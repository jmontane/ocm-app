(self.webpackChunkapp=self.webpackChunkapp||[]).push([[179],{3175:(Rn,Dt,B)=>{"use strict";B.d(Dt,{Ar:()=>be,N0:()=>Ie});var h=B(8274),g=B(6895),ie=B(4004),c=B(5577),Y=B(9770),se=B(9646),y=B(529);const fe=new h.OlP("JWT_OPTIONS");let Ie=(()=>{class me{constructor(he=null){this.tokenGetter=he&&he.tokenGetter||function(){}}urlBase64Decode(he){let Ke=he.replace(/-/g,"+").replace(/_/g,"/");switch(Ke.length%4){case 0:break;case 2:Ke+="==";break;case 3:Ke+="=";break;default:throw new Error("Illegal base64url string!")}return this.b64DecodeUnicode(Ke)}b64decode(he){let Ae="";if((he=String(he).replace(/=+$/,"")).length%4==1)throw new Error("'atob' failed: The string to be decoded is not correctly encoded.");for(let Qe,Ot,te=0,dt=0;Ot=he.charAt(dt++);~Ot&&(Qe=te%4?64*Qe+Ot:Ot,te++%4)?Ae+=String.fromCharCode(255&Qe>>(-2*te&6)):0)Ot="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(Ot);return Ae}b64DecodeUnicode(he){return decodeURIComponent(Array.prototype.map.call(this.b64decode(he),Ke=>"%"+("00"+Ke.charCodeAt(0).toString(16)).slice(-2)).join(""))}decodeToken(he=null){const Ke=he||this.tokenGetter();return Ke instanceof Promise?Ke.then(Ae=>this._decodeToken(Ae)):this._decodeToken(Ke)}_decodeToken(he){if(!he||""===he)return null;const Ke=he.split(".");if(3!==Ke.length)throw new Error("The inspected token doesn't appear to be a JWT. Check to make sure it has three parts and see https://jwt.io for more.");const Ae=this.urlBase64Decode(Ke[1]);if(!Ae)throw new Error("Cannot decode the token.");return JSON.parse(Ae)}getTokenExpirationDate(he=null){const Ke=he||this.tokenGetter();return Ke instanceof Promise?Ke.then(Ae=>this._getTokenExpirationDate(Ae)):this._getTokenExpirationDate(Ke)}_getTokenExpirationDate(he){let Ke;if(Ke=this.decodeToken(he),!Ke||!Ke.hasOwnProperty("exp"))return null;const Ae=new Date(0);return Ae.setUTCSeconds(Ke.exp),Ae}isTokenExpired(he=null,Ke){const Ae=he||this.tokenGetter();return Ae instanceof Promise?Ae.then(te=>this._isTokenExpired(te,Ke)):this._isTokenExpired(Ae,Ke)}_isTokenExpired(he,Ke){if(!he||""===he)return!0;const Ae=this.getTokenExpirationDate(he);return Ke=Ke||0,null!==Ae&&!(Ae.valueOf()>(new Date).valueOf()+1e3*Ke)}getAuthScheme(he,Ke){return"function"==typeof he?he(Ke):he}}return me.\u0275fac=function(he){return new(he||me)(h.LFG(fe))},me.\u0275prov=h.Yz7({token:me,factory:me.\u0275fac}),me})();const Ge=me=>me instanceof Promise?(0,Y.P)(()=>me):(0,se.of)(me);let Q=(()=>{class me{constructor(he,Ke,Ae){this.jwtHelper=Ke,this.document=Ae,this.standardPorts=["80","443"],this.tokenGetter=he.tokenGetter,this.headerName=he.headerName||"Authorization",this.authScheme=he.authScheme||""===he.authScheme?he.authScheme:"Bearer ",this.allowedDomains=he.allowedDomains||[],this.disallowedRoutes=he.disallowedRoutes||[],this.throwNoTokenError=he.throwNoTokenError||!1,this.skipWhenExpired=he.skipWhenExpired}isAllowedDomain(he){const Ke=new URL(he.url,this.document.location.origin);if(Ke.host===this.document.location.host)return!0;const Ae=`${Ke.hostname}${Ke.port&&!this.standardPorts.includes(Ke.port)?":"+Ke.port:""}`;return this.allowedDomains.findIndex(te=>"string"==typeof te?te===Ae:te instanceof RegExp&&te.test(Ae))>-1}isDisallowedRoute(he){const Ke=new URL(he.url,this.document.location.origin);return this.disallowedRoutes.findIndex(Ae=>{if("string"==typeof Ae){const te=new URL(Ae,this.document.location.origin);return te.hostname===Ke.hostname&&te.pathname===Ke.pathname}return Ae instanceof RegExp&&Ae.test(he.url)})>-1}handleInterception(he,Ke,Ae){const te=this.jwtHelper.getAuthScheme(this.authScheme,Ke);if(!he&&this.throwNoTokenError)throw new Error("Could not get token from tokenGetter function.");let Qe=(0,se.of)(!1);return this.skipWhenExpired&&(Qe=he?Ge(this.jwtHelper.isTokenExpired(he)):(0,se.of)(!0)),he?Qe.pipe((0,ie.U)(Ot=>Ot&&this.skipWhenExpired?Ke.clone():Ke.clone({setHeaders:{[this.headerName]:`${te}${he}`}})),(0,c.z)(Ot=>Ae.handle(Ot))):Ae.handle(Ke)}intercept(he,Ke){if(!this.isAllowedDomain(he)||this.isDisallowedRoute(he))return Ke.handle(he);const Ae=this.tokenGetter(he);return Ge(Ae).pipe((0,c.z)(te=>this.handleInterception(te,he,Ke)))}}return me.\u0275fac=function(he){return new(he||me)(h.LFG(fe),h.LFG(Ie),h.LFG(g.K0))},me.\u0275prov=h.Yz7({token:me,factory:me.\u0275fac}),me})(),be=(()=>{class me{constructor(he){if(he)throw new Error("JwtModule is already loaded. It should only be imported in your application's main module.")}static forRoot(he){return{ngModule:me,providers:[{provide:y.TP,useClass:Q,multi:!0},he.jwtOptionsProvider||{provide:fe,useValue:he.config},Ie]}}}return me.\u0275fac=function(he){return new(he||me)(h.LFG(me,12))},me.\u0275mod=h.oAB({type:me}),me.\u0275inj=h.cJS({}),me})()},7423:(Rn,Dt,B)=>{"use strict";B.d(Dt,{Uw:()=>Ae,fo:()=>Ze});var h=B(5861);typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"&&global;var fe=(()=>{return(pe=fe||(fe={})).Unimplemented="UNIMPLEMENTED",pe.Unavailable="UNAVAILABLE",fe;var pe})();class Ie extends Error{constructor(ae,Ee,vt){super(ae),this.message=ae,this.code=Ee,this.data=vt}}const Q=pe=>{var ae,Ee,vt,Et,qt;const Ft=pe.CapacitorCustomPlatform||null,xt=pe.Capacitor||{},Pt=xt.Plugins=xt.Plugins||{},bt=pe.CapacitorPlatforms,ht=(null===(ae=bt?.currentPlatform)||void 0===ae?void 0:ae.getPlatform)||(()=>null!==Ft?Ft.name:(pe=>{var ae,Ee;return pe?.androidBridge?"android":null!==(Ee=null===(ae=pe?.webkit)||void 0===ae?void 0:ae.messageHandlers)&&void 0!==Ee&&Ee.bridge?"ios":"web"})(pe)),Ct=(null===(Ee=bt?.currentPlatform)||void 0===Ee?void 0:Ee.isNativePlatform)||(()=>"web"!==ht()),Gt=(null===(vt=bt?.currentPlatform)||void 0===vt?void 0:vt.isPluginAvailable)||(ci=>!(!jt.get(ci)?.platforms.has(ht())&&!Fn(ci))),Fn=(null===(Et=bt?.currentPlatform)||void 0===Et?void 0:Et.getPluginHeader)||(ci=>{var Un;return null===(Un=xt.PluginHeaders)||void 0===Un?void 0:Un.find(_i=>_i.name===ci)}),jt=new Map,ni=(null===(qt=bt?.currentPlatform)||void 0===qt?void 0:qt.registerPlugin)||((ci,Un={})=>{const _i=jt.get(ci);if(_i)return console.warn(`Capacitor plugin "${ci}" already registered. Cannot register plugins twice.`),_i.proxy;const wi=ht(),xi=Fn(ci);let Ni;const Ii=function(){var tt=(0,h.Z)(function*(){return!Ni&&wi in Un?Ni=Ni="function"==typeof Un[wi]?yield Un[wi]():Un[wi]:null!==Ft&&!Ni&&"web"in Un&&(Ni=Ni="function"==typeof Un.web?yield Un.web():Un.web),Ni});return function(){return tt.apply(this,arguments)}}(),Yi=tt=>{let Wt;const Qt=(...fi)=>{const Ai=Ii().then(er=>{const mi=((tt,Wt)=>{var Qt,fi;if(!xi){if(tt)return null===(fi=tt[Wt])||void 0===fi?void 0:fi.bind(tt);throw new Ie(`"${ci}" plugin is not implemented on ${wi}`,fe.Unimplemented)}{const Ai=xi?.methods.find(er=>Wt===er.name);if(Ai)return"promise"===Ai.rtype?er=>xt.nativePromise(ci,Wt.toString(),er):(er,mi)=>xt.nativeCallback(ci,Wt.toString(),er,mi);if(tt)return null===(Qt=tt[Wt])||void 0===Qt?void 0:Qt.bind(tt)}})(er,tt);if(mi){const xr=mi(...fi);return Wt=xr?.remove,xr}throw new Ie(`"${ci}.${tt}()" is not implemented on ${wi}`,fe.Unimplemented)});return"addListener"===tt&&(Ai.remove=(0,h.Z)(function*(){return Wt()})),Ai};return Qt.toString=()=>`${tt.toString()}() { [capacitor code] }`,Object.defineProperty(Qt,"name",{value:tt,writable:!1,configurable:!1}),Qt},Ht=Yi("addListener"),Mt=Yi("removeListener"),qe=(tt,Wt)=>{const Qt=Ht({eventName:tt},Wt),fi=function(){var er=(0,h.Z)(function*(){const mi=yield Qt;Mt({eventName:tt,callbackId:mi},Wt)});return function(){return er.apply(this,arguments)}}(),Ai=new Promise(er=>Qt.then(()=>er({remove:fi})));return Ai.remove=(0,h.Z)(function*(){console.warn("Using addListener() without 'await' is deprecated."),yield fi()}),Ai},re=new Proxy({},{get(tt,Wt){switch(Wt){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return xi?qe:Ht;case"removeListener":return Mt;default:return Yi(Wt)}}});return Pt[ci]=re,jt.set(ci,{name:ci,proxy:re,platforms:new Set([...Object.keys(Un),...xi?[wi]:[]])}),re});return xt.convertFileSrc||(xt.convertFileSrc=ci=>ci),xt.getPlatform=ht,xt.handleError=ci=>pe.console.error(ci),xt.isNativePlatform=Ct,xt.isPluginAvailable=Gt,xt.pluginMethodNoop=(ci,Un,_i)=>Promise.reject(`${_i} does not have an implementation of "${Un}".`),xt.registerPlugin=ni,xt.Exception=Ie,xt.DEBUG=!!xt.DEBUG,xt.isLoggingEnabled=!!xt.isLoggingEnabled,xt.platform=xt.getPlatform(),xt.isNative=xt.isNativePlatform(),xt},me=(pe=>pe.Capacitor=Q(pe))(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),Ze=me.registerPlugin;class Ae{constructor(ae){this.listeners={},this.windowListeners={},ae&&(console.warn(`Capacitor WebPlugin "${ae.name}" config object was deprecated in v3 and will be removed in v4.`),this.config=ae)}addListener(ae,Ee){var vt=this;this.listeners[ae]||(this.listeners[ae]=[]),this.listeners[ae].push(Ee);const qt=this.windowListeners[ae];qt&&!qt.registered&&this.addWindowListener(qt);const Ft=function(){var Pt=(0,h.Z)(function*(){return vt.removeListener(ae,Ee)});return function(){return Pt.apply(this,arguments)}}(),xt=Promise.resolve({remove:Ft});return Object.defineProperty(xt,"remove",{value:(Pt=(0,h.Z)(function*(){console.warn("Using addListener() without 'await' is deprecated."),yield Ft()}),function(){return Pt.apply(this,arguments)})}),xt;var Pt}removeAllListeners(){var ae=this;return(0,h.Z)(function*(){ae.listeners={};for(const Ee in ae.windowListeners)ae.removeWindowListener(ae.windowListeners[Ee]);ae.windowListeners={}})()}notifyListeners(ae,Ee){const vt=this.listeners[ae];vt&&vt.forEach(Et=>Et(Ee))}hasListeners(ae){return!!this.listeners[ae].length}registerWindowListener(ae,Ee){this.windowListeners[Ee]={registered:!1,windowEventName:ae,pluginEventName:Ee,handler:vt=>{this.notifyListeners(Ee,vt)}}}unimplemented(ae="not implemented"){return new me.Exception(ae,fe.Unimplemented)}unavailable(ae="not available"){return new me.Exception(ae,fe.Unavailable)}removeListener(ae,Ee){var vt=this;return(0,h.Z)(function*(){const Et=vt.listeners[ae];if(!Et)return;const qt=Et.indexOf(Ee);vt.listeners[ae].splice(qt,1),vt.listeners[ae].length||vt.removeWindowListener(vt.windowListeners[ae])})()}addWindowListener(ae){window.addEventListener(ae.windowEventName,ae.handler),ae.registered=!0}removeWindowListener(ae){!ae||(window.removeEventListener(ae.windowEventName,ae.handler),ae.registered=!1)}}const Qe=pe=>encodeURIComponent(pe).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),Ot=pe=>pe.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);class dt extends Ae{getCookies(){return(0,h.Z)(function*(){const ae=document.cookie,Ee={};return ae.split(";").forEach(vt=>{if(vt.length<=0)return;let[Et,qt]=vt.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");Et=Ot(Et).trim(),qt=Ot(qt).trim(),Ee[Et]=qt}),Ee})()}setCookie(ae){return(0,h.Z)(function*(){try{const Ee=Qe(ae.key),vt=Qe(ae.value),Et=`; expires=${(ae.expires||"").replace("expires=","")}`,qt=(ae.path||"/").replace("path=",""),Ft=null!=ae.url&&ae.url.length>0?`domain=${ae.url}`:"";document.cookie=`${Ee}=${vt||""}${Et}; path=${qt}; ${Ft};`}catch(Ee){return Promise.reject(Ee)}})()}deleteCookie(ae){return(0,h.Z)(function*(){try{document.cookie=`${ae.key}=; Max-Age=0`}catch(Ee){return Promise.reject(Ee)}})()}clearCookies(){return(0,h.Z)(function*(){try{const ae=document.cookie.split(";")||[];for(const Ee of ae)document.cookie=Ee.replace(/^ +/,"").replace(/=.*/,`=;expires=${(new Date).toUTCString()};path=/`)}catch(ae){return Promise.reject(ae)}})()}clearAllCookies(){var ae=this;return(0,h.Z)(function*(){try{yield ae.clearCookies()}catch(Ee){return Promise.reject(Ee)}})()}}Ze("CapacitorCookies",{web:()=>new dt});const Fe=function(){var pe=(0,h.Z)(function*(ae){return new Promise((Ee,vt)=>{const Et=new FileReader;Et.onload=()=>{const qt=Et.result;Ee(qt.indexOf(",")>=0?qt.split(",")[1]:qt)},Et.onerror=qt=>vt(qt),Et.readAsDataURL(ae)})});return function(Ee){return pe.apply(this,arguments)}}();class Je extends Ae{request(ae){return(0,h.Z)(function*(){const Ee=((pe,ae={})=>{const Ee=Object.assign({method:pe.method||"GET",headers:pe.headers},ae),Et=((pe={})=>{const ae=Object.keys(pe);return Object.keys(pe).map(Et=>Et.toLocaleLowerCase()).reduce((Et,qt,Ft)=>(Et[qt]=pe[ae[Ft]],Et),{})})(pe.headers)["content-type"]||"";if("string"==typeof pe.data)Ee.body=pe.data;else if(Et.includes("application/x-www-form-urlencoded")){const qt=new URLSearchParams;for(const[Ft,xt]of Object.entries(pe.data||{}))qt.set(Ft,xt);Ee.body=qt.toString()}else if(Et.includes("multipart/form-data")){const qt=new FormData;if(pe.data instanceof FormData)pe.data.forEach((xt,Pt)=>{qt.append(Pt,xt)});else for(const xt of Object.keys(pe.data))qt.append(xt,pe.data[xt]);Ee.body=qt;const Ft=new Headers(Ee.headers);Ft.delete("content-type"),Ee.headers=Ft}else(Et.includes("application/json")||"object"==typeof pe.data)&&(Ee.body=JSON.stringify(pe.data));return Ee})(ae,ae.webFetchExtra),vt=((pe,ae=!0)=>pe?Object.entries(pe).reduce((vt,Et)=>{const[qt,Ft]=Et;let xt,Pt;return Array.isArray(Ft)?(Pt="",Ft.forEach(bt=>{xt=ae?encodeURIComponent(bt):bt,Pt+=`${qt}=${xt}&`}),Pt.slice(0,-1)):(xt=ae?encodeURIComponent(Ft):Ft,Pt=`${qt}=${xt}`),`${vt}&${Pt}`},"").substr(1):null)(ae.params,ae.shouldEncodeUrlParams),Et=vt?`${ae.url}?${vt}`:ae.url,qt=yield fetch(Et,Ee),Ft=qt.headers.get("content-type")||"";let Pt,bt,{responseType:xt="text"}=qt.ok?ae:{};switch(Ft.includes("application/json")&&(xt="json"),xt){case"arraybuffer":case"blob":bt=yield qt.blob(),Pt=yield Fe(bt);break;case"json":Pt=yield qt.json();break;default:Pt=yield qt.text()}const ct={};return qt.headers.forEach((ht,Ce)=>{ct[Ce]=ht}),{data:Pt,headers:ct,status:qt.status,url:qt.url}})()}get(ae){var Ee=this;return(0,h.Z)(function*(){return Ee.request(Object.assign(Object.assign({},ae),{method:"GET"}))})()}post(ae){var Ee=this;return(0,h.Z)(function*(){return Ee.request(Object.assign(Object.assign({},ae),{method:"POST"}))})()}put(ae){var Ee=this;return(0,h.Z)(function*(){return Ee.request(Object.assign(Object.assign({},ae),{method:"PUT"}))})()}patch(ae){var Ee=this;return(0,h.Z)(function*(){return Ee.request(Object.assign(Object.assign({},ae),{method:"PATCH"}))})()}delete(ae){var Ee=this;return(0,h.Z)(function*(){return Ee.request(Object.assign(Object.assign({},ae),{method:"DELETE"}))})()}}Ze("CapacitorHttp",{web:()=>new Je})},201:(Rn,Dt,B)=>{"use strict";B.d(Dt,{BX:()=>lo,Br:()=>Vo,w:()=>Er,dr:()=>st,BJ:()=>Bt,oU:()=>Rt,cs:()=>ms,yp:()=>Pe,YG:()=>nt,Sm:()=>zt,PM:()=>_n,FN:()=>Mn,Zi:()=>Yn,wI:()=>Bi,W2:()=>Qr,IJ:()=>ar,W4:()=>pr,zq:()=>xo,fr:()=>zo,jY:()=>Br,Gu:()=>Oi,gu:()=>lr,pK:()=>ri,Ie:()=>Wn,Q$:()=>He,q_:()=>pt,yh:()=>Yt,z0:()=>hn,fG:()=>nn,zc:()=>kn,uN:()=>qi,I_:()=>tr,nJ:()=>fr,Wo:()=>es,jP:()=>zr,Nd:()=>ia,VI:()=>Io,cJ:()=>Dr,GO:()=>Mo,t9:()=>Zr,n0:()=>ra,PQ:()=>so,jI:()=>ao,g2:()=>ds,Bs:()=>Bs,wd:()=>oa,ho:()=>mo,sr:()=>No,Pc:()=>ol,r4:()=>Xs,HT:()=>la,IN:()=>Ji,SH:()=>fs,X1:()=>Ys,as:()=>ui,t4:()=>hs,YI:()=>ka,QI:()=>_t,j9:()=>kt,yF:()=>Ml});var h=B(8274),g=B(4006);function y(E,Z,I,$){var Cn,ve=arguments.length,St=ve<3?Z:null===$?$=Object.getOwnPropertyDescriptor(Z,I):$;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)St=Reflect.decorate(E,Z,I,$);else for(var Zn=E.length-1;Zn>=0;Zn--)(Cn=E[Zn])&&(St=(ve<3?Cn(St):ve>3?Cn(Z,I,St):Cn(Z,I))||St);return ve>3&&St&&Object.defineProperty(Z,I,St),St}function Ge(E,Z,I,$){return new(I||(I=Promise))(function(St,Cn){function Zn(Xi){try{ii($.next(Xi))}catch(ur){Cn(ur)}}function Ei(Xi){try{ii($.throw(Xi))}catch(ur){Cn(ur)}}function ii(Xi){Xi.done?St(Xi.value):function ve(St){return St instanceof I?St:new I(function(Cn){Cn(St)})}(Xi.value).then(Zn,Ei)}ii(($=$.apply(E,Z||[])).next())})}var ae=B(4968),Ee=B(7579),vt=B(1135),Et=B(4228),bt=(B(8834),B(3953),B(3880),B(1911),B(9658)),ct=B(5730),ht=B(697),Ct=(B(4292),B(1312)),wn=(B(3457),B(4349),B(1308)),ni=B(9300),ci=B(3900),Un=B(4671),_i=B(4482),wi=B(5403);function Ni(E,Z){return E===Z}var Ii=B(6895);const Yi=bt.i,qe=["*"],Ai=E=>"function"==typeof __zone_symbol__requestAnimationFrame?__zone_symbol__requestAnimationFrame(E):"function"==typeof requestAnimationFrame?requestAnimationFrame(E):setTimeout(E),er=E=>!!E.resolveComponentFactory;let mi=(()=>{class E{constructor(I,$){this.injector=I,this.el=$,this.onChange=()=>{},this.onTouched=()=>{}}writeValue(I){this.el.nativeElement.value=this.lastValue=I??"",xr(this.el)}handleChangeEvent(I,$){I===this.el.nativeElement&&($!==this.lastValue&&(this.lastValue=$,this.onChange($)),xr(this.el))}_handleBlurEvent(I){I===this.el.nativeElement&&(this.onTouched(),xr(this.el))}registerOnChange(I){this.onChange=I}registerOnTouched(I){this.onTouched=I}setDisabledState(I){this.el.nativeElement.disabled=I}ngOnDestroy(){this.statusChanges&&this.statusChanges.unsubscribe()}ngAfterViewInit(){let I;try{I=this.injector.get(g.a5)}catch{}if(!I)return;I.statusChanges&&(this.statusChanges=I.statusChanges.subscribe(()=>xr(this.el)));const $=I.control;$&&["markAsTouched","markAllAsTouched","markAsUntouched","markAsDirty","markAsPristine"].forEach(St=>{if(typeof $[St]<"u"){const Cn=$[St].bind($);$[St]=(...Zn)=>{Cn(...Zn),xr(this.el)}}})}}return E.\u0275fac=function(I){return new(I||E)(h.Y36(h.zs3),h.Y36(h.SBq))},E.\u0275dir=h.lG2({type:E,hostBindings:function(I,$){1&I&&h.NdJ("ionBlur",function(St){return $._handleBlurEvent(St.target)})}}),E})();const xr=E=>{Ai(()=>{const Z=E.nativeElement,I=null!=Z.value&&Z.value.toString().length>0,$=Pi(Z);br(Z,$);const ve=Z.closest("ion-item");ve&&br(ve,I?[...$,"item-has-value"]:$)})},Pi=E=>{const Z=E.classList,I=[];for(let $=0;$<Z.length;$++){const ve=Z.item($);null!==ve&&wr(ve,"ng-")&&I.push(`ion-${ve.substring(3)}`)}return I},br=(E,Z)=>{const I=E.classList;I.remove("ion-valid","ion-invalid","ion-touched","ion-untouched","ion-dirty","ion-pristine"),I.add(...Z)},wr=(E,Z)=>E.substring(0,Z.length)===Z;let Er=(()=>{class E extends mi{constructor(I,$){super(I,$)}writeValue(I){this.el.nativeElement.checked=this.lastValue=I??!1,xr(this.el)}_handleIonChange(I){this.handleChangeEvent(I,I.checked)}}return E.\u0275fac=function(I){return new(I||E)(h.Y36(h.zs3),h.Y36(h.SBq))},E.\u0275dir=h.lG2({type:E,selectors:[["ion-checkbox"],["ion-toggle"]],hostBindings:function(I,$){1&I&&h.NdJ("ionChange",function(St){return $._handleIonChange(St.target)})},features:[h._Bn([{provide:g.JU,useExisting:E,multi:!0}]),h.qOj]}),E})(),ui=(()=>{class E extends mi{constructor(I,$){super(I,$)}_handleIonChange(I){this.handleChangeEvent(I,I.value)}registerOnChange(I){super.registerOnChange($=>{I(""===$?null:parseFloat($))})}}return E.\u0275fac=function(I){return new(I||E)(h.Y36(h.zs3),h.Y36(h.SBq))},E.\u0275dir=h.lG2({type:E,selectors:[["ion-input","type","number"]],hostBindings:function(I,$){1&I&&h.NdJ("ionChange",function(St){return $._handleIonChange(St.target)})},features:[h._Bn([{provide:g.JU,useExisting:E,multi:!0}]),h.qOj]}),E})(),_t=(()=>{class E extends mi{constructor(I,$){super(I,$)}_handleChangeEvent(I){this.handleChangeEvent(I,I.value)}}return E.\u0275fac=function(I){return new(I||E)(h.Y36(h.zs3),h.Y36(h.SBq))},E.\u0275dir=h.lG2({type:E,selectors:[["ion-range"],["ion-select"],["ion-radio-group"],["ion-segment"],["ion-datetime"]],hostBindings:function(I,$){1&I&&h.NdJ("ionChange",function(St){return $._handleChangeEvent(St.target)})},features:[h._Bn([{provide:g.JU,useExisting:E,multi:!0}]),h.qOj]}),E})(),kt=(()=>{class E extends mi{constructor(I,$){super(I,$)}_handleInputEvent(I){this.handleChangeEvent(I,I.value)}}return E.\u0275fac=function(I){return new(I||E)(h.Y36(h.zs3),h.Y36(h.SBq))},E.\u0275dir=h.lG2({type:E,selectors:[["ion-input",3,"type","number"],["ion-textarea"],["ion-searchbar"]],hostBindings:function(I,$){1&I&&h.NdJ("ionChange",function(St){return $._handleInputEvent(St.target)})},features:[h._Bn([{provide:g.JU,useExisting:E,multi:!0}]),h.qOj]}),E})();const gn=(E,Z)=>{const I=E.prototype;Z.forEach($=>{Object.defineProperty(I,$,{get(){return this.el[$]},set(ve){this.z.runOutsideAngular(()=>this.el[$]=ve)}})})},Ve=(E,Z)=>{const I=E.prototype;Z.forEach($=>{I[$]=function(){const ve=arguments;return this.z.runOutsideAngular(()=>this.el[$].apply(this.el,ve))}})},le=(E,Z,I)=>{I.forEach($=>E[$]=(0,ae.R)(Z,$))};function j(E){return function(I){const{defineCustomElementFn:$,inputs:ve,methods:St}=E;return void 0!==$&&$(),ve&&gn(I,ve),St&&Ve(I,St),I}}let st=(()=>{let E=class{constructor(I,$,ve){this.z=ve,I.detach(),this.el=$.nativeElement}};return E.\u0275fac=function(I){return new(I||E)(h.Y36(h.sBO),h.Y36(h.SBq),h.Y36(h.R0b))},E.\u0275cmp=h.Xpm({type:E,selectors:[["ion-app"]],ngContentSelectors:qe,decls:1,vars:0,template:function(I,$){1&I&&(h.F$t(),h.Hsn(0))},encapsulation:2,changeDetection:0}),E=y([j({defineCustomElementFn:void 0})],E),E})(),Bt=(()=>{let E=class{constructor(I,$,ve){this.z=ve,I.detach(),this.el=$.nativeElement}};return E.\u0275fac=function(I){return new(I||E)(h.Y36(h.sBO),h.Y36(h.SBq),h.Y36(h.R0b))},E.\u0275cmp=h.Xpm({type:E,selectors:[["ion-avatar"]],ngContentSelectors:qe,decls:1,vars:0,template:function(I,$){1&I&&(h.F$t(),h.Hsn(0))},encapsulation:2,changeDetection:0}),E=y([j({defineCustomElementFn:void 0})],E),E})(),Rt=(()=>{let E=class{constructor(I,$,ve){this.z=ve,I.detach(),this.el=$.nativeElement}};return E.\u0275fac=function(I){return new(I||E)(h.Y36(h.sBO),h.Y36(h.SBq),h.Y36(h.R0b))},E.\u0275cmp=h.Xpm({type:E,selectors:[["ion-back-button"]],inputs:{color:"color",defaultHref:"defaultHref",disabled:"disabled",icon:"icon",mode:"mode",routerAnimation:"routerAnimation",text:"text",type:"type"},ngContentSelectors:qe,decls:1,vars:0,template:function(I,$){1&I&&(h.F$t(),h.Hsn(0))},encapsulation:2,changeDetection:0}),E=y([j({defineCustomElementFn:void 0,inputs:["color","defaultHref","disabled","icon","mode","routerAnimation","text","type"]})],E),E})(),Pe=(()=>{let E=class{constructor(I,$,ve){this.z=ve,I.detach(),this.el=$.nativeElement}};return E.\u0275fac=function(I){return new(I||E)(h.Y36(h.sBO),h.Y36(h.SBq),h.Y36(h.R0b))},E.\u0275cmp=h.Xpm({type:E,selectors:[["ion-badge"]],inputs:{color:"color",mode:"mode"},ngContentSelectors:qe,decls:1,vars:0,template:function(I,$){1&I&&(h.F$t(),h.Hsn(0))},encapsulation:2,changeDetection:0}),E=y([j({defineCustomElementFn:void 0,inputs:["color","mode"]})],E),E})(),nt=(()=>{let E=class{constructor(I,$,ve){this.z=ve,I.detach(),this.el=$.nativeElement,le(this,this.el,["ionFocus","ionBlur"])}};return E.\u0275fac=function(I){return new(I||E)(h.Y36(h.sBO),h.Y36(h.SBq),h.Y36(h.R0b))},E.\u0275cmp=h.Xpm({type:E,selectors:[["ion-button"]],inputs:{buttonType:"buttonType",color:"color",disabled:"disabled",download:"download",expand:"expand",fill:"fill",form:"form",href:"href",mode:"mode",rel:"rel",routerAnimation:"routerAnimation",routerDirection:"routerDirection",shape:"shape",size:"size",strong:"strong",target:"target",type:"type"},ngContentSelectors:qe,decls:1,vars:0,template:function(I,$){1&I&&(h.F$t(),h.Hsn(0))},encapsulation:2,changeDetection:0}),E=y([j({defineCustomElementFn:void 0,inputs:["buttonType","color","disabled","download","expand","fill","form","href","mode","rel","routerAnimation","routerDirection","shape","size","strong","target","type"]})],E),E})(),zt=(()=>{let E=class{constructor(I,$,ve){this.z=ve,I.detach(),this.el=$.nativeElement}};return E.\u0275fac=function(I){return new(I||E)(h.Y36(h.sBO),h.Y36(h.SBq),h.Y36(h.R0b))},E.\u0275cmp=h.Xpm({type:E,selectors:[["ion-buttons"]],inputs:{collapse:"collapse"},ngContentSelectors:qe,decls:1,vars:0,template:function(I,$){1&I&&(h.F$t(),h.Hsn(0))},encapsulation:2,changeDetection:0}),E=y([j({defineCustomElementFn:void 0,inputs:["collapse"]})],E),E})(),_n=(()=>{let E=class{constructor(I,$,ve){this.z=ve,I.detach(),this.el=$.nativeElement}};return E.\u0275fac=function(I){return new(I||E)(h.Y36(h.sBO),h.Y36(h.SBq),h.Y36(h.R0b))},E.\u0275cmp=h.Xpm({type:E,selectors:[["ion-card"]],inputs:{button:"button",color:"color",disabled:"disabled",download:"download",href:"href",mode:"mode",rel:"rel",routerAnimation:"routerAnimation",routerDirection:"routerDirection",target:"target",type:"type"},ngContentSelectors:qe,decls:1,vars:0,template:function(I,$){1&I&&(h.F$t(),h.Hsn(0))},encapsulation:2,changeDetection:0}),E=y([j({defineCustomElementFn:void 0,inputs:["button","color","disabled","download","href","mode","rel","routerAnimation","routerDirection","target","type"]})],E),E})(),Mn=(()=>{let E=class{constructor(I,$,ve){this.z=ve,I.detach(),this.el=$.nativeElement}};return E.\u0275fac=function(I){return new(I||E)(h.Y36(h.sBO),h.Y36(h.SBq),h.Y36(h.R0b))},E.\u0275cmp=h.Xpm({type:E,selectors:[["ion-card-content"]],inputs:{mode:"mode"},ngContentSelectors:qe,decls:1,vars:0,template:function(I,$){1&I&&(h.F$t(),h.Hsn(0))},encapsulation:2,changeDetection:0}),E=y([j({defineCustomElementFn:void 0,inputs:["mode"]})],E),E})(),Yn=(()=>{let E=class{constructor(I,$,ve){this.z=ve,I.detach(),this.el=$.nativeElement}};return E.\u0275fac=function(I){return new(I||E)(h.Y36(h.sBO),h.Y36(h.SBq),h.Y36(h.R0b))},E.\u0275cmp=h.Xpm({type:E,selectors:[["ion-card-header"]],inputs:{color:"color",mode:"mode",translucent:"translucent"},ngContentSelectors:qe,decls:1,vars:0,template:function(I,$){1&I&&(h.F$t(),h.Hsn(0))},encapsulation:2,changeDetection:0}),E=y([j({defineCustomElementFn:void 0,inputs:["color","mode","translucent"]})],E),E})(),Bi=(()=>{let E=class{constructor(I,$,ve){this.z=ve,I.detach(),this.el=$.nativeElement}};return E.\u0275fac=function(I){return new(I||E)(h.Y36(h.sBO),h.Y36(h.SBq),h.Y36(h.R0b))},E.\u0275cmp=h.Xpm({type:E,selectors:[["ion-col"]],inputs:{offset:"offset",offsetLg:"offsetLg",offsetMd:"offsetMd",offsetSm:"offsetSm",offsetXl:"offsetXl",offsetXs:"offsetXs",pull:"pull",pullLg:"pullLg",pullMd:"pullMd",pullSm:"pullSm",pullXl:"pullXl",pullXs:"pullXs",push:"push",pushLg:"pushLg",pushMd:"pushMd",pushSm:"pushSm",pushXl:"pushXl",pushXs:"pushXs",size:"size",sizeLg:"sizeLg",sizeMd:"sizeMd",sizeSm:"sizeSm",sizeXl:"sizeXl",sizeXs:"sizeXs"},ngContentSelectors:qe,decls:1,vars:0,template:function(I,$){1&I&&(h.F$t(),h.Hsn(0))},encapsulation:2,changeDetection:0}),E=y([j({defineCustomElementFn:void 0,inputs:["offset","offsetLg","offsetMd","offsetSm","offsetXl","offsetXs","pull","pullLg","pullMd","pullSm","pullXl","pullXs","push","pushLg","pushMd","pushSm","pushXl","pushXs","size","sizeLg","sizeMd","sizeSm","sizeXl","sizeXs"]})],E),E})(),Qr=(()=>{let E=class{constructor(I,$,ve){this.z=ve,I.detach(),this.el=$.nativeElement,le(this,this.el,["ionScrollStart","ionScroll","ionScrollEnd"])}};return E.\u0275fac=function(I){return new(I||E)(h.Y36(h.sBO),h.Y36(h.SBq),h.Y36(h.R0b))},E.\u0275cmp=h.Xpm({type:E,selectors:[["ion-content"]],inputs:{color:"color",forceOverscroll:"forceOverscroll",fullscreen:"fullscreen",scrollEvents:"scrollEvents",scrollX:"scrollX",scrollY:"scrollY"},ngContentSelectors:qe,decls:1,vars:0,template:function(I,$){1&I&&(h.F$t(),h.Hsn(0))},encapsulation:2,changeDetection:0}),E=y([j({defineCustomElementFn:void 0,inputs:["color","forceOverscroll","fullscreen","scrollEvents","scrollX","scrollY"],methods:["getScrollElement","scrollToTop","scrollToBottom","scrollByPoint","scrollToPoint"]})],E),E})(),ar=(()=>{let E=class{constructor(I,$,ve){this.z=ve,I.detach(),this.el=$.nativeElement}};return E.\u0275fac=function(I){return new(I||E)(h.Y36(h.sBO),h.Y36(h.SBq),h.Y36(h.R0b))},E.\u0275cmp=h.Xpm({type:E,selectors:[["ion-fab"]],inputs:{activated:"activated",edge:"edge",horizontal:"horizontal",vertical:"vertical"},ngContentSelectors:qe,decls:1,vars:0,template:function(I,$){1&I&&(h.F$t(),h.Hsn(0))},encapsulation:2,changeDetection:0}),E=y([j({defineCustomElementFn:void 0,inputs:["activated","edge","horizontal","vertical"],methods:["close"]})],E),E})(),pr=(()=>{let E=class{constructor(I,$,ve){this.z=ve,I.detach(),this.el=$.nativeElement,le(this,this.el,["ionFocus","ionBlur"])}};return E.\u0275fac=function(I){return new(I||E)(h.Y36(h.sBO),h.Y36(h.SBq),h.Y36(h.R0b))},E.\u0275cmp=h.Xpm({type:E,selectors:[["ion-fab-button"]],inputs:{activated:"activated",closeIcon:"closeIcon",color:"color",disabled:"disabled",download:"download",href:"href",mode:"mode",rel:"rel",routerAnimation:"routerAnimation",routerDirection:"routerDirection",show:"show",size:"size",target:"target",translucent:"translucent",type:"type"},ngContentSelectors:qe,decls:1,vars:0,template:function(I,$){1&I&&(h.F$t(),h.Hsn(0))},encapsulation:2,changeDetection:0}),E=y([j({defineCustomElementFn:void 0,inputs:["activated","closeIcon","color","disabled","download","href","mode","rel","routerAnimation","routerDirection","show","size","target","translucent","type"]})],E),E})(),xo=(()=>{let E=class{constructor(I,$,ve){this.z=ve,I.detach(),this.el=$.nativeElement}};return E.\u0275fac=function(I){return new(I||E)(h.Y36(h.sBO),h.Y36(h.SBq),h.Y36(h.R0b))},E.\u0275cmp=h.Xpm({type:E,selectors:[["ion-fab-list"]],inputs:{activated:"activated",side:"side"},ngContentSelectors:qe,decls:1,vars:0,template:function(I,$){1&I&&(h.F$t(),h.Hsn(0))},encapsulation:2,changeDetection:0}),E=y([j({defineCustomElementFn:void 0,inputs:["activated","side"]})],E),E})(),zo=(()=>{let E=class{constructor(I,$,ve){this.z=ve,I.detach(),this.el=$.nativeElement}};return E.\u0275fac=function(I){return new(I||E)(h.Y36(h.sBO),h.Y36(h.SBq),h.Y36(h.R0b))},E.\u0275cmp=h.Xpm({type:E,selectors:[["ion-footer"]],inputs:{collapse:"collapse",mode:"mode",translucent:"translucent"},ngContentSelectors:qe,decls:1,vars:0,template:function(I,$){1&I&&(h.F$t(),h.Hsn(0))},encapsulation:2,changeDetection:0}),E=y([j({defineCustomElementFn:void 0,inputs:["collapse","mode","translucent"]})],E),E})(),Br=(()=>{let E=class{constructor(I,$,ve){this.z=ve,I.detach(),this.el=$.nativeElement}};return E.\u0275fac=function(I){return new(I||E)(h.Y36(h.sBO),h.Y36(h.SBq),h.Y36(h.R0b))},E.\u0275cmp=h.Xpm({type:E,selectors:[["ion-grid"]],inputs:{fixed:"fixed"},ngContentSelectors:qe,decls:1,vars:0,template:function(I,$){1&I&&(h.F$t(),h.Hsn(0))},encapsulation:2,changeDetection:0}),E=y([j({defineCustomElementFn:void 0,inputs:["fixed"]})],E),E})(),Oi=(()=>{let E=class{constructor(I,$,ve){this.z=ve,I.detach(),this.el=$.nativeElement}};return E.\u0275fac=function(I){return new(I||E)(h.Y36(h.sBO),h.Y36(h.SBq),h.Y36(h.R0b))},E.\u0275cmp=h.Xpm({type:E,selectors:[["ion-header"]],inputs:{collapse:"collapse",mode:"mode",translucent:"translucent"},ngContentSelectors:qe,decls:1,vars:0,template:function(I,$){1&I&&(h.F$t(),h.Hsn(0))},encapsulation:2,changeDetection:0}),E=y([j({defineCustomElementFn:void 0,inputs:["collapse","mode","translucent"]})],E),E})(),lr=(()=>{let E=class{constructor(I,$,ve){this.z=ve,I.detach(),this.el=$.nativeElement}};return E.\u0275fac=function(I){return new(I||E)(h.Y36(h.sBO),h.Y36(h.SBq),h.Y36(h.R0b))},E.\u0275cmp=h.Xpm({type:E,selectors:[["ion-icon"]],inputs:{color:"color",flipRtl:"flipRtl",icon:"icon",ios:"ios",lazy:"lazy",md:"md",mode:"mode",name:"name",sanitize:"sanitize",size:"size",src:"src"},ngContentSelectors:qe,decls:1,vars:0,template:function(I,$){1&I&&(h.F$t(),h.Hsn(0))},encapsulation:2,changeDetection:0}),E=y([j({defineCustomElementFn:void 0,inputs:["color","flipRtl","icon","ios","lazy","md","mode","name","sanitize","size","src"]})],E),E})(),ri=(()=>{let E=class{constructor(I,$,ve){this.z=ve,I.detach(),this.el=$.nativeElement,le(this,this.el,["ionInput","ionChange","ionBlur","ionFocus"])}};return E.\u0275fac=function(I){return new(I||E)(h.Y36(h.sBO),h.Y36(h.SBq),h.Y36(h.R0b))},E.\u0275cmp=h.Xpm({type:E,selectors:[["ion-input"]],inputs:{accept:"accept",autocapitalize:"autocapitalize",autocomplete:"autocomplete",autocorrect:"autocorrect",autofocus:"autofocus",clearInput:"clearInput",clearOnEdit:"clearOnEdit",color:"color",debounce:"debounce",disabled:"disabled",enterkeyhint:"enterkeyhint",inputmode:"inputmode",max:"max",maxlength:"maxlength",min:"min",minlength:"minlength",mode:"mode",multiple:"multiple",name:"name",pattern:"pattern",placeholder:"placeholder",readonly:"readonly",required:"required",size:"size",spellcheck:"spellcheck",step:"step",type:"type",value:"value"},ngContentSelectors:qe,decls:1,vars:0,template:function(I,$){1&I&&(h.F$t(),h.Hsn(0))},encapsulation:2,changeDetection:0}),E=y([j({defineCustomElementFn:void 0,inputs:["accept","autocapitalize","autocomplete","autocorrect","autofocus","clearInput","clearOnEdit","color","debounce","disabled","enterkeyhint","inputmode","max","maxlength","min","minlength","mode","multiple","name","pattern","placeholder","readonly","required","size","spellcheck","step","type","value"],methods:["setFocus","getInputElement"]})],E),E})(),Wn=(()=>{let E=class{constructor(I,$,ve){this.z=ve,I.detach(),this.el=$.nativeElement}};return E.\u0275fac=function(I){return new(I||E)(h.Y36(h.sBO),h.Y36(h.SBq),h.Y36(h.R0b))},E.\u0275cmp=h.Xpm({type:E,selectors:[["ion-item"]],inputs:{button:"button",color:"color",counter:"counter",counterFormatter:"counterFormatter",detail:"detail",detailIcon:"detailIcon",disabled:"disabled",download:"download",fill:"fill",href:"href",lines:"lines",mode:"mode",rel:"rel",routerAnimation:"routerAnimation",routerDirection:"routerDirection",shape:"shape",target:"target",type:"type"},ngContentSelectors:qe,decls:1,vars:0,template:function(I,$){1&I&&(h.F$t(),h.Hsn(0))},encapsulation:2,changeDetection:0}),E=y([j({defineCustomElementFn:void 0,inputs:["button","color","counter","counterFormatter","detail","detailIcon","disabled","download","fill","href","lines","mode","rel","routerAnimation","routerDirection","shape","target","type"]})],E),E})(),He=(()=>{let E=class{constructor(I,$,ve){this.z=ve,I.detach(),this.el=$.nativeElement}};return E.\u0275fac=function(I){return new(I||E)(h.Y36(h.sBO),h.Y36(h.SBq),h.Y36(h.R0b))},E.\u0275cmp=h.Xpm({type:E,selectors:[["ion-label"]],inputs:{color:"color",mode:"mode",position:"position"},ngContentSelectors:qe,decls:1,vars:0,template:function(I,$){1&I&&(h.F$t(),h.Hsn(0))},encapsulation:2,changeDetection:0}),E=y([j({defineCustomElementFn:void 0,inputs:["color","mode","position"]})],E),E})(),pt=(()=>{let E=class{constructor(I,$,ve){this.z=ve,I.detach(),this.el=$.nativeElement}};return E.\u0275fac=function(I){return new(I||E)(h.Y36(h.sBO),h.Y36(h.SBq),h.Y36(h.R0b))},E.\u0275cmp=h.Xpm({type:E,selectors:[["ion-list"]],inputs:{inset:"inset",lines:"lines",mode:"mode"},ngContentSelectors:qe,decls:1,vars:0,template:function(I,$){1&I&&(h.F$t(),h.Hsn(0))},encapsulation:2,changeDetection:0}),E=y([j({defineCustomElementFn:void 0,inputs:["inset","lines","mode"],methods:["closeSlidingItems"]})],E),E})(),Yt=(()=>{let E=class{constructor(I,$,ve){this.z=ve,I.detach(),this.el=$.nativeElement}};return E.\u0275fac=function(I){return new(I||E)(h.Y36(h.sBO),h.Y36(h.SBq),h.Y36(h.R0b))},E.\u0275cmp=h.Xpm({type:E,selectors:[["ion-list-header"]],inputs:{color:"color",lines:"lines",mode:"mode"},ngContentSelectors:qe,decls:1,vars:0,template:function(I,$){1&I&&(h.F$t(),h.Hsn(0))},encapsulation:2,changeDetection:0}),E=y([j({defineCustomElementFn:void 0,inputs:["color","lines","mode"]})],E),E})(),hn=(()=>{let E=class{constructor(I,$,ve){this.z=ve,I.detach(),this.el=$.nativeElement,le(this,this.el,["ionWillOpen","ionWillClose","ionDidOpen","ionDidClose"])}};return E.\u0275fac=function(I){return new(I||E)(h.Y36(h.sBO),h.Y36(h.SBq),h.Y36(h.R0b))},E.\u0275cmp=h.Xpm({type:E,selectors:[["ion-menu"]],inputs:{contentId:"contentId",disabled:"disabled",maxEdgeStart:"maxEdgeStart",menuId:"menuId",side:"side",swipeGesture:"swipeGesture",type:"type"},ngContentSelectors:qe,decls:1,vars:0,template:function(I,$){1&I&&(h.F$t(),h.Hsn(0))},encapsulation:2,changeDetection:0}),E=y([j({defineCustomElementFn:void 0,inputs:["contentId","disabled","maxEdgeStart","menuId","side","swipeGesture","type"],methods:["isOpen","isActive","open","close","toggle","setOpen"]})],E),E})(),nn=(()=>{let E=class{constructor(I,$,ve){this.z=ve,I.detach(),this.el=$.nativeElement}};return E.\u0275fac=function(I){return new(I||E)(h.Y36(h.sBO),h.Y36(h.SBq),h.Y36(h.R0b))},E.\u0275cmp=h.Xpm({type:E,selectors:[["ion-menu-button"]],inputs:{autoHide:"autoHide",color:"color",disabled:"disabled",menu:"menu",mode:"mode",type:"type"},ngContentSelectors:qe,decls:1,vars:0,template:function(I,$){1&I&&(h.F$t(),h.Hsn(0))},encapsulation:2,changeDetection:0}),E=y([j({defineCustomElementFn:void 0,inputs:["autoHide","color","disabled","menu","mode","type"]})],E),E})(),kn=(()=>{let E=class{constructor(I,$,ve){this.z=ve,I.detach(),this.el=$.nativeElement}};return E.\u0275fac=function(I){return new(I||E)(h.Y36(h.sBO),h.Y36(h.SBq),h.Y36(h.R0b))},E.\u0275cmp=h.Xpm({type:E,selectors:[["ion-menu-toggle"]],inputs:{autoHide:"autoHide",menu:"menu"},ngContentSelectors:qe,decls:1,vars:0,template:function(I,$){1&I&&(h.F$t(),h.Hsn(0))},encapsulation:2,changeDetection:0}),E=y([j({defineCustomElementFn:void 0,inputs:["autoHide","menu"]})],E),E})(),qi=(()=>{let E=class{constructor(I,$,ve){this.z=ve,I.detach(),this.el=$.nativeElement}};return E.\u0275fac=function(I){return new(I||E)(h.Y36(h.sBO),h.Y36(h.SBq),h.Y36(h.R0b))},E.\u0275cmp=h.Xpm({type:E,selectors:[["ion-note"]],inputs:{color:"color",mode:"mode"},ngContentSelectors:qe,decls:1,vars:0,template:function(I,$){1&I&&(h.F$t(),h.Hsn(0))},encapsulation:2,changeDetection:0}),E=y([j({defineCustomElementFn:void 0,inputs:["color","mode"]})],E),E})(),tr=(()=>{let E=class{constructor(I,$,ve){this.z=ve,I.detach(),this.el=$.nativeElement,le(this,this.el,["ionChange","ionFocus","ionBlur","ionKnobMoveStart","ionKnobMoveEnd"])}};return E.\u0275fac=function(I){return new(I||E)(h.Y36(h.sBO),h.Y36(h.SBq),h.Y36(h.R0b))},E.\u0275cmp=h.Xpm({type:E,selectors:[["ion-range"]],inputs:{activeBarStart:"activeBarStart",color:"color",debounce:"debounce",disabled:"disabled",dualKnobs:"dualKnobs",max:"max",min:"min",mode:"mode",name:"name",pin:"pin",pinFormatter:"pinFormatter",snaps:"snaps",step:"step",ticks:"ticks",value:"value"},ngContentSelectors:qe,decls:1,vars:0,template:function(I,$){1&I&&(h.F$t(),h.Hsn(0))},encapsulation:2,changeDetection:0}),E=y([j({defineCustomElementFn:void 0,inputs:["activeBarStart","color","debounce","disabled","dualKnobs","max","min","mode","name","pin","pinFormatter","snaps","step","ticks","value"]})],E),E})(),fr=(()=>{let E=class{constructor(I,$,ve){this.z=ve,I.detach(),this.el=$.nativeElement,le(this,this.el,["ionRefresh","ionPull","ionStart"])}};return E.\u0275fac=function(I){return new(I||E)(h.Y36(h.sBO),h.Y36(h.SBq),h.Y36(h.R0b))},E.\u0275cmp=h.Xpm({type:E,selectors:[["ion-refresher"]],inputs:{closeDuration:"closeDuration",disabled:"disabled",pullFactor:"pullFactor",pullMax:"pullMax",pullMin:"pullMin",snapbackDuration:"snapbackDuration"},ngContentSelectors:qe,decls:1,vars:0,template:function(I,$){1&I&&(h.F$t(),h.Hsn(0))},encapsulation:2,changeDetection:0}),E=y([j({defineCustomElementFn:void 0,inputs:["closeDuration","disabled","pullFactor","pullMax","pullMin","snapbackDuration"],methods:["complete","cancel","getProgress"]})],E),E})(),es=(()=>{let E=class{constructor(I,$,ve){this.z=ve,I.detach(),this.el=$.nativeElement}};return E.\u0275fac=function(I){return new(I||E)(h.Y36(h.sBO),h.Y36(h.SBq),h.Y36(h.R0b))},E.\u0275cmp=h.Xpm({type:E,selectors:[["ion-refresher-content"]],inputs:{pullingIcon:"pullingIcon",pullingText:"pullingText",refreshingSpinner:"refreshingSpinner",refreshingText:"refreshingText"},ngContentSelectors:qe,decls:1,vars:0,template:function(I,$){1&I&&(h.F$t(),h.Hsn(0))},encapsulation:2,changeDetection:0}),E=y([j({defineCustomElementFn:void 0,inputs:["pullingIcon","pullingText","refreshingSpinner","refreshingText"]})],E),E})(),ia=(()=>{let E=class{constructor(I,$,ve){this.z=ve,I.detach(),this.el=$.nativeElement}};return E.\u0275fac=function(I){return new(I||E)(h.Y36(h.sBO),h.Y36(h.SBq),h.Y36(h.R0b))},E.\u0275cmp=h.Xpm({type:E,selectors:[["ion-row"]],ngContentSelectors:qe,decls:1,vars:0,template:function(I,$){1&I&&(h.F$t(),h.Hsn(0))},encapsulation:2,changeDetection:0}),E=y([j({defineCustomElementFn:void 0})],E),E})(),Io=(()=>{let E=class{constructor(I,$,ve){this.z=ve,I.detach(),this.el=$.nativeElement,le(this,this.el,["ionInput","ionChange","ionCancel","ionClear","ionBlur","ionFocus"])}};return E.\u0275fac=function(I){return new(I||E)(h.Y36(h.sBO),h.Y36(h.SBq),h.Y36(h.R0b))},E.\u0275cmp=h.Xpm({type:E,selectors:[["ion-searchbar"]],inputs:{animated:"animated",autocomplete:"autocomplete",autocorrect:"autocorrect",cancelButtonIcon:"cancelButtonIcon",cancelButtonText:"cancelButtonText",clearIcon:"clearIcon",color:"color",debounce:"debounce",disabled:"disabled",enterkeyhint:"enterkeyhint",inputmode:"inputmode",mode:"mode",placeholder:"placeholder",searchIcon:"searchIcon",showCancelButton:"showCancelButton",showClearButton:"showClearButton",spellcheck:"spellcheck",type:"type",value:"value"},ngContentSelectors:qe,decls:1,vars:0,template:function(I,$){1&I&&(h.F$t(),h.Hsn(0))},encapsulation:2,changeDetection:0}),E=y([j({defineCustomElementFn:void 0,inputs:["animated","autocomplete","autocorrect","cancelButtonIcon","cancelButtonText","clearIcon","color","debounce","disabled","enterkeyhint","inputmode","mode","placeholder","searchIcon","showCancelButton","showClearButton","spellcheck","type","value"],methods:["setFocus","getInputElement"]})],E),E})(),Dr=(()=>{let E=class{constructor(I,$,ve){this.z=ve,I.detach(),this.el=$.nativeElement,le(this,this.el,["ionChange"])}};return E.\u0275fac=function(I){return new(I||E)(h.Y36(h.sBO),h.Y36(h.SBq),h.Y36(h.R0b))},E.\u0275cmp=h.Xpm({type:E,selectors:[["ion-segment"]],inputs:{color:"color",disabled:"disabled",mode:"mode",scrollable:"scrollable",selectOnFocus:"selectOnFocus",swipeGesture:"swipeGesture",value:"value"},ngContentSelectors:qe,decls:1,vars:0,template:function(I,$){1&I&&(h.F$t(),h.Hsn(0))},encapsulation:2,changeDetection:0}),E=y([j({defineCustomElementFn:void 0,inputs:["color","disabled","mode","scrollable","selectOnFocus","swipeGesture","value"]})],E),E})(),Mo=(()=>{let E=class{constructor(I,$,ve){this.z=ve,I.detach(),this.el=$.nativeElement}};return E.\u0275fac=function(I){return new(I||E)(h.Y36(h.sBO),h.Y36(h.SBq),h.Y36(h.R0b))},E.\u0275cmp=h.Xpm({type:E,selectors:[["ion-segment-button"]],inputs:{disabled:"disabled",layout:"layout",mode:"mode",type:"type",value:"value"},ngContentSelectors:qe,decls:1,vars:0,template:function(I,$){1&I&&(h.F$t(),h.Hsn(0))},encapsulation:2,changeDetection:0}),E=y([j({defineCustomElementFn:void 0,inputs:["disabled","layout","mode","type","value"]})],E),E})(),Zr=(()=>{let E=class{constructor(I,$,ve){this.z=ve,I.detach(),this.el=$.nativeElement,le(this,this.el,["ionChange","ionCancel","ionDismiss","ionFocus","ionBlur"])}};return E.\u0275fac=function(I){return new(I||E)(h.Y36(h.sBO),h.Y36(h.SBq),h.Y36(h.R0b))},E.\u0275cmp=h.Xpm({type:E,selectors:[["ion-select"]],inputs:{cancelText:"cancelText",compareWith:"compareWith",disabled:"disabled",interface:"interface",interfaceOptions:"interfaceOptions",mode:"mode",multiple:"multiple",name:"name",okText:"okText",placeholder:"placeholder",selectedText:"selectedText",value:"value"},ngContentSelectors:qe,decls:1,vars:0,template:function(I,$){1&I&&(h.F$t(),h.Hsn(0))},encapsulation:2,changeDetection:0}),E=y([j({defineCustomElementFn:void 0,inputs:["cancelText","compareWith","disabled","interface","interfaceOptions","mode","multiple","name","okText","placeholder","selectedText","value"],methods:["open"]})],E),E})(),ra=(()=>{let E=class{constructor(I,$,ve){this.z=ve,I.detach(),this.el=$.nativeElement}};return E.\u0275fac=function(I){return new(I||E)(h.Y36(h.sBO),h.Y36(h.SBq),h.Y36(h.R0b))},E.\u0275cmp=h.Xpm({type:E,selectors:[["ion-select-option"]],inputs:{disabled:"disabled",value:"value"},ngContentSelectors:qe,decls:1,vars:0,template:function(I,$){1&I&&(h.F$t(),h.Hsn(0))},encapsulation:2,changeDetection:0}),E=y([j({defineCustomElementFn:void 0,inputs:["disabled","value"]})],E),E})(),so=(()=>{let E=class{constructor(I,$,ve){this.z=ve,I.detach(),this.el=$.nativeElement}};return E.\u0275fac=function(I){return new(I||E)(h.Y36(h.sBO),h.Y36(h.SBq),h.Y36(h.R0b))},E.\u0275cmp=h.Xpm({type:E,selectors:[["ion-spinner"]],inputs:{color:"color",duration:"duration",name:"name",paused:"paused"},ngContentSelectors:qe,decls:1,vars:0,template:function(I,$){1&I&&(h.F$t(),h.Hsn(0))},encapsulation:2,changeDetection:0}),E=y([j({defineCustomElementFn:void 0,inputs:["color","duration","name","paused"]})],E),E})(),ao=(()=>{let E=class{constructor(I,$,ve){this.z=ve,I.detach(),this.el=$.nativeElement,le(this,this.el,["ionSplitPaneVisible"])}};return E.\u0275fac=function(I){return new(I||E)(h.Y36(h.sBO),h.Y36(h.SBq),h.Y36(h.R0b))},E.\u0275cmp=h.Xpm({type:E,selectors:[["ion-split-pane"]],inputs:{contentId:"contentId",disabled:"disabled",when:"when"},ngContentSelectors:qe,decls:1,vars:0,template:function(I,$){1&I&&(h.F$t(),h.Hsn(0))},encapsulation:2,changeDetection:0}),E=y([j({defineCustomElementFn:void 0,inputs:["contentId","disabled","when"]})],E),E})(),ds=(()=>{let E=class{constructor(I,$,ve){this.z=ve,I.detach(),this.el=$.nativeElement,le(this,this.el,["ionChange","ionInput","ionBlur","ionFocus"])}};return E.\u0275fac=function(I){return new(I||E)(h.Y36(h.sBO),h.Y36(h.SBq),h.Y36(h.R0b))},E.\u0275cmp=h.Xpm({type:E,selectors:[["ion-textarea"]],inputs:{autoGrow:"autoGrow",autocapitalize:"autocapitalize",autofocus:"autofocus",clearOnEdit:"clearOnEdit",color:"color",cols:"cols",debounce:"debounce",disabled:"disabled",enterkeyhint:"enterkeyhint",inputmode:"inputmode",maxlength:"maxlength",minlength:"minlength",mode:"mode",name:"name",placeholder:"placeholder",readonly:"readonly",required:"required",rows:"rows",spellcheck:"spellcheck",value:"value",wrap:"wrap"},ngContentSelectors:qe,decls:1,vars:0,template:function(I,$){1&I&&(h.F$t(),h.Hsn(0))},encapsulation:2,changeDetection:0}),E=y([j({defineCustomElementFn:void 0,inputs:["autoGrow","autocapitalize","autofocus","clearOnEdit","color","cols","debounce","disabled","enterkeyhint","inputmode","maxlength","minlength","mode","name","placeholder","readonly","required","rows","spellcheck","value","wrap"],methods:["setFocus","getInputElement"]})],E),E})(),Bs=(()=>{let E=class{constructor(I,$,ve){this.z=ve,I.detach(),this.el=$.nativeElement}};return E.\u0275fac=function(I){return new(I||E)(h.Y36(h.sBO),h.Y36(h.SBq),h.Y36(h.R0b))},E.\u0275cmp=h.Xpm({type:E,selectors:[["ion-thumbnail"]],ngContentSelectors:qe,decls:1,vars:0,template:function(I,$){1&I&&(h.F$t(),h.Hsn(0))},encapsulation:2,changeDetection:0}),E=y([j({defineCustomElementFn:void 0})],E),E})(),oa=(()=>{let E=class{constructor(I,$,ve){this.z=ve,I.detach(),this.el=$.nativeElement}};return E.\u0275fac=function(I){return new(I||E)(h.Y36(h.sBO),h.Y36(h.SBq),h.Y36(h.R0b))},E.\u0275cmp=h.Xpm({type:E,selectors:[["ion-title"]],inputs:{color:"color",size:"size"},ngContentSelectors:qe,decls:1,vars:0,template:function(I,$){1&I&&(h.F$t(),h.Hsn(0))},encapsulation:2,changeDetection:0}),E=y([j({defineCustomElementFn:void 0,inputs:["color","size"]})],E),E})(),mo=(()=>{let E=class{constructor(I,$,ve){this.z=ve,I.detach(),this.el=$.nativeElement,le(this,this.el,["ionChange","ionFocus","ionBlur"])}};return E.\u0275fac=function(I){return new(I||E)(h.Y36(h.sBO),h.Y36(h.SBq),h.Y36(h.R0b))},E.\u0275cmp=h.Xpm({type:E,selectors:[["ion-toggle"]],inputs:{checked:"checked",color:"color",disabled:"disabled",enableOnOffLabels:"enableOnOffLabels",mode:"mode",name:"name",value:"value"},ngContentSelectors:qe,decls:1,vars:0,template:function(I,$){1&I&&(h.F$t(),h.Hsn(0))},encapsulation:2,changeDetection:0}),E=y([j({defineCustomElementFn:void 0,inputs:["checked","color","disabled","enableOnOffLabels","mode","name","value"]})],E),E})(),No=(()=>{let E=class{constructor(I,$,ve){this.z=ve,I.detach(),this.el=$.nativeElement}};return E.\u0275fac=function(I){return new(I||E)(h.Y36(h.sBO),h.Y36(h.SBq),h.Y36(h.R0b))},E.\u0275cmp=h.Xpm({type:E,selectors:[["ion-toolbar"]],inputs:{color:"color",mode:"mode"},ngContentSelectors:qe,decls:1,vars:0,template:function(I,$){1&I&&(h.F$t(),h.Hsn(0))},encapsulation:2,changeDetection:0}),E=y([j({defineCustomElementFn:void 0,inputs:["color","mode"]})],E),E})();class Ys{constructor(Z={}){this.data=Z}get(Z){return this.data[Z]}}let go=(()=>{class E{constructor(I,$){this.zone=I,this.appRef=$}create(I,$,ve){return new xa(I,$,ve,this.appRef,this.zone)}}return E.\u0275fac=function(I){return new(I||E)(h.LFG(h.R0b),h.LFG(h.z2F))},E.\u0275prov=h.Yz7({token:E,factory:E.\u0275fac}),E})();class xa{constructor(Z,I,$,ve,St){this.resolverOrInjector=Z,this.injector=I,this.location=$,this.appRef=ve,this.zone=St,this.elRefMap=new WeakMap,this.elEventsMap=new WeakMap}attachViewToDom(Z,I,$,ve){return this.zone.run(()=>new Promise(St=>{St(sa(this.zone,this.resolverOrInjector,this.injector,this.location,this.appRef,this.elRefMap,this.elEventsMap,Z,I,$,ve))}))}removeViewFromDom(Z,I){return this.zone.run(()=>new Promise($=>{const ve=this.elRefMap.get(I);if(ve){ve.destroy(),this.elRefMap.delete(I);const St=this.elEventsMap.get(I);St&&(St(),this.elEventsMap.delete(I))}$()}))}}const sa=(E,Z,I,$,ve,St,Cn,Zn,Ei,ii,Xi)=>{let ur;const or=h.zs3.create({providers:il(ii),parent:I});if(Z&&er(Z)){const Is=Z.resolveComponentFactory(Ei);ur=$?$.createComponent(Is,$.length,or):Is.create(or)}else{if(!$)return null;ur=$.createComponent(Ei,{index:$.indexOf,injector:or,environmentInjector:Z})}const uo=ur.instance,eo=ur.location.nativeElement;if(ii&&Object.assign(uo,ii),Xi)for(const Is of Xi)eo.classList.add(Is);const Ds=ba(E,uo,eo);return Zn.appendChild(eo),$||ve.attachView(ur.hostView),ur.changeDetectorRef.reattach(),St.set(eo,ur),Cn.set(eo,Ds),eo},Ao=[ht.L,ht.a,ht.b,ht.c,ht.d],ba=(E,Z,I)=>E.run(()=>{const $=Ao.filter(ve=>"function"==typeof Z[ve]).map(ve=>{const St=Cn=>Z[ve](Cn.detail);return I.addEventListener(ve,St),()=>I.removeEventListener(ve,St)});return()=>$.forEach(ve=>ve())}),zs=new h.OlP("NavParamsToken"),il=E=>[{provide:zs,useValue:E},{provide:Ys,useFactory:Uo,deps:[zs]}],Uo=E=>new Ys(E),bs=(E,Z)=>((E=E.filter(I=>I.stackId!==Z.stackId)).push(Z),E),Js=(E,Z)=>{const I=E.createUrlTree(["."],{relativeTo:Z});return E.serializeUrl(I)},ws=(E,Z)=>{if(!E)return;const I=Ns(Z);for(let $=0;$<I.length;$++){if($>=E.length)return I[$];if(I[$]!==E[$])return}},Ns=E=>E.split("/").map(Z=>Z.trim()).filter(Z=>""!==Z),qr=E=>{E&&(E.ref.destroy(),E.unlistenEvents())};class Hi{constructor(Z,I,$,ve,St,Cn){this.containerEl=I,this.router=$,this.navCtrl=ve,this.zone=St,this.location=Cn,this.views=[],this.skipTransition=!1,this.nextId=0,this.tabsPrefix=void 0!==Z?Ns(Z):void 0}createView(Z,I){var $;const ve=Js(this.router,I),St=null===($=Z?.location)||void 0===$?void 0:$.nativeElement,Cn=ba(this.zone,Z.instance,St);return{id:this.nextId++,stackId:ws(this.tabsPrefix,ve),unlistenEvents:Cn,element:St,ref:Z,url:ve}}getExistingView(Z){const I=Js(this.router,Z),$=this.views.find(ve=>ve.url===I);return $&&$.ref.changeDetectorRef.reattach(),$}setActive(Z){var I,$;const ve=this.navCtrl.consumeTransition();let{direction:St,animation:Cn,animationBuilder:Zn}=ve;const Ei=this.activeView,ii=((E,Z)=>!Z||E.stackId!==Z.stackId)(Z,Ei);ii&&(St="back",Cn=void 0);const Xi=this.views.slice();let ur;const or=this.router;or.getCurrentNavigation?ur=or.getCurrentNavigation():!(null===(I=or.navigations)||void 0===I)&&I.value&&(ur=or.navigations.value),null!==($=ur?.extras)&&void 0!==$&&$.replaceUrl&&this.views.length>0&&this.views.splice(-1,1);const uo=this.views.includes(Z),eo=this.insertView(Z,St);uo||Z.ref.changeDetectorRef.detectChanges();const Ds=Z.animationBuilder;return void 0===Zn&&"back"===St&&!ii&&void 0!==Ds&&(Zn=Ds),Ei&&(Ei.animationBuilder=Zn),this.zone.runOutsideAngular(()=>this.wait(()=>(Ei&&Ei.ref.changeDetectorRef.detach(),Z.ref.changeDetectorRef.reattach(),this.transition(Z,Ei,Cn,this.canGoBack(1),!1,Zn).then(()=>Us(Z,eo,Xi,this.location,this.zone)).then(()=>({enteringView:Z,direction:St,animation:Cn,tabSwitch:ii})))))}canGoBack(Z,I=this.getActiveStackId()){return this.getStack(I).length>Z}pop(Z,I=this.getActiveStackId()){return this.zone.run(()=>{var $,ve;const St=this.getStack(I);if(St.length<=Z)return Promise.resolve(!1);const Cn=St[St.length-Z-1];let Zn=Cn.url;const Ei=Cn.savedData;if(Ei){const Xi=Ei.get("primary");null!==(ve=null===($=Xi?.route)||void 0===$?void 0:$._routerState)&&void 0!==ve&&ve.snapshot.url&&(Zn=Xi.route._routerState.snapshot.url)}const{animationBuilder:ii}=this.navCtrl.consumeTransition();return this.navCtrl.navigateBack(Zn,Object.assign(Object.assign({},Cn.savedExtras),{animation:ii})).then(()=>!0)})}startBackTransition(){const Z=this.activeView;if(Z){const I=this.getStack(Z.stackId),$=I[I.length-2],ve=$.animationBuilder;return this.wait(()=>this.transition($,Z,"back",this.canGoBack(2),!0,ve))}return Promise.resolve()}endBackTransition(Z){Z?(this.skipTransition=!0,this.pop(1)):this.activeView&&Cs(this.activeView,this.views,this.views,this.location,this.zone)}getLastUrl(Z){const I=this.getStack(Z);return I.length>0?I[I.length-1]:void 0}getRootUrl(Z){const I=this.getStack(Z);return I.length>0?I[0]:void 0}getActiveStackId(){return this.activeView?this.activeView.stackId:void 0}hasRunningTask(){return void 0!==this.runningTask}destroy(){this.containerEl=void 0,this.views.forEach(qr),this.activeView=void 0,this.views=[]}getStack(Z){return this.views.filter(I=>I.stackId===Z)}insertView(Z,I){return this.activeView=Z,this.views=((E,Z,I)=>"root"===I?bs(E,Z):"forward"===I?((E,Z)=>(E.indexOf(Z)>=0?E=E.filter($=>$.stackId!==Z.stackId||$.id<=Z.id):E.push(Z),E))(E,Z):((E,Z)=>E.indexOf(Z)>=0?E.filter($=>$.stackId!==Z.stackId||$.id<=Z.id):bs(E,Z))(E,Z))(this.views,Z,I),this.views.slice()}transition(Z,I,$,ve,St,Cn){if(this.skipTransition)return this.skipTransition=!1,Promise.resolve(!1);if(I===Z)return Promise.resolve(!1);const Zn=Z?Z.element:void 0,Ei=I?I.element:void 0,ii=this.containerEl;return Zn&&Zn!==Ei&&(Zn.classList.add("ion-page"),Zn.classList.add("ion-page-invisible"),Zn.parentElement!==ii&&ii.appendChild(Zn),ii.commit)?ii.commit(Zn,Ei,{deepWait:!0,duration:void 0===$?0:void 0,direction:$,showGoBack:ve,progressAnimation:St,animationBuilder:Cn}):Promise.resolve(!1)}wait(Z){return Ge(this,void 0,void 0,function*(){void 0!==this.runningTask&&(yield this.runningTask,this.runningTask=void 0);const I=this.runningTask=Z();return I.finally(()=>this.runningTask=void 0),I})}}const Us=(E,Z,I,$,ve)=>"function"==typeof requestAnimationFrame?new Promise(St=>{requestAnimationFrame(()=>{Cs(E,Z,I,$,ve),St()})}):Promise.resolve(),Cs=(E,Z,I,$,ve)=>{ve.run(()=>I.filter(St=>!Z.includes(St)).forEach(qr)),Z.forEach(St=>{const Zn=$.path().split("?")[0].split("#")[0];if(St!==E&&St.url!==Zn){const Ei=St.element;Ei.setAttribute("aria-hidden","true"),Ei.classList.add("ion-page-hidden"),St.ref.changeDetectorRef.detach()}})};let Vs=(()=>{class E{get(I,$){const ve=Ts();return ve?ve.get(I,$):null}getBoolean(I,$){const ve=Ts();return!!ve&&ve.getBoolean(I,$)}getNumber(I,$){const ve=Ts();return ve?ve.getNumber(I,$):0}}return E.\u0275fac=function(I){return new(I||E)},E.\u0275prov=h.Yz7({token:E,factory:E.\u0275fac,providedIn:"root"}),E})();const ns=new h.OlP("USERCONFIG"),Ts=()=>{if(typeof window<"u"){const E=window.Ionic;if(E?.config)return E.config}return null};let hs=(()=>{class E{constructor(I,$){this.doc=I,this.backButton=new Ee.x,this.keyboardDidShow=new Ee.x,this.keyboardDidHide=new Ee.x,this.pause=new Ee.x,this.resume=new Ee.x,this.resize=new Ee.x,$.run(()=>{var ve;let St;this.win=I.defaultView,this.backButton.subscribeWithPriority=function(Cn,Zn){return this.subscribe(Ei=>Ei.register(Cn,ii=>$.run(()=>Zn(ii))))},ps(this.pause,I,"pause"),ps(this.resume,I,"resume"),ps(this.backButton,I,"ionBackButton"),ps(this.resize,this.win,"resize"),ps(this.keyboardDidShow,this.win,"ionKeyboardDidShow"),ps(this.keyboardDidHide,this.win,"ionKeyboardDidHide"),this._readyPromise=new Promise(Cn=>{St=Cn}),null!==(ve=this.win)&&void 0!==ve&&ve.cordova?I.addEventListener("deviceready",()=>{St("cordova")},{once:!0}):St("dom")})}is(I){return(0,bt.a)(this.win,I)}platforms(){return(0,bt.g)(this.win)}ready(){return this._readyPromise}get isRTL(){return"rtl"===this.doc.dir}getQueryParam(I){return Po(this.win.location.href,I)}isLandscape(){return!this.isPortrait()}isPortrait(){var I,$;return null===($=(I=this.win).matchMedia)||void 0===$?void 0:$.call(I,"(orientation: portrait)").matches}testUserAgent(I){const $=this.win.navigator;return!!($?.userAgent&&$.userAgent.indexOf(I)>=0)}url(){return this.win.location.href}width(){return this.win.innerWidth}height(){return this.win.innerHeight}}return E.\u0275fac=function(I){return new(I||E)(h.LFG(Ii.K0),h.LFG(h.R0b))},E.\u0275prov=h.Yz7({token:E,factory:E.\u0275fac,providedIn:"root"}),E})();const Po=(E,Z)=>{Z=Z.replace(/[[\]\\]/g,"\\$&");const $=new RegExp("[\\?&]"+Z+"=([^&#]*)").exec(E);return $?decodeURIComponent($[1].replace(/\+/g," ")):null},ps=(E,Z,I)=>{Z&&Z.addEventListener(I,$=>{E.next($?.detail)})};let fs=(()=>{class E{constructor(I,$,ve,St){this.location=$,this.serializer=ve,this.router=St,this.direction=Es,this.animated=ji,this.guessDirection="forward",this.lastNavId=-1,St&&St.events.subscribe(Cn=>{if(Cn instanceof Et.OD){const Zn=Cn.restoredState?Cn.restoredState.navigationId:Cn.id;this.guessDirection=Zn<this.lastNavId?"back":"forward",this.guessAnimation=Cn.restoredState?void 0:this.guessDirection,this.lastNavId="forward"===this.guessDirection?Cn.id:Zn}}),I.backButton.subscribeWithPriority(0,Cn=>{this.pop(),Cn()})}navigateForward(I,$={}){return this.setDirection("forward",$.animated,$.animationDirection,$.animation),this.navigate(I,$)}navigateBack(I,$={}){return this.setDirection("back",$.animated,$.animationDirection,$.animation),this.navigate(I,$)}navigateRoot(I,$={}){return this.setDirection("root",$.animated,$.animationDirection,$.animation),this.navigate(I,$)}back(I={animated:!0,animationDirection:"back"}){return this.setDirection("back",I.animated,I.animationDirection,I.animation),this.location.back()}pop(){return Ge(this,void 0,void 0,function*(){let I=this.topOutlet;for(;I&&!(yield I.pop());)I=I.parentOutlet})}setDirection(I,$,ve,St){this.direction=I,this.animated=Tr(I,$,ve),this.animationBuilder=St}setTopOutlet(I){this.topOutlet=I}consumeTransition(){let $,I="root";const ve=this.animationBuilder;return"auto"===this.direction?(I=this.guessDirection,$=this.guessAnimation):($=this.animated,I=this.direction),this.direction=Es,this.animated=ji,this.animationBuilder=void 0,{direction:I,animation:$,animationBuilder:ve}}navigate(I,$){if(Array.isArray(I))return this.router.navigate(I,$);{const ve=this.serializer.parse(I.toString());return void 0!==$.queryParams&&(ve.queryParams=Object.assign({},$.queryParams)),void 0!==$.fragment&&(ve.fragment=$.fragment),this.router.navigateByUrl(ve,$)}}}return E.\u0275fac=function(I){return new(I||E)(h.LFG(hs),h.LFG(Ii.Ye),h.LFG(Et.Hx),h.LFG(Et.F0,8))},E.\u0275prov=h.Yz7({token:E,factory:E.\u0275fac,providedIn:"root"}),E})();const Tr=(E,Z,I)=>{if(!1!==Z){if(void 0!==I)return I;if("forward"===E||"back"===E)return E;if("root"===E&&!0===Z)return"forward"}},Es="auto",ji=void 0;let zr=(()=>{class E{constructor(I,$,ve,St,Cn,Zn,Ei,ii,Xi,ur,or,uo,eo){this.parentContexts=I,this.location=$,this.config=Cn,this.navCtrl=Zn,this.componentFactoryResolver=Ei,this.parentOutlet=eo,this.activated=null,this.activatedView=null,this._activatedRoute=null,this.proxyMap=new WeakMap,this.currentActivatedRoute$=new vt.X(null),this.stackEvents=new h.vpe,this.activateEvents=new h.vpe,this.deactivateEvents=new h.vpe,this.nativeEl=Xi.nativeElement,this.name=ve||Et.eC,this.tabsPrefix="true"===St?Js(ur,uo):void 0,this.stackCtrl=new Hi(this.tabsPrefix,this.nativeEl,ur,Zn,or,ii),I.onChildOutletCreated(this.name,this)}set animation(I){this.nativeEl.animation=I}set animated(I){this.nativeEl.animated=I}set swipeGesture(I){this._swipeGesture=I,this.nativeEl.swipeHandler=I?{canStart:()=>this.stackCtrl.canGoBack(1)&&!this.stackCtrl.hasRunningTask(),onStart:()=>this.stackCtrl.startBackTransition(),onEnd:$=>this.stackCtrl.endBackTransition($)}:void 0}ngOnDestroy(){this.stackCtrl.destroy()}getContext(){return this.parentContexts.getContext(this.name)}ngOnInit(){if(!this.activated){const I=this.getContext();I?.route&&this.activateWith(I.route,I.resolver||null)}new Promise(I=>(0,ct.c)(this.nativeEl,I)).then(()=>{void 0===this._swipeGesture&&(this.swipeGesture=this.config.getBoolean("swipeBackEnabled","ios"===this.nativeEl.mode))})}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Error("Outlet is not activated");return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Error("Outlet is not activated");return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){throw new Error("incompatible reuse strategy")}attach(I,$){throw new Error("incompatible reuse strategy")}deactivate(){if(this.activated){if(this.activatedView){const $=this.getContext();this.activatedView.savedData=new Map($.children.contexts);const ve=this.activatedView.savedData.get("primary");if(ve&&$.route&&(ve.route=Object.assign({},$.route)),this.activatedView.savedExtras={},$.route){const St=$.route.snapshot;this.activatedView.savedExtras.queryParams=St.queryParams,this.activatedView.savedExtras.fragment=St.fragment}}const I=this.component;this.activatedView=null,this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(I)}}activateWith(I,$){var ve;if(this.isActivated)throw new Error("Cannot activate an already activated outlet");this._activatedRoute=I;let St,Cn=this.stackCtrl.getExistingView(I);if(Cn){St=this.activated=Cn.ref;const Zn=Cn.savedData;Zn&&(this.getContext().children.contexts=Zn),this.updateActivatedRouteProxy(St.instance,I)}else{const Zn=I._futureSnapshot;if(null==Zn.routeConfig.component&&null==this.environmentInjector)return void console.warn('[Ionic Warning]: You must supply an environmentInjector to use standalone components with routing:\n\nIn your component class, add:\n\n   import { EnvironmentInjector } from \'@angular/core\';\n   constructor(public environmentInjector: EnvironmentInjector) {}\n\nIn your router outlet template, add:\n\n   <ion-router-outlet [environmentInjector]="environmentInjector"></ion-router-outlet>\n\nAlternatively, if you are routing within ion-tabs:\n\n   <ion-tabs [environmentInjector]="environmentInjector"></ion-tabs>');const Ei=this.parentContexts.getOrCreateContext(this.name).children,ii=new vt.X(null),Xi=this.createActivatedRouteProxy(ii,I),ur=new wa(Xi,Ei,this.location.injector),or=null!==(ve=Zn.routeConfig.component)&&void 0!==ve?ve:Zn.component;if(($=$||this.componentFactoryResolver)&&er($)){const uo=$.resolveComponentFactory(or);St=this.activated=this.location.createComponent(uo,this.location.length,ur)}else St=this.activated=this.location.createComponent(or,{index:this.location.length,injector:ur,environmentInjector:$??this.environmentInjector});ii.next(St.instance),Cn=this.stackCtrl.createView(this.activated,I),this.proxyMap.set(St.instance,Xi),this.currentActivatedRoute$.next({component:St.instance,activatedRoute:I})}this.activatedView=Cn,this.navCtrl.setTopOutlet(this),this.stackCtrl.setActive(Cn).then(Zn=>{this.activateEvents.emit(St.instance),this.stackEvents.emit(Zn)})}canGoBack(I=1,$){return this.stackCtrl.canGoBack(I,$)}pop(I=1,$){return this.stackCtrl.pop(I,$)}getLastUrl(I){const $=this.stackCtrl.getLastUrl(I);return $?$.url:void 0}getLastRouteView(I){return this.stackCtrl.getLastUrl(I)}getRootView(I){return this.stackCtrl.getRootUrl(I)}getActiveStackId(){return this.stackCtrl.getActiveStackId()}createActivatedRouteProxy(I,$){const ve=new Et.gz;return ve._futureSnapshot=$._futureSnapshot,ve._routerState=$._routerState,ve.snapshot=$.snapshot,ve.outlet=$.outlet,ve.component=$.component,ve._paramMap=this.proxyObservable(I,"paramMap"),ve._queryParamMap=this.proxyObservable(I,"queryParamMap"),ve.url=this.proxyObservable(I,"url"),ve.params=this.proxyObservable(I,"params"),ve.queryParams=this.proxyObservable(I,"queryParams"),ve.fragment=this.proxyObservable(I,"fragment"),ve.data=this.proxyObservable(I,"data"),ve}proxyObservable(I,$){return I.pipe((0,ni.h)(ve=>!!ve),(0,ci.w)(ve=>this.currentActivatedRoute$.pipe((0,ni.h)(St=>null!==St&&St.component===ve),(0,ci.w)(St=>St&&St.activatedRoute[$]),function xi(E,Z=Un.y){return E=E??Ni,(0,_i.e)((I,$)=>{let ve,St=!0;I.subscribe((0,wi.x)($,Cn=>{const Zn=Z(Cn);(St||!E(ve,Zn))&&(St=!1,ve=Zn,$.next(Cn))}))})}())))}updateActivatedRouteProxy(I,$){const ve=this.proxyMap.get(I);if(!ve)throw new Error("Could not find activated route proxy for view");ve._futureSnapshot=$._futureSnapshot,ve._routerState=$._routerState,ve.snapshot=$.snapshot,ve.outlet=$.outlet,ve.component=$.component,this.currentActivatedRoute$.next({component:I,activatedRoute:$})}}return E.\u0275fac=function(I){return new(I||E)(h.Y36(Et.y6),h.Y36(h.s_b),h.$8M("name"),h.$8M("tabs"),h.Y36(Vs),h.Y36(fs),h.Y36(h._Vd,8),h.Y36(Ii.Ye),h.Y36(h.SBq),h.Y36(Et.F0),h.Y36(h.R0b),h.Y36(Et.gz),h.Y36(E,12))},E.\u0275dir=h.lG2({type:E,selectors:[["ion-router-outlet"]],inputs:{animated:"animated",animation:"animation",mode:"mode",swipeGesture:"swipeGesture",environmentInjector:"environmentInjector"},outputs:{stackEvents:"stackEvents",activateEvents:"activate",deactivateEvents:"deactivate"},exportAs:["outlet"]}),E})();class wa{constructor(Z,I,$){this.route=Z,this.childContexts=I,this.parent=$}get(Z,I){return Z===Et.gz?this.route:Z===Et.y6?this.childContexts:this.parent.get(Z,I)}}let ms=(()=>{class E{constructor(I,$,ve){this.routerOutlet=I,this.navCtrl=$,this.config=ve}onClick(I){var $;const ve=this.defaultHref||this.config.get("backButtonDefaultHref");null!==($=this.routerOutlet)&&void 0!==$&&$.canGoBack()?(this.navCtrl.setDirection("back",void 0,void 0,this.routerAnimation),this.routerOutlet.pop(),I.preventDefault()):null!=ve&&(this.navCtrl.navigateBack(ve,{animation:this.routerAnimation}),I.preventDefault())}}return E.\u0275fac=function(I){return new(I||E)(h.Y36(zr,8),h.Y36(fs),h.Y36(Vs))},E.\u0275dir=h.lG2({type:E,selectors:[["ion-back-button"]],hostBindings:function(I,$){1&I&&h.NdJ("click",function(St){return $.onClick(St)})},inputs:{defaultHref:"defaultHref",routerAnimation:"routerAnimation"}}),E})(),ka=(()=>{class E{constructor(I,$,ve,St,Cn){this.locationStrategy=I,this.navCtrl=$,this.elementRef=ve,this.router=St,this.routerLink=Cn,this.routerDirection="forward"}ngOnInit(){this.updateTargetUrlAndHref()}ngOnChanges(){this.updateTargetUrlAndHref()}updateTargetUrlAndHref(){var I;if(null!==(I=this.routerLink)&&void 0!==I&&I.urlTree){const $=this.locationStrategy.prepareExternalUrl(this.router.serializeUrl(this.routerLink.urlTree));this.elementRef.nativeElement.href=$}}onClick(I){this.navCtrl.setDirection(this.routerDirection,void 0,void 0,this.routerAnimation),I.preventDefault()}}return E.\u0275fac=function(I){return new(I||E)(h.Y36(Ii.S$),h.Y36(fs),h.Y36(h.SBq),h.Y36(Et.F0),h.Y36(Et.rH,8))},E.\u0275dir=h.lG2({type:E,selectors:[["","routerLink","",5,"a",5,"area"]],hostBindings:function(I,$){1&I&&h.NdJ("click",function(St){return $.onClick(St)})},inputs:{routerDirection:"routerDirection",routerAnimation:"routerAnimation"},features:[h.TTD]}),E})();class Nr{constructor(Z){this.ctrl=Z}create(Z){return this.ctrl.create(Z||{})}dismiss(Z,I,$){return this.ctrl.dismiss(Z,I,$)}getTop(){return this.ctrl.getTop()}}let lo=(()=>{class E extends Nr{constructor(){super(Ct.b)}}return E.\u0275fac=function(I){return new(I||E)},E.\u0275prov=h.Yz7({token:E,factory:E.\u0275fac,providedIn:"root"}),E})(),Vo=(()=>{class E extends Nr{constructor(){super(Ct.a)}}return E.\u0275fac=function(I){return new(I||E)},E.\u0275prov=h.Yz7({token:E,factory:E.\u0275fac,providedIn:"root"}),E})(),la=(()=>{class E extends Nr{constructor(){super(Ct.l)}}return E.\u0275fac=function(I){return new(I||E)},E.\u0275prov=h.Yz7({token:E,factory:E.\u0275fac,providedIn:"root"}),E})();class Dn{}let Ji=(()=>{class E extends Nr{constructor(I,$,ve,St){super(Ct.m),this.angularDelegate=I,this.resolver=$,this.injector=ve,this.environmentInjector=St}create(I){var $;return super.create(Object.assign(Object.assign({},I),{delegate:this.angularDelegate.create(null!==($=this.resolver)&&void 0!==$?$:this.environmentInjector,this.injector)}))}}return E.\u0275fac=function(I){return new(I||E)(h.LFG(go),h.LFG(h._Vd),h.LFG(h.zs3),h.LFG(Dn,8))},E.\u0275prov=h.Yz7({token:E,factory:E.\u0275fac}),E})(),Il=(()=>{class E extends Nr{constructor(I,$,ve,St){super(Ct.c),this.angularDelegate=I,this.resolver=$,this.injector=ve,this.environmentInjector=St}create(I){var $;return super.create(Object.assign(Object.assign({},I),{delegate:this.angularDelegate.create(null!==($=this.resolver)&&void 0!==$?$:this.environmentInjector,this.injector)}))}}return E.\u0275fac=function(I){return new(I||E)(h.LFG(go),h.LFG(h._Vd),h.LFG(h.zs3),h.LFG(Dn,8))},E.\u0275prov=h.Yz7({token:E,factory:E.\u0275fac}),E})(),Ml=(()=>{class E extends Nr{constructor(){super(Ct.t)}}return E.\u0275fac=function(I){return new(I||E)},E.\u0275prov=h.Yz7({token:E,factory:E.\u0275fac,providedIn:"root"}),E})();class Xs{shouldDetach(Z){return!1}shouldAttach(Z){return!1}store(Z,I){}retrieve(Z){return null}shouldReuseRoute(Z,I){if(Z.routeConfig!==I.routeConfig)return!1;const $=Z.params,ve=I.params,St=Object.keys($),Cn=Object.keys(ve);if(St.length!==Cn.length)return!1;for(const Zn of St)if(ve[Zn]!==$[Zn])return!1;return!0}}const ua=(E,Z,I)=>()=>{if(Z.defaultView&&typeof window<"u"){(E=>{const Z=window,I=Z.Ionic;I&&I.config&&"Object"!==I.config.constructor.name||(Z.Ionic=Z.Ionic||{},Z.Ionic.config=Object.assign(Object.assign({},Z.Ionic.config),E))})(Object.assign(Object.assign({},E),{_zoneGate:St=>I.run(St)}));const ve="__zone_symbol__addEventListener"in Z.body?"__zone_symbol__addEventListener":"addEventListener";return function Ui(){var E=[];if(typeof window<"u"){var Z=window;(!Z.customElements||Z.Element&&(!Z.Element.prototype.closest||!Z.Element.prototype.matches||!Z.Element.prototype.remove||!Z.Element.prototype.getRootNode))&&E.push(B.e(6748).then(B.t.bind(B,723,23))),("function"!=typeof Object.assign||!Object.entries||!Array.prototype.find||!Array.prototype.includes||!String.prototype.startsWith||!String.prototype.endsWith||Z.NodeList&&!Z.NodeList.prototype.forEach||!Z.fetch||!function(){try{var $=new URL("b","http://a");return $.pathname="c%20d","http://a/c%20d"===$.href&&$.searchParams}catch{return!1}}()||typeof WeakMap>"u")&&E.push(B.e(2214).then(B.t.bind(B,4144,23)))}return Promise.all(E)}().then(()=>((E,Z)=>typeof window>"u"?Promise.resolve():(0,wn.p)().then(()=>(Yi(),(0,wn.b)(JSON.parse('[["ion-menu_3",[[33,"ion-menu-button",{"color":[513],"disabled":[4],"menu":[1],"autoHide":[4,"auto-hide"],"type":[1],"visible":[32]},[[16,"ionMenuChange","visibilityChanged"],[16,"ionSplitPaneVisible","visibilityChanged"]]],[33,"ion-menu",{"contentId":[513,"content-id"],"menuId":[513,"menu-id"],"type":[1025],"disabled":[1028],"side":[513],"swipeGesture":[4,"swipe-gesture"],"maxEdgeStart":[2,"max-edge-start"],"isPaneVisible":[32],"isEndSide":[32],"isOpen":[64],"isActive":[64],"open":[64],"close":[64],"toggle":[64],"setOpen":[64]},[[16,"ionSplitPaneVisible","onSplitPaneChanged"],[2,"click","onBackdropClick"],[0,"keydown","onKeydown"]]],[1,"ion-menu-toggle",{"menu":[1],"autoHide":[4,"auto-hide"],"visible":[32]},[[16,"ionMenuChange","visibilityChanged"],[16,"ionSplitPaneVisible","visibilityChanged"]]]]],["ion-fab_3",[[33,"ion-fab-button",{"color":[513],"activated":[4],"disabled":[4],"download":[1],"href":[1],"rel":[1],"routerDirection":[1,"router-direction"],"routerAnimation":[16],"target":[1],"show":[4],"translucent":[4],"type":[1],"size":[1],"closeIcon":[1,"close-icon"]}],[1,"ion-fab",{"horizontal":[1],"vertical":[1],"edge":[4],"activated":[1028],"close":[64],"toggle":[64]}],[1,"ion-fab-list",{"activated":[4],"side":[1]}]]],["ion-refresher_2",[[0,"ion-refresher-content",{"pullingIcon":[1025,"pulling-icon"],"pullingText":[1,"pulling-text"],"refreshingSpinner":[1025,"refreshing-spinner"],"refreshingText":[1,"refreshing-text"]}],[32,"ion-refresher",{"pullMin":[2,"pull-min"],"pullMax":[2,"pull-max"],"closeDuration":[1,"close-duration"],"snapbackDuration":[1,"snapback-duration"],"pullFactor":[2,"pull-factor"],"disabled":[4],"nativeRefresher":[32],"state":[32],"complete":[64],"cancel":[64],"getProgress":[64]}]]],["ion-back-button",[[33,"ion-back-button",{"color":[513],"defaultHref":[1025,"default-href"],"disabled":[516],"icon":[1],"text":[1],"type":[1],"routerAnimation":[16]}]]],["ion-toast",[[33,"ion-toast",{"overlayIndex":[2,"overlay-index"],"color":[513],"enterAnimation":[16],"leaveAnimation":[16],"cssClass":[1,"css-class"],"duration":[2],"header":[1],"message":[1],"keyboardClose":[4,"keyboard-close"],"position":[1],"buttons":[16],"translucent":[4],"animated":[4],"icon":[1],"htmlAttributes":[16],"present":[64],"dismiss":[64],"onDidDismiss":[64],"onWillDismiss":[64]}]]],["ion-card_5",[[33,"ion-card",{"color":[513],"button":[4],"type":[1],"disabled":[4],"download":[1],"href":[1],"rel":[1],"routerDirection":[1,"router-direction"],"routerAnimation":[16],"target":[1]}],[32,"ion-card-content"],[33,"ion-card-header",{"color":[513],"translucent":[4]}],[33,"ion-card-subtitle",{"color":[513]}],[33,"ion-card-title",{"color":[513]}]]],["ion-item-option_3",[[33,"ion-item-option",{"color":[513],"disabled":[4],"download":[1],"expandable":[4],"href":[1],"rel":[1],"target":[1],"type":[1]}],[32,"ion-item-options",{"side":[1],"fireSwipeEvent":[64]}],[0,"ion-item-sliding",{"disabled":[4],"state":[32],"getOpenAmount":[64],"getSlidingRatio":[64],"open":[64],"close":[64],"closeOpened":[64]}]]],["ion-accordion_2",[[49,"ion-accordion",{"value":[1],"disabled":[4],"readonly":[4],"toggleIcon":[1,"toggle-icon"],"toggleIconSlot":[1,"toggle-icon-slot"],"state":[32],"isNext":[32],"isPrevious":[32]}],[33,"ion-accordion-group",{"animated":[4],"multiple":[4],"value":[1025],"disabled":[4],"readonly":[4],"expand":[1],"requestAccordionToggle":[64],"getAccordions":[64]},[[0,"keydown","onKeydown"]]]]],["ion-breadcrumb_2",[[33,"ion-breadcrumb",{"collapsed":[4],"last":[4],"showCollapsedIndicator":[4,"show-collapsed-indicator"],"color":[1],"active":[4],"disabled":[4],"download":[1],"href":[1],"rel":[1],"separator":[4],"target":[1],"routerDirection":[1,"router-direction"],"routerAnimation":[16]}],[33,"ion-breadcrumbs",{"color":[1],"maxItems":[2,"max-items"],"itemsBeforeCollapse":[2,"items-before-collapse"],"itemsAfterCollapse":[2,"items-after-collapse"],"collapsed":[32],"activeChanged":[32]},[[0,"collapsedClick","onCollapsedClick"]]]]],["ion-infinite-scroll_2",[[32,"ion-infinite-scroll-content",{"loadingSpinner":[1025,"loading-spinner"],"loadingText":[1,"loading-text"]}],[0,"ion-infinite-scroll",{"threshold":[1],"disabled":[4],"position":[1],"isLoading":[32],"complete":[64]}]]],["ion-reorder_2",[[33,"ion-reorder",null,[[2,"click","onClick"]]],[0,"ion-reorder-group",{"disabled":[4],"state":[32],"complete":[64]}]]],["ion-segment_2",[[33,"ion-segment-button",{"disabled":[4],"layout":[1],"type":[1],"value":[1],"checked":[32]}],[33,"ion-segment",{"color":[513],"disabled":[4],"scrollable":[4],"swipeGesture":[4,"swipe-gesture"],"value":[1025],"selectOnFocus":[4,"select-on-focus"],"activated":[32]},[[0,"keydown","onKeyDown"]]]]],["ion-tab-bar_2",[[33,"ion-tab-button",{"disabled":[4],"download":[1],"href":[1],"rel":[1],"layout":[1025],"selected":[1028],"tab":[1],"target":[1]},[[8,"ionTabBarChanged","onTabBarChanged"]]],[33,"ion-tab-bar",{"color":[513],"selectedTab":[1,"selected-tab"],"translucent":[4],"keyboardVisible":[32]}]]],["ion-chip",[[1,"ion-chip",{"color":[513],"outline":[4],"disabled":[4]}]]],["ion-datetime-button",[[33,"ion-datetime-button",{"color":[513],"disabled":[516],"datetime":[1],"datetimePresentation":[32],"dateText":[32],"timeText":[32],"datetimeActive":[32],"selectedButton":[32]}]]],["ion-input",[[34,"ion-input",{"fireFocusEvents":[4,"fire-focus-events"],"color":[513],"accept":[1],"autocapitalize":[1],"autocomplete":[1],"autocorrect":[1],"autofocus":[4],"clearInput":[4,"clear-input"],"clearOnEdit":[4,"clear-on-edit"],"debounce":[2],"disabled":[4],"enterkeyhint":[1],"inputmode":[1],"max":[8],"maxlength":[2],"min":[8],"minlength":[2],"multiple":[4],"name":[1],"pattern":[1],"placeholder":[1],"readonly":[4],"required":[4],"spellcheck":[4],"step":[1],"size":[2],"type":[1],"value":[1032],"hasFocus":[32],"setFocus":[64],"setBlur":[64],"getInputElement":[64]}]]],["ion-searchbar",[[34,"ion-searchbar",{"color":[513],"animated":[4],"autocomplete":[1],"autocorrect":[1],"cancelButtonIcon":[1,"cancel-button-icon"],"cancelButtonText":[1,"cancel-button-text"],"clearIcon":[1,"clear-icon"],"debounce":[2],"disabled":[4],"inputmode":[1],"enterkeyhint":[1],"placeholder":[1],"searchIcon":[1,"search-icon"],"showCancelButton":[1,"show-cancel-button"],"showClearButton":[1,"show-clear-button"],"spellcheck":[4],"type":[1],"value":[1025],"focused":[32],"noAnimate":[32],"setFocus":[64],"getInputElement":[64]}]]],["ion-toggle",[[33,"ion-toggle",{"color":[513],"name":[1],"checked":[1028],"disabled":[4],"value":[1],"enableOnOffLabels":[4,"enable-on-off-labels"],"activated":[32]}]]],["ion-avatar_3",[[33,"ion-avatar"],[33,"ion-badge",{"color":[513]}],[1,"ion-thumbnail"]]],["ion-textarea",[[34,"ion-textarea",{"fireFocusEvents":[4,"fire-focus-events"],"color":[513],"autocapitalize":[1],"autofocus":[4],"clearOnEdit":[1028,"clear-on-edit"],"debounce":[2],"disabled":[4],"inputmode":[1],"enterkeyhint":[1],"maxlength":[2],"minlength":[2],"name":[1],"placeholder":[1],"readonly":[4],"required":[4],"spellcheck":[4],"cols":[2],"rows":[2],"wrap":[1],"autoGrow":[516,"auto-grow"],"value":[1025],"hasFocus":[32],"setFocus":[64],"setBlur":[64],"getInputElement":[64]}]]],["ion-backdrop",[[33,"ion-backdrop",{"visible":[4],"tappable":[4],"stopPropagation":[4,"stop-propagation"]},[[2,"click","onMouseDown"]]]]],["ion-loading",[[34,"ion-loading",{"overlayIndex":[2,"overlay-index"],"keyboardClose":[4,"keyboard-close"],"enterAnimation":[16],"leaveAnimation":[16],"message":[1],"cssClass":[1,"css-class"],"duration":[2],"backdropDismiss":[4,"backdrop-dismiss"],"showBackdrop":[4,"show-backdrop"],"spinner":[1025],"translucent":[4],"animated":[4],"htmlAttributes":[16],"present":[64],"dismiss":[64],"onDidDismiss":[64],"onWillDismiss":[64]}]]],["ion-modal",[[33,"ion-modal",{"hasController":[4,"has-controller"],"overlayIndex":[2,"overlay-index"],"delegate":[16],"keyboardClose":[4,"keyboard-close"],"enterAnimation":[16],"leaveAnimation":[16],"breakpoints":[16],"initialBreakpoint":[2,"initial-breakpoint"],"backdropBreakpoint":[2,"backdrop-breakpoint"],"handle":[4],"handleBehavior":[1,"handle-behavior"],"component":[1],"componentProps":[16],"cssClass":[1,"css-class"],"backdropDismiss":[4,"backdrop-dismiss"],"showBackdrop":[4,"show-backdrop"],"animated":[4],"swipeToClose":[4,"swipe-to-close"],"presentingElement":[16],"htmlAttributes":[16],"isOpen":[4,"is-open"],"trigger":[1],"keepContentsMounted":[4,"keep-contents-mounted"],"canDismiss":[4,"can-dismiss"],"presented":[32],"present":[64],"dismiss":[64],"onDidDismiss":[64],"onWillDismiss":[64],"setCurrentBreakpoint":[64],"getCurrentBreakpoint":[64]}]]],["ion-route_4",[[0,"ion-route",{"url":[1],"component":[1],"componentProps":[16],"beforeLeave":[16],"beforeEnter":[16]}],[0,"ion-route-redirect",{"from":[1],"to":[1]}],[0,"ion-router",{"root":[1],"useHash":[4,"use-hash"],"canTransition":[64],"push":[64],"back":[64],"printDebug":[64],"navChanged":[64]},[[8,"popstate","onPopState"],[4,"ionBackButton","onBackButton"]]],[1,"ion-router-link",{"color":[513],"href":[1],"rel":[1],"routerDirection":[1,"router-direction"],"routerAnimation":[16],"target":[1]}]]],["ion-col_3",[[1,"ion-col",{"offset":[1],"offsetXs":[1,"offset-xs"],"offsetSm":[1,"offset-sm"],"offsetMd":[1,"offset-md"],"offsetLg":[1,"offset-lg"],"offsetXl":[1,"offset-xl"],"pull":[1],"pullXs":[1,"pull-xs"],"pullSm":[1,"pull-sm"],"pullMd":[1,"pull-md"],"pullLg":[1,"pull-lg"],"pullXl":[1,"pull-xl"],"push":[1],"pushXs":[1,"push-xs"],"pushSm":[1,"push-sm"],"pushMd":[1,"push-md"],"pushLg":[1,"push-lg"],"pushXl":[1,"push-xl"],"size":[1],"sizeXs":[1,"size-xs"],"sizeSm":[1,"size-sm"],"sizeMd":[1,"size-md"],"sizeLg":[1,"size-lg"],"sizeXl":[1,"size-xl"]},[[9,"resize","onResize"]]],[1,"ion-grid",{"fixed":[4]}],[1,"ion-row"]]],["ion-nav_2",[[1,"ion-nav",{"delegate":[16],"swipeGesture":[1028,"swipe-gesture"],"animated":[4],"animation":[16],"rootParams":[16],"root":[1],"push":[64],"insert":[64],"insertPages":[64],"pop":[64],"popTo":[64],"popToRoot":[64],"removeIndex":[64],"setRoot":[64],"setPages":[64],"setRouteId":[64],"getRouteId":[64],"getActive":[64],"getByIndex":[64],"canGoBack":[64],"getPrevious":[64]}],[0,"ion-nav-link",{"component":[1],"componentProps":[16],"routerDirection":[1,"router-direction"],"routerAnimation":[16]}]]],["ion-slide_2",[[0,"ion-slide"],[36,"ion-slides",{"options":[8],"pager":[4],"scrollbar":[4],"update":[64],"updateAutoHeight":[64],"slideTo":[64],"slideNext":[64],"slidePrev":[64],"getActiveIndex":[64],"getPreviousIndex":[64],"length":[64],"isEnd":[64],"isBeginning":[64],"startAutoplay":[64],"stopAutoplay":[64],"lockSwipeToNext":[64],"lockSwipeToPrev":[64],"lockSwipes":[64],"getSwiper":[64]}]]],["ion-tab_2",[[1,"ion-tab",{"active":[1028],"delegate":[16],"tab":[1],"component":[1],"setActive":[64]}],[1,"ion-tabs",{"useRouter":[1028,"use-router"],"selectedTab":[32],"select":[64],"getTab":[64],"getSelected":[64],"setRouteId":[64],"getRouteId":[64]}]]],["ion-img",[[1,"ion-img",{"alt":[1],"src":[1],"loadSrc":[32],"loadError":[32]}]]],["ion-progress-bar",[[33,"ion-progress-bar",{"type":[1],"reversed":[4],"value":[2],"buffer":[2],"color":[513]}]]],["ion-range",[[33,"ion-range",{"color":[513],"debounce":[2],"name":[1],"dualKnobs":[4,"dual-knobs"],"min":[2],"max":[2],"pin":[4],"pinFormatter":[16],"snaps":[4],"step":[2],"ticks":[4],"activeBarStart":[1026,"active-bar-start"],"disabled":[4],"value":[1026],"ratioA":[32],"ratioB":[32],"pressedKnob":[32]}]]],["ion-split-pane",[[33,"ion-split-pane",{"contentId":[513,"content-id"],"disabled":[4],"when":[8],"visible":[32]}]]],["ion-text",[[1,"ion-text",{"color":[513]}]]],["ion-virtual-scroll",[[0,"ion-virtual-scroll",{"approxItemHeight":[2,"approx-item-height"],"approxHeaderHeight":[2,"approx-header-height"],"approxFooterHeight":[2,"approx-footer-height"],"headerFn":[16],"footerFn":[16],"items":[16],"itemHeight":[16],"headerHeight":[16],"footerHeight":[16],"renderItem":[16],"renderHeader":[16],"renderFooter":[16],"nodeRender":[16],"domRender":[16],"totalHeight":[32],"positionForItem":[64],"checkRange":[64],"checkEnd":[64]},[[9,"resize","onResize"]]]]],["ion-picker-column-internal",[[33,"ion-picker-column-internal",{"items":[16],"value":[1032],"color":[513],"numericInput":[4,"numeric-input"],"isActive":[32],"scrollActiveItemIntoView":[64],"setValue":[64]}]]],["ion-picker-internal",[[33,"ion-picker-internal",null,[[1,"touchstart","preventTouchStartPropagation"]]]]],["ion-radio_2",[[33,"ion-radio",{"color":[513],"name":[1],"disabled":[4],"value":[8],"checked":[32],"buttonTabindex":[32],"setFocus":[64],"setButtonTabindex":[64]}],[0,"ion-radio-group",{"allowEmptySelection":[4,"allow-empty-selection"],"name":[1],"value":[1032]},[[4,"keydown","onKeydown"]]]]],["ion-ripple-effect",[[1,"ion-ripple-effect",{"type":[1],"addRipple":[64]}]]],["ion-button_2",[[33,"ion-button",{"color":[513],"buttonType":[1025,"button-type"],"disabled":[516],"expand":[513],"fill":[1537],"routerDirection":[1,"router-direction"],"routerAnimation":[16],"download":[1],"href":[1],"rel":[1],"shape":[513],"size":[513],"strong":[4],"target":[1],"type":[1],"form":[1]}],[1,"ion-icon",{"mode":[1025],"color":[1],"ios":[1],"md":[1],"flipRtl":[4,"flip-rtl"],"name":[513],"src":[1],"icon":[8],"size":[1],"lazy":[4],"sanitize":[4],"svgContent":[32],"isVisible":[32],"ariaLabel":[32]}]]],["ion-datetime_3",[[33,"ion-datetime",{"color":[1],"name":[1],"disabled":[4],"readonly":[4],"isDateEnabled":[16],"min":[1025],"max":[1025],"presentation":[1],"cancelText":[1,"cancel-text"],"doneText":[1,"done-text"],"clearText":[1,"clear-text"],"yearValues":[8,"year-values"],"monthValues":[8,"month-values"],"dayValues":[8,"day-values"],"hourValues":[8,"hour-values"],"minuteValues":[8,"minute-values"],"locale":[1],"firstDayOfWeek":[2,"first-day-of-week"],"titleSelectedDatesFormatter":[16],"multiple":[4],"value":[1025],"showDefaultTitle":[4,"show-default-title"],"showDefaultButtons":[4,"show-default-buttons"],"showClearButton":[4,"show-clear-button"],"showDefaultTimeLabel":[4,"show-default-time-label"],"hourCycle":[1,"hour-cycle"],"size":[1],"preferWheel":[4,"prefer-wheel"],"showMonthAndYear":[32],"activeParts":[32],"workingParts":[32],"isPresented":[32],"isTimePopoverOpen":[32],"confirm":[64],"reset":[64],"cancel":[64]}],[34,"ion-picker",{"overlayIndex":[2,"overlay-index"],"keyboardClose":[4,"keyboard-close"],"enterAnimation":[16],"leaveAnimation":[16],"buttons":[16],"columns":[16],"cssClass":[1,"css-class"],"duration":[2],"showBackdrop":[4,"show-backdrop"],"backdropDismiss":[4,"backdrop-dismiss"],"animated":[4],"htmlAttributes":[16],"presented":[32],"present":[64],"dismiss":[64],"onDidDismiss":[64],"onWillDismiss":[64],"getColumn":[64]}],[32,"ion-picker-column",{"col":[16]}]]],["ion-action-sheet",[[34,"ion-action-sheet",{"overlayIndex":[2,"overlay-index"],"keyboardClose":[4,"keyboard-close"],"enterAnimation":[16],"leaveAnimation":[16],"buttons":[16],"cssClass":[1,"css-class"],"backdropDismiss":[4,"backdrop-dismiss"],"header":[1],"subHeader":[1,"sub-header"],"translucent":[4],"animated":[4],"htmlAttributes":[16],"present":[64],"dismiss":[64],"onDidDismiss":[64],"onWillDismiss":[64]}]]],["ion-alert",[[34,"ion-alert",{"overlayIndex":[2,"overlay-index"],"keyboardClose":[4,"keyboard-close"],"enterAnimation":[16],"leaveAnimation":[16],"cssClass":[1,"css-class"],"header":[1],"subHeader":[1,"sub-header"],"message":[1],"buttons":[16],"inputs":[1040],"backdropDismiss":[4,"backdrop-dismiss"],"translucent":[4],"animated":[4],"htmlAttributes":[16],"present":[64],"dismiss":[64],"onDidDismiss":[64],"onWillDismiss":[64]},[[4,"keydown","onKeydown"]]]]],["ion-popover",[[33,"ion-popover",{"hasController":[4,"has-controller"],"delegate":[16],"overlayIndex":[2,"overlay-index"],"enterAnimation":[16],"leaveAnimation":[16],"component":[1],"componentProps":[16],"keyboardClose":[4,"keyboard-close"],"cssClass":[1,"css-class"],"backdropDismiss":[4,"backdrop-dismiss"],"event":[8],"showBackdrop":[4,"show-backdrop"],"translucent":[4],"animated":[4],"htmlAttributes":[16],"triggerAction":[1,"trigger-action"],"trigger":[1],"size":[1],"dismissOnSelect":[4,"dismiss-on-select"],"reference":[1],"side":[1],"alignment":[1025],"arrow":[4],"isOpen":[4,"is-open"],"keyboardEvents":[4,"keyboard-events"],"keepContentsMounted":[4,"keep-contents-mounted"],"presented":[32],"presentFromTrigger":[64],"present":[64],"dismiss":[64],"getParentPopover":[64],"onDidDismiss":[64],"onWillDismiss":[64]}]]],["ion-checkbox",[[33,"ion-checkbox",{"color":[513],"name":[1],"checked":[1028],"indeterminate":[1028],"disabled":[4],"value":[8]}]]],["ion-select_3",[[33,"ion-select",{"disabled":[4],"cancelText":[1,"cancel-text"],"okText":[1,"ok-text"],"placeholder":[1],"name":[1],"selectedText":[1,"selected-text"],"multiple":[4],"interface":[1],"interfaceOptions":[8,"interface-options"],"compareWith":[1,"compare-with"],"value":[1032],"isExpanded":[32],"open":[64]}],[1,"ion-select-option",{"disabled":[4],"value":[8]}],[34,"ion-select-popover",{"header":[1],"subHeader":[1,"sub-header"],"message":[1],"multiple":[4],"options":[16]},[[0,"ionChange","onSelect"]]]]],["ion-app_8",[[0,"ion-app",{"setFocus":[64]}],[1,"ion-content",{"color":[513],"fullscreen":[4],"forceOverscroll":[1028,"force-overscroll"],"scrollX":[4,"scroll-x"],"scrollY":[4,"scroll-y"],"scrollEvents":[4,"scroll-events"],"getScrollElement":[64],"getBackgroundElement":[64],"scrollToTop":[64],"scrollToBottom":[64],"scrollByPoint":[64],"scrollToPoint":[64]},[[8,"appload","onAppLoad"]]],[36,"ion-footer",{"collapse":[1],"translucent":[4],"keyboardVisible":[32]}],[36,"ion-header",{"collapse":[1],"translucent":[4]}],[1,"ion-router-outlet",{"mode":[1025],"delegate":[16],"animated":[4],"animation":[16],"swipeHandler":[16],"commit":[64],"setRouteId":[64],"getRouteId":[64]}],[33,"ion-title",{"color":[513],"size":[1]}],[33,"ion-toolbar",{"color":[513]},[[0,"ionStyle","childrenStyle"]]],[34,"ion-buttons",{"collapse":[4]}]]],["ion-spinner",[[1,"ion-spinner",{"color":[513],"duration":[2],"name":[1],"paused":[4]}]]],["ion-item_8",[[33,"ion-item-divider",{"color":[513],"sticky":[4]}],[32,"ion-item-group"],[1,"ion-skeleton-text",{"animated":[4]}],[32,"ion-list",{"lines":[1],"inset":[4],"closeSlidingItems":[64]}],[33,"ion-list-header",{"color":[513],"lines":[1]}],[49,"ion-item",{"color":[513],"button":[4],"detail":[4],"detailIcon":[1,"detail-icon"],"disabled":[4],"download":[1],"fill":[1],"shape":[1],"href":[1],"rel":[1],"lines":[1],"counter":[4],"routerAnimation":[16],"routerDirection":[1,"router-direction"],"target":[1],"type":[1],"counterFormatter":[16],"multipleInputs":[32],"focusable":[32],"counterString":[32]},[[0,"ionChange","handleIonChange"],[0,"ionColor","labelColorChanged"],[0,"ionStyle","itemStyle"]]],[34,"ion-label",{"color":[513],"position":[1],"noAnimate":[32]}],[33,"ion-note",{"color":[513]}]]]]'),Z))))(0,{exclude:["ion-tabs","ion-tab"],syncQueue:!0,raf:Ai,jmp:St=>I.runOutsideAngular(St),ael(St,Cn,Zn,Ei){St[ve](Cn,Zn,Ei)},rel(St,Cn,Zn,Ei){St.removeEventListener(Cn,Zn,Ei)}}))}};let ol=(()=>{class E{static forRoot(I){return{ngModule:E,providers:[{provide:ns,useValue:I},{provide:h.ip1,useFactory:ua,multi:!0,deps:[ns,Ii.K0,h.R0b]}]}}}return E.\u0275fac=function(I){return new(I||E)},E.\u0275mod=h.oAB({type:E}),E.\u0275inj=h.cJS({providers:[go,Ji,Il],imports:[[Ii.ez]]}),E})()},8834:(Rn,Dt,B)=>{"use strict";B.d(Dt,{c:()=>Ke});var h=B(5730),g=B(3457);let ie;const Y=Ae=>Ae.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),se=Ae=>{if(void 0===ie){const Qe=void 0!==Ae.style.webkitAnimationName;ie=void 0===Ae.style.animationName&&Qe?"-webkit-":""}return ie},y=(Ae,te,Qe)=>{const Ot=te.startsWith("animation")?se(Ae):"";Ae.style.setProperty(Ot+te,Qe)},fe=(Ae,te)=>{const Qe=te.startsWith("animation")?se(Ae):"";Ae.style.removeProperty(Qe+te)},Q=[],he=(Ae=[],te)=>{if(void 0!==te){const Qe=Array.isArray(te)?te:[te];return[...Ae,...Qe]}return Ae},Ke=Ae=>{let te,Qe,Ot,dt,ye,Fe,_e,xt,Pt,bt,ct,Ut,Gt,Ne=[],we=[],et=[],Je=!1,pe={},ae=[],Ee=[],vt={},Et=0,qt=!1,Ft=!1,ht=!0,Ce=!1,Ct=!0,wn=!1;const Fn=Ae,un=[],ut=[],jt=[],En=[],ni=[],ci=[],Un=[],_i=[],wi=[],xi=[],Ni="function"==typeof AnimationEffect||void 0!==g.w&&"function"==typeof g.w.AnimationEffect,Ii="function"==typeof Element&&"function"==typeof Element.prototype.animate&&Ni,Yi=()=>xi,tt=(He,pt)=>((pt?.oneTimeCallback?ut:un).push({c:He,o:pt}),Gt),Qt=()=>{if(Ii)xi.forEach(He=>{He.cancel()}),xi.length=0;else{const He=jt.slice();(0,h.r)(()=>{He.forEach(pt=>{fe(pt,"animation-name"),fe(pt,"animation-duration"),fe(pt,"animation-timing-function"),fe(pt,"animation-iteration-count"),fe(pt,"animation-delay"),fe(pt,"animation-play-state"),fe(pt,"animation-fill-mode"),fe(pt,"animation-direction")})})}},fi=()=>{ni.forEach(He=>{He?.parentNode&&He.parentNode.removeChild(He)}),ni.length=0},gn=()=>void 0!==ye?ye:_e?_e.getFill():"both",Ve=()=>void 0!==Pt?Pt:void 0!==Fe?Fe:_e?_e.getDirection():"normal",le=()=>qt?"linear":void 0!==Ot?Ot:_e?_e.getEasing():"linear",R=()=>Ft?0:void 0!==bt?bt:void 0!==Qe?Qe:_e?_e.getDuration():0,j=()=>void 0!==dt?dt:_e?_e.getIterations():1,de=()=>void 0!==ct?ct:void 0!==te?te:_e?_e.getDelay():0,gi=()=>{0!==Et&&(Et--,0===Et&&((()=>{cr(),_i.forEach(nn=>nn()),wi.forEach(nn=>nn());const He=ht?1:0,pt=ae,Yt=Ee,hn=vt;jt.forEach(nn=>{const kn=nn.classList;pt.forEach(ei=>kn.add(ei)),Yt.forEach(ei=>kn.remove(ei));for(const ei in hn)hn.hasOwnProperty(ei)&&y(nn,ei,hn[ei])}),un.forEach(nn=>nn.c(He,Gt)),ut.forEach(nn=>nn.c(He,Gt)),ut.length=0,Ct=!0,ht&&(Ce=!0),ht=!0})(),_e&&_e.animationFinish()))},Kn=(He=!0)=>{fi();const pt=(Ae=>(Ae.forEach(te=>{for(const Qe in te)if(te.hasOwnProperty(Qe)){const Ot=te[Qe];if("easing"===Qe)te["animation-timing-function"]=Ot,delete te[Qe];else{const dt=Y(Qe);dt!==Qe&&(te[dt]=Ot,delete te[Qe])}}}),Ae))(Ne);jt.forEach(Yt=>{if(pt.length>0){const hn=((Ae=[])=>Ae.map(te=>{const Qe=te.offset,Ot=[];for(const dt in te)te.hasOwnProperty(dt)&&"offset"!==dt&&Ot.push(`${dt}: ${te[dt]};`);return`${100*Qe}% { ${Ot.join(" ")} }`}).join(" "))(pt);Ut=void 0!==Ae?Ae:(Ae=>{let te=Q.indexOf(Ae);return te<0&&(te=Q.push(Ae)-1),`ion-animation-${te}`})(hn);const nn=((Ae,te,Qe)=>{var Ot;const dt=(Ae=>{const te=void 0!==Ae.getRootNode?Ae.getRootNode():Ae;return te.head||te})(Qe),ye=se(Qe),Fe=dt.querySelector("#"+Ae);if(Fe)return Fe;const Ne=(null!==(Ot=Qe.ownerDocument)&&void 0!==Ot?Ot:document).createElement("style");return Ne.id=Ae,Ne.textContent=`@${ye}keyframes ${Ae} { ${te} } @${ye}keyframes ${Ae}-alt { ${te} }`,dt.appendChild(Ne),Ne})(Ut,hn,Yt);ni.push(nn),y(Yt,"animation-duration",`${R()}ms`),y(Yt,"animation-timing-function",le()),y(Yt,"animation-delay",`${de()}ms`),y(Yt,"animation-fill-mode",gn()),y(Yt,"animation-direction",Ve());const kn=j()===1/0?"infinite":j().toString();y(Yt,"animation-iteration-count",kn),y(Yt,"animation-play-state","paused"),He&&y(Yt,"animation-name",`${nn.id}-alt`),(0,h.r)(()=>{y(Yt,"animation-name",nn.id||null)})}})},Bi=(He=!0)=>{(()=>{ci.forEach(hn=>hn()),Un.forEach(hn=>hn());const He=we,pt=et,Yt=pe;jt.forEach(hn=>{const nn=hn.classList;He.forEach(kn=>nn.add(kn)),pt.forEach(kn=>nn.remove(kn));for(const kn in Yt)Yt.hasOwnProperty(kn)&&y(hn,kn,Yt[kn])})})(),Ne.length>0&&(Ii?(jt.forEach(He=>{const pt=He.animate(Ne,{id:Fn,delay:de(),duration:R(),easing:le(),iterations:j(),fill:gn(),direction:Ve()});pt.pause(),xi.push(pt)}),xi.length>0&&(xi[0].onfinish=()=>{gi()})):Kn(He)),Je=!0},Qr=He=>{if(He=Math.min(Math.max(He,0),.9999),Ii)xi.forEach(pt=>{pt.currentTime=pt.effect.getComputedTiming().delay+R()*He,pt.pause()});else{const pt=`-${R()*He}ms`;jt.forEach(Yt=>{Ne.length>0&&(y(Yt,"animation-delay",pt),y(Yt,"animation-play-state","paused"))})}},Cr=He=>{xi.forEach(pt=>{pt.effect.updateTiming({delay:de(),duration:R(),easing:le(),iterations:j(),fill:gn(),direction:Ve()})}),void 0!==He&&Qr(He)},on=(He=!0,pt)=>{(0,h.r)(()=>{jt.forEach(Yt=>{y(Yt,"animation-name",Ut||null),y(Yt,"animation-duration",`${R()}ms`),y(Yt,"animation-timing-function",le()),y(Yt,"animation-delay",void 0!==pt?`-${pt*R()}ms`:`${de()}ms`),y(Yt,"animation-fill-mode",gn()||null),y(Yt,"animation-direction",Ve()||null);const hn=j()===1/0?"infinite":j().toString();y(Yt,"animation-iteration-count",hn),He&&y(Yt,"animation-name",`${Ut}-alt`),(0,h.r)(()=>{y(Yt,"animation-name",Ut||null)})})})},ar=(He=!1,pt=!0,Yt)=>(He&&En.forEach(hn=>{hn.update(He,pt,Yt)}),Ii?Cr(Yt):on(pt,Yt),Gt),Br=()=>{Je&&(Ii?xi.forEach(He=>{He.pause()}):jt.forEach(He=>{y(He,"animation-play-state","paused")}),wn=!0)},lr=()=>{xt=void 0,gi()},cr=()=>{xt&&clearTimeout(xt)},xe=He=>new Promise(pt=>{He?.sync&&(Ft=!0,tt(()=>Ft=!1,{oneTimeCallback:!0})),Je||Bi(),Ce&&(Ii?(Qr(0),Cr()):on(),Ce=!1),Ct&&(Et=En.length+1,Ct=!1),tt(()=>pt(),{oneTimeCallback:!0}),En.forEach(Yt=>{Yt.play()}),Ii?(xi.forEach(He=>{He.play()}),(0===Ne.length||0===jt.length)&&gi()):(()=>{if(cr(),(0,h.r)(()=>{jt.forEach(He=>{Ne.length>0&&y(He,"animation-play-state","running")})}),0===Ne.length||0===jt.length)gi();else{const He=de()||0,pt=R()||0,Yt=j()||1;isFinite(Yt)&&(xt=setTimeout(lr,He+pt*Yt+100)),((Ae,te)=>{let Qe;const Ot={passive:!0},ye=Fe=>{Ae===Fe.target&&(Qe&&Qe(),cr(),(0,h.r)(()=>{jt.forEach(He=>{fe(He,"animation-duration"),fe(He,"animation-delay"),fe(He,"animation-play-state")}),(0,h.r)(gi)}))};Ae&&(Ae.addEventListener("webkitAnimationEnd",ye,Ot),Ae.addEventListener("animationend",ye,Ot),Qe=()=>{Ae.removeEventListener("webkitAnimationEnd",ye,Ot),Ae.removeEventListener("animationend",ye,Ot)})})(jt[0])}})(),wn=!1}),Lt=(He,pt)=>{const Yt=Ne[0];return void 0===Yt||void 0!==Yt.offset&&0!==Yt.offset?Ne=[{offset:0,[He]:pt},...Ne]:Yt[He]=pt,Gt};return Gt={parentAnimation:_e,elements:jt,childAnimations:En,id:Fn,animationFinish:gi,from:Lt,to:(He,pt)=>{const Yt=Ne[Ne.length-1];return void 0===Yt||void 0!==Yt.offset&&1!==Yt.offset?Ne=[...Ne,{offset:1,[He]:pt}]:Yt[He]=pt,Gt},fromTo:(He,pt,Yt)=>Lt(He,pt).to(He,Yt),parent:He=>(_e=He,Gt),play:xe,pause:()=>(En.forEach(He=>{He.pause()}),Br(),Gt),stop:()=>{En.forEach(He=>{He.stop()}),Je&&(Qt(),Je=!1),qt=!1,Ft=!1,Ct=!0,Pt=void 0,bt=void 0,ct=void 0,Et=0,Ce=!1,ht=!0,wn=!1},destroy:He=>(En.forEach(pt=>{pt.destroy(He)}),(He=>{Qt(),He&&fi()})(He),jt.length=0,En.length=0,Ne.length=0,un.length=0,ut.length=0,Je=!1,Ct=!0,Gt),keyframes:He=>{const pt=Ne!==He;return Ne=He,pt&&(He=>{Ii?Yi().forEach(pt=>{if(pt.effect.setKeyframes)pt.effect.setKeyframes(He);else{const Yt=new KeyframeEffect(pt.effect.target,He,pt.effect.getTiming());pt.effect=Yt}}):Kn()})(Ne),Gt},addAnimation:He=>{if(null!=He)if(Array.isArray(He))for(const pt of He)pt.parent(Gt),En.push(pt);else He.parent(Gt),En.push(He);return Gt},addElement:He=>{if(null!=He)if(1===He.nodeType)jt.push(He);else if(He.length>=0)for(let pt=0;pt<He.length;pt++)jt.push(He[pt]);else console.error("Invalid addElement value");return Gt},update:ar,fill:He=>(ye=He,ar(!0),Gt),direction:He=>(Fe=He,ar(!0),Gt),iterations:He=>(dt=He,ar(!0),Gt),duration:He=>(!Ii&&0===He&&(He=1),Qe=He,ar(!0),Gt),easing:He=>(Ot=He,ar(!0),Gt),delay:He=>(te=He,ar(!0),Gt),getWebAnimations:Yi,getKeyframes:()=>Ne,getFill:gn,getDirection:Ve,getDelay:de,getIterations:j,getEasing:le,getDuration:R,afterAddRead:He=>(_i.push(He),Gt),afterAddWrite:He=>(wi.push(He),Gt),afterClearStyles:(He=[])=>{for(const pt of He)vt[pt]="";return Gt},afterStyles:(He={})=>(vt=He,Gt),afterRemoveClass:He=>(Ee=he(Ee,He),Gt),afterAddClass:He=>(ae=he(ae,He),Gt),beforeAddRead:He=>(ci.push(He),Gt),beforeAddWrite:He=>(Un.push(He),Gt),beforeClearStyles:(He=[])=>{for(const pt of He)pe[pt]="";return Gt},beforeStyles:(He={})=>(pe=He,Gt),beforeRemoveClass:He=>(et=he(et,He),Gt),beforeAddClass:He=>(we=he(we,He),Gt),onFinish:tt,isRunning:()=>0!==Et&&!wn,progressStart:(He=!1,pt)=>(En.forEach(Yt=>{Yt.progressStart(He,pt)}),Br(),qt=He,Je||Bi(),ar(!1,!0,pt),Gt),progressStep:He=>(En.forEach(pt=>{pt.progressStep(He)}),Qr(He),Gt),progressEnd:(He,pt,Yt)=>(qt=!1,En.forEach(hn=>{hn.progressEnd(He,pt,Yt)}),void 0!==Yt&&(bt=Yt),Ce=!1,ht=!0,0===He?(Pt="reverse"===Ve()?"normal":"reverse","reverse"===Pt&&(ht=!1),Ii?(ar(),Qr(1-pt)):(ct=(1-pt)*R()*-1,ar(!1,!1))):1===He&&(Ii?(ar(),Qr(pt)):(ct=pt*R()*-1,ar(!1,!1))),void 0!==He&&(tt(()=>{bt=void 0,Pt=void 0,ct=void 0},{oneTimeCallback:!0}),_e||xe()),Gt)}}},4349:(Rn,Dt,B)=>{"use strict";B.d(Dt,{G:()=>Y});class g{constructor(y,fe,Ie,Ge,Q){this.id=fe,this.name=Ie,this.disableScroll=Q,this.priority=1e6*Ge+fe,this.ctrl=y}canStart(){return!!this.ctrl&&this.ctrl.canStart(this.name)}start(){return!!this.ctrl&&this.ctrl.start(this.name,this.id,this.priority)}capture(){if(!this.ctrl)return!1;const y=this.ctrl.capture(this.name,this.id,this.priority);return y&&this.disableScroll&&this.ctrl.disableScroll(this.id),y}release(){this.ctrl&&(this.ctrl.release(this.id),this.disableScroll&&this.ctrl.enableScroll(this.id))}destroy(){this.release(),this.ctrl=void 0}}class ie{constructor(y,fe,Ie,Ge){this.id=fe,this.disable=Ie,this.disableScroll=Ge,this.ctrl=y}block(){if(this.ctrl){if(this.disable)for(const y of this.disable)this.ctrl.disableGesture(y,this.id);this.disableScroll&&this.ctrl.disableScroll(this.id)}}unblock(){if(this.ctrl){if(this.disable)for(const y of this.disable)this.ctrl.enableGesture(y,this.id);this.disableScroll&&this.ctrl.enableScroll(this.id)}}destroy(){this.unblock(),this.ctrl=void 0}}const c="backdrop-no-scroll",Y=new class h{constructor(){this.gestureId=0,this.requestedStart=new Map,this.disabledGestures=new Map,this.disabledScroll=new Set}createGesture(y){var fe;return new g(this,this.newID(),y.name,null!==(fe=y.priority)&&void 0!==fe?fe:0,!!y.disableScroll)}createBlocker(y={}){return new ie(this,this.newID(),y.disable,!!y.disableScroll)}start(y,fe,Ie){return this.canStart(y)?(this.requestedStart.set(fe,Ie),!0):(this.requestedStart.delete(fe),!1)}capture(y,fe,Ie){if(!this.start(y,fe,Ie))return!1;const Ge=this.requestedStart;let Q=-1e4;if(Ge.forEach(be=>{Q=Math.max(Q,be)}),Q===Ie){this.capturedId=fe,Ge.clear();const be=new CustomEvent("ionGestureCaptured",{detail:{gestureName:y}});return document.dispatchEvent(be),!0}return Ge.delete(fe),!1}release(y){this.requestedStart.delete(y),this.capturedId===y&&(this.capturedId=void 0)}disableGesture(y,fe){let Ie=this.disabledGestures.get(y);void 0===Ie&&(Ie=new Set,this.disabledGestures.set(y,Ie)),Ie.add(fe)}enableGesture(y,fe){const Ie=this.disabledGestures.get(y);void 0!==Ie&&Ie.delete(fe)}disableScroll(y){this.disabledScroll.add(y),1===this.disabledScroll.size&&document.body.classList.add(c)}enableScroll(y){this.disabledScroll.delete(y),0===this.disabledScroll.size&&document.body.classList.remove(c)}canStart(y){return!(void 0!==this.capturedId||this.isDisabled(y))}isCaptured(){return void 0!==this.capturedId}isScrollDisabled(){return this.disabledScroll.size>0}isDisabled(y){const fe=this.disabledGestures.get(y);return!!(fe&&fe.size>0)}newID(){return this.gestureId++,this.gestureId}}},7593:(Rn,Dt,B)=>{"use strict";B.r(Dt),B.d(Dt,{MENU_BACK_BUTTON_PRIORITY:()=>Y,OVERLAY_BACK_BUTTON_PRIORITY:()=>c,blockHardwareBackButton:()=>g,startHardwareBackButton:()=>ie});var h=B(5861);const g=()=>{document.addEventListener("backbutton",()=>{})},ie=()=>{const se=document;let y=!1;se.addEventListener("backbutton",()=>{if(y)return;let fe=0,Ie=[];const Ge=new CustomEvent("ionBackButton",{bubbles:!1,detail:{register(me,Ze){Ie.push({priority:me,handler:Ze,id:fe++})}}});se.dispatchEvent(Ge);const Q=function(){var me=(0,h.Z)(function*(Ze){try{if(Ze?.handler){const he=Ze.handler(be);null!=he&&(yield he)}}catch(he){console.error(he)}});return function(he){return me.apply(this,arguments)}}(),be=()=>{if(Ie.length>0){let me={priority:Number.MIN_SAFE_INTEGER,handler:()=>{},id:-1};Ie.forEach(Ze=>{Ze.priority>=me.priority&&(me=Ze)}),y=!0,Ie=Ie.filter(Ze=>Ze.id!==me.id),Q(me).then(()=>y=!1)}};be()})},c=100,Y=99},5730:(Rn,Dt,B)=>{"use strict";B.d(Dt,{a:()=>y,b:()=>fe,c:()=>ie,d:()=>Ze,e:()=>he,f:()=>me,g:()=>Ie,h:()=>dt,i:()=>se,j:()=>c,k:()=>be,l:()=>Ke,m:()=>Q,n:()=>Ae,o:()=>Ot,p:()=>Qe,q:()=>ye,r:()=>Ge,s:()=>Fe,t:()=>h,u:()=>te});const h=(Ne,we=0)=>new Promise(et=>{g(Ne,we,et)}),g=(Ne,we=0,et)=>{let Je,_e;const pe={passive:!0},Ee=()=>{Je&&Je()},vt=Et=>{(void 0===Et||Ne===Et.target)&&(Ee(),et(Et))};return Ne&&(Ne.addEventListener("webkitTransitionEnd",vt,pe),Ne.addEventListener("transitionend",vt,pe),_e=setTimeout(vt,we+500),Je=()=>{_e&&(clearTimeout(_e),_e=void 0),Ne.removeEventListener("webkitTransitionEnd",vt,pe),Ne.removeEventListener("transitionend",vt,pe)}),Ee},ie=(Ne,we)=>{Ne.componentOnReady?Ne.componentOnReady().then(et=>we(et)):Ge(()=>we(Ne))},c=(Ne,we=[])=>{const et={};return we.forEach(Je=>{Ne.hasAttribute(Je)&&(null!==Ne.getAttribute(Je)&&(et[Je]=Ne.getAttribute(Je)),Ne.removeAttribute(Je))}),et},Y=["role","aria-activedescendant","aria-atomic","aria-autocomplete","aria-braillelabel","aria-brailleroledescription","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colindextext","aria-colspan","aria-controls","aria-current","aria-describedby","aria-description","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowindextext","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext"],se=(Ne,we)=>{let et=Y;return we&&we.length>0&&(et=et.filter(Je=>!we.includes(Je))),c(Ne,et)},y=(Ne,we,et,Je)=>{var _e;if(typeof window<"u"){const ae=null===(_e=window?.Ionic)||void 0===_e?void 0:_e.config;if(ae){const Ee=ae.get("_ael");if(Ee)return Ee(Ne,we,et,Je);if(ae._ael)return ae._ael(Ne,we,et,Je)}}return Ne.addEventListener(we,et,Je)},fe=(Ne,we,et,Je)=>{var _e;if(typeof window<"u"){const ae=null===(_e=window?.Ionic)||void 0===_e?void 0:_e.config;if(ae){const Ee=ae.get("_rel");if(Ee)return Ee(Ne,we,et,Je);if(ae._rel)return ae._rel(Ne,we,et,Je)}}return Ne.removeEventListener(we,et,Je)},Ie=(Ne,we=Ne)=>Ne.shadowRoot||we,Ge=Ne=>"function"==typeof __zone_symbol__requestAnimationFrame?__zone_symbol__requestAnimationFrame(Ne):"function"==typeof requestAnimationFrame?requestAnimationFrame(Ne):setTimeout(Ne),Q=Ne=>!!Ne.shadowRoot&&!!Ne.attachShadow,be=Ne=>{const we=Ne.closest("ion-item");return we?we.querySelector("ion-label"):null},me=Ne=>{if(Ne.focus(),Ne.classList.contains("ion-focusable")){const we=Ne.closest("ion-app");we&&we.setFocus([Ne])}},Ze=(Ne,we)=>{let et;const Je=Ne.getAttribute("aria-labelledby"),_e=Ne.id;let pe=null!==Je&&""!==Je.trim()?Je:we+"-lbl",ae=null!==Je&&""!==Je.trim()?document.getElementById(Je):be(Ne);return ae?(null===Je&&(ae.id=pe),et=ae.textContent,ae.setAttribute("aria-hidden","true")):""!==_e.trim()&&(ae=document.querySelector(`label[for="${_e}"]`),ae&&(""!==ae.id?pe=ae.id:ae.id=pe=`${_e}-lbl`,et=ae.textContent)),{label:ae,labelId:pe,labelText:et}},he=(Ne,we,et,Je,_e)=>{if(Ne||Q(we)){let pe=we.querySelector("input.aux-input");pe||(pe=we.ownerDocument.createElement("input"),pe.type="hidden",pe.classList.add("aux-input"),we.appendChild(pe)),pe.disabled=_e,pe.name=et,pe.value=Je||""}},Ke=(Ne,we,et)=>Math.max(Ne,Math.min(we,et)),Ae=(Ne,we)=>{if(!Ne){const et="ASSERT: "+we;throw console.error(et),new Error(et)}},te=Ne=>Ne.timeStamp||Date.now(),Qe=Ne=>{if(Ne){const we=Ne.changedTouches;if(we&&we.length>0){const et=we[0];return{x:et.clientX,y:et.clientY}}if(void 0!==Ne.pageX)return{x:Ne.pageX,y:Ne.pageY}}return{x:0,y:0}},Ot=Ne=>{const we="rtl"===document.dir;switch(Ne){case"start":return we;case"end":return!we;default:throw new Error(`"${Ne}" is not a valid value for [side]. Use "start" or "end" instead.`)}},dt=(Ne,we)=>{const et=Ne._original||Ne;return{_original:Ne,emit:ye(et.emit.bind(et),we)}},ye=(Ne,we=0)=>{let et;return(...Je)=>{clearTimeout(et),et=setTimeout(Ne,we,...Je)}},Fe=(Ne,we)=>{if(Ne??(Ne={}),we??(we={}),Ne===we)return!0;const et=Object.keys(Ne);if(et.length!==Object.keys(we).length)return!1;for(const Je of et)if(!(Je in we)||Ne[Je]!==we[Je])return!1;return!0}},4292:(Rn,Dt,B)=>{"use strict";B.d(Dt,{m:()=>Q});var h=B(5861),g=B(7593),ie=B(5730),c=B(9658),Y=B(8834);const se=be=>(0,Y.c)().duration(be?400:300),y=be=>{let me,Ze;const he=be.width+8,Ke=(0,Y.c)(),Ae=(0,Y.c)();be.isEndSide?(me=he+"px",Ze="0px"):(me=-he+"px",Ze="0px"),Ke.addElement(be.menuInnerEl).fromTo("transform",`translateX(${me})`,`translateX(${Ze})`);const Qe="ios"===(0,c.b)(be),Ot=Qe?.2:.25;return Ae.addElement(be.backdropEl).fromTo("opacity",.01,Ot),se(Qe).addAnimation([Ke,Ae])},fe=be=>{let me,Ze;const he=(0,c.b)(be),Ke=be.width;be.isEndSide?(me=-Ke+"px",Ze=Ke+"px"):(me=Ke+"px",Ze=-Ke+"px");const Ae=(0,Y.c)().addElement(be.menuInnerEl).fromTo("transform",`translateX(${Ze})`,"translateX(0px)"),te=(0,Y.c)().addElement(be.contentEl).fromTo("transform","translateX(0px)",`translateX(${me})`),Qe=(0,Y.c)().addElement(be.backdropEl).fromTo("opacity",.01,.32);return se("ios"===he).addAnimation([Ae,te,Qe])},Ie=be=>{const me=(0,c.b)(be),Ze=be.width*(be.isEndSide?-1:1)+"px",he=(0,Y.c)().addElement(be.contentEl).fromTo("transform","translateX(0px)",`translateX(${Ze})`);return se("ios"===me).addAnimation(he)},Q=(()=>{const be=new Map,me=[],Ze=function(){var xt=(0,h.Z)(function*(Pt){const bt=yield dt(Pt);return!!bt&&bt.open()});return function(bt){return xt.apply(this,arguments)}}(),he=function(){var xt=(0,h.Z)(function*(Pt){const bt=yield void 0!==Pt?dt(Pt):ye();return void 0!==bt&&bt.close()});return function(bt){return xt.apply(this,arguments)}}(),Ke=function(){var xt=(0,h.Z)(function*(Pt){const bt=yield dt(Pt);return!!bt&&bt.toggle()});return function(bt){return xt.apply(this,arguments)}}(),Ae=function(){var xt=(0,h.Z)(function*(Pt,bt){const ct=yield dt(bt);return ct&&(ct.disabled=!Pt),ct});return function(bt,ct){return xt.apply(this,arguments)}}(),te=function(){var xt=(0,h.Z)(function*(Pt,bt){const ct=yield dt(bt);return ct&&(ct.swipeGesture=Pt),ct});return function(bt,ct){return xt.apply(this,arguments)}}(),Qe=function(){var xt=(0,h.Z)(function*(Pt){if(null!=Pt){const bt=yield dt(Pt);return void 0!==bt&&bt.isOpen()}return void 0!==(yield ye())});return function(bt){return xt.apply(this,arguments)}}(),Ot=function(){var xt=(0,h.Z)(function*(Pt){const bt=yield dt(Pt);return!!bt&&!bt.disabled});return function(bt){return xt.apply(this,arguments)}}(),dt=function(){var xt=(0,h.Z)(function*(Pt){return yield Ft(),"start"===Pt||"end"===Pt?qt(ht=>ht.side===Pt&&!ht.disabled)||qt(ht=>ht.side===Pt):null!=Pt?qt(ct=>ct.menuId===Pt):qt(ct=>!ct.disabled)||(me.length>0?me[0].el:void 0)});return function(bt){return xt.apply(this,arguments)}}(),ye=function(){var xt=(0,h.Z)(function*(){return yield Ft(),Ee()});return function(){return xt.apply(this,arguments)}}(),Fe=function(){var xt=(0,h.Z)(function*(){return yield Ft(),vt()});return function(){return xt.apply(this,arguments)}}(),Ne=function(){var xt=(0,h.Z)(function*(){return yield Ft(),Et()});return function(){return xt.apply(this,arguments)}}(),we=(xt,Pt)=>{be.set(xt,Pt)},_e=xt=>{const Pt=xt.side;me.filter(bt=>bt.side===Pt&&bt!==xt).forEach(bt=>bt.disabled=!0)},pe=function(){var xt=(0,h.Z)(function*(Pt,bt,ct){if(Et())return!1;if(bt){const ht=yield ye();ht&&Pt.el!==ht&&(yield ht.setOpen(!1,!1))}return Pt._setOpen(bt,ct)});return function(bt,ct,ht){return xt.apply(this,arguments)}}(),Ee=()=>qt(xt=>xt._isOpen),vt=()=>me.map(xt=>xt.el),Et=()=>me.some(xt=>xt.isAnimating),qt=xt=>{const Pt=me.find(xt);if(void 0!==Pt)return Pt.el},Ft=()=>Promise.all(Array.from(document.querySelectorAll("ion-menu")).map(xt=>new Promise(Pt=>(0,ie.c)(xt,Pt))));return we("reveal",Ie),we("push",fe),we("overlay",y),typeof document<"u"&&document.addEventListener("ionBackButton",xt=>{const Pt=Ee();Pt&&xt.detail.register(g.MENU_BACK_BUTTON_PRIORITY,()=>Pt.close())}),{registerAnimation:we,get:dt,getMenus:Fe,getOpen:ye,isEnabled:Ot,swipeGesture:te,isAnimating:Ne,isOpen:Qe,enable:Ae,toggle:Ke,close:he,open:Ze,_getOpenSync:Ee,_createAnimation:(xt,Pt)=>{const bt=be.get(xt);if(!bt)throw new Error("animation not registered");return bt(Pt)},_register:xt=>{me.indexOf(xt)<0&&(xt.disabled||_e(xt),me.push(xt))},_unregister:xt=>{const Pt=me.indexOf(xt);Pt>-1&&me.splice(Pt,1)},_setOpen:pe,_setActiveMenu:_e}})()},3457:(Rn,Dt,B)=>{"use strict";B.d(Dt,{w:()=>h});const h=typeof window<"u"?window:void 0},1308:(Rn,Dt,B)=>{"use strict";B.d(Dt,{B:()=>Wn,H:()=>jt,a:()=>ht,b:()=>Yn,c:()=>ri,e:()=>br,f:()=>hi,g:()=>Ce,h:()=>un,i:()=>Pi,j:()=>Ve,k:()=>di,p:()=>Ke,r:()=>Vi,s:()=>Ze});var h=B(5861);let ie,c,Y,se=!1,y=!1,fe=!1,Ie=!1,Ge=!1;const Q=typeof window<"u"?window:{},be=Q.document||{head:{}},me={$flags$:0,$resourcesUrl$:"",jmp:xe=>xe(),raf:xe=>requestAnimationFrame(xe),ael:(xe,Oe,Lt,$t)=>xe.addEventListener(Oe,Lt,$t),rel:(xe,Oe,Lt,$t)=>xe.removeEventListener(Oe,Lt,$t),ce:(xe,Oe)=>new CustomEvent(xe,Oe)},Ze=xe=>{Object.assign(me,xe)},Ke=xe=>Promise.resolve(xe),Ae=(()=>{try{return new CSSStyleSheet,"function"==typeof(new CSSStyleSheet).replaceSync}catch{}return!1})(),te=(xe,Oe,Lt,$t)=>{Lt&&Lt.map(([tn,He,pt])=>{const Yt=Ot(xe,tn),hn=Qe(Oe,pt),nn=dt(tn);me.ael(Yt,He,hn,nn),(Oe.$rmListeners$=Oe.$rmListeners$||[]).push(()=>me.rel(Yt,He,hn,nn))})},Qe=(xe,Oe)=>Lt=>{try{256&xe.$flags$?xe.$lazyInstance$[Oe](Lt):(xe.$queuedListeners$=xe.$queuedListeners$||[]).push([Oe,Lt])}catch($t){Cr($t)}},Ot=(xe,Oe)=>4&Oe?be:8&Oe?Q:16&Oe?be.body:xe,dt=xe=>0!=(2&xe),et="s-id",Je="sty-id",ae="http://www.w3.org/1999/xlink",Et=new WeakMap,qt=(xe,Oe,Lt)=>{let $t=pr.get(xe);Ae&&Lt?($t=$t||new CSSStyleSheet,"string"==typeof $t?$t=Oe:$t.replaceSync(Oe)):$t=Oe,pr.set(xe,$t)},Ft=(xe,Oe,Lt,$t)=>{let tn=Pt(Oe,Lt);const He=pr.get(tn);if(xe=11===xe.nodeType?xe:be,He)if("string"==typeof He){let Yt,pt=Et.get(xe=xe.head||xe);pt||Et.set(xe,pt=new Set),pt.has(tn)||(xe.host&&(Yt=xe.querySelector(`[${Je}="${tn}"]`))?Yt.innerHTML=He:(Yt=be.createElement("style"),Yt.innerHTML=He,xe.insertBefore(Yt,xe.querySelector("link"))),pt&&pt.add(tn))}else xe.adoptedStyleSheets.includes(He)||(xe.adoptedStyleSheets=[...xe.adoptedStyleSheets,He]);return tn},Pt=(xe,Oe)=>"sc-"+(Oe&&32&xe.$flags$?xe.$tagName$+"-"+Oe:xe.$tagName$),bt=xe=>xe.replace(/\/\*!@([^\/]+)\*\/[^\{]+\{/g,"$1{"),ht=xe=>xo.push(xe),Ce=xe=>Kn(xe).$modeName$,Ct={},Fn=xe=>"object"==(xe=typeof xe)||"function"===xe,un=(xe,Oe,...Lt)=>{let $t=null,tn=null,He=null,pt=!1,Yt=!1;const hn=[],nn=ei=>{for(let Ci=0;Ci<ei.length;Ci++)$t=ei[Ci],Array.isArray($t)?nn($t):null!=$t&&"boolean"!=typeof $t&&((pt="function"!=typeof xe&&!Fn($t))&&($t=String($t)),pt&&Yt?hn[hn.length-1].$text$+=$t:hn.push(pt?ut(null,$t):$t),Yt=pt)};if(nn(Lt),Oe){Oe.key&&(tn=Oe.key),Oe.name&&(He=Oe.name);{const ei=Oe.className||Oe.class;ei&&(Oe.class="object"!=typeof ei?ei:Object.keys(ei).filter(Ci=>ei[Ci]).join(" "))}}if("function"==typeof xe)return xe(null===Oe?{}:Oe,hn,ni);const kn=ut(xe,null);return kn.$attrs$=Oe,hn.length>0&&(kn.$children$=hn),kn.$key$=tn,kn.$name$=He,kn},ut=(xe,Oe)=>({$flags$:0,$tag$:xe,$text$:Oe,$elm$:null,$children$:null,$attrs$:null,$key$:null,$name$:null}),jt={},ni={forEach:(xe,Oe)=>xe.map(ci).forEach(Oe),map:(xe,Oe)=>xe.map(ci).map(Oe).map(Un)},ci=xe=>({vattrs:xe.$attrs$,vchildren:xe.$children$,vkey:xe.$key$,vname:xe.$name$,vtag:xe.$tag$,vtext:xe.$text$}),Un=xe=>{if("function"==typeof xe.vtag){const Lt=Object.assign({},xe.vattrs);return xe.vkey&&(Lt.key=xe.vkey),xe.vname&&(Lt.name=xe.vname),un(xe.vtag,Lt,...xe.vchildren||[])}const Oe=ut(xe.vtag,xe.vtext);return Oe.$attrs$=xe.vattrs,Oe.$children$=xe.vchildren,Oe.$key$=xe.vkey,Oe.$name$=xe.vname,Oe},_i=(xe,Oe,Lt,$t,tn,He)=>{if(Lt!==$t){let pt=Qr(xe,Oe),Yt=Oe.toLowerCase();if("class"===Oe){const hn=xe.classList,nn=xi(Lt),kn=xi($t);hn.remove(...nn.filter(ei=>ei&&!kn.includes(ei))),hn.add(...kn.filter(ei=>ei&&!nn.includes(ei)))}else if("style"===Oe){for(const hn in Lt)(!$t||null==$t[hn])&&(hn.includes("-")?xe.style.removeProperty(hn):xe.style[hn]="");for(const hn in $t)(!Lt||$t[hn]!==Lt[hn])&&(hn.includes("-")?xe.style.setProperty(hn,$t[hn]):xe.style[hn]=$t[hn])}else if("key"!==Oe)if("ref"===Oe)$t&&$t(xe);else if(pt||"o"!==Oe[0]||"n"!==Oe[1]){const hn=Fn($t);if((pt||hn&&null!==$t)&&!tn)try{if(xe.tagName.includes("-"))xe[Oe]=$t;else{const kn=$t??"";"list"===Oe?pt=!1:(null==Lt||xe[Oe]!=kn)&&(xe[Oe]=kn)}}catch{}let nn=!1;Yt!==(Yt=Yt.replace(/^xlink\:?/,""))&&(Oe=Yt,nn=!0),null==$t||!1===$t?(!1!==$t||""===xe.getAttribute(Oe))&&(nn?xe.removeAttributeNS(ae,Oe):xe.removeAttribute(Oe)):(!pt||4&He||tn)&&!hn&&($t=!0===$t?"":$t,nn?xe.setAttributeNS(ae,Oe,$t):xe.setAttribute(Oe,$t))}else Oe="-"===Oe[2]?Oe.slice(3):Qr(Q,Yt)?Yt.slice(2):Yt[2]+Oe.slice(3),Lt&&me.rel(xe,Oe,Lt,!1),$t&&me.ael(xe,Oe,$t,!1)}},wi=/\s/,xi=xe=>xe?xe.split(wi):[],Ni=(xe,Oe,Lt,$t)=>{const tn=11===Oe.$elm$.nodeType&&Oe.$elm$.host?Oe.$elm$.host:Oe.$elm$,He=xe&&xe.$attrs$||Ct,pt=Oe.$attrs$||Ct;for($t in He)$t in pt||_i(tn,$t,He[$t],void 0,Lt,Oe.$flags$);for($t in pt)_i(tn,$t,He[$t],pt[$t],Lt,Oe.$flags$)},Ii=(xe,Oe,Lt,$t)=>{const tn=Oe.$children$[Lt];let pt,Yt,hn,He=0;if(se||(fe=!0,"slot"===tn.$tag$&&(ie&&$t.classList.add(ie+"-s"),tn.$flags$|=tn.$children$?2:1)),null!==tn.$text$)pt=tn.$elm$=be.createTextNode(tn.$text$);else if(1&tn.$flags$)pt=tn.$elm$=be.createTextNode("");else{if(Ie||(Ie="svg"===tn.$tag$),pt=tn.$elm$=be.createElementNS(Ie?"http://www.w3.org/2000/svg":"http://www.w3.org/1999/xhtml",2&tn.$flags$?"slot-fb":tn.$tag$),Ie&&"foreignObject"===tn.$tag$&&(Ie=!1),Ni(null,tn,Ie),(xe=>null!=xe)(ie)&&pt["s-si"]!==ie&&pt.classList.add(pt["s-si"]=ie),tn.$children$)for(He=0;He<tn.$children$.length;++He)Yt=Ii(xe,tn,He,pt),Yt&&pt.appendChild(Yt);"svg"===tn.$tag$?Ie=!1:"foreignObject"===pt.tagName&&(Ie=!0)}return pt["s-hn"]=Y,3&tn.$flags$&&(pt["s-sr"]=!0,pt["s-cr"]=c,pt["s-sn"]=tn.$name$||"",hn=xe&&xe.$children$&&xe.$children$[Lt],hn&&hn.$tag$===tn.$tag$&&xe.$elm$&&Ui(xe.$elm$,!1)),pt},Ui=(xe,Oe)=>{me.$flags$|=1;const Lt=xe.childNodes;for(let $t=Lt.length-1;$t>=0;$t--){const tn=Lt[$t];tn["s-hn"]!==Y&&tn["s-ol"]&&(tt(tn).insertBefore(tn,re(tn)),tn["s-ol"].remove(),tn["s-ol"]=void 0,fe=!0),Oe&&Ui(tn,Oe)}me.$flags$&=-2},Yi=(xe,Oe,Lt,$t,tn,He)=>{let Yt,pt=xe["s-cr"]&&xe["s-cr"].parentNode||xe;for(pt.shadowRoot&&pt.tagName===Y&&(pt=pt.shadowRoot);tn<=He;++tn)$t[tn]&&(Yt=Ii(null,Lt,tn,xe),Yt&&($t[tn].$elm$=Yt,pt.insertBefore(Yt,re(Oe))))},Ht=(xe,Oe,Lt,$t,tn)=>{for(;Oe<=Lt;++Oe)($t=xe[Oe])&&(tn=$t.$elm$,mi($t),y=!0,tn["s-ol"]?tn["s-ol"].remove():Ui(tn,!0),tn.remove())},qe=(xe,Oe)=>xe.$tag$===Oe.$tag$&&("slot"===xe.$tag$?xe.$name$===Oe.$name$:xe.$key$===Oe.$key$),re=xe=>xe&&xe["s-ol"]||xe,tt=xe=>(xe["s-ol"]?xe["s-ol"]:xe).parentNode,Wt=(xe,Oe)=>{const Lt=Oe.$elm$=xe.$elm$,$t=xe.$children$,tn=Oe.$children$,He=Oe.$tag$,pt=Oe.$text$;let Yt;null===pt?(Ie="svg"===He||"foreignObject"!==He&&Ie,"slot"===He||Ni(xe,Oe,Ie),null!==$t&&null!==tn?((xe,Oe,Lt,$t)=>{let ki,jr,tn=0,He=0,pt=0,Yt=0,hn=Oe.length-1,nn=Oe[0],kn=Oe[hn],ei=$t.length-1,Ci=$t[0],qi=$t[ei];for(;tn<=hn&&He<=ei;)if(null==nn)nn=Oe[++tn];else if(null==kn)kn=Oe[--hn];else if(null==Ci)Ci=$t[++He];else if(null==qi)qi=$t[--ei];else if(qe(nn,Ci))Wt(nn,Ci),nn=Oe[++tn],Ci=$t[++He];else if(qe(kn,qi))Wt(kn,qi),kn=Oe[--hn],qi=$t[--ei];else if(qe(nn,qi))("slot"===nn.$tag$||"slot"===qi.$tag$)&&Ui(nn.$elm$.parentNode,!1),Wt(nn,qi),xe.insertBefore(nn.$elm$,kn.$elm$.nextSibling),nn=Oe[++tn],qi=$t[--ei];else if(qe(kn,Ci))("slot"===nn.$tag$||"slot"===qi.$tag$)&&Ui(kn.$elm$.parentNode,!1),Wt(kn,Ci),xe.insertBefore(kn.$elm$,nn.$elm$),kn=Oe[--hn],Ci=$t[++He];else{for(pt=-1,Yt=tn;Yt<=hn;++Yt)if(Oe[Yt]&&null!==Oe[Yt].$key$&&Oe[Yt].$key$===Ci.$key$){pt=Yt;break}pt>=0?(jr=Oe[pt],jr.$tag$!==Ci.$tag$?ki=Ii(Oe&&Oe[He],Lt,pt,xe):(Wt(jr,Ci),Oe[pt]=void 0,ki=jr.$elm$),Ci=$t[++He]):(ki=Ii(Oe&&Oe[He],Lt,He,xe),Ci=$t[++He]),ki&&tt(nn.$elm$).insertBefore(ki,re(nn.$elm$))}tn>hn?Yi(xe,null==$t[ei+1]?null:$t[ei+1].$elm$,Lt,$t,He,ei):He>ei&&Ht(Oe,tn,hn)})(Lt,$t,Oe,tn):null!==tn?(null!==xe.$text$&&(Lt.textContent=""),Yi(Lt,null,Oe,tn,0,tn.length-1)):null!==$t&&Ht($t,0,$t.length-1),Ie&&"svg"===He&&(Ie=!1)):(Yt=Lt["s-cr"])?Yt.parentNode.textContent=pt:xe.$text$!==pt&&(Lt.data=pt)},Qt=xe=>{const Oe=xe.childNodes;let Lt,$t,tn,He,pt,Yt;for($t=0,tn=Oe.length;$t<tn;$t++)if(Lt=Oe[$t],1===Lt.nodeType){if(Lt["s-sr"])for(pt=Lt["s-sn"],Lt.hidden=!1,He=0;He<tn;He++)if(Yt=Oe[He].nodeType,Oe[He]["s-hn"]!==Lt["s-hn"]||""!==pt){if(1===Yt&&pt===Oe[He].getAttribute("slot")){Lt.hidden=!0;break}}else if(1===Yt||3===Yt&&""!==Oe[He].textContent.trim()){Lt.hidden=!0;break}Qt(Lt)}},fi=[],Ai=xe=>{let Oe,Lt,$t,tn,He,pt,Yt=0;const hn=xe.childNodes,nn=hn.length;for(;Yt<nn;Yt++){if(Oe=hn[Yt],Oe["s-sr"]&&(Lt=Oe["s-cr"])&&Lt.parentNode)for($t=Lt.parentNode.childNodes,tn=Oe["s-sn"],pt=$t.length-1;pt>=0;pt--)Lt=$t[pt],!Lt["s-cn"]&&!Lt["s-nr"]&&Lt["s-hn"]!==Oe["s-hn"]&&(er(Lt,tn)?(He=fi.find(kn=>kn.$nodeToRelocate$===Lt),y=!0,Lt["s-sn"]=Lt["s-sn"]||tn,He?He.$slotRefNode$=Oe:fi.push({$slotRefNode$:Oe,$nodeToRelocate$:Lt}),Lt["s-sr"]&&fi.map(kn=>{er(kn.$nodeToRelocate$,Lt["s-sn"])&&(He=fi.find(ei=>ei.$nodeToRelocate$===Lt),He&&!kn.$slotRefNode$&&(kn.$slotRefNode$=He.$slotRefNode$))})):fi.some(kn=>kn.$nodeToRelocate$===Lt)||fi.push({$nodeToRelocate$:Lt}));1===Oe.nodeType&&Ai(Oe)}},er=(xe,Oe)=>1===xe.nodeType?null===xe.getAttribute("slot")&&""===Oe||xe.getAttribute("slot")===Oe:xe["s-sn"]===Oe||""===Oe,mi=xe=>{xe.$attrs$&&xe.$attrs$.ref&&xe.$attrs$.ref(null),xe.$children$&&xe.$children$.map(mi)},Pi=xe=>Kn(xe).$hostElement$,br=(xe,Oe,Lt)=>{const $t=Pi(xe);return{emit:tn=>wr($t,Oe,{bubbles:!!(4&Lt),composed:!!(2&Lt),cancelable:!!(1&Lt),detail:tn})}},wr=(xe,Oe,Lt)=>{const $t=me.ce(Oe,Lt);return xe.dispatchEvent($t),$t},Er=(xe,Oe)=>{Oe&&!xe.$onRenderResolve$&&Oe["s-p"]&&Oe["s-p"].push(new Promise(Lt=>xe.$onRenderResolve$=Lt))},ui=(xe,Oe)=>{if(xe.$flags$|=16,!(4&xe.$flags$))return Er(xe,xe.$ancestorComponent$),ri(()=>pn(xe,Oe));xe.$flags$|=512},pn=(xe,Oe)=>{const $t=xe.$lazyInstance$;let tn;return Oe&&(xe.$flags$|=256,xe.$queuedListeners$&&(xe.$queuedListeners$.map(([He,pt])=>R($t,He,pt)),xe.$queuedListeners$=null),tn=R($t,"componentWillLoad")),tn=j(tn,()=>R($t,"componentWillRender")),j(tn,()=>_t(xe,$t,Oe))},_t=function(){var xe=(0,h.Z)(function*(Oe,Lt,$t){const tn=Oe.$hostElement$,pt=tn["s-rc"];$t&&(xe=>{const Oe=xe.$cmpMeta$,Lt=xe.$hostElement$,$t=Oe.$flags$,He=Ft(Lt.shadowRoot?Lt.shadowRoot:Lt.getRootNode(),Oe,xe.$modeName$);10&$t&&(Lt["s-sc"]=He,Lt.classList.add(He+"-h"),2&$t&&Lt.classList.add(He+"-s"))})(Oe);kt(Oe,Lt),pt&&(pt.map(hn=>hn()),tn["s-rc"]=void 0);{const hn=tn["s-p"],nn=()=>gn(Oe);0===hn.length?nn():(Promise.all(hn).then(nn),Oe.$flags$|=4,hn.length=0)}});return function(Lt,$t,tn){return xe.apply(this,arguments)}}(),kt=(xe,Oe,Lt)=>{try{Oe=Oe.render&&Oe.render(),xe.$flags$&=-17,xe.$flags$|=2,((xe,Oe)=>{const Lt=xe.$hostElement$,$t=xe.$cmpMeta$,tn=xe.$vnode$||ut(null,null),He=(xe=>xe&&xe.$tag$===jt)(Oe)?Oe:un(null,null,Oe);if(Y=Lt.tagName,$t.$attrsToReflect$&&(He.$attrs$=He.$attrs$||{},$t.$attrsToReflect$.map(([pt,Yt])=>He.$attrs$[Yt]=Lt[pt])),He.$tag$=null,He.$flags$|=4,xe.$vnode$=He,He.$elm$=tn.$elm$=Lt.shadowRoot||Lt,ie=Lt["s-sc"],c=Lt["s-cr"],se=0!=(1&$t.$flags$),y=!1,Wt(tn,He),me.$flags$|=1,fe){Ai(He.$elm$);let pt,Yt,hn,nn,kn,ei,Ci=0;for(;Ci<fi.length;Ci++)pt=fi[Ci],Yt=pt.$nodeToRelocate$,Yt["s-ol"]||(hn=be.createTextNode(""),hn["s-nr"]=Yt,Yt.parentNode.insertBefore(Yt["s-ol"]=hn,Yt));for(Ci=0;Ci<fi.length;Ci++)if(pt=fi[Ci],Yt=pt.$nodeToRelocate$,pt.$slotRefNode$){for(nn=pt.$slotRefNode$.parentNode,kn=pt.$slotRefNode$.nextSibling,hn=Yt["s-ol"];hn=hn.previousSibling;)if(ei=hn["s-nr"],ei&&ei["s-sn"]===Yt["s-sn"]&&nn===ei.parentNode&&(ei=ei.nextSibling,!ei||!ei["s-nr"])){kn=ei;break}(!kn&&nn!==Yt.parentNode||Yt.nextSibling!==kn)&&Yt!==kn&&(!Yt["s-hn"]&&Yt["s-ol"]&&(Yt["s-hn"]=Yt["s-ol"].parentNode.nodeName),nn.insertBefore(Yt,kn))}else 1===Yt.nodeType&&(Yt.hidden=!0)}y&&Qt(He.$elm$),me.$flags$&=-2,fi.length=0})(xe,Oe)}catch($t){Cr($t,xe.$hostElement$)}return null},gn=xe=>{const Lt=xe.$hostElement$,tn=xe.$lazyInstance$,He=xe.$ancestorComponent$;R(tn,"componentDidRender"),64&xe.$flags$?R(tn,"componentDidUpdate"):(xe.$flags$|=64,de(Lt),R(tn,"componentDidLoad"),xe.$onReadyResolve$(Lt),He||le()),xe.$onInstanceResolve$(Lt),xe.$onRenderResolve$&&(xe.$onRenderResolve$(),xe.$onRenderResolve$=void 0),512&xe.$flags$&&Ln(()=>ui(xe,!1)),xe.$flags$&=-517},Ve=xe=>{{const Oe=Kn(xe),Lt=Oe.$hostElement$.isConnected;return Lt&&2==(18&Oe.$flags$)&&ui(Oe,!1),Lt}},le=xe=>{de(be.documentElement),Ln(()=>wr(Q,"appload",{detail:{namespace:"ionic"}}))},R=(xe,Oe,Lt)=>{if(xe&&xe[Oe])try{return xe[Oe](Lt)}catch($t){Cr($t)}},j=(xe,Oe)=>xe&&xe.then?xe.then(Oe):Oe(),de=xe=>xe.classList.add("hydrated"),st=(xe,Oe,Lt,$t,tn,He,pt)=>{let Yt,hn,nn,kn;if(1===He.nodeType){for(Yt=He.getAttribute("c-id"),Yt&&(hn=Yt.split("."),(hn[0]===pt||"0"===hn[0])&&(nn={$flags$:0,$hostId$:hn[0],$nodeId$:hn[1],$depth$:hn[2],$index$:hn[3],$tag$:He.tagName.toLowerCase(),$elm$:He,$attrs$:null,$children$:null,$key$:null,$name$:null,$text$:null},Oe.push(nn),He.removeAttribute("c-id"),xe.$children$||(xe.$children$=[]),xe.$children$[nn.$index$]=nn,xe=nn,$t&&"0"===nn.$depth$&&($t[nn.$index$]=nn.$elm$))),kn=He.childNodes.length-1;kn>=0;kn--)st(xe,Oe,Lt,$t,tn,He.childNodes[kn],pt);if(He.shadowRoot)for(kn=He.shadowRoot.childNodes.length-1;kn>=0;kn--)st(xe,Oe,Lt,$t,tn,He.shadowRoot.childNodes[kn],pt)}else if(8===He.nodeType)hn=He.nodeValue.split("."),(hn[1]===pt||"0"===hn[1])&&(Yt=hn[0],nn={$flags$:0,$hostId$:hn[1],$nodeId$:hn[2],$depth$:hn[3],$index$:hn[4],$elm$:He,$attrs$:null,$children$:null,$key$:null,$name$:null,$tag$:null,$text$:null},"t"===Yt?(nn.$elm$=He.nextSibling,nn.$elm$&&3===nn.$elm$.nodeType&&(nn.$text$=nn.$elm$.textContent,Oe.push(nn),He.remove(),xe.$children$||(xe.$children$=[]),xe.$children$[nn.$index$]=nn,$t&&"0"===nn.$depth$&&($t[nn.$index$]=nn.$elm$))):nn.$hostId$===pt&&("s"===Yt?(nn.$tag$="slot",He["s-sn"]=hn[5]?nn.$name$=hn[5]:"",He["s-sr"]=!0,$t&&(nn.$elm$=be.createElement(nn.$tag$),nn.$name$&&nn.$elm$.setAttribute("name",nn.$name$),He.parentNode.insertBefore(nn.$elm$,He),He.remove(),"0"===nn.$depth$&&($t[nn.$index$]=nn.$elm$)),Lt.push(nn),xe.$children$||(xe.$children$=[]),xe.$children$[nn.$index$]=nn):"r"===Yt&&($t?He.remove():(tn["s-cr"]=He,He["s-cn"]=!0))));else if(xe&&"style"===xe.$tag$){const ei=ut(null,He.textContent);ei.$elm$=He,ei.$index$="0",xe.$children$=[ei]}},Bt=(xe,Oe)=>{if(1===xe.nodeType){let Lt=0;for(;Lt<xe.childNodes.length;Lt++)Bt(xe.childNodes[Lt],Oe);if(xe.shadowRoot)for(Lt=0;Lt<xe.shadowRoot.childNodes.length;Lt++)Bt(xe.shadowRoot.childNodes[Lt],Oe)}else if(8===xe.nodeType){const Lt=xe.nodeValue.split(".");"o"===Lt[0]&&(Oe.set(Lt[1]+"."+Lt[2],xe),xe.nodeValue="",xe["s-en"]=Lt[3])}},Ue=(xe,Oe,Lt)=>{if(Oe.$members$){xe.watchers&&(Oe.$watchers$=xe.watchers);const $t=Object.entries(Oe.$members$),tn=xe.prototype;if($t.map(([He,[pt]])=>{31&pt||2&Lt&&32&pt?Object.defineProperty(tn,He,{get(){return((xe,Oe)=>Kn(this).$instanceValues$.get(Oe))(0,He)},set(Yt){((xe,Oe,Lt,$t)=>{const tn=Kn(xe),He=tn.$hostElement$,pt=tn.$instanceValues$.get(Oe),Yt=tn.$flags$,hn=tn.$lazyInstance$;Lt=((xe,Oe)=>null==xe||Fn(xe)?xe:4&Oe?"false"!==xe&&(""===xe||!!xe):2&Oe?parseFloat(xe):1&Oe?String(xe):xe)(Lt,$t.$members$[Oe][0]);const nn=Number.isNaN(pt)&&Number.isNaN(Lt);if((!(8&Yt)||void 0===pt)&&Lt!==pt&&!nn&&(tn.$instanceValues$.set(Oe,Lt),hn)){if($t.$watchers$&&128&Yt){const ei=$t.$watchers$[Oe];ei&&ei.map(Ci=>{try{hn[Ci](Lt,pt,Oe)}catch(qi){Cr(qi,He)}})}2==(18&Yt)&&ui(tn,!1)}})(this,He,Yt,Oe)},configurable:!0,enumerable:!0}):1&Lt&&64&pt&&Object.defineProperty(tn,He,{value(...Yt){const hn=Kn(this);return hn.$onInstancePromise$.then(()=>hn.$lazyInstance$[He](...Yt))}})}),1&Lt){const He=new Map;tn.attributeChangedCallback=function(pt,Yt,hn){me.jmp(()=>{const nn=He.get(pt);if(this.hasOwnProperty(nn))hn=this[nn],delete this[nn];else if(tn.hasOwnProperty(nn)&&"number"==typeof this[nn]&&this[nn]==hn)return;this[nn]=(null!==hn||"boolean"!=typeof this[nn])&&hn})},xe.observedAttributes=$t.filter(([pt,Yt])=>15&Yt[0]).map(([pt,Yt])=>{const hn=Yt[1]||pt;return He.set(hn,pt),512&Yt[0]&&Oe.$attrsToReflect$.push([pt,hn]),hn})}}return xe},Re=function(){var xe=(0,h.Z)(function*(Oe,Lt,$t,tn,He){if(0==(32&Lt.$flags$)){{if(Lt.$flags$|=32,(He=ar($t)).then){const nn=()=>{};He=yield He,nn()}He.isProxied||($t.$watchers$=He.watchers,Ue(He,$t,2),He.isProxied=!0);const hn=()=>{};Lt.$flags$|=8;try{new He(Lt)}catch(nn){Cr(nn)}Lt.$flags$&=-9,Lt.$flags$|=128,hn(),nt(Lt.$lazyInstance$)}if(He.style){let hn=He.style;"string"!=typeof hn&&(hn=hn[Lt.$modeName$=(xe=>xo.map(Oe=>Oe(xe)).find(Oe=>!!Oe))(Oe)]);const nn=Pt($t,Lt.$modeName$);if(!pr.has(nn)){const kn=()=>{};qt(nn,hn,!!(1&$t.$flags$)),kn()}}}const pt=Lt.$ancestorComponent$,Yt=()=>ui(Lt,!0);pt&&pt["s-rc"]?pt["s-rc"].push(Yt):Yt()});return function(Lt,$t,tn,He,pt){return xe.apply(this,arguments)}}(),nt=xe=>{R(xe,"connectedCallback")},_n=xe=>{const Oe=xe["s-cr"]=be.createComment("");Oe["s-cn"]=!0,xe.insertBefore(Oe,xe.firstChild)},Yn=(xe,Oe={})=>{const $t=[],tn=Oe.exclude||[],He=Q.customElements,pt=be.head,Yt=pt.querySelector("meta[charset]"),hn=be.createElement("style"),nn=[],kn=be.querySelectorAll(`[${Je}]`);let ei,Ci=!0,qi=0;for(Object.assign(me,Oe),me.$resourcesUrl$=new URL(Oe.resourcesUrl||"./",be.baseURI).href,me.$flags$|=2;qi<kn.length;qi++)qt(kn[qi].getAttribute(Je),bt(kn[qi].innerHTML),!0);xe.map(ki=>{ki[1].map(jr=>{const Rr={$flags$:jr[0],$tagName$:jr[1],$members$:jr[2],$listeners$:jr[3]};Rr.$members$=jr[2],Rr.$listeners$=jr[3],Rr.$attrsToReflect$=[],Rr.$watchers$={};const tr=Rr.$tagName$,fr=class extends HTMLElement{constructor(es){super(es),Bi(es=this,Rr),1&Rr.$flags$&&es.attachShadow({mode:"open",delegatesFocus:!!(16&Rr.$flags$)})}connectedCallback(){ei&&(clearTimeout(ei),ei=null),Ci?nn.push(this):me.jmp(()=>(xe=>{if(0==(1&me.$flags$)){const Oe=Kn(xe),Lt=Oe.$cmpMeta$,$t=()=>{};if(1&Oe.$flags$)te(xe,Oe,Lt.$listeners$),nt(Oe.$lazyInstance$);else{let tn;if(Oe.$flags$|=1,tn=xe.getAttribute(et),tn){if(1&Lt.$flags$){const He=Ft(xe.shadowRoot,Lt,xe.getAttribute("s-mode"));xe.classList.remove(He+"-h",He+"-s")}((xe,Oe,Lt,$t)=>{const He=xe.shadowRoot,pt=[],hn=He?[]:null,nn=$t.$vnode$=ut(Oe,null);me.$orgLocNodes$||Bt(be.body,me.$orgLocNodes$=new Map),xe[et]=Lt,xe.removeAttribute(et),st(nn,pt,[],hn,xe,xe,Lt),pt.map(kn=>{const ei=kn.$hostId$+"."+kn.$nodeId$,Ci=me.$orgLocNodes$.get(ei),qi=kn.$elm$;Ci&&""===Ci["s-en"]&&Ci.parentNode.insertBefore(qi,Ci.nextSibling),He||(qi["s-hn"]=Oe,Ci&&(qi["s-ol"]=Ci,qi["s-ol"]["s-nr"]=qi)),me.$orgLocNodes$.delete(ei)}),He&&hn.map(kn=>{kn&&He.appendChild(kn)})})(xe,Lt.$tagName$,tn,Oe)}tn||12&Lt.$flags$&&_n(xe);{let He=xe;for(;He=He.parentNode||He.host;)if(1===He.nodeType&&He.hasAttribute("s-id")&&He["s-p"]||He["s-p"]){Er(Oe,Oe.$ancestorComponent$=He);break}}Lt.$members$&&Object.entries(Lt.$members$).map(([He,[pt]])=>{if(31&pt&&xe.hasOwnProperty(He)){const Yt=xe[He];delete xe[He],xe[He]=Yt}}),Ln(()=>Re(xe,Oe,Lt))}$t()}})(this))}disconnectedCallback(){me.jmp(()=>(xe=>{if(0==(1&me.$flags$)){const Oe=Kn(this),Lt=Oe.$lazyInstance$;Oe.$rmListeners$&&(Oe.$rmListeners$.map($t=>$t()),Oe.$rmListeners$=void 0),R(Lt,"disconnectedCallback")}})())}componentOnReady(){return Kn(this).$onReadyPromise$}};Rr.$lazyBundleId$=ki[0],!tn.includes(tr)&&!He.get(tr)&&($t.push(tr),He.define(tr,Ue(fr,Rr,1)))})}),hn.innerHTML=$t+"{visibility:hidden}.hydrated{visibility:inherit}",hn.setAttribute("data-styles",""),pt.insertBefore(hn,Yt?Yt.nextSibling:pt.firstChild),Ci=!1,nn.length?nn.map(ki=>ki.connectedCallback()):me.jmp(()=>ei=setTimeout(le,30))},di=xe=>{const Oe=new URL(xe,me.$resourcesUrl$);return Oe.origin!==Q.location.origin?Oe.href:Oe.pathname},gi=new WeakMap,Kn=xe=>gi.get(xe),Vi=(xe,Oe)=>gi.set(Oe.$lazyInstance$=xe,Oe),Bi=(xe,Oe)=>{const Lt={$flags$:0,$hostElement$:xe,$cmpMeta$:Oe,$instanceValues$:new Map};return Lt.$onInstancePromise$=new Promise($t=>Lt.$onInstanceResolve$=$t),Lt.$onReadyPromise$=new Promise($t=>Lt.$onReadyResolve$=$t),xe["s-p"]=[],xe["s-rc"]=[],te(xe,Lt,Oe.$listeners$),gi.set(xe,Lt)},Qr=(xe,Oe)=>Oe in xe,Cr=(xe,Oe)=>(0,console.error)(xe,Oe),on=new Map,ar=(xe,Oe,Lt)=>{const $t=xe.$tagName$.replace(/-/g,"_"),tn=xe.$lazyBundleId$,He=on.get(tn);return He?He[$t]:B(863)(`./${tn}.entry.js`).then(pt=>(on.set(tn,pt),pt[$t]),Cr)},pr=new Map,xo=[],zo=[],Br=[],Oi=(xe,Oe)=>Lt=>{xe.push(Lt),Ge||(Ge=!0,Oe&&4&me.$flags$?Ln(cr):me.raf(cr))},lr=xe=>{for(let Oe=0;Oe<xe.length;Oe++)try{xe[Oe](performance.now())}catch(Lt){Cr(Lt)}xe.length=0},cr=()=>{lr(zo),lr(Br),(Ge=zo.length>0)&&me.raf(cr)},Ln=xe=>Ke().then(xe),hi=Oi(zo,!1),ri=Oi(Br,!0),Wn={isDev:!1,isBrowser:!0,isServer:!1,isTesting:!1}},697:(Rn,Dt,B)=>{"use strict";B.d(Dt,{L:()=>c,a:()=>Y,b:()=>se,c:()=>y,d:()=>fe,e:()=>we,g:()=>_e,l:()=>Fe,s:()=>et,t:()=>Q});var h=B(5861),g=B(1308),ie=B(5730);const c="ionViewWillEnter",Y="ionViewDidEnter",se="ionViewWillLeave",y="ionViewDidLeave",fe="ionViewWillUnload",Q=pe=>new Promise((ae,Ee)=>{(0,g.c)(()=>{be(pe),me(pe).then(vt=>{vt.animation&&vt.animation.destroy(),Ze(pe),ae(vt)},vt=>{Ze(pe),Ee(vt)})})}),be=pe=>{const ae=pe.enteringEl,Ee=pe.leavingEl;Je(ae,Ee,pe.direction),pe.showGoBack?ae.classList.add("can-go-back"):ae.classList.remove("can-go-back"),et(ae,!1),ae.style.setProperty("pointer-events","none"),Ee&&(et(Ee,!1),Ee.style.setProperty("pointer-events","none"))},me=function(){var pe=(0,h.Z)(function*(ae){const Ee=yield he(ae);return Ee&&g.B.isBrowser?Ke(Ee,ae):Ae(ae)});return function(Ee){return pe.apply(this,arguments)}}(),Ze=pe=>{const ae=pe.enteringEl,Ee=pe.leavingEl;ae.classList.remove("ion-page-invisible"),ae.style.removeProperty("pointer-events"),void 0!==Ee&&(Ee.classList.remove("ion-page-invisible"),Ee.style.removeProperty("pointer-events"))},he=function(){var pe=(0,h.Z)(function*(ae){return ae.leavingEl&&ae.animated&&0!==ae.duration?ae.animationBuilder?ae.animationBuilder:"ios"===ae.mode?(yield Promise.resolve().then(B.bind(B,3953))).iosTransitionAnimation:(yield Promise.resolve().then(B.bind(B,3880))).mdTransitionAnimation:void 0});return function(Ee){return pe.apply(this,arguments)}}(),Ke=function(){var pe=(0,h.Z)(function*(ae,Ee){yield te(Ee,!0);const vt=ae(Ee.baseEl,Ee);dt(Ee.enteringEl,Ee.leavingEl);const Et=yield Ot(vt,Ee);return Ee.progressCallback&&Ee.progressCallback(void 0),Et&&ye(Ee.enteringEl,Ee.leavingEl),{hasCompleted:Et,animation:vt}});return function(Ee,vt){return pe.apply(this,arguments)}}(),Ae=function(){var pe=(0,h.Z)(function*(ae){const Ee=ae.enteringEl,vt=ae.leavingEl;return yield te(ae,!1),dt(Ee,vt),ye(Ee,vt),{hasCompleted:!0}});return function(Ee){return pe.apply(this,arguments)}}(),te=function(){var pe=(0,h.Z)(function*(ae,Ee){const Et=(void 0!==ae.deepWait?ae.deepWait:Ee)?[we(ae.enteringEl),we(ae.leavingEl)]:[Ne(ae.enteringEl),Ne(ae.leavingEl)];yield Promise.all(Et),yield Qe(ae.viewIsReady,ae.enteringEl)});return function(Ee,vt){return pe.apply(this,arguments)}}(),Qe=function(){var pe=(0,h.Z)(function*(ae,Ee){ae&&(yield ae(Ee))});return function(Ee,vt){return pe.apply(this,arguments)}}(),Ot=(pe,ae)=>{const Ee=ae.progressCallback,vt=new Promise(Et=>{pe.onFinish(qt=>Et(1===qt))});return Ee?(pe.progressStart(!0),Ee(pe)):pe.play(),vt},dt=(pe,ae)=>{Fe(ae,se),Fe(pe,c)},ye=(pe,ae)=>{Fe(pe,Y),Fe(ae,y)},Fe=(pe,ae)=>{if(pe){const Ee=new CustomEvent(ae,{bubbles:!1,cancelable:!1});pe.dispatchEvent(Ee)}},Ne=pe=>pe?new Promise(ae=>(0,ie.c)(pe,ae)):Promise.resolve(),we=function(){var pe=(0,h.Z)(function*(ae){const Ee=ae;if(Ee){if(null!=Ee.componentOnReady){if(null!=(yield Ee.componentOnReady()))return}else if(null!=Ee.__registerHost)return void(yield new Promise(Et=>(0,ie.r)(Et)));yield Promise.all(Array.from(Ee.children).map(we))}});return function(Ee){return pe.apply(this,arguments)}}(),et=(pe,ae)=>{ae?(pe.setAttribute("aria-hidden","true"),pe.classList.add("ion-page-hidden")):(pe.hidden=!1,pe.removeAttribute("aria-hidden"),pe.classList.remove("ion-page-hidden"))},Je=(pe,ae,Ee)=>{void 0!==pe&&(pe.style.zIndex="back"===Ee?"99":"101"),void 0!==ae&&(ae.style.zIndex="100")},_e=pe=>pe.classList.contains("ion-page")?pe:pe.querySelector(":scope > .ion-page, :scope > ion-nav, :scope > ion-tabs")||pe},1911:(Rn,Dt,B)=>{"use strict";B.r(Dt),B.d(Dt,{GESTURE_CONTROLLER:()=>h.G,createGesture:()=>Ie});var h=B(4349);const g=(me,Ze,he,Ke)=>{const Ae=ie(me)?{capture:!!Ke.capture,passive:!!Ke.passive}:!!Ke.capture;let te,Qe;return me.__zone_symbol__addEventListener?(te="__zone_symbol__addEventListener",Qe="__zone_symbol__removeEventListener"):(te="addEventListener",Qe="removeEventListener"),me[te](Ze,he,Ae),()=>{me[Qe](Ze,he,Ae)}},ie=me=>{if(void 0===c)try{const Ze=Object.defineProperty({},"passive",{get:()=>{c=!0}});me.addEventListener("optsTest",()=>{},Ze)}catch{c=!1}return!!c};let c;const y=me=>me instanceof Document?me:me.ownerDocument,Ie=me=>{let Ze=!1,he=!1,Ke=!0,Ae=!1;const te=Object.assign({disableScroll:!1,direction:"x",gesturePriority:0,passive:!0,maxAngle:40,threshold:10},me),Qe=te.canStart,Ot=te.onWillStart,dt=te.onStart,ye=te.onEnd,Fe=te.notCaptured,Ne=te.onMove,we=te.threshold,et=te.passive,Je=te.blurOnStart,_e={type:"pan",startX:0,startY:0,startTime:0,currentX:0,currentY:0,velocityX:0,velocityY:0,deltaX:0,deltaY:0,currentTime:0,event:void 0,data:void 0},pe=((me,Ze,he)=>{const Ke=he*(Math.PI/180),Ae="x"===me,te=Math.cos(Ke),Qe=Ze*Ze;let Ot=0,dt=0,ye=!1,Fe=0;return{start(Ne,we){Ot=Ne,dt=we,Fe=0,ye=!0},detect(Ne,we){if(!ye)return!1;const et=Ne-Ot,Je=we-dt,_e=et*et+Je*Je;if(_e<Qe)return!1;const pe=Math.sqrt(_e),ae=(Ae?et:Je)/pe;return Fe=ae>te?1:ae<-te?-1:0,ye=!1,!0},isGesture:()=>0!==Fe,getDirection:()=>Fe}})(te.direction,te.threshold,te.maxAngle),ae=h.G.createGesture({name:me.gestureName,priority:me.gesturePriority,disableScroll:me.disableScroll}),Et=()=>{!Ze||(Ae=!1,Ne&&Ne(_e))},qt=()=>!!ae.capture()&&(Ze=!0,Ke=!1,_e.startX=_e.currentX,_e.startY=_e.currentY,_e.startTime=_e.currentTime,Ot?Ot(_e).then(xt):xt(),!0),xt=()=>{Je&&(()=>{if(typeof document<"u"){const Ce=document.activeElement;Ce?.blur&&Ce.blur()}})(),dt&&dt(_e),Ke=!0},Pt=()=>{Ze=!1,he=!1,Ae=!1,Ke=!0,ae.release()},bt=Ce=>{const Ct=Ze,Ut=Ke;if(Pt(),Ut){if(Ge(_e,Ce),Ct)return void(ye&&ye(_e));Fe&&Fe(_e)}},ct=((me,Ze,he,Ke,Ae)=>{let te,Qe,Ot,dt,ye,Fe,Ne,we=0;const et=Ft=>{we=Date.now()+2e3,Ze(Ft)&&(!Qe&&he&&(Qe=g(me,"touchmove",he,Ae)),Ot||(Ot=g(Ft.target,"touchend",_e,Ae)),dt||(dt=g(Ft.target,"touchcancel",_e,Ae)))},Je=Ft=>{we>Date.now()||!Ze(Ft)||(!Fe&&he&&(Fe=g(y(me),"mousemove",he,Ae)),Ne||(Ne=g(y(me),"mouseup",pe,Ae)))},_e=Ft=>{ae(),Ke&&Ke(Ft)},pe=Ft=>{Ee(),Ke&&Ke(Ft)},ae=()=>{Qe&&Qe(),Ot&&Ot(),dt&&dt(),Qe=Ot=dt=void 0},Ee=()=>{Fe&&Fe(),Ne&&Ne(),Fe=Ne=void 0},vt=()=>{ae(),Ee()},Et=(Ft=!0)=>{Ft?(te||(te=g(me,"touchstart",et,Ae)),ye||(ye=g(me,"mousedown",Je,Ae))):(te&&te(),ye&&ye(),te=ye=void 0,vt())};return{enable:Et,stop:vt,destroy:()=>{Et(!1),Ke=he=Ze=void 0}}})(te.el,Ce=>{const Ct=be(Ce);return!(he||!Ke||(Q(Ce,_e),_e.startX=_e.currentX,_e.startY=_e.currentY,_e.startTime=_e.currentTime=Ct,_e.velocityX=_e.velocityY=_e.deltaX=_e.deltaY=0,_e.event=Ce,Qe&&!1===Qe(_e))||(ae.release(),!ae.start()))&&(he=!0,0===we?qt():(pe.start(_e.startX,_e.startY),!0))},Ce=>{Ze?!Ae&&Ke&&(Ae=!0,Ge(_e,Ce),requestAnimationFrame(Et)):(Ge(_e,Ce),pe.detect(_e.currentX,_e.currentY)&&(!pe.isGesture()||!qt())&&ht())},bt,{capture:!1,passive:et}),ht=()=>{Pt(),ct.stop(),Fe&&Fe(_e)};return{enable(Ce=!0){Ce||(Ze&&bt(void 0),Pt()),ct.enable(Ce)},destroy(){ae.destroy(),ct.destroy()}}},Ge=(me,Ze)=>{if(!Ze)return;const he=me.currentX,Ke=me.currentY,Ae=me.currentTime;Q(Ze,me);const te=me.currentX,Qe=me.currentY,dt=(me.currentTime=be(Ze))-Ae;if(dt>0&&dt<100){const Fe=(Qe-Ke)/dt;me.velocityX=(te-he)/dt*.7+.3*me.velocityX,me.velocityY=.7*Fe+.3*me.velocityY}me.deltaX=te-me.startX,me.deltaY=Qe-me.startY,me.event=Ze},Q=(me,Ze)=>{let he=0,Ke=0;if(me){const Ae=me.changedTouches;if(Ae&&Ae.length>0){const te=Ae[0];he=te.clientX,Ke=te.clientY}else void 0!==me.pageX&&(he=me.pageX,Ke=me.pageY)}Ze.currentX=he,Ze.currentY=Ke},be=me=>me.timeStamp||Date.now()},9658:(Rn,Dt,B)=>{"use strict";B.d(Dt,{a:()=>Q,b:()=>Et,c:()=>ie,g:()=>Ge,i:()=>qt});var h=B(1308);class g{constructor(){this.m=new Map}reset(xt){this.m=new Map(Object.entries(xt))}get(xt,Pt){const bt=this.m.get(xt);return void 0!==bt?bt:Pt}getBoolean(xt,Pt=!1){const bt=this.m.get(xt);return void 0===bt?Pt:"string"==typeof bt?"true"===bt:!!bt}getNumber(xt,Pt){const bt=parseFloat(this.m.get(xt));return isNaN(bt)?void 0!==Pt?Pt:NaN:bt}set(xt,Pt){this.m.set(xt,Pt)}}const ie=new g,Ie="ionic-persist-config",Ge=Ft=>be(Ft),Q=(Ft,xt)=>("string"==typeof Ft&&(xt=Ft,Ft=void 0),Ge(Ft).includes(xt)),be=(Ft=window)=>{if(typeof Ft>"u")return[];Ft.Ionic=Ft.Ionic||{};let xt=Ft.Ionic.platforms;return null==xt&&(xt=Ft.Ionic.platforms=me(Ft),xt.forEach(Pt=>Ft.document.documentElement.classList.add(`plt-${Pt}`))),xt},me=Ft=>{const xt=ie.get("platform");return Object.keys(Ee).filter(Pt=>{const bt=xt?.[Pt];return"function"==typeof bt?bt(Ft):Ee[Pt](Ft)})},he=Ft=>!!(pe(Ft,/iPad/i)||pe(Ft,/Macintosh/i)&&ye(Ft)),te=Ft=>pe(Ft,/android|sink/i),ye=Ft=>ae(Ft,"(any-pointer:coarse)"),Ne=Ft=>we(Ft)||et(Ft),we=Ft=>!!(Ft.cordova||Ft.phonegap||Ft.PhoneGap),et=Ft=>!!Ft.Capacitor?.isNative,pe=(Ft,xt)=>xt.test(Ft.navigator.userAgent),ae=(Ft,xt)=>{var Pt;return null===(Pt=Ft.matchMedia)||void 0===Pt?void 0:Pt.call(Ft,xt).matches},Ee={ipad:he,iphone:Ft=>pe(Ft,/iPhone/i),ios:Ft=>pe(Ft,/iPhone|iPod/i)||he(Ft),android:te,phablet:Ft=>{const xt=Ft.innerWidth,Pt=Ft.innerHeight,bt=Math.min(xt,Pt),ct=Math.max(xt,Pt);return bt>390&&bt<520&&ct>620&&ct<800},tablet:Ft=>{const xt=Ft.innerWidth,Pt=Ft.innerHeight,bt=Math.min(xt,Pt),ct=Math.max(xt,Pt);return he(Ft)||(Ft=>te(Ft)&&!pe(Ft,/mobile/i))(Ft)||bt>460&&bt<820&&ct>780&&ct<1400},cordova:we,capacitor:et,electron:Ft=>pe(Ft,/electron/i),pwa:Ft=>{var xt;return!(!(null===(xt=Ft.matchMedia)||void 0===xt?void 0:xt.call(Ft,"(display-mode: standalone)").matches)&&!Ft.navigator.standalone)},mobile:ye,mobileweb:Ft=>ye(Ft)&&!Ne(Ft),desktop:Ft=>!ye(Ft),hybrid:Ne};let vt;const Et=Ft=>Ft&&(0,h.g)(Ft)||vt,qt=(Ft={})=>{if(typeof window>"u")return;const xt=window.document,Pt=window,bt=Pt.Ionic=Pt.Ionic||{},ct={};Ft._ael&&(ct.ael=Ft._ael),Ft._rel&&(ct.rel=Ft._rel),Ft._ce&&(ct.ce=Ft._ce),(0,h.s)(ct);const ht=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},(Ft=>{try{const xt=Ft.sessionStorage.getItem(Ie);return null!==xt?JSON.parse(xt):{}}catch{return{}}})(Pt)),{persistConfig:!1}),bt.config),(Ft=>{const xt={};return Ft.location.search.slice(1).split("&").map(Pt=>Pt.split("=")).map(([Pt,bt])=>[decodeURIComponent(Pt),decodeURIComponent(bt)]).filter(([Pt])=>((Ft,xt)=>Ft.substr(0,xt.length)===xt)(Pt,"ionic:")).map(([Pt,bt])=>[Pt.slice("ionic:".length),bt]).forEach(([Pt,bt])=>{xt[Pt]=bt}),xt})(Pt)),Ft);ie.reset(ht),ie.getBoolean("persistConfig")&&((Ft,xt)=>{try{Ft.sessionStorage.setItem(Ie,JSON.stringify(xt))}catch{return}})(Pt,ht),be(Pt),bt.config=ie,bt.mode=vt=ie.get("mode",xt.documentElement.getAttribute("mode")||(Q(Pt,"ios")?"ios":"md")),ie.set("mode",vt),xt.documentElement.setAttribute("mode",vt),xt.documentElement.classList.add(vt),ie.getBoolean("_testing")&&ie.set("animated",!1);const Ce=Ut=>{var Gt;return null===(Gt=Ut.tagName)||void 0===Gt?void 0:Gt.startsWith("ION-")},Ct=Ut=>["ios","md"].includes(Ut);(0,h.a)(Ut=>{for(;Ut;){const Gt=Ut.mode||Ut.getAttribute("mode");if(Gt){if(Ct(Gt))return Gt;Ce(Ut)&&console.warn('Invalid ionic mode: "'+Gt+'", expected: "ios" or "md"')}Ut=Ut.parentElement}return vt})}},3953:(Rn,Dt,B)=>{"use strict";B.r(Dt),B.d(Dt,{iosTransitionAnimation:()=>me,shadow:()=>y});var h=B(8834),g=B(697);B(3457),B(1308);const se=Ze=>document.querySelector(`${Ze}.ion-cloned-element`),y=Ze=>Ze.shadowRoot||Ze,fe=Ze=>{const he="ION-TABS"===Ze.tagName?Ze:Ze.querySelector("ion-tabs"),Ke="ion-content ion-header:not(.header-collapse-condense-inactive) ion-title.title-large";if(null!=he){const Ae=he.querySelector("ion-tab:not(.tab-hidden), .ion-page:not(.ion-page-hidden)");return null!=Ae?Ae.querySelector(Ke):null}return Ze.querySelector(Ke)},Ie=(Ze,he)=>{const Ke="ION-TABS"===Ze.tagName?Ze:Ze.querySelector("ion-tabs");let Ae=[];if(null!=Ke){const te=Ke.querySelector("ion-tab:not(.tab-hidden), .ion-page:not(.ion-page-hidden)");null!=te&&(Ae=te.querySelectorAll("ion-buttons"))}else Ae=Ze.querySelectorAll("ion-buttons");for(const te of Ae){const Qe=te.closest("ion-header"),Ot=Qe&&!Qe.classList.contains("header-collapse-condense-inactive"),dt=te.querySelector("ion-back-button"),ye=te.classList.contains("buttons-collapse"),Fe="start"===te.slot||""===te.slot;if(null!==dt&&Fe&&(ye&&Ot&&he||!ye))return dt}return null},Q=(Ze,he,Ke,Ae,te,Qe)=>{const Ot=he?`calc(100% - ${Qe.right+4}px)`:Qe.left-4+"px",dt=he?"7px":"-7px",ye=he?"-4px":"4px",Fe=he?"-4px":"4px",Ne=he?"right":"left",we=he?"left":"right",_e=Ke?[{offset:0,opacity:1,transform:`translate3d(${ye}, ${Qe.top-46}px, 0) scale(1)`},{offset:.6,opacity:0},{offset:1,opacity:0,transform:`translate3d(${dt}, ${te.top-40}px, 0) scale(2.1)`}]:[{offset:0,opacity:0,transform:`translate3d(${dt}, ${te.top-40}px, 0) scale(2.1)`},{offset:1,opacity:1,transform:`translate3d(${ye}, ${Qe.top-46}px, 0) scale(1)`}],Ee=Ke?[{offset:0,opacity:1,transform:`translate3d(${Fe}, ${Qe.top-46}px, 0) scale(1)`},{offset:.2,opacity:0,transform:`translate3d(${Fe}, ${Qe.top-41}px, 0) scale(0.6)`},{offset:1,opacity:0,transform:`translate3d(${Fe}, ${Qe.top-41}px, 0) scale(0.6)`}]:[{offset:0,opacity:0,transform:`translate3d(${Fe}, ${Qe.top-41}px, 0) scale(0.6)`},{offset:1,opacity:1,transform:`translate3d(${Fe}, ${Qe.top-46}px, 0) scale(1)`}],vt=(0,h.c)(),Et=(0,h.c)(),qt=se("ion-back-button"),Ft=y(qt).querySelector(".button-text"),xt=y(qt).querySelector("ion-icon");qt.text=Ae.text,qt.mode=Ae.mode,qt.icon=Ae.icon,qt.color=Ae.color,qt.disabled=Ae.disabled,qt.style.setProperty("display","block"),qt.style.setProperty("position","fixed"),Et.addElement(xt),vt.addElement(Ft),vt.beforeStyles({"transform-origin":`${Ne} center`}).beforeAddWrite(()=>{Ae.style.setProperty("display","none"),qt.style.setProperty(Ne,Ot)}).afterAddWrite(()=>{Ae.style.setProperty("display",""),qt.style.setProperty("display","none"),qt.style.removeProperty(Ne)}).keyframes(_e),Et.beforeStyles({"transform-origin":`${we} center`}).keyframes(Ee),Ze.addAnimation([vt,Et])},be=(Ze,he,Ke,Ae,te,Qe)=>{const Ot=he?`calc(100% - ${te.right}px)`:`${te.left}px`,dt=he?"-18px":"18px",ye=he?"right":"left",we=Ke?[{offset:0,opacity:0,transform:`translate3d(${dt}, ${Qe.top-4}px, 0) scale(0.49)`},{offset:.1,opacity:0},{offset:1,opacity:1,transform:`translate3d(0, ${te.top-2}px, 0) scale(1)`}]:[{offset:0,opacity:.99,transform:`translate3d(0, ${te.top-2}px, 0) scale(1)`},{offset:.6,opacity:0},{offset:1,opacity:0,transform:`translate3d(${dt}, ${Qe.top-4}px, 0) scale(0.5)`}],et=se("ion-title"),Je=(0,h.c)();et.innerText=Ae.innerText,et.size=Ae.size,et.color=Ae.color,Je.addElement(et),Je.beforeStyles({"transform-origin":`${ye} center`,height:"46px",display:"",position:"relative",[ye]:Ot}).beforeAddWrite(()=>{Ae.style.setProperty("display","none")}).afterAddWrite(()=>{Ae.style.setProperty("display",""),et.style.setProperty("display","none")}).keyframes(we),Ze.addAnimation(Je)},me=(Ze,he)=>{var Ke;try{const Ae="cubic-bezier(0.32,0.72,0,1)",te="opacity",Qe="transform",Ot="0%",ye="rtl"===Ze.ownerDocument.dir,Fe=ye?"-99.5%":"99.5%",Ne=ye?"33%":"-33%",we=he.enteringEl,et=he.leavingEl,Je="back"===he.direction,_e=we.querySelector(":scope > ion-content"),pe=we.querySelectorAll(":scope > ion-header > *:not(ion-toolbar), :scope > ion-footer > *"),ae=we.querySelectorAll(":scope > ion-header > ion-toolbar"),Ee=(0,h.c)(),vt=(0,h.c)();if(Ee.addElement(we).duration((null!==(Ke=he.duration)&&void 0!==Ke?Ke:0)||540).easing(he.easing||Ae).fill("both").beforeRemoveClass("ion-page-invisible"),et&&null!=Ze){const xt=(0,h.c)();xt.addElement(Ze),Ee.addAnimation(xt)}if(_e||0!==ae.length||0!==pe.length?(vt.addElement(_e),vt.addElement(pe)):vt.addElement(we.querySelector(":scope > .ion-page, :scope > ion-nav, :scope > ion-tabs")),Ee.addAnimation(vt),Je?vt.beforeClearStyles([te]).fromTo("transform",`translateX(${Ne})`,`translateX(${Ot})`).fromTo(te,.8,1):vt.beforeClearStyles([te]).fromTo("transform",`translateX(${Fe})`,`translateX(${Ot})`),_e){const xt=y(_e).querySelector(".transition-effect");if(xt){const Pt=xt.querySelector(".transition-cover"),bt=xt.querySelector(".transition-shadow"),ct=(0,h.c)(),ht=(0,h.c)(),Ce=(0,h.c)();ct.addElement(xt).beforeStyles({opacity:"1",display:"block"}).afterStyles({opacity:"",display:""}),ht.addElement(Pt).beforeClearStyles([te]).fromTo(te,0,.1),Ce.addElement(bt).beforeClearStyles([te]).fromTo(te,.03,.7),ct.addAnimation([ht,Ce]),vt.addAnimation([ct])}}const Et=we.querySelector("ion-header.header-collapse-condense"),{forward:qt,backward:Ft}=((Ze,he,Ke,Ae,te)=>{const Qe=Ie(Ae,Ke),Ot=fe(te),dt=fe(Ae),ye=Ie(te,Ke),Fe=null!==Qe&&null!==Ot&&!Ke,Ne=null!==dt&&null!==ye&&Ke;if(Fe){const we=Ot.getBoundingClientRect(),et=Qe.getBoundingClientRect();be(Ze,he,Ke,Ot,we,et),Q(Ze,he,Ke,Qe,we,et)}else if(Ne){const we=dt.getBoundingClientRect(),et=ye.getBoundingClientRect();be(Ze,he,Ke,dt,we,et),Q(Ze,he,Ke,ye,we,et)}return{forward:Fe,backward:Ne}})(Ee,ye,Je,we,et);if(ae.forEach(xt=>{const Pt=(0,h.c)();Pt.addElement(xt),Ee.addAnimation(Pt);const bt=(0,h.c)();bt.addElement(xt.querySelector("ion-title"));const ct=(0,h.c)(),ht=Array.from(xt.querySelectorAll("ion-buttons,[menuToggle]")),Ce=xt.closest("ion-header"),Ct=Ce?.classList.contains("header-collapse-condense-inactive");let Ut;Ut=ht.filter(Je?ut=>{const jt=ut.classList.contains("buttons-collapse");return jt&&!Ct||!jt}:ut=>!ut.classList.contains("buttons-collapse")),ct.addElement(Ut);const Gt=(0,h.c)();Gt.addElement(xt.querySelectorAll(":scope > *:not(ion-title):not(ion-buttons):not([menuToggle])"));const wn=(0,h.c)();wn.addElement(y(xt).querySelector(".toolbar-background"));const Fn=(0,h.c)(),un=xt.querySelector("ion-back-button");if(un&&Fn.addElement(un),Pt.addAnimation([bt,ct,Gt,wn,Fn]),ct.fromTo(te,.01,1),Gt.fromTo(te,.01,1),Je)Ct||bt.fromTo("transform",`translateX(${Ne})`,`translateX(${Ot})`).fromTo(te,.01,1),Gt.fromTo("transform",`translateX(${Ne})`,`translateX(${Ot})`),Fn.fromTo(te,.01,1);else if(Et||bt.fromTo("transform",`translateX(${Fe})`,`translateX(${Ot})`).fromTo(te,.01,1),Gt.fromTo("transform",`translateX(${Fe})`,`translateX(${Ot})`),wn.beforeClearStyles([te,"transform"]),Ce?.translucent?wn.fromTo("transform",ye?"translateX(-100%)":"translateX(100%)","translateX(0px)"):wn.fromTo(te,.01,"var(--opacity)"),qt||Fn.fromTo(te,.01,1),un&&!qt){const jt=(0,h.c)();jt.addElement(y(un).querySelector(".button-text")).fromTo("transform",ye?"translateX(-100px)":"translateX(100px)","translateX(0px)"),Pt.addAnimation(jt)}}),et){const xt=(0,h.c)(),Pt=et.querySelector(":scope > ion-content"),bt=et.querySelectorAll(":scope > ion-header > ion-toolbar"),ct=et.querySelectorAll(":scope > ion-header > *:not(ion-toolbar), :scope > ion-footer > *");if(Pt||0!==bt.length||0!==ct.length?(xt.addElement(Pt),xt.addElement(ct)):xt.addElement(et.querySelector(":scope > .ion-page, :scope > ion-nav, :scope > ion-tabs")),Ee.addAnimation(xt),Je){xt.beforeClearStyles([te]).fromTo("transform",`translateX(${Ot})`,ye?"translateX(-100%)":"translateX(100%)");const ht=(0,g.g)(et);Ee.afterAddWrite(()=>{"normal"===Ee.getDirection()&&ht.style.setProperty("display","none")})}else xt.fromTo("transform",`translateX(${Ot})`,`translateX(${Ne})`).fromTo(te,1,.8);if(Pt){const ht=y(Pt).querySelector(".transition-effect");if(ht){const Ce=ht.querySelector(".transition-cover"),Ct=ht.querySelector(".transition-shadow"),Ut=(0,h.c)(),Gt=(0,h.c)(),wn=(0,h.c)();Ut.addElement(ht).beforeStyles({opacity:"1",display:"block"}).afterStyles({opacity:"",display:""}),Gt.addElement(Ce).beforeClearStyles([te]).fromTo(te,.1,0),wn.addElement(Ct).beforeClearStyles([te]).fromTo(te,.7,.03),Ut.addAnimation([Gt,wn]),xt.addAnimation([Ut])}}bt.forEach(ht=>{const Ce=(0,h.c)();Ce.addElement(ht);const Ct=(0,h.c)();Ct.addElement(ht.querySelector("ion-title"));const Ut=(0,h.c)(),Gt=ht.querySelectorAll("ion-buttons,[menuToggle]"),wn=ht.closest("ion-header"),Fn=wn?.classList.contains("header-collapse-condense-inactive"),un=Array.from(Gt).filter(Un=>{const _i=Un.classList.contains("buttons-collapse");return _i&&!Fn||!_i});Ut.addElement(un);const ut=(0,h.c)(),jt=ht.querySelectorAll(":scope > *:not(ion-title):not(ion-buttons):not([menuToggle])");jt.length>0&&ut.addElement(jt);const En=(0,h.c)();En.addElement(y(ht).querySelector(".toolbar-background"));const ni=(0,h.c)(),ci=ht.querySelector("ion-back-button");if(ci&&ni.addElement(ci),Ce.addAnimation([Ct,Ut,ut,ni,En]),Ee.addAnimation(Ce),ni.fromTo(te,.99,0),Ut.fromTo(te,.99,0),ut.fromTo(te,.99,0),Je){if(Fn||Ct.fromTo("transform",`translateX(${Ot})`,ye?"translateX(-100%)":"translateX(100%)").fromTo(te,.99,0),ut.fromTo("transform",`translateX(${Ot})`,ye?"translateX(-100%)":"translateX(100%)"),En.beforeClearStyles([te,"transform"]),wn?.translucent?En.fromTo("transform","translateX(0px)",ye?"translateX(-100%)":"translateX(100%)"):En.fromTo(te,"var(--opacity)",0),ci&&!Ft){const _i=(0,h.c)();_i.addElement(y(ci).querySelector(".button-text")).fromTo("transform",`translateX(${Ot})`,`translateX(${(ye?-124:124)+"px"})`),Ce.addAnimation(_i)}}else Fn||Ct.fromTo("transform",`translateX(${Ot})`,`translateX(${Ne})`).fromTo(te,.99,0).afterClearStyles([Qe,te]),ut.fromTo("transform",`translateX(${Ot})`,`translateX(${Ne})`).afterClearStyles([Qe,te]),ni.afterClearStyles([te]),Ct.afterClearStyles([te]),Ut.afterClearStyles([te])})}return Ee}catch(Ae){throw Ae}}},3880:(Rn,Dt,B)=>{"use strict";B.r(Dt),B.d(Dt,{mdTransitionAnimation:()=>Y});var h=B(8834),g=B(697);B(3457),B(1308);const Y=(se,y)=>{var fe,Ie,Ge;const me="back"===y.direction,he=y.leavingEl,Ke=(0,g.g)(y.enteringEl),Ae=Ke.querySelector("ion-toolbar"),te=(0,h.c)();if(te.addElement(Ke).fill("both").beforeRemoveClass("ion-page-invisible"),me?te.duration((null!==(fe=y.duration)&&void 0!==fe?fe:0)||200).easing("cubic-bezier(0.47,0,0.745,0.715)"):te.duration((null!==(Ie=y.duration)&&void 0!==Ie?Ie:0)||280).easing("cubic-bezier(0.36,0.66,0.04,1)").fromTo("transform","translateY(40px)","translateY(0px)").fromTo("opacity",.01,1),Ae){const Qe=(0,h.c)();Qe.addElement(Ae),te.addAnimation(Qe)}if(he&&me){te.duration((null!==(Ge=y.duration)&&void 0!==Ge?Ge:0)||200).easing("cubic-bezier(0.47,0,0.745,0.715)");const Qe=(0,h.c)();Qe.addElement((0,g.g)(he)).onFinish(Ot=>{1===Ot&&Qe.elements.length>0&&Qe.elements[0].style.setProperty("display","none")}).fromTo("transform","translateY(0px)","translateY(40px)").fromTo("opacity",1,0),te.addAnimation(Qe)}return te}},1312:(Rn,Dt,B)=>{"use strict";B.d(Dt,{B:()=>Pt,G:()=>bt,a:()=>fe,b:()=>Ie,c:()=>me,d:()=>Je,e:()=>he,f:()=>pe,g:()=>vt,h:()=>se,i:()=>qt,j:()=>te,k:()=>we,l:()=>Ge,m:()=>Q,s:()=>xt,t:()=>Ze});var h=B(5861),g=B(9658),ie=B(7593),c=B(5730);let Y=0;const se=new WeakMap,y=ct=>({create:ht=>Ke(ct,ht),dismiss:(ht,Ce,Ct)=>Fe(document,ht,Ce,ct,Ct),getTop:()=>(0,h.Z)(function*(){return we(document,ct)})()}),fe=y("ion-alert"),Ie=y("ion-action-sheet"),Ge=y("ion-loading"),Q=y("ion-modal"),me=y("ion-popover"),Ze=y("ion-toast"),he=ct=>{typeof document<"u"&&ye(document);const ht=Y++;ct.overlayIndex=ht,ct.hasAttribute("id")||(ct.id=`ion-overlay-${ht}`)},Ke=(ct,ht)=>typeof window<"u"&&typeof window.customElements<"u"?window.customElements.whenDefined(ct).then(()=>{const Ce=document.createElement(ct);return Ce.classList.add("overlay-hidden"),Object.assign(Ce,Object.assign(Object.assign({},ht),{hasController:!0})),ae(document).appendChild(Ce),new Promise(Ct=>(0,c.c)(Ce,Ct))}):Promise.resolve(),Ae='[tabindex]:not([tabindex^="-"]):not([hidden]):not([disabled]), input:not([type=hidden]):not([tabindex^="-"]):not([hidden]):not([disabled]), textarea:not([tabindex^="-"]):not([hidden]):not([disabled]), button:not([tabindex^="-"]):not([hidden]):not([disabled]), select:not([tabindex^="-"]):not([hidden]):not([disabled]), .ion-focusable:not([tabindex^="-"]):not([hidden]):not([disabled]), .ion-focusable[disabled="false"]:not([tabindex^="-"]):not([hidden])',te=(ct,ht)=>{let Ce=ct.querySelector(Ae);const Ct=Ce?.shadowRoot;Ct&&(Ce=Ct.querySelector(Ae)||Ce),Ce?(0,c.f)(Ce):ht.focus()},Ot=(ct,ht)=>{const Ce=Array.from(ct.querySelectorAll(Ae));let Ct=Ce.length>0?Ce[Ce.length-1]:null;const Ut=Ct?.shadowRoot;Ut&&(Ct=Ut.querySelector(Ae)||Ct),Ct?Ct.focus():ht.focus()},ye=ct=>{0===Y&&(Y=1,ct.addEventListener("focus",ht=>{((ct,ht)=>{const Ce=we(ht,"ion-alert,ion-action-sheet,ion-loading,ion-modal,ion-picker,ion-popover"),Ct=ct.target;Ce&&Ct&&!Ce.classList.contains("ion-disable-focus-trap")&&(Ce.shadowRoot?(()=>{if(Ce.contains(Ct))Ce.lastFocus=Ct;else{const wn=Ce.lastFocus;te(Ce,Ce),wn===ht.activeElement&&Ot(Ce,Ce),Ce.lastFocus=ht.activeElement}})():(()=>{if(Ce===Ct)Ce.lastFocus=void 0;else{const wn=(0,c.g)(Ce);if(!wn.contains(Ct))return;const Fn=wn.querySelector(".ion-overlay-wrapper");if(!Fn)return;if(Fn.contains(Ct))Ce.lastFocus=Ct;else{const un=Ce.lastFocus;te(Fn,Ce),un===ht.activeElement&&Ot(Fn,Ce),Ce.lastFocus=ht.activeElement}}})())})(ht,ct)},!0),ct.addEventListener("ionBackButton",ht=>{const Ce=we(ct);Ce?.backdropDismiss&&ht.detail.register(ie.OVERLAY_BACK_BUTTON_PRIORITY,()=>Ce.dismiss(void 0,Pt))}),ct.addEventListener("keyup",ht=>{if("Escape"===ht.key){const Ce=we(ct);Ce?.backdropDismiss&&Ce.dismiss(void 0,Pt)}}))},Fe=(ct,ht,Ce,Ct,Ut)=>{const Gt=we(ct,Ct,Ut);return Gt?Gt.dismiss(ht,Ce):Promise.reject("overlay does not exist")},we=(ct,ht,Ce)=>{const Ct=((ct,ht)=>(void 0===ht&&(ht="ion-alert,ion-action-sheet,ion-loading,ion-modal,ion-picker,ion-popover,ion-toast"),Array.from(ct.querySelectorAll(ht)).filter(Ce=>Ce.overlayIndex>0)))(ct,ht).filter(Ut=>!(ct=>ct.classList.contains("overlay-hidden"))(Ut));return void 0===Ce?Ct[Ct.length-1]:Ct.find(Ut=>Ut.id===Ce)},et=(ct=!1)=>{const Ce=ae(document).querySelector("ion-router-outlet, ion-nav, #ion-view-container-root");!Ce||(ct?Ce.setAttribute("aria-hidden","true"):Ce.removeAttribute("aria-hidden"))},Je=function(){var ct=(0,h.Z)(function*(ht,Ce,Ct,Ut,Gt){var wn,Fn;if(ht.presented)return;et(!0),ht.presented=!0,ht.willPresent.emit(),null===(wn=ht.willPresentShorthand)||void 0===wn||wn.emit();const un=(0,g.b)(ht),ut=ht.enterAnimation?ht.enterAnimation:g.c.get(Ce,"ios"===un?Ct:Ut);(yield Ee(ht,ut,ht.el,Gt))&&(ht.didPresent.emit(),null===(Fn=ht.didPresentShorthand)||void 0===Fn||Fn.emit()),"ION-TOAST"!==ht.el.tagName&&_e(ht.el),ht.keyboardClose&&(null===document.activeElement||!ht.el.contains(document.activeElement))&&ht.el.focus()});return function(Ce,Ct,Ut,Gt,wn){return ct.apply(this,arguments)}}(),_e=function(){var ct=(0,h.Z)(function*(ht){let Ce=document.activeElement;if(!Ce)return;const Ct=Ce?.shadowRoot;Ct&&(Ce=Ct.querySelector(Ae)||Ce),yield ht.onDidDismiss(),Ce.focus()});return function(Ce){return ct.apply(this,arguments)}}(),pe=function(){var ct=(0,h.Z)(function*(ht,Ce,Ct,Ut,Gt,wn,Fn){var un,ut;if(!ht.presented)return!1;et(!1),ht.presented=!1;try{ht.el.style.setProperty("pointer-events","none"),ht.willDismiss.emit({data:Ce,role:Ct}),null===(un=ht.willDismissShorthand)||void 0===un||un.emit({data:Ce,role:Ct});const jt=(0,g.b)(ht),En=ht.leaveAnimation?ht.leaveAnimation:g.c.get(Ut,"ios"===jt?Gt:wn);Ct!==bt&&(yield Ee(ht,En,ht.el,Fn)),ht.didDismiss.emit({data:Ce,role:Ct}),null===(ut=ht.didDismissShorthand)||void 0===ut||ut.emit({data:Ce,role:Ct}),se.delete(ht),ht.el.classList.add("overlay-hidden"),ht.el.style.removeProperty("pointer-events")}catch(jt){console.error(jt)}return ht.el.remove(),!0});return function(Ce,Ct,Ut,Gt,wn,Fn,un){return ct.apply(this,arguments)}}(),ae=ct=>ct.querySelector("ion-app")||ct.body,Ee=function(){var ct=(0,h.Z)(function*(ht,Ce,Ct,Ut){Ct.classList.remove("overlay-hidden");const wn=Ce(ht.el,Ut);(!ht.animated||!g.c.getBoolean("animated",!0))&&wn.duration(0),ht.keyboardClose&&wn.beforeAddWrite(()=>{const un=Ct.ownerDocument.activeElement;un?.matches("input,ion-input, ion-textarea")&&un.blur()});const Fn=se.get(ht)||[];return se.set(ht,[...Fn,wn]),yield wn.play(),!0});return function(Ce,Ct,Ut,Gt){return ct.apply(this,arguments)}}(),vt=(ct,ht)=>{let Ce;const Ct=new Promise(Ut=>Ce=Ut);return Et(ct,ht,Ut=>{Ce(Ut.detail)}),Ct},Et=(ct,ht,Ce)=>{const Ct=Ut=>{(0,c.b)(ct,ht,Ct),Ce(Ut)};(0,c.a)(ct,ht,Ct)},qt=ct=>"cancel"===ct||ct===Pt,Ft=ct=>ct(),xt=(ct,ht)=>{if("function"==typeof ct)return g.c.get("_zoneGate",Ft)(()=>{try{return ct(ht)}catch(Ct){throw Ct}})},Pt="backdrop",bt="gesture"},1099:(Rn,Dt,B)=>{"use strict";B.d(Dt,{B:()=>be});var h=B(8274),g=B(6579),ie=B(6895),c=B(201);function Y(me,Ze){if(1&me&&(h.TgZ(0,"ion-badge",7),h._uU(1),h.qZA()),2&me){const he=h.oxw().$implicit;h.xp6(1),h.hij("",he.Quantity," x")}}function se(me,Ze){if(1&me&&(h.TgZ(0,"strong"),h._uU(1),h.qZA()),2&me){const he=h.oxw().$implicit;h.xp6(1),h.hij("",he.PowerKW," kW ")}}function y(me,Ze){if(1&me&&(h.TgZ(0,"div"),h._uU(1),h.qZA()),2&me){const he=h.oxw().$implicit;h.xp6(1),h.hij("",null==he.CurrentType?null:he.CurrentType.Title," ")}}function fe(me,Ze){if(1&me&&(h.TgZ(0,"span"),h._uU(1),h.qZA()),2&me){const he=h.oxw().$implicit;h.xp6(1),h.hij("",he.Amps,"A ")}}function Ie(me,Ze){if(1&me&&(h.TgZ(0,"span"),h._uU(1),h.qZA()),2&me){const he=h.oxw().$implicit;h.xp6(1),h.hij("",he.Voltage,"V ")}}function Ge(me,Ze){if(1&me){const he=h.EpF();h.TgZ(0,"ion-col")(1,"ion-button",8),h.NdJ("click",function(){h.CHM(he);const Ae=h.oxw().$implicit,te=h.oxw();return h.KtG(te.editConnection(Ae))}),h._UZ(2,"ion-icon",9),h.qZA(),h._UZ(3,"br"),h.TgZ(4,"ion-button",10),h.NdJ("click",function(){h.CHM(he);const Ae=h.oxw().$implicit,te=h.oxw();return h.KtG(te.deleteConnection(Ae))}),h._UZ(5,"ion-icon",11),h.qZA()()}}function Q(me,Ze){if(1&me&&(h.TgZ(0,"ion-row")(1,"ion-col")(2,"ion-row")(3,"ion-col",1),h._UZ(4,"img",2),h.YNc(5,Y,2,1,"ion-badge",3),h.TgZ(6,"div",4),h._uU(7),h.qZA()(),h.TgZ(8,"ion-col")(9,"ion-row")(10,"ion-col")(11,"ion-note")(12,"div")(13,"strong",5),h._uU(14),h.qZA()(),h.YNc(15,se,2,1,"strong",6),h.YNc(16,y,2,1,"div",6),h.qZA(),h.TgZ(17,"ion-note"),h.YNc(18,fe,2,1,"span",6),h.YNc(19,Ie,2,1,"span",6),h.qZA()()(),h.TgZ(20,"ion-row")(21,"ion-col",4),h._uU(22),h.qZA(),h.TgZ(23,"ion-col",4),h._uU(24),h.qZA()()(),h.YNc(25,Ge,6,0,"ion-col",6),h.qZA()()()),2&me){const he=Ze.$implicit,Ke=h.oxw();h.xp6(4),h.Q6J("src",Ke.getConnectorTypeIcon(he.ConnectionTypeID),h.LSH),h.xp6(1),h.Q6J("ngIf",he.Quantity),h.xp6(2),h.Oqu(null==he.StatusType?null:he.StatusType.Title),h.xp6(6),h.s9C("title",null==he.ConnectionType?null:he.ConnectionType.FormalName),h.xp6(1),h.hij("",null==he.ConnectionType?null:he.ConnectionType.Title," "),h.xp6(1),h.Q6J("ngIf",he.PowerKW),h.xp6(1),h.Q6J("ngIf",he.CurrentTypeID),h.xp6(2),h.Q6J("ngIf",he.Amps),h.xp6(1),h.Q6J("ngIf",he.Voltage),h.xp6(3),h.Oqu(he.Reference),h.xp6(2),h.Oqu(he.Comments),h.xp6(1),h.Q6J("ngIf",Ke.enableEdit)}}let be=(()=>{class me{constructor(){this.enableEdit=!1,this.onEdit=new h.vpe,this.onDelete=new h.vpe}ngOnInit(){}editConnection(he){this.onEdit.emit(he)}deleteConnection(he){this.onDelete.emit(he)}getConnectorTypeIcon(he){return g.c.getIconForConnector(he)}}return me.\u0275fac=function(he){return new(he||me)},me.\u0275cmp=h.Xpm({type:me,selectors:[["app-equipment-details"]],inputs:{item:"item",enableEdit:"enableEdit"},outputs:{onEdit:"onEdit",onDelete:"onDelete"},decls:2,vars:1,consts:[[4,"ngFor","ngForOf"],["size","3"],[2,"max-width","64px",3,"src"],["color","primary",4,"ngIf"],[1,"info"],[3,"title"],[4,"ngIf"],["color","primary"],["size","small","color","secondary",3,"click"],["name","create","slot","icon-only"],["size","small","color","danger",3,"click"],["name","trash","slot","icon-only"]],template:function(he,Ke){1&he&&(h.TgZ(0,"ion-grid"),h.YNc(1,Q,26,12,"ion-row",0),h.qZA()),2&he&&(h.xp6(1),h.Q6J("ngForOf",Ke.item.Connections))},dependencies:[ie.sg,ie.O5,c.yp,c.YG,c.wI,c.jY,c.gu,c.uN,c.Nd]}),me})()},2428:(Rn,Dt,B)=>{"use strict";B.d(Dt,{v:()=>be});var h=B(5861),g=B(7689),ie=B(8274),c=B(553),Y=B(201),se=B(529),y=B(6260),fe=B(6895);function Ie(me,Ze){1&me&&(ie.TgZ(0,"div"),ie._UZ(1,"ion-spinner"),ie.qZA())}function Ge(me,Ze){if(1&me){const he=ie.EpF();ie.TgZ(0,"ion-item",5),ie.NdJ("click",function(){const te=ie.CHM(he).$implicit,Qe=ie.oxw(2);return ie.KtG(Qe.placeSelected(te))}),ie.TgZ(1,"ion-avatar",6),ie._UZ(2,"ion-icon",7),ie.qZA(),ie.TgZ(3,"ion-label")(4,"p"),ie._uU(5),ie.qZA()()()}if(2&me){const he=Ze.$implicit;ie.xp6(5),ie.Oqu(he.Address)}}function Q(me,Ze){if(1&me&&(ie.TgZ(0,"div",1),ie.YNc(1,Ie,2,0,"div",2),ie.TgZ(2,"ion-list"),ie.YNc(3,Ge,6,1,"ion-item",3),ie.TgZ(4,"ion-item")(5,"p",4),ie._uU(6),ie.qZA()()()()),2&me){const he=ie.oxw();ie.xp6(1),ie.Q6J("ngIf",he.searchInProgress),ie.xp6(2),ie.Q6J("ngForOf",he.placeList),ie.xp6(3),ie.hij(" ",he.placeAttribution," ")}}let be=(()=>{class me{constructor(he,Ke,Ae,te,Qe){this.logging=he,this.changeDetector=Ke,this.platform=Ae,this.http=te,this.events=Qe,this.searchInProgress=!1,this.placeSearchActive=!1,this.placeAttribution="",this.placeChanged=new ie.vpe,this.searchKeyword="",this.searchInProgress=!1,this.mapService=new c.k(Qe,he,te)}ngOnInit(){var he=this;return(0,h.Z)(function*(){yield he.platform.ready(),he.mapService.initAPI()})()}onSearchFocus(){this.placeSearchFocused=!0}onSearchBlur(){this.placeSearchFocused=!1}onSearchCancel(){}getPlacesAutoComplete(he,Ke){var Ae=this;return(0,h.Z)(function*(){Ae.placeSearchType=Ke;let te=he.target.value;if(te&&te.length>3){Ae.logging.log("Starting place lookup for:"+te),Ae.placeSearchActive=!0,Ae.searchInProgress=!0,Ae.searchInProgress=!1,Ae.placeSearchActive=!0;try{Ae.placeList=yield Ae.mapService.placeSearch(te),Ae.placeList&&Ae.placeList.length>0&&(Ae.placeAttribution=Ae.placeList[0].Attribution)}catch{}Ae.searchInProgress=!1,Ae.placeSearchActive=!0}else Ae.searchInProgress=!1,Ae.placeSearchActive=!1})()}placeSelected(he){this.logging.log("Looking up place details:"+he.Title+"::"+he.ReferenceID),this.selectedPlace=he,this.placeChanged.emit(he),this.placeSearchActive=!1}}return me.\u0275fac=function(he){return new(he||me)(ie.Y36(g.z),ie.Y36(ie.sBO),ie.Y36(Y.t4),ie.Y36(se.eN),ie.Y36(y.z))},me.\u0275cmp=ie.Xpm({type:me,selectors:[["place-search"]],inputs:{searchKeyword:"searchKeyword"},outputs:{selectedPlace:"selectedPlace",placeChanged:"placeChanged"},decls:1,vars:1,consts:[["class","place-search",4,"ngIf"],[1,"place-search"],[4,"ngIf"],[3,"click",4,"ngFor","ngForOf"],[1,"place-attribution"],[3,"click"],["item-left",""],["name","locate"]],template:function(he,Ke){1&he&&ie.YNc(0,Q,7,3,"div",0),2&he&&ie.Q6J("ngIf",Ke.placeSearchActive)},dependencies:[fe.sg,fe.O5,Y.BJ,Y.gu,Y.Ie,Y.Q$,Y.q_,Y.PQ],styles:[".place-search[_ngcontent-%COMP%]{position:absolute;z-index:1000}.place-attribution[_ngcontent-%COMP%]{font-size:9px;color:#dcdcdc;max-width:100%}"]}),me})()},6585:(Rn,Dt,B)=>{"use strict";B.d(Dt,{o:()=>fe});var h=B(8274),g=B(6579),ie=B(6895),c=B(201);function Y(Ie,Ge){if(1&Ie){const Q=h.EpF();h.TgZ(0,"ion-button",5),h.NdJ("click",function(){h.CHM(Q);const me=h.oxw().$implicit,Ze=h.oxw();return h.KtG(Ze.onCopyCommand(me))}),h._uU(1,"Copy"),h.qZA()}}function se(Ie,Ge){if(1&Ie){const Q=h.EpF();h.TgZ(0,"ion-button",5),h.NdJ("click",function(){h.CHM(Q);const me=h.oxw().$implicit,Ze=h.oxw();return h.KtG(Ze.onEditCommand(me))}),h._uU(1,"Edit"),h.qZA()}}function y(Ie,Ge){if(1&Ie&&(h.TgZ(0,"ion-item",1)(1,"ion-grid")(2,"ion-row")(3,"ion-col"),h._uU(4),h.qZA()(),h.TgZ(5,"ion-row")(6,"ion-col",2)(7,"p"),h._UZ(8,"img",3),h.qZA(),h.TgZ(9,"ion-note"),h._uU(10),h.qZA(),h.YNc(11,Y,2,0,"ion-button",4),h.YNc(12,se,2,0,"ion-button",4),h.qZA(),h.TgZ(13,"ion-col")(14,"ion-row")(15,"ion-col")(16,"p"),h._uU(17),h.qZA(),h.TgZ(18,"ion-note"),h._uU(19),h.qZA()()(),h.TgZ(20,"ion-row")(21,"ion-col"),h._uU(22),h.qZA(),h.TgZ(23,"ion-col"),h._uU(24),h.qZA()()()()()()),2&Ie){const Q=Ge.$implicit,be=h.oxw();h.xp6(4),h.hij(" ",Q.AddressInfo.Title," "),h.xp6(4),h.Q6J("src",be.getIconForPOI(Q),h.LSH),h.xp6(2),h.hij(" ",be.getFormattedDistance(Q)," "),h.xp6(1),h.Q6J("ngIf",be.enableCopyOption),h.xp6(1),h.Q6J("ngIf",be.enableEditOption),h.xp6(5),h.hij(" ",be.getFormattedAddress(Q)," "),h.xp6(2),h.hij(" ",be.getFormattedConnectorList(Q)," "),h.xp6(3),h.hij(" ",null==Q.UsageType?null:Q.UsageType.Title," "),h.xp6(2),h.hij(" ",null==Q.OperatorInfo?null:Q.OperatorInfo.Title," ")}}let fe=(()=>{class Ie{constructor(){this.enableCopyOption=!1,this.enableEditOption=!1,this.poiList=[],this.onCopy=new h.vpe,this.onEdit=new h.vpe}ngOnInit(){}onCopyCommand(Q){this.onCopy.emit(Q)}onEditCommand(Q){this.onEdit.emit(Q)}getFormattedAddress(Q){let be="";return be+=Q.AddressInfo.Title!=Q.AddressInfo.AddressLine1?Q.AddressInfo.Title:Q.AddressInfo.Town,be}getFormattedConnectorList(Q){if(!Q.Connections)return;let be=[];for(let me of Q.Connections)null!=me.ConnectionType&&(be.find(Ze=>Ze==me.ConnectionType.Title)||be.push(me.ConnectionType.Title));return be.join(", ")}getIconForPOI(Q){return g.c.getIconForPOI(Q)}getFormattedDistance(Q){return g.c.getFormattedDistance(Q)}}return Ie.\u0275fac=function(Q){return new(Q||Ie)},Ie.\u0275cmp=h.Xpm({type:Ie,selectors:[["app-poi-list"]],inputs:{enableCopyOption:"enableCopyOption",enableEditOption:"enableEditOption",poiList:"poiList"},outputs:{onCopy:"onCopy",onEdit:"onEdit"},decls:2,vars:1,consts:[["style","max-width:400px;",4,"ngFor","ngForOf"],[2,"max-width","400px"],["size","3"],[2,"width","24px",3,"src"],["size","small",3,"click",4,"ngIf"],["size","small",3,"click"]],template:function(Q,be){1&Q&&(h.TgZ(0,"ion-list"),h.YNc(1,y,25,9,"ion-item",0),h.qZA()),2&Q&&(h.xp6(1),h.Q6J("ngForOf",be.poiList))},dependencies:[ie.sg,ie.O5,c.YG,c.wI,c.jY,c.Ie,c.q_,c.uN,c.Nd]}),Ie})()},8936:(Rn,Dt,B)=>{"use strict";B.d(Dt,{e:()=>se});var h=B(6895),g=B(201),ie=B(4006),c=B(4463),Y=B(8274);let se=(()=>{class y{}return y.\u0275fac=function(Ie){return new(Ie||y)},y.\u0275mod=Y.oAB({type:y}),y.\u0275inj=Y.cJS({providers:[h.JJ],imports:[h.ez,g.Pc,ie.u5,c.aw]}),y})()},2951:(Rn,Dt,B)=>{"use strict";B.d(Dt,{X:()=>g});var h=B(2340);class g{constructor(){this.baseURL="https://map.openchargemap.io",this.loginProviderRedirectBaseURL="https://openchargemap.org/site/loginprovider/?_mode=silent&_forceLogin=true&_redirectURL=",this.loginProviderRedirectURL=this.loginProviderRedirectBaseURL+this.baseURL,this.enableLiveMapQuerying=!0,this.googleMapsAPIKey=h.N.googleMapsKey,this.enableStaticMaps=h.N.enableStaticMaps}}},6579:(Rn,Dt,B)=>{"use strict";B.d(Dt,{c:()=>g});var h=B(2340);let g=(()=>{class ie{static isFeatureEnabled(Y){return!!h.N.enabledFeatures.find(se=>se===Y)}static getClientHeight(){const Y=document.body,se=document.documentElement;return Math.max(Y.scrollHeight,Y.offsetHeight,se.clientHeight,se.scrollHeight,se.offsetHeight)}static getClientWidth(){const Y=document.body,se=document.documentElement;return Math.max(Y.scrollWidth,Y.offsetWidth,se.clientWidth,se.scrollWidth,se.offsetWidth)}static getMaxLevelOfPOI(Y){let se=0;if(null!=Y.Connections)for(let y=0;y<Y.Connections.length;y++)null!=Y.Connections[y].Level&&Y.Connections[y].Level.ID>se&&(se=Y.Connections[y].Level.ID);return 4===se&&(se=2),se>4&&(se=3),se}static getIconForPOI(Y){let y="assets/images/icons/map/level"+ie.getMaxLevelOfPOI(Y);return null!=Y.UsageType&&Y.UsageType.Title.indexOf("Private")>-1?y+="_private":y+=null!=Y.StatusType&&!0!==Y.StatusType.IsOperational?"_nonoperational":"_operational",y+="_icon.png",y}static getColorForPOI(Y){const se=ie.getMaxLevelOfPOI(Y);let y="#c0c0c0";return null!=Y.UsageType&&Y.UsageType.Title.indexOf("Private")>-1?y="#FF0000":null!=Y.StatusType&&!0!==Y.StatusType.IsOperational?y="#a0a0a0":2==se?y="#72EB0D":3==se&&(y="#EB800D"),y}static getIconForConnector(Y){let se="assets/images/icons/connectors/";return se+=1===Y?"Type1_J1772.svg":2===Y?"Chademo_type4.svg":25===Y?"Type2_socket.svg":32===Y?"Type1_CCS.svg":33===Y?"Type2_CCS.svg":1036===Y?"Type2_tethered.svg":28===Y?"schuko.svg":"Unknown.svg",se}static getFormattedDistance(Y){return Y&&Y.AddressInfo&&Y.AddressInfo.Distance?Y.AddressInfo.Distance.toFixed(1)+" "+(1===Y.AddressInfo.DistanceUnit?"km":"miles"):""}static fixJSONDate(Y){if(null==Y)return null;if(0==Y.indexOf("/")){let y=/Date\(([^)]+)\)/.exec(Y);Y=new Date(parseFloat(y[1]))}else Y=new Date(Y);return Y}static formatMapLinkFromPosition(Y,se,y,fe,Ie){return'<a href="https://maps.google.com/maps?saddr='+se+","+y+"&daddr="+Y.AddressInfo.Latitude+","+Y.AddressInfo.Longitude+'">Map ('+Math.ceil(fe)+" "+Ie+")</a>"}static formatSystemWebLink(Y,se){return"<a href='#' onclick=\"window.open('"+Y+"', '_system');return false;\">"+se+"</a>"}static formatMapLink(Y,se,y){return y?device&&"WinCE"==device.platform?this.formatSystemWebLink("maps:"+Y.AddressInfo.Latitude+","+Y.AddressInfo.Longitude,se):device&&"iOS"===device.platform?this.formatSystemWebLink("https://maps.apple.com/?q="+Y.AddressInfo.Latitude+","+Y.AddressInfo.Longitude,se):this.formatSystemWebLink("https://maps.google.com/maps?q="+Y.AddressInfo.Latitude+","+Y.AddressInfo.Longitude,se):'<a target="_blank"  href="https://maps.google.com/maps?q='+Y.AddressInfo.Latitude+","+Y.AddressInfo.Longitude+'">'+se+"</a>"}static formatURL(Y,se=null){return null==Y||""==Y?"":(-1==Y.indexOf("http")&&(Y="https://"+Y),'<a target="_blank" href="'+Y+'">'+(se??Y)+"</a>")}static formatString(Y){return null==Y?"":Y.toString()}static formatTextField(Y,se=null,y=!1,fe=!1,Ie=null){if(null==Y||""==Y||null==Y)return"";let Ge=(null!=se?"<strong class='ocm-label' "+(null!=Ie?"data-localize='"+Ie+"' ":"")+">"+se+"</strong>: ":"")+(y?"<br/>":"")+Y.toString().replace("\n","<br/>")+"<br/>";return 1==fe&&(Ge="<p>"+Ge+"</p>"),Ge}static formatEmailAddress(Y){return null!=Y&&null!=Y&&""!=Y?"<i class='fa fa-envelope fa-fw'></i> <a href=\"mailto:"+Y+'">'+Y+"</a><br/>":""}static formatPhone(Y,se=null){return null!=Y&&null!=Y&&""!=Y?(null==se?se="<i class='fa fa-phone fa-fw '></i> ":se+=": ",se+'<a href="tel:'+Y+'">'+Y+"</a><br/>"):""}static formatPOIDetails(Y,se){let fe=new Date;null==se&&(se=!1);let Ie=this.formatPOIAddress(Y,!1),Ge="";Ge+=this.formatPhone(Y.AddressInfo.ContactTelephone1),Ge+=this.formatPhone(Y.AddressInfo.ContactTelephone2),Ge+=this.formatEmailAddress(Y.AddressInfo.ContactEmail);let Q="";if(null!=Y.AddressInfo.Distance){let Ae="https://maps.google.com/maps?saddr=&daddr="+Y.AddressInfo.Latitude+","+Y.AddressInfo.Longitude;Q+="<strong id='addr_distance'><span data-localize='details.approxDistance'>Distance</span>: "+Y.AddressInfo.Distance.toFixed(1)+" "+(2==Y.AddressInfo.DistanceUnit?"Miles":"KM")+"</strong>",Q+="<p>"+this.formatSystemWebLink(Ae,"Get Directions")+"</p>"}if(null!=Y.AddressInfo.RelatedURL&&""!=Y.AddressInfo.RelatedURL){let Ae=Y.AddressInfo.RelatedURL;Ae=Ae.replace(/.*?:\/\//g,""),Ae.length>40&&(Ae=Ae.substr(0,40)+".."),Ge+="<i class='fa fa-fw fa-external-link'></i>  "+this.formatSystemWebLink(Y.AddressInfo.RelatedURL,"<span data-localize='details.addressRelatedURL'>"+Ae+"</span>")}Ge+="</p>";const be=this.formatTextField(Y.GeneralComments,null,!1,!0)+this.formatTextField(Y.AddressInfo.AccessComments,"Access",!0,!0,"details.accessComments");let me="";null!=Y.NumberOfPoints&&(me+=this.formatTextField(Y.NumberOfPoints,"Bays",!1,!0,"details.numberOfPoints")),null!=Y.UsageType&&(me+=this.formatTextField(Y.UsageType.Title,"Usage",!1,!0,"details.usageType")),null!=Y.UsageCost&&(me+=this.formatTextField(Y.UsageCost,"Usage Cost",!1,!0,"details.usageCost")),null!=Y.OperatorInfo&&1!=Y.OperatorInfo.ID&&(me+=this.formatTextField(Y.OperatorInfo.Title,"Operator",!1,!0,"details.operatorTitle"),null!=Y.OperatorInfo.WebsiteURL&&(me+=this.formatTextField(this.formatURL(Y.OperatorInfo.WebsiteURL),"Operator Website",!0,!0,"details.operatorWebsite")));let Ze="";if(null!=Y.StatusType&&(Ze+=this.formatTextField(Y.StatusType.Title,"Status",!1,!0,"details.operationalStatus"),null!=Y.DateLastStatusUpdate&&(Ze+=this.formatTextField(Math.round((fe-this.fixJSONDate(Y.DateLastStatusUpdate))/864e5)+" days ago","Last Updated",!1,!0,"details.lastUpdated"))),null!=Y.Connections&&Y.Connections.length>0){Ze+="<table class='table table-striped'>",Ze+="<tr><th data-localize='details.equipment.connectionType'>Connection</th><th data-localize='details.equipment.powerLevel'>Power Level</th><th data-localize='details.operationalStatus'>Status</th></tr>";for(let Ae=0;Ae<Y.Connections.length;Ae++){let te=Y.Connections[Ae];""==te.Amps&&(te.Amps=null),""==te.Voltage&&(te.Voltage=null),""==te.Quantity&&(te.Quantity=null),""==te.PowerKW&&(te.PowerKW=null),Ze+="<tr><td>"+(null!=te.ConnectionType?te.ConnectionType.Title:"")+"</td><td>"+(null!=te.Level?"<strong>"+te.Level.Title+"</strong><br/>":"")+(null!=te.Amps?this.formatString(te.Amps)+"A/ ":"")+(null!=te.Voltage?this.formatString(te.Voltage)+"V/ ":"")+(null!=te.PowerKW?this.formatString(te.PowerKW)+"kW <br/>":"")+(null!=te.CurrentType?te.CurrentType.Title:"")+"<br/>"+(null!=te.Quantity?this.formatString(te.Quantity):"1")+" Present</td><td>"+(null!=te.StatusType?te.StatusType.Title:"-")+"</td></tr>"}Ze+="</table>"}let he="";return he+=this.formatTextField("<a target='_blank' href='https://openchargemap.org/site/poi/details/"+Y.ID+"'>OCM-"+Y.ID+"</a>","OpenChargeMap Ref",!1,!0,"details.refNumber"),null!=Y.DataProvider&&(he+=this.formatTextField(Y.DataProvider.Title,"Data Provider",!1,!0,"details.dataProviderTitle"),null!=Y.DataProvider.WebsiteURL&&(he+=this.formatTextField(this.formatURL(Y.DataProvider.WebsiteURL),"Website",!1,!0,"details.dataProviderWebsite")),he+=this.formatTextField(Y.AddressInfo.Latitude,"Latitude",!1,!0,null),he+=this.formatTextField(Y.AddressInfo.Longitude,"Longitude",!1,!0,null)),{address:Ie,drivingInfo:Q,contactInfo:Ge,additionalInfo:be+me+Ze,advancedInfo:he}}static debounce(Y,se,y){let fe;return function(){let Ie=this,Ge=arguments,Q=function(){fe=null,y||Y.apply(Ie,Ge)},be=y&&!fe;clearTimeout(fe),fe=setTimeout(Q,se),be&&Y.apply(Ie,Ge)}}static getRandomInt(Y){return Math.floor(Math.random()*Math.floor(Y))}}return ie.formatPOIAddress=function(c,Y=!0){let se="";return se=Y?""+this.formatTextField(c.AddressInfo.AddressLine1)+this.formatTextField(c.AddressInfo.AddressLine2)+this.formatTextField(c.AddressInfo.Town)+this.formatTextField(c.AddressInfo.StateOrProvince)+this.formatTextField(c.AddressInfo.Postcode)+(null!=c.AddressInfo.Country?this.formatTextField(c.AddressInfo.Country.Title):""):this.formatStringArray([c.AddressInfo.AddressLine1,c.AddressInfo.AddressLine2,c.AddressInfo.Town,c.AddressInfo.StateOrProvince,c.AddressInfo.Postcode,null!=c.AddressInfo.Country?c.AddressInfo.Country.Title:""]),se},ie.formatStringArray=function(c,Y=", "){if(null==c)return"";let se="";for(let y=0;y<c.length;y++)null!=c[y]&&""!=c[y].trim()&&(se+=y==c.length-1?c[y]:c[y]+Y);return se},ie})()},4120:(Rn,Dt,B)=>{"use strict";B.d(Dt,{LL:()=>ie,jR:()=>g,wC:()=>h});class h{constructor(Y=null,se=null){this.latitude=Y,this.longitude=se}}class g{constructor(Y=null,se=null){this.coords=new h,this.coords.latitude=Y,this.coords.longitude=se}static fromPosition(Y){return new g(Y.coords.latitude,Y.coords.longitude)}}class ie{constructor(Y,se){this.northEast=Y,this.southWest=se}}},129:(Rn,Dt,B)=>{"use strict";B.d(Dt,{Qp:()=>ie,fw:()=>se,JJ:()=>fe,eN:()=>y,vw:()=>Y,kA:()=>c});class h{constructor(Ge,Q){this.itemType=Ge,this.itemId=h.getNewItemId(),this.version=1,this.schemaVersion=Q,this.syncTimeStamp=h.getNewSyncTimeStamp()}static getNewSyncTimeStamp(){return Date.now().toString()}static getNewItemId(){return"_syncitem_"+Date.now().toString()}}class g{constructor(Ge,Q){this._sync=new h(Ge,Q)}}class ie extends g{}class c extends g{constructor(){super("waypoint",1)}}class Y extends g{constructor(){super("journey_stage",1),this.WayPoints=[]}}class se extends g{constructor(){super("journey",1),this.ID=""+Date.now(),this.Stages=[]}}class y{}class fe{}},8016:(Rn,Dt,B)=>{"use strict";B.d(Dt,{b:()=>h});class h{constructor(){this.poiIdList=null,this.countryCode=null,this.latitude=null,this.longitude=null,this.locationTitle=null,this.distance=null,this.distanceUnit=null,this.connectionTypeIdList=null,this.operatorIdList=null,this.levelIdList=null,this.countryIdList=null,this.usageTypeIdList=null,this.statusTypeIdList=null,this.minPowerKW=null,this.maxPowerKW=null,this.submissionStatusTypeIdList=null,this.maxResults=500,this.additionalParams=null,this.includeComments=!1,this.compact=!0,this.enableCaching=!0,this.levelOfDetail=1,this.polyline=null,this.boundingbox=null}}},4209:(Rn,Dt,B)=>{"use strict";B.d(Dt,{n:()=>h});class h{}},7627:(Rn,Dt,B)=>{"use strict";B.d(Dt,{N:()=>g,U:()=>h});const h=650;class g{constructor(){this.OperatorList=[],this.ConnectionTypeList=[],this.CountryList=[],this.UsageTypeList=[],this.StatusTypeList=[],this.MaxPowerKW=null,this.MinPowerKW=null,this.HasActiveFilters=!1,this.FilterOptionsByCountryId=null,this.UseDistanceInKM=!0,this.MapType="ROADMAP",this.EnableAdvancedEditorFeatures=!1}LoadSettings(){}SaveSettings(){}ClearActiveFilters(){this.OperatorList=[],this.ConnectionTypeList=[],this.CountryList=[],this.UsageTypeList=[],this.StatusTypeList=[],this.MinPowerKW=null,this.MaxPowerKW=null}CheckForActiveFilters(){return this.HasActiveFilters=this.OperatorList.length>0||this.ConnectionTypeList.length>0||this.CountryList.length>0||this.UsageTypeList.length>0||this.StatusTypeList.length>0||this.MinPowerKW>0||this.MaxPowerKW>0||null!=this.MaxPowerKW&&this.MaxPowerKW<h,this.HasActiveFilters}}},8649:(Rn,Dt,B)=>{"use strict";B.d(Dt,{q:()=>h});var h=(()=>{return(g=h||(h={}))[g.POI=0]="POI",g[g.Comment=1]="Comment",g[g.Media=2]="Media",h;var g})()},534:(Rn,Dt,B)=>{"use strict";B.r(Dt),B.d(Dt,{AboutPageModule:()=>Ge});var h=B(6895),g=B(4006),ie=B(201),c=B(4228),Y=B(388),se=B(8274);const y=[{path:"",component:Y.t}];let fe=(()=>{class Q{}return Q.\u0275fac=function(me){return new(me||Q)},Q.\u0275mod=se.oAB({type:Q}),Q.\u0275inj=se.cJS({imports:[c.Bz.forChild(y),c.Bz]}),Q})();var Ie=B(4463);let Ge=(()=>{class Q{}return Q.\u0275fac=function(me){return new(me||Q)},Q.\u0275mod=se.oAB({type:Q}),Q.\u0275inj=se.cJS({imports:[h.ez,g.u5,ie.Pc,Ie.aw,fe]}),Q})()},388:(Rn,Dt,B)=>{"use strict";B.d(Dt,{t:()=>Y});var h=B(2340),g=B(8274),ie=B(201),c=B(4463);let Y=(()=>{class se{constructor(fe){this.modalController=fe}get appVersion(){return h.N.version}get apiUrl(){return h.N.apiBase}ngOnInit(){}close(){this.modalController.dismiss()}}return se.\u0275fac=function(fe){return new(fe||se)(g.Y36(ie.IN))},se.\u0275cmp=g.Xpm({type:se,selectors:[["app-about"]],decls:49,vars:5,consts:[[1,"ion-padding"],["size","2"],["src","assets/images/icons/branding/AppIcon_128x128.png",2,"padding-top","2em"],["href","https://openchargemap.org"],["href","https://community.openchargemap.org"],["href","https://github.com/openchargemap/ocm-system/issues"],["href","https://webprofusion.com"],["href","https://opencollective.com/openchargemap"],["slot","end"],[3,"click"],["name","close","slot","start"]],template:function(fe,Ie){1&fe&&(g.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),g._uU(3),g.ALo(4,"translate"),g.qZA()()(),g.TgZ(5,"ion-content",0)(6,"ion-grid")(7,"ion-row")(8,"ion-col",1),g._UZ(9,"img",2),g.qZA(),g.TgZ(10,"ion-col")(11,"h1"),g._uU(12,"Open Charge Map"),g.qZA(),g.TgZ(13,"h2"),g._uU(14,"The global public registry of Electric Vehicle charging locations"),g.qZA(),g.TgZ(15,"p"),g._uU(16,"Web: "),g.TgZ(17,"a",3),g._uU(18,"https://openchargemap.org"),g.qZA()()()()(),g.TgZ(19,"p"),g._uU(20,"Community Discussions: "),g.TgZ(21,"a",4),g._uU(22,"https://community.openchargemap.org"),g.qZA()(),g.TgZ(23,"p"),g._uU(24,"App or System Bugs and feature suggestions: "),g.TgZ(25,"a",5),g._uU(26,"GitHub"),g.qZA()(),g.TgZ(27,"p"),g._uU(28,"App development by Webprofusion Pty Ltd ("),g.TgZ(29,"a",6),g._uU(30,"https://webprofusion.com"),g.qZA(),g._uU(31,")"),g.qZA(),g.TgZ(32,"h3"),g._uU(33,"Funding"),g.qZA(),g.TgZ(34,"p"),g._uU(35,"Our software is developed and hosted by volunteers, our data is crowdsourced by you. To help further development please encourage your organisation to sponsor us: "),g.TgZ(36,"a",7),g._uU(37,"Open Collective"),g.qZA()(),g.TgZ(38,"ion-note")(39,"p"),g._uU(40),g.qZA(),g.TgZ(41,"p"),g._uU(42),g.qZA()()(),g.TgZ(43,"ion-footer")(44,"ion-toolbar")(45,"ion-buttons",8)(46,"ion-button",9),g.NdJ("click",function(){return Ie.close()}),g._UZ(47,"ion-icon",10),g._uU(48," Close "),g.qZA()()()()),2&fe&&(g.xp6(3),g.Oqu(g.lcZ(4,3,"ocm.general.about")),g.xp6(37),g.hij("App Version: ",Ie.appVersion,""),g.xp6(2),g.hij("API: ",Ie.apiUrl,""))},dependencies:[ie.YG,ie.Sm,ie.wI,ie.W2,ie.fr,ie.jY,ie.Gu,ie.gu,ie.uN,ie.Nd,ie.wd,ie.sr,c.X$]}),se})()},5476:(Rn,Dt,B)=>{"use strict";B.r(Dt),B.d(Dt,{JourneysModule:()=>Ie});var h=B(9741),g=B(8936),ie=B(4463),c=B(6895),Y=B(4006),se=B(201),y=B(4228),fe=B(8274);let Ie=(()=>{class Ge{}return Ge.\u0275fac=function(be){return new(be||Ge)},Ge.\u0275mod=fe.oAB({type:Ge}),Ge.\u0275inj=fe.cJS({imports:[c.ez,Y.u5,se.Pc,ie.aw,g.e,y.Bz.forChild([{path:"",component:h.g}])]}),Ge})()},9741:(Rn,Dt,B)=>{"use strict";B.d(Dt,{g:()=>Ot});var h=B(3912),g=B(7814),ie=B(3855),c=B(4120),Y=B(3399),se=B(8274),y=B(201),fe=B(6895);function Ie(dt,ye){1&dt&&(se.TgZ(0,"p"),se._uU(1," You have no journeys yet. Start by browsing to a charging location, then add it as Favourite to start a new Journey. "),se.qZA())}function Ge(dt,ye){if(1&dt&&(se.TgZ(0,"p"),se._uU(1),se.qZA()),2&dt){const Fe=se.oxw(2).$implicit;se.xp6(1),se.hij(" ",Fe.Poi.AddressInfo.AddressLine1,"")}}function Q(dt,ye){if(1&dt&&(se.TgZ(0,"p"),se._uU(1),se.qZA()),2&dt){const Fe=se.oxw(2).$implicit;se.xp6(1),se.hij(" ",Fe.Poi.AddressInfo.AddressLine2,"")}}function be(dt,ye){if(1&dt&&(se.TgZ(0,"p"),se._uU(1),se.qZA()),2&dt){const Fe=se.oxw(2).$implicit;se.xp6(1),se.hij(" ",Fe.Poi.AddressInfo.Town,"")}}function me(dt,ye){if(1&dt&&(se.TgZ(0,"p"),se._uU(1),se.qZA()),2&dt){const Fe=se.oxw(2).$implicit;se.xp6(1),se.hij(" ",Fe.Poi.AddressInfo.StateOrProvince,"")}}function Ze(dt,ye){if(1&dt&&(se.TgZ(0,"p"),se._uU(1),se.qZA()),2&dt){const Fe=se.oxw(2).$implicit;se.xp6(1),se.hij(" ",Fe.Poi.AddressInfo.Postcode,"")}}function he(dt,ye){if(1&dt){const Fe=se.EpF();se.TgZ(0,"div")(1,"div",18),se.NdJ("click",function(){se.CHM(Fe);const we=se.oxw().$implicit,et=se.oxw(4);return se.KtG(et.viewPOIDetails(we.Poi))}),se.YNc(2,Ge,2,1,"p",4),se.YNc(3,Q,2,1,"p",4),se.YNc(4,be,2,1,"p",4),se.YNc(5,me,2,1,"p",4),se.YNc(6,Ze,2,1,"p",4),se.qZA(),se.TgZ(7,"ion-button",19),se.NdJ("click",function(){se.CHM(Fe);const we=se.oxw().$implicit,et=se.oxw(4);return se.KtG(et.launchNavigation(we.Poi))}),se._UZ(8,"ion-icon",20),se._uU(9," Navigate "),se.qZA()()}if(2&dt){const Fe=se.oxw().$implicit;se.xp6(2),se.Q6J("ngIf",Fe.Poi.AddressInfo.AddressLine1),se.xp6(1),se.Q6J("ngIf",Fe.Poi.AddressInfo.AddressLine2),se.xp6(1),se.Q6J("ngIf",Fe.Poi.AddressInfo.Town),se.xp6(1),se.Q6J("ngIf",Fe.Poi.AddressInfo.StateOrProvince),se.xp6(1),se.Q6J("ngIf",Fe.Poi.AddressInfo.Postcode)}}function Ke(dt,ye){if(1&dt&&(se.TgZ(0,"div",17),se.YNc(1,he,10,5,"div",4),se.qZA()),2&dt){const Fe=ye.$implicit;se.xp6(1),se.Q6J("ngIf",Fe.Poi)}}function Ae(dt,ye){if(1&dt&&(se.TgZ(0,"ion-item")(1,"h2"),se._uU(2),se.qZA(),se.TgZ(3,"ion-thumbnail",0),se._UZ(4,"ion-icon",15),se.qZA(),se.TgZ(5,"p"),se._uU(6),se.qZA(),se.YNc(7,Ke,2,1,"div",16),se.qZA()),2&dt){const Fe=ye.$implicit;se.xp6(2),se.Oqu(Fe.Title),se.xp6(4),se.Oqu(Fe.Notes),se.xp6(1),se.Q6J("ngForOf",Fe.PoiList)}}function te(dt,ye){if(1&dt&&(se.TgZ(0,"ion-list")(1,"ion-list-header",11),se._uU(2),se._UZ(3,"ion-icon",12),se._uU(4," -- "),se._UZ(5,"ion-icon",13),se._uU(6," -- "),se._UZ(7,"ion-icon",14),se._uU(8," -- "),se.qZA(),se.YNc(9,Ae,8,3,"ion-item",5),se.qZA()),2&dt){const Fe=ye.$implicit;se.xp6(2),se.hij(" ",Fe.Title," "),se.xp6(7),se.Q6J("ngForOf",Fe.WayPoints)}}function Qe(dt,ye){if(1&dt){const Fe=se.EpF();se.TgZ(0,"ion-card")(1,"ion-card-content")(2,"ion-toolbar",8)(3,"ion-title"),se._uU(4),se.qZA(),se.TgZ(5,"ion-buttons",9)(6,"ion-button",1),se.NdJ("click",function(){const et=se.CHM(Fe).$implicit,Je=se.oxw();return se.KtG(Je.deleteJourney(et.ID))}),se._UZ(7,"ion-icon",10),se.qZA()()(),se.TgZ(8,"p"),se._uU(9),se.qZA(),se.YNc(10,te,10,2,"ion-list",5),se.qZA()()}if(2&dt){const Fe=ye.$implicit;se.xp6(4),se.hij(" ",Fe.Title,""),se.xp6(5),se.Oqu(Fe.Notes),se.xp6(1),se.Q6J("ngForOf",Fe.Stages)}}let Ot=(()=>{class dt{constructor(Fe,Ne,we,et,Je){this.appManager=Fe,this.journeyManager=Ne,this.api=we,this.modalController=et,this.alertController=Je}dismiss(){this.modalController.dismiss()}discoverImages(){this.journeyManager.journeys.forEach(Fe=>{Fe.Stages.forEach(Ne=>{Ne.WayPoints.forEach(we=>{null!=we.PoiList&&we.PoiList.forEach(et=>{et.Poi&&this.api.getPanoramioLocationPhotos(new c.wC(et.Poi.AddressInfo.Latitude,et.Poi.AddressInfo.Longitude)).then(Je=>{et.Photos=Je})})})})})}getJson(Fe){return JSON.stringify(Fe,null,4)}viewPOIDetails(Fe){this.modalController.create({component:Y.H,componentProps:{item:Fe}}).then(Ne=>Ne.present())}get staticMapSize(){return"60x60"}getStaticMapURL(Fe){return"https://maps.googleapis.com/maps/api/staticmap?center="+Fe.AddressInfo.Latitude+","+Fe.AddressInfo.Longitude+"&zoom=13&scale=2&size="+this.staticMapSize+"&maptype=roadmap&format=jpg&visual_refresh=true&markers=size:small%7Ccolor:0xff0000%7Clabel:%7C"+Fe.AddressInfo.Latitude+","+Fe.AddressInfo.Longitude}deleteJourney(Fe){this.alertController.create({header:"Delete this Journey?",message:"Are you sure you want to delete this Journey?",buttons:[{text:"No",handler:()=>{}},{text:"Delete",handler:()=>{this.journeyManager.deleteJourney(Fe)}}]}).then(Ne=>Ne.present())}launchNavigation(Fe){let Ne="https://maps.google.com/?q="+Fe.AddressInfo.Latitude+","+Fe.AddressInfo.Longitude;this.appManager.platform.is("ios")&&(Ne="https://maps.apple.com?q="+Fe.AddressInfo.Latitude+","+Fe.AddressInfo.Longitude),window.open(Ne,"_system")}}return dt.\u0275fac=function(Fe){return new(Fe||dt)(se.Y36(ie.c),se.Y36(h.i),se.Y36(g.l),se.Y36(y.IN),se.Y36(y.Br))},dt.\u0275cmp=se.Xpm({type:dt,selectors:[["ng-component"]],decls:18,vars:2,consts:[["slot","start"],[3,"click"],[1,"journeys-page"],[1,"ion-padding"],[4,"ngIf"],[4,"ngFor","ngForOf"],["slot","end"],["name","close","slot","start"],["primary",""],["slot","primary"],["name","close","slot","icon-only"],[2,"font-size","1.5rem"],["name","car"],["name","time"],["name","flash"],["name","caret-down",2,"font-size","4rem"],["style","text-align:right;width:100%;",4,"ngFor","ngForOf"],[2,"text-align","right","width","100%"],["tappable","",3,"click"],["clear","","item-right","",3,"click"],["name","navigate","slot","start"]],template:function(Fe,Ne){1&Fe&&(se.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0)(3,"ion-back-button",1),se.NdJ("click",function(){return Ne.dismiss()}),se.qZA()(),se.TgZ(4,"ion-title"),se._uU(5," Journeys "),se.qZA()()(),se.TgZ(6,"ion-content",2)(7,"div",3)(8,"p"),se._uU(9," You can create and plan journeys to group your favourite charging routes together. "),se.qZA(),se.YNc(10,Ie,2,0,"p",4),se.qZA(),se.YNc(11,Qe,11,3,"ion-card",5),se.qZA(),se.TgZ(12,"ion-footer")(13,"ion-toolbar")(14,"ion-buttons",6)(15,"ion-button",1),se.NdJ("click",function(){return Ne.dismiss()}),se._UZ(16,"ion-icon",7),se._uU(17," Close "),se.qZA()()()()),2&Fe&&(se.xp6(10),se.Q6J("ngIf",null==Ne.journeyManager.journeys||0==Ne.journeyManager.journeys.length),se.xp6(1),se.Q6J("ngForOf",Ne.journeyManager.journeys))},dependencies:[fe.sg,fe.O5,y.oU,y.YG,y.Sm,y.PM,y.FN,y.W2,y.fr,y.Gu,y.gu,y.Ie,y.q_,y.yh,y.Bs,y.wd,y.sr,y.cs],encapsulation:2}),dt})()},5005:(Rn,Dt,B)=>{"use strict";B.r(Dt),B.d(Dt,{LayerEditorPageModule:()=>Ge});var h=B(6895),g=B(4006),ie=B(201),c=B(4228),Y=B(6588),se=B(8274);const y=[{path:"",component:Y.A}];let fe=(()=>{class Q{}return Q.\u0275fac=function(me){return new(me||Q)},Q.\u0275mod=se.oAB({type:Q}),Q.\u0275inj=se.cJS({imports:[c.Bz.forChild(y),c.Bz]}),Q})();var Ie=B(8936);let Ge=(()=>{class Q{}return Q.\u0275fac=function(me){return new(me||Q)},Q.\u0275mod=se.oAB({type:Q}),Q.\u0275inj=se.cJS({imports:[h.ez,g.u5,ie.Pc,fe,Ie.e]}),Q})()},6588:(Rn,Dt,B)=>{"use strict";B.d(Dt,{A:()=>fe});var h=B(5861),g=B(6799),ie=B(8274),c=B(201),Y=B(6895),se=B(6585);function y(Ie,Ge){if(1&Ie&&(ie.TgZ(0,"div"),ie._uU(1),ie._UZ(2,"app-poi-list",10),ie.qZA()),2&Ie){const Q=ie.oxw();ie.xp6(1),ie.hij(" Items Parsed: ",Q.fileData.length," "),ie.xp6(1),ie.Q6J("poiList",Q.fileData)}}let fe=(()=>{class Ie{constructor(Q,be){this.modalController=Q,this.refData=be}ngOnInit(){}previewFile(){var Q=this;return(0,h.Z)(function*(){yield Q.loadFile(!1)})()}cancel(){var Q=this;return(0,h.Z)(function*(){yield Q.modalController.dismiss(Q.fileData)})()}loadFile(Q=!0){var be=this;return(0,h.Z)(function*(){const me=new FileReader;me.onload=()=>{let he=JSON.parse(me.result);for(let Ke of he)Ke.ID="imp_"+Ke.ID;be.fileData=be.refData.hydrateCompactPOIList(he),Q&&be.modalController.dismiss(be.fileData)},me.onerror=()=>{},me.readAsText(document.getElementById("file-upload").files[0])})()}add(){var Q=this;return(0,h.Z)(function*(){Q.modalController.dismiss(Q.fileData)})()}}return Ie.\u0275fac=function(Q){return new(Q||Ie)(ie.Y36(c.IN),ie.Y36(g.W))},Ie.\u0275cmp=ie.Xpm({type:Ie,selectors:[["app-layer-editor"]],decls:27,vars:1,consts:[[1,"ion-padding"],[1,"upload"],["name","file","aria-label","file","slot","start"],["type","file","required","","id","file-upload",3,"change"],[4,"ngIf"],["slot","secondary"],[3,"click"],["name","close","slot","start"],["slot","primary"],["name","checkmark-circle-outline","slot","end"],[3,"poiList"]],template:function(Q,be){1&Q&&(ie.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),ie._uU(3," Edit Layer "),ie.qZA()()(),ie.TgZ(4,"ion-content",0)(5,"p"),ie._uU(6,"POI layers are used to preview data from other Open Data sources. "),ie.qZA(),ie.TgZ(7,"p"),ie._uU(8,"Select a POI layer JSON file: "),ie.qZA(),ie.TgZ(9,"div")(10,"label",1)(11,"ion-button"),ie._UZ(12,"ion-icon",2),ie.TgZ(13,"ion-label"),ie._uU(14,"Choose File.."),ie.qZA()(),ie.TgZ(15,"input",3),ie.NdJ("change",function(){return be.previewFile()}),ie.qZA()()(),ie.YNc(16,y,3,2,"div",4),ie.qZA(),ie.TgZ(17,"ion-footer")(18,"ion-toolbar")(19,"ion-buttons",5)(20,"ion-button",6),ie.NdJ("click",function(){return be.cancel()}),ie._UZ(21,"ion-icon",7),ie._uU(22," Cancel "),ie.qZA()(),ie.TgZ(23,"ion-buttons",8)(24,"ion-button",6),ie.NdJ("click",function(){return be.add()}),ie._uU(25," Add "),ie._UZ(26,"ion-icon",9),ie.qZA()()()()),2&Q&&(ie.xp6(16),ie.Q6J("ngIf",be.fileData&&be.fileData.length>0))},dependencies:[Y.O5,c.YG,c.Sm,c.W2,c.fr,c.Gu,c.gu,c.Q$,c.wd,c.sr,se.o],styles:[".upload[_ngcontent-%COMP%]   input[type=file][_ngcontent-%COMP%]{position:fixed;top:-1000px}"]}),Ie})()},3399:(Rn,Dt,B)=>{"use strict";B.d(Dt,{H:()=>gn});var h=B(3855),g=B(8274),ie=B(201),c=B(5861),Y=B(3912),se=B(129),y=B(6895),fe=B(4006);function Ie(Ve,le){if(1&Ve&&(g.TgZ(0,"ion-select-option",13),g._uU(1),g.qZA()),2&Ve){const R=le.$implicit;g.Q6J("value",R.ID),g.xp6(1),g.Oqu(R.Title)}}function Ge(Ve,le){if(1&Ve&&(g.TgZ(0,"ion-select-option",16),g._uU(1),g.qZA()),2&Ve){const R=le.$implicit;g.Q6J("value",le.index),g.xp6(1),g.Oqu(R.Title)}}function Q(Ve,le){if(1&Ve){const R=g.EpF();g.TgZ(0,"ion-item")(1,"ion-label",2),g._uU(2,"Journey Stage"),g.qZA(),g.TgZ(3,"ion-select",3),g.NdJ("ngModelChange",function(de){g.CHM(R);const Le=g.oxw();return g.KtG(Le.selectedStageIndex=de)}),g.TgZ(4,"ion-select-option",14),g._uU(5,"Create a Journey Stage"),g.qZA(),g.YNc(6,Ge,2,2,"ion-select-option",15),g.qZA()()}if(2&Ve){const R=g.oxw();g.xp6(3),g.Q6J("ngModel",R.selectedStageIndex),g.xp6(3),g.Q6J("ngForOf",R.journeyManager.getJourneyStages(R.selectedJourneyID))}}function be(Ve,le){if(1&Ve){const R=g.EpF();g.TgZ(0,"ion-item")(1,"ion-label",2),g._uU(2,"New Journey Name"),g.qZA(),g.TgZ(3,"ion-input",7),g.NdJ("ngModelChange",function(de){g.CHM(R);const Le=g.oxw();return g.KtG(Le.newJourneyName=de)}),g.qZA()()}if(2&Ve){const R=g.oxw();g.xp6(3),g.Q6J("ngModel",R.newJourneyName)}}let me=(()=>{class Ve{constructor(R,j,de,Le){this.appManager=R,this.navParams=j,this.journeyManager=de,this.modalController=Le,this.poi=this.navParams.get("poi"),this.waypoint=new se.kA,this.waypoint.Title=this.poi.AddressInfo.Title,this.waypoint.PoiIDs=[this.poi.ID],this.waypoint.PoiList=[];const st=new se.Qp("charging",1);st.Poi=this.poi,st.PoiID=this.poi.ID,this.waypoint.PoiList.push(st),this.newJourneyName="Trip to "+this.poi.AddressInfo.Title}cancel(){this.modalController.dismiss()}add(){if(null!=this.selectedJourneyID&&""!==this.selectedJourneyID)this.journeyManager.addJourneyWaypoint(this.selectedJourneyID,this.selectedStageIndex,this.waypoint);else{const R=new se.fw;R.ID=Date.now().toString(),""===this.newJourneyName&&(this.newJourneyName="New Journey"),R.Title=this.newJourneyName,this.journeyManager.addJourney(R,this.waypoint)}this.journeyManager.saveJourneys(),this.modalController.dismiss()}}return Ve.\u0275fac=function(R){return new(R||Ve)(g.Y36(h.c),g.Y36(ie.X1),g.Y36(Y.i),g.Y36(ie.IN))},Ve.\u0275cmp=g.Xpm({type:Ve,selectors:[["ng-component"]],decls:39,vars:8,consts:[[1,"journeys-page","ion-padding"],[1,"banner"],["position","stacked"],[3,"ngModel","ngModelChange"],["value","","checked",""],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],["type","text",3,"ngModel","ngModelChange"],["slot","secondary"],[3,"click"],["name","close","slot","start"],["slot","primary"],["name","add","slot","end"],[3,"value"],["value",""],["checked","",3,"value",4,"ngFor","ngForOf"],["checked","",3,"value"]],template:function(R,j){1&R&&(g.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),g._uU(3," Edit Favourite "),g.qZA()()(),g.TgZ(4,"ion-content",0)(5,"div",1)(6,"h1"),g._uU(7),g.qZA(),g.TgZ(8,"p"),g._uU(9),g.qZA()(),g.TgZ(10,"p"),g._uU(11," Add Charging Location as a Journey Waypoint "),g.qZA(),g.TgZ(12,"ion-item")(13,"ion-label",2),g._uU(14,"Add to a Journey"),g.qZA(),g.TgZ(15,"ion-select",3),g.NdJ("ngModelChange",function(Le){return j.selectedJourneyID=Le}),g.TgZ(16,"ion-select-option",4),g._uU(17,"Create a New Journey"),g.qZA(),g.YNc(18,Ie,2,2,"ion-select-option",5),g.qZA()(),g.YNc(19,Q,7,2,"ion-item",6),g.YNc(20,be,4,1,"ion-item",6),g.TgZ(21,"ion-item")(22,"ion-label",2),g._uU(23,"Name for this step of your journey"),g.qZA(),g.TgZ(24,"ion-input",7),g.NdJ("ngModelChange",function(Le){return j.waypoint.Title=Le}),g.qZA()(),g.TgZ(25,"ion-item")(26,"ion-label",2),g._uU(27,"Other Notes"),g.qZA(),g.TgZ(28,"ion-textarea",3),g.NdJ("ngModelChange",function(Le){return j.waypoint.Notes=Le}),g.qZA()()(),g.TgZ(29,"ion-footer")(30,"ion-toolbar")(31,"ion-buttons",8)(32,"ion-button",9),g.NdJ("click",function(){return j.cancel()}),g._UZ(33,"ion-icon",10),g._uU(34," Cancel "),g.qZA()(),g.TgZ(35,"ion-buttons",11)(36,"ion-button",9),g.NdJ("click",function(){return j.add()}),g._uU(37," Add "),g._UZ(38,"ion-icon",12),g.qZA()()()()),2&R&&(g.xp6(7),g.Oqu(j.poi.AddressInfo.Title),g.xp6(2),g.Oqu(j.poi.AddressInfo.AddressLine1),g.xp6(6),g.Q6J("ngModel",j.selectedJourneyID),g.xp6(3),g.Q6J("ngForOf",j.journeyManager.journeys),g.xp6(1),g.Q6J("ngIf",j.selectedJourneyID),g.xp6(1),g.Q6J("ngIf",!j.selectedJourneyID),g.xp6(4),g.Q6J("ngModel",j.waypoint.Title),g.xp6(4),g.Q6J("ngModel",j.waypoint.Notes))},dependencies:[y.sg,y.O5,fe.JJ,fe.On,ie.YG,ie.Sm,ie.W2,ie.fr,ie.Gu,ie.gu,ie.pK,ie.Ie,ie.Q$,ie.t9,ie.n0,ie.g2,ie.wd,ie.sr,ie.QI,ie.j9],encapsulation:2}),Ve})();var Ze=B(7689);function he(Ve,le){if(1&Ve){const R=g.EpF();g.TgZ(0,"ion-card")(1,"ion-toolbar")(2,"ion-title",14),g._uU(3,"Preview"),g.qZA(),g.TgZ(4,"ion-buttons",15)(5,"ion-button",4),g.NdJ("click",function(){g.CHM(R);const de=g.oxw();return g.KtG(de.rotateImage())}),g._UZ(6,"ion-icon",16),g.TgZ(7,"ion-label"),g._uU(8,"Rotate"),g.qZA()()()(),g.TgZ(9,"ion-card-content")(10,"ion-list")(11,"ion-item")(12,"ion-label",17),g._uU(13,"Comment"),g.qZA(),g.TgZ(14,"ion-input",18),g.NdJ("ngModelChange",function(de){g.CHM(R);const Le=g.oxw();return g.KtG(Le.comment=de)}),g.qZA()()(),g._UZ(15,"img",19),g.qZA()()}if(2&Ve){const R=g.oxw();g.xp6(14),g.Q6J("ngModel",R.comment)}}let Ke=(()=>{class Ve{constructor(R,j,de,Le,st){this.navParams=R,this.appManager=j,this.nav=de,this.modalController=Le,this.logging=st,this.processingQuality=.8,this.targetWidth=1024,this.targetHeight=800,this.mode=j.platformMode,this.chargePointId=this.navParams.get("id"),this.poi=this.navParams.get("poi"),this.comment=""}processNativeImageSource(R){let j=R;const de=document.getElementById("img-upload-canvas"),Le=de.getContext("2d"),st=new Image;st.onload=()=>{this.logging.log("img load:"+st.width),de.width=st.width,de.height=st.height,Le.fillStyle="rgb(0,0,0)",Le.fillRect(0,0,de.width,de.height),Le.drawImage(st,0,0,de.width,de.height),this.imgData=de.toDataURL("image/png"),this.processImage()},st.src=j}loadCameraOrLibraryImage(R=!1){this.logging.log("PWA mode: fetching image");const j=new FileReader;j.onload=()=>{this.imgData=j.result,this.processImage()},j.onerror=()=>{},j.readAsDataURL(document.getElementById("img-upload-media").files[0])}isBrowserMode(){return this.appManager.isPlatform("desktop")||this.appManager.isPlatform("hybrid")}processImage(){if(null!=this.imgData){const j=document.getElementById("img-upload-canvas"),de=j.getContext("2d"),Le=new Image;Le.onload=()=>{j.width=Le.width,j.height=Le.height,de.fillStyle="rgb(0,0,0)",de.fillRect(0,0,j.width,j.height),de.drawImage(Le,0,0,j.width,j.height),this.refreshImageFromCanvas()},Le.src=this.imgData}else this.logging.log("processImage: nothing to process.")}refreshImageFromCanvas(){const R=document.getElementById("img-upload-canvas");this.imgData=R.toDataURL("image/jpeg",.8),document.getElementById("preview").src=this.imgData}rotateImage(){const R=document.getElementById("img-upload-canvas");let j=new Image;j.src=R.toDataURL(),j.onload=()=>{let de=R.height,Le=R.width;R.width=de,R.height=Le,de=R.height,Le=R.width;const st=R.getContext("2d");st.save(),st.translate(Le,de/Le),st.rotate(Math.PI/2),st.drawImage(j,0,0),st.restore(),j=null,this.refreshImageFromCanvas()}}performUpload(){var R=this;return(0,c.Z)(function*(){if(!R.imgData)return void(yield R.appManager.showToastNotification("Select an image to upload."));const j={chargePointID:R.chargePointId,comment:R.comment,imageDataBase64:R.imgData};yield R.appManager.showLoadingProgress("Uploading photo..");try{yield R.appManager.submitMediaItem(j),R.appManager.dismissLoadingProgress().then(()=>{R.appManager.showToastNotification("Upload completed"),R.modalController.dismiss()}),R.appManager.analytics.appEvent("MediaUpload","Completed")}catch{yield R.appManager.dismissLoadingProgress(),yield R.appManager.showToastNotification("Upload failed, please try again."),R.appManager.analytics.appEvent("MediaUpload","Failed")}})()}cancel(){var R=this;return(0,c.Z)(function*(){yield R.modalController.dismiss()})()}}return Ve.\u0275fac=function(R){return new(R||Ve)(g.Y36(ie.X1),g.Y36(h.c),g.Y36(ie.SH),g.Y36(ie.IN),g.Y36(Ze.z))},Ve.\u0275cmp=g.Xpm({type:Ve,selectors:[["ng-component"]],decls:32,vars:3,consts:[[1,"media-upload"],[1,"ion-padding"],[1,"banner"],[1,"upload"],[3,"click"],["name","camera","aria-label","camera","slot","start"],["type","file","required","","id","img-upload-media",3,"change"],["inputFile",""],["id","img-upload-canvas",2,"display","none","width","500","height","500","border","1px solid red"],[4,"ngIf"],["slot","secondary"],["name","close","slot","start"],["slot","primary"],["name","send","slot","end"],["slot","start"],["slot","end"],["name","refresh","slot","start"],["position","floating"],["type","text","placeholder","(optional comment)",3,"ngModel","ngModelChange"],["id","preview",2,"max-width","500px"]],template:function(R,j){if(1&R){const de=g.EpF();g.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),g._uU(3," Share Photo "),g.qZA()()(),g.TgZ(4,"ion-content",0)(5,"div",1)(6,"div",2)(7,"h1"),g._uU(8),g.qZA(),g.TgZ(9,"p"),g._uU(10),g.qZA()(),g.TgZ(11,"p"),g._uU(12,"You can upload a photo from your device or take a new photo: "),g.qZA(),g.TgZ(13,"div",3)(14,"ion-button",4),g.NdJ("click",function(){g.CHM(de);const st=g.MAs(19);return g.KtG(st.click())}),g._UZ(15,"ion-icon",5),g.TgZ(16,"ion-label"),g._uU(17,"Choose Photo.."),g.qZA()(),g.TgZ(18,"input",6,7),g.NdJ("change",function(){return j.loadCameraOrLibraryImage()}),g.qZA()(),g._UZ(20,"canvas",8),g.YNc(21,he,16,1,"ion-card",9),g.qZA()(),g.TgZ(22,"ion-footer")(23,"ion-toolbar")(24,"ion-buttons",10)(25,"ion-button",4),g.NdJ("click",function(){return j.cancel()}),g._UZ(26,"ion-icon",11),g._uU(27," Cancel "),g.qZA()(),g.TgZ(28,"ion-buttons",12)(29,"ion-button",4),g.NdJ("click",function(){return j.performUpload()}),g._uU(30," Upload "),g._UZ(31,"ion-icon",13),g.qZA()()()()}2&R&&(g.xp6(8),g.Oqu(j.poi.AddressInfo.Title),g.xp6(2),g.Oqu(j.poi.AddressInfo.AddressLine1),g.xp6(11),g.Q6J("ngIf",null!=j.imgData))},dependencies:[y.O5,fe.JJ,fe.On,ie.YG,ie.Sm,ie.PM,ie.FN,ie.W2,ie.fr,ie.Gu,ie.gu,ie.pK,ie.Ie,ie.Q$,ie.q_,ie.wd,ie.sr,ie.j9],styles:[".upload[_ngcontent-%COMP%]   input[type=file][_ngcontent-%COMP%]{position:fixed;top:-1000px}"]}),Ve})();var Ae=B(4228);function te(Ve,le){if(1&Ve&&(g.TgZ(0,"ion-select-option",19),g._uU(1),g.qZA()),2&Ve){const R=le.$implicit;g.Q6J("value",R.ID),g.xp6(1),g.Oqu(R.Title)}}function Qe(Ve,le){if(1&Ve&&(g.TgZ(0,"ion-select-option",19),g._uU(1),g.qZA()),2&Ve){const R=le.$implicit;g.Q6J("value",R.ID),g.xp6(1),g.Oqu(R.Title)}}let Ot=(()=>{class Ve{constructor(R,j,de,Le,st,Bt,Rt,at){this.navParams=R,this.appManager=j,this.nav=de,this.zone=Le,this.loadingController=st,this.modalController=Bt,this.logging=Rt,this.router=at,this.commentModel={ChargePointID:this.navParams.get("id"),Comment:"",CheckinStatusTypeID:10,CommentTypeID:10,Rating:null},this.poi=this.navParams.get("poi"),this.commentTypes=j.referenceDataManager.getCommentTypes(!0,!0),this.checkinTypes=j.referenceDataManager.getCheckinStatusTypes(!0,!0)}onPageWillEnter(){}cancel(){this.modalController.dismiss()}add(){var R=this;return(0,c.Z)(function*(){const j=yield R.loadingController.create({message:"Sending .."});yield j.present(),(yield R.appManager.submitComment(R.commentModel).catch(Le=>{R.appManager.showToastNotification("There was a problem submitting your comment."),R.loadingController.dismiss(),R.appManager.analytics.appEvent("Comment","Failed")}))&&(R.logging.log("Comment submitted"),yield j.dismiss(),yield R.modalController.dismiss(),R.appManager.analytics.appEvent("Comment","Submitted"))})()}}return Ve.\u0275fac=function(R){return new(R||Ve)(g.Y36(ie.X1),g.Y36(h.c),g.Y36(ie.SH),g.Y36(g.R0b),g.Y36(ie.HT),g.Y36(ie.IN),g.Y36(Ze.z),g.Y36(Ae.F0))},Ve.\u0275cmp=g.Xpm({type:Ve,selectors:[["ng-component"]],decls:53,vars:8,consts:[["color","primary"],[1,"comment-page","ion-padding"],[1,"banner"],[1,"ion-padding"],["position","stacked"],[3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["type","text","placeholder","(optional comment)",3,"ngModel","ngModelChange"],["value","5"],["value","4"],["value","3"],["value","2"],["value","1"],["value",""],["slot","secondary"],[3,"click"],["name","close","slot","start"],["slot","primary"],["name","send","slot","end"],[3,"value"]],template:function(R,j){1&R&&(g.TgZ(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-title"),g._uU(3," Add Comment "),g.qZA()()(),g.TgZ(4,"ion-content",1)(5,"div",2)(6,"h1"),g._uU(7),g.qZA(),g.TgZ(8,"p"),g._uU(9),g.qZA()(),g.TgZ(10,"p",3),g._uU(11,"Recent Check-ins are a big help to other drivers when planning their journey. Tell everyone what you thought about this charging location. "),g.qZA(),g.TgZ(12,"ion-list")(13,"ion-item")(14,"ion-label",4),g._uU(15,"Comment Type"),g.qZA(),g.TgZ(16,"ion-select",5),g.NdJ("ngModelChange",function(Le){return j.commentModel.CommentTypeID=Le}),g.YNc(17,te,2,2,"ion-select-option",6),g.qZA()(),g.TgZ(18,"ion-item")(19,"ion-label",4),g._uU(20,"What Did You Think?"),g.qZA(),g.TgZ(21,"ion-input",7),g.NdJ("ngModelChange",function(Le){return j.commentModel.Comment=Le}),g.qZA()(),g.TgZ(22,"ion-item")(23,"ion-label",4),g._uU(24,"Did You Successfully Charge?"),g.qZA(),g.TgZ(25,"ion-select",5),g.NdJ("ngModelChange",function(Le){return j.commentModel.CheckinStatusTypeID=Le}),g.YNc(26,Qe,2,2,"ion-select-option",6),g.qZA()(),g.TgZ(27,"ion-item")(28,"ion-label",4),g._uU(29,"Your Rating"),g.qZA(),g.TgZ(30,"ion-select",5),g.NdJ("ngModelChange",function(Le){return j.commentModel.Rating=Le}),g.TgZ(31,"ion-select-option",8),g._uU(32,"5 - Excellent"),g.qZA(),g.TgZ(33,"ion-select-option",9),g._uU(34,"4 - Good"),g.qZA(),g.TgZ(35,"ion-select-option",10),g._uU(36,"3 - Average"),g.qZA(),g.TgZ(37,"ion-select-option",11),g._uU(38,"2 - Not Good"),g.qZA(),g.TgZ(39,"ion-select-option",12),g._uU(40,"1 - Bad"),g.qZA(),g.TgZ(41,"ion-select-option",13),g._uU(42,"Not Rated"),g.qZA()()()()(),g.TgZ(43,"ion-footer")(44,"ion-toolbar")(45,"ion-buttons",14)(46,"ion-button",15),g.NdJ("click",function(){return j.cancel()}),g._UZ(47,"ion-icon",16),g._uU(48," Cancel "),g.qZA()(),g.TgZ(49,"ion-buttons",17)(50,"ion-button",15),g.NdJ("click",function(){return j.add()}),g._uU(51," Submit "),g._UZ(52,"ion-icon",18),g.qZA()()()()),2&R&&(g.xp6(7),g.Oqu(j.poi.AddressInfo.Title),g.xp6(2),g.Oqu(j.poi.AddressInfo.AddressLine1),g.xp6(7),g.Q6J("ngModel",j.commentModel.CommentTypeID),g.xp6(1),g.Q6J("ngForOf",j.commentTypes),g.xp6(4),g.Q6J("ngModel",j.commentModel.Comment),g.xp6(4),g.Q6J("ngModel",j.commentModel.CheckinStatusTypeID),g.xp6(1),g.Q6J("ngForOf",j.checkinTypes),g.xp6(4),g.Q6J("ngModel",j.commentModel.Rating))},dependencies:[y.sg,fe.JJ,fe.On,ie.YG,ie.Sm,ie.W2,ie.fr,ie.Gu,ie.gu,ie.pK,ie.Ie,ie.Q$,ie.q_,ie.t9,ie.n0,ie.wd,ie.sr,ie.QI,ie.j9],encapsulation:2}),Ve})();var dt=B(2951),ye=B(9698),Fe=B(9492),Ne=B(4508),we=B(6579),et=B(4463),Je=B(1099);function _e(Ve,le){if(1&Ve&&(g.TgZ(0,"div")(1,"small"),g._uU(2),g.qZA()()),2&Ve){const R=g.oxw(2);g.xp6(2),g.Oqu(R.connectionSummary)}}function pe(Ve,le){if(1&Ve&&(g.TgZ(0,"div")(1,"small"),g._uU(2),g.qZA()()),2&Ve){const R=g.oxw(2);g.xp6(2),g.Oqu(R.poi.OperatorInfo.Title)}}function ae(Ve,le){if(1&Ve){const R=g.EpF();g.ynx(0),g.TgZ(1,"ion-button",28),g.NdJ("click",function(){g.CHM(R);const de=g.oxw(2);return g.KtG(de.addFavourite())}),g._UZ(2,"ion-icon",29),g.TgZ(3,"ion-label"),g._uU(4,"Favourite"),g.qZA()(),g.TgZ(5,"ion-button",13),g.NdJ("click",function(){g.CHM(R);const de=g.oxw(2);return g.KtG(de.edit())}),g._UZ(6,"ion-icon",30),g.TgZ(7,"ion-label"),g._uU(8,"Edit"),g.qZA()(),g.BQk()}}function Ee(Ve,le){if(1&Ve){const R=g.EpF();g.ynx(0),g.TgZ(1,"ion-button",31),g.NdJ("click",function(){g.CHM(R);const de=g.oxw(2);return g.KtG(de.launchNavigation())}),g._UZ(2,"ion-icon",32),g.TgZ(3,"ion-label"),g._uU(4,"Navigate"),g.qZA()(),g.BQk()}}function vt(Ve,le){if(1&Ve){const R=g.EpF();g.ynx(0),g.TgZ(1,"ion-button",33),g.NdJ("click",function(){g.CHM(R);const de=g.oxw(2);return g.KtG(de.addComment())}),g._UZ(2,"ion-icon",34),g.TgZ(3,"ion-label"),g._uU(4,"Add Comment"),g.qZA()(),g.BQk()}}function Et(Ve,le){if(1&Ve){const R=g.EpF();g.ynx(0),g.TgZ(1,"ion-button",35),g.NdJ("click",function(){g.CHM(R);const de=g.oxw(2);return g.KtG(de.addMedia())}),g._UZ(2,"ion-icon",36),g.TgZ(3,"ion-label"),g._uU(4," Add Photo"),g.qZA()(),g.BQk()}}function qt(Ve,le){if(1&Ve&&(g.TgZ(0,"div"),g._uU(1),g.qZA()),2&Ve){const R=g.oxw(4);g.xp6(1),g.hij(" ",R.poi.AddressInfo.AddressLine1,"")}}function Ft(Ve,le){if(1&Ve&&(g.TgZ(0,"div"),g._uU(1),g.qZA()),2&Ve){const R=g.oxw(4);g.xp6(1),g.hij(" ",R.poi.AddressInfo.AddressLine2,"")}}function xt(Ve,le){if(1&Ve&&(g.TgZ(0,"div"),g._uU(1),g.qZA()),2&Ve){const R=g.oxw(4);g.xp6(1),g.hij(" ",R.poi.AddressInfo.Town,"")}}function Pt(Ve,le){if(1&Ve&&(g.TgZ(0,"div"),g._uU(1),g.qZA()),2&Ve){const R=g.oxw(4);g.xp6(1),g.hij(" ",R.poi.AddressInfo.StateOrProvince,"")}}function bt(Ve,le){if(1&Ve&&(g.TgZ(0,"div"),g._uU(1),g.qZA()),2&Ve){const R=g.oxw(4);g.xp6(1),g.hij(" ",R.poi.AddressInfo.Postcode,"")}}function ct(Ve,le){if(1&Ve&&(g.TgZ(0,"div"),g._uU(1),g.qZA()),2&Ve){const R=g.oxw(4);g.xp6(1),g.hij(" ",R.poi.AddressInfo.Country.Title,"")}}function ht(Ve,le){if(1&Ve&&(g.TgZ(0,"p"),g._uU(1),g.qZA()),2&Ve){const R=g.oxw(4);g.xp6(1),g.hij(" ",R.poi.AddressInfo.AccessComments," ")}}function Ce(Ve,le){if(1&Ve&&(g.TgZ(0,"p"),g._UZ(1,"ion-icon",48),g.TgZ(2,"span",45),g._uU(3),g.qZA()()),2&Ve){const R=g.oxw(4);g.xp6(3),g.Oqu(R.poi.AddressInfo.ContactTelephone1)}}function Ct(Ve,le){if(1&Ve&&(g.TgZ(0,"p"),g._UZ(1,"ion-icon",48),g.TgZ(2,"span",45),g._uU(3),g.qZA()()),2&Ve){const R=g.oxw(4);g.xp6(3),g.Oqu(R.poi.AddressInfo.ContactTelephone2)}}function Ut(Ve,le){if(1&Ve&&(g.TgZ(0,"p"),g._UZ(1,"ion-icon",49),g.TgZ(2,"span",45),g._uU(3),g.qZA()()),2&Ve){const R=g.oxw(4);g.xp6(3),g.Oqu(R.poi.AddressInfo.ContactEmail)}}function Gt(Ve,le){if(1&Ve&&(g.TgZ(0,"p"),g._UZ(1,"ion-icon",50),g.TgZ(2,"span",45)(3,"a",51),g._uU(4),g.qZA()()()),2&Ve){const R=g.oxw(4);g.xp6(3),g.s9C("href",R.poi.AddressInfo.RelatedURL,g.LSH),g.xp6(1),g.Oqu(R.poi.AddressInfo.RelatedURL)}}function wn(Ve,le){if(1&Ve&&(g.TgZ(0,"ion-card")(1,"ion-card-header"),g._UZ(2,"ion-icon",43),g._uU(3),g.ALo(4,"translate"),g.qZA(),g.TgZ(5,"ion-card-content")(6,"ion-grid")(7,"ion-row")(8,"ion-col")(9,"ion-label",44),g._uU(10),g.ALo(11,"translate"),g.qZA(),g.TgZ(12,"div",45),g.YNc(13,qt,2,1,"div",0),g.YNc(14,Ft,2,1,"div",0),g.YNc(15,xt,2,1,"div",0),g.YNc(16,Pt,2,1,"div",0),g.YNc(17,bt,2,1,"div",0),g.YNc(18,ct,2,1,"div",0),g.qZA()(),g.TgZ(19,"ion-col"),g.YNc(20,ht,2,1,"p",0),g.YNc(21,Ce,4,1,"p",0),g.YNc(22,Ct,4,1,"p",0),g.YNc(23,Ut,4,1,"p",0),g.YNc(24,Gt,5,2,"p",0),g.qZA()(),g.TgZ(25,"ion-row")(26,"ion-col"),g._UZ(27,"ion-icon",46),g.TgZ(28,"ion-label",47),g._uU(29),g.ALo(30,"number"),g.ALo(31,"number"),g.qZA()()()()()()),2&Ve){const R=g.oxw(3);g.xp6(3),g.hij(" ",g.lcZ(4,15,"ocm.details.location.sectionTitle")," "),g.xp6(7),g.hij(" ",g.lcZ(11,17,"ocm.details.location.address"),""),g.xp6(3),g.Q6J("ngIf",R.poi.AddressInfo.AddressLine1),g.xp6(1),g.Q6J("ngIf",R.poi.AddressInfo.AddressLine2),g.xp6(1),g.Q6J("ngIf",R.poi.AddressInfo.Town),g.xp6(1),g.Q6J("ngIf",R.poi.AddressInfo.StateOrProvince),g.xp6(1),g.Q6J("ngIf",R.poi.AddressInfo.Postcode),g.xp6(1),g.Q6J("ngIf",R.poi.AddressInfo.Country),g.xp6(2),g.Q6J("ngIf",R.poi.AddressInfo.AccessComments),g.xp6(1),g.Q6J("ngIf",R.poi.AddressInfo.ContactTelephone1),g.xp6(1),g.Q6J("ngIf",R.poi.AddressInfo.ContactTelephone2),g.xp6(1),g.Q6J("ngIf",R.poi.AddressInfo.ContactEmail),g.xp6(1),g.Q6J("ngIf",R.poi.AddressInfo.RelatedURL),g.xp6(5),g.AsE(" ",g.xi3(30,19,R.poi.AddressInfo.Latitude,"1.1-13")," , ",g.xi3(31,22,R.poi.AddressInfo.Longitude,"1.1-13")," ")}}function Fn(Ve,le){if(1&Ve&&(g.TgZ(0,"p")(1,"span",44),g._uU(2),g.ALo(3,"translate"),g.qZA(),g.TgZ(4,"span",45),g._uU(5),g.qZA()()),2&Ve){const R=g.oxw(3);g.xp6(2),g.hij("",g.lcZ(3,2,"ocm.details.numberOfPoints"),":"),g.xp6(3),g.Oqu(R.poi.NumberOfPoints)}}function un(Ve,le){if(1&Ve&&(g.TgZ(0,"p")(1,"span",44),g._uU(2),g.ALo(3,"translate"),g.qZA(),g.TgZ(4,"span",45),g._uU(5),g.qZA()()),2&Ve){const R=g.oxw(3);g.xp6(2),g.hij("",g.lcZ(3,2,"ocm.details.operationalStatus"),":"),g.xp6(3),g.hij(" ",R.poi.StatusType.Title," ")}}function ut(Ve,le){if(1&Ve&&(g.TgZ(0,"p")(1,"span",44),g._uU(2),g.ALo(3,"translate"),g.qZA(),g.TgZ(4,"span",45),g._uU(5),g.qZA()()),2&Ve){const R=g.oxw(3);g.xp6(2),g.hij("",g.lcZ(3,2,"ocm.details.usageType"),":"),g.xp6(3),g.Oqu(R.poi.UsageType.Title)}}function jt(Ve,le){if(1&Ve&&(g.TgZ(0,"p")(1,"span",44),g._uU(2),g.ALo(3,"translate"),g.qZA(),g.TgZ(4,"span",45),g._uU(5),g.qZA()()),2&Ve){const R=g.oxw(3);g.xp6(2),g.hij("",g.lcZ(3,2,"ocm.details.usageCost"),":"),g.xp6(3),g.hij(" ",R.poi.UsageCost,"")}}function En(Ve,le){if(1&Ve&&(g.TgZ(0,"p"),g._UZ(1,"br"),g._uU(2),g.ALo(3,"translate"),g._UZ(4,"br"),g.TgZ(5,"span",45),g._uU(6),g.qZA()()),2&Ve){const R=g.oxw(3);g.xp6(2),g.hij("",g.lcZ(3,2,"ocm.details.generalComments"),": "),g.xp6(4),g.Oqu(R.poi.GeneralComments)}}function ni(Ve,le){if(1&Ve&&(g.TgZ(0,"p"),g._UZ(1,"ion-icon",54),g._uU(2),g.qZA()),2&Ve){const R=g.oxw(4);g.xp6(2),g.hij(" ",R.poi.OperatorInfo.WebsiteURL," ")}}function ci(Ve,le){if(1&Ve&&(g.TgZ(0,"p"),g._UZ(1,"ion-icon",49),g._uU(2),g.qZA()),2&Ve){const R=g.oxw(4);g.xp6(2),g.hij(" ",R.poi.OperatorInfo.ContactEmail," ")}}function Un(Ve,le){if(1&Ve&&(g.TgZ(0,"p"),g._UZ(1,"ion-icon",49),g._uU(2),g.qZA()),2&Ve){const R=g.oxw(4);g.xp6(2),g.hij(" ",R.poi.OperatorInfo.FaultReportEmail," ")}}function _i(Ve,le){if(1&Ve&&(g.TgZ(0,"ion-card")(1,"ion-card-header"),g._UZ(2,"ion-icon",52),g._uU(3),g.ALo(4,"translate"),g.qZA(),g.TgZ(5,"ion-card-content")(6,"div",45)(7,"p",53),g._uU(8),g.qZA(),g.YNc(9,ni,3,1,"p",0),g.YNc(10,ci,3,1,"p",0),g.YNc(11,Un,3,1,"p",0),g.qZA()()()),2&Ve){const R=g.oxw(3);g.xp6(3),g.hij(" ",g.lcZ(4,5,"ocm.details.operator.sectionTitle")," "),g.xp6(5),g.hij(" ",R.poi.OperatorInfo.Title," "),g.xp6(1),g.Q6J("ngIf",R.poi.OperatorInfo.WebsiteURL),g.xp6(1),g.Q6J("ngIf",null!=R.poi.OperatorInfo.ContactEmail),g.xp6(1),g.Q6J("ngIf",null!=R.poi.OperatorInfo.FaultReportEmail&&R.poi.OperatorInfo.FaultReportEmail!=R.poi.OperatorInfo.ContactEmail)}}function wi(Ve,le){if(1&Ve){const R=g.EpF();g.TgZ(0,"a",56),g.NdJ("click",function(){g.CHM(R);const de=g.oxw(4);return g.KtG(de.launchURL(de.poi.DataProvider.WebsiteURL))}),g._uU(1),g.qZA()}if(2&Ve){const R=g.oxw(4);g.xp6(1),g.Oqu(R.poi.DataProvider.WebsiteURL)}}function xi(Ve,le){if(1&Ve&&(g.TgZ(0,"div",45)(1,"h3"),g._uU(2),g.ALo(3,"translate"),g.qZA(),g.TgZ(4,"p"),g._uU(5),g.qZA(),g.YNc(6,wi,2,1,"a",55),g.TgZ(7,"p"),g._uU(8),g.qZA()()),2&Ve){const R=g.oxw(3);g.xp6(2),g.hij(" ",g.lcZ(3,4,"ocm.details.dataProvider.sectionTitle")," "),g.xp6(3),g.Oqu(null==R.poi.DataProvider?null:R.poi.DataProvider.Title),g.xp6(1),g.Q6J("ngIf",R.poi.DataProvider.WebsiteURL),g.xp6(2),g.Oqu(null==R.poi.DataProvider?null:R.poi.DataProvider.License)}}function Ni(Ve,le){if(1&Ve&&(g.TgZ(0,"div",37),g.YNc(1,wn,32,25,"ion-card",0),g.TgZ(2,"ion-card")(3,"ion-card-header"),g._UZ(4,"ion-icon",38),g._uU(5),g.ALo(6,"translate"),g.qZA(),g.TgZ(7,"ion-card-content"),g.YNc(8,Fn,6,4,"p",0),g._UZ(9,"app-equipment-details",39),g.qZA()(),g.TgZ(10,"ion-card")(11,"ion-card-header"),g._UZ(12,"ion-icon",40),g._uU(13," Usage Restrictions "),g.qZA(),g.TgZ(14,"ion-card-content"),g.YNc(15,un,6,4,"p",0),g.YNc(16,ut,6,4,"p",0),g.YNc(17,jt,6,4,"p",0),g.YNc(18,En,7,4,"p",0),g.qZA()(),g.YNc(19,_i,12,7,"ion-card",0),g.TgZ(20,"ion-card")(21,"ion-card-header"),g._UZ(22,"ion-icon",41),g._uU(23),g.ALo(24,"translate"),g.qZA(),g.TgZ(25,"ion-card-content"),g.YNc(26,xi,9,6,"div",42),g.qZA()()()),2&Ve){const R=g.oxw(2);g.xp6(1),g.Q6J("ngIf",R.poi.AddressInfo),g.xp6(4),g.hij(" ",g.lcZ(6,11,"ocm.details.equipment.sectionTitle")," "),g.xp6(3),g.Q6J("ngIf",null!=R.poi.NumberOfPoints),g.xp6(1),g.Q6J("item",R.poi),g.xp6(6),g.Q6J("ngIf",null!=R.poi.StatusType),g.xp6(1),g.Q6J("ngIf",null!=R.poi.UsageType),g.xp6(1),g.Q6J("ngIf",null!=R.poi.UsageCost),g.xp6(1),g.Q6J("ngIf",null!=R.poi.GeneralComments),g.xp6(1),g.Q6J("ngIf",R.poi.OperatorInfo),g.xp6(4),g.hij(" ",g.lcZ(24,13,"ocm.details.advancedDetails")," "),g.xp6(3),g.Q6J("ngIf",R.poi.DataProvider)}}function Ii(Ve,le){if(1&Ve&&g._UZ(0,"img",60),2&Ve){const R=g.oxw().$implicit;g.s9C("src",null==R.User?null:R.User.ProfileImageURL,g.LSH)}}function Ui(Ve,le){if(1&Ve&&(g.TgZ(0,"span"),g._uU(1),g.qZA()),2&Ve){const R=g.oxw().$implicit;g.xp6(1),g.Oqu(R.User.Username)}}function Yi(Ve,le){if(1&Ve&&(g.TgZ(0,"span"),g._uU(1),g.qZA()),2&Ve){const R=g.oxw().$implicit;g.xp6(1),g.Oqu(R.Username)}}function Ht(Ve,le){if(1&Ve&&(g.TgZ(0,"p",45),g._uU(1),g.qZA()),2&Ve){const R=g.oxw().$implicit;g.xp6(1),g.hij(" ",null==R.CommentType?null:R.CommentType.Title," ")}}function Mt(Ve,le){if(1&Ve&&(g.TgZ(0,"p")(1,"span",44),g._uU(2,"Rating:"),g.qZA(),g.TgZ(3,"span",45),g._uU(4),g.qZA()()),2&Ve){const R=g.oxw().$implicit;g.xp6(4),g.hij("",R.Rating," out of 5")}}function qe(Ve,le){1&Ve&&(g.ynx(0),g._UZ(1,"ion-icon",61),g.BQk())}function re(Ve,le){1&Ve&&(g.ynx(0),g._UZ(1,"ion-icon",62),g.BQk())}function tt(Ve,le){if(1&Ve&&(g.TgZ(0,"p"),g.YNc(1,qe,2,0,"ng-container",0),g.YNc(2,re,2,0,"ng-container",0),g._uU(3),g.qZA()),2&Ve){const R=g.oxw().$implicit;g.xp6(1),g.Q6J("ngIf",!0===R.CheckinStatusType.IsPositive),g.xp6(1),g.Q6J("ngIf",!1===R.CheckinStatusType.IsPositive),g.xp6(1),g.hij(" ",R.CheckinStatusType.Title," ")}}function Wt(Ve,le){if(1&Ve&&(g.TgZ(0,"ion-card")(1,"ion-item")(2,"ion-avatar",19),g.YNc(3,Ii,1,1,"img",59),g.qZA(),g.TgZ(4,"ion-label"),g.YNc(5,Ui,2,1,"span",0),g.YNc(6,Yi,2,1,"span",0),g.qZA(),g.TgZ(7,"ion-label",20),g._uU(8),g.ALo(9,"date"),g.qZA()(),g.TgZ(10,"ion-card-content")(11,"p"),g._uU(12),g.qZA(),g.YNc(13,Ht,2,1,"p",42),g.YNc(14,Mt,5,1,"p",0),g.YNc(15,tt,4,3,"p",0),g.qZA()()),2&Ve){const R=le.$implicit;g.xp6(3),g.Q6J("ngIf",R.User&&R.User.ProfileImageURL),g.xp6(2),g.Q6J("ngIf",R.User),g.xp6(1),g.Q6J("ngIf",!R.User),g.xp6(2),g.hij(" ",g.lcZ(9,8,R.DateCreated)," "),g.xp6(4),g.Oqu(R.Comment),g.xp6(1),g.Q6J("ngIf",10!=R.CommentTypeID),g.xp6(1),g.Q6J("ngIf",R.Rating),g.xp6(1),g.Q6J("ngIf",R.CheckinStatusType)}}function Qt(Ve,le){if(1&Ve&&(g.ynx(0),g.YNc(1,Wt,16,10,"ion-card",58),g.BQk()),2&Ve){const R=g.oxw(3);g.xp6(1),g.Q6J("ngForOf",R.poi.UserComments)}}function fi(Ve,le){1&Ve&&(g.TgZ(0,"p",21),g._uU(1),g.ALo(2,"translate"),g.qZA()),2&Ve&&(g.xp6(1),g.hij(" ",g.lcZ(2,1,"ocm.details.commentsAndRatings.zeroComments")," "))}function Ai(Ve,le){if(1&Ve&&(g.TgZ(0,"div"),g.YNc(1,Qt,2,1,"ng-container",0),g.YNc(2,fi,3,3,"p",57),g.qZA()),2&Ve){const R=g.oxw(2);g.xp6(1),g.Q6J("ngIf",1==R.poi._hasComments),g.xp6(1),g.Q6J("ngIf",0==R.poi._hasComments)}}function er(Ve,le){if(1&Ve&&g._UZ(0,"img",60),2&Ve){const R=g.oxw().$implicit;g.s9C("src",null==R.User?null:R.User.ProfileImageURL,g.LSH)}}function mi(Ve,le){if(1&Ve&&(g.TgZ(0,"span"),g._uU(1),g.qZA()),2&Ve){const R=g.oxw().$implicit;g.xp6(1),g.Oqu(R.User.Username)}}function xr(Ve,le){if(1&Ve&&(g.TgZ(0,"span"),g._uU(1),g.qZA()),2&Ve){const R=g.oxw().$implicit;g.xp6(1),g.Oqu(R.Username)}}function Pi(Ve,le){if(1&Ve&&(g.TgZ(0,"ion-card"),g._UZ(1,"img",60),g.TgZ(2,"ion-item")(3,"ion-avatar",19),g.YNc(4,er,1,1,"img",59),g.qZA(),g.TgZ(5,"ion-label"),g.YNc(6,mi,2,1,"span",0),g.YNc(7,xr,2,1,"span",0),g.qZA(),g.TgZ(8,"ion-label",20),g._uU(9),g.ALo(10,"date"),g.qZA()(),g.TgZ(11,"ion-card-content")(12,"p"),g._uU(13),g.qZA()()()),2&Ve){const R=le.$implicit;g.xp6(1),g.s9C("src",R.ItemMediumURL,g.LSH),g.xp6(3),g.Q6J("ngIf",R.User&&R.User.ProfileImageURL),g.xp6(2),g.Q6J("ngIf",R.User),g.xp6(1),g.Q6J("ngIf",!R.User),g.xp6(2),g.hij(" ",g.lcZ(10,6,R.DateCreated)," "),g.xp6(4),g.Oqu(R.Comment)}}function br(Ve,le){if(1&Ve&&(g.TgZ(0,"div"),g.YNc(1,Pi,14,8,"ion-card",58),g.qZA()),2&Ve){const R=g.oxw(3);g.xp6(1),g.Q6J("ngForOf",R.poi.MediaItems)}}function wr(Ve,le){1&Ve&&(g.TgZ(0,"div",21)(1,"p",63),g._uU(2),g.ALo(3,"translate"),g.qZA()()),2&Ve&&(g.xp6(2),g.hij(" ",g.lcZ(3,1,"ocm.details.mediaItems.addPrompt"),""))}function Er(Ve,le){if(1&Ve&&(g.TgZ(0,"div"),g.YNc(1,br,2,1,"div",0),g.YNc(2,wr,4,3,"div",57),g.qZA()),2&Ve){const R=g.oxw(2);g.xp6(1),g.Q6J("ngIf",R.poi._hasPhotos),g.xp6(1),g.Q6J("ngIf",!R.poi._hasPhotos)}}function ui(Ve,le){if(1&Ve&&(g.TgZ(0,"p",64),g._uU(1),g.qZA()),2&Ve){const R=g.oxw(2);g.xp6(1),g.hij(" ",R.json,"")}}function pn(Ve,le){if(1&Ve){const R=g.EpF();g.TgZ(0,"div")(1,"div",1)(2,"div",2)(3,"h2"),g._uU(4),g.qZA(),g.TgZ(5,"div")(6,"small"),g._uU(7),g.qZA()(),g.YNc(8,_e,3,1,"div",0),g.YNc(9,pe,3,1,"div",0),g.TgZ(10,"ion-badge",3),g._uU(11),g.ALo(12,"number"),g.qZA()(),g.TgZ(13,"ion-fab",4)(14,"ion-fab-button"),g._UZ(15,"ion-icon",5),g.qZA(),g.TgZ(16,"ion-fab-list",6)(17,"ion-fab-button",7),g.NdJ("click",function(){g.CHM(R);const de=g.oxw();return g.KtG(de.addComment())}),g._UZ(18,"ion-icon",8),g.qZA(),g.TgZ(19,"ion-fab-button",9),g.NdJ("click",function(){g.CHM(R);const de=g.oxw();return g.KtG(de.addMedia())}),g._UZ(20,"ion-icon",10),g.qZA(),g.TgZ(21,"ion-fab-button",11),g.NdJ("click",function(){g.CHM(R);const de=g.oxw();return g.KtG(de.addFavourite())}),g._UZ(22,"ion-icon",12),g.qZA(),g.TgZ(23,"ion-fab-button",13),g.NdJ("click",function(){g.CHM(R);const de=g.oxw();return g.KtG(de.edit())}),g._UZ(24,"ion-icon",14),g.qZA(),g.TgZ(25,"ion-fab-button",15),g.NdJ("click",function(){g.CHM(R);const de=g.oxw();return g.KtG(de.refresh())}),g._UZ(26,"ion-icon",16),g.qZA()()()(),g.TgZ(27,"ion-refresher",17),g.NdJ("ionRefresh",function(de){g.CHM(R);const Le=g.oxw();return g.KtG(Le.refresh(de))}),g._UZ(28,"ion-refresher-content",18),g.qZA(),g.TgZ(29,"ion-toolbar")(30,"ion-buttons",19),g.YNc(31,ae,9,0,"ng-container",0),g.qZA(),g.TgZ(32,"ion-buttons",20),g.YNc(33,Ee,5,0,"ng-container",0),g.YNc(34,vt,5,0,"ng-container",0),g.YNc(35,Et,5,0,"ng-container",0),g.qZA()(),g.TgZ(36,"div",21)(37,"ion-segment",22),g.NdJ("ngModelChange",function(de){g.CHM(R);const Le=g.oxw();return g.KtG(Le.selectedTab=de)}),g.TgZ(38,"ion-segment-button",23)(39,"ion-label"),g._uU(40," Details "),g.qZA()(),g.TgZ(41,"ion-segment-button",24)(42,"ion-label"),g._uU(43),g.qZA()(),g.TgZ(44,"ion-segment-button",25)(45,"ion-label"),g._uU(46),g.qZA()()()(),g.YNc(47,Ni,27,15,"div",26),g.YNc(48,Ai,3,2,"div",0),g.YNc(49,Er,3,2,"div",0),g.YNc(50,ui,2,1,"p",27),g.qZA()}if(2&Ve){const R=g.oxw();g.xp6(1),g.Udp("background-image",R.backdropImage?"url("+R.backdropImage+")":""),g.xp6(3),g.hij(" ",R.poi.AddressInfo.Title," "),g.xp6(3),g.hij("OCM-",R.poi.ID,""),g.xp6(1),g.Q6J("ngIf",R.connectionSummary),g.xp6(1),g.Q6J("ngIf",R.poi.OperatorInfo),g.xp6(2),g.Oqu(g.xi3(12,18,R.avgRating,"1.1-1")),g.xp6(20),g.Q6J("ngIf","location"==R.selectedTab),g.xp6(2),g.Q6J("ngIf","location"==R.selectedTab),g.xp6(1),g.Q6J("ngIf","comments"==R.selectedTab),g.xp6(1),g.Q6J("ngIf","media"==R.selectedTab),g.xp6(2),g.Q6J("ngModel",R.selectedTab),g.xp6(6),g.hij("Comments (",R.poi.UserComments?R.poi.UserComments.length:0,")"),g.xp6(3),g.hij(" Photos (",R.poi.MediaItems?R.poi.MediaItems.length:0,")"),g.xp6(1),g.Q6J("ngIf","location"==R.selectedTab),g.xp6(1),g.Q6J("ngIf","comments"==R.selectedTab),g.xp6(1),g.Q6J("ngIf","media"==R.selectedTab),g.xp6(1),g.Q6J("ngIf",1==R.appManager.isDebugMode)}}function _t(Ve,le){1&Ve&&(g.TgZ(0,"div")(1,"h2"),g._uU(2,"POI Not Found"),g.qZA(),g.TgZ(3,"p"),g._uU(4,"The POI details could not be loaded."),g.qZA()())}let kt=(()=>{class Ve{constructor(R,j,de,Le,st,Bt,Rt,at){this.appManager=R,this.nav=j,this.translate=de,this.logging=Le,this.modalController=st,this.actionSheetController=Bt,this.poiManager=Rt,this.router=at,this.hasNavBar=!1}ngOnChanges(R){if(this.logging.log("In ngOnChanges of POI Details"),null!=this.poi&&null!=this.poi.AddressInfo){if(this.selectedTab="location",null!=this.poi.MediaItems&&this.poi.MediaItems.length>0){this.poi._hasPhotos=!0;for(let j of this.poi.MediaItems)j.ItemMediumURL=j.ItemThumbnailURL.replace(".thmb.",".medi.");this.backdropImage=this.poi.MediaItems[this.poi.MediaItems.length-1].ItemThumbnailURL.replace(".thmb.",".medi.")}else this.poi._hasPhotos=!1,this.backdropImage=null;if(null!=this.poi.UserComments&&this.poi.UserComments.length>0){this.poi._hasComments=!0;try{let j=this.poi.UserComments.filter(de=>de.Rating>0);if(j.length>0){let de=0;for(let Le of j)de+=Le.Rating;this.avgRating=de/j.length}else this.avgRating=null}catch{}}else this.poi._hasComments=!1;if(this.poi.Connections&&this.poi.Connections.length>0){let j="";for(let de of this.poi.Connections)-1==j.indexOf(de.ConnectionType.Title)&&(j+=(""!=j?", ":"")+de.ConnectionType.Title);this.connectionSummary=j}}}ngOnInit(){this.logging.log("In ngInit of POI Details")}get staticMapURL(){return"https://maps.googleapis.com/maps/api/staticmap?key="+(new dt.X).googleMapsAPIKey+"&center="+this.poi.AddressInfo.Latitude+","+this.poi.AddressInfo.Longitude+"&zoom=13&scale=2&size="+this.staticMapSize+"&maptype=roadmap&format=jpg&visual_refresh=true&markers=size:small%7Ccolor:0xff0000%7Clabel:%7C"+this.poi.AddressInfo.Latitude+","+this.poi.AddressInfo.Longitude}get staticMapSize(){return 0===this.appManager.clientWidth?"240x100":this.appManager.clientWidth>=800?"640x100":this.appManager.clientWidth>=400?"400x100":"240x100"}continueAddComment(){var R=this;return(0,c.Z)(function*(){const j=yield R.modalController.create({component:Ot,componentProps:{id:R.poi.ID,poi:R.poi}});setTimeout(()=>{R.refresh()},1e3),yield j.present()})()}addComment(){var R=this;return(0,c.Z)(function*(){if(R.appManager.isUserAuthenticated(!0))yield R.continueAddComment();else{const j=yield R.modalController.create({component:Fe.F});j.onDidDismiss().then((0,c.Z)(function*(){R.appManager.isUserAuthenticated(!0)&&(yield R.continueAddComment())})),yield j.present()}})()}continueAddMedia(){var R=this;return(0,c.Z)(function*(){const j=yield R.modalController.create({component:Ke,componentProps:{id:R.poi.ID,poi:R.poi}});j.onDidDismiss().then(()=>{setTimeout(()=>{R.refresh()},1e3)}),yield j.present()})()}addMedia(){var R=this;return(0,c.Z)(function*(){if(R.appManager.isUserAuthenticated(!0))yield R.continueAddMedia();else{const j=yield R.modalController.create({component:Fe.F});j.onDidDismiss().then((0,c.Z)(function*(){R.appManager.isUserAuthenticated(!0)&&(yield R.continueAddMedia())})),yield j.present()}})()}addFavourite(){var R=this;return(0,c.Z)(function*(){yield(yield R.actionSheetController.create({header:"Add Favourite",buttons:[{text:"Add to Journey",handler:()=>{R.modalController.create({component:me,componentProps:{poi:R.poi}}).then(de=>de.present())}},{text:"Cancel",role:"cancel",handler:()=>{}}]})).present()})()}launchNavigation(){this.appManager.isPlatform("ios")?this.appManager.launchWebPage("https://maps.apple.com/?ll="+this.poi.AddressInfo.Latitude+","+this.poi.AddressInfo.Longitude):this.appManager.launchWebPage("https://maps.google.com/?q="+this.poi.AddressInfo.Latitude+","+this.poi.AddressInfo.Longitude)}launchURL(R){this.appManager.launchWebPage(R)}continueEdit(){var R=this;return(0,c.Z)(function*(){const j=yield R.modalController.create({component:Ne.Y,componentProps:{id:R.poi.ID}});return j.onDidDismiss().then(de=>{R.refresh()}),yield j.present()})()}edit(){var R=this;return(0,c.Z)(function*(){if(we.c.isFeatureEnabled("EDIT_POI"))if(R.appManager.isUserAuthenticated(!0))yield R.continueEdit();else{const j=yield R.modalController.create({component:Fe.F});j.onDidDismiss().then((0,c.Z)(function*(){R.appManager.isUserAuthenticated(!0)&&(yield R.continueEdit())})),yield j.present()}else R.appManager.launchOCMWebPage("/poi/edit/"+R.poi.ID)})()}refresh(R=null){this.poi&&this.poiManager.getPOIById(this.poi.ID,!0,!0).then(j=>{j&&(this.poi=j,this.ngOnChanges(null)),R&&R.target.complete()})}}return Ve.\u0275fac=function(R){return new(R||Ve)(g.Y36(h.c),g.Y36(ie.SH),g.Y36(et.sK),g.Y36(Ze.z),g.Y36(ie.IN),g.Y36(ie.BX),g.Y36(ye.R),g.Y36(Ae.F0))},Ve.\u0275cmp=g.Xpm({type:Ve,selectors:[["poi-details"]],inputs:{poi:"poi"},features:[g.TTD],decls:2,vars:2,consts:[[4,"ngIf"],[1,"banner"],[1,"banner-content"],["color","primary","title","Average User Rating"],["vertical","top","horizontal","end","slot","fixed"],["name","add"],["side","bottom"],["title","Add a comment or charging check-in",3,"click"],["name","chatbubbles"],["title","Add a Photo",3,"click"],["name","camera"],["title","Add to Favourites",3,"click"],["name","star"],["title","Submit an Edit",3,"click"],["name","create"],["title","Refresh",3,"click"],["name","refresh"],["slot","fixed",3,"ionRefresh"],["pullingIcon","caret-down","pullingText","Pull to refresh","refreshingSpinner","circles","refreshingText","Refreshing..."],["slot","start"],["slot","end"],[1,"ion-padding"],[3,"ngModel","ngModelChange"],["value","location","selected",""],["value","comments"],["value","media"],["class","address-details",4,"ngIf"],["style","white-space: pre-wrap;",4,"ngIf"],["size","small","title","Add to Favourites",3,"click"],["name","star","slot","start"],["name","create","slot","start"],[3,"click"],["name","navigate","slot","start"],["size","small","title","Add a comment or charging check-in",3,"click"],["name","chatbubbles","slot","start"],["size","small","title","Add a Photo",3,"click"],["name","camera","slot","start"],[1,"address-details"],["name","battery-charging"],[3,"item"],["name","book"],["name","information-circle"],["class","details",4,"ngIf"],["name","map"],[1,"label"],[1,"details"],["name","pin"],[1,"details-minor"],["name","call"],["name","mail"],["name","globe"],["target","_system",3,"href"],["name","help-circle"],[1,"ion-padding-left"],["name","link"],["href","javascript:void(0)",3,"click",4,"ngIf"],["href","javascript:void(0)",3,"click"],["class","ion-padding",4,"ngIf"],[4,"ngFor","ngForOf"],[3,"src",4,"ngIf"],[3,"src"],["name","checkmark-circle","color","success",2,"font-size","2em"],["name","close-circle","color","danger"],[1,"subtle"],[2,"white-space","pre-wrap"]],template:function(R,j){1&R&&(g.YNc(0,pn,51,21,"div",0),g.YNc(1,_t,5,0,"div",0)),2&R&&(g.Q6J("ngIf",null!=j.poi&&null!=j.poi.AddressInfo),g.xp6(1),g.Q6J("ngIf",null==j.poi||null==j.poi.AddressInfo))},dependencies:[y.sg,y.O5,ie.BJ,ie.yp,ie.YG,ie.Sm,ie.PM,ie.FN,ie.Zi,ie.wI,ie.IJ,ie.W4,ie.zq,ie.jY,ie.gu,ie.Ie,ie.Q$,ie.nJ,ie.Wo,ie.Nd,ie.cJ,ie.GO,ie.sr,ie.QI,fe.JJ,fe.On,Je.B,y.JJ,y.uU,et.X$],styles:[".banner[_ngcontent-%COMP%]{background-color:#4f712f;color:#ffffffec;padding:1em;text-shadow:#000 1px 1px 1px;min-height:180px;background-size:cover}.banner[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0}.banner-content[_ngcontent-%COMP%]{padding-right:48px}h3[_ngcontent-%COMP%]{font-weight:700}.label[_ngcontent-%COMP%]{color:#000;font-weight:700;font-size:12px}.details[_ngcontent-%COMP%]{color:#707d61;margin-left:1em;font-size:12px}.details-minor[_ngcontent-%COMP%]{color:#707d61;font-size:12px}p[_ngcontent-%COMP%]{display:block;padding:4px}ion-card-header[_ngcontent-%COMP%]{font-weight:700;padding-bottom:0}ion-card-content[_ngcontent-%COMP%]{padding-top:4px}"]}),Ve})(),gn=(()=>{class Ve{constructor(R,j,de){this.modalController=R,this.navParams=j,this.appManager=de,this.hasNavbar=!1,this.poi=this.navParams.get("item"),this.appManager.analytics.viewEvent("POIDetails")}close(){this.modalController.dismiss()}}return Ve.\u0275fac=function(R){return new(R||Ve)(g.Y36(ie.IN),g.Y36(ie.X1),g.Y36(h.c))},Ve.\u0275cmp=g.Xpm({type:Ve,selectors:[["ng-component"]],decls:11,vars:3,consts:[["color","primary"],["slot","start"],[3,"click"],["name","close","slot","icon-only"],[1,"poi-details"],[3,"poi"]],template:function(R,j){1&R&&(g.TgZ(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-title"),g._uU(3),g.TgZ(4,"small"),g._uU(5),g.qZA()(),g.TgZ(6,"ion-buttons",1)(7,"ion-button",2),g.NdJ("click",function(){return j.close()}),g._UZ(8,"ion-icon",3),g.qZA()()()(),g.TgZ(9,"ion-content",4),g._UZ(10,"poi-details",5),g.qZA()),2&R&&(g.xp6(3),g.hij(" ",j.poi.AddressInfo.Title," "),g.xp6(2),g.hij("OCM-",j.poi.ID,""),g.xp6(5),g.Q6J("poi",j.poi))},dependencies:[ie.YG,ie.Sm,ie.W2,ie.Gu,ie.gu,ie.wd,ie.sr,kt],styles:['.left-col[_ngcontent-%COMP%]{float:left;width:50%;overflow:auto}.right-col[_ngcontent-%COMP%]{float:right;width:50%;overflow:auto}.row[_ngcontent-%COMP%]:after{content:"";display:table;clear:both;overflow:auto}.row[_ngcontent-%COMP%]{margin-bottom:1em}.subtle[_ngcontent-%COMP%]{color:silver}@media screen and (max-width: 768px){.left-col[_ngcontent-%COMP%]{float:none;width:100%}.right-col[_ngcontent-%COMP%]{margin-top:1em;float:none;width:100%}}.address-details[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-height:200px;width:auto}ion-label[_ngcontent-%COMP%]{overflow:inherit}ion-title[_ngcontent-%COMP%] > small[_ngcontent-%COMP%]{color:#ffffffbf}']}),Ve})()},1948:(Rn,Dt,B)=>{"use strict";B.r(Dt),B.d(Dt,{PoiEditorPageModule:()=>Ge});var h=B(6895),g=B(4006),ie=B(4228),c=B(201),Y=B(4508),se=B(4463),y=B(8936),fe=B(8274);const Ie=[{path:"",component:Y.Y}];let Ge=(()=>{class Q{}return Q.\u0275fac=function(me){return new(me||Q)},Q.\u0275mod=fe.oAB({type:Q}),Q.\u0275inj=fe.cJS({imports:[h.ez,g.u5,c.Pc,se.aw,y.e,ie.Bz.forChild(Ie)]}),Q})()},4508:(Rn,Dt,B)=>{"use strict";B.d(Dt,{Y:()=>Ht});var h=B(5861),g=B(3855),ie=B(8016),c=B(6579),Y=B(9698),se=B(4781),y=B(8274),fe=B(4120),Ie=B(5906),Ge=B(553),Q=B(7689),be=B(6260),me=B(529),Ze=B(6895),he=B(201);function Ke(Mt,qe){if(1&Mt){const re=y.EpF();y.ynx(0),y.TgZ(1,"ion-note")(2,"p"),y._uU(3," The closest address to this position is: "),y.qZA(),y.TgZ(4,"p")(5,"strong"),y._uU(6),y.qZA(),y._UZ(7,"br"),y._uU(8),y._UZ(9,"br"),y.TgZ(10,"ion-button",3),y.NdJ("click",function(){y.CHM(re);const Wt=y.oxw();return y.KtG(Wt.useAddressSelection())}),y._uU(11,"Use this address below "),y._UZ(12,"ion-icon",4),y.qZA()()(),y.BQk()}if(2&Mt){const re=y.oxw();y.xp6(6),y.Oqu(re.suggestedAddress.AddressLine1),y.xp6(2),y.HOy(" ",re.suggestedAddress.AddressLine2," ",re.suggestedAddress.Town," ",re.suggestedAddress.StateOrProvince," ",re.suggestedAddress.Postcode," ")}}let Ae=(()=>{class Mt{constructor(re,tt,Wt,Qt,fi){this.mapping=re,this.events=tt,this.logging=Wt,this.http=Qt,this.appManager=fi,this.latitudeChange=new y.vpe,this.longitudeChange=new y.vpe,this.suggestedAddress=null,this.suggestedAddressChange=new y.vpe,this.onUseSuggestedAddress=new y.vpe,this.suggestedAddressAttribution=null,this.suggestedAddressAttributionChange=new y.vpe,this.isMapInitialised=!1}ngOnInit(){this.mapService=new Ge.k(this.events,this.logging,this.http),this.mapService.initAPI(),this.mapOptions=new Ie._,this.mapOptions.mapType=this.appManager.searchSettings.MapType,this.mapOptions.onMapMoveCompleted=()=>{let re;re=this.mapService.getMapCenter(),re.subscribe(tt=>{tt&&(this.latitude=tt.coords.latitude,this.longitude=tt.coords.longitude,this.latitudeChange.emit(this.latitude),this.longitudeChange.emit(this.longitude),this.getAddressForCurrentLatLng())})}}ngAfterContentInit(){this.focusMap()}ngOnDestroy(){this.mapService.disposeMap()}focusMap(){0==this.isMapInitialised&&this.mapService&&0!=this.latitude&&0!=this.longitude&&(this.isMapInitialised=!0,this.mapService.initMap("editor-map",this.mapOptions,null),this.mapService.setMapCenter(new fe.jR(this.latitude,this.longitude)),this.originalMarkerPos=new fe.wC(this.latitude,this.longitude))}ngOnChanges(re){this.focusMap()}getAddressForCurrentLatLng(){var re=this;return(0,h.Z)(function*(){re.latitude&&re.longitude&&re.appManager.api.fetchReverseGeocodeResult(re.latitude,re.longitude).then(tt=>{tt.AddressInfo&&(re.suggestedAddress=tt.AddressInfo)})})()}useAddressSelection(){this.onUseSuggestedAddress.emit({suggestedAddress:this.suggestedAddress,attribution:this.suggestedAddressAttribution}),this.suggestedAddress=null,this.suggestedAddressAttribution=null}}return Mt.\u0275fac=function(re){return new(re||Mt)(y.Y36(se.v),y.Y36(be.z),y.Y36(Q.z),y.Y36(me.eN),y.Y36(g.c))},Mt.\u0275cmp=y.Xpm({type:Mt,selectors:[["app-poi-location-editor"]],inputs:{latitude:"latitude",longitude:"longitude"},outputs:{latitudeChange:"latitudeChange",longitudeChange:"longitudeChange",suggestedAddressChange:"suggestedAddressChange",onUseSuggestedAddress:"onUseSuggestedAddress",suggestedAddressAttributionChange:"suggestedAddressAttributionChange"},features:[y.TTD],decls:4,vars:1,consts:[[1,"instruction"],["id","editor-map"],[4,"ngIf"],["size","small",3,"click"],["slot","end","name","copy"]],template:function(re,tt){1&re&&(y.TgZ(0,"p",0),y._uU(1,"Drag the map to center the marker on the charging location:"),y.qZA(),y._UZ(2,"div",1),y.YNc(3,Ke,13,5,"ng-container",2)),2&re&&(y.xp6(3),y.Q6J("ngIf",tt.suggestedAddress))},dependencies:[Ze.O5,he.YG,he.gu,he.uN],styles:["#editor-map[_ngcontent-%COMP%]{border:1px solid gainsboro;background-color:gray;width:100%;height:128px}"]}),Mt})();var te=B(6799),Qe=B(4006);function Ot(Mt,qe){if(1&Mt&&(y.TgZ(0,"ion-select-option",14),y._uU(1),y.qZA()),2&Mt){const re=qe.$implicit;y.Q6J("value",re.ID),y.xp6(1),y.Oqu(re.Title)}}function dt(Mt,qe){if(1&Mt&&(y.TgZ(0,"ion-select-option",14),y._uU(1),y.qZA()),2&Mt){const re=qe.$implicit;y.Q6J("value",re.ID),y.xp6(1),y.Oqu(re.Title)}}function ye(Mt,qe){if(1&Mt&&(y.TgZ(0,"ion-select-option",14),y._uU(1),y.qZA()),2&Mt){const re=qe.$implicit;y.Q6J("value",re.ID),y.xp6(1),y.Oqu(re.Title)}}let Fe=(()=>{class Mt{constructor(re,tt){this.modalController=re,this.referenceDataManager=tt,this.useFilteredConnectionTypes=!0,this.useFilteredOperators=!0}get isAddMode(){return!(null!=this.conn&&this.conn.ID>0)}get connectionTypes(){return this.referenceDataManager.getConnectionTypes(this.useFilteredConnectionTypes)}get currentTypes(){return this.referenceDataManager.getOutputCurrentTypes()}get statusTypes(){return this.referenceDataManager.getStatusTypes().filter(re=>1==re.IsUserSelectable)}ngOnInit(){}save(){this.modalController.dismiss({item:this.conn})}cancel(){this.modalController.dismiss()}}return Mt.\u0275fac=function(re){return new(re||Mt)(y.Y36(he.IN),y.Y36(te.W))},Mt.\u0275cmp=y.Xpm({type:Mt,selectors:[["app-poi-equipment-editor"]],decls:60,vars:13,consts:[[1,"ion-padding"],["position","floating"],[3,"ngModel","ngModelChange"],["value","0"],[3,"value",4,"ngFor","ngForOf"],["type","number",3,"ngModel","ngModelChange"],["type","text","placeholder","(optional) other comments",3,"ngModel","ngModelChange"],["type","text",3,"ngModel","ngModelChange"],["slot","start"],[3,"click"],["name","close","slot","start"],["slot","end"],["color","success",3,"click"],["name","send","slot","end"],[3,"value"]],template:function(re,tt){1&re&&(y.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),y._uU(3),y.qZA()()(),y.TgZ(4,"ion-content",0)(5,"p"),y._uU(6,"Please provide as much information as you can about the equipment. If you don't know then leave the field blank. At a minimum you should include the Connection Type and approximate Power kW (max)."),y.qZA(),y.TgZ(7,"ion-item")(8,"ion-label",1),y._uU(9,"Connection Type"),y.qZA(),y.TgZ(10,"ion-select",2),y.NdJ("ngModelChange",function(Qt){return tt.conn.ConnectionTypeID=Qt}),y.TgZ(11,"ion-select-option",3),y._uU(12,"Unknown"),y.qZA(),y.YNc(13,Ot,2,2,"ion-select-option",4),y.qZA()(),y.TgZ(14,"ion-item")(15,"ion-label",1),y._uU(16,"Supply Type"),y.qZA(),y.TgZ(17,"ion-select",2),y.NdJ("ngModelChange",function(Qt){return tt.conn.CurrentTypeID=Qt}),y.TgZ(18,"ion-select-option",3),y._uU(19,"Unknown"),y.qZA(),y.YNc(20,dt,2,2,"ion-select-option",4),y.qZA()(),y.TgZ(21,"ion-item")(22,"ion-label",1),y._uU(23,"Power (kW)"),y.qZA(),y.TgZ(24,"ion-input",5),y.NdJ("ngModelChange",function(Qt){return tt.conn.PowerKW=Qt}),y.qZA()(),y.TgZ(25,"ion-item")(26,"ion-label",1),y._uU(27,"Amps"),y.qZA(),y.TgZ(28,"ion-input",5),y.NdJ("ngModelChange",function(Qt){return tt.conn.Amps=Qt}),y.qZA()(),y.TgZ(29,"ion-item")(30,"ion-label",1),y._uU(31,"Voltage"),y.qZA(),y.TgZ(32,"ion-input",5),y.NdJ("ngModelChange",function(Qt){return tt.conn.Voltage=Qt}),y.qZA()(),y.TgZ(33,"ion-item")(34,"ion-label",1),y._uU(35,"Status"),y.qZA(),y.TgZ(36,"ion-select",2),y.NdJ("ngModelChange",function(Qt){return tt.conn.StatusTypeID=Qt}),y.YNc(37,ye,2,2,"ion-select-option",4),y.qZA()(),y.TgZ(38,"ion-item")(39,"ion-label",1),y._uU(40,"Quantity Available"),y.qZA(),y.TgZ(41,"ion-input",5),y.NdJ("ngModelChange",function(Qt){return tt.conn.Quantity=Qt}),y.qZA()(),y.TgZ(42,"ion-item")(43,"ion-label",1),y._uU(44,"Comment"),y.qZA(),y.TgZ(45,"ion-input",6),y.NdJ("ngModelChange",function(Qt){return tt.conn.Comments=Qt}),y.qZA()(),y.TgZ(46,"ion-item")(47,"ion-label",1),y._uU(48,"Operators Reference"),y.qZA(),y.TgZ(49,"ion-input",7),y.NdJ("ngModelChange",function(Qt){return tt.conn.Reference=Qt}),y.qZA()()(),y.TgZ(50,"ion-footer")(51,"ion-toolbar")(52,"ion-buttons",8)(53,"ion-button",9),y.NdJ("click",function(){return tt.cancel()}),y._UZ(54,"ion-icon",10),y._uU(55," Cancel "),y.qZA()(),y.TgZ(56,"ion-buttons",11)(57,"ion-button",12),y.NdJ("click",function(){return tt.save()}),y._uU(58," OK "),y._UZ(59,"ion-icon",13),y.qZA()()()()),2&re&&(y.xp6(3),y.Oqu(tt.isAddMode?"Add Equipment":"Edit Equipment"),y.xp6(7),y.Q6J("ngModel",tt.conn.ConnectionTypeID),y.xp6(3),y.Q6J("ngForOf",tt.connectionTypes),y.xp6(4),y.Q6J("ngModel",tt.conn.CurrentTypeID),y.xp6(3),y.Q6J("ngForOf",tt.currentTypes),y.xp6(4),y.Q6J("ngModel",tt.conn.PowerKW),y.xp6(4),y.Q6J("ngModel",tt.conn.Amps),y.xp6(4),y.Q6J("ngModel",tt.conn.Voltage),y.xp6(4),y.Q6J("ngModel",tt.conn.StatusTypeID),y.xp6(1),y.Q6J("ngForOf",tt.statusTypes),y.xp6(4),y.Q6J("ngModel",tt.conn.Quantity),y.xp6(4),y.Q6J("ngModel",tt.conn.Comments),y.xp6(4),y.Q6J("ngModel",tt.conn.Reference))},dependencies:[Ze.sg,he.YG,he.Sm,he.W2,he.fr,he.Gu,he.gu,he.pK,he.Ie,he.Q$,he.t9,he.n0,he.wd,he.sr,he.as,he.QI,he.j9,Qe.JJ,Qe.On]}),Mt})();var Ne=(()=>{return(Mt=Ne||(Ne={}))[Mt.Unknown=0]="Unknown",Mt[Mt.CurrentlyAvailable=10]="CurrentlyAvailable",Mt[Mt.CurrentlyInUse=20]="CurrentlyInUse",Mt[Mt.TemporarilyUnavailable=30]="TemporarilyUnavailable",Mt[Mt.Operational=50]="Operational",Mt[Mt.PartlyOperational=75]="PartlyOperational",Mt[Mt.NotOperational=100]="NotOperational",Mt[Mt.PlannedForFutureDate=150]="PlannedForFutureDate",Mt[Mt.RemovedDecomissioned=200]="RemovedDecomissioned",Ne;var Mt})(),we=(()=>{return(Mt=we||(we={}))[Mt.UnknownOperator=1]="UnknownOperator",Mt[Mt.SiteOwner=45]="SiteOwner",we;var Mt})(),_e=B(6585),pe=B(1099);function ae(Mt,qe){if(1&Mt&&(y.TgZ(0,"ion-select-option",5),y._uU(1),y.qZA()),2&Mt){const re=qe.$implicit;y.Q6J("value",re.ID),y.xp6(1),y.Oqu(re.Title)}}function Ee(Mt,qe){1&Mt&&(y.TgZ(0,"ion-select-option",6),y._uU(1,"Other..."),y.qZA())}function vt(Mt,qe){if(1&Mt){const re=y.EpF();y.TgZ(0,"ion-item")(1,"ion-label",1),y._uU(2,"Network Operator"),y.qZA(),y.TgZ(3,"ion-select",2),y.NdJ("ngModelChange",function(Wt){y.CHM(re);const Qt=y.oxw();return y.KtG(Qt.operatorId=Wt)})("ionChange",function(){y.CHM(re);const Wt=y.oxw();return y.KtG(Wt.onOperatorChange())}),y.YNc(4,ae,2,2,"ion-select-option",3),y.YNc(5,Ee,2,0,"ion-select-option",4),y.qZA()()}if(2&Mt){const re=y.oxw();y.xp6(3),y.Q6J("ngModel",re.operatorId),y.xp6(1),y.Q6J("ngForOf",re.operators),y.xp6(1),y.Q6J("ngIf",re.useFilteredOperators)}}function Et(Mt,qe){if(1&Mt){const re=y.EpF();y.TgZ(0,"ion-item")(1,"ion-label"),y._uU(2,"Network Operator"),y.qZA(),y.TgZ(3,"ion-searchbar",7),y.NdJ("ionCancel",function(){y.CHM(re);const Wt=y.oxw();return y.KtG(Wt.cancelOperatorLookup())})("ngModelChange",function(Wt){y.CHM(re);const Qt=y.oxw();return y.KtG(Qt.operatorSearchKeyword=Wt)})("ionChange",function(Wt){y.CHM(re);const Qt=y.oxw();return y.KtG(Qt.searchOperators(Wt))}),y.qZA()()}if(2&Mt){const re=y.oxw();y.xp6(3),y.Q6J("ngModel",re.operatorSearchKeyword)}}function qt(Mt,qe){if(1&Mt){const re=y.EpF();y.TgZ(0,"ion-item",9),y.NdJ("click",function(){const Qt=y.CHM(re).$implicit,fi=y.oxw(2);return y.KtG(fi.onOperatorChange(Qt))}),y.TgZ(1,"ion-avatar",10),y._UZ(2,"ion-icon",11),y.qZA(),y.TgZ(3,"ion-label")(4,"p"),y._uU(5),y.qZA(),y.TgZ(6,"p"),y._uU(7),y.qZA()()()}if(2&Mt){const re=qe.$implicit;y.xp6(5),y.Oqu(re.Title),y.xp6(2),y.Oqu(re.WebsiteURL)}}function Ft(Mt,qe){if(1&Mt&&(y.ynx(0),y.TgZ(1,"ion-list"),y.YNc(2,qt,8,2,"ion-item",8),y.qZA(),y.BQk()),2&Mt){const re=y.oxw();y.xp6(2),y.Q6J("ngForOf",re.operatorSearchResults)}}function xt(Mt,qe){if(1&Mt){const re=y.EpF();y.ynx(0),y.TgZ(1,"ion-item")(2,"ion-avatar",10),y._UZ(3,"ion-icon",12),y.qZA(),y.TgZ(4,"ion-label")(5,"p"),y._uU(6),y.qZA(),y.TgZ(7,"p"),y._uU(8),y.qZA(),y.TgZ(9,"ion-button",9),y.NdJ("click",function(){y.CHM(re);const Wt=y.oxw();return y.KtG(Wt.selectedOperator=null)}),y._uU(10,"Change"),y.qZA()()(),y.BQk()}if(2&Mt){const re=y.oxw();y.xp6(6),y.Oqu(re.selectedOperator.Title),y.xp6(2),y.Oqu(re.selectedOperator.WebsiteURL)}}let Pt=(()=>{class Mt{constructor(re){this.referenceDataManager=re,this.operatorId=null,this.useFilteredOperators=null,this.operatorChanged=new y.vpe,this.operatorCache=[],this.operatorSearchResults=[],this.operatorSearchKeyword="",this.selectedOperator=null}get operators(){return this.referenceDataManager.getNetworkOperators(this.useFilteredOperators)}ngOnInit(){this.operatorCache=this.referenceDataManager.getNetworkOperators(!1),null!=this.operatorId&&(this.selectedOperator=this.operatorCache.find(re=>re.ID==this.operatorId))}searchOperators(){this.operatorSearchResults=[],0!=this.operatorSearchKeyword.length&&(this.operatorSearchResults=this.operatorCache?this.operatorCache.filter(re=>re.Title.toLowerCase().startsWith(this.operatorSearchKeyword.toLowerCase())||re.Title.toLowerCase().startsWith("("+this.operatorSearchKeyword.toLowerCase())).slice(0,10):[])}onOperatorChange(re=null){var tt=this;return(0,h.Z)(function*(){null==re&&tt.operatorId&&(re=tt.operatorCache.find(Wt=>Wt.ID==tt.operatorId)),null!=re&&(tt.operatorSearchResults=[],tt.selectedOperator=re,tt.operatorId=re.ID),tt.operatorId?tt.operatorChanged.emit(tt.selectedOperator):tt.useFilteredOperators=!1})()}cancelOperatorLookup(){this.selectedOperator=null}}return Mt.\u0275fac=function(re){return new(re||Mt)(y.Y36(te.W))},Mt.\u0275cmp=y.Xpm({type:Mt,selectors:[["app-operator-lookup"]],inputs:{operatorId:"operatorId",useFilteredOperators:"useFilteredOperators"},outputs:{operatorChanged:"operatorChanged"},decls:4,vars:4,consts:[[4,"ngIf"],["position","floating"],[3,"ngModel","ngModelChange","ionChange"],[3,"value",4,"ngFor","ngForOf"],["value","",4,"ngIf"],[3,"value"],["value",""],["placeholder","Search by network name (in any country)","showCancelButton","focus","autocomplete","on",3,"ngModel","ionCancel","ngModelChange","ionChange"],[3,"click",4,"ngFor","ngForOf"],[3,"click"],["item-left",""],["name","card"],["name","locate"]],template:function(re,tt){1&re&&(y.YNc(0,vt,6,3,"ion-item",0),y.YNc(1,Et,4,1,"ion-item",0),y.YNc(2,Ft,3,1,"ng-container",0),y.YNc(3,xt,11,2,"ng-container",0)),2&re&&(y.Q6J("ngIf",tt.useFilteredOperators&&!tt.selectedOperator),y.xp6(1),y.Q6J("ngIf",!tt.useFilteredOperators&&!tt.selectedOperator),y.xp6(1),y.Q6J("ngIf",tt.operatorSearchResults.length>0),y.xp6(1),y.Q6J("ngIf",null!=tt.selectedOperator))},dependencies:[Ze.sg,Ze.O5,he.BJ,he.YG,he.gu,he.Ie,he.Q$,he.q_,he.VI,he.t9,he.n0,he.QI,he.j9,Qe.JJ,Qe.On]}),Mt})();function bt(Mt,qe){1&Mt&&y._UZ(0,"ion-icon",13)}function ct(Mt,qe){1&Mt&&y._UZ(0,"ion-icon",13)}function ht(Mt,qe){1&Mt&&y._UZ(0,"ion-icon",13)}function Ce(Mt,qe){if(1&Mt&&(y.TgZ(0,"ion-select-option",27),y._uU(1),y.qZA()),2&Mt){const re=qe.$implicit;y.Q6J("value",re.ID),y.xp6(1),y.Oqu(re.Title)}}function Ct(Mt,qe){if(1&Mt){const re=y.EpF();y.ynx(0),y.TgZ(1,"app-poi-location-editor",14,15),y.NdJ("latitudeChange",function(Wt){y.CHM(re);const Qt=y.oxw(2);return y.KtG(Qt.item.AddressInfo.Latitude=Wt)})("longitudeChange",function(Wt){y.CHM(re);const Qt=y.oxw(2);return y.KtG(Qt.item.AddressInfo.Longitude=Wt)})("onUseSuggestedAddress",function(Wt){y.CHM(re);const Qt=y.oxw(2);return y.KtG(Qt.useSuggestedAddress(Wt))}),y.qZA(),y.TgZ(3,"ion-list")(4,"ion-item")(5,"ion-label",16),y._uU(6,"Location Name"),y.qZA(),y.TgZ(7,"ion-input",17),y.NdJ("ngModelChange",function(Wt){y.CHM(re);const Qt=y.oxw(2);return y.KtG(Qt.item.AddressInfo.Title=Wt)}),y.qZA()(),y.TgZ(8,"ion-item")(9,"ion-label",16),y._uU(10,"Address Line 1"),y.qZA(),y.TgZ(11,"ion-input",18),y.NdJ("ngModelChange",function(Wt){y.CHM(re);const Qt=y.oxw(2);return y.KtG(Qt.item.AddressInfo.AddressLine1=Wt)}),y.qZA()(),y.TgZ(12,"ion-item")(13,"ion-label",16),y._uU(14,"Address Line 2"),y.qZA(),y.TgZ(15,"ion-input",19),y.NdJ("ngModelChange",function(Wt){y.CHM(re);const Qt=y.oxw(2);return y.KtG(Qt.item.AddressInfo.AddressLine2=Wt)}),y.qZA()(),y.TgZ(16,"ion-item")(17,"ion-label",16),y._uU(18,"Town"),y.qZA(),y.TgZ(19,"ion-input",20),y.NdJ("ngModelChange",function(Wt){y.CHM(re);const Qt=y.oxw(2);return y.KtG(Qt.item.AddressInfo.Town=Wt)}),y.qZA()(),y.TgZ(20,"ion-item")(21,"ion-label",16),y._uU(22,"State or Province"),y.qZA(),y.TgZ(23,"ion-input",21),y.NdJ("ngModelChange",function(Wt){y.CHM(re);const Qt=y.oxw(2);return y.KtG(Qt.item.AddressInfo.StateOrProvince=Wt)}),y.qZA()(),y.TgZ(24,"ion-item")(25,"ion-label",16),y._uU(26,"Postal Code"),y.qZA(),y.TgZ(27,"ion-input",22),y.NdJ("ngModelChange",function(Wt){y.CHM(re);const Qt=y.oxw(2);return y.KtG(Qt.item.AddressInfo.Postcode=Wt)}),y.qZA()(),y.TgZ(28,"ion-item")(29,"ion-label",16),y._uU(30,"Country"),y.qZA(),y.TgZ(31,"ion-select",23),y.NdJ("ngModelChange",function(Wt){y.CHM(re);const Qt=y.oxw(2);return y.KtG(Qt.item.AddressInfo.CountryID=Wt)})("ionChange",function(){y.CHM(re);const Wt=y.oxw(2);return y.KtG(Wt.onCountryChange())}),y.YNc(32,Ce,2,2,"ion-select-option",24),y.qZA()(),y.TgZ(33,"ion-item")(34,"ion-label",16),y._uU(35,"Latitude"),y.qZA(),y.TgZ(36,"ion-input",25),y.NdJ("ngModelChange",function(Wt){y.CHM(re);const Qt=y.oxw(2);return y.KtG(Qt.item.AddressInfo.Latitude=Wt)}),y.qZA()(),y.TgZ(37,"ion-item")(38,"ion-label",16),y._uU(39,"Longitude"),y.qZA(),y.TgZ(40,"ion-input",26),y.NdJ("ngModelChange",function(Wt){y.CHM(re);const Qt=y.oxw(2);return y.KtG(Qt.item.AddressInfo.Longitude=Wt)}),y.qZA()()(),y.BQk()}if(2&Mt){const re=y.oxw(2);y.xp6(1),y.Q6J("latitude",re.item.AddressInfo.Latitude)("longitude",re.item.AddressInfo.Longitude),y.xp6(6),y.Q6J("ngModel",re.item.AddressInfo.Title),y.xp6(4),y.Q6J("ngModel",re.item.AddressInfo.AddressLine1),y.xp6(4),y.Q6J("ngModel",re.item.AddressInfo.AddressLine2),y.xp6(4),y.Q6J("ngModel",re.item.AddressInfo.Town),y.xp6(4),y.Q6J("ngModel",re.item.AddressInfo.StateOrProvince),y.xp6(4),y.Q6J("ngModel",re.item.AddressInfo.Postcode),y.xp6(4),y.Q6J("ngModel",re.item.AddressInfo.CountryID),y.xp6(1),y.Q6J("ngForOf",re.countries),y.xp6(4),y.Q6J("ngModel",re.item.AddressInfo.Latitude),y.xp6(4),y.Q6J("ngModel",re.item.AddressInfo.Longitude)}}function Ut(Mt,qe){if(1&Mt){const re=y.EpF();y.ynx(0),y.TgZ(1,"h3"),y._uU(2,"Locations Nearby"),y.qZA(),y.TgZ(3,"p")(4,"strong"),y._uU(5,"The following locations already exist nearby."),y.qZA()(),y.TgZ(6,"div",28)(7,"p"),y._uU(8,"Ensure you are not adding a duplicate site unless it is for different equipment from another network operator."),y.qZA(),y.TgZ(9,"p"),y._uU(10,"You can edit any of these listings if required instead:"),y.qZA()(),y.TgZ(11,"app-poi-list",29),y.NdJ("onEdit",function(Wt){y.CHM(re);const Qt=y.oxw(2);return y.KtG(Qt.editPOI(Wt))}),y.qZA(),y.BQk()}if(2&Mt){const re=y.oxw(2);y.xp6(11),y.Q6J("poiList",re.nearbySites)("enableEditOption",!0)}}function Gt(Mt,qe){if(1&Mt&&(y.ynx(0),y.YNc(1,Ct,41,12,"ng-container",9),y.YNc(2,Ut,12,2,"ng-container",9),y.BQk()),2&Mt){const re=y.oxw();y.xp6(1),y.Q6J("ngIf","location"==re.step),y.xp6(1),y.Q6J("ngIf","poi-nearby"==re.step)}}function wn(Mt,qe){if(1&Mt){const re=y.EpF();y.ynx(0),y.TgZ(1,"p"),y._uU(2,"Copied the equipment configuration from:"),y.qZA(),y.TgZ(3,"ion-item")(4,"ion-label"),y._uU(5),y._UZ(6,"br"),y._uU(7),y._UZ(8,"br"),y._uU(9),y._UZ(10,"br"),y._uU(11),y._UZ(12,"br"),y._uU(13),y.qZA(),y.TgZ(14,"ion-button",31),y.NdJ("click",function(){y.CHM(re);const Wt=y.oxw(5);return y.KtG(Wt.changeTemplatePOI())}),y._uU(15,"Change.."),y.qZA()(),y.BQk()}if(2&Mt){const re=y.oxw(5);y.xp6(5),y.hij(" ",re.selectedTemplatePOI.AddressInfo.Title," "),y.xp6(2),y.hij(" ",re.selectedTemplatePOI.AddressInfo.AddressLine1," "),y.xp6(2),y.hij(" ",null==re.selectedTemplatePOI.Connections[0].ConnectionType?null:re.selectedTemplatePOI.Connections[0].ConnectionType.Title," "),y.xp6(2),y.hij(" ",re.selectedTemplatePOI.Connections[0].PowerKW," "),y.xp6(2),y.hij(" ",re.selectedTemplatePOI.DateCreated," ")}}function Fn(Mt,qe){if(1&Mt){const re=y.EpF();y.ynx(0),y.TgZ(1,"h4"),y._uU(2,"Similar Sites"),y.qZA(),y.TgZ(3,"app-poi-list",32),y.NdJ("onCopy",function(Wt){y.CHM(re);const Qt=y.oxw(6);return y.KtG(Qt.useTemplatePOI(Wt))}),y.qZA(),y.BQk()}if(2&Mt){const re=y.oxw(6);y.xp6(3),y.Q6J("enableCopyOption",!0)("poiList",re.templateSites)}}function un(Mt,qe){1&Mt&&(y.ynx(0),y.TgZ(1,"p"),y._uU(2," There are no suggested sites to copy for this network operator. "),y.qZA(),y.BQk())}function ut(Mt,qe){if(1&Mt&&(y.ynx(0),y.YNc(1,Fn,4,2,"ng-container",9),y.YNc(2,un,3,0,"ng-container",9),y.BQk()),2&Mt){const re=y.oxw(5);y.xp6(1),y.Q6J("ngIf",re.templateSites.length>0),y.xp6(1),y.Q6J("ngIf",0==re.templateSites.length)}}function jt(Mt,qe){if(1&Mt&&(y.ynx(0),y.YNc(1,wn,16,5,"ng-container",9),y.YNc(2,ut,3,2,"ng-container",9),y.BQk()),2&Mt){const re=y.oxw(4);y.xp6(1),y.Q6J("ngIf",re.selectedTemplatePOI),y.xp6(1),y.Q6J("ngIf",!re.selectedTemplatePOI)}}function En(Mt,qe){if(1&Mt){const re=y.EpF();y.ynx(0),y.TgZ(1,"p",28),y._uU(2,"You can copy the equipment settings from other sites operated by the same network operator or choose 'Next' to skip this step: "),y.qZA(),y.TgZ(3,"app-operator-lookup",30),y.NdJ("operatorChanged",function(Wt){y.CHM(re);const Qt=y.oxw(3);return y.KtG(Qt.onOperatorChange(Wt))}),y.qZA(),y.YNc(4,jt,3,2,"ng-container",9),y.BQk()}if(2&Mt){const re=y.oxw(3);y.xp6(3),y.Q6J("operatorId",re.item.OperatorID),y.xp6(1),y.Q6J("ngIf",re.item.AddressInfo.CountryID&&re.item.OperatorID)}}function ni(Mt,qe){if(1&Mt&&(y.ynx(0),y.YNc(1,En,5,2,"ng-container",9),y.BQk()),2&Mt){const re=y.oxw(2);y.xp6(1),y.Q6J("ngIf",!re.skipPOICopy)}}function ci(Mt,qe){if(1&Mt){const re=y.EpF();y.ynx(0),y.TgZ(1,"app-operator-lookup",33),y.NdJ("operatorChanged",function(Wt){y.CHM(re);const Qt=y.oxw(2);return y.KtG(Qt.onOperatorChange(Wt))}),y.qZA(),y.TgZ(2,"ion-item")(3,"ion-label",16),y._uU(4,"Number of Stations or Parking Bays"),y.qZA(),y.TgZ(5,"ion-input",21),y.NdJ("ngModelChange",function(Wt){y.CHM(re);const Qt=y.oxw(2);return y.KtG(Qt.item.NumberOfPoints=Wt)}),y.qZA()(),y.TgZ(6,"h4"),y._uU(7,"Equipment"),y.qZA(),y.TgZ(8,"ion-button",34),y.NdJ("click",function(){y.CHM(re);const Wt=y.oxw(2);return y.KtG(Wt.addConnection())}),y._UZ(9,"ion-icon",35),y.qZA(),y.TgZ(10,"app-equipment-details",36),y.NdJ("onEdit",function(Wt){y.CHM(re);const Qt=y.oxw(2);return y.KtG(Qt.editConnection(Wt))})("onDelete",function(Wt){y.CHM(re);const Qt=y.oxw(2);return y.KtG(Qt.deleteConnection(Wt))}),y.qZA(),y.BQk()}if(2&Mt){const re=y.oxw(2);y.xp6(1),y.Q6J("operatorId",re.item.OperatorID)("useFilteredOperators",!1),y.xp6(4),y.Q6J("ngModel",re.item.NumberOfPoints),y.xp6(5),y.Q6J("item",re.item)("enableEdit",!0)}}function Un(Mt,qe){if(1&Mt&&(y.ynx(0),y.YNc(1,ni,2,1,"ng-container",9),y.YNc(2,ci,11,5,"ng-container",9),y.BQk()),2&Mt){const re=y.oxw();y.xp6(1),y.Q6J("ngIf","copy-equipment"==re.step),y.xp6(1),y.Q6J("ngIf","edit-equipment"==re.step)}}function _i(Mt,qe){if(1&Mt&&(y.TgZ(0,"p",43)(1,"strong"),y._uU(2,"Your changes cannot be saved until the following issues are resolved:"),y.qZA(),y.TgZ(3,"ion-label",44),y._uU(4),y.qZA()()),2&Mt){const re=y.oxw(2);y.xp6(4),y.hij(" ",re.validationMsg,"")}}function wi(Mt,qe){if(1&Mt&&(y.TgZ(0,"ion-select-option",27),y._uU(1),y.qZA()),2&Mt){const re=qe.$implicit;y.Q6J("value",re.ID),y.xp6(1),y.Oqu(re.Title)}}function xi(Mt,qe){if(1&Mt&&(y.TgZ(0,"ion-select-option",27),y._uU(1),y.qZA()),2&Mt){const re=qe.$implicit;y.Q6J("value",re.ID),y.xp6(1),y.Oqu(re.Title)}}function Ni(Mt,qe){if(1&Mt){const re=y.EpF();y.ynx(0),y.YNc(1,_i,5,1,"p",37),y.TgZ(2,"p"),y._uU(3,"Please provide any other facts related to this site. Additional comments (your charging experiences etc) can be added as check-in comments once the site is listed."),y.qZA(),y.TgZ(4,"ion-item")(5,"ion-label",16),y._uU(6,"Operational Status (All Equipment))"),y.qZA(),y.TgZ(7,"ion-select",38),y.NdJ("ngModelChange",function(Wt){y.CHM(re);const Qt=y.oxw();return y.KtG(Qt.item.StatusTypeID=Wt)}),y.YNc(8,wi,2,2,"ion-select-option",24),y.qZA()(),y.TgZ(9,"ion-item")(10,"ion-label",16),y._uU(11,"Usage Type"),y.qZA(),y.TgZ(12,"ion-select",38),y.NdJ("ngModelChange",function(Wt){y.CHM(re);const Qt=y.oxw();return y.KtG(Qt.item.UsageTypeID=Wt)}),y.YNc(13,xi,2,2,"ion-select-option",24),y.qZA()(),y.TgZ(14,"ion-item")(15,"ion-label",16),y._uU(16,"Usage Cost"),y.qZA(),y.TgZ(17,"ion-input",21),y.NdJ("ngModelChange",function(Wt){y.CHM(re);const Qt=y.oxw();return y.KtG(Qt.item.UsageCost=Wt)}),y.qZA()(),y.TgZ(18,"ion-item")(19,"ion-label",16),y._uU(20,"General Comments"),y.qZA(),y.TgZ(21,"ion-input",39),y.NdJ("ngModelChange",function(Wt){y.CHM(re);const Qt=y.oxw();return y.KtG(Qt.item.GeneralComments=Wt)}),y.qZA()(),y.TgZ(22,"ion-item")(23,"ion-label",16),y._uU(24,"Main Telephone Number "),y.qZA(),y.TgZ(25,"ion-input",40),y.NdJ("ngModelChange",function(Wt){y.CHM(re);const Qt=y.oxw();return y.KtG(Qt.item.AddressInfo.ContactTelephone1=Wt)}),y.qZA()(),y.TgZ(26,"ion-item")(27,"ion-label",16),y._uU(28,"Other Telephone Number "),y.qZA(),y.TgZ(29,"ion-input",40),y.NdJ("ngModelChange",function(Wt){y.CHM(re);const Qt=y.oxw();return y.KtG(Qt.item.AddressInfo.ContactTelephone2=Wt)}),y.qZA()(),y.TgZ(30,"ion-item")(31,"ion-label",16),y._uU(32,"Access Comments"),y.qZA(),y.TgZ(33,"ion-input",41),y.NdJ("ngModelChange",function(Wt){y.CHM(re);const Qt=y.oxw();return y.KtG(Qt.item.AddressInfo.AccessComments=Wt)}),y.qZA()(),y.TgZ(34,"ion-item")(35,"ion-label",16),y._uU(36,"Related Website"),y.qZA(),y.TgZ(37,"ion-input",42),y.NdJ("ngModelChange",function(Wt){y.CHM(re);const Qt=y.oxw();return y.KtG(Qt.item.AddressInfo.RelatedURL=Wt)}),y.qZA()(),y.BQk()}if(2&Mt){const re=y.oxw();y.xp6(1),y.Q6J("ngIf",re.validationMsg),y.xp6(6),y.Q6J("ngModel",re.item.StatusTypeID),y.xp6(1),y.Q6J("ngForOf",re.statusTypes),y.xp6(4),y.Q6J("ngModel",re.item.UsageTypeID),y.xp6(1),y.Q6J("ngForOf",re.usageTypes),y.xp6(4),y.Q6J("ngModel",re.item.UsageCost),y.xp6(4),y.Q6J("ngModel",re.item.GeneralComments),y.xp6(4),y.Q6J("ngModel",re.item.AddressInfo.ContactTelephone1),y.xp6(4),y.Q6J("ngModel",re.item.AddressInfo.ContactTelephone2),y.xp6(4),y.Q6J("ngModel",re.item.AddressInfo.AccessComments),y.xp6(4),y.Q6J("ngModel",re.item.AddressInfo.RelatedURL)}}function Ii(Mt,qe){if(1&Mt){const re=y.EpF();y.TgZ(0,"ion-button",1),y.NdJ("click",function(){y.CHM(re);const Wt=y.oxw();return y.KtG(Wt.previous())}),y._uU(1," Previous "),y._UZ(2,"ion-icon",45),y.qZA()}}function Ui(Mt,qe){if(1&Mt){const re=y.EpF();y.TgZ(0,"ion-button",1),y.NdJ("click",function(){y.CHM(re);const Wt=y.oxw();return y.KtG(Wt.next())}),y._uU(1," Next "),y._UZ(2,"ion-icon",46),y.qZA()}}function Yi(Mt,qe){if(1&Mt){const re=y.EpF();y.TgZ(0,"ion-button",47),y.NdJ("click",function(){y.CHM(re);const Wt=y.oxw();return y.KtG(Wt.save())}),y._uU(1," Submit "),y._UZ(2,"ion-icon",48),y.qZA()}}let Ht=(()=>{class Mt{constructor(re,tt,Wt,Qt,fi,Ai){this.appManager=re,this.modalController=tt,this.poiManager=Wt,this.mapping=Qt,this.loadingController=fi,this.alertController=Ai,this.useFilteredConnectionTypes=!0,this.templateSites=[],this.nearbySites=[],this.selectedTemplatePOI=null,this.suggestedAddress=null,this.suggestedAddressAttribution=null,this.isNonDuplicateConfirmed=!1,this.skipPOICopy=!1,this.validationMsg=null,this.initNewItem()}get countries(){return this.appManager.referenceDataManager.getCountries()}get usageTypes(){return this.appManager.referenceDataManager.getUsageTypes()}get statusTypes(){return this.appManager.referenceDataManager.getStatusTypes().filter(re=>1==re.IsUserSelectable)}get isAddMode(){return this.item.ID<=0}initNewItem(){this.item={ID:-1,DataProviderID:1,DataProvidersReference:null,OperatorsReference:null,OperatorID:1,UsageCost:null,UsageTypeID:4,NumberOfPoints:1,GeneralComments:null,DatePlanned:null,StatusTypeID:50,SubmissionStatusTypeID:null,Connections:[],MetadataValues:[],AddressInfo:{ID:-1,CountryID:18,Title:"",AddressLine1:"",Latitude:0,Longitude:0}},this.step="location",this.selectedTab="location"}get isReadyToSubmit(){return this.validate().isValid&&"info"==this.step}ngOnInit(){}presentLoadingUI(){var re=this;return(0,h.Z)(function*(){re.loading=yield re.loadingController.create({message:"Please Wait.."}),yield re.loading.present()})()}dismissLoadingUI(){var re=this;return(0,h.Z)(function*(){re.loading&&(yield re.loading.dismiss())})()}ionViewDidEnter(){if(null!=this.id)this.editExistingPOI(this.id);else{let re=localStorage.getItem("_editor-operatorid");re&&(this.item.OperatorID=parseInt(re,10)),this.startPos?(this.item.AddressInfo.Latitude=this.startPos.latitude,this.item.AddressInfo.Longitude=this.startPos.longitude):this.mapping&&this.mapping.getMapCenter().subscribe(tt=>{tt&&(this.item.AddressInfo.Latitude=tt.coords.latitude,this.item.AddressInfo.Longitude=tt.coords.longitude)})}this.refreshFilteredReferenceData()}previous(){var re=this;return(0,h.Z)(function*(){switch(re.step){case"info":re.step="edit-equipment";break;case"edit-equipment":re.step=re.isAddMode?"copy-equipment":"location";break;case"copy-equipment":case"poi-nearby":re.step="location"}yield re.initCurrentStep(!1)})()}next(){var re=this;return(0,h.Z)(function*(){if("poi-nearby"==re.step&&re.nearbySites.length>0&&!re.isNonDuplicateConfirmed)return void(yield re.alertController.create({header:"Confirm",message:"Please confirm you are not adding a duplicate site.",buttons:[{text:"Cancel",role:"cancel",cssClass:"secondary",handler:Qt=>{}},{text:"Confirm",handler:()=>{re.isNonDuplicateConfirmed=!0,re.next()}}]})).present();const tt=re.validate(re.step);if(tt.isValid){switch(re.step){case"location":re.step=re.isAddMode?"poi-nearby":"edit-equipment";break;case"poi-nearby":re.step=re.isAddMode?"copy-equipment":"edit-equipment";break;case"copy-equipment":re.step="edit-equipment";break;case"edit-equipment":re.step="info"}yield re.initCurrentStep(!0)}else(yield re.alertController.create({message:tt.msg})).present()})()}initCurrentStep(re){var tt=this;return(0,h.Z)(function*(){"poi-nearby"==tt.step?(tt.selectedTab="location",0==(yield tt.refreshNearbySites())&&(re?yield tt.next():yield tt.previous())):"location"==tt.step?tt.selectedTab="location":"copy-equipment"==tt.step?(tt.selectedTab="equipment",yield tt.refreshTemplateSites()):"edit-equipment"==tt.step?tt.selectedTab="equipment":"info"==tt.step&&(tt.selectedTab="info")})()}onCountryChange(){var re=this;return(0,h.Z)(function*(){re.refreshFilteredReferenceData()})()}onOperatorChange(re=null){var tt=this;return(0,h.Z)(function*(){null!=re&&tt.item.OperatorID!=re.ID&&(tt.item.OperatorID=re.ID,localStorage.setItem("_editor-operatorid",tt.item.OperatorID.toString()),yield tt.refreshTemplateSites())})()}useSuggestedAddress(re=null){re&&(this.suggestedAddress=re.suggestedAddress,this.suggestedAddressAttribution=re.suggestedAddressAttribution),Object.assign(this.item.AddressInfo,this.suggestedAddress),this.suggestedAddressAttribution&&(this.item.MetadataValues.find(tt=>4==tt.MetadataFieldID)||this.item.MetadataValues.push({ID:-1,MetadataFieldID:4,ItemValue:this.suggestedAddressAttribution,MetadataFieldOptionID:null,MetadataFieldOption:null}))}editConnection(re){var tt=this;return(0,h.Z)(function*(){const Wt=tt.item.Connections.find(Ai=>Ai.ID==re.ID),Qt=Object.assign({},Wt),fi=yield tt.modalController.create({component:Fe,componentProps:{conn:Qt}});return fi.onWillDismiss().then(Ai=>{Ai&&Ai.data&&Ai.data.item&&tt.updateConnection(Ai.data.item)}),yield fi.present()})()}deleteConnection(re){var tt=this;return(0,h.Z)(function*(){const Wt=tt.item.Connections.find(fi=>fi.ID==re.ID);(yield tt.alertController.create({header:"Confirm Delete",message:"Are you sure you want to delete this connection information?",buttons:[{text:"No",role:"cancel",cssClass:"secondary",handler:()=>{}},{text:"Yes",handler:()=>{tt.item.Connections=tt.item.Connections.filter(fi=>fi.ID!=Wt.ID),tt.appManager.referenceDataManager.hydrateCompactPOI(tt.item,!0)}}]})).present()})()}addConnection(){var re=this;return(0,h.Z)(function*(){const tt={ID:-c.c.getRandomInt(1e4),ConnectionTypeID:null,StatusTypeID:50,PowerKW:null,Quantity:1},Wt=yield re.modalController.create({component:Fe,componentProps:{conn:tt}});return Wt.onWillDismiss().then(Qt=>{Qt&&Qt.data&&Qt.data.item&&re.updateConnection(Qt.data.item)}),yield Wt.present()})()}refreshFilteredReferenceData(){this.appManager.referenceDataManager.refreshFilteredReferenceData(this.appManager.api,{CountryIds:[this.item.AddressInfo.CountryID]})}updateConnection(re){if(re){let tt=this.item.Connections.find(Wt=>Wt.ID==re.ID);tt?Object.assign(tt,re):this.item.Connections.push(re)}this.appManager.referenceDataManager.hydrateCompactPOI(this.item,!0)}validate(re="all"){let tt=null;return("all"==re||"location"==re)&&((!this.item.AddressInfo.Latitude||!this.item.AddressInfo.Longitude)&&(tt="Location is required"),""==this.item.AddressInfo.Title&&(tt="A location title is required"),!this.item.AddressInfo.AddressLine1&&!this.item.AddressInfo.AddressLine2&&(tt="An approximate address is required."),this.item.AddressInfo.CountryID||(tt="A country selection is required"),(!this.item.AddressInfo.Latitude||!this.item.AddressInfo.Longitude)&&(tt="A location latitude and longitude is required")),("all"==re||"poi-nearby"==re)&&this.nearbySites.length>0&&!this.isNonDuplicateConfirmed&&(tt="Please confirm that the site is not a duplicate"),("all"==re||"equipment"==re)&&(this.item.OperatorID||(tt="Please confirm the charging network or equipment operator."),0==this.item.Connections.length&&(tt="Equipment information is required")),tt?(this.validationMsg=tt,{isValid:!1,msg:tt}):(this.validationMsg=null,{isValid:!0,msg:null})}save(){var re=this;return(0,h.Z)(function*(){let tt=re.validate();if(tt.isValid){yield re.presentLoadingUI();try{yield re.appManager.submitPOI(re.item),yield re.dismissLoadingUI(),re.appManager.showToastNotification("You submission will be reviewed (if required) and published shortly."),re.modalController.dismiss()}catch(Wt){yield re.dismissLoadingUI(),Wt.error&&alert("Sorry, your submission could not be completed at this time. Please try again later.")}}else alert(tt.msg)})()}cancel(){var re=this;return(0,h.Z)(function*(){re.modalController.dismiss()})()}refreshTemplateSites(){var re=this;return(0,h.Z)(function*(){if(re.item.AddressInfo.CountryID&&re.item.OperatorID){yield re.presentLoadingUI(),re.templateSites=[];let tt=new ie.b;tt.countryIdList=[re.item.AddressInfo.CountryID],tt.minPowerKW=1,tt.operatorIdList=[re.item.OperatorID],tt.maxResults=10;let Wt=yield re.poiManager.fetchPOIList(tt);Wt.sort((Qt,fi)=>new Date(Qt.DateCreated).getTime()-new Date(fi.DateCreated).getTime()),re.templateSites=Wt,re.dismissLoadingUI()}})()}refreshNearbySites(){var re=this;return(0,h.Z)(function*(){if(re.item.AddressInfo.Latitude&&re.item.AddressInfo.Longitude){yield re.presentLoadingUI(),re.nearbySites=[];let tt=new ie.b;tt.latitude=re.item.AddressInfo.Latitude,tt.longitude=re.item.AddressInfo.Longitude,tt.distance=5,tt.distanceUnit="km",tt.maxResults=10;let Wt=yield re.poiManager.fetchPOIList(tt);return Wt.sort((Qt,fi)=>Qt.Distance-fi.Distance),re.nearbySites=Wt,re.dismissLoadingUI(),Wt.length}return 0})()}confirmNonDuplicate(){this.isNonDuplicateConfirmed=!0,this.next()}changeTemplatePOI(){this.selectedTemplatePOI=null}editPOI(re){this.editExistingPOI(re.ID)}editExistingPOI(re){var tt=this;return(0,h.Z)(function*(){tt.skipPOICopy=!0,tt.isNonDuplicateConfirmed=!0,yield tt.presentLoadingUI(),tt.poiManager.getPOIById(re,!0,!0).then(Wt=>{tt.item=Object.assign({},Wt),null==tt.item.OperatorID&&(tt.item.OperatorID=we.UnknownOperator),tt.refreshFilteredReferenceData(),tt.dismissLoadingUI()})})()}useTemplatePOI(re){this.selectedTemplatePOI=re,Object.assign(this.item.Connections,re.Connections);for(let tt of this.item.Connections)tt.ID=-c.c.getRandomInt(1e4),tt.Reference=null,tt.Comments=null,tt.StatusTypeID=Ne.Operational;this.item.UsageCost=re.UsageCost,this.item.UsageTypeID=re.UsageTypeID,this.appManager.referenceDataManager.hydrateCompactPOI(this.item)}skipCopyingPOI(){this.skipPOICopy=!0}}return Mt.\u0275fac=function(re){return new(re||Mt)(y.Y36(g.c),y.Y36(he.IN),y.Y36(Y.R),y.Y36(se.v),y.Y36(he.HT),y.Y36(he.Br))},Mt.\u0275cmp=y.Xpm({type:Mt,selectors:[["app-poi-editor"]],viewQuery:function(re,tt){if(1&re&&y.Gf(Ae,5),2&re){let Wt;y.iGM(Wt=y.CRH())&&(tt.editorMap=Wt.first)}},decls:33,vars:14,consts:[["slot","end"],[3,"click"],["name","close","slot","start"],[1,"ion-padding"],[3,"ngModel"],["value","location","layout","icon-start",3,"disabled"],["name","caret-forward",4,"ngIf"],["value","equipment","layout","icon-start",3,"disabled"],["value","info","layout","icon-start",3,"disabled"],[4,"ngIf"],["slot","start"],[3,"click",4,"ngIf"],["color","success",3,"click",4,"ngIf"],["name","caret-forward"],[3,"latitude","longitude","latitudeChange","longitudeChange","onUseSuggestedAddress"],["editorMap",""],["position","floating"],["type","text","autocapitalize","words","placeholder","A title for this location",3,"ngModel","ngModelChange"],["type","text","autocapitalize","words","placeholder","The nearest street address",3,"ngModel","ngModelChange"],["type","text","autocapitalize","words","placeholder","Optional",3,"ngModel","ngModelChange"],["type","text","autocapitalize","words","placeholder","Town or City",3,"ngModel","ngModelChange"],["type","text",3,"ngModel","ngModelChange"],["type","text","autocapitalize","words","placeholder","Optional Postal Code",3,"ngModel","ngModelChange"],[3,"ngModel","ngModelChange","ionChange"],[3,"value",4,"ngFor","ngForOf"],["type","number","placeholder","Latitude (if entering manually)",3,"ngModel","ngModelChange"],["type","number","placeholder","Longitude (if entering manually)",3,"ngModel","ngModelChange"],[3,"value"],[1,"instruction"],[3,"poiList","enableEditOption","onEdit"],[3,"operatorId","operatorChanged"],["slot","start","size","small",3,"click"],[3,"enableCopyOption","poiList","onCopy"],[3,"operatorId","useFilteredOperators","operatorChanged"],["size","small",3,"click"],["name","add","slot","icon-only"],[3,"item","enableEdit","onEdit","onDelete"],["color","warning",4,"ngIf"],[3,"ngModel","ngModelChange"],["type","text","autocapitalize","sentences",3,"ngModel","ngModelChange"],["type","tel","placeholder","",3,"ngModel","ngModelChange"],["type","text","autocapitalize","sentences","placeholder","Instructions for access or tips for finding charging location",3,"ngModel","ngModelChange"],["type","url","placeholder","Website related to this site",3,"ngModel","ngModelChange"],["color","warning"],["color","danger"],["name","caret-back","slot","start"],["name","caret-forward","slot","end"],["color","success",3,"click"],["name","send","slot","end"]],template:function(re,tt){1&re&&(y.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),y._uU(3),y.qZA(),y.TgZ(4,"ion-buttons",0)(5,"ion-button",1),y.NdJ("click",function(){return tt.cancel()}),y._UZ(6,"ion-icon",2),y._uU(7," Cancel "),y.qZA()()()(),y.TgZ(8,"ion-content",3),y.ynx(9),y.TgZ(10,"ion-segment",4)(11,"ion-segment-button",5),y.YNc(12,bt,1,0,"ion-icon",6),y.TgZ(13,"ion-label"),y._uU(14,"Location"),y.qZA()(),y.TgZ(15,"ion-segment-button",7),y.YNc(16,ct,1,0,"ion-icon",6),y.TgZ(17,"ion-label"),y._uU(18,"Equipment"),y.qZA()(),y.TgZ(19,"ion-segment-button",8),y.YNc(20,ht,1,0,"ion-icon",6),y.TgZ(21,"ion-label"),y._uU(22,"Info"),y.qZA()()(),y.YNc(23,Gt,3,2,"ng-container",9),y.YNc(24,Un,3,2,"ng-container",9),y.YNc(25,Ni,38,11,"ng-container",9),y.BQk(),y.qZA(),y.TgZ(26,"ion-footer")(27,"ion-toolbar")(28,"ion-buttons",10),y.YNc(29,Ii,3,0,"ion-button",11),y.qZA(),y.TgZ(30,"ion-buttons",0),y.YNc(31,Ui,3,0,"ion-button",11),y.YNc(32,Yi,3,0,"ion-button",12),y.qZA()()()),2&re&&(y.xp6(3),y.Oqu(tt.isAddMode?"Add Location":"Edit Location"),y.xp6(7),y.Q6J("ngModel",tt.selectedTab),y.xp6(1),y.Q6J("disabled",!0),y.xp6(1),y.Q6J("ngIf","location"==tt.selectedTab),y.xp6(3),y.Q6J("disabled",!0),y.xp6(1),y.Q6J("ngIf","equipment"==tt.selectedTab),y.xp6(3),y.Q6J("disabled",!0),y.xp6(1),y.Q6J("ngIf","info"==tt.selectedTab),y.xp6(3),y.Q6J("ngIf","location"==tt.selectedTab),y.xp6(1),y.Q6J("ngIf","equipment"==tt.selectedTab),y.xp6(1),y.Q6J("ngIf","info"==tt.selectedTab),y.xp6(4),y.Q6J("ngIf","location"!=tt.step),y.xp6(2),y.Q6J("ngIf",!tt.isReadyToSubmit&&"info"!=tt.step),y.xp6(1),y.Q6J("ngIf",tt.isReadyToSubmit))},dependencies:[Ze.sg,Ze.O5,Qe.JJ,Qe.On,he.YG,he.Sm,he.W2,he.fr,he.Gu,he.gu,he.pK,he.Ie,he.Q$,he.q_,he.cJ,he.GO,he.t9,he.n0,he.wd,he.sr,he.as,he.QI,he.j9,_e.o,pe.B,Ae,Pt],styles:['ul.breadcrumb[_ngcontent-%COMP%]{display:inline-flex;margin:0;padding:0}ul.breadcrumb[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{display:inline-flex;margin-right:6px;color:var(--ion-color-light-shade);font-size:10px}ul.breadcrumb[_ngcontent-%COMP%]   li.active[_ngcontent-%COMP%]{color:var(--ion-color-dark-shade)}ul.breadcrumb[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:before{content:">";padding-right:4px}']}),Mt})()},6763:(Rn,Dt,B)=>{"use strict";B.d(Dt,{u:()=>Ne});var h=B(8274),g=B(201),ie=B(4120),c=B(3912),Y=B(7689),se=B(129),y=B(529);let fe=(()=>{class we{constructor(Je,_e){this.http=Je,this.journeyManager=_e}getDirections(Je,_e){return new Promise((pe,ae)=>{(new google.maps.DirectionsService).route({origin:Je,destination:_e,travelMode:google.maps.TravelMode.DRIVING},(vt,Et)=>{Et===google.maps.DirectionsStatus.OK?pe(vt):ae(Et)})})}analyseRoutes(Je,_e){const pe=new Array;return Je.routes.forEach(ae=>{const Ee=new se.JJ;Ee.Title=""+pe.length+1,Ee.JourneyRouteLegs=new Array,Ee.TotalDistanceKM=0,Ee.TotalDurationMinutes=0,Ee.TotalEnergykWh=0,ae.legs.forEach(vt=>{const Et=vt.duration.value,qt=vt.distance.value/1e3,Ft=this.journeyManager.calculateEnergyConsumptionkWh(qt,0,null,_e),xt=new se.eN;xt.DistanceKM=qt,xt.DurationMinutes=Et/60,xt.EnergyConsumptionkWh=Ft,Ee.JourneyRouteLegs.push(xt),Ee.TotalDistanceKM+=xt.DistanceKM,Ee.TotalDurationMinutes+=xt.DurationMinutes,Ee.TotalEnergykWh=xt.EnergyConsumptionkWh}),pe.push(Ee)}),pe}}return we.\u0275fac=function(Je){return new(Je||we)(h.LFG(y.eN),h.LFG(c.i))},we.\u0275prov=h.Yz7({token:we,factory:we.\u0275fac,providedIn:"root"}),we})();var Ie=B(4781),Ge=B(6895),Q=B(4006),be=B(2428);function me(we,et){if(1&we){const Je=h.EpF();h.TgZ(0,"ion-item"),h._UZ(1,"ion-icon",12),h.TgZ(2,"ion-searchbar",13),h.NdJ("ngModelChange",function(pe){h.CHM(Je);const ae=h.oxw();return h.KtG(ae.routeStart=pe)})("ionInput",function(pe){h.CHM(Je),h.oxw();const ae=h.MAs(18);return h.KtG(ae.getPlacesAutoComplete(pe,"routeStart"))})("ionCancel",function(pe){h.CHM(Je);const ae=h.oxw();return h.KtG(ae.onPlaceSearchCancel(pe))}),h.qZA()()}if(2&we){const Je=h.oxw();h.xp6(2),h.Q6J("ngModel",Je.routeStart)("debounce",500)}}function Ze(we,et){if(1&we){const Je=h.EpF();h.TgZ(0,"ion-item",14),h.NdJ("click",function(){h.CHM(Je);const pe=h.oxw();return h.KtG(pe.clearRouteStart())}),h._UZ(1,"ion-icon",12),h.TgZ(2,"h2"),h._uU(3),h.qZA()()}if(2&we){h.oxw();const Je=h.MAs(18);h.xp6(3),h.Oqu(null==Je.selectedPlace?null:Je.selectedPlace.name)}}function he(we,et){if(1&we){const Je=h.EpF();h.TgZ(0,"ion-item"),h._UZ(1,"ion-icon",15),h.TgZ(2,"ion-searchbar",16),h.NdJ("ngModelChange",function(pe){h.CHM(Je);const ae=h.oxw();return h.KtG(ae.routeDestination=pe)})("ionInput",function(pe){h.CHM(Je),h.oxw();const ae=h.MAs(20);return h.KtG(ae.getPlacesAutoComplete(pe,"routeDestination"))})("ionCancel",function(pe){h.CHM(Je);const ae=h.oxw();return h.KtG(ae.onPlaceSearchCancel(pe))}),h.qZA()()}if(2&we){const Je=h.oxw();h.xp6(2),h.Q6J("ngModel",Je.routeDestination)("debounce",500)}}function Ke(we,et){if(1&we){const Je=h.EpF();h.TgZ(0,"ion-item",14),h.NdJ("click",function(){h.CHM(Je);const pe=h.oxw();return h.KtG(pe.clearRouteDestination())}),h._UZ(1,"ion-icon",15),h.TgZ(2,"h2"),h._uU(3),h.qZA()()}if(2&we){h.oxw();const Je=h.MAs(20);h.xp6(3),h.Oqu(null==Je.selectedPlace?null:Je.selectedPlace.name)}}function Ae(we,et){if(1&we){const Je=h.EpF();h.TgZ(0,"ion-button",14),h.NdJ("click",function(){h.CHM(Je);const pe=h.oxw();return h.KtG(pe.clearRoute())}),h._UZ(1,"ion-icon",17),h._uU(2," Clear Route "),h.qZA()}}function te(we,et){if(1&we){const Je=h.EpF();h.TgZ(0,"ion-button",14),h.NdJ("click",function(){h.CHM(Je);const pe=h.oxw();return h.KtG(pe.showSettings())}),h._uU(1," Show Settings "),h._UZ(2,"ion-icon",18),h.qZA()}}function Qe(we,et){if(1&we){const Je=h.EpF();h.TgZ(0,"ion-button",14),h.NdJ("click",function(){h.CHM(Je);const pe=h.oxw();return h.KtG(pe.hideSettings())}),h._uU(1," Hide Settings "),h._UZ(2,"ion-icon",18),h.qZA()}}function Ot(we,et){1&we&&(h.TgZ(0,"p",19),h._UZ(1,"ion-spinner",19),h._uU(2," Calculating Route.. "),h.qZA())}function dt(we,et){if(1&we&&(h.TgZ(0,"ion-list")(1,"ion-list-header"),h._uU(2),h.ALo(3,"number"),h.ALo(4,"number"),h.qZA()()),2&we){const Je=h.oxw();h.xp6(2),h.lnq(" Total Distance ",h.xi3(3,3,Je.selectedJourneyRoute.TotalDistanceKM,"1.0-2")," km, ",Je.formatDuration(Je.selectedJourneyRoute.TotalDurationMinutes),", ",h.xi3(4,6,Je.selectedJourneyRoute.TotalEnergykWh,"1.0-2")," kWh ")}}function ye(we,et){if(1&we){const Je=h.EpF();h.TgZ(0,"div")(1,"ion-list")(2,"ion-list-header"),h._UZ(3,"ion-icon",20),h._uU(4," Route Settings "),h.qZA(),h.TgZ(5,"ion-item")(6,"ion-label",21),h._uU(7),h.qZA(),h.TgZ(8,"ion-range",22),h.NdJ("ngModelChange",function(pe){h.CHM(Je);const ae=h.oxw();return h.KtG(ae.routeSearchDistance=pe)}),h._UZ(9,"ion-icon",23)(10,"ion-icon",24),h.qZA()(),h.TgZ(11,"ion-item")(12,"ion-label",21),h._uU(13,"Energy Efficiency (kWh Per km)"),h.qZA(),h.TgZ(14,"ion-input",25),h.NdJ("ngModelChange",function(pe){h.CHM(Je);const ae=h.oxw();return h.KtG(ae.kWhPerKM=pe)}),h.qZA()()()()}if(2&we){const Je=h.oxw();h.xp6(7),h.hij("Search Distance (",Je.routeSearchDistance,")"),h.xp6(1),h.Q6J("ngModel",Je.routeSearchDistance),h.xp6(6),h.Q6J("ngModel",Je.kWhPerKM)}}let Fe=(()=>{class we{constructor(Je,_e,pe,ae,Ee,vt){this.mapping=Je,this.logging=_e,this.directions=pe,this.journeyManager=ae,this.changeDetector=Ee,this.numberPipe=vt,this.routeSearchDistance=5,this.routeCalcInProgress=!1,this.advancedSettingsMode=!1,this.routeStart="",this.routeDestination="",this.kWhPerKM=.212}get isRouteSet(){return null!=this.routeStartPlace&&null!=this.routeDestinationPlace}showSettings(){this.advancedSettingsMode=!0}hideSettings(){this.advancedSettingsMode=!1}routeStartSelected(Je){this.routeStartPlace=Je,this.calculateRoute(),this.changeDetector.detectChanges()}routeDestinationSelected(Je){this.routeDestinationPlace=Je,this.calculateRoute(),this.changeDetector.detectChanges()}clearRouteStart(){this.routeStartPlace=null,this.changeDetector.detectChanges()}clearRouteDestination(){this.routeDestinationPlace=null,this.changeDetector.detectChanges()}clearRoute(){this.routeStartPlace=null,this.routeDestinationPlace=null,this.journeyManager.setRoutePolyline(null),this.mapping.clearPolyline()}formatDuration(Je){if(Je<=60)return this.numberPipe.transform(Je,"1.0-2")+" mins";{const _e=Math.round(Je/60),pe=Math.floor(Je-60*_e);return _e+" hours "+(pe>0?pe+" mins":"")}}calculateRoute(){null!=this.routeStartPlace&&null!=this.routeDestinationPlace&&(this.logging.log("Fetching route directions.."),this.routeCalcInProgress=!0,this.directions.getDirections(this.routeStartPlace.Location.latitude+","+this.routeStartPlace.Location.longitude,this.routeDestinationPlace.Location.latitude+","+this.routeDestinationPlace.Location.longitude).then(Je=>{if(null!=Je.routes&&Je.routes.length>0){this.logging.log("Got route directions, analysing.."),this.routePolyline=Je.routes[0].overview_polyline;const _e=Je.routes[0].bounds.getSouthWest(),pe=Je.routes[0].bounds.getNorthEast(),ae=new ie.wC(pe.lat(),pe.lng()),Ee=new ie.wC(_e.lat(),_e.lng()),vt=new ie.LL(ae,Ee);this.journeyRoutes=this.directions.analyseRoutes(Je,this.kWhPerKM),this.journeyRoutes.length>0&&(this.selectedJourneyRoute=this.journeyRoutes[0]),this.journeyManager.setRoutePolyline(this.routePolyline),this.mapping.renderPolyline(this.routePolyline),this.mapping.moveToMapBounds(vt)}else this.logging.log("No route returned..");this.routeCalcInProgress=!1}))}}return we.\u0275fac=function(Je){return new(Je||we)(h.Y36(Ie.v),h.Y36(Y.z),h.Y36(fe),h.Y36(c.i),h.Y36(h.sBO),h.Y36(Ge.JJ))},we.\u0275cmp=h.Xpm({type:we,selectors:[["route-planner"]],decls:24,vars:10,consts:[[1,"route"],[1,"route-places"],["name","map","slot","start"],[4,"ngIf"],[3,"click",4,"ngIf"],["primary",""],["slot","secondary"],["slot","primary"],[3,"placeChanged"],["placeSearchRouteStart",""],["placeSearchRouteDestination",""],["class","ion-padding",4,"ngIf"],["name","ionic","item-left",""],["placeholder","Starting Point",3,"ngModel","debounce","ngModelChange","ionInput","ionCancel"],[3,"click"],["name","pin","item-left",""],["placeholder","Destination",3,"ngModel","debounce","ngModelChange","ionInput","ionCancel"],["name","close","slot","start"],["name","cog","slot","end"],[1,"ion-padding"],["name","cog"],["position","stacked"],["min","1","max","200","step","5","snaps","true","pin","true","light","",3,"ngModel","ngModelChange"],["slot","start","small","","name","map"],["slot","end","large","","name","map"],["type","number","min","0.1","max","1",3,"ngModel","ngModelChange"]],template:function(Je,_e){1&Je&&(h.TgZ(0,"div",0)(1,"div",1)(2,"ion-list")(3,"ion-list-header"),h._UZ(4,"ion-icon",2),h.TgZ(5,"ion-label"),h._uU(6,"Plan Your Journey"),h.qZA()(),h.YNc(7,me,3,2,"ion-item",3),h.YNc(8,Ze,4,1,"ion-item",4),h.YNc(9,he,3,2,"ion-item",3),h.YNc(10,Ke,4,1,"ion-item",4),h.qZA(),h.TgZ(11,"ion-toolbar",5)(12,"ion-buttons",6),h.YNc(13,Ae,3,0,"ion-button",4),h.qZA(),h.TgZ(14,"ion-buttons",7),h.YNc(15,te,3,0,"ion-button",4),h.YNc(16,Qe,3,0,"ion-button",4),h.qZA()()(),h.TgZ(17,"place-search",8,9),h.NdJ("placeChanged",function(ae){return _e.routeStartSelected(ae)}),h.qZA(),h.TgZ(19,"place-search",8,10),h.NdJ("placeChanged",function(ae){return _e.routeDestinationSelected(ae)}),h.qZA(),h.YNc(21,Ot,3,0,"p",11),h.YNc(22,dt,5,9,"ion-list",3),h.YNc(23,ye,15,3,"div",3),h.qZA()),2&Je&&(h.xp6(7),h.Q6J("ngIf",null==_e.routeStartPlace),h.xp6(1),h.Q6J("ngIf",null!=_e.routeStartPlace),h.xp6(1),h.Q6J("ngIf",null==_e.routeDestinationPlace),h.xp6(1),h.Q6J("ngIf",null!=_e.routeDestinationPlace),h.xp6(3),h.Q6J("ngIf",_e.isRouteSet),h.xp6(2),h.Q6J("ngIf",!_e.advancedSettingsMode),h.xp6(1),h.Q6J("ngIf",_e.advancedSettingsMode),h.xp6(5),h.Q6J("ngIf",_e.routeCalcInProgress),h.xp6(1),h.Q6J("ngIf",null!=_e.selectedJourneyRoute),h.xp6(1),h.Q6J("ngIf",_e.advancedSettingsMode))},dependencies:[Ge.O5,g.YG,g.Sm,g.gu,g.pK,g.Ie,g.Q$,g.q_,g.yh,g.I_,g.VI,g.PQ,g.sr,g.as,g.QI,g.j9,Q.JJ,Q.On,be.v,Ge.JJ],encapsulation:2}),we})(),Ne=(()=>{class we{constructor(Je){this.modalController=Je,this.hasNavbar=!1}close(){this.modalController.dismiss()}}return we.\u0275fac=function(Je){return new(Je||we)(h.Y36(g.IN))},we.\u0275cmp=h.Xpm({type:we,selectors:[["ng-component"]],decls:10,vars:0,consts:[["slot","end"],[3,"click"],["name","close","slot","end"],[1,"route-planner","ion-padding"]],template:function(Je,_e){1&Je&&(h.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),h._uU(3," Route Planner "),h.qZA(),h.TgZ(4,"ion-buttons",0)(5,"ion-button",1),h.NdJ("click",function(){return _e.close()}),h._UZ(6,"ion-icon",2),h._uU(7," Close "),h.qZA()()()(),h.TgZ(8,"ion-content",3),h._UZ(9,"route-planner"),h.qZA())},dependencies:[g.YG,g.Sm,g.W2,g.Gu,g.gu,g.wd,g.sr,Fe],encapsulation:2}),we})()},3548:(Rn,Dt,B)=>{"use strict";B.r(Dt),B.d(Dt,{SearchPageModule:()=>wn});var h=B(8936),g=B(4463),ie=B(6895),c=B(4006),Y=B(201),se=B(4228),y=B(5861),fe=B(2340),Ie=B(2951),Ge=B(6314),Q=B(6763),be=B(3399),me=B(4120),Ze=B(8016),he=B(6579),Ke=B(7689),Ae=B(3912),te=B(4781),Qe=B(9698),Ot=B(3855),dt=B(2428),ye=B(4968),Fe=B(727);class Ne extends Fe.w0{constructor(un,ut){super()}schedule(un,ut=0){return this}}const we={setInterval(Fn,un,...ut){const{delegate:jt}=we;return jt?.setInterval?jt.setInterval(Fn,un,...ut):setInterval(Fn,un,...ut)},clearInterval(Fn){const{delegate:un}=we;return(un?.clearInterval||clearInterval)(Fn)},delegate:void 0};var et=B(8737),_e=B(6063);class pe{constructor(un,ut=pe.now){this.schedulerActionCtor=un,this.now=ut}schedule(un,ut=0,jt){return new this.schedulerActionCtor(this,un).schedule(jt,ut)}}pe.now=_e.l.now;const Ee=new class ae extends pe{constructor(un,ut=pe.now){super(un,ut),this.actions=[],this._active=!1}flush(un){const{actions:ut}=this;if(this._active)return void ut.push(un);let jt;this._active=!0;do{if(jt=un.execute(un.state,un.delay))break}while(un=ut.shift());if(this._active=!1,jt){for(;un=ut.shift();)un.unsubscribe();throw jt}}}(class Je extends Ne{constructor(un,ut){super(un,ut),this.scheduler=un,this.work=ut,this.pending=!1}schedule(un,ut=0){var jt;if(this.closed)return this;this.state=un;const En=this.id,ni=this.scheduler;return null!=En&&(this.id=this.recycleAsyncId(ni,En,ut)),this.pending=!0,this.delay=ut,this.id=null!==(jt=this.id)&&void 0!==jt?jt:this.requestAsyncId(ni,this.id,ut),this}requestAsyncId(un,ut,jt=0){return we.setInterval(un.flush.bind(un,this),jt)}recycleAsyncId(un,ut,jt=0){if(null!=jt&&this.delay===jt&&!1===this.pending)return ut;null!=ut&&we.clearInterval(ut)}execute(un,ut){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const jt=this._execute(un,ut);if(jt)return jt;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(un,ut){let En,jt=!1;try{this.work(un)}catch(ni){jt=!0,En=ni||new Error("Scheduled action threw falsy error")}if(jt)return this.unsubscribe(),En}unsubscribe(){if(!this.closed){const{id:un,scheduler:ut}=this,{actions:jt}=ut;this.work=this.state=this.scheduler=null,this.pending=!1,(0,et.P)(jt,this),null!=un&&(this.id=this.recycleAsyncId(ut,un,null)),this.delay=null,super.unsubscribe()}}});var Et=B(4482),qt=B(5403);const Pt=(0,B(7423).fo)("Geolocation",{web:()=>B.e(4561).then(B.bind(B,4561)).then(Fn=>new Fn.GeolocationWeb)});var bt=B(8274),ct=B(6260);function ht(Fn,un){1&Fn&&bt._UZ(0,"ion-icon",13)}function Ce(Fn,un){1&Fn&&bt._UZ(0,"ion-spinner")}function Ct(Fn,un){if(1&Fn){const ut=bt.EpF();bt.TgZ(0,"ion-button",3),bt.NdJ("click",function(){bt.CHM(ut);const En=bt.oxw();return bt.KtG(En.openSideView())}),bt._UZ(1,"ion-icon",14),bt.qZA()}}function Ut(Fn,un){1&Fn&&(bt.ynx(0),bt.TgZ(1,"div",15)(2,"p"),bt._uU(3,"There was a problem communicating with Open Charge Map. Please check your data connection."),bt.qZA()(),bt.BQk())}let Gt=(()=>{class Fn{constructor(ut,jt,En,ni,ci,Un,_i,wi,xi,Ni,Ii,Ui){this.appManager=ut,this.nav=jt,this.events=En,this.translate=ni,this.platform=ci,this.poiManager=Un,this.mapping=_i,this.journeyManager=wi,this.zone=xi,this.modalController=Ni,this.alertController=Ii,this.logging=Ui,this.mapDisplayed=!1,this.initialResultsShown=!1,this.searchOnDemand=!1,this.poiViewMode="modal",this.sideViewAvailable=!1,this.routePlanningMode=!0,this.searchKeyword="",this.appConfig=new Ie.X,this.defaultMapZoom=15,this.defaultStartPos=new me.wC(37.415328,-122.076575),this._watchId=null,this.mapCanvasID="map-canvas",this.mapping.setMapType(ut.searchSettings.MapType),this.mapping.setMapAPI(fe.N.defaultMapProvider),(0,ye.R)(window,"resize").pipe(function Ft(Fn,un=Ee){return(0,Et.e)((ut,jt)=>{let En=null,ni=null,ci=null;const Un=()=>{if(En){En.unsubscribe(),En=null;const wi=ni;ni=null,jt.next(wi)}};function _i(){const wi=ci+Fn,xi=un.now();if(xi<wi)return En=this.schedule(void 0,wi-xi),void jt.add(En);Un()}ut.subscribe((0,qt.x)(jt,wi=>{ni=wi,ci=un.now(),En||(En=un.schedule(_i,Fn),jt.add(En))},()=>{Un(),jt.complete()},void 0,()=>{ni=En=null}))})}(500)).subscribe(Ht=>{let Mt={width:he.c.getClientHeight(),height:he.c.getClientWidth()};this.events.publish("ocm:window:resized",[Mt])})}ionViewDidEnter(){this.logging.log("Entered search page.",Ke.i.VERBOSE),this.mapping.focusMap(),this.mapping.updateMapSize()}ionViewWillLeave(){this.logging.log("Leaving search page.",Ke.i.VERBOSE),this.mapping.unfocusMap()}getPreferredMapHeight(ut){return null==ut&&(ut=he.c.getClientHeight()),ut-56}enforceMapHeight(ut){this.logging.log("Would resize map:"+ut.width+" "+ut.height,Ke.i.VERBOSE),this.checkViewportMode();const jt=this.getPreferredMapHeight(ut[0]);document.getElementById(this.mapCanvasID).offsetHeight!==jt&&(document.getElementById(this.mapCanvasID).style.height=jt+"px"),this.mapping&&(this.logging.log("Map height:"+jt,Ke.i.VERBOSE),this.mapping.updateMapSize())}checkViewportMode(){}initialiseMapping(){var ut=this;return(0,y.Z)(function*(){yield ut.platform.ready(),ut.debouncedRefreshMapResults=he.c.debounce(ut.refreshMapResults,1e3,!1),ut.events.subscribe("ocm:mapping:ready",(0,y.Z)(function*(){if(ut.logging.log("init map: mapping ready"),ut.mapping&&ut.mapping.updateMapSize(),!ut.initialResultsShown)if(ut.appManager.searchSettings.StartSearchPosition)ut.searchOnDemand=!0,ut.mapping.updateMapCentrePos(ut.appManager.searchSettings.StartSearchPosition.latitude,ut.appManager.searchSettings.StartSearchPosition.longitude,!0,ut.defaultMapZoom);else{let jt=localStorage.getItem("_locationEnabled");1==ut.appManager.isEmbeddedMode&&"true"!=jt?yield(yield ut.alertController.create({header:"Search using your location?",message:"Select OK to continue.",buttons:[{text:"Cancel",role:"cancel",cssClass:"secondary",handler:(ni=(0,y.Z)(function*(ci){yield ut.useFallbackPosition()}),function(Un){return ni.apply(this,arguments)})},{text:"OK",handler:function(){var ni=(0,y.Z)(function*(){yield ut.locateUser()});return function(){return ni.apply(this,arguments)}}()}]})).present():(yield ut.locateUser(),ut.mapping&&ut.mapping.updateMapSize())}var ni})),ut.events.subscribe("ocm:mapping:zoom",()=>{ut.debouncedRefreshMapResults()}),ut.events.subscribe("ocm:mapping:dragend",()=>{ut.debouncedRefreshMapResults()}),ut.events.subscribe("ocm:poiList:updated",jt=>{ut.showPOIListOnMap(jt)}),ut.events.subscribe("ocm:poiList:cleared",()=>{ut.mapping.clearMarkers(),setTimeout(()=>{ut.debouncedRefreshMapResults()},500)}),ut.events.subscribe("ocm:window:resized",jt=>{null!=jt&&jt.length>0&&ut.enforceMapHeight(jt[0])}),ut.events.subscribe("ocm:poi:selected",jt=>{if(jt.poi)ut.viewPOIDetails(jt,jt.poi);else{let En=ut.getPOIByID(jt.poiId);ut.viewPOIDetails(jt,En)}}),ut.checkViewportMode(),ut.mapping.initMap(ut.mapCanvasID)})()}ngAfterViewInit(){var ut=this;return(0,y.Z)(function*(){yield ut.initialiseMapping()})()}ngOnInit(){var ut=this;return(0,y.Z)(function*(){ut.logging.log("Refreshing reference data ..",Ke.i.VERBOSE),(yield ut.appManager.referenceDataManager.refreshReferenceData(ut.appManager.api))||(ut.appManager.isOffline=!0)})()}showPOIListOnMap(ut){const jt=this.getPreferredMapHeight(null);this.mapping.refreshMapView(jt,this.poiManager.poiList,null),this.mapDisplayed||(this.mapDisplayed=!0)}getIconForPOI(ut){return he.c.getIconForPOI(ut)}getPOIByID(ut){const jt=this.poiManager.poiList;for(let En=0;En<jt.length;En++)if(jt[En].ID===ut)return jt[En];return null}refreshMapResults(){var ut=this;return(0,y.Z)(function*(){if(!ut.searchOnDemand)return void ut.logging.log("Skipping refresh, search on demand disabled..",Ke.i.VERBOSE);ut.logging.log("Refreshing Results..",Ke.i.VERBOSE);const jt=new Ze.b;let En=null;if(ut.appManager.searchSettings.StartSearchPosition&&(En=new me.jR(ut.appManager.searchSettings.StartSearchPosition.latitude,ut.appManager.searchSettings.StartSearchPosition.longitude),ut.appManager.searchSettings.StartSearchPosition=null),En&&0==En.coords.latitude&&0==En.coords.longitude)return void ut.logging.log("Map center is zero. No query will be performed",Ke.i.WARNING);if(null!=En)jt.latitude=En.coords.latitude,jt.longitude=En.coords.longitude,jt.distance=25,jt.boundingbox=null,ut.appManager.searchSettings.LastSearchPosition=new me.wC(En.coords.latitude,En.coords.longitude);else{jt.latitude=null,jt.longitude=null;let ci=yield ut.mapping.getMapBounds().toPromise();jt.boundingbox="("+ci[0].latitude+","+ci[0].longitude+"),("+ci[1].latitude+","+ci[1].longitude+")",ut.logging.log(JSON.stringify(ci),Ke.i.VERBOSE)}jt.includeComments=!0,jt.enableCaching=!0,null!=ut.appManager.searchSettings&&(null!=ut.appManager.searchSettings.ConnectionTypeList&&(jt.connectionTypeIdList=ut.appManager.searchSettings.ConnectionTypeList),null!=ut.appManager.searchSettings.UsageTypeList&&(jt.usageTypeIdList=ut.appManager.searchSettings.UsageTypeList),null!=ut.appManager.searchSettings.StatusTypeList&&(jt.statusTypeIdList=ut.appManager.searchSettings.StatusTypeList),null!=ut.appManager.searchSettings.OperatorList&&(jt.operatorIdList=ut.appManager.searchSettings.OperatorList),null!=ut.appManager.searchSettings.MinPowerKW&&ut.appManager.searchSettings.MinPowerKW>0&&(jt.minPowerKW=ut.appManager.searchSettings.MinPowerKW),null!=ut.appManager.searchSettings.MaxPowerKW&&ut.appManager.searchSettings.MaxPowerKW>0&&(jt.maxPowerKW=ut.appManager.searchSettings.MaxPowerKW),null!=ut.journeyManager.getRoutePolyline()&&(jt.polyline=ut.journeyManager.getRoutePolyline(),jt.boundingbox=null,jt.levelOfDetail=null,jt.latitude=null,jt.longitude=null)),ut.appManager.isRequestInProgress=!0;let ni=yield ut.poiManager.refreshPOIList(jt);ut.appManager.isRequestInProgress=!1,ut.initialResultsShown=!0,ni>=jt.maxResults&&ut.appManager.showToastNotification("A maximum of "+ni+" results are returned per search. Zoom in for details.")})()}viewPOIDetails(ut,jt){this.logging.log("Viewing/fetching ["+this.poiViewMode+"] POI Details "+ut.poiId),null!=jt?(this.mapping.unfocusMap(),this.modalController.create({component:be.H,componentProps:{item:jt}}).then(En=>{En.onDidDismiss().then(()=>{this.logging.log("Dismissing POI Details."),this.mapping.focusMap(),this.searchOnDemand=!0}),En.present()})):this.poiManager.getPOIById(ut.poiId,!0).then(En=>{this.logging.log("Got POI Details "+En.ID),"modal"===this.poiViewMode&&(this.searchOnDemand=!1,this.modalController.create({component:be.H,componentProps:{item:En}}).then(ni=>{ni.onDidDismiss().then(()=>{this.logging.log("Dismissing POI Details."),this.mapping.focusMap(),this.searchOnDemand=!0}),ni.present()}),this.mapping.unfocusMap()),"side"===this.poiViewMode&&(this.selectedPOI=En)},En=>{this.appManager.showToastNotification("POI Details not available")})}closePOIDetails(){this.selectedPOI=null}openRoutePlannerModal(){this.searchOnDemand=!1,this.mapping.unfocusMap(),this.modalController.create({component:Q.u}).then(ut=>{ut.onDidDismiss().then(jt=>{this.logging.log("Dismissing Route Planner Details."),this.mapping.focusMap(),this.searchOnDemand=!0}),ut.present()})}openSearchOptions(){this.searchOnDemand=!1,this.mapping.unfocusMap(),this.modalController.create({component:Ge.N}).then(ut=>{ut.onDidDismiss().then(jt=>{this.mapping.focusMap(),this.searchOnDemand=!0}),ut.present()})}openSideView(){this.poiViewMode="side",this.mapping.updateMapSize()}closeSideView(){this.poiViewMode="modal",this.mapping.updateMapSize()}planRoute(){this.routePlanningMode=!0}search(ut){this.placeSearchMapPOI.getPlacesAutoComplete(ut,"poiSearch")}useFallbackPosition(){let ut=this.defaultStartPos;null!=this.appManager.searchSettings.LastSearchPosition&&(ut=this.appManager.searchSettings.LastSearchPosition),this.appManager.searchSettings.StartSearchPosition=ut,this.appManager.searchSettings.LastSearchPosition=null,this.searchOnDemand=!0,this.mapping.updateMapCentrePos(ut.latitude,ut.longitude,!0,this.defaultMapZoom)}getPosition(ut={}){var jt=this;return(0,y.Z)(function*(){return new Promise((En,ni)=>{jt._watchId=Pt.watchPosition(ut,(ci,Un)=>{Pt.clearWatch({id:jt._watchId}),Un?ni(Un):En(ci)})})})()}locateUser(){var ut=this;return(0,y.Z)(function*(){ut.useFallbackPosition();try{ut.logging.log("Attempting to locate user..");const jt=yield ut.getPosition({timeout:1e4});if(!jt)throw"Failed to get user location.";return ut.logging.log("Got user location."),ut.appManager.searchSettings.StartSearchPosition=new me.wC(jt.coords.latitude,jt.coords.longitude),ut.searchOnDemand=!0,ut.mapping.updateMapCentrePos(jt.coords.latitude,jt.coords.longitude,!0,ut.defaultMapZoom),localStorage.setItem("_locationEnabled","true"),!0}catch(jt){return ut.logging.log("Failed to get user location. Searching using default or last position."+jt),ut.appManager.showToastNotification("Your location could not be determined."),ut.useFallbackPosition(),!1}})()}placeSelected(ut){this.searchKeyword=ut.Address,this.logging.log("Got place details:"+ut.Address),this.mapping.focusMap(),this.mapping.updateMapCentrePos(ut.Location.latitude,ut.Location.longitude,!0),this.debouncedRefreshMapResults()}}return Fn.\u0275fac=function(ut){return new(ut||Fn)(bt.Y36(Ot.c),bt.Y36(Y.SH),bt.Y36(ct.z),bt.Y36(g.sK),bt.Y36(Y.t4),bt.Y36(Qe.R),bt.Y36(te.v),bt.Y36(Ae.i),bt.Y36(bt.R0b),bt.Y36(Y.IN),bt.Y36(Y.Br),bt.Y36(Ke.z))},Fn.\u0275cmp=bt.Xpm({type:Fn,selectors:[["ng-component"]],viewQuery:function(ut,jt){if(1&ut&&bt.Gf(dt.v,7),2&ut){let En;bt.iGM(En=bt.CRH())&&(jt.placeSearchMapPOI=En.first)}},decls:18,vars:10,consts:[["slot","start"],["autocapitalize","on","autocomplete","on",3,"ngModel","placeholder","debounce","ngModelChange","ionInput"],["slot","end"],[3,"click"],["name","locate","slot","start",4,"ngIf"],[4,"ngIf"],[3,"color","click"],["name","options","slot","end"],[3,"click",4,"ngIf"],[1,"search-page"],[3,"placeChanged"],["placeSearchMapPOI",""],["id","map-canvas",2,"height","100%","width","100%","min-height","300px"],["name","locate","slot","start"],["name","car","title","Route","slot","end"],[2,"position","absolute"]],template:function(ut,jt){1&ut&&(bt.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),bt._UZ(3,"ion-menu-button"),bt.qZA(),bt.TgZ(4,"ion-searchbar",1),bt.NdJ("ngModelChange",function(ni){return jt.searchKeyword=ni})("ionInput",function(ni){return jt.search(ni)}),bt.ALo(5,"translate"),bt.qZA(),bt.TgZ(6,"ion-buttons",2)(7,"ion-button",3),bt.NdJ("click",function(){return jt.locateUser()}),bt.YNc(8,ht,1,0,"ion-icon",4),bt.YNc(9,Ce,1,0,"ion-spinner",5),bt.qZA(),bt.TgZ(10,"ion-button",6),bt.NdJ("click",function(){return jt.openSearchOptions()}),bt._UZ(11,"ion-icon",7),bt.qZA(),bt.YNc(12,Ct,2,0,"ion-button",8),bt.qZA()()(),bt.TgZ(13,"ion-content",9)(14,"place-search",10,11),bt.NdJ("placeChanged",function(ni){return jt.placeSelected(ni)}),bt.qZA(),bt.YNc(16,Ut,4,0,"ng-container",5),bt._UZ(17,"div",12),bt.qZA()),2&ut&&(bt.xp6(4),bt.Q6J("ngModel",jt.searchKeyword)("placeholder",bt.lcZ(5,8,"ocm.search.performSearch"))("debounce",500),bt.xp6(4),bt.Q6J("ngIf",!jt.appManager.isRequestInProgress),bt.xp6(1),bt.Q6J("ngIf",jt.appManager.isRequestInProgress),bt.xp6(1),bt.Q6J("color",jt.appManager.searchSettings.HasActiveFilters?"danger":"default"),bt.xp6(2),bt.Q6J("ngIf",1==jt.sideViewAvailable&&"modal"==jt.poiViewMode),bt.xp6(4),bt.Q6J("ngIf",jt.appManager.isOffline))},dependencies:[ie.O5,c.JJ,c.On,Y.YG,Y.Sm,Y.W2,Y.Gu,Y.gu,Y.fG,Y.VI,Y.PQ,Y.sr,Y.j9,dt.v,g.X$],styles:[".search-page[_ngcontent-%COMP%]   #map-canvas[_ngcontent-%COMP%]{width:100%;height:98%}.search-page[_ngcontent-%COMP%]   #place-search[_ngcontent-%COMP%]{min-height:300px;background-color:#f0f0f0;position:absolute;z-index:100;width:100%}.search-page[_ngcontent-%COMP%]   ion-buttons[_ngcontent-%COMP%]{flex:.4}.search-page[_ngcontent-%COMP%]   ion-grid[_ngcontent-%COMP%], .search-page[_ngcontent-%COMP%]   ion-row[_ngcontent-%COMP%], .search-page[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]{padding:0}.search-page[_ngcontent-%COMP%]   scroll-content[_ngcontent-%COMP%]{overflow-y:hidden}.search-page[_ngcontent-%COMP%]   .banner[_ngcontent-%COMP%]{padding-left:2em}.search-page[_ngcontent-%COMP%]   .sideview[_ngcontent-%COMP%]{background:rgb(238,238,238);background:linear-gradient(to bottom,rgb(238,238,238) 0%,rgb(255,255,255) 100%)}"]}),Fn})(),wn=(()=>{class Fn{}return Fn.\u0275fac=function(ut){return new(ut||Fn)},Fn.\u0275mod=bt.oAB({type:Fn}),Fn.\u0275inj=bt.cJS({imports:[ie.ez,c.u5,Y.Pc,g.aw,h.e,se.Bz.forChild([{path:"",component:Gt}])]}),Fn})()},6314:(Rn,Dt,B)=>{"use strict";B.d(Dt,{N:()=>ye});var h=B(5861),g=B(9698),ie=B(3855),c=B(7627),Y=B(6579),se=B(4781),y=B(8274),fe=B(201),Ie=B(6260),Ge=B(6895),Q=B(4006),be=B(4463);let me=(()=>{class Fe extends be.X${constructor(we,et){super(we,et)}transform(we,...et){let Je=super.transform(we,...et);return Je==we?null!=et&&et[0].default?et[0].default:et[0].Title?et[0].Title:Je:Je}}return Fe.\u0275fac=function(we){return new(we||Fe)(y.Y36(be.sK,16),y.Y36(y.sBO,16))},Fe.\u0275pipe=y.Yjl({name:"nullableTranslate",type:Fe,pure:!0}),Fe.\u0275prov=y.Yz7({token:Fe,factory:Fe.\u0275fac}),Fe})();function Ze(Fe,Ne){if(1&Fe){const we=y.EpF();y.TgZ(0,"p",21),y._UZ(1,"ion-icon",22),y._uU(2," One or more filters are currently being applied. "),y.TgZ(3,"ion-button",23),y.NdJ("click",function(){y.CHM(we);const Je=y.oxw();return y.KtG(Je.clearFilters())}),y._UZ(4,"ion-icon",24),y.TgZ(5,"ion-label"),y._uU(6,"Clear"),y.qZA()()()}}function he(Fe,Ne){if(1&Fe&&(y.TgZ(0,"ion-select-option",26),y._uU(1),y.qZA()),2&Fe){const we=Ne.$implicit;y.Q6J("value",we.ID),y.xp6(1),y.Oqu(we.Title)}}function Ke(Fe,Ne){if(1&Fe){const we=y.EpF();y.TgZ(0,"ion-item")(1,"ion-label"),y._uU(2),y.ALo(3,"translate"),y.qZA(),y.TgZ(4,"ion-select",14),y.NdJ("ngModelChange",function(Je){y.CHM(we);const _e=y.oxw();return y.KtG(_e.searchSettings.FilterOptionsByCountryId=Je)})("ionChange",function(){y.CHM(we);const Je=y.oxw();return y.KtG(Je.onCountryChange())}),y.TgZ(5,"ion-select",25),y._uU(6,"(All Countries)"),y.qZA(),y.YNc(7,he,2,2,"ion-select-option",4),y.qZA()()}if(2&Fe){const we=y.oxw();y.xp6(2),y.Oqu(y.lcZ(3,3,"ocm.search.countries")),y.xp6(2),y.Q6J("ngModel",we.searchSettings.FilterOptionsByCountryId),y.xp6(3),y.Q6J("ngForOf",we.countries)}}function Ae(Fe,Ne){if(1&Fe&&(y.TgZ(0,"ion-select-option",26),y._uU(1),y.ALo(2,"nullableTranslate"),y.qZA()),2&Fe){const we=Ne.$implicit;y.Q6J("value",we.ID),y.xp6(1),y.Oqu(y.xi3(2,2,"ocm.reference.operatorInfo.value_"+we.ID,we))}}function te(Fe,Ne){if(1&Fe&&(y.TgZ(0,"ion-select-option",26),y._uU(1),y.ALo(2,"nullableTranslate"),y.qZA()),2&Fe){const we=Ne.$implicit;y.Q6J("value",we.ID),y.xp6(1),y.Oqu(y.xi3(2,2,"ocm.reference.usageType.value_"+we.ID,we))}}function Qe(Fe,Ne){if(1&Fe&&(y.TgZ(0,"ion-select-option",26),y._uU(1),y.ALo(2,"nullableTranslate"),y.qZA()),2&Fe){const we=Ne.$implicit;y.Q6J("value",we.ID),y.xp6(1),y.Oqu(y.xi3(2,2,"ocm.reference.statusType.value_"+we.ID,we))}}function Ot(Fe,Ne){if(1&Fe&&(y.TgZ(0,"ion-select-option",26),y._uU(1),y.ALo(2,"nullableTranslate"),y.qZA()),2&Fe){const we=Ne.$implicit;y.Q6J("value",we.ID),y.xp6(1),y.Oqu(y.xi3(2,2,"ocm.reference.connectionType.value_"+we.ID,we))}}function dt(Fe,Ne){if(1&Fe&&(y.TgZ(0,"ion-select-option",26),y._uU(1),y.qZA()),2&Fe){const we=Ne.$implicit;y.Q6J("value",we.code),y.xp6(1),y.Oqu(we.title)}}let ye=(()=>{class Fe{constructor(we,et,Je,_e,pe){this.appManager=we,this.poiManager=et,this.mapping=Je,this.modalController=_e,this.events=pe,this.maxPower=c.U,this.powerRange={lower:0,upper:this.maxPower},this._languages=[],this.searchSettings=we.searchSettings}ngOnInit(){var we=this;return(0,h.Z)(function*(){null!=we.searchSettings.MinPowerKW&&(we.powerRange.lower=we.searchSettings.MinPowerKW),null!=we.searchSettings.MaxPowerKW&&(we.powerRange.upper=we.searchSettings.MaxPowerKW),0==we.powerRange.upper&&(we.powerRange.upper=we.maxPower),we.appManager.analytics.viewEvent("Settings"),we.useFilteredOptions&&(yield we.onCountryChange())})()}get useFilteredOptions(){return this.searchSettings.FilterOptionsByCountryId>0}clearFilters(){this.searchSettings.ClearActiveFilters(),this.powerRange={lower:0,upper:this.maxPower},this.searchSettings.CheckForActiveFilters()}get operators(){return this.appManager.referenceDataManager.getNetworkOperators(this.useFilteredOptions)}get connectionTypes(){return this.appManager.referenceDataManager.getConnectionTypes(this.useFilteredOptions)}get usageTypes(){return this.appManager.referenceDataManager.getUsageTypes(this.useFilteredOptions)}get statusTypes(){return this.appManager.referenceDataManager.getStatusTypes(this.useFilteredOptions)}get countries(){return this.appManager.referenceDataManager.getCountries(this.useFilteredOptions)}get isCountryFilterFeatureEnabled(){return Y.c.isFeatureEnabled("FILTER_OPTIONS_BY_COUNTRY")}get languages(){return this._languages.length>0||(this._languages=this.appManager.getLanguages()),this._languages}ionViewWillLeave(){null!=this.searchSettings.Language&&this.appManager.setLanguage(this.searchSettings.Language),this.searchSettings.MinPowerKW=this.powerRange.lower,this.searchSettings.MaxPowerKW=this.powerRange.upper,1==this.searchSettings.MinPowerKW&&(this.searchSettings.MinPowerKW=null),this.searchSettings.MaxPowerKW==this.maxPower&&(this.searchSettings.MaxPowerKW=null),this.appManager.searchSettings=this.searchSettings,this.appManager.saveSearchSettings(),this.events.publish("ocm:poiList:cleared")}onLanguageChange(){null!=this.searchSettings.Language&&""!=this.searchSettings.Language&&this.appManager.setLanguage(this.searchSettings.Language)}onCountryChange(){var we=this;return(0,h.Z)(function*(){we.appManager.referenceDataManager.refreshFilteredReferenceData(we.appManager.api,{CountryIds:[we.searchSettings.FilterOptionsByCountryId]})})()}onMapTypeChange(){var we=this;return(0,h.Z)(function*(){we.mapping.setMapType(we.searchSettings.MapType)})()}close(){this.modalController.dismiss()}}return Fe.\u0275fac=function(we){return new(we||Fe)(y.Y36(ie.c),y.Y36(g.R),y.Y36(se.v),y.Y36(fe.IN),y.Y36(Ie.z))},Fe.\u0275cmp=y.Xpm({type:Fe,selectors:[["ng-component"]],decls:77,vars:38,consts:[[1,"settings-page","ion-padding"],["danger","",4,"ngIf"],[4,"ngIf"],["multiple","true","cancelText","Cancel","okText","OK",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["lines","none"],["dualKnobs","true","min","0","max","650","pin","true",3,"ngModel","ngModelChange"],["slot","start","size","small","name","flash"],["slot","end","name","flash"],["slot","start",2,"padding-top","0"],["type","number","min","0",2,"width","3em","border","none",3,"ngModel","max","ngModelChange"],["slot","end",2,"padding-top","0"],["type","number",2,"width","3em","border","none",3,"ngModel","max","min","ngModelChange"],["multiple","false",3,"ngModel","ngModelChange","ionChange"],["multiple","false","cancelText","Cancel","okText","OK",3,"ngModel","ngModelChange","ionChange"],["value","ROADMAP"],["value","SATELLITE"],[3,"ngModel","ngModelChange"],["slot","end"],[3,"click"],["name","close","slot","start"],["danger",""],["name","alert"],["size","small","color","light",3,"click"],["slot","start","name","close"],["value",""],[3,"value"]],template:function(we,et){1&we&&(y.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),y._uU(3),y.ALo(4,"translate"),y.qZA()()(),y.TgZ(5,"ion-content",0)(6,"h2"),y._uU(7,"Search Filters"),y.qZA(),y.TgZ(8,"p"),y._uU(9,"Note: Filters will remove usable charging locations from your search results if we do not have complete data (i.e Operator or Power Levels)."),y.qZA(),y.YNc(10,Ze,7,0,"p",1),y.TgZ(11,"ion-list"),y.YNc(12,Ke,8,5,"ion-item",2),y.TgZ(13,"ion-item")(14,"ion-label"),y._uU(15),y.ALo(16,"translate"),y.qZA(),y.TgZ(17,"ion-select",3),y.NdJ("ngModelChange",function(_e){return et.searchSettings.OperatorList=_e}),y.YNc(18,Ae,3,5,"ion-select-option",4),y.qZA()(),y.TgZ(19,"ion-item")(20,"ion-label"),y._uU(21),y.ALo(22,"translate"),y.qZA(),y.TgZ(23,"ion-select",3),y.NdJ("ngModelChange",function(_e){return et.searchSettings.UsageTypeList=_e}),y.YNc(24,te,3,5,"ion-select-option",4),y.qZA()(),y.TgZ(25,"ion-item")(26,"ion-label"),y._uU(27),y.ALo(28,"translate"),y.qZA(),y.TgZ(29,"ion-select",3),y.NdJ("ngModelChange",function(_e){return et.searchSettings.StatusTypeList=_e}),y.YNc(30,Qe,3,5,"ion-select-option",4),y.qZA()(),y.TgZ(31,"ion-item")(32,"ion-label"),y._uU(33),y.ALo(34,"translate"),y.qZA(),y.TgZ(35,"ion-select",3),y.NdJ("ngModelChange",function(_e){return et.searchSettings.ConnectionTypeList=_e}),y.YNc(36,Ot,3,5,"ion-select-option",4),y.qZA()(),y.TgZ(37,"ion-item",5)(38,"ion-range",6),y.NdJ("ngModelChange",function(_e){return et.powerRange=_e}),y.TgZ(39,"ion-icon",7),y._uU(40,"0"),y.qZA(),y._UZ(41,"ion-icon",8),y.qZA()(),y.TgZ(42,"ion-item",5)(43,"ion-note",9),y._uU(44,"Min. Power (kW)"),y._UZ(45,"br"),y.TgZ(46,"input",10),y.NdJ("ngModelChange",function(_e){return et.powerRange.lower=_e}),y.qZA()(),y.TgZ(47,"ion-note",11),y._uU(48,"Max. Power (kW)"),y._UZ(49,"br"),y.TgZ(50,"input",12),y.NdJ("ngModelChange",function(_e){return et.powerRange.upper=_e}),y.qZA()()()(),y.TgZ(51,"h2"),y._uU(52," General Settings "),y.qZA(),y.TgZ(53,"ion-item")(54,"ion-label"),y._uU(55,"Language"),y.qZA(),y.TgZ(56,"ion-select",13),y.NdJ("ngModelChange",function(_e){return et.searchSettings.Language=_e})("ionChange",function(){return et.onLanguageChange()}),y.YNc(57,dt,2,2,"ion-select-option",4),y.qZA()(),y.TgZ(58,"ion-item")(59,"ion-label"),y._uU(60),y.ALo(61,"translate"),y.qZA(),y.TgZ(62,"ion-select",14),y.NdJ("ngModelChange",function(_e){return et.searchSettings.MapType=_e})("ionChange",function(){return et.onMapTypeChange()}),y.TgZ(63,"ion-select-option",15),y._uU(64,"Road Map"),y.qZA(),y.TgZ(65,"ion-select-option",16),y._uU(66,"Satellite"),y.qZA()()(),y.TgZ(67,"ion-item")(68,"ion-label"),y._uU(69,"Enable Advanced Editor Options"),y.qZA(),y.TgZ(70,"ion-toggle",17),y.NdJ("ngModelChange",function(_e){return et.searchSettings.EnableAdvancedEditorFeatures=_e}),y.qZA()()(),y.TgZ(71,"ion-footer")(72,"ion-toolbar")(73,"ion-buttons",18)(74,"ion-button",19),y.NdJ("click",function(){return et.close()}),y._UZ(75,"ion-icon",20),y._uU(76," Close "),y.qZA()()()()),2&we&&(y.xp6(3),y.hij(" ",y.lcZ(4,26,"ocm.general.settings")," "),y.xp6(7),y.Q6J("ngIf",1==et.searchSettings.HasActiveFilters),y.xp6(2),y.Q6J("ngIf",et.isCountryFilterFeatureEnabled),y.xp6(3),y.Oqu(y.lcZ(16,28,"ocm.search.networkOperators")),y.xp6(2),y.Q6J("ngModel",et.searchSettings.OperatorList),y.xp6(1),y.Q6J("ngForOf",et.operators),y.xp6(3),y.Oqu(y.lcZ(22,30,"ocm.search.usageTypes")),y.xp6(2),y.Q6J("ngModel",et.searchSettings.UsageTypeList),y.xp6(1),y.Q6J("ngForOf",et.usageTypes),y.xp6(3),y.Oqu(y.lcZ(28,32,"ocm.search.operationalStatusTypes")),y.xp6(2),y.Q6J("ngModel",et.searchSettings.StatusTypeList),y.xp6(1),y.Q6J("ngForOf",et.statusTypes),y.xp6(3),y.Oqu(y.lcZ(34,34,"ocm.search.connectionTypes")),y.xp6(2),y.Q6J("ngModel",et.searchSettings.ConnectionTypeList),y.xp6(1),y.Q6J("ngForOf",et.connectionTypes),y.xp6(2),y.Q6J("ngModel",et.powerRange),y.xp6(8),y.Q6J("ngModel",et.powerRange.lower)("max",et.powerRange.upper),y.xp6(4),y.Q6J("ngModel",et.powerRange.upper)("max",et.maxPower)("min",et.powerRange.lower),y.xp6(6),y.Q6J("ngModel",et.searchSettings.Language),y.xp6(1),y.Q6J("ngForOf",et.languages),y.xp6(3),y.Oqu(y.lcZ(61,36,"ocm.details.location.map")),y.xp6(2),y.Q6J("ngModel",et.searchSettings.MapType),y.xp6(8),y.Q6J("ngModel",et.searchSettings.EnableAdvancedEditorFeatures))},dependencies:[Ge.sg,Ge.O5,Q.Fj,Q.wV,Q.JJ,Q.qQ,Q.Fd,Q.On,fe.YG,fe.Sm,fe.W2,fe.fr,fe.Gu,fe.gu,fe.Ie,fe.Q$,fe.q_,fe.uN,fe.I_,fe.t9,fe.n0,fe.wd,fe.ho,fe.sr,fe.w,fe.QI,be.X$,me],encapsulation:2}),Fe})()},6779:(Rn,Dt,B)=>{"use strict";B.r(Dt),B.d(Dt,{SignInModule:()=>Ie});var h=B(9492),g=B(8936),ie=B(4463),c=B(6895),Y=B(4006),se=B(201),y=B(4228),fe=B(8274);let Ie=(()=>{class Ge{}return Ge.\u0275fac=function(be){return new(be||Ge)},Ge.\u0275mod=fe.oAB({type:Ge}),Ge.\u0275inj=fe.cJS({imports:[c.ez,Y.u5,se.Pc,ie.aw,g.e,y.Bz.forChild([{path:"",component:h.F}])]}),Ge})()},9492:(Rn,Dt,B)=>{"use strict";B.d(Dt,{F:()=>Ge});var h=B(5861),g=B(7689),ie=B(3855),c=B(8274),Y=B(201),se=B(4463),y=B(4228),fe=B(6895),Ie=B(4006);let Ge=(()=>{class Q{constructor(me,Ze,he,Ke,Ae,te,Qe,Ot){this.appManager=me,this.modalController=Ze,this.translate=he,this.alertController=Ke,this.loadingController=Ae,this.logging=te,this.router=Qe,this.location=Ot,this.email=""}cancelSignIn(){this.modalController.dismiss()}performSignIn(){var me=this;return(0,h.Z)(function*(){const Ze=yield me.loadingController.create({message:"Signing In.."});yield Ze.present();let he=!1;try{yield me.appManager.api.performSignIn(me.email,me.password),Ze.dismiss(),localStorage.setItem("authResponse",JSON.stringify(me.appManager.api.authResponse)),me.appManager.isUserAuthenticated(!0),me.modalController.dismiss(),me.appManager.analytics.appEvent("Profile","SignedIn")}catch(Ke){he=!0,Ze.dismiss(),yield(yield me.alertController.create({header:"Open Charge Map",subHeader:"Email or Password not recognised",buttons:["Ok"]})).present(),me.logging.log("Error logging in:"+Ke)}})()}}return Q.\u0275fac=function(me){return new(me||Q)(c.Y36(ie.c),c.Y36(Y.IN),c.Y36(se.sK),c.Y36(Y.Br),c.Y36(Y.HT),c.Y36(g.z),c.Y36(y.F0),c.Y36(fe.Ye))},Q.\u0275cmp=c.Xpm({type:Q,selectors:[["ng-component"]],decls:37,vars:8,consts:[[1,"signin-page","ion-padding"],["item-left",""],["src","assets/images/icons/branding/AppIcon_128x128.png"],[1,"ion-padding"],["position","floating"],["type","text",3,"ngModel","ngModelChange"],["type","password",3,"ngModel","ngModelChange"],[3,"click"],["slot","secondary"],["name","close","slot","start"],["slot","primary"],["type","submit","color","primary",3,"click"],["name","log-in","slot","start"]],template:function(me,Ze){1&me&&(c.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),c._uU(3),c.ALo(4,"translate"),c.qZA()()(),c.TgZ(5,"ion-content",0)(6,"ion-avatar",1),c._UZ(7,"img",2),c.qZA(),c.TgZ(8,"p",3),c._uU(9," Sign in using your Open Charge Map account. "),c.qZA(),c.TgZ(10,"ion-list")(11,"ion-item")(12,"ion-label",4),c._uU(13,"Email"),c.qZA(),c.TgZ(14,"ion-input",5),c.NdJ("ngModelChange",function(Ke){return Ze.email=Ke}),c.qZA()(),c.TgZ(15,"ion-item")(16,"ion-label",4),c._uU(17,"Password"),c.qZA(),c.TgZ(18,"ion-input",6),c.NdJ("ngModelChange",function(Ke){return Ze.password=Ke}),c.qZA()()(),c.TgZ(19,"p"),c._uU(20,"or "),c.TgZ(21,"a",7),c.NdJ("click",function(){return Ze.appManager.launchWebPage("https://openchargemap.org/site/loginprovider/register")}),c._uU(22,"Register as New User"),c.qZA(),c._uU(23," or "),c.TgZ(24,"a",7),c.NdJ("click",function(){return Ze.appManager.launchWebPage("https://openchargemap.org/site/loginprovider/passwordreset")}),c._uU(25,"Reset your password"),c.qZA()()(),c.TgZ(26,"ion-footer")(27,"ion-toolbar")(28,"ion-buttons",8)(29,"ion-button",7),c.NdJ("click",function(){return Ze.cancelSignIn()}),c._UZ(30,"ion-icon",9),c._uU(31," Cancel"),c.qZA()(),c.TgZ(32,"ion-buttons",10)(33,"ion-button",11),c.NdJ("click",function(){return Ze.performSignIn()}),c._UZ(34,"ion-icon",12),c._uU(35),c.ALo(36,"translate"),c.qZA()()()()),2&me&&(c.xp6(3),c.hij(" ",c.lcZ(4,4,"ocm.general.signIn")," "),c.xp6(11),c.Q6J("ngModel",Ze.email),c.xp6(4),c.Q6J("ngModel",Ze.password),c.xp6(17),c.hij(" ",c.lcZ(36,6,"ocm.general.signIn"),""))},dependencies:[Ie.JJ,Ie.On,Y.BJ,Y.YG,Y.Sm,Y.W2,Y.fr,Y.Gu,Y.gu,Y.pK,Y.Ie,Y.Q$,Y.q_,Y.wd,Y.sr,Y.j9,se.X$],encapsulation:2}),Q})()},7814:(Rn,Dt,B)=>{"use strict";B.d(Dt,{l:()=>fe});var h=B(5861),g=B(7689),ie=B(6799),c=B(8649),Y=B(529),se=B(2340),y=B(8274);let fe=(()=>{class Ie{constructor(Q,be,me){this.http=Q,this.refData=be,this.logging=me,this.serviceBase="https://api.openchargemap.io",this.serviceBaseURL=this.serviceBase+"/v3",this.hasAuthorizationError=!1,this.ATTRIBUTION_METADATAFIELDID=4,this.clientName="ocm.api.default",this.allowMirror=!1,this.lastPOIApiCallURL="",this.serviceBaseURL=se.N.apiBase+"/v3"}getNumberListString(Q){let be="";for(let me=0;me<Q.length;me++)be+=Q[me],me<Q.length&&(be+=",");return be}fetchPOIListByParam(Q){var be=this;return(0,h.Z)(function*(){const me=be.serviceBaseURL+"/poi/?client="+be.clientName+(be.allowMirror?" &allowmirror=true":"")+"&verbose=false&output=json";Q.compact=!0;let Ze="";null!=Q.countryCode&&(Ze+="&countrycode="+Q.countryCode),null!=Q.latitude&&(Ze+="&latitude="+Q.latitude),null!=Q.longitude&&(Ze+="&longitude="+Q.longitude),null!=Q.distance&&(Ze+="&distance="+Q.distance),null!=Q.distanceUnit&&(Ze+="&distanceunit="+Q.distanceUnit),null!=Q.includeComments&&(Ze+="&includecomments="+Q.includeComments),null!=Q.maxResults&&(Ze+="&maxresults="+Q.maxResults),null!=Q.countryIdList&&(Ze+="&countryid="+be.getNumberListString(Q.countryIdList)),null!=Q.levelIdList&&(Ze+="&levelid="+be.getNumberListString(Q.levelIdList)),null!=Q.connectionTypeIdList&&Q.connectionTypeIdList.length>0&&(Ze+="&connectiontypeid="+be.getNumberListString(Q.connectionTypeIdList)),null!=Q.operatorIdList&&Q.operatorIdList.length>0&&(Ze+="&operatorid="+be.getNumberListString(Q.operatorIdList)),null!=Q.usageTypeIdList&&Q.usageTypeIdList.length>0&&(Ze+="&usagetypeid="+be.getNumberListString(Q.usageTypeIdList)),null!=Q.statusTypeIdList&&Q.statusTypeIdList.length>0&&(Ze+="&statustypeid="+be.getNumberListString(Q.statusTypeIdList)),null!=Q.locationTitle&&(Ze+="&locationtitle="+Q.locationTitle),null!=Q.minPowerKW&&Q.minPowerKW>0&&(Ze+="&minpowerkw="+Q.minPowerKW),null!=Q.maxPowerKW&&Q.maxPowerKW>0&&(Ze+="&maxpowerkw="+Q.maxPowerKW),null!=Q.submissionStatusTypeIdList&&(Ze+="&submissionstatustypeid="+be.getNumberListString(Q.submissionStatusTypeIdList)),null!=Q.poiIdList&&Q.poiIdList.length>0&&(Ze+="&chargepointid="+be.getNumberListString(Q.poiIdList)),0==Q.enableCaching&&(Ze+="&enablecaching=false"),null!=Q.compact&&(Ze+="&compact="+Q.compact),Q.levelOfDetail>1&&(Ze+="&levelofdetail="+Q.levelOfDetail),null!=Q.polyline&&(Ze+="&polyline="+Q.polyline),null!=Q.boundingbox&&(Ze+="&boundingbox="+Q.boundingbox),null!=Q.additionalParams&&(Ze+="&"+Q.additionalParams);const he=me+Ze;if(be.lastPOIApiCallURL===he&&0!=Q.enableCaching)return be.logging.log("Skipped API call due to same query being repeated."),[];be.lastPOIApiCallURL=he,be.logging.log("API Call:"+he,g.i.VERBOSE);try{let Ke=yield be.http.get(he,be.getHttpRequestOptions()).toPromise();return be.refData.hydrateCompactPOIList(Ke)}catch(Ke){const Ae=Ke.message||"Could not fetch POI list from server.";throw be.logging.log("API Client: "+JSON.stringify(Ke),g.i.ERROR),Ae}})()}getHttpRequestOptions(Q=!0){let be=new Y.WM;return Q&&(be=be.append("Content-Type","application/json")),this.authResponse&&this.authResponse.Data&&this.authResponse.Data.access_token&&(be=be.append("Authorization","Bearer "+this.authResponse.Data.access_token)),be=be.append("X-API-Key",se.N.apiKey),{headers:be}}fetchCoreReferenceData(Q){let be=this.serviceBaseURL+"/referencedata/?client="+this.clientName+"&output=json"+(this.allowMirror?"&allowmirror=true":"")+"&verbose=false&compact=true";return null!=Q&&null!=Q.CountryIds&&(be+="&countryid="+this.getNumberListString(Q.CountryIds)),this.logging.log("API Call:"+be,g.i.VERBOSE),this.http.get(be,this.getHttpRequestOptions())}performSignIn(Q,be){return this.http.post(this.serviceBaseURL+"/profile/authenticate/",JSON.stringify({emailaddress:Q,password:be}),this.getHttpRequestOptions()).toPromise().then(he=>(this.authResponse=he,this.authResponse))}performSubmission(Q,be){return Q===c.q.POI?this.submitPOI(be):Q===c.q.Comment?this.submitUserComment(be):Q===c.q.Media?this.submitMediaItem(be):void 0}submitUserComment(Q){const be=JSON.stringify(Q);return this.logging.log("[api] Submitting user comment"),this.http.post(this.serviceBaseURL+"/comment/",be,this.getHttpRequestOptions()).toPromise()}submitMediaItem(Q){const be=JSON.stringify(Q);return this.http.post(this.serviceBaseURL+"/mediaitem/",be,this.getHttpRequestOptions()).toPromise()}submitPOI(Q){const be=JSON.stringify(Q);return this.http.post(this.serviceBaseURL+"/poi/",be,this.getHttpRequestOptions()).toPromise()}getPanoramioLocationPhotos(Q){return new Promise(be=>{const Ze="https://www.panoramio.com/map/get_panoramas.php?set=public&from=0&to=2&minx="+(Q.longitude-.001)+"&miny="+(Q.latitude-.001)+"&maxx="+(Q.longitude+.001)+"maxy="+(Q.latitude+.001)+"&size=medium&mapfilter=true&callback=?";return console.log(Ze),this.http.get(Ze).toPromise()})}fetchReverseGeocodeResult(Q,be){return this.http.get(this.serviceBaseURL+"/geocode/?client="+this.clientName+"&output=json&camelcase=false&latitude="+Q+"&longitude="+be,this.getHttpRequestOptions()).toPromise()}isLocalStorageAvailable(){return typeof window.localStorage<"u"}setCachedDataObject(Q,be){this.isLocalStorageAvailable()&&(typeof be>"u"&&(be=null),null===be?localStorage.removeItem(Q):localStorage.setItem(Q,JSON.stringify(be)))}getCachedDataObject(Q){if(this.isLocalStorageAvailable()){const be=localStorage.getItem(Q);if(null!=be&&be.length>0)return JSON.parse(be)}return null}}return Ie.\u0275fac=function(Q){return new(Q||Ie)(y.LFG(Y.eN),y.LFG(ie.W),y.LFG(g.z))},Ie.\u0275prov=y.Yz7({token:Ie,factory:Ie.\u0275fac,providedIn:"root"}),Ie})()},56:(Rn,Dt,B)=>{"use strict";B.d(Dt,{c:()=>Y});var h=B(5861),g=B(7689),ie=B(8274),c=B(201);let Y=(()=>{class se{constructor(fe,Ie){this.logger=fe,this.platform=Ie,this.isCordova=!1,this.ga=null,this.isCordova=!(!Ie.is("cordova")&&!Ie.is("capacitor"))}init(fe){var Ie=this;return(0,h.Z)(function*(){Ie.isCordova&&Ie.ga?yield Ie.ga.startTrackerWithId(fe):Ie.logger.log("Could not initialise analytics")})()}setAppVersion(fe){var Ie=this;return(0,h.Z)(function*(){if(Ie.isCordova&&Ie.ga)return Ie.ga.setAppVersion(fe);Ie.logger.log(fe)})()}appEvent(fe,Ie){var Ge=this;return(0,h.Z)(function*(){if(Ge.isCordova&&Ge.ga)return Ge.ga.trackEvent(fe,Ie);Ge.logger.log(Ie)})()}viewEvent(fe){var Ie=this;return(0,h.Z)(function*(){if(Ie.isCordova&&Ie.ga)return Ie.ga.trackView(fe);Ie.logger.log(fe)})()}}return se.\u0275fac=function(fe){return new(fe||se)(ie.LFG(g.z),ie.LFG(c.t4))},se.\u0275prov=ie.Yz7({token:se,factory:se.\u0275fac,providedIn:"root"}),se})()},3855:(Rn,Dt,B)=>{"use strict";B.d(Dt,{c:()=>Qe});var h=B(5861),g=B(7689),ie=B(7814),c=B(7627),Y=B(4120),se=B(8649),y=B(6799),fe=B(3912),Ie=B(56),Ge=B(2340),Q=B(8274),be=B(529),me=B(6260);class Ze{constructor(dt,ye){this.SubmissionType=dt,this.Data=ye,this.DateQueued=new Date,this.IsSubmitted=!1,this.IsInProgress=!1,this.IsCancelled=!1,this.IsFailure=!1,this.Attempts=0,this.ID=new Date+"_"+100*Math.random()}}let he=(()=>{class Ot{constructor(ye){this.events=ye,this.isQueueProcessing=!1}setAppManager(ye){this.appManager=ye}add(ye,Fe){let Ne=this.getQueueItems();Ne.push(new Ze(ye,Fe)),this.saveQueueItems(Ne)}update(ye){let Fe=this.getQueueItems(),Ne=new Array;return Fe.forEach(we=>{Ne.push(we.ID==ye.ID?ye:we)}),Ne}processNextQueueItem(){let ye=this.getNextQueueItem();null!=ye&&null!=this.appManager&&this.appManager.api.performSubmission(ye.SubmissionType,ye.Data).then(()=>{ye.IsSubmitted=!0,ye.Attempts++,this.update(ye),this.clear()})}getNextQueueItem(){let ye=this.getQueueItems(),Fe=null;return ye.forEach(Ne=>{null==Fe&&!Ne.IsCancelled&&!Ne.IsInProgress&&!Ne.IsSubmitted&&(Fe=Ne)}),Fe}hasPendingItems(){let ye=!1;return this.getQueueItems().forEach(Ne=>{!Ne.IsFailure&&!Ne.IsCancelled&&!Ne.IsSubmitted&&(ye=!0)}),ye}isCompleted(){let ye=this.getQueueItems(),Fe=!0;return ye.forEach(Ne=>{(Ne.IsInProgress||Ne.IsFailure)&&(Fe=!1)}),Fe}clear(ye=!1){let Fe=this.getQueueItems(),Ne=new Array;ye||Fe.forEach(we=>{(we.IsInProgress||we.IsFailure)&&Ne.push(we)}),this.saveQueueItems(Ne)}saveQueueItems(ye){localStorage.setItem("submissionQueue",JSON.stringify(ye))}getQueueItems(){let ye=localStorage.getItem("submissionQueue");return null!=ye?JSON.parse(ye):new Array}}return Ot.\u0275fac=function(ye){return new(ye||Ot)(Q.LFG(me.z))},Ot.\u0275prov=Q.Yz7({token:Ot,factory:Ot.\u0275fac,providedIn:"root"}),Ot})();var Ke=B(201),Ae=B(4463),te=B(3175);let Qe=(()=>{class Ot{constructor(ye,Fe,Ne,we,et,Je,_e,pe,ae,Ee,vt,Et,qt){this.http=ye,this.events=Fe,this.api=Ne,this.submissionQueue=we,this.platform=et,this.referenceDataManager=Je,this.journeyManager=_e,this.translateService=pe,this.toastController=ae,this.loadingController=Ee,this.jwtHelper=vt,this.logging=Et,this.analytics=qt,this.isRequestInProgress=!1,this.title="Open Charge Map",this._isUserAuthenticated=null,this.isEmbeddedMode=!1,this.isOffline=!1,this.api.clientName="ocm.app.ionic."+Ge.N.version,this.isDebugMode=!1,this.enableSubmissionQueue=!1,this.submissionQueue.setAppManager(this),this.platformMode=et.is("cordova")?"cordova":"web",this.initAppManager(),this.searchSettings=new c.N,this.loadSearchSettings(),this.applyURLQueryStringOptions(),this.searchSettings.CheckForActiveFilters(),this.journeyManager.loadJourneys()}loadSearchSettings(){if(null!=localStorage.getItem("searchSettings")){this.searchSettings=new c.N;try{let ye=JSON.parse(localStorage.getItem("searchSettings"));Object.assign(this.searchSettings,ye)}catch{}}}savePushRegistration(ye){localStorage.setItem("_pushToken",ye.toString())}getPushRegistration(){localStorage.getItem("_pushToken")}getQueryVariable(ye){let Ne=window.location.search.substring(1).split("&");for(let we=0;we<Ne.length;we++){let et=Ne[we].split("=");if(decodeURIComponent(et[0])==ye)return et[1].split(",").map(pe=>decodeURIComponent(pe))}return null}applyURLQueryStringOptions(){if(this.getQueryVariable("mode")&&"embedded"==this.getQueryVariable("mode")[0]&&(this.isEmbeddedMode=!0),this.getQueryVariable("operatorid")){let ye=this.getQueryVariable("operatorid");for(let Fe of ye)this.searchSettings.OperatorList.unshift(parseInt(Fe,10))}if(this.getQueryVariable("latitude")&&this.getQueryVariable("longitude")){let ye=this.getQueryVariable("latitude")[0],Fe=this.getQueryVariable("longitude")[0];this.searchSettings.StartSearchPosition=new Y.wC(parseFloat(ye),parseFloat(Fe))}this.getQueryVariable("title")&&(this.title=this.getQueryVariable("title")[0]),this.getQueryVariable("languagecode")&&this.setLanguage(this.getQueryVariable("languagecode")[0])}saveSearchSettings(){this.searchSettings.CheckForActiveFilters(),localStorage.setItem("searchSettings",JSON.stringify(this.searchSettings))}getLanguages(){return[{code:"ar",title:"\u0627\u0644\u0639\u0631\u0628\u064a\u0629 / Arabic"},{code:"bg",title:"Bulgarian / \u0411\u044a\u043b\u0433\u0430\u0440\u0441\u043a\u0438"},{code:"cs",title:"Czech / \u010ce\u0161tina"},{code:"de",title:"German / Deutsch"},{code:"el",title:"Greek / \u0395\u03bb\u03bb\u03b7\u03bd\u03b9\u03ba\u03ae"},{code:"en",title:"English"},{code:"es",title:"Spanish / Espa\xf1ol"},{code:"et",title:"Estonian / Eesti"},{code:"fi",title:"Finnish / Suomi"},{code:"fr",title:"French / Fran\xe7ais"},{code:"fy",title:"West Frisian / Frysk"},{code:"hu",title:"Hungarian / Magyar"},{code:"it",title:"Italian / Italiano"},{code:"ja",title:"Japanese / \u65e5\u672c\u8a9e"},{code:"lt",title:"Lithuanian / Lietuvi\u0173"},{code:"nl",title:"Dutch / Nederlands"},{code:"pt",title:"Portuguese / portugu\xeas"},{code:"ru",title:"Russian / P\u0443\u0441\u0441\u043a\u0438\u0439"},{code:"sk",title:"Slovak / Sloven\u010dina"},{code:"tr",title:"Turkish / T\xfcrk\xe7e"},{code:"zh",title:"Chinese / \u4e2d\u56fd\u7684"}]}setLanguage(ye){(null==ye||""==ye)&&(ye="en"),this.logging.log("Changing language: "+ye),this.translateService.use(ye)}initAppManager(){this.initAuthFromStorage(),this.isUserAuthenticated(!0)&&this.enableSubmissionQueue&&null!=this.submissionQueue&&this.submissionQueue.hasPendingItems()&&this.submissionQueue.processNextQueueItem()}initAuthFromStorage(){let ye=localStorage.getItem("authResponse");if(null!=ye){let Fe=JSON.parse(ye);null!=Fe.Data&&null!=Fe.Data.access_token&&(this.jwtHelper.decodeToken(Fe.Data.access_token),this.jwtHelper.isTokenExpired(Fe.Data.access_token)?localStorage.removeItem("authResponse"):(this.api.authResponse=Fe,this.logging.log("User has valid auth token in local storage",g.i.VERBOSE)))}}isUserAuthenticated(ye=!1){return!1===ye&&null!=this._isUserAuthenticated||(this._isUserAuthenticated=!1,null!=this.api.authResponse&&(this.jwtHelper.isTokenExpired(this.api.authResponse.Data.access_token)||(this._isUserAuthenticated=!0))),this._isUserAuthenticated}getCurrentAuthToken(){return null!=this.api.authResponse?this.api.authResponse.Data.access_token:null}getUserProfile(){return null!=this.api.authResponse?this.api.authResponse.Data.UserProfile:null}signOutCurrentUser(){localStorage.removeItem("authResponse"),this.api.authResponse=null,this._isUserAuthenticated=!1}submitComment(ye){if(!this.enableSubmissionQueue)return this.api.performSubmission(se.q.Comment,ye);this.submissionQueue.add(se.q.Comment,ye),this.submissionQueue.processNextQueueItem()}submitMediaItem(ye){if(!this.enableSubmissionQueue)return this.api.performSubmission(se.q.Media,ye);this.submissionQueue.add(se.q.Media,ye),this.submissionQueue.processNextQueueItem()}submitPOI(ye){if(!this.enableSubmissionQueue)return this.api.performSubmission(se.q.POI,ye);this.submissionQueue.add(se.q.POI,ye),this.submissionQueue.processNextQueueItem()}showToastNotification(ye){var Fe=this;return(0,h.Z)(function*(){yield(yield Fe.toastController.create({message:ye,duration:3e3})).present()})()}showLoadingProgress(ye){var Fe=this;return(0,h.Z)(function*(){yield(yield Fe.loadingController.create({message:ye})).present()})()}dismissLoadingProgress(){var ye=this;return(0,h.Z)(function*(){return ye.loadingController.dismiss()})()}launchOCMWebPage(ye){this.isUserAuthenticated(!0)&&(-1===ye.indexOf("?")&&(ye+="?"),ye+="&auth="+this.getCurrentAuthToken()),ye="https://openchargemap.org/site"+ye,window.open(ye,"_system")}launchWebPage(ye){window.open(ye,"_system")}isPlatform(ye){return this.platform.is(ye)}}return Ot.\u0275fac=function(ye){return new(ye||Ot)(Q.LFG(be.eN),Q.LFG(me.z),Q.LFG(ie.l),Q.LFG(he),Q.LFG(Ke.t4),Q.LFG(y.W),Q.LFG(fe.i),Q.LFG(Ae.sK),Q.LFG(Ke.yF),Q.LFG(Ke.HT),Q.LFG(te.N0),Q.LFG(g.z),Q.LFG(Ie.c))},Ot.\u0275prov=Q.Yz7({token:Ot,factory:Ot.\u0275fac,providedIn:"root"}),Ot})()},6260:(Rn,Dt,B)=>{"use strict";B.d(Dt,{z:()=>g});var h=B(8274);let g=(()=>{class ie{constructor(){this.c=new Map}subscribe(Y,...se){let y=this.c.get(Y);y||this.c.set(Y,y=[]),y.push(...se)}unsubscribe(Y,se){if(!se)return this.c.delete(Y);const y=this.c.get(Y);if(!y)return!1;const fe=y.indexOf(se);return!(fe<0||(y.splice(fe,1),0===y.length&&this.c.delete(Y),0))}publish(Y,...se){const y=this.c.get(Y);return y?y.map(fe=>{try{return fe(...se)}catch(Ie){return console.error(Ie),null}}):null}}return ie.\u0275fac=function(Y){return new(Y||ie)},ie.\u0275prov=h.Yz7({token:ie,factory:ie.\u0275fac,providedIn:"root"}),ie})()},3912:(Rn,Dt,B)=>{"use strict";B.d(Dt,{i:()=>fe});var h=B(7689),g=B(7814),ie=B(9698),c=B(8016),Y=B(129),se=B(4120),y=B(8274);let fe=(()=>{class Ie{constructor(Q,be,me){this.api=Q,this.poiManager=be,this.logging=me,this.journeys=[],this.favourites=[]}loadJourneys(){let Q=localStorage.getItem("journeys");if(null!=Q&&(this.journeys=JSON.parse(Q)),null!=this.journeys)for(let be of this.journeys)this.fetchAllJourneyPOIDetails(be)}fetchAllJourneyPOIDetails(Q){this.logging.log("Journeys - fetching poi details for Journey "+Q.Title);let be=new c.b;be.poiIdList=[];for(let me of Q.Stages)for(let Ze of me.WayPoints)for(let he of Ze.PoiIDs)be.poiIdList.push(he);this.api.fetchPOIListByParam(be).then(me=>{for(let Ze of me)this.updateStoredPOI(Ze)})}updateStoredPOI(Q){if(this.journeys.forEach(be=>{be.Stages.forEach(me=>{me.WayPoints.forEach(Ze=>{Ze.PoiIDs.forEach(he=>{if(he==Q.ID)if(null==Ze.PoiList){Ze.PoiList=[];let Ke=new Y.Qp("charging",1);Ke.Poi=Q,Ke.PoiID=Q.ID,Ze.PoiList.push(Ke)}else for(let Ke of Ze.PoiList)Ke.PoiID==Q.ID&&(Ke.Poi=Q)})})})}),null!=this.favourites)for(let be of this.favourites)"charging"==be.Type&&be.PoiID==Q.ID&&(be.Poi=Q)}saveJourneys(){let Q=JSON.parse(JSON.stringify(this.journeys));for(let me of Q)for(const Ze of me.Stages)for(let he of Ze.WayPoints)for(let Ke of he.PoiList)Ke.Poi=null,Ke.Photos=null;const be=JSON.stringify(Q);localStorage.setItem("journeys",be)}addJourney(Q,be){let me=new Y.vw;me.Title="Stage 1",null!=be&&me.WayPoints.push(be),Q.Stages.push(me),this.journeys.push(Q)}deleteJourney(Q){this.journeys=this.journeys.filter(be=>be.ID!=Q),this.saveJourneys()}getJourney(Q){let be=this.journeys.filter(me=>me.ID==Q);return be.length>0?be[0]:null}getJourneyStages(Q){return this.getJourney(Q).Stages}addJourneyWaypoint(Q,be,me){let Ze=this.getJourney(Q);if(null==be){let he=new Y.vw;he.Title="Stage "+(Ze.Stages.length+1),he.WayPoints.push(me),Ze.Stages.push(he)}else{let he=Ze.Stages[be];null==he.WayPoints&&(he.WayPoints=[]),he.WayPoints.push(me)}}addJourneyStage(Q,be){return this.getJourney(Q).Stages.push(be)-1}setupTestJourneys(){this.journeys=[];let Q=new Y.fw;Q.Title="New York to Brooklyn",Q.Notes="A little jaunt to Brooklyn",Q.Stages=[];let be=new Y.vw,me=new Y.kA;me.Notes="Starting point",me.Position=new se.wC(40,1.2),me.Title="Start",be.WayPoints.push(me);let Ze=new Y.kA;Ze.Notes="Middle point",Ze.Position=new se.wC(40,1.33),Ze.Title="Middle",be.WayPoints.push(Ze);let he=new Y.kA;he.Notes="End point",he.Position=new se.wC(40,1.33),he.Title="End",be.WayPoints.push(he),Q.Stages.push(be),this.journeys.push(Q);let Ke=new Y.fw;Ke.Title="Aberdeen to London",Ke.Notes="Roadtrip",Ke.Stages=[],this.journeys.push(Ke)}calculateEnergyConsumptionkWh(Q,be,me=0,Ze){return Q*Ze}setRoutePolyline(Q){this.routePolyline=Q}getRoutePolyline(){return this.routePolyline}}return Ie.\u0275fac=function(Q){return new(Q||Ie)(y.LFG(g.l),y.LFG(ie.R),y.LFG(h.z))},Ie.\u0275prov=y.Yz7({token:Ie,factory:Ie.\u0275fac,providedIn:"root"}),Ie})()},7689:(Rn,Dt,B)=>{"use strict";B.d(Dt,{i:()=>ie,z:()=>c});var h=B(2340),g=B(8274),ie=(()=>{return(Y=ie||(ie={}))[Y.VERBOSE=0]="VERBOSE",Y[Y.INFO=1]="INFO",Y[Y.WARNING=2]="WARNING",Y[Y.ERROR=3]="ERROR",ie;var Y})();let c=(()=>{class Y{constructor(){this.logLevel=ie.VERBOSE,h.N.production&&(this.logLevel=ie.INFO)}log(y,fe=ie.VERBOSE){console&&console.log&&fe>=this.logLevel&&console.log("["+ie[fe]+"] {"+(new Date).toLocaleTimeString()+"} "+y)}}return Y.\u0275fac=function(y){return new(y||Y)},Y.\u0275prov=g.Yz7({token:Y,factory:Y.\u0275fac,providedIn:"root"}),Y})()},9698:(Rn,Dt,B)=>{"use strict";B.d(Dt,{R:()=>y});var h=B(5861),g=B(7689),ie=B(7814),c=B(56),Y=B(8274),se=B(6260);let y=(()=>{class fe{constructor(Ge,Q,be,me){this.api=Ge,this.events=Q,this.logging=be,this.analytics=me,this.isRequestInProgress=!1}refreshPOIList(Ge){var Q=this;return(0,h.Z)(function*(){try{return Q.poiList=yield Q.fetchPOIList(Ge),Q.events.publish("ocm:poiList:updated"),Q.analytics.appEvent("Search","Fetched Results"),Q.poiList.length}catch{return 0}})()}fetchPOIList(Ge){var Q=this;return(0,h.Z)(function*(){Q.isRequestInProgress=!0;try{let be=yield Q.api.fetchPOIListByParam(Ge);return Q.isRequestInProgress=!1,be&&be.length&&Q.logging.log("fetched POI list ["+be.length+"]"),be}catch{return Q.isRequestInProgress=!1,[]}})()}clearResults(){this.poiList=[],this.events.publish("ocm:poiList:cleared"),this.logging.log("clearing results after settings change",g.i.VERBOSE)}getPOIById(Ge,Q=!1,be=!1){var me=this;return(0,h.Z)(function*(){if(!be&&null!=me.poiList){const Ke=me.poiList.find(Ae=>Ae.ID==Ge);if(Ke)return Ke}const Ze={poiIdList:[Ge],enableCaching:!be,includeComments:!0},he=yield me.api.fetchPOIListByParam(Ze);return he&&he.length>0?(me.poiList&&he[0].ID==Ge&&(me.poiList=me.poiList.filter(Ke=>Ke.ID!=Ge),me.poiList.push(he[0]),me.logging.log("POI refreshed in cache "+Ge)),he[0]):null})()}}return fe.\u0275fac=function(Ge){return new(Ge||fe)(Y.LFG(ie.l),Y.LFG(se.z),Y.LFG(g.z),Y.LFG(c.c))},fe.\u0275prov=Y.Yz7({token:fe,factory:fe.\u0275fac,providedIn:"root"}),fe})()},6799:(Rn,Dt,B)=>{"use strict";B.d(Dt,{W:()=>Y});var h=B(5861),g=B(7689),ie=B(8274),c=B(529);let Y=(()=>{class se{constructor(fe,Ie){this.http=fe,this.logging=Ie,this.loadCachedRefData()}refreshReferenceData(fe){var Ie=this;return(0,h.Z)(function*(){try{const Ge=yield fe.fetchCoreReferenceData(null).toPromise();return Ie.setCoreReferenceData(Ge),Ie.setFilteredReferenceData(Ge),Ie.logging.log("Got refreshed core ref data.",g.i.VERBOSE),Ie.sortCoreReferenceData(),Ie.cacheCurrentRefData(),!0}catch(Ge){return Ie.logging.log("Error fetching core ref data:"+Ge),!1}})()}refreshFilteredReferenceData(fe,Ie){fe.fetchCoreReferenceData(Ie).subscribe(Ge=>{this.setFilteredReferenceData(Ge),this.sortCoreReferenceData(),this.logging.log("Got refreshed filtered reference data.",g.i.VERBOSE)},Ge=>{this.logging.log("Error fetching filtered reference data:"+Ge)})}setCoreReferenceData(fe){this.referenceData=fe}setFilteredReferenceData(fe){this.filteredReferenceData=fe}referenceDataLoaded(){return null!=this.referenceData}getCountries(fe=!1){return 1==fe?this.filteredReferenceData.Countries:this.referenceData.Countries}getCountryByID(fe){return this.getRefDataByID(this.referenceData.Countries,fe)}getConnectionTypes(fe=!1){return 1==fe?this.filteredReferenceData.ConnectionTypes:this.referenceData.ConnectionTypes}getConnectionTypeByID(fe){return this.getRefDataByID(this.referenceData.ConnectionTypes,fe)}getUsageTypes(fe=!1){return 1==fe?this.filteredReferenceData.UsageTypes:this.referenceData.UsageTypes.filter(Ie=>Ie.ID>0)}getUsageTypeByID(fe){return this.getRefDataByID(this.referenceData.UsageTypes,fe)}getStatusTypes(fe=!1){return 1==fe?this.filteredReferenceData.StatusTypes:this.referenceData.StatusTypes.filter(Ie=>Ie.ID>0)}getStatusTypeByID(fe){return this.getRefDataByID(this.referenceData.StatusTypes,fe)}getNetworkOperators(fe=!1){return 1==fe?this.filteredReferenceData.Operators:this.referenceData.Operators}getNetworkOperatorByID(fe){return this.getRefDataByID(this.referenceData.Operators,fe)}getDataProviders(fe=!1){return 1==fe?this.filteredReferenceData.DataProviders:this.referenceData.DataProviders}getDataProviderByID(fe){return this.getRefDataByID(this.referenceData.DataProviders,fe)}getCheckinStatusTypes(fe=!1,Ie=!0){let Ge=null;return Ge=1==fe?this.filteredReferenceData.CheckinStatusTypes:this.referenceData.CheckinStatusTypes,Ie&&(Ge=Ge.filter(Q=>!1===Q.IsAutomatedCheckin)),Ge}getCheckinStatusTypeByID(fe){return this.getRefDataByID(this.referenceData.CheckinStatusTypes,fe)}getCommentTypes(fe=!1,Ie=!0){let Ge;return Ge=1==fe?this.filteredReferenceData.UserCommentTypes:this.referenceData.UserCommentTypes,Ie&&(Ge=Ge.filter(Q=>100!==Q.ID&&110!==Q.ID)),Ge}getCommentTypeByID(fe){return this.getRefDataByID(this.referenceData.UserCommentTypes,fe)}getSubmissionStatusTypes(fe=!1){return 1==fe?this.filteredReferenceData.SubmissionStatusTypes:this.referenceData.SubmissionStatusTypes}getSubmissionStatusTypesByID(fe){return this.getRefDataByID(this.referenceData.SubmissionStatusTypes,fe)}getChargingLevelTypes(fe=!1){return 1==fe?this.filteredReferenceData.ChargerTypes:this.referenceData.ChargerTypes}getChargingLevelTypeByID(fe){return this.getRefDataByID(this.referenceData.ChargerTypes,fe)}getOutputCurrentTypes(fe=!1){return fe?this.referenceData.CurrentTypes:this.filteredReferenceData.CurrentTypes}getOutputCurrentTypeByID(fe){return this.getRefDataByID(this.referenceData.CurrentTypes,fe)}loadCachedRefData(){const fe=localStorage.getItem("referenceData");if(null==fe)this.http.get("./assets/data/CoreReferenceData.json").subscribe(Ie=>{this.logging.log("Using bundled reference data as cached ref data."),this.setCoreReferenceData(Ie),this.setFilteredReferenceData(Ie)});else{let Ie=JSON.parse(fe);this.setCoreReferenceData(Ie)}this.setFilteredReferenceData(this.referenceData)}cacheCurrentRefData(){null!=this.referenceData&&(this.referenceData.CacheDate=new Date,localStorage.setItem("referenceData",JSON.stringify(this.referenceData)))}getRefDataByID(fe,Ie){if(""!==Ie&&(Ie=parseInt(Ie,10)),null!=fe)for(let Ge=0;Ge<fe.length;Ge++)if(fe[Ge].ID===Ie)return fe[Ge];return null}sortCoreReferenceData(){this.sortReferenceData(this.referenceData.ConnectionTypes),this.sortReferenceData(this.referenceData.Countries),this.sortReferenceData(this.referenceData.Operators),this.sortReferenceData(this.referenceData.DataProviders),this.sortReferenceData(this.referenceData.UsageTypes),this.sortReferenceData(this.referenceData.StatusTypes),this.sortReferenceData(this.referenceData.CheckinStatusTypes),this.sortReferenceData(this.referenceData.SubmissionStatusTypes),this.filteredReferenceData&&(this.sortReferenceData(this.filteredReferenceData.ConnectionTypes),this.sortReferenceData(this.filteredReferenceData.Operators))}sortReferenceData(fe){fe.sort(this.sortListByTitle)}sortListByTitle(fe,Ie){return fe.Title<Ie.Title?-1:fe.Title>Ie.Title?1:0}getMetadataValueByMetadataFieldID(fe,Ie){if(""!==Ie&&(Ie=parseInt(Ie,10)),null!=fe)for(let Ge=0;Ge<fe.length;Ge++)if(fe[Ge].ID===Ie)return fe[Ge];return null}hydrateCompactPOI(fe,Ie=!1){const Ge=this;if(null!=fe.DataProviderID&&(Ie||null==fe.DataProvider)&&(fe.DataProvider=Ge.getDataProviderByID(fe.DataProviderID)),null!=fe.OperatorID&&(Ie||null==fe.OperatorInfo)&&(fe.OperatorInfo=Ge.getNetworkOperatorByID(fe.OperatorID)),null!=fe.UsageTypeID&&(Ie||null==fe.UsageType)&&(fe.UsageType=Ge.getUsageTypeByID(fe.UsageTypeID)),null!=fe.AddressInfo.CountryID&&(Ie||null==fe.AddressInfo.Country)&&(fe.AddressInfo.Country=Ge.getCountryByID(fe.AddressInfo.CountryID)),null!=fe.StatusTypeID&&(Ie||null==fe.StatusType)&&(fe.StatusType=Ge.getStatusTypeByID(fe.StatusTypeID)),null!=fe.SubmissionStatusTypeID&&(Ie||null==fe.SubmissionStatusType)&&(fe.SubmissionStatusType=Ge.getSubmissionStatusTypesByID(fe.SubmissionStatusTypeID)),null!=fe.Connections)for(let Q=0;Q<fe.Connections.length;Q++){const be=fe.Connections[Q];null!=be.ConnectionTypeID&&(Ie||null==be.ConnectionType)&&(be.ConnectionType=Ge.getConnectionTypeByID(be.ConnectionTypeID)),null!=be.LevelID&&(Ie||null==be.Level)&&(be.Level=Ge.getChargingLevelTypeByID(be.LevelID)),null!=be.CurrentTypeID&&(Ie||null==be.CurrentType)&&(be.CurrentType=Ge.getOutputCurrentTypeByID(be.CurrentTypeID)),null!=be.StatusTypeID&&(Ie||null==be.StatusType)&&(be.StatusType=Ge.getStatusTypeByID(be.StatusTypeID)),fe.Connections[Q]=be}if(null!=fe.UserComments)for(let Q=0;Q<fe.UserComments.length;Q++){const be=fe.UserComments[Q];null!=be.CommentTypeID&&(Ie||null==be.CommentType)&&(be.CommentType=Ge.getCommentTypeByID(be.CommentTypeID)),null!=be.CheckinStatusTypeID&&(Ie||null==be.CheckinStatusType)&&(be.CheckinStatusType=Ge.getCheckinStatusTypeByID(be.CheckinStatusTypeID)),fe.UserComments[Q]=be}return fe}hydrateCompactPOIList(fe){for(let Ie=0;Ie<fe.length;Ie++)fe[Ie]=this.hydrateCompactPOI(fe[Ie]);return fe}}return se.\u0275fac=function(fe){return new(fe||se)(ie.LFG(c.eN),ie.LFG(g.z))},se.\u0275prov=ie.Yz7({token:se,factory:se.\u0275fac,providedIn:"root"}),se})()},4781:(Rn,Dt,B)=>{"use strict";B.d(Dt,{v:()=>Ke});var h=B(553),g=B(5906),ie=B(6579),c=B(7689),Y=B(5861),se=B(9751),y=B(4120),fe=B(2340),Ie=B(4209);class Ge{constructor(te,Qe){this.events=te,this.logging=Qe,this.events=te,this.mapAPIType=g.b.MAPKIT_JS,this.mapReady=!1,this.markerList=new Map,this.mapkitUtils=new Q}initAPI(){mapkit&&mapkit.init({authorizationCallback:function(te){te(fe.N.mapKitToken)}})}disposeMap(){}initMap(te,Qe,Ot){this.mapCanvasID=te;let dt=!0;if(dt=!(typeof mapkit>"u"),!dt)return this.logging.log("Call to initMap before API is ready:"+g.b[this.mapAPIType],c.i.ERROR),this.mapReady=!1,!1;this.initAPI(),null==this.map&&(document.getElementById(te),this.map=new mapkit.Map(te),this.map.annotationForCluster=function(Fe){"poi"===Fe.clusteringIdentifier&&(Fe.title="Charging Location",Fe.subtitle=Fe.memberAnnotations.reduce((Ne,we)=>Ne+we.population,0))},this.mapReady=!0,mapkit.addEventListener("configuration-change",Fe=>{this.events.publish("ocm:mapping:ready")}),this.map.addEventListener("scroll-end",Fe=>{this.events.publish("ocm:mapping:dragend")}),this.map.addEventListener("zoom-end",Fe=>{this.events.publish("ocm:mapping:zoom")}))}clearMarkers(){null!=this.markerList&&this.markerList.forEach((te,Qe)=>{try{this.map.removeAnnotation(Qe)}catch{}}),this.markerList=new Map}showPOIListOnMap(te,Qe){let Fe=0,we=0==this.markerList.size;if(null!=te){let Je=[];for(let _e=0;_e<te.length;_e++)if(null!=te[_e].AddressInfo&&null!=te[_e].AddressInfo.Latitude&&null!=te[_e].AddressInfo.Longitude){let pe=te[_e],ae=!0;if(null!=this.markerList&&this.markerList.has(pe.ID)&&(ae=!1),ae){let Ee=null;Ee=ie.c.getIconForPOI(pe);let Ft="OCM-"+pe.ID+": "+pe.AddressInfo.Title+":";null!=pe.UsageType&&(Ft+=" "+pe.UsageType.Title),null!=pe.StatusType&&(Ft+=" "+pe.StatusType.Title);const xt=new mapkit.Coordinate(pe.AddressInfo.Latitude,pe.AddressInfo.Longitude);let Pt=new mapkit.ImageAnnotation(xt,{title:Ft,size:{width:34,height:50},url:{1:Ee},clusteringIdentifier:"poi"});Pt.poi=pe,Pt.addEventListener("select",bt=>{const ct=bt.target.poi;this.events.publish("ocm:poi:selected",{poi:ct,poiId:ct.ID})}),this.markerList.set(pe.ID,Pt),Je.push(Pt),Fe++}}Je.length>0&&(this.map.addAnnotations(Je),we&&this.map.showItems(Je,{animate:!0,padding:new mapkit.Padding(60,25,60,25)})),this.logging.log(Fe+" new map markers added out of a total "+this.markerList.size)}}refreshMapLayout(){null!=this.map&&setTimeout(()=>{this.logging.log("MapKit: refreshMapLayout",c.i.VERBOSE)},200)}setMapCenter(te,Qe){this.map&&(this.map.setCenterAnimated(new mapkit.Coordinate(te.coords.latitude,te.coords.longitude),!1),Qe&&this.setMapZoom(Qe))}getMapCenter(){return new se.y(Qe=>{if(null!=this.map){let Ot=this.map.center;null!=Ot&&(Qe.next(new y.jR(Ot.latitude,Ot.longitude)),Qe.complete())}})}setMapZoom(te){const Qe=Math.min(te,28),Ot=this.mapkitUtils.deltaFromZoomLevel(this.map,this.map.center,Math.round(Qe)),dt=new mapkit.CoordinateSpan(111*Ot.latitudeDelta,111*Ot.longitudeDelta),ye=new mapkit.CoordinateRegion(this.map.center,dt);this.map.setRegionAnimated(ye)}getMapZoom(){return new se.y(Qe=>{this.logging.log("MapKit: getMapZoom not supported",c.i.VERBOSE),Qe.next(this.map._impl.zoomLevel),Qe.complete()})}setMapType(te){this.logging.log("MapKit: skipped setting Map Type :"+te)}getMapBounds(){return new se.y(Qe=>{let Ot=new Array,dt=this.map.region.toBoundingRegion();Ot.push(new y.wC(dt.southLatitude,dt.westLongitude)),Ot.push(new y.wC(dt.northLatitude,dt.eastLongitude)),Qe.next(Ot),Qe.complete()})}moveToMapBounds(te){this.logging.log("MapKit: map bounds not implemented")}renderMap(te,Qe,Ot){return document.getElementById(this.mapCanvasID).style.height=Qe+"px",this.mapReady&&this.showPOIListOnMap(te,Ot),!0}renderPolyline(te){this.clearPolyline()}clearPolyline(){null!=this.polylinePath&&this.polylinePath.setMap(null)}focusMap(){}unfocusMap(){}placeSearch(te){return(0,Y.Z)(function*(){let Qe=new mapkit.Search({getsUserLocation:!0});return new Promise(function(){var Ot=(0,Y.Z)(function*(dt,ye){let Fe=[];Qe.search(te,function(){var Ne=(0,Y.Z)(function*(we,et){we&&ye(we),Fe=[],et.places.map(Je=>{let _e=new Ie.n;_e.Title=Je.name,_e.Address=Je.formattedAddress,_e.Type="place",_e.Location=new y.wC(Je.coordinate.latitude,Je.coordinate.longitude),Fe.push(_e)}),dt(Fe)});return function(we,et){return Ne.apply(this,arguments)}}())});return function(dt,ye){return Ot.apply(this,arguments)}}())})()}addPOILayer(te){this.logging.log("Add POI Layer not implemented in this provider.")}}class Q{constructor(){this.mercatorRadius=85445659.44705395,this.mercatorOffset=268435456}longitudeToPixelSpaceX(te){return Math.round(this.mercatorOffset+this.mercatorRadius*te*Math.PI/180)}latitudeToPixelSpaceY(te){return Math.round(this.mercatorOffset-this.mercatorRadius*Math.log((1+Math.sin(te*Math.PI/180))/(1-Math.sin(te*Math.PI/180)))/2)}pixelSpaceXToLongitude(te){return(Math.round(te)-this.mercatorOffset)/this.mercatorRadius*180/Math.PI}pixelSpaceYToLatitude(te){return 180*(Math.PI/2-2*Math.atan(Math.exp((Math.round(te)-this.mercatorOffset)/this.mercatorRadius)))/Math.PI}deltaFromZoomLevel(te,Qe,Ot){let dt=this.longitudeToPixelSpaceX(Qe.longitude),ye=this.latitudeToPixelSpaceY(Qe.latitude),Ne=Math.pow(2,20-Ot),we=te.visibleMapRect.size,et=we.width*Ne,Je=we.height*Ne,_e=dt-et/2,pe=ye-Je/2,ae=this.pixelSpaceXToLongitude(_e),vt=this.pixelSpaceXToLongitude(_e+et)-ae,Et=this.pixelSpaceYToLatitude(pe);return{latitudeDelta:-1*(this.pixelSpaceYToLatitude(pe+Je)-Et),longitudeDelta:vt}}}var be=B(8274),me=B(6260),Ze=B(529);let he=(()=>{class Ae extends h.k{constructor(Qe,Ot,dt){super(Qe,Ot,dt),this.mapAPIType=g.b.MAPTILER,this.mapTileSet="https://maps.tilehosting.com/styles/streets/style.json?key=Gs9z7krALe3CGI60d5cL"}initAPI(){}}return Ae.\u0275fac=function(Qe){return new(Qe||Ae)(be.LFG(me.z),be.LFG(c.z),be.LFG(Ze.eN))},Ae.\u0275prov=be.Yz7({token:Ae,factory:Ae.\u0275fac}),Ae})(),Ke=(()=>{class Ae{constructor(Qe,Ot,dt){this.logging=Ot,this.http=dt,this.isFocused=!1,this.events=Qe,this.mapOptions=new g._,this.mapAPIReady=!1,this.mapsInitialised=!1,this.setMapAPI(this.mapOptions.mapAPI);let ye=this;this.debouncedMapPositionUpdate=ie.c.debounce(()=>{this.logging.log("signaling map position change:"),ye.mapProvider.mapReady&&ye.getMapCenter().subscribe(Fe=>{null!=Fe?(this.logging.log("Map centre/zoom changed, updating search position:"+Fe),this.updateMapCentrePos(Fe.coords.latitude,Fe.coords.longitude,!1)):this.logging.log("Map centre/zoom changed - map not ready to change centre pos:")})},300,!1)}setParentAppContext(Qe){this.parentAppContext=Qe}setMapAPI(Qe){this.mapOptions.mapAPI=Qe,this.mapOptions.mapAPI==g.b.MAPBOX&&(this.mapProvider=new h.k(this.events,this.logging,this.http)),this.mapOptions.mapAPI==g.b.MAPKIT_JS&&(this.mapProvider=new Ge(this.events,this.logging)),this.mapOptions.mapAPI==g.b.MAPTILER&&(this.mapProvider=new he(this.events,this.logging,this.http))}isMapReady(){return null!=this.mapProvider&&this.mapProvider.mapReady}externalAPILoaded(Qe){this.mapAPIReady=!0,this.logging.log("Mapping API Loaded: "+g.b[Qe])}initMap(Qe){if(!this.isMapReady())if(null!=this.mapProvider)this.mapsInitialised&&this.logging.log("initMap: Map provider already initialised"),this.logging.log("Mapping Manager: Init "+g.b[this.mapProvider.mapAPIType]),this.mapProvider.initMap(Qe,this.mapOptions,this);else{if(this.mapsInitialised)return void this.logging.log("initMap: map already initialised");this.logging.log("initMap: "+this.mapOptions.mapAPI)}}mapManipulationPerformed(Qe){this.logging.log("map manipulated:"+Qe),("drag"==Qe||"zoom"==Qe)&&this.debouncedMapPositionUpdate()}updateMapSize(){this.mapProvider&&this.mapProvider.refreshMapLayout()}updateMapCentrePos(Qe,Ot,dt,ye){dt&&null!=this.mapProvider&&this.mapProvider.setMapCenter(new y.jR(Qe,Ot),ye),this.mapOptions.mapCentre=new y.jR(Qe,Ot)}moveToMapBounds(Qe){this.mapProvider.moveToMapBounds(Qe)}refreshMapView(Qe,Ot,dt){return null!=this.mapProvider?(this.logging.log("Mapping Manager: renderMap "+g.b[this.mapProvider.mapAPIType]),this.isMapReady()?this.mapProvider.renderMap(Ot,Qe,this.parentAppContext):this.logging.log("refreshMapView: map provider not initialised..")):this.logging.log("Unsupported Map API: refreshMapView",c.i.ERROR),!0}setMapType(Qe){this.mapOptions.mapType!=Qe&&(this.mapOptions.mapType=Qe,this.isMapReady()&&null!=this.mapProvider?(this.logging.log("Changing map type:"+Qe),this.mapProvider.setMapType(Qe)):this.logging.log("Map type set, maps not initialised yet."))}unfocusMap(){this.logging.log("[mapping] Unfocus Map."),this.isFocused=!1,this.mapProvider.unfocusMap()}focusMap(){this.logging.log("[mapping] Focus Map."),this.isFocused=!0,this.mapProvider.focusMap()}getMapBounds(){return this.mapProvider.getMapBounds()}getMapZoom(){return this.mapProvider.getMapZoom()}setMapZoom(Qe){this.mapProvider.setMapZoom(Qe)}getMapCenter(){return this.mapProvider.getMapCenter()}showPOIOnStaticMap(Qe,Ot,dt=!1,ye=!1,Fe=200,Ne=200){let we=document.getElementById(Qe);if(null!=we){let Je=Ot.AddressInfo.Latitude,_e=Ot.AddressInfo.Longitude;Fe>640&&(Fe=640),Ne>640&&(Ne=640);let pe=Fe,ae=Ne,Ee="https://maps.googleapis.com/maps/api/staticmap?center="+Je+","+_e+"&zoom=14&size="+pe+"x"+ae+"&maptype=roadmap&markers=color:blue%7Clabel:A%7C"+Je+","+_e+"&sensor=false",vt="";vt+=1==dt?"<div>"+ie.c.formatMapLink(Ot,'<div><img width="'+pe+'" height="'+ae+'" src="'+Ee+'" /></div>',ye)+"</div>":'<div><img width="'+pe+'" height="'+ae+'" src="'+Ee+'" /></div>',we.innerHTML=vt}}renderPolyline(Qe){this.mapProvider.renderPolyline(Qe)}clearPolyline(){this.mapProvider.clearPolyline()}clearMarkers(){this.logging.log("mapping: clearing markers"),this.mapProvider.clearMarkers()}addPOILayer(Qe){this.mapProvider.addPOILayer(Qe)}}return Ae.\u0275fac=function(Qe){return new(Qe||Ae)(be.LFG(me.z),be.LFG(c.z),be.LFG(Ze.eN))},Ae.\u0275prov=be.Yz7({token:Ae,factory:Ae.\u0275fac,providedIn:"root"}),Ae})()},5906:(Rn,Dt,B)=>{"use strict";B.d(Dt,{_:()=>ie,b:()=>g});var h=B(2340),g=(()=>{return(c=g||(g={}))[c.GOOGLE_WEB=1]="GOOGLE_WEB",c[c.GOOGLE_NATIVE=2]="GOOGLE_NATIVE",c[c.LEAFLET=3]="LEAFLET",c[c.MAPBOX=4]="MAPBOX",c[c.MAPKIT_JS=5]="MAPKIT_JS",c[c.MAPTILER=6]="MAPTILER",g;var c})();class ie{constructor(){this.enableClustering=!1,this.resultBatchID=-1,this.useMarkerIcons=!0,this.useMarkerAnimation=!0,this.enableTrackingMapCentre=!1,this.enableSearchByWatchingLocation=!1,this.mapCentre=null,this.mapAPI=h.N.defaultMapProvider,this.mapType="ROADMAP",this.searchDistanceKM=1e5,this.mapMoveQueryRefreshMS=300,this.enableSearchRadiusIndicator=!1,this.minZoomLevel=2}}},553:(Rn,Dt,B)=>{"use strict";B.d(Dt,{k:()=>he});var h=B(5861),g=B(6579),ie=B(5906),c=B(9751),Y=B(4120),se=B(7689),y=B(9898),Ie=B(2340),Ge=B(4209),Q=B(8274),be=B(6260),me=B(529);let he=(()=>{class Ke{constructor(te,Qe,Ot){this.events=te,this.logging=Qe,this.http=Ot,this._isMapAnimating=!1,this.events=te,this.mapAPIType=ie.b.MAPBOX,this.mapReady=!1,this.markerList=new Map}initAPI(){y&&(y.accessToken=Ie.N.mapBoxToken)}disposeMap(){this.map&&(this.logging.log("Disposing map",se.i.INFO),this.map.remove())}getCurrentMapTileSet(te){return"SATELLITE"==te?"mapbox://styles/mapbox/satellite-streets-v11?optimize=true":"mapbox://styles/mapbox/streets-v11?optimize=true"}flyAroundPoint(te){if(this._isMapAnimating){this.map.rotateTo(te/100%360,{duration:0});const Qe=this;requestAnimationFrame(function(Ot){Qe.flyAroundPoint(Ot)})}}initMap(te,Qe,Ot){this.mapCanvasID=te;let dt=!0;if(dt=!(typeof y>"u"),!dt)return this.logging.log("Call to initMap before API is ready:"+ie.b[this.mapAPIType],se.i.ERROR),this.mapReady=!1,!1;if(null==this.map){let we=function(Je){return Je*(2-Je)};document.getElementById(te),this.initAPI(),this.map=new y.Map({container:te,style:this.getCurrentMapTileSet(Qe.mapType),zoom:15,attributionControl:!1}),this.map.addControl(new y.AttributionControl({compact:!0,customAttribution:["Open Charge Map Contributors"]})),this.map.addControl(new y.NavigationControl),this.mapReady=!0,this.map.getCanvas().focus();let Fe=100,Ne=25;this.map.getCanvas().addEventListener("keydown",Je=>{Je.preventDefault(),38===Je.which?this.map.panBy([0,-Fe],{easing:we}):40===Je.which?this.map.panBy([0,Fe],{easing:we}):37===Je.which?this.map.easeTo({bearing:this.map.getBearing()-Ne,easing:we}):39===Je.which?this.map.easeTo({bearing:this.map.getBearing()+Ne,easing:we}):32===Je.which&&(this._isMapAnimating?this._isMapAnimating=!1:(this._isMapAnimating=!0,this.flyAroundPoint(0)))},!0),this.map.on("load",()=>{this.events.publish("ocm:mapping:ready")});let et=g.c.debounce(()=>{this.getMapCenter().subscribe(Je=>{this.searchMarker.setLngLat(new y.LngLat(Je.coords.longitude,Je.coords.latitude))})},500,!1);this.map.on("move",()=>{this.searchMarker&&et()}),this.map.on("moveend",()=>{this.events.publish("ocm:mapping:dragend"),Qe.onMapMoveCompleted&&Qe.onMapMoveCompleted()}),this.map.on("zoomend",()=>{this.events.publish("ocm:mapping:zoom")})}}clearMarkers(){null!=this.markerList&&this.markerList.forEach((te,Qe)=>{te.remove()}),this.markerList=new Map}showPOIListOnMap(te,Qe,Ot=!0){let ye=this.map,Fe=new y.LngLatBounds,Ne=0;if(ye.getZoom(),null!=te){for(let pe=0;pe<te.length;pe++)if(null!=te[pe].AddressInfo&&null!=te[pe].AddressInfo.Latitude&&null!=te[pe].AddressInfo.Longitude){let ae=te[pe],Ee=!0;if(null!=this.markerList&&this.markerList.has(ae.ID)){Ee=!1;let vt=this.markerList.get(ae.ID);vt&&vt.poi&&vt.poi.DateLastStatusUpdate!=ae.DateLastStatusUpdate&&(vt.remove(),Ee=!0)}if(Ee){let vt=null,Et=null;Ot?(vt=document.createElement("img"),vt.src=g.c.getIconForPOI(ae),vt.width=34,vt.height=50):(vt=null,Et=g.c.getColorForPOI(ae));let Ft=(Ot?"OCM-":"EXT-")+ae.ID+": "+ae.AddressInfo.Title+":";null!=ae.UsageType&&(Ft+=" "+ae.UsageType.Title),null!=ae.StatusType&&(Ft+=" "+ae.StatusType.Title);let xt=new y.Marker({element:vt,color:Et}).setLngLat([ae.AddressInfo.Longitude,ae.AddressInfo.Latitude]).addTo(ye);xt.poi=ae;let Pt=xt.getElement();Pt.poi=ae,Pt.addEventListener("click",bt=>{const ct=bt.currentTarget.poi;this.events.publish("ocm:poi:selected",{poiId:ct.ID,poi:ct})}),Fe.extend(xt.getLngLat()),this.markerList.set(ae.ID,xt),Ne++}}this.logging.log(Ne+" new map markers added out of a total "+this.markerList.size)}if(null!=te&&te.length>0)if(null==Qe||Qe.appConfig.enableLiveMapQuerying)null==ye.getCenter()&&ye.setCenter(Fe.getCenter());else{this.logging.log("Fitting to marker bounds:"+Fe),ye.setCenter(Fe.getCenter()),this.logging.log("zoom before fit bounds:"+ye.getZoom()),ye.fitBounds(Fe);let _e=ye.getZoom();ye.setZoom(_e<6?6:_e)}}refreshMapLayout(){null!=this.map&&setTimeout(()=>{this.logging.log("MapBoxGL: refreshMapLayout",se.i.VERBOSE),this.map.resize()},200)}setMapCenter(te){this.mapReady&&(this.map.setCenter(new y.LngLat(te.coords.longitude,te.coords.latitude)),this.searchMarker||(this.searchMarker=new y.Marker({color:"#99ccff",anchor:"top"}).setLngLat(new y.LngLat(te.coords.longitude,te.coords.latitude)).addTo(this.map),this.searchMarker.getElement().addEventListener("click",()=>{let Qe=this.searchMarker.getLngLat();this.events.publish("ocm:mapping:addpoi",new Y.wC(Qe.lat,Qe.lng))})))}getMapCenter(){return new c.y(Qe=>{if(null!=this.map){let Ot=this.map.getCenter();null!=Ot&&(Qe.next(new Y.jR(Ot.lat,Ot.lng)),Qe.complete())}})}setMapZoom(te){this.map.setZoom(te)}getMapZoom(){return new c.y(Qe=>{let Ot=this.map.getZoom();Qe.next(Ot),Qe.complete()})}setMapType(te){this.map.setStyle(this.getCurrentMapTileSet(te))}getMapBounds(){return new c.y(Qe=>{let Ot=new Array,dt=this.map.getBounds();Ot.push(new Y.wC(dt.getSouthWest().lat,dt.getSouthWest().lng)),Ot.push(new Y.wC(dt.getNorthEast().lat,dt.getNorthEast().lng)),Qe.next(Ot),Qe.complete()})}moveToMapBounds(te){this.map.fitBounds(new y.LngLatBounds(new y.LngLat(te.southWest.longitude,te.southWest.latitude),new y.LngLat(te.northEast.longitude,te.northEast.latitude)))}renderMap(te,Qe,Ot){return document.getElementById(this.mapCanvasID).style.height=Qe+"px",this.mapReady&&this.showPOIListOnMap(te,Ot),!0}renderPolyline(te){this.clearPolyline()}clearPolyline(){null!=this.polylinePath&&this.polylinePath.setMap(null)}focusMap(){}unfocusMap(){}placeSearch(te,Qe,Ot){var dt=this;return(0,h.Z)(function*(){let ye=`https://api.mapbox.com/geocoding/v5/mapbox.places/${te||Ot+","+Qe}.json?access_token=${Ie.N.mapBoxToken}`;return new Promise(function(){var Fe=(0,h.Z)(function*(Ne,we){dt.http.get(ye).toPromise().then(et=>{let Je=[];Je=[],et.features&&et.features.map(_e=>{let pe=new Ge.n;pe.Title=_e.place_name,pe.Address=_e.place_name,pe.Type="place",pe.Location=new Y.wC(_e.center[1],_e.center[0]),pe.Attribution=et.attribution,Je.push(pe)}),Ne(Je)})});return function(Ne,we){return Fe.apply(this,arguments)}}())})()}addPOILayer(te){this.logging.log("Add POI Layer not implemented in this provider."),this.showPOIListOnMap(te,null,!1)}}return Ke.\u0275fac=function(te){return new(te||Ke)(Q.LFG(be.z),Q.LFG(se.z),Q.LFG(me.eN))},Ke.\u0275prov=Q.Yz7({token:Ke,factory:Ke.\u0275fac}),Ke})()},2340:(Rn,Dt,B)=>{"use strict";B.d(Dt,{N:()=>h});const h={name:"prod",version:"8.3.0",production:!0,analyticsId:"",googleMapsKey:"",mapBoxToken:"pk.eyJ1Ijoid2VicHJvZnVzaW9uIiwiYSI6ImNrdHZlc2N5dTI5Zjcydm8zYWFwc2JnbTMifQ.M7b5SOzbPcg_8XAHCOeP0w",mapKitToken:"",enableStaticMaps:!1,defaultMapProvider:4,apiBase:"https://api.openchargemap.io",apiKey:"9bb03e5b-0fb2-4916-9b2b-26c6bd27a56a",enabledFeatures:["MAP","ADD_COMMENT","ADD_PHOTO","FAVOURITES","FILTER_OPTIONS_BY_COUNTRY","ADD_POI","EDIT_POI","LAYERS"]}},659:(Rn,Dt,B)=>{"use strict";var h=B(1481),g=B(8274),ie=B(8936),c=B(4463),Y=B(6895),se=B(4006),y=B(201);let fe=(()=>{class Ht{}return Ht.\u0275fac=function(qe){return new(qe||Ht)},Ht.\u0275mod=g.oAB({type:Ht}),Ht.\u0275inj=g.cJS({imports:[Y.ez,se.u5,y.Pc,c.aw,ie.e]}),Ht})(),Ie=(()=>{class Ht{}return Ht.\u0275fac=function(qe){return new(qe||Ht)},Ht.\u0275mod=g.oAB({type:Ht}),Ht.\u0275inj=g.cJS({imports:[Y.ez,se.u5,y.Pc,c.aw,ie.e]}),Ht})(),Ge=(()=>{class Ht{}return Ht.\u0275fac=function(qe){return new(qe||Ht)},Ht.\u0275mod=g.oAB({type:Ht}),Ht.\u0275inj=g.cJS({imports:[Y.ez,se.u5,y.Pc,c.aw,ie.e]}),Ht})();var Q=B(3548),be=B(529),me=B(4228),Ze=B(3175);class he{constructor(Mt,qe="/assets/i18n/",re=".json"){this.http=Mt,this.prefix=qe,this.suffix=re}getTranslation(Mt){return this.http.get(`${this.prefix}${Mt}${this.suffix}`)}}var Ke=B(5861),Ae=B(4781),te=B(6763),Qe=B(9492),Ot=B(9741),dt=B(3855);function ye(Ht,Mt){if(1&Ht){const qe=g.EpF();g.TgZ(0,"div"),g._uU(1," You are not signed in. "),g.TgZ(2,"button",5),g.NdJ("click",function(){g.CHM(qe);const tt=g.oxw();return g.KtG(tt.showSignInModal())}),g._uU(3),g.ALo(4,"translate"),g.qZA()()}2&Ht&&(g.xp6(3),g.Oqu(g.lcZ(4,1,"ocm.general.signIn")))}function Fe(Ht,Mt){if(1&Ht&&(g.TgZ(0,"div")(1,"ion-card")(2,"ion-item")(3,"ion-avatar",6),g._UZ(4,"img",7),g.qZA(),g.TgZ(5,"h2"),g._uU(6),g.qZA()(),g.TgZ(7,"ion-card-content")(8,"p"),g._uU(9),g.qZA(),g.TgZ(10,"p"),g._uU(11),g.qZA()(),g.TgZ(12,"ion-item")(13,"ion-note",8),g._UZ(14,"ion-icon",9),g._uU(15),g.qZA()()()()),2&Ht){const qe=g.oxw();g.xp6(4),g.s9C("src",qe.userProfile.ProfileImageURL,g.LSH),g.xp6(2),g.Oqu(qe.userProfile.Username),g.xp6(3),g.hij(" ",qe.userProfile.Profile,""),g.xp6(2),g.hij(" Date Joined: ",qe.userProfile.DateCreated," "),g.xp6(4),g.hij(" ",qe.userProfile.ReputationPoints," Contributor Points ")}}let Ne=(()=>{class Ht{constructor(qe,re,tt,Wt){this.appManager=qe,this.nav=re,this.translate=tt,this.modalController=Wt}ionViewDidEnter(){this.userProfile=this.appManager.getUserProfile(),null!=this.userProfile&&this.appManager.isUserAuthenticated(!0)?this.refreshProfileView():this.showSignInModal(),this.appManager.analytics.viewEvent("Profile")}refreshProfileView(){this.userProfile=this.appManager.getUserProfile()}showSignInModal(){this.modalController.create({component:Qe.F,componentProps:{Profile:this.userProfile}}).then(qe=>{qe.onDidDismiss().then(()=>{this.refreshProfileView()}),qe.present()})}close(){this.modalController.dismiss()}}return Ht.\u0275fac=function(qe){return new(qe||Ht)(g.Y36(dt.c),g.Y36(y.SH),g.Y36(c.sK),g.Y36(y.IN))},Ht.\u0275cmp=g.Xpm({type:Ht,selectors:[["ng-component"]],decls:14,vars:5,consts:[[1,"profile-page","ion-padding"],[4,"ngIf"],["slot","end"],[3,"click"],["name","close","slot","start"],["ion-button","",3,"click"],["slot","start"],[3,"src"],["item-left",""],["name","star"]],template:function(qe,re){1&qe&&(g.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),g._uU(3),g.ALo(4,"translate"),g.qZA()()(),g.TgZ(5,"ion-content",0),g.YNc(6,ye,5,3,"div",1),g.YNc(7,Fe,16,5,"div",1),g.qZA(),g.TgZ(8,"ion-footer")(9,"ion-toolbar")(10,"ion-buttons",2)(11,"ion-button",3),g.NdJ("click",function(){return re.close()}),g._UZ(12,"ion-icon",4),g._uU(13," Close "),g.qZA()()()()),2&qe&&(g.xp6(3),g.hij(" ",g.lcZ(4,3,"ocm.navigation.profile.sectionTitle")," "),g.xp6(3),g.Q6J("ngIf",null==re.userProfile),g.xp6(1),g.Q6J("ngIf",null!=re.userProfile))},dependencies:[Y.O5,y.BJ,y.YG,y.Sm,y.PM,y.FN,y.W2,y.fr,y.Gu,y.gu,y.Ie,y.uN,y.wd,y.sr,c.X$],encapsulation:2}),Ht})();var we=B(7689),et=B(2340),Je=B(4508),_e=B(56),pe=B(6579),ae=B(388),Ee=B(6588),vt=B(7423);const Et=(0,vt.fo)("PushNotifications",{}),qt=(0,vt.fo)("StatusBar"),Ft=(0,vt.fo)("SplashScreen",{web:()=>B.e(2680).then(B.bind(B,2680)).then(Ht=>new Ht.SplashScreenWeb)}),xt=(0,vt.fo)("App",{web:()=>B.e(4477).then(B.bind(B,4477)).then(Ht=>new Ht.AppWeb)});var Pt=B(6260);function bt(Ht,Mt){if(1&Ht){const qe=g.EpF();g.TgZ(0,"ion-item",9),g.NdJ("click",function(){g.CHM(qe);const tt=g.oxw();return g.KtG(tt.openRoutePlannerModal())}),g._UZ(1,"ion-icon",12),g.TgZ(2,"ion-label"),g._uU(3," Route Planner "),g.qZA()()}}function ct(Ht,Mt){if(1&Ht){const qe=g.EpF();g.TgZ(0,"ion-item",9),g.NdJ("click",function(){g.CHM(qe);const tt=g.oxw();return g.KtG(tt.add())}),g._UZ(1,"ion-icon",13),g.TgZ(2,"ion-label"),g._uU(3),g.ALo(4,"translate"),g.qZA()()}2&Ht&&(g.xp6(3),g.hij(" ",g.lcZ(4,1,"ocm.general.addLocation")," "))}function ht(Ht,Mt){if(1&Ht){const qe=g.EpF();g.TgZ(0,"ion-item",9),g.NdJ("click",function(){g.CHM(qe);const tt=g.oxw();return g.KtG(tt.journeys())}),g._UZ(1,"ion-icon",12),g.TgZ(2,"ion-label"),g._uU(3," Journeys "),g.qZA()()}}function Ce(Ht,Mt){if(1&Ht){const qe=g.EpF();g.TgZ(0,"ion-item",9),g.NdJ("click",function(){g.CHM(qe);const tt=g.oxw();return g.KtG(tt.addLayer())}),g._UZ(1,"ion-icon",14),g.TgZ(2,"ion-label"),g._uU(3," Add Layer "),g.qZA()()}}function Ct(Ht,Mt){if(1&Ht){const qe=g.EpF();g.ynx(0),g.TgZ(1,"ion-item",9),g.NdJ("click",function(){g.CHM(qe);const tt=g.oxw();return g.KtG(tt.signIn())}),g._UZ(2,"ion-icon",15),g.TgZ(3,"ion-label"),g._uU(4),g.ALo(5,"translate"),g.qZA()(),g.BQk()}2&Ht&&(g.xp6(4),g.hij(" ",g.lcZ(5,1,"ocm.general.signIn")," "))}function Ut(Ht,Mt){if(1&Ht){const qe=g.EpF();g.ynx(0),g.TgZ(1,"ion-item",9),g.NdJ("click",function(){g.CHM(qe);const tt=g.oxw();return g.KtG(tt.profile())}),g._UZ(2,"ion-icon",15),g.TgZ(3,"ion-label"),g._uU(4),g.ALo(5,"translate"),g.qZA()(),g.TgZ(6,"ion-item",9),g.NdJ("click",function(){g.CHM(qe);const tt=g.oxw();return g.KtG(tt.signOut())}),g._UZ(7,"ion-icon",16),g.TgZ(8,"ion-label"),g._uU(9),g.ALo(10,"translate"),g._UZ(11,"br"),g.TgZ(12,"small",17),g._uU(13),g.qZA()()(),g.BQk()}if(2&Ht){const qe=g.oxw();g.xp6(4),g.hij(" ",g.lcZ(5,3,"ocm.navigation.profile.sectionTitle")," "),g.xp6(5),g.hij(" ",g.lcZ(10,5,"ocm.general.signOut")," "),g.xp6(4),g.hij(" ",qe.getUserName(),"")}}const Gt=function(){return["/search"]};let wn=(()=>{class Ht{constructor(qe,re,tt,Wt,Qt,fi,Ai,er){this.platform=qe,this.translate=re,this.mapping=tt,this.modalController=Wt,this.appManager=Qt,this.logger=fi,this.analytics=Ai,this.events=er,this.logger.log("Environment: "+et.N.name),this.initializeApp(),this.enabledFeatures=et.N.enabledFeatures,1!=Qt.searchSettings.EnableAdvancedEditorFeatures&&(this.enabledFeatures=this.enabledFeatures.filter(mi=>"LAYERS"!=mi))}configurePushNotifications(){Et.register(),Et.addListener("registration",qe=>{this.logger.log("Push registration success, token: "+qe.value),this.appManager.savePushRegistration(qe.value)}),Et.addListener("registrationError",qe=>{this.logger.log("Error on registration: "+JSON.stringify(qe))}),Et.addListener("pushNotificationReceived",qe=>{this.logger.log("Push received: "+JSON.stringify(qe),we.i.INFO)}),Et.addListener("pushNotificationActionPerformed",qe=>{this.logger.log("Push action performed: "+JSON.stringify(qe))})}isUserAuthenticated(){return this.appManager.isUserAuthenticated()}getUserName(){let qe=this.appManager.getUserProfile();return qe?qe.EmailAddress?qe.EmailAddress:qe.Username:"Not Signed In"}initializeApp(){var qe=this;this.platform.ready().then(()=>{this.platform.is("capacitor")&&(qt.show(),Ft.hide()),this.translate.addLangs(this.appManager.getLanguages().map(re=>re.code)),this.translate.setDefaultLang("en"),null!=this.appManager.searchSettings.Language?this.translate.use(this.appManager.searchSettings.Language):this.translate.currentLang||this.translate.use("en"),this.translate.get("ocm.search.performSearch").toPromise().then(re=>{}),this.analytics.init(et.N.analyticsId).then(()=>{this.analytics.setAppVersion(et.N.version),this.analytics.appEvent("Startup","App Loaded")}).catch(re=>this.logger.log("Error starting analytics")),this.events.subscribe("ocm:mapping:addpoi",function(){var re=(0,Ke.Z)(function*(tt){pe.c.isFeatureEnabled("ADD_POI")&&qe.add(tt)});return function(tt){return re.apply(this,arguments)}}()),(this.platform.is("ios")||this.platform.is("android"))&&(this.configurePushNotifications(),this.checkForAppOpenUrl())})}checkForAppOpenUrl(){return(0,Ke.Z)(function*(){xt.addListener("appUrlOpen",re=>{alert("App (re)opened with URL: "+re.url)});let qe=yield xt.getLaunchUrl();qe&&qe.url&&alert("App opened with URL: "+qe.url)})()}openRoutePlannerModal(){var qe=this;return(0,Ke.Z)(function*(){qe.mapping.unfocusMap();const re=yield qe.modalController.create({component:te.u});re.onDidDismiss().then(tt=>{qe.mapping.focusMap()}),yield re.present()})()}continueAdd(qe){var re=this;return(0,Ke.Z)(function*(){const tt=yield re.modalController.create({component:Je.Y,componentProps:{startPos:qe}});tt.onDidDismiss().then(Wt=>{re.mapping.focusMap()}),yield tt.present()})()}add(qe){var re=this;return(0,Ke.Z)(function*(){if(re.mapping.unfocusMap(),!re.appManager.isUserAuthenticated(!0)){const tt=yield re.modalController.create({component:Qe.F});return tt.onDidDismiss().then(function(){var Wt=(0,Ke.Z)(function*(Qt){re.mapping.focusMap(),re.appManager.isUserAuthenticated(!0)&&(yield re.continueAdd(qe))});return function(Qt){return Wt.apply(this,arguments)}}()),yield tt.present()}yield re.continueAdd(qe)})()}signIn(){var qe=this;return(0,Ke.Z)(function*(){qe.mapping.unfocusMap();const re=yield qe.modalController.create({component:Qe.F});return re.onDidDismiss().then(tt=>{qe.mapping.focusMap(),qe.appManager.isUserAuthenticated(!0)}),yield re.present()})()}signOut(){var qe=this;return(0,Ke.Z)(function*(){qe.appManager.signOutCurrentUser()})()}profile(){var qe=this;return(0,Ke.Z)(function*(){qe.mapping.unfocusMap();const re=yield qe.modalController.create({component:Ne});re.onDidDismiss().then(tt=>{qe.mapping.focusMap()}),yield re.present()})()}journeys(){var qe=this;return(0,Ke.Z)(function*(){qe.mapping.unfocusMap();const re=yield qe.modalController.create({component:Ot.g});re.onDidDismiss().then(tt=>{qe.mapping.focusMap()}),yield re.present()})()}addLayer(){var qe=this;return(0,Ke.Z)(function*(){const re=yield qe.modalController.create({component:Ee.A});yield re.present();const{data:tt}=yield re.onWillDismiss();tt&&qe.mapping.addPOILayer(tt)})()}about(){var qe=this;return(0,Ke.Z)(function*(){qe.mapping.unfocusMap();const re=yield qe.modalController.create({component:ae.t});re.onDidDismiss().then(tt=>{qe.mapping.focusMap()}),yield re.present()})()}}return Ht.\u0275fac=function(qe){return new(qe||Ht)(g.Y36(y.t4),g.Y36(c.sK),g.Y36(Ae.v),g.Y36(y.IN),g.Y36(dt.c),g.Y36(we.z),g.Y36(_e.c),g.Y36(Pt.z))},Ht.\u0275cmp=g.Xpm({type:Ht,selectors:[["app-root"]],decls:29,vars:17,consts:[["contentId","main-content",3,"disabled"],["contentId","main-content","swipeGesture","false"],["slot","start"],["src","assets/images/icons/branding/AppIcon_128x128.png"],["auto-hide","false"],[3,"routerDirection","routerLink"],["slot","start","name","home"],[3,"click",4,"ngIf"],[4,"ngIf"],[3,"click"],["slot","start","name","information-circle-outline"],["id","main-content"],["slot","start","name","map"],["slot","start","name","add-circle-outline"],["slot","start","name","albums"],["slot","start","name","person"],["slot","start","name","log-out"],[2,"color","#c0c0c0"]],template:function(qe,re){1&qe&&(g.TgZ(0,"ion-app")(1,"ion-split-pane",0)(2,"ion-menu",1)(3,"ion-header")(4,"ion-toolbar")(5,"ion-thumbnail",2),g._UZ(6,"img",3),g.qZA(),g.TgZ(7,"ion-title"),g._uU(8),g.qZA()()(),g.TgZ(9,"ion-content")(10,"ion-list")(11,"ion-menu-toggle",4)(12,"ion-item",5),g._UZ(13,"ion-icon",6),g.TgZ(14,"ion-label"),g._uU(15),g.ALo(16,"translate"),g.qZA()(),g.YNc(17,bt,4,0,"ion-item",7),g.YNc(18,ct,5,3,"ion-item",7),g.YNc(19,ht,4,0,"ion-item",7),g.YNc(20,Ce,4,0,"ion-item",7),g.YNc(21,Ct,6,3,"ng-container",8),g.YNc(22,Ut,14,7,"ng-container",8),g.TgZ(23,"ion-item",9),g.NdJ("click",function(){return re.about()}),g._UZ(24,"ion-icon",10),g.TgZ(25,"ion-label"),g._uU(26),g.ALo(27,"translate"),g.qZA()()()()()(),g._UZ(28,"ion-router-outlet",11),g.qZA()()),2&qe&&(g.xp6(1),g.Q6J("disabled",!0),g.xp6(7),g.Oqu(re.appManager.title),g.xp6(4),g.Q6J("routerDirection","root")("routerLink",g.DdM(16,Gt)),g.xp6(3),g.hij(" ",g.lcZ(16,12,"ocm.search.sectionTitle")," "),g.xp6(2),g.Q6J("ngIf",re.enabledFeatures.includes("ROUTE_PLANNER")),g.xp6(1),g.Q6J("ngIf",re.enabledFeatures.includes("ADD_POI")),g.xp6(1),g.Q6J("ngIf",re.enabledFeatures.includes("FAVOURITES")),g.xp6(1),g.Q6J("ngIf",re.enabledFeatures.includes("LAYERS")),g.xp6(1),g.Q6J("ngIf",!re.isUserAuthenticated()),g.xp6(1),g.Q6J("ngIf",re.isUserAuthenticated()),g.xp6(4),g.hij(" ",g.lcZ(27,14,"ocm.general.about")," "))},dependencies:[Y.O5,y.dr,y.W2,y.Gu,y.gu,y.Ie,y.Q$,y.q_,y.z0,y.zc,y.jI,y.Bs,y.wd,y.sr,y.jP,y.YI,me.rH,c.X$],encapsulation:2}),Ht})();const Fn=[{path:"",redirectTo:"search",pathMatch:"full"},{path:"search",loadChildren:()=>Promise.resolve().then(B.bind(B,3548)).then(Ht=>Ht.SearchPageModule)},{path:"journeys",loadChildren:()=>Promise.resolve().then(B.bind(B,5476)).then(Ht=>Ht.JourneysModule)},{path:"signin",loadChildren:()=>Promise.resolve().then(B.bind(B,6779)).then(Ht=>Ht.SignInModule)},{path:"poi-editor/:id",loadChildren:()=>Promise.resolve().then(B.bind(B,1948)).then(Ht=>Ht.PoiEditorPageModule)},{path:"about",loadChildren:()=>Promise.resolve().then(B.bind(B,534)).then(Ht=>Ht.AboutPageModule)},{path:"layer-editor",loadChildren:()=>Promise.resolve().then(B.bind(B,5005)).then(Ht=>Ht.LayerEditorPageModule)}];let un=(()=>{class Ht{}return Ht.\u0275fac=function(qe){return new(qe||Ht)},Ht.\u0275mod=g.oAB({type:Ht}),Ht.\u0275inj=g.cJS({imports:[me.Bz.forRoot(Fn,{useHash:!0}),me.Bz]}),Ht})(),ut=(()=>{class Ht{}return Ht.\u0275fac=function(qe){return new(qe||Ht)},Ht.\u0275mod=g.oAB({type:Ht}),Ht.\u0275inj=g.cJS({imports:[Y.ez,se.u5,y.Pc,c.aw,ie.e]}),Ht})();var jt=B(6779);let En=(()=>{class Ht{}return Ht.\u0275fac=function(qe){return new(qe||Ht)},Ht.\u0275mod=g.oAB({type:Ht}),Ht.\u0275inj=g.cJS({imports:[Y.ez,se.u5,y.Pc,c.aw,ie.e,me.Bz.forChild([{path:"",component:Ne}])]}),Ht})();var ni=B(6314);let ci=(()=>{class Ht{}return Ht.\u0275fac=function(qe){return new(qe||Ht)},Ht.\u0275mod=g.oAB({type:Ht}),Ht.\u0275inj=g.cJS({imports:[Y.ez,se.u5,y.Pc,c.aw,ie.e,me.Bz.forChild([{path:"",component:ni.N}])]}),Ht})();var Un=B(5476),_i=B(1948),wi=B(534),xi=B(5005);function Ni(){return localStorage.getItem("access_token")}function Ii(Ht){return new he(Ht,"/assets/i18n/",".json")}let Yi=(()=>{class Ht{}return Ht.\u0275fac=function(qe){return new(qe||Ht)},Ht.\u0275mod=g.oAB({type:Ht,bootstrap:[wn]}),Ht.\u0275inj=g.cJS({providers:[{provide:me.wN,useClass:y.r4}],imports:[h.b2,be.JF,c.aw.forRoot({loader:{provide:c.Zw,useFactory:Ii,deps:[be.eN]}}),y.Pc.forRoot(),un,Ze.Ar.forRoot({config:{tokenGetter:Ni}}),Q.SearchPageModule,ut,Un.JourneysModule,jt.SignInModule,Ge,fe,Ie,_i.PoiEditorPageModule,En,ci,wi.AboutPageModule,xi.LayerEditorPageModule]}),Ht})();et.N.production&&(0,g.G48)(),h.q6().bootstrapModule(Yi).catch(Ht=>console.log(Ht))},9898:function(Rn){Rn.exports=function(){"use strict";var Dt,B,h;function g(c,Y){if(Dt)if(B){var se="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+Dt+")(sharedChunk); ("+B+")(sharedChunk); self.onerror = null;",y={};Dt(y),h=Y(y),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(h.workerUrl=window.URL.createObjectURL(new Blob([se],{type:"text/javascript"})))}else B=Y;else Dt=Y}return g(0,function(c){var Y=typeof self<"u"?self:{},se="2.11.1";let y;const fe={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(null==y){const n=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{y=null!=process.env.API_URL_REGEX?new RegExp(process.env.API_URL_REGEX):n}catch{y=n}}return y},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get EVENTS_URL(){return this.API_URL?0===this.API_URL.indexOf("https://api.mapbox.cn")?"https://events.mapbox.cn/events/v2":0===this.API_URL.indexOf("https://api.mapbox.com")?"https://events.mapbox.com/events/v2":null:null},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},Ie={supported:!1,testSupport:function(n){!be&&Q&&(me?Ze(n):Ge=n)}};let Ge,Q,be=!1,me=!1;function Ze(n){const e=n.createTexture();n.bindTexture(n.TEXTURE_2D,e);try{if(n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,Q),n.isContextLost())return;Ie.supported=!0}catch{}n.deleteTexture(e),be=!0}Y.document&&(Q=Y.document.createElement("img"),Q.onload=function(){Ge&&Ze(Ge),Ge=null,me=!0},Q.onerror=function(){be=!0,Ge=null},Q.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const he="01";var Ke=Ae;function Ae(n,e,i,a){this.cx=3*n,this.bx=3*(i-n)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(a-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=n,this.p1y=e,this.p2x=i,this.p2y=a}Ae.prototype={sampleCurveX:function(n){return((this.ax*n+this.bx)*n+this.cx)*n},sampleCurveY:function(n){return((this.ay*n+this.by)*n+this.cy)*n},sampleCurveDerivativeX:function(n){return(3*this.ax*n+2*this.bx)*n+this.cx},solveCurveX:function(n,e){if(void 0===e&&(e=1e-6),n<0)return 0;if(n>1)return 1;for(var i=n,a=0;a<8;a++){var d=this.sampleCurveX(i)-n;if(Math.abs(d)<e)return i;var m=this.sampleCurveDerivativeX(i);if(Math.abs(m)<1e-6)break;i-=d/m}var _=0,w=1;for(i=n,a=0;a<20&&(d=this.sampleCurveX(i),!(Math.abs(d-n)<e));a++)n>d?_=i:w=i,i=.5*(w-_)+_;return i},solve:function(n,e){return this.sampleCurveY(this.solveCurveX(n,e))}};var te=Qe;function Qe(n,e){this.x=n,this.y=e}Qe.prototype={clone:function(){return new Qe(this.x,this.y)},add:function(n){return this.clone()._add(n)},sub:function(n){return this.clone()._sub(n)},multByPoint:function(n){return this.clone()._multByPoint(n)},divByPoint:function(n){return this.clone()._divByPoint(n)},mult:function(n){return this.clone()._mult(n)},div:function(n){return this.clone()._div(n)},rotate:function(n){return this.clone()._rotate(n)},rotateAround:function(n,e){return this.clone()._rotateAround(n,e)},matMult:function(n){return this.clone()._matMult(n)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(n){return this.x===n.x&&this.y===n.y},dist:function(n){return Math.sqrt(this.distSqr(n))},distSqr:function(n){var e=n.x-this.x,i=n.y-this.y;return e*e+i*i},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(n){return Math.atan2(this.y-n.y,this.x-n.x)},angleWith:function(n){return this.angleWithSep(n.x,n.y)},angleWithSep:function(n,e){return Math.atan2(this.x*e-this.y*n,this.x*n+this.y*e)},_matMult:function(n){var e=n[2]*this.x+n[3]*this.y;return this.x=n[0]*this.x+n[1]*this.y,this.y=e,this},_add:function(n){return this.x+=n.x,this.y+=n.y,this},_sub:function(n){return this.x-=n.x,this.y-=n.y,this},_mult:function(n){return this.x*=n,this.y*=n,this},_div:function(n){return this.x/=n,this.y/=n,this},_multByPoint:function(n){return this.x*=n.x,this.y*=n.y,this},_divByPoint:function(n){return this.x/=n.x,this.y/=n.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var n=this.y;return this.y=this.x,this.x=-n,this},_rotate:function(n){var e=Math.cos(n),i=Math.sin(n),a=i*this.x+e*this.y;return this.x=e*this.x-i*this.y,this.y=a,this},_rotateAround:function(n,e){var i=Math.cos(n),a=Math.sin(n),d=e.y+a*(this.x-e.x)+i*(this.y-e.y);return this.x=e.x+i*(this.x-e.x)-a*(this.y-e.y),this.y=d,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},Qe.convert=function(n){return n instanceof Qe?n:Array.isArray(n)?new Qe(n[0],n[1]):n};const Ot=Math.PI/180,dt=180/Math.PI;function ye(n){return n*Ot}function Fe(n){return n*dt}const Ne=[[0,0],[1,0],[1,1],[0,1]];function we(n){if(n<=0)return 0;if(n>=1)return 1;const e=n*n,i=e*n;return 4*(n<.5?i:3*(n-e)+i-.75)}function et(n,e,i,a){const d=new Ke(n,e,i,a);return function(m){return d.solve(m)}}const Je=et(.25,.1,.25,1);function _e(n,e,i){return Math.min(i,Math.max(e,n))}function pe(n,e,i){return(i=_e((i-n)/(e-n),0,1))*i*(3-2*i)}function ae(n,e,i){const a=i-e,d=((n-e)%a+a)%a+e;return d===e?i:d}function Ee(n,e,i){if(!n.length)return i(null,[]);let a=n.length;const d=new Array(n.length);let m=null;n.forEach((_,w)=>{e(_,(T,M)=>{T&&(m=T),d[w]=M,0==--a&&i(m,d)})})}function vt(n){const e=[];for(const i in n)e.push(n[i]);return e}function Et(n,...e){for(const i of e)for(const a in i)n[a]=i[a];return n}let qt=1;function Ft(){return qt++}function xt(){return function n(e){return e?(e^Math.random()*(16>>e/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,n)}()}function Pt(n){return n<=1?1:Math.pow(2,Math.ceil(Math.log(n)/Math.LN2))}function bt(n){return!!n&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(n)}function ct(n,e){n.forEach(i=>{e[i]&&(e[i]=e[i].bind(e))})}function ht(n,e){return-1!==n.indexOf(e,n.length-e.length)}function Ce(n,e,i){const a={};for(const d in n)a[d]=e.call(i||this,n[d],d,n);return a}function Ct(n,e,i){const a={};for(const d in n)e.call(i||this,n[d],d,n)&&(a[d]=n[d]);return a}function Ut(n){return Array.isArray(n)?n.map(Ut):"object"==typeof n&&n?Ce(n,Ut):n}const Gt={};function wn(n){Gt[n]||(typeof console<"u"&&console.warn(n),Gt[n]=!0)}function Fn(n,e,i){return(i.y-n.y)*(e.x-n.x)>(e.y-n.y)*(i.x-n.x)}function un(n){let e=0;for(let i,a,d=0,m=n.length,_=m-1;d<m;_=d++)i=n[d],a=n[_],e+=(a.x-i.x)*(i.y+a.y);return e}function ut(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function jt(n){const e={};if(n.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(i,a,d,m)=>{const _=d||m;return e[a]=!_||_.toLowerCase(),""}),e["max-age"]){const i=parseInt(e["max-age"],10);isNaN(i)?delete e["max-age"]:e["max-age"]=i}return e}let En=null;function ni(n){if(null==En){const e=n.navigator?n.navigator.userAgent:null;En=!!n.safari||!(!e||!(/\b(iPad|iPhone|iPod)\b/.test(e)||e.match("Safari")&&!e.match("Chrome")))}return En}function ci(n){try{const e=Y[n];return e.setItem("_mapbox_test_",1),e.removeItem("_mapbox_test_"),!0}catch{return!1}}function Un(n,e){return[n[4*e],n[4*e+1],n[4*e+2],n[4*e+3]]}const _i="mapbox-tiles";let wi,xi,Ni=500,Ii=50;function Ui(){try{return Y.caches}catch{}}function Yi(){Ui()&&!wi&&(wi=Y.caches.open(_i))}function Ht(n){const e=n.indexOf("?");if(e<0)return n;const a=function(d){const m=d.indexOf("?");return m>0?d.slice(m+1).split("&"):[]}(n).filter(d=>{const m=d.split("=");return"language"===m[0]||"worldview"===m[0]});return a.length?`${n.slice(0,e)}?${a.join("&")}`:n.slice(0,e)}let Mt=1/0;const qe={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};"function"==typeof Object.freeze&&Object.freeze(qe);class re extends Error{constructor(e,i,a){401===i&&wr(a)&&(e+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),super(e),this.status=i,this.url=a}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const tt=ut()?()=>self.worker&&self.worker.referrer:()=>("blob:"===Y.location.protocol?Y.parent:Y).location.href,Wt=function(n,e){if(!(/^file:/.test(i=n.url)||/^file:/.test(tt())&&!/^\w+:/.test(i))){if(Y.fetch&&Y.Request&&Y.AbortController&&Y.Request.prototype.hasOwnProperty("signal"))return function(a,d){const m=new Y.AbortController,_=new Y.Request(a.url,{method:a.method||"GET",body:a.body,credentials:a.credentials,headers:a.headers,referrer:tt(),signal:m.signal});let w=!1,T=!1;const M=(L=_.url).indexOf("sku=")>0&&wr(L);var L;"json"===a.type&&_.headers.set("Accept","application/json");const z=(K,ne,ge)=>{if(T)return;if(K&&"SecurityError"!==K.message&&wn(K),ne&&ge)return V(ne);const ze=Date.now();Y.fetch(_).then(rt=>{if(rt.ok){const wt=M?rt.clone():null;return V(rt,wt,ze)}return d(new re(rt.statusText,rt.status,a.url))}).catch(rt=>{20!==rt.code&&d(new Error(rt.message))})},V=(K,ne,ge)=>{("arrayBuffer"===a.type?K.arrayBuffer():"json"===a.type?K.json():K.text()).then(ze=>{T||(ne&&ge&&function(rt,wt,it){if(Yi(),!wi)return;const ft={status:wt.status,statusText:wt.statusText,headers:new Y.Headers};wt.headers.forEach((rn,en)=>ft.headers.set(en,rn));const At=jt(wt.headers.get("Cache-Control")||"");if(At["no-store"])return;At["max-age"]&&ft.headers.set("Expires",new Date(it+1e3*At["max-age"]).toUTCString());const mt=ft.headers.get("Expires");mt&&(new Date(mt).getTime()-it<42e4||function(rn,en){if(void 0===xi)try{new Response(new ReadableStream),xi=!0}catch{xi=!1}xi?en(rn.body):rn.blob().then(en)}(wt,rn=>{const en=new Y.Response(rn,ft);Yi(),wi&&wi.then(mn=>mn.put(Ht(rt.url),en)).catch(mn=>wn(mn.message))}))}(_,ne,ge),w=!0,d(null,ze,K.headers.get("Cache-Control"),K.headers.get("Expires")))}).catch(ze=>{T||d(new Error(ze.message))})};return M?function(K,ne){if(Yi(),!wi)return ne(null);const ge=Ht(K.url);wi.then(ze=>{ze.match(ge).then(rt=>{const wt=function(it){if(!it)return!1;const ft=new Date(it.headers.get("Expires")||0),At=jt(it.headers.get("Cache-Control")||"");return ft>Date.now()&&!At["no-cache"]}(rt);ze.delete(ge),wt&&ze.put(ge,rt.clone()),ne(null,rt,wt)}).catch(ne)}).catch(ne)}(_,z):z(null,null),{cancel:()=>{T=!0,w||m.abort()}}}(n,e);if(ut()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",n,e,void 0,!0)}var i;return function(a,d){const m=new Y.XMLHttpRequest;m.open(a.method||"GET",a.url,!0),"arrayBuffer"===a.type&&(m.responseType="arraybuffer");for(const _ in a.headers)m.setRequestHeader(_,a.headers[_]);return"json"===a.type&&(m.responseType="text",m.setRequestHeader("Accept","application/json")),m.withCredentials="include"===a.credentials,m.onerror=()=>{d(new Error(m.statusText))},m.onload=()=>{if((m.status>=200&&m.status<300||0===m.status)&&null!==m.response){let _=m.response;if("json"===a.type)try{_=JSON.parse(m.response)}catch(w){return d(w)}d(null,_,m.getResponseHeader("Cache-Control"),m.getResponseHeader("Expires"))}else d(new re(m.statusText,m.status,a.url))},m.send(a.body),{cancel:()=>m.abort()}}(n,e)},Qt=function(n,e){return Wt(Et(n,{type:"arrayBuffer"}),e)};function fi(n){const e=Y.document.createElement("a");return e.href=n,e.protocol===Y.document.location.protocol&&e.host===Y.document.location.host}const Ai="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let er,mi;er=[],mi=0;const xr=function(n,e){if(Ie.supported&&(n.headers||(n.headers={}),n.headers.accept="image/webp,*/*"),mi>=fe.MAX_PARALLEL_IMAGE_REQUESTS){const m={requestParameters:n,callback:e,cancelled:!1,cancel(){this.cancelled=!0}};return er.push(m),m}mi++;let i=!1;const a=()=>{if(!i)for(i=!0,mi--;er.length&&mi<fe.MAX_PARALLEL_IMAGE_REQUESTS;){const m=er.shift(),{requestParameters:_,callback:w,cancelled:T}=m;T||(m.cancel=xr(_,w).cancel)}},d=Qt(n,(m,_,w,T)=>{a(),m?e(m):_&&(Y.createImageBitmap?function(M,L){const z=new Y.Blob([new Uint8Array(M)],{type:"image/png"});Y.createImageBitmap(z).then(V=>{L(null,V)}).catch(V=>{L(new Error(`Could not load image because of ${V.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(_,(M,L)=>e(M,L,w,T)):function(M,L){const z=new Y.Image,V=Y.URL;z.onload=()=>{L(null,z),V.revokeObjectURL(z.src),z.onload=null,Y.requestAnimationFrame(()=>{z.src=Ai})},z.onerror=()=>L(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const K=new Y.Blob([new Uint8Array(M)],{type:"image/png"});z.src=M.byteLength?V.createObjectURL(K):Ai}(_,(M,L)=>e(M,L,w,T)))});return{cancel:()=>{d.cancel(),a()}}},Pi="NO_ACCESS_TOKEN";function br(n){return 0===n.indexOf("mapbox:")}function wr(n){return fe.API_URL_REGEX.test(n)}function Er(n){return fe.API_STYLE_REGEX.test(n)&&!ui(n)}function ui(n){return fe.API_SPRITE_REGEX.test(n)}const pn=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function _t(n){const e=n.match(pn);if(!e)throw new Error("Unable to parse URL object");return{protocol:e[1],authority:e[2],path:e[3]||"/",params:e[4]?e[4].split("&"):[]}}function kt(n){const e=n.params.length?`?${n.params.join("&")}`:"";return`${n.protocol}://${n.authority}${n.path}${e}`}function gn(n){if(!n)return null;const e=n.split(".");if(!e||3!==e.length)return null;try{return JSON.parse(decodeURIComponent(Y.atob(e[1]).split("").map(i=>"%"+("00"+i.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch{return null}}class Ve{constructor(e){this.type=e,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(e){const i=gn(fe.ACCESS_TOKEN);let a="";return a=i&&i.u?Y.btoa(encodeURIComponent(i.u).replace(/%([0-9A-F]{2})/g,(d,m)=>String.fromCharCode(Number("0x"+m)))):fe.ACCESS_TOKEN||"",e?`mapbox.eventData.${e}:${a}`:`mapbox.eventData:${a}`}fetchEventData(){const e=ci("localStorage"),i=this.getStorageKey(),a=this.getStorageKey("uuid");if(e)try{const d=Y.localStorage.getItem(i);d&&(this.eventData=JSON.parse(d));const m=Y.localStorage.getItem(a);m&&(this.anonId=m)}catch{wn("Unable to read from LocalStorage")}}saveEventData(){const e=ci("localStorage"),i=this.getStorageKey(),a=this.getStorageKey("uuid");if(e)try{Y.localStorage.setItem(a,this.anonId),Object.keys(this.eventData).length>=1&&Y.localStorage.setItem(i,JSON.stringify(this.eventData))}catch{wn("Unable to write to LocalStorage")}}processRequests(e){}postEvent(e,i,a,d){if(!fe.EVENTS_URL)return;const m=_t(fe.EVENTS_URL);m.params.push(`access_token=${d||fe.ACCESS_TOKEN||""}`);const _={event:this.type,created:new Date(e).toISOString()},w=i?Et(_,i):_,T={url:kt(m),headers:{"Content-Type":"text/plain"},body:JSON.stringify([w])};var L;this.pendingRequest=(L=M=>{this.pendingRequest=null,a(M),this.saveEventData(),this.processRequests(d)},Wt(Et(T,{method:"POST"}),L))}queueRequest(e,i){this.queue.push(e),this.processRequests(i)}}const le=new class extends Ve{constructor(n){super("appUserTurnstile"),this._customAccessToken=n}postTurnstileEvent(n,e){fe.EVENTS_URL&&fe.ACCESS_TOKEN&&Array.isArray(n)&&n.some(i=>br(i)||wr(i))&&this.queueRequest(Date.now(),e)}processRequests(n){if(this.pendingRequest||0===this.queue.length)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const e=gn(fe.ACCESS_TOKEN),i=e?e.u:fe.ACCESS_TOKEN;let a=i!==this.eventData.tokenU;bt(this.anonId)||(this.anonId=xt(),a=!0);const d=this.queue.shift();if(this.eventData.lastSuccess){const m=new Date(this.eventData.lastSuccess),_=new Date(d),w=(d-this.eventData.lastSuccess)/864e5;a=a||w>=1||w<-1||m.getDate()!==_.getDate()}else a=!0;a?this.postEvent(d,{sdkIdentifier:"mapbox-gl-js",sdkVersion:se,skuId:he,"enabled.telemetry":!1,userId:this.anonId},m=>{m||(this.eventData.lastSuccess=d,this.eventData.tokenU=i)},n):this.processRequests()}},R=le.postTurnstileEvent.bind(le),j=new class extends Ve{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(n,e,i,a){this.skuToken=e,this.errorCb=a,fe.EVENTS_URL&&(i||fe.ACCESS_TOKEN?this.queueRequest({id:n,timestamp:Date.now()},i):this.errorCb(new Error(Pi)))}processRequests(n){if(this.pendingRequest||0===this.queue.length)return;const{id:e,timestamp:i}=this.queue.shift();e&&this.success[e]||(this.anonId||this.fetchEventData(),bt(this.anonId)||(this.anonId=xt()),this.postEvent(i,{sdkIdentifier:"mapbox-gl-js",sdkVersion:se,skuId:he,skuToken:this.skuToken,userId:this.anonId},a=>{a?this.errorCb(a):e&&(this.success[e]=!0)},n))}},de=j.postMapLoadEvent.bind(j),Le=new class extends Ve{constructor(){super("gljs.performance")}postPerformanceEvent(n,e){fe.EVENTS_URL&&(n||fe.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:e},n)}processRequests(n){if(this.pendingRequest||0===this.queue.length)return;const{timestamp:e,performanceData:i}=this.queue.shift(),a=function(d){const m=Y.performance.getEntriesByType("resource"),_=Y.performance.getEntriesByType("mark"),w=function(V){const K={};if(V)for(const ne in V)if("other"!==ne)for(const ge of V[ne]){const ze=`${ne}RequestCount`,rt=`${ne}ResolveRangeMin`,wt=`${ne}ResolveRangeMax`;K[rt]=Math.min(K[rt]||1/0,ge.startTime),K[wt]=Math.max(K[wt]||-1/0,ge.responseEnd),void 0===K[ze]&&(K[ze]=0),++K[ze]}return K}(function(V,K){const ne={};if(V)for(const ge of V){const ze=K(ge);void 0===ne[ze]&&(ne[ze]=[]),ne[ze].push(ge)}return ne}(m,Re)),T=Y.devicePixelRatio,M=Y.navigator.connection||Y.navigator.mozConnection||Y.navigator.webkitConnection,L={counters:[],metadata:[],attributes:[]},z=(V,K,ne)=>{null!=ne&&V.push({name:K,value:ne.toString()})};for(const V in w)z(L.counters,V,w[V]);if(d.interactionRange[0]!==1/0&&d.interactionRange[1]!==-1/0&&(z(L.counters,"interactionRangeMin",d.interactionRange[0]),z(L.counters,"interactionRangeMax",d.interactionRange[1])),_)for(const V of Object.keys(Pe)){const K=Pe[V],ne=_.find(ge=>ge.name===K);ne&&z(L.counters,K,ne.startTime)}return z(L.counters,"visibilityHidden",d.visibilityHidden),z(L.attributes,"style",function(V){if(V)for(const K of V){const ne=K.name.split("?")[0];if(Er(ne)){const ge=ne.split("/").slice(-2);if(2===ge.length)return`mapbox://styles/${ge[0]}/${ge[1]}`}}}(m)),z(L.attributes,"terrainEnabled",d.terrainEnabled?"true":"false"),z(L.attributes,"fogEnabled",d.fogEnabled?"true":"false"),z(L.attributes,"projection",d.projection.name),z(L.attributes,"zoom",d.zoom),z(L.metadata,"devicePixelRatio",T),z(L.metadata,"connectionEffectiveType",M?M.effectiveType:void 0),z(L.metadata,"navigatorUserAgent",Y.navigator.userAgent),z(L.metadata,"screenWidth",Y.screen.width),z(L.metadata,"screenHeight",Y.screen.height),z(L.metadata,"windowWidth",Y.innerWidth),z(L.metadata,"windowHeight",Y.innerHeight),z(L.metadata,"mapWidth",d.width/T),z(L.metadata,"mapHeight",d.height/T),z(L.metadata,"webglRenderer",d.renderer),z(L.metadata,"webglVendor",d.vendor),z(L.metadata,"sdkVersion",se),z(L.metadata,"sdkIdentifier","mapbox-gl-js"),L}(i);for(const d of a.metadata);for(const d of a.counters);for(const d of a.attributes);this.postEvent(e,a,()=>{},n)}},st=Le.postPerformanceEvent.bind(Le),Bt=new class extends Ve{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(n,e,i,a){if(!fe.API_URL||!fe.SESSION_PATH)return;const d=_t(fe.API_URL+fe.SESSION_PATH);d.params.push(`sku=${e||""}`),d.params.push(`access_token=${a||fe.ACCESS_TOKEN||""}`);const m={url:kt(d),headers:{"Content-Type":"text/plain"}};var w;this.pendingRequest=(w=_=>{this.pendingRequest=null,i(_),this.saveEventData(),this.processRequests(a)},Wt(Et(m,{method:"GET"}),w))}getSessionAPI(n,e,i,a){this.skuToken=e,this.errorCb=a,fe.SESSION_PATH&&fe.API_URL&&(i||fe.ACCESS_TOKEN?this.queueRequest({id:n,timestamp:Date.now()},i):this.errorCb(new Error(Pi)))}processRequests(n){if(this.pendingRequest||0===this.queue.length)return;const{id:e,timestamp:i}=this.queue.shift();e&&this.success[e]||this.getSession(i,this.skuToken,a=>{a?this.errorCb(a):e&&(this.success[e]=!0)},n)}},Rt=Bt.getSessionAPI.bind(Bt),at=new Set,Pe={create:"create",load:"load",fullLoad:"fullLoad"},Ue={mark(n){Y.performance.mark(n)},measure(n,e,i){Y.performance.measure(n,e,i)}};function Re(n){const e=n.name.split("?")[0];return e.includes("mapbox-gl.js")?"javascript":e.includes("mapbox-gl.css")?"css":fe.API_FONTS_REGEX.test(e)?"fontRange":ui(e)?"sprite":Er(e)?"style":fe.API_TILEJSON_REGEX.test(e)?"tilejson":"other"}const nt=Y.performance;function zt(n){const e=n?n.url.toString():void 0;return nt.getEntriesByName(e)}let _n,Mn,Yn,di;const gi={now:()=>void 0!==Yn?Yn:Y.performance.now(),setNow(n){Yn=n},restoreNow(){Yn=void 0},frame(n){const e=Y.requestAnimationFrame(n);return{cancel:()=>Y.cancelAnimationFrame(e)}},getImageData(n,e=0){const{width:i,height:a}=n;di||(di=Y.document.createElement("canvas"));const d=di.getContext("2d");if(!d)throw new Error("failed to create canvas 2d context");return(i>di.width||a>di.height)&&(di.width=i,di.height=a),d.clearRect(-e,-e,i+2*e,a+2*e),d.drawImage(n,0,0,i,a),d.getImageData(-e,-e,i+2*e,a+2*e)},resolveURL:n=>(_n||(_n=Y.document.createElement("a")),_n.href=n,_n.href),get devicePixelRatio(){return Y.devicePixelRatio},get prefersReducedMotion(){return!!Y.matchMedia&&(null==Mn&&(Mn=Y.matchMedia("(prefers-reduced-motion: reduce)")),Mn.matches)}};function Kn(n,e,i){i[n]&&-1!==i[n].indexOf(e)||(i[n]=i[n]||[],i[n].push(e))}function Vi(n,e,i){if(i&&i[n]){const a=i[n].indexOf(e);-1!==a&&i[n].splice(a,1)}}class Bi{constructor(e,i={}){Et(this,i),this.type=e}}class Qr extends Bi{constructor(e,i={}){super("error",Et({error:e},i))}}class Cr{on(e,i){return this._listeners=this._listeners||{},Kn(e,i,this._listeners),this}off(e,i){return Vi(e,i,this._listeners),Vi(e,i,this._oneTimeListeners),this}once(e,i){return i?(this._oneTimeListeners=this._oneTimeListeners||{},Kn(e,i,this._oneTimeListeners),this):new Promise(a=>this.once(e,a))}fire(e,i){"string"==typeof e&&(e=new Bi(e,i||{}));const a=e.type;if(this.listens(a)){e.target=this;const d=this._listeners&&this._listeners[a]?this._listeners[a].slice():[];for(const w of d)w.call(this,e);const m=this._oneTimeListeners&&this._oneTimeListeners[a]?this._oneTimeListeners[a].slice():[];for(const w of m)Vi(a,w,this._oneTimeListeners),w.call(this,e);const _=this._eventedParent;_&&(Et(e,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),_.fire(e))}else e instanceof Qr&&console.error(e.error);return this}listens(e){return!!(this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e))}setEventedParent(e,i){return this._eventedParent=e,this._eventedParentData=i,this}}var on=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360,"units":"degrees"},"pitch":{"type":"number","default":0,"units":"degrees"},"light":{"type":"light"},"terrain":{"type":"terrain"},"fog":{"type":"fog"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":{},"mapbox":{}},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":{}}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":{}}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":{}}},"url":{"required":true,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"hillshade":{},"background":{},"sky":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],"layout_background":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","private":true,"default":0,"minimum":0,"maximum":1,"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":{},"round":{},"square":{}},"default":"butt","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":{},"round":{},"miter":{}},"default":"miter","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"requires":[{"line-join":"miter"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"requires":[{"line-join":"round"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":{},"line":{},"line-center":{}},"default":"point","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"units":"pixels","requires":[{"symbol-placement":"line"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":{},"viewport-y":{},"source":{}},"default":"auto","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"units":"factor of the original icon size","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":{},"width":{},"height":{},"both":{}},"default":"none","requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"units":"pixels","requires":["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"requires":["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"units":"ems","requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":{},"left":{},"center":{},"right":{}},"default":"center","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","units":"ems","default":0,"requires":["text-field"],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["text-field",{"!":"text-variable-anchor"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"units":"degrees","requires":["text-field",{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":{},"vertical":{}},"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"requires":["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":{},"uppercase":{},"lowercase":{}},"default":"none","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","units":"ems","length":2,"default":[0,0],"requires":["text-field",{"!":"text-radial-offset"}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"requires":["text-field","icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},"in":{},"!in":{},"all":{},"any":{},"none":{},"has":{},"!has":{},"within":{}}},"geometry_type":{"type":"enum","values":{"Point":{},"LineString":{},"Polygon":{}}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":{},"exponential":{},"interval":{},"categorical":{}},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":{},"lab":{},"hcl":{}},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":{},"viewport":{}},"property-type":"data-constant","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":{},"equalEarth":{},"equirectangular":{},"lambertConformalConic":{},"mercator":{},"naturalEarth":{},"winkelTripel":{},"globe":{}},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["source"]}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"requires":[{"!":"fill-pattern"},{"fill-antialias":true}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","transition":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-extrusion-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-extrusion-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","transition":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"requires":["fill-extrusion-height"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","private":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["fill-extrusion-edge-radius"]}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"line-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["line-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"transition":true,"units":"line widths","requires":[{"!":"line-pattern"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-pattern":{"type":"resolvedImage","transition":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{"type":"color","transition":false,"requires":[{"!":"line-pattern"},{"source":"geojson","has":{"lineMetrics":true}}],"expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"transition":false,"requires":[{"source":"geojson","has":{"lineMetrics":true}}],"property-type":"constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["circle-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"transition":false,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"transition":false,"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["icon-image","icon-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["text-field","text-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"units":"degrees","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":{},"nearest":{}},"default":"linear","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"transition":false,"units":"milliseconds","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"transition":false,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"background-pattern"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","transition":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"cross-faded"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":{},"atmosphere":{}},"default":"atmosphere","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"requires":[{"sky-type":"atmosphere"}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","requires":[{"sky-type":"atmosphere"}],"default":10,"minimum":0,"maximum":100,"transition":false,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","requires":[{"sky-type":"gradient"}],"value":"number","default":[0,0],"length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","requires":[{"sky-type":"gradient"}],"default":90,"minimum":0,"maximum":180,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"transition":false,"requires":[{"sky-type":"gradient"}],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"transition":{"duration":{"type":"number","default":300,"minimum":0,"units":"milliseconds"},"delay":{"type":"number","default":0,"minimum":0,"units":"milliseconds"}},"property-type":{"data-driven":{"type":"property-type"},"cross-faded":{"type":"property-type"},"cross-faded-data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function ar(n,...e){for(const i of e)for(const a in i)n[a]=i[a];return n}function pr(n){return n instanceof Number||n instanceof String||n instanceof Boolean?n.valueOf():n}function xo(n){if(Array.isArray(n))return n.map(xo);if(n instanceof Object&&!(n instanceof Number||n instanceof String||n instanceof Boolean)){const e={};for(const i in n)e[i]=xo(n[i]);return e}return pr(n)}class zo extends Error{constructor(e,i){super(i),this.message=i,this.key=e}}var Br=zo;class Oi{constructor(e,i=[]){this.parent=e,this.bindings={};for(const[a,d]of i)this.bindings[a]=d}concat(e){return new Oi(this,e)}get(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(`${e} not found in scope.`)}has(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)}}var lr=Oi;const cr={kind:"null"},Ln={kind:"number"},hi={kind:"string"},ri={kind:"boolean"},Wn={kind:"color"},xe={kind:"object"},Oe={kind:"value"},Lt={kind:"collator"},$t={kind:"formatted"},tn={kind:"resolvedImage"};function He(n,e){return{kind:"array",itemType:n,N:e}}function pt(n){if("array"===n.kind){const e=pt(n.itemType);return"number"==typeof n.N?`array<${e}, ${n.N}>`:"value"===n.itemType.kind?"array":`array<${e}>`}return n.kind}const Yt=[cr,Ln,hi,ri,Wn,$t,xe,He(Oe),tn];function hn(n,e){if("error"===e.kind)return null;if("array"===n.kind){if("array"===e.kind&&(0===e.N&&"value"===e.itemType.kind||!hn(n.itemType,e.itemType))&&("number"!=typeof n.N||n.N===e.N))return null}else{if(n.kind===e.kind)return null;if("value"===n.kind)for(const i of Yt)if(!hn(i,e))return null}return`Expected ${pt(n)} but found ${pt(e)} instead.`}function nn(n,e){return e.some(i=>i.kind===n.kind)}function kn(n,e){return e.some(i=>"null"===i?null===n:"array"===i?Array.isArray(n):"object"===i?n&&!Array.isArray(n)&&"object"==typeof n:i===typeof n)}var ei,Ci={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function qi(n){return(n=Math.round(n))<0?0:n>255?255:n}function ki(n){return qi("%"===n[n.length-1]?parseFloat(n)/100*255:parseInt(n))}function jr(n){return(e="%"===n[n.length-1]?parseFloat(n)/100:parseFloat(n))<0?0:e>1?1:e;var e}function Rr(n,e,i){return i<0?i+=1:i>1&&(i-=1),6*i<1?n+(e-n)*i*6:2*i<1?e:3*i<2?n+(e-n)*(2/3-i)*6:n}try{ei={}.parseCSSColor=function(n){var e,i=n.replace(/ /g,"").toLowerCase();if(i in Ci)return Ci[i].slice();if("#"===i[0])return 4===i.length?(e=parseInt(i.substr(1),16))>=0&&e<=4095?[(3840&e)>>4|(3840&e)>>8,240&e|(240&e)>>4,15&e|(15&e)<<4,1]:null:7===i.length&&(e=parseInt(i.substr(1),16))>=0&&e<=16777215?[(16711680&e)>>16,(65280&e)>>8,255&e,1]:null;var a=i.indexOf("("),d=i.indexOf(")");if(-1!==a&&d+1===i.length){var m=i.substr(0,a),_=i.substr(a+1,d-(a+1)).split(","),w=1;switch(m){case"rgba":if(4!==_.length)return null;w=jr(_.pop());case"rgb":return 3!==_.length?null:[ki(_[0]),ki(_[1]),ki(_[2]),w];case"hsla":if(4!==_.length)return null;w=jr(_.pop());case"hsl":if(3!==_.length)return null;var T=(parseFloat(_[0])%360+360)%360/360,M=jr(_[1]),L=jr(_[2]),z=L<=.5?L*(M+1):L+M-L*M,V=2*L-z;return[qi(255*Rr(V,z,T+1/3)),qi(255*Rr(V,z,T)),qi(255*Rr(V,z,T-1/3)),w];default:return null}}return null}}catch{}class tr{constructor(e,i,a,d=1){this.r=e,this.g=i,this.b=a,this.a=d}static parse(e){if(!e)return;if(e instanceof tr)return e;if("string"!=typeof e)return;const i=ei(e);return i?new tr(i[0]/255*i[3],i[1]/255*i[3],i[2]/255*i[3],i[3]):void 0}toString(){const[e,i,a,d]=this.toArray();return`rgba(${Math.round(e)},${Math.round(i)},${Math.round(a)},${d})`}toArray(){const{r:e,g:i,b:a,a:d}=this;return 0===d?[0,0,0,0]:[255*e/d,255*i/d,255*a/d,d]}toArray01(){const{r:e,g:i,b:a,a:d}=this;return 0===d?[0,0,0,0]:[e/d,i/d,a/d,d]}toArray01PremultipliedAlpha(){const{r:e,g:i,b:a,a:d}=this;return[e,i,a,d]}}tr.black=new tr(0,0,0,1),tr.white=new tr(1,1,1,1),tr.transparent=new tr(0,0,0,0),tr.red=new tr(1,0,0,1),tr.blue=new tr(0,0,1,1);var fr=tr;class es{constructor(e,i,a){this.sensitivity=e?i?"variant":"case":i?"accent":"base",this.locale=a,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(e,i){return this.collator.compare(e,i)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class mr{constructor(e,i,a,d,m){this.text=e.normalize?e.normalize():e,this.image=i,this.scale=a,this.fontStack=d,this.textColor=m}}class bo{constructor(e){this.sections=e}static fromString(e){return new bo([new mr(e,null,null,null,null)])}isEmpty(){return 0===this.sections.length||!this.sections.some(e=>0!==e.text.length||e.image&&0!==e.image.name.length)}static factory(e){return e instanceof bo?e:bo.fromString(e)}toString(){return 0===this.sections.length?"":this.sections.map(e=>e.text).join("")}serialize(){const e=["format"];for(const i of this.sections){if(i.image){e.push(["image",i.image.name]);continue}e.push(i.text);const a={};i.fontStack&&(a["text-font"]=["literal",i.fontStack.split(",")]),i.scale&&(a["font-scale"]=i.scale),i.textColor&&(a["text-color"]=["rgba"].concat(i.textColor.toArray())),e.push(a)}return e}}class io{constructor(e){this.name=e.name,this.available=e.available}toString(){return this.name}static fromString(e){return e?new io({name:e,available:!1}):null}serialize(){return["image",this.name]}}function ia(n,e,i,a){return"number"==typeof n&&n>=0&&n<=255&&"number"==typeof e&&e>=0&&e<=255&&"number"==typeof i&&i>=0&&i<=255?void 0===a||"number"==typeof a&&a>=0&&a<=1?null:`Invalid rgba value [${[n,e,i,a].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${("number"==typeof a?[n,e,i,a]:[n,e,i]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Io(n){if(null===n||"string"==typeof n||"boolean"==typeof n||"number"==typeof n||n instanceof fr||n instanceof es||n instanceof bo||n instanceof io)return!0;if(Array.isArray(n)){for(const e of n)if(!Io(e))return!1;return!0}if("object"==typeof n){for(const e in n)if(!Io(n[e]))return!1;return!0}return!1}function Dr(n){if(null===n)return cr;if("string"==typeof n)return hi;if("boolean"==typeof n)return ri;if("number"==typeof n)return Ln;if(n instanceof fr)return Wn;if(n instanceof es)return Lt;if(n instanceof bo)return $t;if(n instanceof io)return tn;if(Array.isArray(n)){const e=n.length;let i;for(const a of n){const d=Dr(a);if(i){if(i===d)continue;i=Oe;break}i=d}return He(i||Oe,e)}return xe}function Mo(n){const e=typeof n;return null===n?"":"string"===e||"number"===e||"boolean"===e?String(n):n instanceof fr||n instanceof bo||n instanceof io?n.toString():JSON.stringify(n)}class Zr{constructor(e,i){this.type=e,this.value=i}static parse(e,i){if(2!==e.length)return i.error(`'literal' expression requires exactly one argument, but found ${e.length-1} instead.`);if(!Io(e[1]))return i.error("invalid value");const a=e[1];let d=Dr(a);const m=i.expectedType;return"array"!==d.kind||0!==d.N||!m||"array"!==m.kind||"number"==typeof m.N&&0!==m.N||(d=m),new Zr(d,a)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof fr?["rgba"].concat(this.value.toArray()):this.value instanceof bo?this.value.serialize():this.value}}var ra=Zr,rr=class{constructor(n){this.name="ExpressionEvaluationError",this.message=n}toJSON(){return this.message}};const So={string:hi,number:Ln,boolean:ri,object:xe};class xs{constructor(e,i){this.type=e,this.args=i}static parse(e,i){if(e.length<2)return i.error("Expected at least one argument.");let a,d=1;const m=e[0];if("array"===m){let w,T;if(e.length>2){const M=e[1];if("string"!=typeof M||!(M in So)||"object"===M)return i.error('The item type argument of "array" must be one of string, number, boolean',1);w=So[M],d++}else w=Oe;if(e.length>3){if(null!==e[2]&&("number"!=typeof e[2]||e[2]<0||e[2]!==Math.floor(e[2])))return i.error('The length argument to "array" must be a positive integer literal',2);T=e[2],d++}a=He(w,T)}else a=So[m];const _=[];for(;d<e.length;d++){const w=i.parse(e[d],d,Oe);if(!w)return null;_.push(w)}return new xs(a,_)}evaluate(e){for(let i=0;i<this.args.length;i++){const a=this.args[i].evaluate(e);if(!hn(this.type,Dr(a)))return a;if(i===this.args.length-1)throw new rr(`Expected value to be of type ${pt(this.type)}, but found ${pt(Dr(a))} instead.`)}return null}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){const e=this.type,i=[e.kind];if("array"===e.kind){const a=e.itemType;if("string"===a.kind||"number"===a.kind||"boolean"===a.kind){i.push(a.kind);const d=e.N;("number"==typeof d||this.args.length>1)&&i.push(d)}}return i.concat(this.args.map(a=>a.serialize()))}}var so=xs;class ao{constructor(e){this.type=$t,this.sections=e}static parse(e,i){if(e.length<2)return i.error("Expected at least one argument.");const a=e[1];if(!Array.isArray(a)&&"object"==typeof a)return i.error("First argument must be an image or text section.");const d=[];let m=!1;for(let _=1;_<=e.length-1;++_){const w=e[_];if(m&&"object"==typeof w&&!Array.isArray(w)){m=!1;let T=null;if(w["font-scale"]&&(T=i.parse(w["font-scale"],1,Ln),!T))return null;let M=null;if(w["text-font"]&&(M=i.parse(w["text-font"],1,He(hi)),!M))return null;let L=null;if(w["text-color"]&&(L=i.parse(w["text-color"],1,Wn),!L))return null;const z=d[d.length-1];z.scale=T,z.font=M,z.textColor=L}else{const T=i.parse(e[_],1,Oe);if(!T)return null;const M=T.type.kind;if("string"!==M&&"value"!==M&&"null"!==M&&"resolvedImage"!==M)return i.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");m=!0,d.push({content:T,scale:null,font:null,textColor:null})}}return new ao(d)}evaluate(e){return new bo(this.sections.map(i=>{const a=i.content.evaluate(e);return Dr(a)===tn?new mr("",a,null,null,null):new mr(Mo(a),null,i.scale?i.scale.evaluate(e):null,i.font?i.font.evaluate(e).join(","):null,i.textColor?i.textColor.evaluate(e):null)}))}eachChild(e){for(const i of this.sections)e(i.content),i.scale&&e(i.scale),i.font&&e(i.font),i.textColor&&e(i.textColor)}outputDefined(){return!1}serialize(){const e=["format"];for(const i of this.sections){e.push(i.content.serialize());const a={};i.scale&&(a["font-scale"]=i.scale.serialize()),i.font&&(a["text-font"]=i.font.serialize()),i.textColor&&(a["text-color"]=i.textColor.serialize()),e.push(a)}return e}}class Wr{constructor(e){this.type=tn,this.input=e}static parse(e,i){if(2!==e.length)return i.error("Expected two arguments.");const a=i.parse(e[1],1,hi);return a?new Wr(a):i.error("No image name provided.")}evaluate(e){const i=this.input.evaluate(e),a=io.fromString(i);return a&&e.availableImages&&(a.available=e.availableImages.indexOf(i)>-1),a}eachChild(e){e(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}const Ho={"to-boolean":ri,"to-color":Wn,"to-number":Ln,"to-string":hi};class us{constructor(e,i){this.type=e,this.args=i}static parse(e,i){if(e.length<2)return i.error("Expected at least one argument.");const a=e[0];if(("to-boolean"===a||"to-string"===a)&&2!==e.length)return i.error("Expected one argument.");const d=Ho[a],m=[];for(let _=1;_<e.length;_++){const w=i.parse(e[_],_,Oe);if(!w)return null;m.push(w)}return new us(d,m)}evaluate(e){if("boolean"===this.type.kind)return Boolean(this.args[0].evaluate(e));if("color"===this.type.kind){let i,a;for(const d of this.args){if(i=d.evaluate(e),a=null,i instanceof fr)return i;if("string"==typeof i){const m=e.parseColor(i);if(m)return m}else if(Array.isArray(i)&&(a=i.length<3||i.length>4?`Invalid rbga value ${JSON.stringify(i)}: expected an array containing either three or four numeric values.`:ia(i[0],i[1],i[2],i[3]),!a))return new fr(i[0]/255,i[1]/255,i[2]/255,i[3])}throw new rr(a||`Could not parse color from value '${"string"==typeof i?i:String(JSON.stringify(i))}'`)}if("number"===this.type.kind){let i=null;for(const a of this.args){if(i=a.evaluate(e),null===i)return 0;const d=Number(i);if(!isNaN(d))return d}throw new rr(`Could not convert ${JSON.stringify(i)} to number.`)}return"formatted"===this.type.kind?bo.fromString(Mo(this.args[0].evaluate(e))):"resolvedImage"===this.type.kind?io.fromString(Mo(this.args[0].evaluate(e))):Mo(this.args[0].evaluate(e))}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){if("formatted"===this.type.kind)return new ao([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if("resolvedImage"===this.type.kind)return new Wr(this.args[0]).serialize();const e=[`to-${this.type.kind}`];return this.eachChild(i=>{e.push(i.serialize())}),e}}var ds=us;const Bs=["Unknown","Point","LineString","Polygon"];var oa=class{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null}id(){return this.feature&&void 0!==this.feature.id?this.feature.id:null}geometryType(){return this.feature?"number"==typeof this.feature.type?Bs[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const n=this.featureDistanceData.center,e=this.featureDistanceData.scale,{x:i,y:a}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(i*e-n[0])+this.featureDistanceData.bearing[1]*(a*e-n[1])}return 0}parseColor(n){let e=this._parseColorCache[n];return e||(e=this._parseColorCache[n]=fr.parse(n)),e}};class mo{constructor(e,i,a,d){this.name=e,this.type=i,this._evaluate=a,this.args=d}evaluate(e){return this._evaluate(e,this.args)}eachChild(e){this.args.forEach(e)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(e=>e.serialize()))}static parse(e,i){const a=e[0],d=mo.definitions[a];if(!d)return i.error(`Unknown expression "${a}". If you wanted a literal array, use ["literal", [...]].`,0);const m=Array.isArray(d)?d[0]:d.type,_=Array.isArray(d)?[[d[1],d[2]]]:d.overloads,w=_.filter(([M])=>!Array.isArray(M)||M.length===e.length-1);let T=null;for(const[M,L]of w){T=new Po(i.registry,i.path,null,i.scope);const z=[];let V=!1;for(let K=1;K<e.length;K++){const ne=e[K],ge=Array.isArray(M)?M[K-1]:M.type,ze=T.parse(ne,1+z.length,ge);if(!ze){V=!0;break}z.push(ze)}if(!V)if(Array.isArray(M)&&M.length!==z.length)T.error(`Expected ${M.length} arguments, but found ${z.length} instead.`);else{for(let K=0;K<z.length;K++){const ne=Array.isArray(M)?M[K]:M.type,ge=z[K];T.concat(K+1).checkSubtype(ne,ge.type)}if(0===T.errors.length)return new mo(a,m,L,z)}}if(1===w.length)i.errors.push(...T.errors);else{const M=(w.length?w:_).map(([z])=>{return V=z,Array.isArray(V)?`(${V.map(pt).join(", ")})`:`(${pt(V.type)}...)`;var V}).join(" | "),L=[];for(let z=1;z<e.length;z++){const V=i.parse(e[z],1+L.length);if(!V)return null;L.push(pt(V.type))}i.error(`Expected arguments of type ${M}, but found (${L.join(", ")}) instead.`)}return null}static register(e,i){mo.definitions=i;for(const a in i)e[a]=mo}}var No=mo;class Ys{constructor(e,i,a){this.type=Lt,this.locale=a,this.caseSensitive=e,this.diacriticSensitive=i}static parse(e,i){if(2!==e.length)return i.error("Expected one argument.");const a=e[1];if("object"!=typeof a||Array.isArray(a))return i.error("Collator options argument must be an object.");const d=i.parse(void 0!==a["case-sensitive"]&&a["case-sensitive"],1,ri);if(!d)return null;const m=i.parse(void 0!==a["diacritic-sensitive"]&&a["diacritic-sensitive"],1,ri);if(!m)return null;let _=null;return a.locale&&(_=i.parse(a.locale,1,hi),!_)?null:new Ys(d,m,_)}evaluate(e){return new es(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)}eachChild(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)}outputDefined(){return!1}serialize(){const e={};return e["case-sensitive"]=this.caseSensitive.serialize(),e["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(e.locale=this.locale.serialize()),["collator",e]}}const go=8192;function xa(n,e){n[0]=Math.min(n[0],e[0]),n[1]=Math.min(n[1],e[1]),n[2]=Math.max(n[2],e[0]),n[3]=Math.max(n[3],e[1])}function sa(n,e){return!(n[0]<=e[0]||n[2]>=e[2]||n[1]<=e[1]||n[3]>=e[3])}function Ao(n,e){const i=(180+n[0])/360,a=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+n[1]*Math.PI/360)))/360,d=Math.pow(2,e.z);return[Math.round(i*d*go),Math.round(a*d*go)]}function ba(n,e,i){const a=n[0]-e[0],d=n[1]-e[1],m=n[0]-i[0],_=n[1]-i[1];return a*_-m*d==0&&a*m<=0&&d*_<=0}function zs(n,e){let i=!1;for(let _=0,w=e.length;_<w;_++){const T=e[_];for(let M=0,L=T.length;M<L-1;M++){if(ba(n,T[M],T[M+1]))return!1;(d=T[M])[1]>(a=n)[1]!=(m=T[M+1])[1]>a[1]&&a[0]<(m[0]-d[0])*(a[1]-d[1])/(m[1]-d[1])+d[0]&&(i=!i)}}var a,d,m;return i}function il(n,e){for(let i=0;i<e.length;i++)if(zs(n,e[i]))return!0;return!1}function Uo(n,e,i,a){const d=a[0]-i[0],m=a[1]-i[1],_=(n[0]-i[0])*m-d*(n[1]-i[1]),w=(e[0]-i[0])*m-d*(e[1]-i[1]);return _>0&&w<0||_<0&&w>0}function Fa(n,e,i){for(const M of i)for(let L=0;L<M.length-1;++L)if((w=[(_=M[L+1])[0]-(m=M[L])[0],_[1]-m[1]])[0]*(T=[(d=e)[0]-(a=n)[0],d[1]-a[1]])[1]-w[1]*T[0]!=0&&Uo(a,d,m,_)&&Uo(m,_,a,d))return!0;var a,d,m,_,w,T;return!1}function bs(n,e){for(let i=0;i<n.length;++i)if(!zs(n[i],e))return!1;for(let i=0;i<n.length-1;++i)if(Fa(n[i],n[i+1],e))return!1;return!0}function aa(n,e){for(let i=0;i<e.length;i++)if(bs(n,e[i]))return!0;return!1}function Wo(n,e,i){const a=[];for(let d=0;d<n.length;d++){const m=[];for(let _=0;_<n[d].length;_++){const w=Ao(n[d][_],i);xa(e,w),m.push(w)}a.push(m)}return a}function Js(n,e,i){const a=[];for(let d=0;d<n.length;d++){const m=Wo(n[d],e,i);a.push(m)}return a}function ts(n,e,i,a){if(n[0]<i[0]||n[0]>i[2]){const d=.5*a;let m=n[0]-i[0]>d?-a:i[0]-n[0]>d?a:0;0===m&&(m=n[0]-i[2]>d?-a:i[2]-n[0]>d?a:0),n[0]+=m}xa(e,n)}function ws(n,e,i,a){const d=Math.pow(2,a.z)*go,m=[a.x*go,a.y*go],_=[];if(!n)return _;for(const w of n)for(const T of w){const M=[T.x+m[0],T.y+m[1]];ts(M,e,i,d),_.push(M)}return _}function Ns(n,e,i,a){const d=Math.pow(2,a.z)*go,m=[a.x*go,a.y*go],_=[];if(!n)return _;for(const T of n){const M=[];for(const L of T){const z=[L.x+m[0],L.y+m[1]];xa(e,z),M.push(z)}_.push(M)}if(e[2]-e[0]<=d/2){(w=e)[0]=w[1]=1/0,w[2]=w[3]=-1/0;for(const T of _)for(const M of T)ts(M,e,i,d)}var w;return _}class qr{constructor(e,i){this.type=ri,this.geojson=e,this.geometries=i}static parse(e,i){if(2!==e.length)return i.error(`'within' expression requires exactly one argument, but found ${e.length-1} instead.`);if(Io(e[1])){const a=e[1];if("FeatureCollection"===a.type)for(let d=0;d<a.features.length;++d){const m=a.features[d].geometry.type;if("Polygon"===m||"MultiPolygon"===m)return new qr(a,a.features[d].geometry)}else if("Feature"===a.type){const d=a.geometry.type;if("Polygon"===d||"MultiPolygon"===d)return new qr(a,a.geometry)}else if("Polygon"===a.type||"MultiPolygon"===a.type)return new qr(a,a)}return i.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(null!=e.geometry()&&null!=e.canonicalID()){if("Point"===e.geometryType())return function(i,a){const d=[1/0,1/0,-1/0,-1/0],m=[1/0,1/0,-1/0,-1/0],_=i.canonicalID();if(!_)return!1;if("Polygon"===a.type){const w=Wo(a.coordinates,m,_),T=ws(i.geometry(),d,m,_);if(!sa(d,m))return!1;for(const M of T)if(!zs(M,w))return!1}if("MultiPolygon"===a.type){const w=Js(a.coordinates,m,_),T=ws(i.geometry(),d,m,_);if(!sa(d,m))return!1;for(const M of T)if(!il(M,w))return!1}return!0}(e,this.geometries);if("LineString"===e.geometryType())return function(i,a){const d=[1/0,1/0,-1/0,-1/0],m=[1/0,1/0,-1/0,-1/0],_=i.canonicalID();if(!_)return!1;if("Polygon"===a.type){const w=Wo(a.coordinates,m,_),T=Ns(i.geometry(),d,m,_);if(!sa(d,m))return!1;for(const M of T)if(!bs(M,w))return!1}if("MultiPolygon"===a.type){const w=Js(a.coordinates,m,_),T=Ns(i.geometry(),d,m,_);if(!sa(d,m))return!1;for(const M of T)if(!aa(M,w))return!1}return!0}(e,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}var Hi=qr;function Us(n){if(n instanceof No&&("get"===n.name&&1===n.args.length||"feature-state"===n.name||"has"===n.name&&1===n.args.length||"properties"===n.name||"geometry-type"===n.name||"id"===n.name||/^filter-/.test(n.name))||n instanceof Hi)return!1;let e=!0;return n.eachChild(i=>{e&&!Us(i)&&(e=!1)}),e}function Cs(n){if(n instanceof No&&"feature-state"===n.name)return!1;let e=!0;return n.eachChild(i=>{e&&!Cs(i)&&(e=!1)}),e}function Vs(n,e){if(n instanceof No&&e.indexOf(n.name)>=0)return!1;let i=!0;return n.eachChild(a=>{i&&!Vs(a,e)&&(i=!1)}),i}class ns{constructor(e,i){this.type=i.type,this.name=e,this.boundExpression=i}static parse(e,i){if(2!==e.length||"string"!=typeof e[1])return i.error("'var' expression requires exactly one string literal argument.");const a=e[1];return i.scope.has(a)?new ns(a,i.scope.get(a)):i.error(`Unknown variable "${a}". Make sure "${a}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(e){return this.boundExpression.evaluate(e)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}var Ts=ns;class hs{constructor(e,i=[],a,d=new lr,m=[]){this.registry=e,this.path=i,this.key=i.map(_=>`[${_}]`).join(""),this.scope=d,this.errors=m,this.expectedType=a}parse(e,i,a,d,m={}){return i?this.concat(i,a,d)._parse(e,m):this._parse(e,m)}_parse(e,i){function a(d,m,_){return"assert"===_?new so(m,[d]):"coerce"===_?new ds(m,[d]):d}if(null!==e&&"string"!=typeof e&&"boolean"!=typeof e&&"number"!=typeof e||(e=["literal",e]),Array.isArray(e)){if(0===e.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const d=e[0];if("string"!=typeof d)return this.error(`Expression name must be a string, but found ${typeof d} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const m=this.registry[d];if(m){let _=m.parse(e,this);if(!_)return null;if(this.expectedType){const w=this.expectedType,T=_.type;if("string"!==w.kind&&"number"!==w.kind&&"boolean"!==w.kind&&"object"!==w.kind&&"array"!==w.kind||"value"!==T.kind)if("color"!==w.kind&&"formatted"!==w.kind&&"resolvedImage"!==w.kind||"value"!==T.kind&&"string"!==T.kind){if(this.checkSubtype(w,T))return null}else _=a(_,w,i.typeAnnotation||"coerce");else _=a(_,w,i.typeAnnotation||"assert")}if(!(_ instanceof ra)&&"resolvedImage"!==_.type.kind&&ps(_)){const w=new oa;try{_=new ra(_.type,_.evaluate(w))}catch(T){return this.error(T.message),null}}return _}return this.error(`Unknown expression "${d}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(void 0===e?"'undefined' value invalid. Use null instead.":"object"==typeof e?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof e} instead.`)}concat(e,i,a){const d="number"==typeof e?this.path.concat(e):this.path,m=a?this.scope.concat(a):this.scope;return new hs(this.registry,d,i||null,m,this.errors)}error(e,...i){const a=`${this.key}${i.map(d=>`[${d}]`).join("")}`;this.errors.push(new Br(a,e))}checkSubtype(e,i){const a=hn(e,i);return a&&this.error(a),a}}var Po=hs;function ps(n){if(n instanceof Ts)return ps(n.boundExpression);if(n instanceof No&&"error"===n.name||n instanceof Ys||n instanceof Hi)return!1;const e=n instanceof ds||n instanceof so;let i=!0;return n.eachChild(a=>{i=e?i&&ps(a):i&&a instanceof ra}),!!i&&Us(n)&&Vs(n,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center"])}function fs(n,e){const i=n.length-1;let a,d,m=0,_=i,w=0;for(;m<=_;)if(w=Math.floor((m+_)/2),a=n[w],d=n[w+1],a<=e){if(w===i||e<d)return w;m=w+1}else{if(!(a>e))throw new rr("Input is not a number.");_=w-1}return 0}class Tr{constructor(e,i,a){this.type=e,this.input=i,this.labels=[],this.outputs=[];for(const[d,m]of a)this.labels.push(d),this.outputs.push(m)}static parse(e,i){if(e.length-1<4)return i.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return i.error("Expected an even number of arguments.");const a=i.parse(e[1],1,Ln);if(!a)return null;const d=[];let m=null;i.expectedType&&"value"!==i.expectedType.kind&&(m=i.expectedType);for(let _=1;_<e.length;_+=2){const w=1===_?-1/0:e[_],T=e[_+1],M=_,L=_+1;if("number"!=typeof w)return i.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',M);if(d.length&&d[d.length-1][0]>=w)return i.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',M);const z=i.parse(T,L,m);if(!z)return null;m=m||z.type,d.push([w,z])}return new Tr(m,a,d)}evaluate(e){const i=this.labels,a=this.outputs;if(1===i.length)return a[0].evaluate(e);const d=this.input.evaluate(e);if(d<=i[0])return a[0].evaluate(e);const m=i.length;return d>=i[m-1]?a[m-1].evaluate(e):a[fs(i,d)].evaluate(e)}eachChild(e){e(this.input);for(const i of this.outputs)e(i)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}serialize(){const e=["step",this.input.serialize()];for(let i=0;i<this.labels.length;i++)i>0&&e.push(this.labels[i]),e.push(this.outputs[i].serialize());return e}}var Es=Tr;function ji(n,e,i){return n*(1-i)+e*i}var zr=Object.freeze({__proto__:null,number:ji,color:function(n,e,i){return new fr(ji(n.r,e.r,i),ji(n.g,e.g,i),ji(n.b,e.b,i),ji(n.a,e.a,i))},array:function(n,e,i){return n.map((a,d)=>ji(a,e[d],i))}});const ms=4/29,Yr=6/29,ka=3*Yr*Yr,Ca=Math.PI/180,Ta=180/Math.PI;function ee(n){return n>.008856451679035631?Math.pow(n,1/3):n/ka+ms}function X(n){return n>Yr?n*n*n:ka*(n-ms)}function q(n){return 255*(n<=.0031308?12.92*n:1.055*Math.pow(n,1/2.4)-.055)}function Te(n){return(n/=255)<=.04045?n/12.92:Math.pow((n+.055)/1.055,2.4)}function dn(n){const e=Te(n.r),i=Te(n.g),a=Te(n.b),d=ee((.4124564*e+.3575761*i+.1804375*a)/.95047),m=ee((.2126729*e+.7151522*i+.072175*a)/1);return{l:116*m-16,a:500*(d-m),b:200*(m-ee((.0193339*e+.119192*i+.9503041*a)/1.08883)),alpha:n.a}}function ti(n){let e=(n.l+16)/116,i=isNaN(n.a)?e:e+n.a/500,a=isNaN(n.b)?e:e-n.b/200;return e=1*X(e),i=.95047*X(i),a=1.08883*X(a),new fr(q(3.2404542*i-1.5371385*e-.4985314*a),q(-.969266*i+1.8760108*e+.041556*a),q(.0556434*i-.2040259*e+1.0572252*a),n.alpha)}function Nr(n,e,i){const a=e-n;return n+i*(a>180||a<-180?a-360*Math.round(a/360):a)}const lo={forward:dn,reverse:ti,interpolate:function(n,e,i){return{l:ji(n.l,e.l,i),a:ji(n.a,e.a,i),b:ji(n.b,e.b,i),alpha:ji(n.alpha,e.alpha,i)}}},Vo={forward:function(n){const{l:e,a:i,b:a}=dn(n),d=Math.atan2(a,i)*Ta;return{h:d<0?d+360:d,c:Math.sqrt(i*i+a*a),l:e,alpha:n.a}},reverse:function(n){const e=n.h*Ca,i=n.c;return ti({l:n.l,a:Math.cos(e)*i,b:Math.sin(e)*i,alpha:n.alpha})},interpolate:function(n,e,i){return{h:Nr(n.h,e.h,i),c:ji(n.c,e.c,i),l:ji(n.l,e.l,i),alpha:ji(n.alpha,e.alpha,i)}}};var la=Object.freeze({__proto__:null,lab:lo,hcl:Vo});class El{constructor(e,i,a,d,m){this.type=e,this.operator=i,this.interpolation=a,this.input=d,this.labels=[],this.outputs=[];for(const[_,w]of m)this.labels.push(_),this.outputs.push(w)}static interpolationFactor(e,i,a,d){let m=0;if("exponential"===e.name)m=Dl(i,e.base,a,d);else if("linear"===e.name)m=Dl(i,1,a,d);else if("cubic-bezier"===e.name){const _=e.controlPoints;m=new Ke(_[0],_[1],_[2],_[3]).solve(Dl(i,1,a,d))}return m}static parse(e,i){let[a,d,m,..._]=e;if(!Array.isArray(d)||0===d.length)return i.error("Expected an interpolation type expression.",1);if("linear"===d[0])d={name:"linear"};else if("exponential"===d[0]){const M=d[1];if("number"!=typeof M)return i.error("Exponential interpolation requires a numeric base.",1,1);d={name:"exponential",base:M}}else{if("cubic-bezier"!==d[0])return i.error(`Unknown interpolation type ${String(d[0])}`,1,0);{const M=d.slice(1);if(4!==M.length||M.some(L=>"number"!=typeof L||L<0||L>1))return i.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);d={name:"cubic-bezier",controlPoints:M}}}if(e.length-1<4)return i.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return i.error("Expected an even number of arguments.");if(m=i.parse(m,2,Ln),!m)return null;const w=[];let T=null;"interpolate-hcl"===a||"interpolate-lab"===a?T=Wn:i.expectedType&&"value"!==i.expectedType.kind&&(T=i.expectedType);for(let M=0;M<_.length;M+=2){const L=_[M],z=_[M+1],V=M+3,K=M+4;if("number"!=typeof L)return i.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',V);if(w.length&&w[w.length-1][0]>=L)return i.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',V);const ne=i.parse(z,K,T);if(!ne)return null;T=T||ne.type,w.push([L,ne])}return"number"===T.kind||"color"===T.kind||"array"===T.kind&&"number"===T.itemType.kind&&"number"==typeof T.N?new El(T,a,d,m,w):i.error(`Type ${pt(T)} is not interpolatable.`)}evaluate(e){const i=this.labels,a=this.outputs;if(1===i.length)return a[0].evaluate(e);const d=this.input.evaluate(e);if(d<=i[0])return a[0].evaluate(e);const m=i.length;if(d>=i[m-1])return a[m-1].evaluate(e);const _=fs(i,d),w=El.interpolationFactor(this.interpolation,d,i[_],i[_+1]),T=a[_].evaluate(e),M=a[_+1].evaluate(e);return"interpolate"===this.operator?zr[this.type.kind.toLowerCase()](T,M,w):"interpolate-hcl"===this.operator?Vo.reverse(Vo.interpolate(Vo.forward(T),Vo.forward(M),w)):lo.reverse(lo.interpolate(lo.forward(T),lo.forward(M),w))}eachChild(e){e(this.input);for(const i of this.outputs)e(i)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}serialize(){let e;e="linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const i=[this.operator,e,this.input.serialize()];for(let a=0;a<this.labels.length;a++)i.push(this.labels[a],this.outputs[a].serialize());return i}}function Dl(n,e,i,a){const d=a-i,m=n-i;return 0===d?0:1===e?m/d:(Math.pow(e,m)-1)/(Math.pow(e,d)-1)}var Dn=El;class Ji{constructor(e,i){this.type=e,this.args=i}static parse(e,i){if(e.length<2)return i.error("Expectected at least one argument.");let a=null;const d=i.expectedType;d&&"value"!==d.kind&&(a=d);const m=[];for(const w of e.slice(1)){const T=i.parse(w,1+m.length,a,void 0,{typeAnnotation:"omit"});if(!T)return null;a=a||T.type,m.push(T)}const _=d&&m.some(w=>hn(d,w.type));return new Ji(_?Oe:a,m)}evaluate(e){let i,a=null,d=0;for(const m of this.args){if(d++,a=m.evaluate(e),a&&a instanceof io&&!a.available&&(i||(i=a),a=null,d===this.args.length))return i;if(null!==a)break}return a}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){const e=["coalesce"];return this.eachChild(i=>{e.push(i.serialize())}),e}}var Il=Ji;class Ml{constructor(e,i){this.type=i.type,this.bindings=[].concat(e),this.result=i}evaluate(e){return this.result.evaluate(e)}eachChild(e){for(const i of this.bindings)e(i[1]);e(this.result)}static parse(e,i){if(e.length<4)return i.error(`Expected at least 3 arguments, but found ${e.length-1} instead.`);const a=[];for(let m=1;m<e.length-1;m+=2){const _=e[m];if("string"!=typeof _)return i.error(`Expected string, but found ${typeof _} instead.`,m);if(/[^a-zA-Z0-9_]/.test(_))return i.error("Variable names must contain only alphanumeric characters or '_'.",m);const w=i.parse(e[m+1],m+1);if(!w)return null;a.push([_,w])}const d=i.parse(e[e.length-1],e.length-1,i.expectedType,a);return d?new Ml(a,d):null}outputDefined(){return this.result.outputDefined()}serialize(){const e=["let"];for(const[i,a]of this.bindings)e.push(i,a.serialize());return e.push(this.result.serialize()),e}}var ro=Ml;class ca{constructor(e,i,a){this.type=e,this.index=i,this.input=a}static parse(e,i){if(3!==e.length)return i.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const a=i.parse(e[1],1,Ln),d=i.parse(e[2],2,He(i.expectedType||Oe));return a&&d?new ca(d.type.itemType,a,d):null}evaluate(e){const i=this.index.evaluate(e),a=this.input.evaluate(e);if(i<0)throw new rr(`Array index out of bounds: ${i} < 0.`);if(i>=a.length)throw new rr(`Array index out of bounds: ${i} > ${a.length-1}.`);if(i!==Math.floor(i))throw new rr(`Array index must be an integer, but found ${i} instead.`);return a[i]}eachChild(e){e(this.index),e(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}var js=ca;class co{constructor(e,i){this.type=ri,this.needle=e,this.haystack=i}static parse(e,i){if(3!==e.length)return i.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const a=i.parse(e[1],1,Oe),d=i.parse(e[2],2,Oe);return a&&d?nn(a.type,[ri,hi,Ln,cr,Oe])?new co(a,d):i.error(`Expected first argument to be of type boolean, string, number or null, but found ${pt(a.type)} instead`):null}evaluate(e){const i=this.needle.evaluate(e),a=this.haystack.evaluate(e);if(null==a)return!1;if(!kn(i,["boolean","string","number","null"]))throw new rr(`Expected first argument to be of type boolean, string, number or null, but found ${pt(Dr(i))} instead.`);if(!kn(a,["string","array"]))throw new rr(`Expected second argument to be of type array or string, but found ${pt(Dr(a))} instead.`);return a.indexOf(i)>=0}eachChild(e){e(this.needle),e(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}var Xs=co;class ua{constructor(e,i,a){this.type=Ln,this.needle=e,this.haystack=i,this.fromIndex=a}static parse(e,i){if(e.length<=2||e.length>=5)return i.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const a=i.parse(e[1],1,Oe),d=i.parse(e[2],2,Oe);if(!a||!d)return null;if(!nn(a.type,[ri,hi,Ln,cr,Oe]))return i.error(`Expected first argument to be of type boolean, string, number or null, but found ${pt(a.type)} instead`);if(4===e.length){const m=i.parse(e[3],3,Ln);return m?new ua(a,d,m):null}return new ua(a,d)}evaluate(e){const i=this.needle.evaluate(e),a=this.haystack.evaluate(e);if(!kn(i,["boolean","string","number","null"]))throw new rr(`Expected first argument to be of type boolean, string, number or null, but found ${pt(Dr(i))} instead.`);if(!kn(a,["string","array"]))throw new rr(`Expected second argument to be of type array or string, but found ${pt(Dr(a))} instead.`);if(this.fromIndex){const d=this.fromIndex.evaluate(e);return a.indexOf(i,d)}return a.indexOf(i)}eachChild(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)}outputDefined(){return!1}serialize(){if(null!=this.fromIndex&&void 0!==this.fromIndex){const e=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),e]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}var Tc=ua;class rl{constructor(e,i,a,d,m,_){this.inputType=e,this.type=i,this.input=a,this.cases=d,this.outputs=m,this.otherwise=_}static parse(e,i){if(e.length<5)return i.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if(e.length%2!=1)return i.error("Expected an even number of arguments.");let a,d;i.expectedType&&"value"!==i.expectedType.kind&&(d=i.expectedType);const m={},_=[];for(let M=2;M<e.length-1;M+=2){let L=e[M];const z=e[M+1];Array.isArray(L)||(L=[L]);const V=i.concat(M);if(0===L.length)return V.error("Expected at least one branch label.");for(const ne of L){if("number"!=typeof ne&&"string"!=typeof ne)return V.error("Branch labels must be numbers or strings.");if("number"==typeof ne&&Math.abs(ne)>Number.MAX_SAFE_INTEGER)return V.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if("number"==typeof ne&&Math.floor(ne)!==ne)return V.error("Numeric branch labels must be integer values.");if(a){if(V.checkSubtype(a,Dr(ne)))return null}else a=Dr(ne);if(void 0!==m[String(ne)])return V.error("Branch labels must be unique.");m[String(ne)]=_.length}const K=i.parse(z,M,d);if(!K)return null;d=d||K.type,_.push(K)}const w=i.parse(e[1],1,Oe);if(!w)return null;const T=i.parse(e[e.length-1],e.length-1,d);return T?"value"!==w.type.kind&&i.concat(1).checkSubtype(a,w.type)?null:new rl(a,d,w,m,_,T):null}evaluate(e){const i=this.input.evaluate(e);return(Dr(i)===this.inputType&&this.outputs[this.cases[i]]||this.otherwise).evaluate(e)}eachChild(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)}outputDefined(){return this.outputs.every(e=>e.outputDefined())&&this.otherwise.outputDefined()}serialize(){const e=["match",this.input.serialize()],i=Object.keys(this.cases).sort(),a=[],d={};for(const _ of i){const w=d[this.cases[_]];void 0===w?(d[this.cases[_]]=a.length,a.push([this.cases[_],[_]])):a[w][1].push(_)}const m=_=>"number"===this.inputType.kind?Number(_):_;for(const[_,w]of a)e.push(1===w.length?m(w[0]):w.map(m)),e.push(this.outputs[_].serialize());return e.push(this.otherwise.serialize()),e}}var ol=rl;class E{constructor(e,i,a){this.type=e,this.branches=i,this.otherwise=a}static parse(e,i){if(e.length<4)return i.error(`Expected at least 3 arguments, but found only ${e.length-1}.`);if(e.length%2!=0)return i.error("Expected an odd number of arguments.");let a;i.expectedType&&"value"!==i.expectedType.kind&&(a=i.expectedType);const d=[];for(let _=1;_<e.length-1;_+=2){const w=i.parse(e[_],_,ri);if(!w)return null;const T=i.parse(e[_+1],_+1,a);if(!T)return null;d.push([w,T]),a=a||T.type}const m=i.parse(e[e.length-1],e.length-1,a);return m?new E(a,d,m):null}evaluate(e){for(const[i,a]of this.branches)if(i.evaluate(e))return a.evaluate(e);return this.otherwise.evaluate(e)}eachChild(e){for(const[i,a]of this.branches)e(i),e(a);e(this.otherwise)}outputDefined(){return this.branches.every(([e,i])=>i.outputDefined())&&this.otherwise.outputDefined()}serialize(){const e=["case"];return this.eachChild(i=>{e.push(i.serialize())}),e}}var Z=E;class I{constructor(e,i,a,d){this.type=e,this.input=i,this.beginIndex=a,this.endIndex=d}static parse(e,i){if(e.length<=2||e.length>=5)return i.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const a=i.parse(e[1],1,Oe),d=i.parse(e[2],2,Ln);if(!a||!d)return null;if(!nn(a.type,[He(Oe),hi,Oe]))return i.error(`Expected first argument to be of type array or string, but found ${pt(a.type)} instead`);if(4===e.length){const m=i.parse(e[3],3,Ln);return m?new I(a.type,a,d,m):null}return new I(a.type,a,d)}evaluate(e){const i=this.input.evaluate(e),a=this.beginIndex.evaluate(e);if(!kn(i,["string","array"]))throw new rr(`Expected first argument to be of type array or string, but found ${pt(Dr(i))} instead.`);if(this.endIndex){const d=this.endIndex.evaluate(e);return i.slice(a,d)}return i.slice(a)}eachChild(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)}outputDefined(){return!1}serialize(){if(null!=this.endIndex&&void 0!==this.endIndex){const e=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),e]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}var $=I;function ve(n,e){return"=="===n||"!="===n?"boolean"===e.kind||"string"===e.kind||"number"===e.kind||"null"===e.kind||"value"===e.kind:"string"===e.kind||"number"===e.kind||"value"===e.kind}function St(n,e,i,a){return 0===a.compare(e,i)}function Cn(n,e,i){const a="=="!==n&&"!="!==n;return class j0{constructor(m,_,w){this.type=ri,this.lhs=m,this.rhs=_,this.collator=w,this.hasUntypedArgument="value"===m.type.kind||"value"===_.type.kind}static parse(m,_){if(3!==m.length&&4!==m.length)return _.error("Expected two or three arguments.");const w=m[0];let T=_.parse(m[1],1,Oe);if(!T)return null;if(!ve(w,T.type))return _.concat(1).error(`"${w}" comparisons are not supported for type '${pt(T.type)}'.`);let M=_.parse(m[2],2,Oe);if(!M)return null;if(!ve(w,M.type))return _.concat(2).error(`"${w}" comparisons are not supported for type '${pt(M.type)}'.`);if(T.type.kind!==M.type.kind&&"value"!==T.type.kind&&"value"!==M.type.kind)return _.error(`Cannot compare types '${pt(T.type)}' and '${pt(M.type)}'.`);a&&("value"===T.type.kind&&"value"!==M.type.kind?T=new so(M.type,[T]):"value"!==T.type.kind&&"value"===M.type.kind&&(M=new so(T.type,[M])));let L=null;if(4===m.length){if("string"!==T.type.kind&&"string"!==M.type.kind&&"value"!==T.type.kind&&"value"!==M.type.kind)return _.error("Cannot use collator to compare non-string types.");if(L=_.parse(m[3],3,Lt),!L)return null}return new j0(T,M,L)}evaluate(m){const _=this.lhs.evaluate(m),w=this.rhs.evaluate(m);if(a&&this.hasUntypedArgument){const T=Dr(_),M=Dr(w);if(T.kind!==M.kind||"string"!==T.kind&&"number"!==T.kind)throw new rr(`Expected arguments for "${n}" to be (string, string) or (number, number), but found (${T.kind}, ${M.kind}) instead.`)}if(this.collator&&!a&&this.hasUntypedArgument){const T=Dr(_),M=Dr(w);if("string"!==T.kind||"string"!==M.kind)return e(m,_,w)}return this.collator?i(m,_,w,this.collator.evaluate(m)):e(m,_,w)}eachChild(m){m(this.lhs),m(this.rhs),this.collator&&m(this.collator)}outputDefined(){return!0}serialize(){const m=[n];return this.eachChild(_=>{m.push(_.serialize())}),m}}}const Zn=Cn("==",function(n,e,i){return e===i},St),Ei=Cn("!=",function(n,e,i){return e!==i},function(n,e,i,a){return!St(0,e,i,a)}),ii=Cn("<",function(n,e,i){return e<i},function(n,e,i,a){return a.compare(e,i)<0}),Xi=Cn(">",function(n,e,i){return e>i},function(n,e,i,a){return a.compare(e,i)>0}),ur=Cn("<=",function(n,e,i){return e<=i},function(n,e,i,a){return a.compare(e,i)<=0}),or=Cn(">=",function(n,e,i){return e>=i},function(n,e,i,a){return a.compare(e,i)>=0});class uo{constructor(e,i,a,d,m,_){this.type=hi,this.number=e,this.locale=i,this.currency=a,this.unit=d,this.minFractionDigits=m,this.maxFractionDigits=_}static parse(e,i){if(3!==e.length)return i.error("Expected two arguments.");const a=i.parse(e[1],1,Ln);if(!a)return null;const d=e[2];if("object"!=typeof d||Array.isArray(d))return i.error("NumberFormat options argument must be an object.");let m=null;if(d.locale&&(m=i.parse(d.locale,1,hi),!m))return null;let _=null;if(d.currency&&(_=i.parse(d.currency,1,hi),!_))return null;let w=null;if(d.unit&&(w=i.parse(d.unit,1,hi),!w))return null;let T=null;if(d["min-fraction-digits"]&&(T=i.parse(d["min-fraction-digits"],1,Ln),!T))return null;let M=null;return d["max-fraction-digits"]&&(M=i.parse(d["max-fraction-digits"],1,Ln),!M)?null:new uo(a,m,_,w,T,M)}evaluate(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(e):void 0,unit:this.unit?this.unit.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))}eachChild(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.unit&&e(this.unit),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const e={};return this.locale&&(e.locale=this.locale.serialize()),this.currency&&(e.currency=this.currency.serialize()),this.unit&&(e.unit=this.unit.serialize()),this.minFractionDigits&&(e["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(e["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),e]}}class eo{constructor(e){this.type=Ln,this.input=e}static parse(e,i){if(2!==e.length)return i.error(`Expected 1 argument, but found ${e.length-1} instead.`);const a=i.parse(e[1],1);return a?"array"!==a.type.kind&&"string"!==a.type.kind&&"value"!==a.type.kind?i.error(`Expected argument of type string or array, but found ${pt(a.type)} instead.`):new eo(a):null}evaluate(e){const i=this.input.evaluate(e);if("string"==typeof i||Array.isArray(i))return i.length;throw new rr(`Expected value to be of type string or array, but found ${pt(Dr(i))} instead.`)}eachChild(e){e(this.input)}outputDefined(){return!1}serialize(){const e=["length"];return this.eachChild(i=>{e.push(i.serialize())}),e}}const Ds={"==":Zn,"!=":Ei,">":Xi,"<":ii,">=":or,"<=":ur,array:so,at:js,boolean:so,case:Z,coalesce:Il,collator:Ys,format:ao,image:Wr,in:Xs,"index-of":Tc,interpolate:Dn,"interpolate-hcl":Dn,"interpolate-lab":Dn,length:eo,let:ro,literal:ra,match:ol,number:so,"number-format":uo,object:so,slice:$,step:Es,string:so,"to-boolean":ds,"to-color":ds,"to-number":ds,"to-string":ds,var:Ts,within:Hi};function Is(n,[e,i,a,d]){e=e.evaluate(n),i=i.evaluate(n),a=a.evaluate(n);const m=d?d.evaluate(n):1,_=ia(e,i,a,m);if(_)throw new rr(_);return new fr(e/255*m,i/255*m,a/255*m,m)}function Ba(n,e){return n in e}function za(n,e){const i=e[n];return void 0===i?null:i}function da(n){return{type:n}}No.register(Ds,{error:[{kind:"error"},[hi],(n,[e])=>{throw new rr(e.evaluate(n))}],typeof:[hi,[Oe],(n,[e])=>pt(Dr(e.evaluate(n)))],"to-rgba":[He(Ln,4),[Wn],(n,[e])=>e.evaluate(n).toArray()],rgb:[Wn,[Ln,Ln,Ln],Is],rgba:[Wn,[Ln,Ln,Ln,Ln],Is],has:{type:ri,overloads:[[[hi],(n,[e])=>Ba(e.evaluate(n),n.properties())],[[hi,xe],(n,[e,i])=>Ba(e.evaluate(n),i.evaluate(n))]]},get:{type:Oe,overloads:[[[hi],(n,[e])=>za(e.evaluate(n),n.properties())],[[hi,xe],(n,[e,i])=>za(e.evaluate(n),i.evaluate(n))]]},"feature-state":[Oe,[hi],(n,[e])=>za(e.evaluate(n),n.featureState||{})],properties:[xe,[],n=>n.properties()],"geometry-type":[hi,[],n=>n.geometryType()],id:[Oe,[],n=>n.id()],zoom:[Ln,[],n=>n.globals.zoom],pitch:[Ln,[],n=>n.globals.pitch||0],"distance-from-center":[Ln,[],n=>n.distanceFromCenter()],"heatmap-density":[Ln,[],n=>n.globals.heatmapDensity||0],"line-progress":[Ln,[],n=>n.globals.lineProgress||0],"sky-radial-progress":[Ln,[],n=>n.globals.skyRadialProgress||0],accumulated:[Oe,[],n=>void 0===n.globals.accumulated?null:n.globals.accumulated],"+":[Ln,da(Ln),(n,e)=>{let i=0;for(const a of e)i+=a.evaluate(n);return i}],"*":[Ln,da(Ln),(n,e)=>{let i=1;for(const a of e)i*=a.evaluate(n);return i}],"-":{type:Ln,overloads:[[[Ln,Ln],(n,[e,i])=>e.evaluate(n)-i.evaluate(n)],[[Ln],(n,[e])=>-e.evaluate(n)]]},"/":[Ln,[Ln,Ln],(n,[e,i])=>e.evaluate(n)/i.evaluate(n)],"%":[Ln,[Ln,Ln],(n,[e,i])=>e.evaluate(n)%i.evaluate(n)],ln2:[Ln,[],()=>Math.LN2],pi:[Ln,[],()=>Math.PI],e:[Ln,[],()=>Math.E],"^":[Ln,[Ln,Ln],(n,[e,i])=>Math.pow(e.evaluate(n),i.evaluate(n))],sqrt:[Ln,[Ln],(n,[e])=>Math.sqrt(e.evaluate(n))],log10:[Ln,[Ln],(n,[e])=>Math.log(e.evaluate(n))/Math.LN10],ln:[Ln,[Ln],(n,[e])=>Math.log(e.evaluate(n))],log2:[Ln,[Ln],(n,[e])=>Math.log(e.evaluate(n))/Math.LN2],sin:[Ln,[Ln],(n,[e])=>Math.sin(e.evaluate(n))],cos:[Ln,[Ln],(n,[e])=>Math.cos(e.evaluate(n))],tan:[Ln,[Ln],(n,[e])=>Math.tan(e.evaluate(n))],asin:[Ln,[Ln],(n,[e])=>Math.asin(e.evaluate(n))],acos:[Ln,[Ln],(n,[e])=>Math.acos(e.evaluate(n))],atan:[Ln,[Ln],(n,[e])=>Math.atan(e.evaluate(n))],min:[Ln,da(Ln),(n,e)=>Math.min(...e.map(i=>i.evaluate(n)))],max:[Ln,da(Ln),(n,e)=>Math.max(...e.map(i=>i.evaluate(n)))],abs:[Ln,[Ln],(n,[e])=>Math.abs(e.evaluate(n))],round:[Ln,[Ln],(n,[e])=>{const i=e.evaluate(n);return i<0?-Math.round(-i):Math.round(i)}],floor:[Ln,[Ln],(n,[e])=>Math.floor(e.evaluate(n))],ceil:[Ln,[Ln],(n,[e])=>Math.ceil(e.evaluate(n))],"filter-==":[ri,[hi,Oe],(n,[e,i])=>n.properties()[e.value]===i.value],"filter-id-==":[ri,[Oe],(n,[e])=>n.id()===e.value],"filter-type-==":[ri,[hi],(n,[e])=>n.geometryType()===e.value],"filter-<":[ri,[hi,Oe],(n,[e,i])=>{const a=n.properties()[e.value],d=i.value;return typeof a==typeof d&&a<d}],"filter-id-<":[ri,[Oe],(n,[e])=>{const i=n.id(),a=e.value;return typeof i==typeof a&&i<a}],"filter->":[ri,[hi,Oe],(n,[e,i])=>{const a=n.properties()[e.value],d=i.value;return typeof a==typeof d&&a>d}],"filter-id->":[ri,[Oe],(n,[e])=>{const i=n.id(),a=e.value;return typeof i==typeof a&&i>a}],"filter-<=":[ri,[hi,Oe],(n,[e,i])=>{const a=n.properties()[e.value],d=i.value;return typeof a==typeof d&&a<=d}],"filter-id-<=":[ri,[Oe],(n,[e])=>{const i=n.id(),a=e.value;return typeof i==typeof a&&i<=a}],"filter->=":[ri,[hi,Oe],(n,[e,i])=>{const a=n.properties()[e.value],d=i.value;return typeof a==typeof d&&a>=d}],"filter-id->=":[ri,[Oe],(n,[e])=>{const i=n.id(),a=e.value;return typeof i==typeof a&&i>=a}],"filter-has":[ri,[Oe],(n,[e])=>e.value in n.properties()],"filter-has-id":[ri,[],n=>null!==n.id()&&void 0!==n.id()],"filter-type-in":[ri,[He(hi)],(n,[e])=>e.value.indexOf(n.geometryType())>=0],"filter-id-in":[ri,[He(Oe)],(n,[e])=>e.value.indexOf(n.id())>=0],"filter-in-small":[ri,[hi,He(Oe)],(n,[e,i])=>i.value.indexOf(n.properties()[e.value])>=0],"filter-in-large":[ri,[hi,He(Oe)],(n,[e,i])=>function(a,d,m,_){for(;m<=_;){const w=m+_>>1;if(d[w]===a)return!0;d[w]>a?_=w-1:m=w+1}return!1}(n.properties()[e.value],i.value,0,i.value.length-1)],all:{type:ri,overloads:[[[ri,ri],(n,[e,i])=>e.evaluate(n)&&i.evaluate(n)],[da(ri),(n,e)=>{for(const i of e)if(!i.evaluate(n))return!1;return!0}]]},any:{type:ri,overloads:[[[ri,ri],(n,[e,i])=>e.evaluate(n)||i.evaluate(n)],[da(ri),(n,e)=>{for(const i of e)if(i.evaluate(n))return!0;return!1}]]},"!":[ri,[ri],(n,[e])=>!e.evaluate(n)],"is-supported-script":[ri,[hi],(n,[e])=>{const i=n.globals&&n.globals.isSupportedScript;return!i||i(e.evaluate(n))}],upcase:[hi,[hi],(n,[e])=>e.evaluate(n).toUpperCase()],downcase:[hi,[hi],(n,[e])=>e.evaluate(n).toLowerCase()],concat:[hi,da(Oe),(n,e)=>e.map(i=>Mo(i.evaluate(n))).join("")],"resolved-locale":[hi,[Lt],(n,[e])=>e.evaluate(n).resolvedLocale()]});var Ms=Ds;function Hl(n){return{result:"success",value:n}}function ha(n){return{result:"error",value:n}}function _o(n){return"data-driven"===n["property-type"]||"cross-faded-data-driven"===n["property-type"]}function Ea(n){return!!n.expression&&n.expression.parameters.indexOf("zoom")>-1}function vr(n){return!!n.expression&&n.expression.interpolated}function U(n){return n instanceof Number?"number":n instanceof String?"string":n instanceof Boolean?"boolean":Array.isArray(n)?"array":null===n?"null":typeof n}function ce(n){return"object"==typeof n&&null!==n&&!Array.isArray(n)}function W(n){return n}function Me(n,e){const i="color"===e.type,a=n.stops&&"object"==typeof n.stops[0][0],d=a||!(a||void 0!==n.property),m=n.type||(vr(e)?"exponential":"interval");if(i&&((n=ar({},n)).stops&&(n.stops=n.stops.map(M=>[M[0],fr.parse(M[1])])),n.default=fr.parse(n.default?n.default:e.default)),n.colorSpace&&"rgb"!==n.colorSpace&&!la[n.colorSpace])throw new Error(`Unknown color space: ${n.colorSpace}`);let _,w,T;if("exponential"===m)_=li;else if("interval"===m)_=Tn;else if("categorical"===m){_=fn,w=Object.create(null);for(const M of n.stops)w[M[0]]=M[1];T=typeof n.stops[0][0]}else{if("identity"!==m)throw new Error(`Unknown function type "${m}"`);_=sr}if(a){const M={},L=[];for(let K=0;K<n.stops.length;K++){const ne=n.stops[K],ge=ne[0].zoom;void 0===M[ge]&&(M[ge]={zoom:ge,type:n.type,property:n.property,default:n.default,stops:[]},L.push(ge)),M[ge].stops.push([ne[0].value,ne[1]])}const z=[];for(const K of L)z.push([M[K].zoom,Me(M[K],e)]);const V={name:"linear"};return{kind:"composite",interpolationType:V,interpolationFactor:Dn.interpolationFactor.bind(void 0,V),zoomStops:z.map(K=>K[0]),evaluate:({zoom:K},ne)=>li({stops:z,base:n.base},e,K).evaluate(K,ne)}}if(d){const M="exponential"===m?{name:"exponential",base:void 0!==n.base?n.base:1}:null;return{kind:"camera",interpolationType:M,interpolationFactor:Dn.interpolationFactor.bind(void 0,M),zoomStops:n.stops.map(L=>L[0]),evaluate:({zoom:L})=>_(n,e,L,w,T)}}return{kind:"source",evaluate(M,L){const z=L&&L.properties?L.properties[n.property]:void 0;return void 0===z?Tt(n.default,e.default):_(n,e,z,w,T)}}}function Tt(n,e,i){return void 0!==n?n:void 0!==e?e:void 0!==i?i:void 0}function fn(n,e,i,a,d){return Tt(typeof i===d?a[i]:void 0,n.default,e.default)}function Tn(n,e,i){if("number"!==U(i))return Tt(n.default,e.default);const a=n.stops.length;if(1===a||i<=n.stops[0][0])return n.stops[0][1];if(i>=n.stops[a-1][0])return n.stops[a-1][1];const d=fs(n.stops.map(m=>m[0]),i);return n.stops[d][1]}function li(n,e,i){const a=void 0!==n.base?n.base:1;if("number"!==U(i))return Tt(n.default,e.default);const d=n.stops.length;if(1===d||i<=n.stops[0][0])return n.stops[0][1];if(i>=n.stops[d-1][0])return n.stops[d-1][1];const m=fs(n.stops.map(L=>L[0]),i),_=function(L,z,V,K){const ne=K-V,ge=L-V;return 0===ne?0:1===z?ge/ne:(Math.pow(z,ge)-1)/(Math.pow(z,ne)-1)}(i,a,n.stops[m][0],n.stops[m+1][0]),w=n.stops[m][1],T=n.stops[m+1][1];let M=zr[e.type]||W;if(n.colorSpace&&"rgb"!==n.colorSpace){const L=la[n.colorSpace];M=(z,V)=>L.reverse(L.interpolate(L.forward(z),L.forward(V),_))}return"function"==typeof w.evaluate?{evaluate(...L){const z=w.evaluate.apply(void 0,L),V=T.evaluate.apply(void 0,L);if(void 0!==z&&void 0!==V)return M(z,V,_)}}:M(w,T,_)}function sr(n,e,i){return"color"===e.type?i=fr.parse(i):"formatted"===e.type?i=bo.fromString(i.toString()):"resolvedImage"===e.type?i=io.fromString(i.toString()):U(i)===e.type||"enum"===e.type&&e.values[i]||(i=void 0),Tt(i,n.default,e.default)}class nr{constructor(e,i){var a;this.expression=e,this._warningHistory={},this._evaluator=new oa,this._defaultValue=i?"color"===(a=i).type&&(ce(a.default)||Array.isArray(a.default))?new fr(0,0,0,0):"color"===a.type?fr.parse(a.default)||null:void 0===a.default?null:a.default:null,this._enumValues=i&&"enum"===i.type?i.values:null}evaluateWithoutErrorHandling(e,i,a,d,m,_,w,T){return this._evaluator.globals=e,this._evaluator.feature=i,this._evaluator.featureState=a,this._evaluator.canonical=d||null,this._evaluator.availableImages=m||null,this._evaluator.formattedSection=_,this._evaluator.featureTileCoord=w||null,this._evaluator.featureDistanceData=T||null,this.expression.evaluate(this._evaluator)}evaluate(e,i,a,d,m,_,w,T){this._evaluator.globals=e,this._evaluator.feature=i||null,this._evaluator.featureState=a||null,this._evaluator.canonical=d||null,this._evaluator.availableImages=m||null,this._evaluator.formattedSection=_||null,this._evaluator.featureTileCoord=w||null,this._evaluator.featureDistanceData=T||null;try{const M=this.expression.evaluate(this._evaluator);if(null==M||"number"==typeof M&&M!=M)return this._defaultValue;if(this._enumValues&&!(M in this._enumValues))throw new rr(`Expected value to be one of ${Object.keys(this._enumValues).map(L=>JSON.stringify(L)).join(", ")}, but found ${JSON.stringify(M)} instead.`);return M}catch(M){return this._warningHistory[M.message]||(this._warningHistory[M.message]=!0,typeof console<"u"&&console.warn(M.message)),this._defaultValue}}}function dr(n){return Array.isArray(n)&&n.length>0&&"string"==typeof n[0]&&n[0]in Ms}function Wi(n,e){const i=new Po(Ms,[],e?function(d){const m={color:Wn,string:hi,number:Ln,enum:hi,boolean:ri,formatted:$t,resolvedImage:tn};return"array"===d.type?He(m[d.value]||Oe,d.length):m[d.type]}(e):void 0),a=i.parse(n,void 0,void 0,void 0,e&&"string"===e.type?{typeAnnotation:"coerce"}:void 0);return a?Hl(new nr(a,e)):ha(i.errors)}class Sr{constructor(e,i){this.kind=e,this._styleExpression=i,this.isStateDependent="constant"!==e&&!Cs(i.expression)}evaluateWithoutErrorHandling(e,i,a,d,m,_){return this._styleExpression.evaluateWithoutErrorHandling(e,i,a,d,m,_)}evaluate(e,i,a,d,m,_){return this._styleExpression.evaluate(e,i,a,d,m,_)}}class gr{constructor(e,i,a,d){this.kind=e,this.zoomStops=a,this._styleExpression=i,this.isStateDependent="camera"!==e&&!Cs(i.expression),this.interpolationType=d}evaluateWithoutErrorHandling(e,i,a,d,m,_){return this._styleExpression.evaluateWithoutErrorHandling(e,i,a,d,m,_)}evaluate(e,i,a,d,m,_){return this._styleExpression.evaluate(e,i,a,d,m,_)}interpolationFactor(e,i,a){return this.interpolationType?Dn.interpolationFactor(this.interpolationType,e,i,a):0}}function to(n,e){if("error"===(n=Wi(n,e)).result)return n;const i=n.value.expression,a=Us(i);if(!a&&!_o(e))return ha([new Br("","data expressions not supported")]);const d=Vs(i,["zoom","pitch","distance-from-center"]);if(!d&&!Ea(e))return ha([new Br("","zoom expressions not supported")]);const m=Oo(i);return m||d?m instanceof Br?ha([m]):m instanceof Dn&&!vr(e)?ha([new Br("",'"interpolate" expressions cannot be used with this property')]):Hl(m?new gr(a?"camera":"composite",n.value,m.labels,m instanceof Dn?m.interpolation:void 0):new Sr(a?"constant":"source",n.value)):ha([new Br("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class jo{constructor(e,i){this._parameters=e,this._specification=i,ar(this,Me(this._parameters,this._specification))}static deserialize(e){return new jo(e._parameters,e._specification)}static serialize(e){return{_parameters:e._parameters,_specification:e._specification}}}function Oo(n){let e=null;if(n instanceof ro)e=Oo(n.result);else if(n instanceof Il){for(const i of n.args)if(e=Oo(i),e)break}else(n instanceof Es||n instanceof Dn)&&n.input instanceof No&&"zoom"===n.input.name&&(e=n);return e instanceof Br||n.eachChild(i=>{const a=Oo(i);a instanceof Br?e=a:!e&&a?e=new Br("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):e&&a&&e!==a&&(e=new Br("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),e}class Gn{constructor(e,i,a,d){this.message=(e?`${e}: `:"")+a,d&&(this.identifier=d),null!=i&&i.__line__&&(this.line=i.__line__)}}function ho(n){const e=n.key,i=n.value,a=n.valueSpec||{},d=n.objectElementValidators||{},m=n.style,_=n.styleSpec;let w=[];const T=U(i);if("object"!==T)return[new Gn(e,i,`object expected, ${T} found`)];for(const M in i){const L=M.split(".")[0],z=a[L]||a["*"];let V;d[L]?V=d[L]:a[L]?V=po:d["*"]?V=d["*"]:a["*"]&&(V=po),V?w=w.concat(V({key:(e&&`${e}.`)+M,value:i[M],valueSpec:z,style:m,styleSpec:_,object:i,objectKey:M},i)):w.push(new Gn(e,i[M],`unknown property "${M}"`))}for(const M in a)d[M]||a[M].required&&void 0===a[M].default&&void 0===i[M]&&w.push(new Gn(e,i,`missing required property "${M}"`));return w}function Na(n){const e=n.value,i=n.valueSpec,a=n.style,d=n.styleSpec,m=n.key,_=n.arrayElementValidator||po;if("array"!==U(e))return[new Gn(m,e,`array expected, ${U(e)} found`)];if(i.length&&e.length!==i.length)return[new Gn(m,e,`array length ${i.length} expected, length ${e.length} found`)];if(i["min-length"]&&e.length<i["min-length"])return[new Gn(m,e,`array length at least ${i["min-length"]} expected, length ${e.length} found`)];let w={type:i.value,values:i.values,minimum:i.minimum,maximum:i.maximum,function:void 0};d.$version<7&&(w.function=i.function),"object"===U(i.value)&&(w=i.value);let T=[];for(let M=0;M<e.length;M++)T=T.concat(_({array:e,arrayIndex:M,value:e[M],valueSpec:w,style:a,styleSpec:d,key:`${m}[${M}]`}));return T}function Wl(n){const e=n.key,i=n.value,a=n.valueSpec;let d=U(i);if("number"===d&&i!=i&&(d="NaN"),"number"!==d)return[new Gn(e,i,`number expected, ${d} found`)];if("minimum"in a){let m=a.minimum;if("array"===U(a.minimum)&&(m=a.minimum[n.arrayIndex]),i<m)return[new Gn(e,i,`${i} is less than the minimum value ${m}`)]}if("maximum"in a){let m=a.maximum;if("array"===U(a.maximum)&&(m=a.maximum[n.arrayIndex]),i>m)return[new Gn(e,i,`${i} is greater than the maximum value ${m}`)]}return[]}function ql(n){const e=n.valueSpec,i=pr(n.value.type);let a,d,m,_={};const w="categorical"!==i&&void 0===n.value.property,T=!w,M="array"===U(n.value.stops)&&"array"===U(n.value.stops[0])&&"object"===U(n.value.stops[0][0]),L=ho({key:n.key,value:n.value,valueSpec:n.styleSpec.function,style:n.style,styleSpec:n.styleSpec,objectElementValidators:{stops:function(K){if("identity"===i)return[new Gn(K.key,K.value,'identity function may not have a "stops" property')];let ne=[];const ge=K.value;return ne=ne.concat(Na({key:K.key,value:ge,valueSpec:K.valueSpec,style:K.style,styleSpec:K.styleSpec,arrayElementValidator:z})),"array"===U(ge)&&0===ge.length&&ne.push(new Gn(K.key,ge,"array must have at least one stop")),ne},default:function(K){return po({key:K.key,value:K.value,valueSpec:e,style:K.style,styleSpec:K.styleSpec})}}});return"identity"===i&&w&&L.push(new Gn(n.key,n.value,'missing required property "property"')),"identity"===i||n.value.stops||L.push(new Gn(n.key,n.value,'missing required property "stops"')),"exponential"===i&&n.valueSpec.expression&&!vr(n.valueSpec)&&L.push(new Gn(n.key,n.value,"exponential functions not supported")),n.styleSpec.$version>=8&&(T&&!_o(n.valueSpec)?L.push(new Gn(n.key,n.value,"property functions not supported")):w&&!Ea(n.valueSpec)&&L.push(new Gn(n.key,n.value,"zoom functions not supported"))),"categorical"!==i&&!M||void 0!==n.value.property||L.push(new Gn(n.key,n.value,'"property" property is required')),L;function z(K){let ne=[];const ge=K.value,ze=K.key;if("array"!==U(ge))return[new Gn(ze,ge,`array expected, ${U(ge)} found`)];if(2!==ge.length)return[new Gn(ze,ge,`array length 2 expected, length ${ge.length} found`)];if(M){if("object"!==U(ge[0]))return[new Gn(ze,ge,`object expected, ${U(ge[0])} found`)];if(void 0===ge[0].zoom)return[new Gn(ze,ge,"object stop key must have zoom")];if(void 0===ge[0].value)return[new Gn(ze,ge,"object stop key must have value")];const rt=pr(ge[0].zoom);if("number"!=typeof rt)return[new Gn(ze,ge[0].zoom,"stop zoom values must be numbers")];if(m&&m>rt)return[new Gn(ze,ge[0].zoom,"stop zoom values must appear in ascending order")];rt!==m&&(m=rt,d=void 0,_={}),ne=ne.concat(ho({key:`${ze}[0]`,value:ge[0],valueSpec:{zoom:{}},style:K.style,styleSpec:K.styleSpec,objectElementValidators:{zoom:Wl,value:V}}))}else ne=ne.concat(V({key:`${ze}[0]`,value:ge[0],valueSpec:{},style:K.style,styleSpec:K.styleSpec},ge));return dr(xo(ge[1]))?ne.concat([new Gn(`${ze}[1]`,ge[1],"expressions are not allowed in function stops.")]):ne.concat(po({key:`${ze}[1]`,value:ge[1],valueSpec:e,style:K.style,styleSpec:K.styleSpec}))}function V(K,ne){const ge=U(K.value),ze=pr(K.value),rt=null!==K.value?K.value:ne;if(a){if(ge!==a)return[new Gn(K.key,rt,`${ge} stop domain type must match previous stop domain type ${a}`)]}else a=ge;if("number"!==ge&&"string"!==ge&&"boolean"!==ge&&"number"!=typeof ze&&"string"!=typeof ze&&"boolean"!=typeof ze)return[new Gn(K.key,rt,"stop domain value must be a number, string, or boolean")];if("number"!==ge&&"categorical"!==i){let wt=`number expected, ${ge} found`;return _o(e)&&void 0===i&&(wt+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Gn(K.key,rt,wt)]}return"categorical"!==i||"number"!==ge||"number"==typeof ze&&isFinite(ze)&&Math.floor(ze)===ze?"categorical"!==i&&"number"===ge&&"number"==typeof ze&&"number"==typeof d&&void 0!==d&&ze<d?[new Gn(K.key,rt,"stop domain values must appear in ascending order")]:(d=ze,"categorical"===i&&ze in _?[new Gn(K.key,rt,"stop domain values must be unique")]:(_[ze]=!0,[])):[new Gn(K.key,rt,`integer expected, found ${String(ze)}`)]}}function $s(n){const e=("property"===n.expressionContext?to:Wi)(xo(n.value),n.valueSpec);if("error"===e.result)return e.value.map(a=>new Gn(`${n.key}${a.key}`,n.value,a.message));const i=e.value.expression||e.value._styleExpression.expression;if("property"===n.expressionContext&&"text-font"===n.propertyKey&&!i.outputDefined())return[new Gn(n.key,n.value,`Invalid data expression for "${n.propertyKey}". Output values must be contained as literals within the expression.`)];if("property"===n.expressionContext&&"layout"===n.propertyType&&!Cs(i))return[new Gn(n.key,n.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===n.expressionContext)return Yl(i,n);if(n.expressionContext&&0===n.expressionContext.indexOf("cluster")){if(!Vs(i,["zoom","feature-state"]))return[new Gn(n.key,n.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===n.expressionContext&&!Us(i))return[new Gn(n.key,n.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Yl(n,e){const i=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(e.valueSpec&&e.valueSpec.expression)for(const d of e.valueSpec.expression.parameters)i.delete(d);if(0===i.size)return[];const a=[];return n instanceof No&&i.has(n.name)?[new Gn(e.key,e.value,`["${n.name}"] expression is not supported in a filter for a ${e.object.type} layer with id: ${e.object.id}`)]:(n.eachChild(d=>{a.push(...Yl(d,e))}),a)}function Jl(n){const e=n.key,i=n.value,a=n.valueSpec,d=[];return Array.isArray(a.values)?-1===a.values.indexOf(pr(i))&&d.push(new Gn(e,i,`expected one of [${a.values.join(", ")}], ${JSON.stringify(i)} found`)):-1===Object.keys(a.values).indexOf(pr(i))&&d.push(new Gn(e,i,`expected one of [${Object.keys(a.values).join(", ")}], ${JSON.stringify(i)} found`)),d}function Ua(n){if(!0===n||!1===n)return!0;if(!Array.isArray(n)||0===n.length)return!1;switch(n[0]){case"has":return n.length>=2&&"$id"!==n[1]&&"$type"!==n[1];case"in":return n.length>=3&&("string"!=typeof n[1]||Array.isArray(n[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==n.length||Array.isArray(n[1])||Array.isArray(n[2]);case"any":case"all":for(const e of n.slice(1))if(!Ua(e)&&"boolean"!=typeof e)return!1;return!0;default:return!0}}function pa(n,e="fill"){if(null==n)return{filter:()=>!0,needGeometry:!1,needFeature:!1};Ua(n)||(n=Ec(n));const i=n;let a=!0;try{a=function(M){if(!fa(M))return M;let L=xo(M);return Va(L),L=Xl(L),L}(i)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.\nThis is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md\nand paste the contents of this message in the report.\nThank you!\nFilter Expression:\n${JSON.stringify(i,null,2)}\n        `)}const d=on[`filter_${e}`],m=Wi(a,d);let _=null;if("error"===m.result)throw new Error(m.value.map(M=>`${M.key}: ${M.message}`).join(", "));_=(M,L,z)=>m.value.evaluate(M,L,{},z);let w=null,T=null;if(a!==i){const M=Wi(i,d);if("error"===M.result)throw new Error(M.value.map(L=>`${L.key}: ${L.message}`).join(", "));w=(L,z,V,K,ne)=>M.value.evaluate(L,z,{},V,void 0,void 0,K,ne),T=!Us(M.value.expression)}return{filter:_,dynamicFilter:w||void 0,needGeometry:Sl(a),needFeature:!!T}}function Xl(n){if(!Array.isArray(n))return n;const e=function(i){if($o.has(i[0]))for(let a=1;a<i.length;a++)if(fa(i[a]))return!0;return i}(n);return!0===e?e:e.map(i=>Xl(i))}function Va(n){let e=!1;const i=[];if("case"===n[0]){for(let a=1;a<n.length-1;a+=2)e=e||fa(n[a]),i.push(n[a+1]);i.push(n[n.length-1])}else if("match"===n[0]){e=e||fa(n[1]);for(let a=2;a<n.length-1;a+=2)i.push(n[a+1]);i.push(n[n.length-1])}else if("step"===n[0]){e=e||fa(n[1]);for(let a=1;a<n.length-1;a+=2)i.push(n[a+1])}e&&(n.length=0,n.push("any",...i));for(let a=1;a<n.length;a++)Va(n[a])}function fa(n){if(!Array.isArray(n))return!1;if("pitch"===(e=n[0])||"distance-from-center"===e)return!0;var e;for(let i=1;i<n.length;i++)if(fa(n[i]))return!0;return!1}const $o=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function ja(n,e){return n<e?-1:n>e?1:0}function Sl(n){if(!Array.isArray(n))return!1;if("within"===n[0])return!0;for(let e=1;e<n.length;e++)if(Sl(n[e]))return!0;return!1}function Ec(n){if(!n)return!0;const e=n[0];return n.length<=1?"any"!==e:"=="===e?Dc(n[1],n[2],"=="):"!="===e?Ss(Dc(n[1],n[2],"==")):"<"===e||">"===e||"<="===e||">="===e?Dc(n[1],n[2],e):"any"===e?(i=n.slice(1),["any"].concat(i.map(Ec))):"all"===e?["all"].concat(n.slice(1).map(Ec)):"none"===e?["all"].concat(n.slice(1).map(Ec).map(Ss)):"in"===e?Ic(n[1],n.slice(2)):"!in"===e?Ss(Ic(n[1],n.slice(2))):"has"===e?Mc(n[1]):"!has"===e?Ss(Mc(n[1])):"within"!==e||n;var i}function Dc(n,e,i){switch(n){case"$type":return[`filter-type-${i}`,e];case"$id":return[`filter-id-${i}`,e];default:return[`filter-${i}`,n,e]}}function Ic(n,e){if(0===e.length)return!1;switch(n){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some(i=>typeof i!=typeof e[0])?["filter-in-large",n,["literal",e.sort(ja)]]:["filter-in-small",n,["literal",e]]}}function Mc(n){switch(n){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",n]}}function Ss(n){return["!",n]}function Kl(n){return Ua(xo(n.value))?$s(ar({},n,{expressionContext:"filter",valueSpec:n.styleSpec[`filter_${n.layerType||"fill"}`]})):$a(n)}function $a(n){const e=n.value,i=n.key;if("array"!==U(e))return[new Gn(i,e,`array expected, ${U(e)} found`)];const a=n.styleSpec;let d,m=[];if(e.length<1)return[new Gn(i,e,"filter array must have at least 1 element")];switch(m=m.concat(Jl({key:`${i}[0]`,value:e[0],valueSpec:a.filter_operator,style:n.style,styleSpec:n.styleSpec})),pr(e[0])){case"<":case"<=":case">":case">=":e.length>=2&&"$type"===pr(e[1])&&m.push(new Gn(i,e,`"$type" cannot be use with operator "${e[0]}"`));case"==":case"!=":3!==e.length&&m.push(new Gn(i,e,`filter array for operator "${e[0]}" must have 3 elements`));case"in":case"!in":e.length>=2&&(d=U(e[1]),"string"!==d&&m.push(new Gn(`${i}[1]`,e[1],`string expected, ${d} found`)));for(let _=2;_<e.length;_++)d=U(e[_]),"$type"===pr(e[1])?m=m.concat(Jl({key:`${i}[${_}]`,value:e[_],valueSpec:a.geometry_type,style:n.style,styleSpec:n.styleSpec})):"string"!==d&&"number"!==d&&"boolean"!==d&&m.push(new Gn(`${i}[${_}]`,e[_],`string, number, or boolean expected, ${d} found`));break;case"any":case"all":case"none":for(let _=1;_<e.length;_++)m=m.concat($a({key:`${i}[${_}]`,value:e[_],style:n.style,styleSpec:n.styleSpec}));break;case"has":case"!has":d=U(e[1]),2!==e.length?m.push(new Gn(i,e,`filter array for "${e[0]}" operator must have 2 elements`)):"string"!==d&&m.push(new Gn(`${i}[1]`,e[1],`string expected, ${d} found`));break;case"within":d=U(e[1]),2!==e.length?m.push(new Gn(i,e,`filter array for "${e[0]}" operator must have 2 elements`)):"object"!==d&&m.push(new Gn(`${i}[1]`,e[1],`object expected, ${d} found`))}return m}function Sc(n,e){const i=n.key,a=n.style,d=n.styleSpec,m=n.value,_=n.objectKey,w=d[`${e}_${n.layerType}`];if(!w)return[];const T=_.match(/^(.*)-transition$/);if("paint"===e&&T&&w[T[1]]&&w[T[1]].transition)return po({key:i,value:m,valueSpec:d.transition,style:a,styleSpec:d});const M=n.valueSpec||w[_];if(!M)return[new Gn(i,m,`unknown property "${_}"`)];let L;if("string"===U(m)&&_o(M)&&!M.tokens&&(L=/^{([^}]+)}$/.exec(m)))return[new Gn(i,m,`"${_}" does not support interpolation syntax\nUse an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(L[1])} }\`.`)];const z=[];return"symbol"===n.layerType&&("text-field"===_&&a&&!a.glyphs&&z.push(new Gn(i,m,'use of "text-field" requires a style "glyphs" property')),"text-font"===_&&ce(xo(m))&&"identity"===pr(m.type)&&z.push(new Gn(i,m,'"text-font" does not support identity functions'))),z.concat(po({key:n.key,value:m,valueSpec:M,style:a,styleSpec:d,expressionContext:"property",propertyType:e,propertyKey:_}))}function Ql(n){return Sc(n,"paint")}function ec(n){return Sc(n,"layout")}function tc(n){let e=[];const i=n.value,a=n.key,d=n.style,m=n.styleSpec;i.type||i.ref||e.push(new Gn(a,i,'either "type" or "ref" is required'));let _=pr(i.type);const w=pr(i.ref);if(i.id){const T=pr(i.id);for(let M=0;M<n.arrayIndex;M++){const L=d.layers[M];pr(L.id)===T&&e.push(new Gn(a,i.id,`duplicate layer id "${i.id}", previously used at line ${L.id.__line__}`))}}if("ref"in i){let T;["type","source","source-layer","filter","layout"].forEach(M=>{M in i&&e.push(new Gn(a,i[M],`"${M}" is prohibited for ref layers`))}),d.layers.forEach(M=>{pr(M.id)===w&&(T=M)}),T?T.ref?e.push(new Gn(a,i.ref,"ref cannot reference another ref layer")):_=pr(T.type):"string"==typeof w&&e.push(new Gn(a,i.ref,`ref layer "${w}" not found`))}else if("background"!==_&&"sky"!==_)if(i.source){const T=d.sources&&d.sources[i.source],M=T&&pr(T.type);T?"vector"===M&&"raster"===_?e.push(new Gn(a,i.source,`layer "${i.id}" requires a raster source`)):"raster"===M&&"raster"!==_?e.push(new Gn(a,i.source,`layer "${i.id}" requires a vector source`)):"vector"!==M||i["source-layer"]?"raster-dem"===M&&"hillshade"!==_?e.push(new Gn(a,i.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==_||!i.paint||!i.paint["line-gradient"]&&!i.paint["line-trim-offset"]||"geojson"===M&&T.lineMetrics||e.push(new Gn(a,i,`layer "${i.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):e.push(new Gn(a,i,`layer "${i.id}" must specify a "source-layer"`)):e.push(new Gn(a,i.source,`source "${i.source}" not found`))}else e.push(new Gn(a,i,'missing required property "source"'));return e=e.concat(ho({key:a,value:i,valueSpec:m.layer,style:n.style,styleSpec:n.styleSpec,objectElementValidators:{"*":()=>[],type:()=>po({key:`${a}.type`,value:i.type,valueSpec:m.layer.type,style:n.style,styleSpec:n.styleSpec,object:i,objectKey:"type"}),filter:T=>Kl(ar({layerType:_},T)),layout:T=>ho({layer:i,key:T.key,value:T.value,valueSpec:{},style:T.style,styleSpec:T.styleSpec,objectElementValidators:{"*":M=>ec(ar({layerType:_},M))}}),paint:T=>ho({layer:i,key:T.key,value:T.value,valueSpec:{},style:T.style,styleSpec:T.styleSpec,objectElementValidators:{"*":M=>Ql(ar({layerType:_},M))}})}})),e}function sl(n){const e=n.value,i=n.key,a=U(e);return"string"!==a?[new Gn(i,e,`string expected, ${a} found`)]:[]}const Qc={promoteId:function({key:n,value:e}){if("string"===U(e))return sl({key:n,value:e});{const i=[];for(const a in e)i.push(...sl({key:`${n}.${a}`,value:e[a]}));return i}}};function nc(n){const e=n.value,i=n.key,a=n.styleSpec,d=n.style;if(!e.type)return[new Gn(i,e,'"type" is required')];const m=pr(e.type);let _;switch(m){case"vector":case"raster":case"raster-dem":return _=ho({key:i,value:e,valueSpec:a[`source_${m.replace("-","_")}`],style:n.style,styleSpec:a,objectElementValidators:Qc}),_;case"geojson":if(_=ho({key:i,value:e,valueSpec:a.source_geojson,style:d,styleSpec:a,objectElementValidators:Qc}),e.cluster)for(const w in e.clusterProperties){const[T,M]=e.clusterProperties[w],L="string"==typeof T?[T,["accumulated"],["get",w]]:T;_.push(...$s({key:`${i}.${w}.map`,value:M,expressionContext:"cluster-map"})),_.push(...$s({key:`${i}.${w}.reduce`,value:L,expressionContext:"cluster-reduce"}))}return _;case"video":return ho({key:i,value:e,valueSpec:a.source_video,style:d,styleSpec:a});case"image":return ho({key:i,value:e,valueSpec:a.source_image,style:d,styleSpec:a});case"canvas":return[new Gn(i,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Jl({key:`${i}.type`,value:e.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:d,styleSpec:a})}}function To(n){const e=n.value,i=n.styleSpec,a=i.light,d=n.style;let m=[];const _=U(e);if(void 0===e)return m;if("object"!==_)return m=m.concat([new Gn("light",e,`object expected, ${_} found`)]),m;for(const w in e){const T=w.match(/^(.*)-transition$/);m=m.concat(T&&a[T[1]]&&a[T[1]].transition?po({key:w,value:e[w],valueSpec:i.transition,style:d,styleSpec:i}):a[w]?po({key:w,value:e[w],valueSpec:a[w],style:d,styleSpec:i}):[new Gn(w,e[w],`unknown property "${w}"`)])}return m}function Ac(n){const e=n.value,i=n.key,a=n.style,d=n.styleSpec,m=d.terrain;let _=[];const w=U(e);if(void 0===e)return _;if("object"!==w)return _=_.concat([new Gn("terrain",e,`object expected, ${w} found`)]),_;for(const T in e){const M=T.match(/^(.*)-transition$/);_=_.concat(M&&m[M[1]]&&m[M[1]].transition?po({key:T,value:e[T],valueSpec:d.transition,style:a,styleSpec:d}):m[T]?po({key:T,value:e[T],valueSpec:m[T],style:a,styleSpec:d}):[new Gn(T,e[T],`unknown property "${T}"`)])}if(e.source){const T=a.sources&&a.sources[e.source],M=T&&pr(T.type);T?"raster-dem"!==M&&_.push(new Gn(i,e.source,`terrain cannot be used with a source of type ${String(M)}, it only be used with a "raster-dem" source type`)):_.push(new Gn(i,e.source,`source "${e.source}" not found`))}else _.push(new Gn(i,e,'terrain is missing required property "source"'));return _}function ic(n){const e=n.value,i=n.style,a=n.styleSpec,d=a.fog;let m=[];const _=U(e);if(void 0===e)return m;if("object"!==_)return m=m.concat([new Gn("fog",e,`object expected, ${_} found`)]),m;for(const w in e){const T=w.match(/^(.*)-transition$/);m=m.concat(T&&d[T[1]]&&d[T[1]].transition?po({key:w,value:e[w],valueSpec:a.transition,style:i,styleSpec:a}):d[w]?po({key:w,value:e[w],valueSpec:d[w],style:i,styleSpec:a}):[new Gn(w,e[w],`unknown property "${w}"`)])}return m}const Al={"*":()=>[],array:Na,boolean:function(n){const e=n.value,i=n.key,a=U(e);return"boolean"!==a?[new Gn(i,e,`boolean expected, ${a} found`)]:[]},number:Wl,color:function(n){const e=n.key,i=n.value,a=U(i);return"string"!==a?[new Gn(e,i,`color expected, ${a} found`)]:null===ei(i)?[new Gn(e,i,`color expected, "${i}" found`)]:[]},enum:Jl,filter:Kl,function:ql,layer:tc,object:ho,source:nc,light:To,terrain:Ac,fog:ic,string:sl,formatted:function(n){return 0===sl(n).length?[]:$s(n)},resolvedImage:function(n){return 0===sl(n).length?[]:$s(n)},projection:function(n){const e=n.value,i=n.styleSpec,a=i.projection,d=n.style;let m=[];const _=U(e);if("object"===_)for(const w in e)m=m.concat(po({key:w,value:e[w],valueSpec:a[w],style:d,styleSpec:i}));else"string"!==_&&(m=m.concat([new Gn("projection",e,`object or string expected, ${_} found`)]));return m}};function po(n){const e=n.value,i=n.valueSpec,a=n.styleSpec;return i.expression&&ce(pr(e))?ql(n):i.expression&&dr(xo(e))?$s(n):i.type&&Al[i.type]?Al[i.type](n):ho(ar({},n,{valueSpec:i.type?a[i.type]:i}))}function Pc(n){const e=n.value,i=n.key,a=sl(n);return a.length||(-1===e.indexOf("{fontstack}")&&a.push(new Gn(i,e,'"glyphs" url must include a "{fontstack}" token')),-1===e.indexOf("{range}")&&a.push(new Gn(i,e,'"glyphs" url must include a "{range}" token'))),a}function Cu(n,e=on){return Ks(po({key:"",value:n,valueSpec:e.$root,styleSpec:e,style:n,objectElementValidators:{glyphs:Pc,"*":()=>[]}}))}const ud=n=>Ks(Ql(n)),Pl=n=>Ks(ec(n));function Ks(n){return n.slice().sort((e,i)=>e.line&&i.line?e.line-i.line:0)}function rc(n,e){let i=!1;if(e&&e.length)for(const a of e)n.fire(new Qr(new Error(a.message))),i=!0;return i}var As=Da;function Da(n,e,i){var a=this.cells=[];if(n instanceof ArrayBuffer){this.arrayBuffer=n;var d=new Int32Array(this.arrayBuffer);n=d[0],this.d=(e=d[1])+2*(i=d[2]);for(var m=0;m<this.d*this.d;m++){var _=d[3+m],w=d[3+m+1];a.push(_===w?null:d.subarray(_,w))}var T=d[3+a.length+1];this.keys=d.subarray(d[3+a.length],T),this.bboxes=d.subarray(T),this.insert=this._insertReadonly}else{this.d=e+2*i;for(var M=0;M<this.d*this.d;M++)a.push([]);this.keys=[],this.bboxes=[]}this.n=e,this.extent=n,this.padding=i,this.scale=e/n,this.uid=0;var L=i/e*n;this.min=-L,this.max=n+L}Da.prototype.insert=function(n,e,i,a,d){this._forEachCell(e,i,a,d,this._insertCell,this.uid++),this.keys.push(n),this.bboxes.push(e),this.bboxes.push(i),this.bboxes.push(a),this.bboxes.push(d)},Da.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Da.prototype._insertCell=function(n,e,i,a,d,m){this.cells[d].push(m)},Da.prototype.query=function(n,e,i,a,d){var m=this.min,_=this.max;if(n<=m&&e<=m&&_<=i&&_<=a&&!d)return Array.prototype.slice.call(this.keys);var w=[];return this._forEachCell(n,e,i,a,this._queryCell,w,{},d),w},Da.prototype._queryCell=function(n,e,i,a,d,m,_,w){var T=this.cells[d];if(null!==T)for(var M=this.keys,L=this.bboxes,z=0;z<T.length;z++){var V=T[z];if(void 0===_[V]){var K=4*V;(w?w(L[K+0],L[K+1],L[K+2],L[K+3]):n<=L[K+2]&&e<=L[K+3]&&i>=L[K+0]&&a>=L[K+1])?(_[V]=!0,m.push(M[V])):_[V]=!1}}},Da.prototype._forEachCell=function(n,e,i,a,d,m,_,w){for(var T=this._convertToCellCoord(n),M=this._convertToCellCoord(e),L=this._convertToCellCoord(i),z=this._convertToCellCoord(a),V=T;V<=L;V++)for(var K=M;K<=z;K++){var ne=this.d*K+V;if((!w||w(this._convertFromCellCoord(V),this._convertFromCellCoord(K),this._convertFromCellCoord(V+1),this._convertFromCellCoord(K+1)))&&d.call(this,n,e,i,a,ne,m,_,w))return}},Da.prototype._convertFromCellCoord=function(n){return(n-this.padding)/this.scale},Da.prototype._convertToCellCoord=function(n){return Math.max(0,Math.min(this.d-1,Math.floor(n*this.scale)+this.padding))},Da.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var n=this.cells,e=3+this.cells.length+1+1,i=0,a=0;a<this.cells.length;a++)i+=this.cells[a].length;var d=new Int32Array(e+i+this.keys.length+this.bboxes.length);d[0]=this.extent,d[1]=this.n,d[2]=this.padding;for(var m=e,_=0;_<n.length;_++){var w=n[_];d[3+_]=m,d.set(w,m),m+=w.length}return d[3+n.length]=m,d.set(this.keys,m),d[3+n.length+1]=m+=this.keys.length,d.set(this.bboxes,m),m+=this.bboxes.length,d.buffer};const Ol={};function Jn(n,e,i={}){Object.defineProperty(n,"_classRegistryKey",{value:e,writeable:!1}),Ol[e]={klass:n,omit:i.omit||[]}}Jn(Object,"Object"),As.serialize=function(n,e){const i=n.toArrayBuffer();return e&&e.push(i),{buffer:i}},As.deserialize=function(n){return new As(n.buffer)},Object.defineProperty(As,"name",{value:"Grid"}),Jn(As,"Grid"),Jn(fr,"Color"),Jn(Error,"Error"),Jn(re,"AJAXError"),Jn(io,"ResolvedImage"),Jn(jo,"StylePropertyFunction"),Jn(nr,"StyleExpression",{omit:["_evaluator"]}),Jn(gr,"ZoomDependentExpression"),Jn(Sr,"ZoomConstantExpression"),Jn(No,"CompoundExpression",{omit:["_evaluate"]});for(const n in Ms)Ol[Ms[n]._classRegistryKey]||Jn(Ms[n],`Expression${n}`);function Ia(n){return n&&typeof ArrayBuffer<"u"&&(n instanceof ArrayBuffer||n.constructor&&"ArrayBuffer"===n.constructor.name)}function al(n){return Y.ImageBitmap&&n instanceof Y.ImageBitmap}function Ma(n,e){if(null==n||"boolean"==typeof n||"number"==typeof n||"string"==typeof n||n instanceof Boolean||n instanceof Number||n instanceof String||n instanceof Date||n instanceof RegExp)return n;if(Ia(n)||al(n))return e&&e.push(n),n;if(ArrayBuffer.isView(n)){const i=n;return e&&e.push(i.buffer),i}if(n instanceof Y.ImageData)return e&&e.push(n.data.buffer),n;if(Array.isArray(n)){const i=[];for(const a of n)i.push(Ma(a,e));return i}if("object"==typeof n){const i=n.constructor,a=i._classRegistryKey;if(!a)throw new Error(`can't serialize object of unregistered class ${a}`);const d=i.serialize?i.serialize(n,e):{};if(!i.serialize){for(const m in n)n.hasOwnProperty(m)&&(Ol[a].omit.indexOf(m)>=0||(d[m]=Ma(n[m],e)));n instanceof Error&&(d.message=n.message)}if(d.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==a&&(d.$name=a),d}throw new Error("can't serialize object of type "+typeof n)}function Za(n){if(null==n||"boolean"==typeof n||"number"==typeof n||"string"==typeof n||n instanceof Boolean||n instanceof Number||n instanceof String||n instanceof Date||n instanceof RegExp||Ia(n)||al(n)||ArrayBuffer.isView(n)||n instanceof Y.ImageData)return n;if(Array.isArray(n))return n.map(Za);if("object"==typeof n){const e=n.$name||"Object",{klass:i}=Ol[e];if(!i)throw new Error(`can't deserialize unregistered class ${e}`);if(i.deserialize)return i.deserialize(n);const a=Object.create(i.prototype);for(const d of Object.keys(n))"$name"!==d&&(a[d]=Za(n[d]));return a}throw new Error("can't deserialize object of type "+typeof n)}class oc{constructor(){this.first=!0}update(e,i){const a=Math.floor(e);return this.first?(this.first=!1,this.lastIntegerZoom=a,this.lastIntegerZoomTime=0,this.lastZoom=e,this.lastFloorZoom=a,!0):(this.lastFloorZoom>a?(this.lastIntegerZoom=a+1,this.lastIntegerZoomTime=i):this.lastFloorZoom<a&&(this.lastIntegerZoom=a,this.lastIntegerZoomTime=i),e!==this.lastZoom&&(this.lastZoom=e,this.lastFloorZoom=a,!0))}}const Ga=n=>n>=1536&&n<=1791,Rl=n=>n>=1872&&n<=1919,Tu=n=>n>=2208&&n<=2303,Ur=n=>n>=11904&&n<=12031,dd=n=>n>=12032&&n<=12255,eu=n=>n>=12272&&n<=12287,Oc=n=>n>=12288&&n<=12351,Eu=n=>n>=12352&&n<=12447,Ha=n=>n>=12448&&n<=12543,Du=n=>n>=12544&&n<=12591,Rc=n=>n>=12704&&n<=12735,Ll=n=>n>=12736&&n<=12783,hd=n=>n>=12784&&n<=12799,Iu=n=>n>=12800&&n<=13055,wo=n=>n>=13056&&n<=13311,Lc=n=>n>=13312&&n<=19903,ll=n=>n>=19968&&n<=40959,Fc=n=>n>=40960&&n<=42127,Ps=n=>n>=42128&&n<=42191,Sa=n=>n>=44032&&n<=55215,tu=n=>n>=63744&&n<=64255,sc=n=>n>=64336&&n<=65023,P=n=>n>=65040&&n<=65055,F=n=>n>=65072&&n<=65103,S=n=>n>=65104&&n<=65135,l=n=>n>=65136&&n<=65279,t=n=>n>=65280&&n<=65519;function s(n){for(const e of n)if(b(e.charCodeAt(0)))return!0;return!1}function p(n){for(const e of n)if(!v(e.charCodeAt(0)))return!1;return!0}function v(n){return!(Ga(n)||Rl(n)||Tu(n)||sc(n)||l(n))}function b(n){return!(746!==n&&747!==n&&(n<4352||!(Rc(n)||Du(n)||F(n)&&!(n>=65097&&n<=65103)||tu(n)||wo(n)||Ur(n)||Ll(n)||!(!Oc(n)||n>=12296&&n<=12305||n>=12308&&n<=12319||12336===n)||Lc(n)||ll(n)||Iu(n)||(e=n,e>=12592&&e<=12687)||(e=>e>=43360&&e<=43391)(n)||(e=>e>=55216&&e<=55295)(n)||(e=>e>=4352&&e<=4607)(n)||Sa(n)||Eu(n)||eu(n)||(e=>e>=12688&&e<=12703)(n)||dd(n)||hd(n)||Ha(n)&&12540!==n||!(!t(n)||65288===n||65289===n||65293===n||n>=65306&&n<=65310||65339===n||65341===n||65343===n||n>=65371&&n<=65503||65507===n||n>=65512&&n<=65519)||!(!S(n)||n>=65112&&n<=65118||n>=65123&&n<=65126)||(e=>e>=5120&&e<=5759)(n)||(e=>e>=6320&&e<=6399)(n)||P(n)||(e=>e>=19904&&e<=19967)(n)||Fc(n)||Ps(n))));var e}function D(n){return!(b(n)||(e=n,(i=e)>=128&&i<=255&&(167===e||169===e||174===e||177===e||188===e||189===e||190===e||215===e||247===e)||(i=>i>=8192&&i<=8303)(e)&&(8214===e||8224===e||8225===e||8240===e||8241===e||8251===e||8252===e||8258===e||8263===e||8264===e||8265===e||8273===e)||(i=>i>=8448&&i<=8527)(e)||(i=>i>=8528&&i<=8591)(e)||(i=>i>=8960&&i<=9215)(e)&&(e>=8960&&e<=8967||e>=8972&&e<=8991||e>=8996&&e<=9e3||9003===e||e>=9085&&e<=9114||e>=9150&&e<=9165||9167===e||e>=9169&&e<=9179||e>=9186&&e<=9215)||(i=>i>=9216&&i<=9279)(e)&&9251!==e||(i=>i>=9280&&i<=9311)(e)||(i=>i>=9312&&i<=9471)(e)||(i=>i>=9632&&i<=9727)(e)||(i=>i>=9728&&i<=9983)(e)&&!(e>=9754&&e<=9759)||(i=>i>=11008&&i<=11263)(e)&&(e>=11026&&e<=11055||e>=11088&&e<=11097||e>=11192&&e<=11243)||Oc(e)||Ha(e)||(i=>i>=57344&&i<=63743)(e)||F(e)||S(e)||t(e)||8734===e||8756===e||8757===e||e>=9984&&e<=10087||e>=10102&&e<=10131||65532===e||65533===e));var e,i}function O(n){return n>=1424&&n<=2303||sc(n)||l(n)}function k(n,e){return!(!e&&O(n)||n>=2304&&n<=3583||n>=3840&&n<=4255||(i=n,i>=6016&&i<=6143));var i}function H(n){for(const e of n)if(O(e.charCodeAt(0)))return!0;return!1}const J="deferred",ue="loading",De="loaded";let je=null,ke="unavailable",Ye=null;const $e=function(n){n&&"string"==typeof n&&n.indexOf("NetworkError")>-1&&(ke="error"),je&&je(n)};function Be(){Xe.fire(new Bi("pluginStateChange",{pluginStatus:ke,pluginURL:Ye}))}const Xe=new Cr,We=function(){return ke},gt=function(){if(ke!==J||!Ye)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");ke=ue,Be(),Ye&&Qt({url:Ye},n=>{n?$e(n):(ke=De,Be())})},yt={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>ke===De||null!=yt.applyArabicShaping,isLoading:()=>ke===ue,setState(n){ke=n.pluginStatus,Ye=n.pluginURL},isParsed:()=>null!=yt.applyArabicShaping&&null!=yt.processBidirectionalText&&null!=yt.processStyledBidirectionalText,getPluginURL:()=>Ye};class ot{constructor(e,i){this.zoom=e,i?(this.now=i.now,this.fadeDuration=i.fadeDuration,this.zoomHistory=i.zoomHistory,this.transition=i.transition,this.pitch=i.pitch):(this.now=0,this.fadeDuration=0,this.zoomHistory=new oc,this.transition={},this.pitch=0)}isSupportedScript(e){return function(i,a){for(const d of i)if(!k(d.charCodeAt(0),a))return!1;return!0}(e,yt.isLoaded())}crossFadingFactor(){return 0===this.fadeDuration?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const e=this.zoom,i=e-Math.floor(e),a=this.crossFadingFactor();return e>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:i+(1-i)*a}:{fromScale:.5,toScale:1,t:1-(1-a)*i}}}class It{constructor(e,i){this.property=e,this.value=i,this.expression=function(a,d){if(ce(a))return new jo(a,d);if(dr(a)){const m=to(a,d);if("error"===m.result)throw new Error(m.value.map(_=>`${_.key}: ${_.message}`).join(", "));return m.value}{let m=a;return"string"==typeof a&&"color"===d.type&&(m=fr.parse(a)),{kind:"constant",evaluate:()=>m}}}(void 0===i?e.specification.default:i,e.specification)}isDataDriven(){return"source"===this.expression.kind||"composite"===this.expression.kind}possiblyEvaluate(e,i,a){return this.property.possiblyEvaluate(this,e,i,a)}}class Jt{constructor(e){this.property=e,this.value=new It(e,void 0)}transitioned(e,i){return new Xt(this.property,this.value,i,Et({},e.transition,this.transition),e.now)}untransitioned(){return new Xt(this.property,this.value,null,{},0)}}class cn{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues)}getValue(e){return Ut(this._values[e].value.value)}setValue(e,i){this._values.hasOwnProperty(e)||(this._values[e]=new Jt(this._values[e].property)),this._values[e].value=new It(this._values[e].property,null===i?void 0:Ut(i))}getTransition(e){return Ut(this._values[e].transition)}setTransition(e,i){this._values.hasOwnProperty(e)||(this._values[e]=new Jt(this._values[e].property)),this._values[e].transition=Ut(i)||void 0}serialize(){const e={};for(const i of Object.keys(this._values)){const a=this.getValue(i);void 0!==a&&(e[i]=a);const d=this.getTransition(i);void 0!==d&&(e[`${i}-transition`]=d)}return e}transitioned(e,i){const a=new An(this._properties);for(const d of Object.keys(this._values))a._values[d]=this._values[d].transitioned(e,i._values[d]);return a}untransitioned(){const e=new An(this._properties);for(const i of Object.keys(this._values))e._values[i]=this._values[i].untransitioned();return e}}class Xt{constructor(e,i,a,d,m){const _=d.delay||0,w=d.duration||0;m=m||0,this.property=e,this.value=i,this.begin=m+_,this.end=this.begin+w,e.specification.transition&&(d.delay||d.duration)&&(this.prior=a)}possiblyEvaluate(e,i,a){const d=e.now||0,m=this.value.possiblyEvaluate(e,i,a),_=this.prior;if(_){if(d>this.end)return this.prior=null,m;if(this.value.isDataDriven())return this.prior=null,m;if(d<this.begin)return _.possiblyEvaluate(e,i,a);{const w=(d-this.begin)/(this.end-this.begin);return this.property.interpolate(_.possiblyEvaluate(e,i,a),m,we(w))}}return m}}class An{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)}possiblyEvaluate(e,i,a){const d=new yn(this._properties);for(const m of Object.keys(this._values))d._values[m]=this._values[m].possiblyEvaluate(e,i,a);return d}hasTransition(){for(const e of Object.keys(this._values))if(this._values[e].prior)return!0;return!1}}class Zt{constructor(e){this._properties=e,this._values=Object.create(e.defaultPropertyValues)}getValue(e){return Ut(this._values[e].value)}setValue(e,i){this._values[e]=new It(this._values[e].property,null===i?void 0:Ut(i))}serialize(){const e={};for(const i of Object.keys(this._values)){const a=this.getValue(i);void 0!==a&&(e[i]=a)}return e}possiblyEvaluate(e,i,a){const d=new yn(this._properties);for(const m of Object.keys(this._values))d._values[m]=this._values[m].possiblyEvaluate(e,i,a);return d}}class bn{constructor(e,i,a){this.property=e,this.value=i,this.parameters=a}isConstant(){return"constant"===this.value.kind}constantOr(e){return"constant"===this.value.kind?this.value.value:e}evaluate(e,i,a,d){return this.property.evaluate(this.value,this.parameters,e,i,a,d)}}class yn{constructor(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)}get(e){return this._values[e]}}class Kt{constructor(e){this.specification=e}possiblyEvaluate(e,i){return e.expression.evaluate(i)}interpolate(e,i,a){const d=zr[this.specification.type];return d?d(e,i,a):e}}class Nt{constructor(e,i){this.specification=e,this.overrides=i}possiblyEvaluate(e,i,a,d){return new bn(this,"constant"===e.expression.kind||"camera"===e.expression.kind?{kind:"constant",value:e.expression.evaluate(i,null,{},a,d)}:e.expression,i)}interpolate(e,i,a){if("constant"!==e.value.kind||"constant"!==i.value.kind)return e;if(void 0===e.value.value||void 0===i.value.value)return new bn(this,{kind:"constant",value:void 0},e.parameters);const d=zr[this.specification.type];return d?new bn(this,{kind:"constant",value:d(e.value.value,i.value.value,a)},e.parameters):e}evaluate(e,i,a,d,m,_){return"constant"===e.kind?e.value:e.evaluate(i,a,d,m,_)}}class qn extends Nt{possiblyEvaluate(e,i,a,d){if(void 0===e.value)return new bn(this,{kind:"constant",value:void 0},i);if("constant"===e.expression.kind){const m=e.expression.evaluate(i,null,{},a,d),_="resolvedImage"===e.property.specification.type&&"string"!=typeof m?m.name:m,w=this._calculate(_,_,_,i);return new bn(this,{kind:"constant",value:w},i)}if("camera"===e.expression.kind){const m=this._calculate(e.expression.evaluate({zoom:i.zoom-1}),e.expression.evaluate({zoom:i.zoom}),e.expression.evaluate({zoom:i.zoom+1}),i);return new bn(this,{kind:"constant",value:m},i)}return new bn(this,e.expression,i)}evaluate(e,i,a,d,m,_){if("source"===e.kind){const w=e.evaluate(i,a,d,m,_);return this._calculate(w,w,w,i)}return"composite"===e.kind?this._calculate(e.evaluate({zoom:Math.floor(i.zoom)-1},a,d),e.evaluate({zoom:Math.floor(i.zoom)},a,d),e.evaluate({zoom:Math.floor(i.zoom)+1},a,d),i):e.value}_calculate(e,i,a,d){return d.zoom>d.zoomHistory.lastIntegerZoom?{from:e,to:i,other:a}:{from:a,to:i,other:e}}interpolate(e){return e}}class zn{constructor(e){this.specification=e}possiblyEvaluate(e,i,a,d){if(void 0!==e.value){if("constant"===e.expression.kind){const m=e.expression.evaluate(i,null,{},a,d);return this._calculate(m,m,m,i)}return this._calculate(e.expression.evaluate(new ot(Math.floor(i.zoom-1),i)),e.expression.evaluate(new ot(Math.floor(i.zoom),i)),e.expression.evaluate(new ot(Math.floor(i.zoom+1),i)),i)}}_calculate(e,i,a,d){return d.zoom>d.zoomHistory.lastIntegerZoom?{from:e,to:i}:{from:a,to:i}}interpolate(e){return e}}class jn{constructor(e){this.specification=e}possiblyEvaluate(e,i,a,d){return!!e.expression.evaluate(i,null,{},a,d)}interpolate(){return!1}}class Bn{constructor(e){this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const i=new ot(0,{});for(const a in e){const d=e[a];d.specification.overridable&&this.overridableProperties.push(a);const m=this.defaultPropertyValues[a]=new It(d,void 0),_=this.defaultTransitionablePropertyValues[a]=new Jt(d);this.defaultTransitioningPropertyValues[a]=_.untransitioned(),this.defaultPossiblyEvaluatedValues[a]=m.possiblyEvaluate(i)}}}function si(n,e){return 256*(n=_e(Math.floor(n),0,255))+_e(Math.floor(e),0,255)}Jn(Nt,"DataDrivenProperty"),Jn(Kt,"DataConstantProperty"),Jn(qn,"CrossFadedDataDrivenProperty"),Jn(zn,"CrossFadedProperty"),Jn(jn,"ColorRampProperty");const Di={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class yi{constructor(e,i){this._structArray=e,this._pos1=i*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class pi{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(e,i){return e._trim(),i&&(e.isTransferred=!0,i.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}}static deserialize(e){const i=Object.create(this.prototype);return i.arrayBuffer=e.arrayBuffer,i.length=e.length,i.capacity=e.arrayBuffer.byteLength/i.bytesPerElement,i._refreshViews(),i}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(e){this.reserve(e),this.length=e}reserve(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const i=this.uint8;this._refreshViews(),i&&this.uint8.set(i)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function Nn(n,e=1){let i=0,a=0;return{members:n.map(d=>{const m=Di[d.type].BYTES_PER_ELEMENT,_=i=Ri(i,Math.max(e,m)),w=d.components||1;return a=Math.max(a,m),i+=m*w,{name:d.name,type:d.type,components:w,offset:_}}),size:Ri(i,Math.max(a,e)),alignment:e}}function Ri(n,e){return Math.ceil(n/e)*e}class $i extends pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i){const a=this.length;return this.resize(a+1),this.emplace(a,e,i)}emplace(e,i,a){const d=2*e;return this.int16[d+0]=i,this.int16[d+1]=a,e}}$i.prototype.bytesPerElement=4,Jn($i,"StructArrayLayout2i4");class Lr extends pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,a){const d=this.length;return this.resize(d+1),this.emplace(d,e,i,a)}emplace(e,i,a,d){const m=3*e;return this.int16[m+0]=i,this.int16[m+1]=a,this.int16[m+2]=d,e}}Lr.prototype.bytesPerElement=6,Jn(Lr,"StructArrayLayout3i6");class Ir extends pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,a,d){const m=this.length;return this.resize(m+1),this.emplace(m,e,i,a,d)}emplace(e,i,a,d,m){const _=4*e;return this.int16[_+0]=i,this.int16[_+1]=a,this.int16[_+2]=d,this.int16[_+3]=m,e}}Ir.prototype.bytesPerElement=8,Jn(Ir,"StructArrayLayout4i8");class Ar extends pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,a,d,m,_,w){const T=this.length;return this.resize(T+1),this.emplace(T,e,i,a,d,m,_,w)}emplace(e,i,a,d,m,_,w,T){const M=6*e,L=12*e,z=3*e;return this.int16[M+0]=i,this.int16[M+1]=a,this.uint8[L+4]=d,this.uint8[L+5]=m,this.uint8[L+6]=_,this.uint8[L+7]=w,this.float32[z+2]=T,e}}Ar.prototype.bytesPerElement=12,Jn(Ar,"StructArrayLayout2i4ub1f12");class qo extends pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,a,d){const m=this.length;return this.resize(m+1),this.emplace(m,e,i,a,d)}emplace(e,i,a,d,m){const _=4*e;return this.float32[_+0]=i,this.float32[_+1]=a,this.float32[_+2]=d,this.float32[_+3]=m,e}}qo.prototype.bytesPerElement=16,Jn(qo,"StructArrayLayout4f16");class is extends pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,a,d,m,_,w,T,M,L){const z=this.length;return this.resize(z+1),this.emplace(z,e,i,a,d,m,_,w,T,M,L)}emplace(e,i,a,d,m,_,w,T,M,L,z){const V=10*e;return this.uint16[V+0]=i,this.uint16[V+1]=a,this.uint16[V+2]=d,this.uint16[V+3]=m,this.uint16[V+4]=_,this.uint16[V+5]=w,this.uint16[V+6]=T,this.uint16[V+7]=M,this.uint16[V+8]=L,this.uint16[V+9]=z,e}}is.prototype.bytesPerElement=20,Jn(is,"StructArrayLayout10ui20");class cl extends pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,a,d,m,_,w,T){const M=this.length;return this.resize(M+1),this.emplace(M,e,i,a,d,m,_,w,T)}emplace(e,i,a,d,m,_,w,T,M){const L=8*e;return this.uint16[L+0]=i,this.uint16[L+1]=a,this.uint16[L+2]=d,this.uint16[L+3]=m,this.uint16[L+4]=_,this.uint16[L+5]=w,this.uint16[L+6]=T,this.uint16[L+7]=M,e}}cl.prototype.bytesPerElement=16,Jn(cl,"StructArrayLayout8ui16");class Jr extends pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,a,d,m,_){const w=this.length;return this.resize(w+1),this.emplace(w,e,i,a,d,m,_)}emplace(e,i,a,d,m,_,w){const T=6*e;return this.int16[T+0]=i,this.int16[T+1]=a,this.int16[T+2]=d,this.int16[T+3]=m,this.int16[T+4]=_,this.int16[T+5]=w,e}}Jr.prototype.bytesPerElement=12,Jn(Jr,"StructArrayLayout6i12");class fo extends pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,a,d,m,_,w,T,M,L,z,V){const K=this.length;return this.resize(K+1),this.emplace(K,e,i,a,d,m,_,w,T,M,L,z,V)}emplace(e,i,a,d,m,_,w,T,M,L,z,V,K){const ne=12*e;return this.int16[ne+0]=i,this.int16[ne+1]=a,this.int16[ne+2]=d,this.int16[ne+3]=m,this.uint16[ne+4]=_,this.uint16[ne+5]=w,this.uint16[ne+6]=T,this.uint16[ne+7]=M,this.int16[ne+8]=L,this.int16[ne+9]=z,this.int16[ne+10]=V,this.int16[ne+11]=K,e}}fo.prototype.bytesPerElement=24,Jn(fo,"StructArrayLayout4i4ui4i24");class Mr extends pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,a,d,m,_){const w=this.length;return this.resize(w+1),this.emplace(w,e,i,a,d,m,_)}emplace(e,i,a,d,m,_,w){const T=10*e,M=5*e;return this.int16[T+0]=i,this.int16[T+1]=a,this.int16[T+2]=d,this.float32[M+2]=m,this.float32[M+3]=_,this.float32[M+4]=w,e}}Mr.prototype.bytesPerElement=20,Jn(Mr,"StructArrayLayout3i3f20");class Ro extends pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e){const i=this.length;return this.resize(i+1),this.emplace(i,e)}emplace(e,i){return this.uint32[1*e+0]=i,e}}Ro.prototype.bytesPerElement=4,Jn(Ro,"StructArrayLayout1ul4");class gs extends pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,a,d,m,_,w,T,M,L,z,V,K){const ne=this.length;return this.resize(ne+1),this.emplace(ne,e,i,a,d,m,_,w,T,M,L,z,V,K)}emplace(e,i,a,d,m,_,w,T,M,L,z,V,K,ne){const ge=20*e,ze=10*e;return this.int16[ge+0]=i,this.int16[ge+1]=a,this.int16[ge+2]=d,this.int16[ge+3]=m,this.int16[ge+4]=_,this.float32[ze+3]=w,this.float32[ze+4]=T,this.float32[ze+5]=M,this.float32[ze+6]=L,this.int16[ge+14]=z,this.uint32[ze+8]=V,this.uint16[ge+18]=K,this.uint16[ge+19]=ne,e}}gs.prototype.bytesPerElement=40,Jn(gs,"StructArrayLayout5i4f1i1ul2ui40");class Vr extends pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,a,d,m,_,w){const T=this.length;return this.resize(T+1),this.emplace(T,e,i,a,d,m,_,w)}emplace(e,i,a,d,m,_,w,T){const M=8*e;return this.int16[M+0]=i,this.int16[M+1]=a,this.int16[M+2]=d,this.int16[M+4]=m,this.int16[M+5]=_,this.int16[M+6]=w,this.int16[M+7]=T,e}}Vr.prototype.bytesPerElement=16,Jn(Vr,"StructArrayLayout3i2i2i16");class _s extends pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,a,d,m){const _=this.length;return this.resize(_+1),this.emplace(_,e,i,a,d,m)}emplace(e,i,a,d,m,_){const w=4*e,T=8*e;return this.float32[w+0]=i,this.float32[w+1]=a,this.float32[w+2]=d,this.int16[T+6]=m,this.int16[T+7]=_,e}}_s.prototype.bytesPerElement=16,Jn(_s,"StructArrayLayout2f1f2i16");class Fl extends pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,a,d){const m=this.length;return this.resize(m+1),this.emplace(m,e,i,a,d)}emplace(e,i,a,d,m){const _=12*e,w=3*e;return this.uint8[_+0]=i,this.uint8[_+1]=a,this.float32[w+1]=d,this.float32[w+2]=m,e}}Fl.prototype.bytesPerElement=12,Jn(Fl,"StructArrayLayout2ub2f12");class ma extends pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,a){const d=this.length;return this.resize(d+1),this.emplace(d,e,i,a)}emplace(e,i,a,d){const m=3*e;return this.float32[m+0]=i,this.float32[m+1]=a,this.float32[m+2]=d,e}}ma.prototype.bytesPerElement=12,Jn(ma,"StructArrayLayout3f12");class ys extends pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,a){const d=this.length;return this.resize(d+1),this.emplace(d,e,i,a)}emplace(e,i,a,d){const m=3*e;return this.uint16[m+0]=i,this.uint16[m+1]=a,this.uint16[m+2]=d,e}}ys.prototype.bytesPerElement=6,Jn(ys,"StructArrayLayout3ui6");class Os extends pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e,i,a,d,m,_,w,T,M,L,z,V,K,ne,ge,ze,rt,wt,it,ft,At){const mt=this.length;return this.resize(mt+1),this.emplace(mt,e,i,a,d,m,_,w,T,M,L,z,V,K,ne,ge,ze,rt,wt,it,ft,At)}emplace(e,i,a,d,m,_,w,T,M,L,z,V,K,ne,ge,ze,rt,wt,it,ft,At,mt){const rn=30*e,en=15*e,mn=60*e;return this.int16[rn+0]=i,this.int16[rn+1]=a,this.int16[rn+2]=d,this.float32[en+2]=m,this.float32[en+3]=_,this.uint16[rn+8]=w,this.uint16[rn+9]=T,this.uint32[en+5]=M,this.uint32[en+6]=L,this.uint32[en+7]=z,this.uint16[rn+16]=V,this.uint16[rn+17]=K,this.uint16[rn+18]=ne,this.float32[en+10]=ge,this.float32[en+11]=ze,this.uint8[mn+48]=rt,this.uint8[mn+49]=wt,this.uint8[mn+50]=it,this.uint32[en+13]=ft,this.int16[rn+28]=At,this.uint8[mn+58]=mt,e}}Os.prototype.bytesPerElement=60,Jn(Os,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class kl extends pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e,i,a,d,m,_,w,T,M,L,z,V,K,ne,ge,ze,rt,wt,it,ft,At,mt,rn,en,mn,Pn,sn,vn,xn,Sn){const On=this.length;return this.resize(On+1),this.emplace(On,e,i,a,d,m,_,w,T,M,L,z,V,K,ne,ge,ze,rt,wt,it,ft,At,mt,rn,en,mn,Pn,sn,vn,xn,Sn)}emplace(e,i,a,d,m,_,w,T,M,L,z,V,K,ne,ge,ze,rt,wt,it,ft,At,mt,rn,en,mn,Pn,sn,vn,xn,Sn,On){const ln=38*e,$n=19*e;return this.int16[ln+0]=i,this.int16[ln+1]=a,this.int16[ln+2]=d,this.float32[$n+2]=m,this.float32[$n+3]=_,this.int16[ln+8]=w,this.int16[ln+9]=T,this.int16[ln+10]=M,this.int16[ln+11]=L,this.int16[ln+12]=z,this.int16[ln+13]=V,this.uint16[ln+14]=K,this.uint16[ln+15]=ne,this.uint16[ln+16]=ge,this.uint16[ln+17]=ze,this.uint16[ln+18]=rt,this.uint16[ln+19]=wt,this.uint16[ln+20]=it,this.uint16[ln+21]=ft,this.uint16[ln+22]=At,this.uint16[ln+23]=mt,this.uint16[ln+24]=rn,this.uint16[ln+25]=en,this.uint16[ln+26]=mn,this.uint16[ln+27]=Pn,this.uint16[ln+28]=sn,this.uint32[$n+15]=vn,this.float32[$n+16]=xn,this.float32[$n+17]=Sn,this.float32[$n+18]=On,e}}kl.prototype.bytesPerElement=76,Jn(kl,"StructArrayLayout3i2f6i15ui1ul3f76");class rs extends pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e){const i=this.length;return this.resize(i+1),this.emplace(i,e)}emplace(e,i){return this.float32[1*e+0]=i,e}}rs.prototype.bytesPerElement=4,Jn(rs,"StructArrayLayout1f4");class Wa extends pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,a,d,m){const _=this.length;return this.resize(_+1),this.emplace(_,e,i,a,d,m)}emplace(e,i,a,d,m,_){const w=5*e;return this.float32[w+0]=i,this.float32[w+1]=a,this.float32[w+2]=d,this.float32[w+3]=m,this.float32[w+4]=_,e}}Wa.prototype.bytesPerElement=20,Jn(Wa,"StructArrayLayout5f20");class ul extends pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,a,d){const m=this.length;return this.resize(m+1),this.emplace(m,e,i,a,d)}emplace(e,i,a,d,m){const _=6*e;return this.uint32[3*e+0]=i,this.uint16[_+2]=a,this.uint16[_+3]=d,this.uint16[_+4]=m,e}}ul.prototype.bytesPerElement=12,Jn(ul,"StructArrayLayout1ul3ui12");class Qs extends pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i){const a=this.length;return this.resize(a+1),this.emplace(a,e,i)}emplace(e,i,a){const d=2*e;return this.uint16[d+0]=i,this.uint16[d+1]=a,e}}Qs.prototype.bytesPerElement=4,Jn(Qs,"StructArrayLayout2ui4");class pd extends pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e){const i=this.length;return this.resize(i+1),this.emplace(i,e)}emplace(e,i){return this.uint16[1*e+0]=i,e}}pd.prototype.bytesPerElement=2,Jn(pd,"StructArrayLayout1ui2");class sh extends pi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i){const a=this.length;return this.resize(a+1),this.emplace(a,e,i)}emplace(e,i,a){const d=2*e;return this.float32[d+0]=i,this.float32[d+1]=a,e}}sh.prototype.bytesPerElement=8,Jn(sh,"StructArrayLayout2f8");class im extends yi{get a_pos_30(){return this._structArray.int16[this._pos2+0]}get a_pos_31(){return this._structArray.int16[this._pos2+1]}get a_pos_32(){return this._structArray.int16[this._pos2+2]}get a_pos_normal_30(){return this._structArray.int16[this._pos2+3]}get a_pos_normal_31(){return this._structArray.int16[this._pos2+4]}get a_pos_normal_32(){return this._structArray.int16[this._pos2+5]}}im.prototype.size=12;class pp extends Jr{get(e){return new im(this,e)}}Jn(pp,"FillExtrusionExtArray");class rm extends yi{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}rm.prototype.size=40;class fp extends gs{get(e){return new rm(this,e)}}Jn(fp,"CollisionBoxArray");class ea extends yi{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(e){this._structArray.uint8[this._pos1+49]=e}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(e){this._structArray.uint8[this._pos1+50]=e}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(e){this._structArray.uint32[this._pos4+13]=e}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(e){this._structArray.uint8[this._pos1+58]=e}}ea.prototype.size=60;class ah extends Os{get(e){return new ea(this,e)}}Jn(ah,"PlacedSymbolArray");class mp extends yi{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+11]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+13]}get key(){return this._structArray.uint16[this._pos2+14]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+17]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+19]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+21]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+22]}get featureIndex(){return this._structArray.uint16[this._pos2+23]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+25]}get numIconVertices(){return this._structArray.uint16[this._pos2+26]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+27]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+28]}get crossTileID(){return this._structArray.uint32[this._pos4+15]}set crossTileID(e){this._structArray.uint32[this._pos4+15]=e}get textOffset0(){return this._structArray.float32[this._pos4+16]}get textOffset1(){return this._structArray.float32[this._pos4+17]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+18]}}mp.prototype.size=76;class lh extends kl{get(e){return new mp(this,e)}}Jn(lh,"SymbolInstanceArray");class Rs extends rs{getoffsetX(e){return this.float32[1*e+0]}}Jn(Rs,"GlyphOffsetArray");class Mu extends Lr{getx(e){return this.int16[3*e+0]}gety(e){return this.int16[3*e+1]}gettileUnitDistanceFromAnchor(e){return this.int16[3*e+2]}}Jn(Mu,"SymbolLineVertexArray");class gp extends yi{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}gp.prototype.size=12;class _p extends ul{get(e){return new gp(this,e)}}Jn(_p,"FeatureIndexArray");class om extends yi{get a_centroid_pos0(){return this._structArray.uint16[this._pos2+0]}get a_centroid_pos1(){return this._structArray.uint16[this._pos2+1]}}om.prototype.size=4;class yp extends Qs{get(e){return new om(this,e)}}Jn(yp,"FillExtrusionCentroidArray");class sm extends yi{get a_pos_30(){return this._structArray.int16[this._pos2+0]}get a_pos_31(){return this._structArray.int16[this._pos2+1]}get a_pos_32(){return this._structArray.int16[this._pos2+2]}get a_pos_normal_30(){return this._structArray.int16[this._pos2+3]}get a_pos_normal_31(){return this._structArray.int16[this._pos2+4]}get a_pos_normal_32(){return this._structArray.int16[this._pos2+5]}}sm.prototype.size=12;class vp extends Jr{get(e){return new sm(this,e)}}Jn(vp,"CircleGlobeExtArray");const Jg=Nn([{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"}]),am=Nn([{name:"a_dash_to",components:4,type:"Uint16"},{name:"a_dash_from",components:4,type:"Uint16"}]);var Su={exports:{}},uh=function(n,e){var i,a,d,m,_,w,T,M;for(a=n.length-(i=3&n.length),d=e,_=3432918353,w=461845907,M=0;M<a;)T=255&n.charCodeAt(M)|(255&n.charCodeAt(++M))<<8|(255&n.charCodeAt(++M))<<16|(255&n.charCodeAt(++M))<<24,++M,d=27492+(65535&(m=5*(65535&(d=(d^=T=(65535&(T=(T=(65535&T)*_+(((T>>>16)*_&65535)<<16)&4294967295)<<15|T>>>17))*w+(((T>>>16)*w&65535)<<16)&4294967295)<<13|d>>>19))+((5*(d>>>16)&65535)<<16)&4294967295))+((58964+(m>>>16)&65535)<<16);switch(T=0,i){case 3:T^=(255&n.charCodeAt(M+2))<<16;case 2:T^=(255&n.charCodeAt(M+1))<<8;case 1:d^=T=(65535&(T=(T=(65535&(T^=255&n.charCodeAt(M)))*_+(((T>>>16)*_&65535)<<16)&4294967295)<<15|T>>>17))*w+(((T>>>16)*w&65535)<<16)&4294967295}return d^=n.length,d=2246822507*(65535&(d^=d>>>16))+((2246822507*(d>>>16)&65535)<<16)&4294967295,d=3266489909*(65535&(d^=d>>>13))+((3266489909*(d>>>16)&65535)<<16)&4294967295,(d^=d>>>16)>>>0},Xg=function(n,e){for(var i,a=n.length,d=e^a,m=0;a>=4;)i=1540483477*(65535&(i=255&n.charCodeAt(m)|(255&n.charCodeAt(++m))<<8|(255&n.charCodeAt(++m))<<16|(255&n.charCodeAt(++m))<<24))+((1540483477*(i>>>16)&65535)<<16),d=1540483477*(65535&d)+((1540483477*(d>>>16)&65535)<<16)^(i=1540483477*(65535&(i^=i>>>24))+((1540483477*(i>>>16)&65535)<<16)),a-=4,++m;switch(a){case 3:d^=(255&n.charCodeAt(m+2))<<16;case 2:d^=(255&n.charCodeAt(m+1))<<8;case 1:d=1540483477*(65535&(d^=255&n.charCodeAt(m)))+((1540483477*(d>>>16)&65535)<<16)}return d=1540483477*(65535&(d^=d>>>13))+((1540483477*(d>>>16)&65535)<<16),(d^=d>>>15)>>>0};Su.exports=uh,Su.exports.murmur3=uh,Su.exports.murmur2=Xg;class kc{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(e,i,a,d){this.ids.push(cm(e)),this.positions.push(i,a,d)}getPositions(e){const i=cm(e);let a=0,d=this.ids.length-1;for(;a<d;){const _=a+d>>1;this.ids[_]>=i?d=_:a=_+1}const m=[];for(;this.ids[a]===i;)m.push({index:this.positions[3*a],start:this.positions[3*a+1],end:this.positions[3*a+2]}),a++;return m}static serialize(e,i){const a=new Float64Array(e.ids),d=new Uint32Array(e.positions);return xp(a,d,0,a.length-1),i&&i.push(a.buffer,d.buffer),{ids:a,positions:d}}static deserialize(e){const i=new kc;return i.ids=e.ids,i.positions=e.positions,i.indexed=!0,i}}function cm(n){const e=+n;return!isNaN(e)&&Number.MIN_SAFE_INTEGER<=e&&e<=Number.MAX_SAFE_INTEGER?e:Su.exports(String(n))}function xp(n,e,i,a){for(;i<a;){const d=n[i+a>>1];let m=i-1,_=a+1;for(;;){do{m++}while(n[m]<d);do{_--}while(n[_]>d);if(m>=_)break;Au(n,m,_),Au(e,3*m,3*_),Au(e,3*m+1,3*_+1),Au(e,3*m+2,3*_+2)}_-i<a-_?(xp(n,e,i,_),i=_+1):(xp(n,e,_+1,a),a=_)}}function Au(n,e,i){const a=n[e];n[e]=n[i],n[i]=a}Jn(kc,"FeaturePositionMap");class dl{constructor(e){this.gl=e.gl,this.initialized=!1}fetchUniformLocation(e,i){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(e,i),this.initialized=!0),!!this.location}}class fd extends dl{constructor(e){super(e),this.current=0}set(e,i,a){this.fetchUniformLocation(e,i)&&this.current!==a&&(this.current=a,this.gl.uniform1f(this.location,a))}}class nu extends dl{constructor(e){super(e),this.current=[0,0,0,0]}set(e,i,a){this.fetchUniformLocation(e,i)&&(a[0]===this.current[0]&&a[1]===this.current[1]&&a[2]===this.current[2]&&a[3]===this.current[3]||(this.current=a,this.gl.uniform4f(this.location,a[0],a[1],a[2],a[3])))}}class dh extends dl{constructor(e){super(e),this.current=fr.transparent}set(e,i,a){this.fetchUniformLocation(e,i)&&(a.r===this.current.r&&a.g===this.current.g&&a.b===this.current.b&&a.a===this.current.a||(this.current=a,this.gl.uniform4f(this.location,a.r,a.g,a.b,a.a)))}}const um=new Float32Array(16),Kg=new Float32Array(9),bp=new Float32Array(4);function wp(n){return[si(255*n.r,255*n.g),si(255*n.b,255*n.a)]}class md{constructor(e,i,a){this.value=e,this.uniformNames=i.map(d=>`u_${d}`),this.type=a}setUniform(e,i,a,d,m){i.set(e,m,d.constantOr(this.value))}getBinding(e,i){return"color"===this.type?new dh(e):new fd(e)}}class Pu{constructor(e,i){this.uniformNames=i.map(a=>`u_${a}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(e,i){this.pixelRatioFrom=i.pixelRatio||1,this.pixelRatioTo=e.pixelRatio||1,this.patternFrom=i.tl.concat(i.br),this.patternTo=e.tl.concat(e.br)}setUniform(e,i,a,d,m){const _="u_pattern_to"===m||"u_dash_to"===m?this.patternTo:"u_pattern_from"===m||"u_dash_from"===m?this.patternFrom:"u_pixel_ratio_to"===m?this.pixelRatioTo:"u_pixel_ratio_from"===m?this.pixelRatioFrom:null;_&&i.set(e,m,_)}getBinding(e,i){return"u_pattern_from"===i||"u_pattern_to"===i||"u_dash_from"===i||"u_dash_to"===i?new nu(e):new fd(e)}}class ac{constructor(e,i,a,d){this.expression=e,this.type=a,this.maxValue=0,this.paintVertexAttributes=i.map(m=>({name:`a_${m}`,type:"Float32",components:"color"===a?2:1,offset:0})),this.paintVertexArray=new d}populatePaintArray(e,i,a,d,m,_){const w=this.paintVertexArray.length,T=this.expression.evaluate(new ot(0),i,{},m,d,_);this.paintVertexArray.resize(e),this._setPaintValue(w,e,T)}updatePaintArray(e,i,a,d,m){const _=this.expression.evaluate({zoom:0},a,d,void 0,m);this._setPaintValue(e,i,_)}_setPaintValue(e,i,a){if("color"===this.type){const d=wp(a);for(let m=e;m<i;m++)this.paintVertexArray.emplace(m,d[0],d[1])}else{for(let d=e;d<i;d++)this.paintVertexArray.emplace(d,a);this.maxValue=Math.max(this.maxValue,Math.abs(a))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class hl{constructor(e,i,a,d,m,_){this.expression=e,this.uniformNames=i.map(w=>`u_${w}_t`),this.type=a,this.useIntegerZoom=d,this.zoom=m,this.maxValue=0,this.paintVertexAttributes=i.map(w=>({name:`a_${w}`,type:"Float32",components:"color"===a?4:2,offset:0})),this.paintVertexArray=new _}populatePaintArray(e,i,a,d,m,_){const w=this.expression.evaluate(new ot(this.zoom),i,{},m,d,_),T=this.expression.evaluate(new ot(this.zoom+1),i,{},m,d,_),M=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(M,e,w,T)}updatePaintArray(e,i,a,d,m){const _=this.expression.evaluate({zoom:this.zoom},a,d,void 0,m),w=this.expression.evaluate({zoom:this.zoom+1},a,d,void 0,m);this._setPaintValue(e,i,_,w)}_setPaintValue(e,i,a,d){if("color"===this.type){const m=wp(a),_=wp(d);for(let w=e;w<i;w++)this.paintVertexArray.emplace(w,m[0],m[1],_[0],_[1])}else{for(let m=e;m<i;m++)this.paintVertexArray.emplace(m,a,d);this.maxValue=Math.max(this.maxValue,Math.abs(a),Math.abs(d))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(e,i,a,d,m){const _=this.useIntegerZoom?Math.floor(a.zoom):a.zoom,w=_e(this.expression.interpolationFactor(_,this.zoom,this.zoom+1),0,1);i.set(e,m,w)}getBinding(e,i){return new fd(e)}}class Bc{constructor(e,i,a,d,m,_,w){this.expression=e,this.type=a,this.useIntegerZoom=d,this.zoom=m,this.layerId=w,this.paintVertexAttributes=("array"===a?am:Jg).members;for(let T=0;T<i.length;++T);this.zoomInPaintVertexArray=new _,this.zoomOutPaintVertexArray=new _}populatePaintArray(e,i,a){const d=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(e),this.zoomOutPaintVertexArray.resize(e),this._setPaintValues(d,e,i.patterns&&i.patterns[this.layerId],a)}updatePaintArray(e,i,a,d,m,_){this._setPaintValues(e,i,a.patterns&&a.patterns[this.layerId],_)}_setPaintValues(e,i,a,d){if(!d||!a)return;const{min:m,mid:_,max:w}=a,T=d[m],M=d[_],L=d[w];if(T&&M&&L)for(let z=e;z<i;z++)this._setPaintValue(this.zoomInPaintVertexArray,z,M,T),this._setPaintValue(this.zoomOutPaintVertexArray,z,M,L)}_setPaintValue(e,i,a,d){e.emplace(i,a.tl[0],a.tl[1],a.br[0],a.br[1],d.tl[0],d.tl[1],d.br[0],d.br[1],a.pixelRatio,d.pixelRatio)}upload(e){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=e.createVertexBuffer(this.zoomInPaintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=e.createVertexBuffer(this.zoomOutPaintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class lc{constructor(e,i,a=(()=>!0)){this.binders={},this._buffers=[];const d=[];for(const m in e.paint._values){if(!a(m))continue;const _=e.paint.get(m);if(!(_ instanceof bn&&_o(_.property.specification)))continue;const w=Cp(m,e.type),T=_.value,M=_.property.specification.type,L=_.property.useIntegerZoom,z=_.property.specification["property-type"],V="cross-faded"===z||"cross-faded-data-driven"===z,K="line-dasharray"===String(m)&&"constant"!==e.layout.get("line-cap").value.kind;if("constant"!==T.kind||K)if("source"===T.kind||K||V){const ne=Tp(m,M,"source");this.binders[m]=V?new Bc(T,w,M,L,i,ne,e.id):new ac(T,w,M,ne),d.push(`/a_${m}`)}else{const ne=Tp(m,M,"composite");this.binders[m]=new hl(T,w,M,L,i,ne),d.push(`/z_${m}`)}else this.binders[m]=V?new Pu(T.value,w):new md(T.value,w,M),d.push(`/u_${m}`)}this.cacheKey=d.sort().join("")}getMaxValue(e){const i=this.binders[e];return i instanceof ac||i instanceof hl?i.maxValue:0}populatePaintArrays(e,i,a,d,m,_){for(const w in this.binders){const T=this.binders[w];(T instanceof ac||T instanceof hl||T instanceof Bc)&&T.populatePaintArray(e,i,a,d,m,_)}}setConstantPatternPositions(e,i){for(const a in this.binders){const d=this.binders[a];d instanceof Pu&&d.setConstantPatternPositions(e,i)}}updatePaintArrays(e,i,a,d,m,_){let w=!1;for(const T in e){const M=i.getPositions(T);for(const L of M){const z=a.feature(L.index);for(const V in this.binders){const K=this.binders[V];if((K instanceof ac||K instanceof hl||K instanceof Bc)&&!0===K.expression.isStateDependent){const ne=d.paint.get(V);K.expression=ne.value,K.updatePaintArray(L.start,L.end,z,e[T],m,_),w=!0}}}}return w}defines(){const e=[];for(const i in this.binders){const a=this.binders[i];(a instanceof md||a instanceof Pu)&&e.push(...a.uniformNames.map(d=>`#define HAS_UNIFORM_${d}`))}return e}getBinderAttributes(){const e=[];for(const i in this.binders){const a=this.binders[i];if(a instanceof ac||a instanceof hl||a instanceof Bc)for(let d=0;d<a.paintVertexAttributes.length;d++)e.push(a.paintVertexAttributes[d].name)}return e}getBinderUniforms(){const e=[];for(const i in this.binders){const a=this.binders[i];if(a instanceof md||a instanceof Pu||a instanceof hl)for(const d of a.uniformNames)e.push(d)}return e}getPaintVertexBuffers(){return this._buffers}getUniforms(e){const i=[];for(const a in this.binders){const d=this.binders[a];if(d instanceof md||d instanceof Pu||d instanceof hl)for(const m of d.uniformNames)i.push({name:m,property:a,binding:d.getBinding(e,m)})}return i}setUniforms(e,i,a,d,m){for(const{name:_,property:w,binding:T}of a)this.binders[w].setUniform(e,T,m,d.get(w),_)}updatePaintBuffers(e){this._buffers=[];for(const i in this.binders){const a=this.binders[i];if(e&&a instanceof Bc){const d=2===e.fromScale?a.zoomInPaintVertexBuffer:a.zoomOutPaintVertexBuffer;d&&this._buffers.push(d)}else(a instanceof ac||a instanceof hl)&&a.paintVertexBuffer&&this._buffers.push(a.paintVertexBuffer)}}upload(e){for(const i in this.binders){const a=this.binders[i];(a instanceof ac||a instanceof hl||a instanceof Bc)&&a.upload(e)}this.updatePaintBuffers()}destroy(){for(const e in this.binders){const i=this.binders[e];(i instanceof ac||i instanceof hl||i instanceof Bc)&&i.destroy()}}}class cc{constructor(e,i,a=(()=>!0)){this.programConfigurations={};for(const d of e)this.programConfigurations[d.id]=new lc(d,i,a);this.needsUpload=!1,this._featureMap=new kc,this._bufferOffset=0}populatePaintArrays(e,i,a,d,m,_,w){for(const T in this.programConfigurations)this.programConfigurations[T].populatePaintArrays(e,i,d,m,_,w);void 0!==i.id&&this._featureMap.add(i.id,a,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0}updatePaintArrays(e,i,a,d,m){for(const _ of a)this.needsUpload=this.programConfigurations[_.id].updatePaintArrays(e,this._featureMap,i,_,d,m)||this.needsUpload}get(e){return this.programConfigurations[e]}upload(e){if(this.needsUpload){for(const i in this.programConfigurations)this.programConfigurations[i].upload(e);this.needsUpload=!1}}destroy(){for(const e in this.programConfigurations)this.programConfigurations[e].destroy()}}const dm={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"line-dasharray":["dash_to","dash_from"]};function Cp(n,e){return dm[n]||[n.replace(`${e}-`,"").replace(/-/g,"_")]}const Qg={"line-pattern":{source:is,composite:is},"fill-pattern":{source:is,composite:is},"fill-extrusion-pattern":{source:is,composite:is},"line-dasharray":{source:cl,composite:cl}},e_={color:{source:sh,composite:qo},number:{source:rs,composite:sh}};function Tp(n,e,i){const a=Qg[n];return a&&a[i]||e_[e][i]}Jn(md,"ConstantBinder"),Jn(Pu,"CrossFadedConstantBinder"),Jn(ac,"SourceExpressionBinder"),Jn(Bc,"CrossFadedCompositeBinder"),Jn(hl,"CompositeExpressionBinder"),Jn(lc,"ProgramConfiguration",{omit:["_buffers"]}),Jn(cc,"ProgramConfigurationSet");const gd="-transition";class Ls extends Cr{constructor(e,i){if(super(),this.id=e.id,this.type=e.type,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,"custom"!==e.type&&(this.metadata=e.metadata,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,"background"!==e.type&&"sky"!==e.type&&(this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter),i.layout&&(this._unevaluatedLayout=new Zt(i.layout)),i.paint)){this._transitionablePaint=new cn(i.paint);for(const a in e.paint)this.setPaintProperty(a,e.paint[a],{validate:!1});for(const a in e.layout)this.setLayoutProperty(a,e.layout[a],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new yn(i.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(e){return"visibility"===e?this.visibility:this._unevaluatedLayout.getValue(e)}setLayoutProperty(e,i,a={}){null!=i&&this._validate(Pl,`layers.${this.id}.layout.${e}`,e,i,a)||("visibility"!==e?this._unevaluatedLayout.setValue(e,i):this.visibility=i)}getPaintProperty(e){return ht(e,gd)?this._transitionablePaint.getTransition(e.slice(0,-gd.length)):this._transitionablePaint.getValue(e)}setPaintProperty(e,i,a={}){if(null!=i&&this._validate(ud,`layers.${this.id}.paint.${e}`,e,i,a))return!1;if(ht(e,gd))return this._transitionablePaint.setTransition(e.slice(0,-gd.length),i||void 0),!1;{const d=this._transitionablePaint._values[e],m="cross-faded-data-driven"===d.property.specification["property-type"],_=d.value.isDataDriven(),w=d.value;this._transitionablePaint.setValue(e,i),this._handleSpecialPaintPropertyUpdate(e);const T=this._transitionablePaint._values[e].value;return T.isDataDriven()||_||m||this._handleOverridablePaintPropertyUpdate(e,w,T)}}_handleSpecialPaintPropertyUpdate(e){}getProgramIds(){return null}getProgramConfiguration(e){return null}_handleOverridablePaintPropertyUpdate(e,i,a){return!1}isHidden(e){return!!(this.minzoom&&e<this.minzoom)||!!(this.maxzoom&&e>=this.maxzoom)||"none"===this.visibility}updateTransitions(e){this._transitioningPaint=this._transitionablePaint.transitioned(e,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(e,i){e.getCrossfadeParameters&&(this._crossfadeParameters=e.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(e,void 0,i)),this.paint=this._transitioningPaint.possiblyEvaluate(e,void 0,i)}serialize(){const e={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(e.layout=e.layout||{},e.layout.visibility=this.visibility),Ct(e,(i,a)=>!(void 0===i||"layout"===a&&!Object.keys(i).length||"paint"===a&&!Object.keys(i).length))}_validate(e,i,a,d,m={}){return(!m||!1!==m.validate)&&rc(this,e.call(Cu,{key:i,layerType:this.type,objectKey:a,value:d,styleSpec:on,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const e in this.paint._values){const i=this.paint.get(e);if(i instanceof bn&&_o(i.property.specification)&&("source"===i.value.kind||"composite"===i.value.kind)&&i.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=pa(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}}const hm=Nn([{name:"a_pos",components:2,type:"Int16"}],4),pm=Nn([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class Lo{constructor(e=[]){this.segments=e}prepareSegment(e,i,a,d){let m=this.segments[this.segments.length-1];return e>Lo.MAX_VERTEX_ARRAY_LENGTH&&wn(`Max vertices per segment is ${Lo.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${e}`),(!m||m.vertexLength+e>Lo.MAX_VERTEX_ARRAY_LENGTH||m.sortKey!==d)&&(m={vertexOffset:i.length,primitiveOffset:a.length,vertexLength:0,primitiveLength:0},void 0!==d&&(m.sortKey=d),this.segments.push(m)),m}get(){return this.segments}destroy(){for(const e of this.segments)for(const i in e.vaos)e.vaos[i].destroy()}static simpleSegment(e,i,a,d){return new Lo([{vertexOffset:e,primitiveOffset:i,vertexLength:a,primitiveLength:d,vaos:{},sortKey:0}])}}Lo.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Jn(Lo,"SegmentVector");var Si=8192;class pl{constructor(e,i){e&&(i?this.setSouthWest(e).setNorthEast(i):4===e.length?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1]))}setNorthEast(e){return this._ne=e instanceof _r?new _r(e.lng,e.lat):_r.convert(e),this}setSouthWest(e){return this._sw=e instanceof _r?new _r(e.lng,e.lat):_r.convert(e),this}extend(e){const i=this._sw,a=this._ne;let d,m;if(e instanceof _r)d=e,m=e;else{if(!(e instanceof pl))return Array.isArray(e)?4===e.length||e.every(Array.isArray)?this.extend(pl.convert(e)):this.extend(_r.convert(e)):"object"==typeof e&&null!==e&&e.hasOwnProperty("lat")&&e.hasOwnProperty("lon")?this.extend(_r.convert(e)):this;if(d=e._sw,m=e._ne,!d||!m)return this}return i||a?(i.lng=Math.min(d.lng,i.lng),i.lat=Math.min(d.lat,i.lat),a.lng=Math.max(m.lng,a.lng),a.lat=Math.max(m.lat,a.lat)):(this._sw=new _r(d.lng,d.lat),this._ne=new _r(m.lng,m.lat)),this}getCenter(){return new _r((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new _r(this.getWest(),this.getNorth())}getSouthEast(){return new _r(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(e){const{lng:i,lat:a}=_r.convert(e);let d=this._sw.lng<=i&&i<=this._ne.lng;return this._sw.lng>this._ne.lng&&(d=this._sw.lng>=i&&i>=this._ne.lng),this._sw.lat<=a&&a<=this._ne.lat&&d}static convert(e){return!e||e instanceof pl?e:new pl(e)}}const hh=6371008.8;class _r{constructor(e,i){if(isNaN(e)||isNaN(i))throw new Error(`Invalid LngLat object: (${e}, ${i})`);if(this.lng=+e,this.lat=+i,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new _r(ae(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(e){const i=Math.PI/180,a=this.lat*i,d=e.lat*i,m=Math.sin(a)*Math.sin(d)+Math.cos(a)*Math.cos(d)*Math.cos((e.lng-this.lng)*i);return hh*Math.acos(Math.min(m,1))}toBounds(e=0){const i=360*e/40075017,a=i/Math.cos(Math.PI/180*this.lat);return new pl(new _r(this.lng-a,this.lat-i),new _r(this.lng+a,this.lat+i))}static convert(e){if(e instanceof _r)return e;if(Array.isArray(e)&&(2===e.length||3===e.length))return new _r(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&"object"==typeof e&&null!==e)return new _r(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const Ep=2*Math.PI*hh;function ph(n){return Ep*Math.cos(n*Math.PI/180)}function qa(n){return(180+n)/360}function fl(n){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+n*Math.PI/360)))/360}function ta(n,e){return n/ph(e)}function Zs(n){return 360*n-180}function os(n){return 360/Math.PI*Math.atan(Math.exp((180-360*n)*Math.PI/180))-90}function fh(n,e){return n*ph(os(e))}const Ya=85.051129;function mh(n){return 1/Math.cos(n*Math.PI/180)}class Bl{constructor(e,i,a=0){this.x=+e,this.y=+i,this.z=+a}static fromLngLat(e,i=0){const a=_r.convert(e);return new Bl(qa(a.lng),fl(a.lat),ta(i,a.lat))}toLngLat(){return new _r(Zs(this.x),os(this.y))}toAltitude(){return fh(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/Ep*mh(os(this.y))}}function Dp(n,e,i,a,d,m,_,w,T){const M=(e+a)/2,L=(i+d)/2,z=new te(M,L);w(z),function(V,K,ne,ge,ze,rt){const wt=ne-ze,it=ge-rt;return Math.abs((ge-K)*wt-(ne-V)*it)/Math.hypot(wt,it)}(z.x,z.y,m.x,m.y,_.x,_.y)>=T?(Dp(n,e,i,M,L,m,z,w,T),Dp(n,M,L,a,d,z,_,w,T)):n.push(_)}function Ip(n,e,i){let a=n[0],d=a.x,m=a.y;e(a);const _=[a];for(let w=1;w<n.length;w++){const T=n[w],{x:M,y:L}=T;e(T),Dp(_,d,m,M,L,a,T,e,i),d=M,m=L,a=T}return _}function Mp(n,e,i,a){if(a(e,i)){const d=e.add(i)._mult(.5);Mp(n,e,d,a),Mp(n,d,i,a)}else n.push(i)}function t_(n,e){let i=n[0];const a=[i];for(let d=1;d<n.length;d++){const m=n[d];Mp(a,i,m,e),i=m}return a}const Sp=Math.pow(2,14)-1,Ap=-Sp-1;function fm(n,e){const i=Math.round(n.x*e),a=Math.round(n.y*e);return n.x=_e(i,Ap,Sp),n.y=_e(a,Ap,Sp),(i<n.x||i>n.x+1||a<n.y||a>n.y+1)&&wn("Geometry exceeds allowed extent, reduce your vector tile buffer size"),n}function Ja(n,e,i){const a=n.loadGeometry(),d=n.extent,m=Si/d;if(e&&i&&i.projection.isReprojectedInTileSpace){const _=1<<e.z,{scale:w,x:T,y:M,projection:L}=i,z=V=>{const K=Zs((e.x+V.x/d)/_),ne=os((e.y+V.y/d)/_),ge=L.project(K,ne);V.x=(ge.x*w-T)*d,V.y=(ge.y*w-M)*d};for(let V=0;V<a.length;V++)if(1!==n.type)a[V]=Ip(a[V],z,1);else{const K=[];for(const ne of a[V])ne.x<0||ne.x>=d||ne.y<0||ne.y>=d||(z(ne),K.push(ne));a[V]=K}}for(const _ of a)for(const w of _)fm(w,m);return a}function uc(n,e){return{type:n.type,id:n.id,properties:n.properties,geometry:e?Ja(n):[]}}function zl(n,e,i,a,d){n.emplaceBack(2*e+(a+1)/2,2*i+(d+1)/2)}function gh(n,e,i){n.emplaceBack(e.x,e.y,e.z,16384*i[0],16384*i[1],16384*i[2])}class Pp{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(i=>i.id),this.index=e.index,this.hasPattern=!1,this.projection=e.projection,this.layoutVertexArray=new $i,this.indexArray=new ys,this.segments=new Lo,this.programConfigurations=new cc(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id)}populate(e,i,a,d){const m=this.layers[0],_=[];let w=null;"circle"===m.type&&(w=m.layout.get("circle-sort-key"));for(const{feature:M,id:L,index:z,sourceLayerIndex:V}of e){const K=this.layers[0]._featureFilter.needGeometry,ne=uc(M,K);if(!this.layers[0]._featureFilter.filter(new ot(this.zoom),ne,a))continue;const ge=w?w.evaluate(ne,{},a):void 0,ze={id:L,properties:M.properties,type:M.type,sourceLayerIndex:V,index:z,geometry:K?ne.geometry:Ja(M,a,d),patterns:{},sortKey:ge};_.push(ze)}w&&_.sort((M,L)=>M.sortKey-L.sortKey);let T=null;"globe"===d.projection.name&&(this.globeExtVertexArray=new vp,T=d.projection);for(const M of _){const{geometry:L,index:z,sourceLayerIndex:V}=M,K=e[z].feature;this.addFeature(M,L,z,i.availableImages,a,T),i.featureIndex.insert(K,L,z,V,this.index)}}update(e,i,a,d){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,i,this.stateDependentLayers,a,d)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,hm.members),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=e.createVertexBuffer(this.globeExtVertexArray,pm.members))),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(e,i,a,d,m,_){for(const w of i)for(const T of w){const M=T.x,L=T.y;if(M<0||M>=Si||L<0||L>=Si)continue;if(_){const K=_.projectTilePoint(M,L,m),ne=_.upVector(m,M,L),ge=this.globeExtVertexArray;gh(ge,K,ne),gh(ge,K,ne),gh(ge,K,ne),gh(ge,K,ne)}const z=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),V=z.vertexLength;zl(this.layoutVertexArray,M,L,-1,-1),zl(this.layoutVertexArray,M,L,1,-1),zl(this.layoutVertexArray,M,L,1,1),zl(this.layoutVertexArray,M,L,-1,1),this.indexArray.emplaceBack(V,V+1,V+2),this.indexArray.emplaceBack(V,V+2,V+3),z.vertexLength+=4,z.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,a,{},d,m)}}function n_(n,e){for(let i=0;i<n.length;i++)if(zc(e,n[i]))return!0;for(let i=0;i<e.length;i++)if(zc(n,e[i]))return!0;return!!yh(n,e)}function i_(n,e,i){return!!zc(n,e)||!!_d(e,n,i)}function _h(n,e){if(1===n.length)return Rp(e,n[0]);for(let i=0;i<e.length;i++){const a=e[i];for(let d=0;d<a.length;d++)if(zc(n,a[d]))return!0}for(let i=0;i<n.length;i++)if(Rp(e,n[i]))return!0;for(let i=0;i<e.length;i++)if(yh(n,e[i]))return!0;return!1}function r_(n,e,i){if(n.length>1){if(yh(n,e))return!0;for(let a=0;a<e.length;a++)if(_d(e[a],n,i))return!0}for(let a=0;a<n.length;a++)if(_d(n[a],e,i))return!0;return!1}function yh(n,e){if(0===n.length||0===e.length)return!1;for(let i=0;i<n.length-1;i++){const a=n[i],d=n[i+1];for(let m=0;m<e.length-1;m++)if(vh(a,d,e[m],e[m+1]))return!0}return!1}function vh(n,e,i,a){return Fn(n,i,a)!==Fn(e,i,a)&&Fn(n,e,i)!==Fn(n,e,a)}function _d(n,e,i){const a=i*i;if(1===e.length)return n.distSqr(e[0])<a;for(let d=1;d<e.length;d++)if(Op(n,e[d-1],e[d])<a)return!0;return!1}function Op(n,e,i){const a=e.distSqr(i);if(0===a)return n.distSqr(e);const d=((n.x-e.x)*(i.x-e.x)+(n.y-e.y)*(i.y-e.y))/a;return n.distSqr(d<0?e:d>1?i:i.sub(e)._mult(d)._add(e))}function Rp(n,e){let i,a,d,m=!1;for(let _=0;_<n.length;_++){i=n[_];for(let w=0,T=i.length-1;w<i.length;T=w++)a=i[w],d=i[T],a.y>e.y!=d.y>e.y&&e.x<(d.x-a.x)*(e.y-a.y)/(d.y-a.y)+a.x&&(m=!m)}return m}function zc(n,e){let i=!1;for(let a=0,d=n.length-1;a<n.length;d=a++){const m=n[a],_=n[d];m.y>e.y!=_.y>e.y&&e.x<(_.x-m.x)*(e.y-m.y)/(_.y-m.y)+m.x&&(i=!i)}return i}function Lp(n,e,i,a,d){for(const _ of n)if(e<=_.x&&i<=_.y&&a>=_.x&&d>=_.y)return!0;const m=[new te(e,i),new te(e,d),new te(a,d),new te(a,i)];if(n.length>2)for(const _ of m)if(zc(n,_))return!0;for(let _=0;_<n.length-1;_++)if(o_(n[_],n[_+1],m))return!0;return!1}function o_(n,e,i){const a=i[0],d=i[2];if(n.x<a.x&&e.x<a.x||n.x>d.x&&e.x>d.x||n.y<a.y&&e.y<a.y||n.y>d.y&&e.y>d.y)return!1;const m=Fn(n,e,i[0]);return m!==Fn(n,e,i[1])||m!==Fn(n,e,i[2])||m!==Fn(n,e,i[3])}function Ou(n,e,i){const a=e.paint.get(n).value;return"constant"===a.kind?a.value:i.programConfigurations.get(e.id).getMaxValue(n)}function xh(n){return Math.sqrt(n[0]*n[0]+n[1]*n[1])}function mm(n,e,i,a,d){if(!e[0]&&!e[1])return n;const m=te.convert(e)._mult(d);"viewport"===i&&m._rotate(-a);const _=[];for(let w=0;w<n.length;w++)_.push(n[w].sub(m));return _}function gm(n,e,i,a){const d=te.convert(n)._mult(a);return"viewport"===e&&d._rotate(-i),d}Jn(Pp,"CircleBucket",{omit:["layers"]});const Nc=new Bn({"circle-sort-key":new Nt(on.layout_circle["circle-sort-key"])});var yd={paint:new Bn({"circle-radius":new Nt(on.paint_circle["circle-radius"]),"circle-color":new Nt(on.paint_circle["circle-color"]),"circle-blur":new Nt(on.paint_circle["circle-blur"]),"circle-opacity":new Nt(on.paint_circle["circle-opacity"]),"circle-translate":new Kt(on.paint_circle["circle-translate"]),"circle-translate-anchor":new Kt(on.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Kt(on.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Kt(on.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Nt(on.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Nt(on.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Nt(on.paint_circle["circle-stroke-opacity"])}),layout:Nc},bh=1e-6,Aa=typeof Float32Array<"u"?Float32Array:Array;function s_(){var n=new Aa(9);return Aa!=Float32Array&&(n[1]=0,n[2]=0,n[3]=0,n[5]=0,n[6]=0,n[7]=0),n[0]=1,n[4]=1,n[8]=1,n}function a_(n,e,i){var a=e[0],d=e[1],m=e[2],_=e[3],w=e[4],T=e[5],M=e[6],L=e[7],z=e[8],V=i[0],K=i[1],ne=i[2],ge=i[3],ze=i[4],rt=i[5],wt=i[6],it=i[7],ft=i[8];return n[0]=V*a+K*_+ne*M,n[1]=V*d+K*w+ne*L,n[2]=V*m+K*T+ne*z,n[3]=ge*a+ze*_+rt*M,n[4]=ge*d+ze*w+rt*L,n[5]=ge*m+ze*T+rt*z,n[6]=wt*a+it*_+ft*M,n[7]=wt*d+it*w+ft*L,n[8]=wt*m+it*T+ft*z,n}function dc(n){return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function _m(n,e){var i=e[0],a=e[1],d=e[2],m=e[3],_=e[4],w=e[5],T=e[6],M=e[7],L=e[8],z=e[9],V=e[10],K=e[11],ne=e[12],ge=e[13],ze=e[14],rt=e[15],wt=i*w-a*_,it=i*T-d*_,ft=i*M-m*_,At=a*T-d*w,mt=a*M-m*w,rn=d*M-m*T,en=L*ge-z*ne,mn=L*ze-V*ne,Pn=L*rt-K*ne,sn=z*ze-V*ge,vn=z*rt-K*ge,xn=V*rt-K*ze,Sn=wt*xn-it*vn+ft*sn+At*Pn-mt*mn+rn*en;return Sn?(n[0]=(w*xn-T*vn+M*sn)*(Sn=1/Sn),n[1]=(d*vn-a*xn-m*sn)*Sn,n[2]=(ge*rn-ze*mt+rt*At)*Sn,n[3]=(V*mt-z*rn-K*At)*Sn,n[4]=(T*Pn-_*xn-M*mn)*Sn,n[5]=(i*xn-d*Pn+m*mn)*Sn,n[6]=(ze*ft-ne*rn-rt*it)*Sn,n[7]=(L*rn-V*ft+K*it)*Sn,n[8]=(_*vn-w*Pn+M*en)*Sn,n[9]=(a*Pn-i*vn-m*en)*Sn,n[10]=(ne*mt-ge*ft+rt*wt)*Sn,n[11]=(z*ft-L*mt-K*wt)*Sn,n[12]=(w*mn-_*sn-T*en)*Sn,n[13]=(i*sn-a*mn+d*en)*Sn,n[14]=(ge*it-ne*At-ze*wt)*Sn,n[15]=(L*At-z*it+V*wt)*Sn,n):null}function iu(n,e,i){var a=e[0],d=e[1],m=e[2],_=e[3],w=e[4],T=e[5],M=e[6],L=e[7],z=e[8],V=e[9],K=e[10],ne=e[11],ge=e[12],ze=e[13],rt=e[14],wt=e[15],it=i[0],ft=i[1],At=i[2],mt=i[3];return n[0]=it*a+ft*w+At*z+mt*ge,n[1]=it*d+ft*T+At*V+mt*ze,n[2]=it*m+ft*M+At*K+mt*rt,n[3]=it*_+ft*L+At*ne+mt*wt,n[4]=(it=i[4])*a+(ft=i[5])*w+(At=i[6])*z+(mt=i[7])*ge,n[5]=it*d+ft*T+At*V+mt*ze,n[6]=it*m+ft*M+At*K+mt*rt,n[7]=it*_+ft*L+At*ne+mt*wt,n[8]=(it=i[8])*a+(ft=i[9])*w+(At=i[10])*z+(mt=i[11])*ge,n[9]=it*d+ft*T+At*V+mt*ze,n[10]=it*m+ft*M+At*K+mt*rt,n[11]=it*_+ft*L+At*ne+mt*wt,n[12]=(it=i[12])*a+(ft=i[13])*w+(At=i[14])*z+(mt=i[15])*ge,n[13]=it*d+ft*T+At*V+mt*ze,n[14]=it*m+ft*M+At*K+mt*rt,n[15]=it*_+ft*L+At*ne+mt*wt,n}function vd(n,e,i){var a,d,m,_,w,T,M,L,z,V,K,ne,ge=i[0],ze=i[1],rt=i[2];return e===n?(n[12]=e[0]*ge+e[4]*ze+e[8]*rt+e[12],n[13]=e[1]*ge+e[5]*ze+e[9]*rt+e[13],n[14]=e[2]*ge+e[6]*ze+e[10]*rt+e[14],n[15]=e[3]*ge+e[7]*ze+e[11]*rt+e[15]):(d=e[1],m=e[2],_=e[3],w=e[4],T=e[5],M=e[6],L=e[7],z=e[8],V=e[9],K=e[10],ne=e[11],n[0]=a=e[0],n[1]=d,n[2]=m,n[3]=_,n[4]=w,n[5]=T,n[6]=M,n[7]=L,n[8]=z,n[9]=V,n[10]=K,n[11]=ne,n[12]=a*ge+w*ze+z*rt+e[12],n[13]=d*ge+T*ze+V*rt+e[13],n[14]=m*ge+M*ze+K*rt+e[14],n[15]=_*ge+L*ze+ne*rt+e[15]),n}function ru(n,e,i){var a=i[0],d=i[1],m=i[2];return n[0]=e[0]*a,n[1]=e[1]*a,n[2]=e[2]*a,n[3]=e[3]*a,n[4]=e[4]*d,n[5]=e[5]*d,n[6]=e[6]*d,n[7]=e[7]*d,n[8]=e[8]*m,n[9]=e[9]*m,n[10]=e[10]*m,n[11]=e[11]*m,n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n}function Fp(n,e,i){var a=Math.sin(i),d=Math.cos(i),m=e[4],_=e[5],w=e[6],T=e[7],M=e[8],L=e[9],z=e[10],V=e[11];return e!==n&&(n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n[4]=m*d+M*a,n[5]=_*d+L*a,n[6]=w*d+z*a,n[7]=T*d+V*a,n[8]=M*d-m*a,n[9]=L*d-_*a,n[10]=z*d-w*a,n[11]=V*d-T*a,n}function wh(n,e,i){var a=Math.sin(i),d=Math.cos(i),m=e[0],_=e[1],w=e[2],T=e[3],M=e[8],L=e[9],z=e[10],V=e[11];return e!==n&&(n[4]=e[4],n[5]=e[5],n[6]=e[6],n[7]=e[7],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n[0]=m*d-M*a,n[1]=_*d-L*a,n[2]=w*d-z*a,n[3]=T*d-V*a,n[8]=m*a+M*d,n[9]=_*a+L*d,n[10]=w*a+z*d,n[11]=T*a+V*d,n}function Ch(n,e){return n[0]=e[0],n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=e[1],n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=e[2],n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function Nl(n,e,i){var a,d,m,_=i[0],w=i[1],T=i[2],M=Math.hypot(_,w,T);return M<bh?null:(_*=M=1/M,w*=M,T*=M,a=Math.sin(e),d=Math.cos(e),n[0]=_*_*(m=1-d)+d,n[1]=w*_*m+T*a,n[2]=T*_*m-w*a,n[3]=0,n[4]=_*w*m-T*a,n[5]=w*w*m+d,n[6]=T*w*m+_*a,n[7]=0,n[8]=_*T*m+w*a,n[9]=w*T*m-_*a,n[10]=T*T*m+d,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n)}Math.hypot||(Math.hypot=function(){for(var n=0,e=arguments.length;e--;)n+=arguments[e]*arguments[e];return Math.sqrt(n)});var xd=iu;function Th(){var n=new Aa(3);return Aa!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0),n}function kp(n){var e=new Aa(3);return e[0]=n[0],e[1]=n[1],e[2]=n[2],e}function Ru(n){return Math.hypot(n[0],n[1],n[2])}function bd(n,e,i){var a=new Aa(3);return a[0]=n,a[1]=e,a[2]=i,a}function Uc(n,e,i){return n[0]=e[0]+i[0],n[1]=e[1]+i[1],n[2]=e[2]+i[2],n}function ym(n,e,i){return n[0]=e[0]-i[0],n[1]=e[1]-i[1],n[2]=e[2]-i[2],n}function Eh(n,e,i){return n[0]=e[0]*i[0],n[1]=e[1]*i[1],n[2]=e[2]*i[2],n}function ou(n,e,i){return n[0]=Math.min(e[0],i[0]),n[1]=Math.min(e[1],i[1]),n[2]=Math.min(e[2],i[2]),n}function Dh(n,e,i){return n[0]=Math.max(e[0],i[0]),n[1]=Math.max(e[1],i[1]),n[2]=Math.max(e[2],i[2]),n}function Xa(n,e,i){return n[0]=e[0]*i,n[1]=e[1]*i,n[2]=e[2]*i,n}function Lu(n,e,i,a){return n[0]=e[0]+i[0]*a,n[1]=e[1]+i[1]*a,n[2]=e[2]+i[2]*a,n}function Gs(n,e){var i=e[0],a=e[1],d=e[2],m=i*i+a*a+d*d;return m>0&&(m=1/Math.sqrt(m)),n[0]=e[0]*m,n[1]=e[1]*m,n[2]=e[2]*m,n}function Ka(n,e){return n[0]*e[0]+n[1]*e[1]+n[2]*e[2]}function Bp(n,e,i){var a=e[0],d=e[1],m=e[2],_=i[0],w=i[1],T=i[2];return n[0]=d*T-m*w,n[1]=m*_-a*T,n[2]=a*w-d*_,n}function Fo(n,e,i){var a=e[0],d=e[1],m=e[2],_=i[3]*a+i[7]*d+i[11]*m+i[15];return n[0]=(i[0]*a+i[4]*d+i[8]*m+i[12])/(_=_||1),n[1]=(i[1]*a+i[5]*d+i[9]*m+i[13])/_,n[2]=(i[2]*a+i[6]*d+i[10]*m+i[14])/_,n}function zp(n,e,i){var a=i[0],d=i[1],m=i[2],_=e[0],w=e[1],T=e[2],M=d*T-m*w,L=m*_-a*T,z=a*w-d*_,V=d*z-m*L,K=m*M-a*z,ne=a*L-d*M,ge=2*i[3];return L*=ge,z*=ge,K*=2,ne*=2,n[0]=_+(M*=ge)+(V*=2),n[1]=w+L+K,n[2]=T+z+ne,n}var Vc,ml=ym,Np=Eh,l_=Ru;function Zo(n,e,i){return n[0]=e[0]*i,n[1]=e[1]*i,n[2]=e[2]*i,n[3]=e[3]*i,n}function vm(n,e){var i=e[0],a=e[1],d=e[2],m=e[3],_=i*i+a*a+d*d+m*m;return _>0&&(_=1/Math.sqrt(_)),n[0]=i*_,n[1]=a*_,n[2]=d*_,n[3]=m*_,n}function su(n,e,i){var a=e[0],d=e[1],m=e[2],_=e[3];return n[0]=i[0]*a+i[4]*d+i[8]*m+i[12]*_,n[1]=i[1]*a+i[5]*d+i[9]*m+i[13]*_,n[2]=i[2]*a+i[6]*d+i[10]*m+i[14]*_,n[3]=i[3]*a+i[7]*d+i[11]*m+i[15]*_,n}function Ih(){var n=new Aa(4);return Aa!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0),n[3]=1,n}function Up(n){return n[0]=0,n[1]=0,n[2]=0,n[3]=1,n}function xm(n,e,i){i*=.5;var a=e[0],d=e[1],m=e[2],_=e[3],w=Math.sin(i),T=Math.cos(i);return n[0]=a*T+_*w,n[1]=d*T+m*w,n[2]=m*T-d*w,n[3]=_*T-a*w,n}function bm(n,e,i){i*=.5;var a=e[0],d=e[1],m=e[2],_=e[3],w=Math.sin(i),T=Math.cos(i);return n[0]=a*T-m*w,n[1]=d*T+_*w,n[2]=m*T+a*w,n[3]=_*T-d*w,n}Th(),Vc=new Aa(4),Aa!=Float32Array&&(Vc[0]=0,Vc[1]=0,Vc[2]=0,Vc[3]=0);var c_=vm;Th(),bd(1,0,0),bd(0,1,0),Ih(),Ih(),s_();class Vp{constructor(e,i){this.pos=e,this.dir=i}intersectsPlane(e,i,a){const d=Ka(i,this.dir);if(Math.abs(d)<1e-6)return!1;const m=((e[0]-this.pos[0])*i[0]+(e[1]-this.pos[1])*i[1]+(e[2]-this.pos[2])*i[2])/d;return a[0]=this.pos[0]+this.dir[0]*m,a[1]=this.pos[1]+this.dir[1]*m,a[2]=this.pos[2]+this.dir[2]*m,!0}closestPointOnSphere(e,i,a){if(ge=(K=this.pos)[0],ze=K[1],rt=K[2],wt=(ne=e)[0],it=ne[1],ft=ne[2],Math.abs(ge-wt)<=bh*Math.max(1,Math.abs(ge),Math.abs(wt))&&Math.abs(ze-it)<=bh*Math.max(1,Math.abs(ze),Math.abs(it))&&Math.abs(rt-ft)<=bh*Math.max(1,Math.abs(rt),Math.abs(ft))||0===i)return a[0]=a[1]=a[2]=0,!1;var K,ne,ge,ze,rt,wt,it,ft;const[d,m,_]=this.dir,w=this.pos[0]-e[0],T=this.pos[1]-e[1],M=this.pos[2]-e[2],L=d*d+m*m+_*_,z=2*(w*d+T*m+M*_),V=z*z-4*L*(w*w+T*T+M*M-i*i);if(V<0){const K=Math.max(-z/2,0),ne=w+d*K,ge=T+m*K,ze=M+_*K,rt=Math.hypot(ne,ge,ze);return a[0]=ne*i/rt,a[1]=ge*i/rt,a[2]=ze*i/rt,!1}{const K=(-z-Math.sqrt(V))/(2*L);if(K<0){const ne=Math.hypot(w,T,M);return a[0]=w*i/ne,a[1]=T*i/ne,a[2]=M*i/ne,!1}return a[0]=w+d*K,a[1]=T+m*K,a[2]=M+_*K,!0}}}class Mh{constructor(e,i,a,d,m){this.TL=e,this.TR=i,this.BR=a,this.BL=d,this.horizon=m}static fromInvProjectionMatrix(e,i,a){const d=[-1,1,1],m=[1,1,1],_=[1,-1,1],w=[-1,-1,1],T=Fo(d,d,e),M=Fo(m,m,e),L=Fo(_,_,e),z=Fo(w,w,e);return new Mh(T,M,L,z,i/a)}}class wm{constructor(e,i){this.points=e,this.planes=i}static fromInvProjectionMatrix(e,i,a,d){const m=Math.pow(2,a),_=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(T=>{const M=su([],T,e),L=1/M[3]/i*m;return(z=M)[0]=(V=M)[0]*(K=[L,L,d?1/M[3]:L,L])[0],z[1]=V[1]*K[1],z[2]=V[2]*K[2],z[3]=V[3]*K[3],z;var z,V,K}),w=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(T=>{const M=Gs([],Bp([],ml([],_[T[0]],_[T[1]]),ml([],_[T[2]],_[T[1]]))),L=-Ka(M,_[T[1]]);return M.concat(L)});return new wm(_,w)}}class na{static fromPoints(e){const i=[1/0,1/0,1/0],a=[-1/0,-1/0,-1/0];for(const d of e)ou(i,i,d),Dh(a,a,d);return new na(i,a)}static applyTransform(e,i){const a=e.getCorners();for(let d=0;d<a.length;++d)Fo(a[d],a[d],i);return na.fromPoints(a)}constructor(e,i){this.min=e,this.max=i,this.center=Xa([],Uc([],this.min,this.max),.5)}quadrant(e){const i=[e%2==0,e<2],a=kp(this.min),d=kp(this.max);for(let m=0;m<i.length;m++)a[m]=i[m]?this.min[m]:this.center[m],d[m]=i[m]?this.center[m]:this.max[m];return d[2]=this.max[2],new na(a,d)}distanceX(e){return Math.max(Math.min(this.max[0],e[0]),this.min[0])-e[0]}distanceY(e){return Math.max(Math.min(this.max[1],e[1]),this.min[1])-e[1]}distanceZ(e){return Math.max(Math.min(this.max[2],e[2]),this.min[2])-e[2]}getCorners(){const e=this.min,i=this.max;return[[e[0],e[1],e[2]],[i[0],e[1],e[2]],[i[0],i[1],e[2]],[e[0],i[1],e[2]],[e[0],e[1],i[2]],[i[0],e[1],i[2]],[i[0],i[1],i[2]],[e[0],i[1],i[2]]]}intersects(e){const i=this.getCorners();let a=!0;for(let d=0;d<e.planes.length;d++){const m=e.planes[d];let _=0;for(let w=0;w<i.length;w++)_+=Ka(m,i[w])+m[3]>=0;if(0===_)return 0;_!==i.length&&(a=!1)}if(a)return 2;for(let d=0;d<3;d++){let m=Number.MAX_VALUE,_=-Number.MAX_VALUE;for(let w=0;w<e.points.length;w++){const T=e.points[w][d]-this.min[d];m=Math.min(m,T),_=Math.max(_,T)}if(_<0||m>this.max[d]-this.min[d])return 0}return 1}}function Fu(n,e,i,a,d,m,_,w,T){if(m&&n.queryGeometry.isAboveHorizon)return!1;m&&(T*=n.pixelToTileUnitsFactor);const M=n.tileID.canonical,L=i.projection.upVectorScale(M,i.center.lat,i.worldSize).metersToTile;for(const z of e)for(const V of z){const K=V.add(w),ne=d&&i.elevation?i.elevation.exaggeration()*d.getElevationAt(K.x,K.y,!0):0,ge=i.projection.projectTilePoint(K.x,K.y,M);if(ne>0){const it=i.projection.upVector(M,K.x,K.y);ge.x+=it[0]*L*ne,ge.y+=it[1]*L*ne,ge.z+=it[2]*L*ne}const ze=m?K:jp(ge.x,ge.y,ge.z,a),rt=m?n.tilespaceRays.map(it=>Tm(it,ne)):n.queryGeometry.screenGeometry,wt=su([],[ge.x,ge.y,ge.z,1],a);if(!_&&m?T*=wt[3]/i.cameraToCenterDistance:_&&!m&&(T*=i.cameraToCenterDistance/wt[3]),m){const it=os((V.y/Si+M.y)/(1<<M.z));T/=i.projection.pixelsPerMeter(it,1)/ta(1,it)}if(i_(rt,ze,T))return!0}return!1}function jp(n,e,i,a){const d=su([],[n,e,i,1],a);return new te(d[0]/d[3],d[1]/d[3])}const $p=bd(0,0,0),Cm=bd(0,0,1);function Tm(n,e){const i=Th();return $p[2]=e,n.intersectsPlane($p,Cm,i),new te(i[0],i[1])}class Em extends Pp{}function Dm(n,{width:e,height:i},a,d){if(d){if(d instanceof Uint8ClampedArray)d=new Uint8Array(d.buffer);else if(d.length!==e*i*a)throw new RangeError("mismatched image size")}else d=new Uint8Array(e*i*a);return n.width=e,n.height=i,n.data=d,n}function Zp(n,e,i){const{width:a,height:d}=e;a===n.width&&d===n.height||(Sh(n,e,{x:0,y:0},{x:0,y:0},{width:Math.min(n.width,a),height:Math.min(n.height,d)},i),n.width=a,n.height=d,n.data=e.data)}function Sh(n,e,i,a,d,m){if(0===d.width||0===d.height)return e;if(d.width>n.width||d.height>n.height||i.x>n.width-d.width||i.y>n.height-d.height)throw new RangeError("out of range source coordinates for image copy");if(d.width>e.width||d.height>e.height||a.x>e.width-d.width||a.y>e.height-d.height)throw new RangeError("out of range destination coordinates for image copy");const _=n.data,w=e.data;for(let T=0;T<d.height;T++){const M=((i.y+T)*n.width+i.x)*m,L=((a.y+T)*e.width+a.x)*m;for(let z=0;z<d.width*m;z++)w[L+z]=_[M+z]}return e}Jn(Em,"HeatmapBucket",{omit:["layers"]});class gl{constructor(e,i){Dm(this,e,1,i)}resize(e){Zp(this,new gl(e),1)}clone(){return new gl({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,i,a,d,m){Sh(e,i,a,d,m,1)}}class Pa{constructor(e,i){Dm(this,e,4,i)}resize(e){Zp(this,new Pa(e),4)}replace(e,i){i?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e}clone(){return new Pa({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,i,a,d,m){Sh(e,i,a,d,m,4)}}Jn(gl,"AlphaImage"),Jn(Pa,"RGBAImage");var Gp={paint:new Bn({"heatmap-radius":new Nt(on.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Nt(on.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Kt(on.paint_heatmap["heatmap-intensity"]),"heatmap-color":new jn(on.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Kt(on.paint_heatmap["heatmap-opacity"])})};function Hp(n){const e={},i=n.resolution||256,a=n.clips?n.clips.length:1,d=n.image||new Pa({width:i,height:a}),m=(_,w,T)=>{e[n.evaluationKey]=T;const M=n.expression.evaluate(e);d.data[_+w+0]=Math.floor(255*M.r/M.a),d.data[_+w+1]=Math.floor(255*M.g/M.a),d.data[_+w+2]=Math.floor(255*M.b/M.a),d.data[_+w+3]=Math.floor(255*M.a)};if(n.clips)for(let _=0,w=0;_<a;++_,w+=4*i)for(let T=0,M=0;T<i;T++,M+=4){const L=T/(i-1),{start:z,end:V}=n.clips[_];m(w,M,z*(1-L)+V*L)}else for(let _=0,w=0;_<i;_++,w+=4)m(0,w,_/(i-1));return d}var Wp={paint:new Bn({"hillshade-illumination-direction":new Kt(on.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Kt(on.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Kt(on.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Kt(on.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Kt(on.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Kt(on.paint_hillshade["hillshade-accent-color"])})};const Im=Nn([{name:"a_pos",components:2,type:"Int16"}],4),{members:Mm}=Im;var _l={exports:{}};function Ah(n,e,i){i=i||2;var a,d,m,_,w,T,M,L=e&&e.length,z=L?e[0]*i:n.length,V=Ph(n,0,z,i,!0),K=[];if(!V||V.next===V.prev)return K;if(L&&(V=function(ge,ze,rt,wt){var it,ft,At,mt=[];for(it=0,ft=ze.length;it<ft;it++)(At=Ph(ge,ze[it]*wt,it<ft-1?ze[it+1]*wt:ge.length,wt,!1))===At.next&&(At.steiner=!0),mt.push(ku(At));for(mt.sort(Yp),it=0;it<mt.length;it++)rt=u_(mt[it],rt);return rt}(n,e,V,i)),n.length>80*i){a=m=n[0],d=_=n[1];for(var ne=i;ne<z;ne+=i)(w=n[ne])<a&&(a=w),(T=n[ne+1])<d&&(d=T),w>m&&(m=w),T>_&&(_=T);M=0!==(M=Math.max(m-a,_-d))?32767/M:0}return wd(V,K,i,a,d,M,0),K}function Ph(n,e,i,a,d){var m,_;if(d===jc(n,e,i,a)>0)for(m=e;m<i;m+=a)_=Pm(m,n[m],n[m+1],_);else for(m=i-a;m>=e;m-=a)_=Pm(m,n[m],n[m+1],_);return _&&zu(_,_.next)&&(hc(_),_=_.next),_}function Ul(n,e){if(!n)return n;e||(e=n);var i,a=n;do{if(i=!1,a.steiner||!zu(a,a.next)&&0!==Eo(a.prev,a,a.next))a=a.next;else{if(hc(a),(a=e=a.prev)===a.next)break;i=!0}}while(i||a!==e);return e}function wd(n,e,i,a,d,m,_){if(n){!_&&m&&function(L,z,V,K){var ne=L;do{0===ne.z&&(ne.z=Rh(ne.x,ne.y,z,V,K)),ne.prevZ=ne.prev,ne.nextZ=ne.next,ne=ne.next}while(ne!==L);ne.prevZ.nextZ=null,ne.prevZ=null,function(ge){var ze,rt,wt,it,ft,At,mt,rn,en=1;do{for(rt=ge,ge=null,ft=null,At=0;rt;){for(At++,wt=rt,mt=0,ze=0;ze<en&&(mt++,wt=wt.nextZ);ze++);for(rn=en;mt>0||rn>0&&wt;)0!==mt&&(0===rn||!wt||rt.z<=wt.z)?(it=rt,rt=rt.nextZ,mt--):(it=wt,wt=wt.nextZ,rn--),ft?ft.nextZ=it:ge=it,it.prevZ=ft,ft=it;rt=wt}ft.nextZ=null,en*=2}while(At>1)}(ne)}(n,a,d,m);for(var w,T,M=n;n.prev!==n.next;)if(w=n.prev,T=n.next,m?Oh(n,a,d,m):qp(n))e.push(w.i/i|0),e.push(n.i/i|0),e.push(T.i/i|0),hc(n),n=T.next,M=T.next;else if((n=T)===M){_?1===_?wd(n=au(Ul(n),e,i),e,i,a,d,m,2):2===_&&Sm(n,e,i,a,d,m):wd(Ul(n),e,i,a,d,m,1);break}}}function qp(n){var e=n.prev,i=n,a=n.next;if(Eo(e,i,a)>=0)return!1;for(var d=e.x,m=i.x,_=a.x,w=e.y,T=i.y,M=a.y,L=d<m?d<_?d:_:m<_?m:_,z=w<T?w<M?w:M:T<M?T:M,V=d>m?d>_?d:_:m>_?m:_,K=w>T?w>M?w:M:T>M?T:M,ne=a.next;ne!==e;){if(ne.x>=L&&ne.x<=V&&ne.y>=z&&ne.y<=K&&Bu(d,w,m,T,_,M,ne.x,ne.y)&&Eo(ne.prev,ne,ne.next)>=0)return!1;ne=ne.next}return!0}function Oh(n,e,i,a){var d=n.prev,m=n,_=n.next;if(Eo(d,m,_)>=0)return!1;for(var w=d.x,T=m.x,M=_.x,L=d.y,z=m.y,V=_.y,K=w<T?w<M?w:M:T<M?T:M,ne=L<z?L<V?L:V:z<V?z:V,ge=w>T?w>M?w:M:T>M?T:M,ze=L>z?L>V?L:V:z>V?z:V,rt=Rh(K,ne,e,i,a),wt=Rh(ge,ze,e,i,a),it=n.prevZ,ft=n.nextZ;it&&it.z>=rt&&ft&&ft.z<=wt;){if(it.x>=K&&it.x<=ge&&it.y>=ne&&it.y<=ze&&it!==d&&it!==_&&Bu(w,L,T,z,M,V,it.x,it.y)&&Eo(it.prev,it,it.next)>=0||(it=it.prevZ,ft.x>=K&&ft.x<=ge&&ft.y>=ne&&ft.y<=ze&&ft!==d&&ft!==_&&Bu(w,L,T,z,M,V,ft.x,ft.y)&&Eo(ft.prev,ft,ft.next)>=0))return!1;ft=ft.nextZ}for(;it&&it.z>=rt;){if(it.x>=K&&it.x<=ge&&it.y>=ne&&it.y<=ze&&it!==d&&it!==_&&Bu(w,L,T,z,M,V,it.x,it.y)&&Eo(it.prev,it,it.next)>=0)return!1;it=it.prevZ}for(;ft&&ft.z<=wt;){if(ft.x>=K&&ft.x<=ge&&ft.y>=ne&&ft.y<=ze&&ft!==d&&ft!==_&&Bu(w,L,T,z,M,V,ft.x,ft.y)&&Eo(ft.prev,ft,ft.next)>=0)return!1;ft=ft.nextZ}return!0}function au(n,e,i){var a=n;do{var d=a.prev,m=a.next.next;!zu(d,m)&&Am(d,a,a.next,m)&&Nu(d,m)&&Nu(m,d)&&(e.push(d.i/i|0),e.push(a.i/i|0),e.push(m.i/i|0),hc(a),hc(a.next),a=n=m),a=a.next}while(a!==n);return Ul(a)}function Sm(n,e,i,a,d,m){var _=n;do{for(var w=_.next.next;w!==_.prev;){if(_.i!==w.i&&h_(_,w)){var T=p_(_,w);return _=Ul(_,_.next),T=Ul(T,T.next),wd(_,e,i,a,d,m,0),void wd(T,e,i,a,d,m,0)}w=w.next}_=_.next}while(_!==n)}function Yp(n,e){return n.x-e.x}function u_(n,e){var i=function(d,m){var _,w=m,T=d.x,M=d.y,L=-1/0;do{if(M<=w.y&&M>=w.next.y&&w.next.y!==w.y){var z=w.x+(M-w.y)*(w.next.x-w.x)/(w.next.y-w.y);if(z<=T&&z>L&&(L=z,_=w.x<w.next.x?w:w.next,z===T))return _}w=w.next}while(w!==m);if(!_)return null;var V,K=_,ne=_.x,ge=_.y,ze=1/0;w=_;do{T>=w.x&&w.x>=ne&&T!==w.x&&Bu(M<ge?T:L,M,ne,ge,M<ge?L:T,M,w.x,w.y)&&(V=Math.abs(M-w.y)/(T-w.x),Nu(w,d)&&(V<ze||V===ze&&(w.x>_.x||w.x===_.x&&d_(_,w)))&&(_=w,ze=V)),w=w.next}while(w!==K);return _}(n,e);if(!i)return e;var a=p_(i,n);return Ul(a,a.next),Ul(i,i.next)}function d_(n,e){return Eo(n.prev,n,e.prev)<0&&Eo(e.next,n,n.next)<0}function Rh(n,e,i,a,d){return(n=1431655765&((n=858993459&((n=252645135&((n=16711935&((n=(n-i)*d|0)|n<<8))|n<<4))|n<<2))|n<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-a)*d|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function ku(n){var e=n,i=n;do{(e.x<i.x||e.x===i.x&&e.y<i.y)&&(i=e),e=e.next}while(e!==n);return i}function Bu(n,e,i,a,d,m,_,w){return(d-_)*(e-w)>=(n-_)*(m-w)&&(n-_)*(a-w)>=(i-_)*(e-w)&&(i-_)*(m-w)>=(d-_)*(a-w)}function h_(n,e){return n.next.i!==e.i&&n.prev.i!==e.i&&!function(i,a){var d=i;do{if(d.i!==i.i&&d.next.i!==i.i&&d.i!==a.i&&d.next.i!==a.i&&Am(d,d.next,i,a))return!0;d=d.next}while(d!==i);return!1}(n,e)&&(Nu(n,e)&&Nu(e,n)&&function(i,a){var d=i,m=!1,_=(i.x+a.x)/2,w=(i.y+a.y)/2;do{d.y>w!=d.next.y>w&&d.next.y!==d.y&&_<(d.next.x-d.x)*(w-d.y)/(d.next.y-d.y)+d.x&&(m=!m),d=d.next}while(d!==i);return m}(n,e)&&(Eo(n.prev,n,e.prev)||Eo(n,e.prev,e))||zu(n,e)&&Eo(n.prev,n,n.next)>0&&Eo(e.prev,e,e.next)>0)}function Eo(n,e,i){return(e.y-n.y)*(i.x-e.x)-(e.x-n.x)*(i.y-e.y)}function zu(n,e){return n.x===e.x&&n.y===e.y}function Am(n,e,i,a){var d=Lh(Eo(n,e,i)),m=Lh(Eo(n,e,a)),_=Lh(Eo(i,a,n)),w=Lh(Eo(i,a,e));return d!==m&&_!==w||!(0!==d||!Cd(n,i,e))||!(0!==m||!Cd(n,a,e))||!(0!==_||!Cd(i,n,a))||!(0!==w||!Cd(i,e,a))}function Cd(n,e,i){return e.x<=Math.max(n.x,i.x)&&e.x>=Math.min(n.x,i.x)&&e.y<=Math.max(n.y,i.y)&&e.y>=Math.min(n.y,i.y)}function Lh(n){return n>0?1:n<0?-1:0}function Nu(n,e){return Eo(n.prev,n,n.next)<0?Eo(n,e,n.next)>=0&&Eo(n,n.prev,e)>=0:Eo(n,e,n.prev)<0||Eo(n,n.next,e)<0}function p_(n,e){var i=new Jp(n.i,n.x,n.y),a=new Jp(e.i,e.x,e.y),d=n.next,m=e.prev;return n.next=e,e.prev=n,i.next=d,d.prev=i,a.next=i,i.prev=a,m.next=a,a.prev=m,a}function Pm(n,e,i,a){var d=new Jp(n,e,i);return a?(d.next=a.next,d.prev=a,a.next.prev=d,a.next=d):(d.prev=d,d.next=d),d}function hc(n){n.next.prev=n.prev,n.prev.next=n.next,n.prevZ&&(n.prevZ.nextZ=n.nextZ),n.nextZ&&(n.nextZ.prevZ=n.prevZ)}function Jp(n,e,i){this.i=n,this.x=e,this.y=i,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function jc(n,e,i,a){for(var d=0,m=e,_=i-a;m<i;m+=a)d+=(n[_]-n[m])*(n[m+1]+n[_+1]),_=m;return d}function Td(n,e,i,a,d){Om(n,e,i||0,a||n.length-1,d||f_)}function Om(n,e,i,a,d){for(;a>i;){if(a-i>600){var m=a-i+1,_=e-i+1,w=Math.log(m),T=.5*Math.exp(2*w/3),M=.5*Math.sqrt(w*T*(m-T)/m)*(_-m/2<0?-1:1);Om(n,e,Math.max(i,Math.floor(e-_*T/m+M)),Math.min(a,Math.floor(e+(m-_)*T/m+M)),d)}var L=n[e],z=i,V=a;for(Uu(n,i,e),d(n[a],L)>0&&Uu(n,i,a);z<V;){for(Uu(n,z,V),z++,V--;d(n[z],L)<0;)z++;for(;d(n[V],L)>0;)V--}0===d(n[i],L)?Uu(n,i,V):Uu(n,++V,a),V<=e&&(i=V+1),e<=V&&(a=V-1)}}function Uu(n,e,i){var a=n[e];n[e]=n[i],n[i]=a}function f_(n,e){return n<e?-1:n>e?1:0}function Xp(n,e){const i=n.length;if(i<=1)return[n];const a=[];let d,m;for(let _=0;_<i;_++){const w=un(n[_]);0!==w&&(n[_].area=Math.abs(w),void 0===m&&(m=w<0),m===w<0?(d&&a.push(d),d=[n[_]]):d.push(n[_]))}if(d&&a.push(d),e>1)for(let _=0;_<a.length;_++)a[_].length<=e||(Td(a[_],e,1,a[_].length-1,m_),a[_]=a[_].slice(0,e));return a}function m_(n,e){return e.area-n.area}function Fh(n,e,i){const a=i.patternDependencies;let d=!1;for(const m of e){const _=m.paint.get(`${n}-pattern`);_.isConstant()||(d=!0);const w=_.constantOr(null);w&&(d=!0,a[w.to]=!0,a[w.from]=!0)}return d}function Kp(n,e,i,a,d){const m=d.patternDependencies;for(const _ of e){const w=_.paint.get(`${n}-pattern`).value;if("constant"!==w.kind){let T=w.evaluate({zoom:a-1},i,{},d.availableImages),M=w.evaluate({zoom:a},i,{},d.availableImages),L=w.evaluate({zoom:a+1},i,{},d.availableImages);T=T&&T.name?T.name:T,M=M&&M.name?M.name:M,L=L&&L.name?L.name:L,m[T]=!0,m[M]=!0,m[L]=!0,i.patterns[_.id]={min:T,mid:M,max:L}}}return i}_l.exports=Ah,_l.exports.default=Ah,Ah.deviation=function(n,e,i,a){var d=e&&e.length,m=Math.abs(jc(n,0,d?e[0]*i:n.length,i));if(d)for(var _=0,w=e.length;_<w;_++)m-=Math.abs(jc(n,e[_]*i,_<w-1?e[_+1]*i:n.length,i));var T=0;for(_=0;_<a.length;_+=3){var M=a[_]*i,L=a[_+1]*i,z=a[_+2]*i;T+=Math.abs((n[M]-n[z])*(n[L+1]-n[M+1])-(n[M]-n[L])*(n[z+1]-n[M+1]))}return 0===m&&0===T?0:Math.abs((T-m)/m)},Ah.flatten=function(n){for(var e=n[0][0].length,i={vertices:[],holes:[],dimensions:e},a=0,d=0;d<n.length;d++){for(var m=0;m<n[d].length;m++)for(var _=0;_<e;_++)i.vertices.push(n[d][m][_]);d>0&&i.holes.push(a+=n[d-1].length)}return i};class Vu{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(i=>i.id),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new $i,this.indexArray=new ys,this.indexArray2=new Qs,this.programConfigurations=new cc(e.layers,e.zoom),this.segments=new Lo,this.segments2=new Lo,this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id),this.projection=e.projection}populate(e,i,a,d){this.hasPattern=Fh("fill",this.layers,i);const m=this.layers[0].layout.get("fill-sort-key"),_=[];for(const{feature:w,id:T,index:M,sourceLayerIndex:L}of e){const z=this.layers[0]._featureFilter.needGeometry,V=uc(w,z);if(!this.layers[0]._featureFilter.filter(new ot(this.zoom),V,a))continue;const K=m?m.evaluate(V,{},a,i.availableImages):void 0,ne={id:T,properties:w.properties,type:w.type,sourceLayerIndex:L,index:M,geometry:z?V.geometry:Ja(w,a,d),patterns:{},sortKey:K};_.push(ne)}m&&_.sort((w,T)=>w.sortKey-T.sortKey);for(const w of _){const{geometry:T,index:M,sourceLayerIndex:L}=w;if(this.hasPattern){const z=Kp("fill",this.layers,w,this.zoom,i);this.patternFeatures.push(z)}else this.addFeature(w,T,M,a,{},i.availableImages);i.featureIndex.insert(e[M].feature,T,M,L,this.index)}}update(e,i,a,d){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,i,this.stateDependentLayers,a,d)}addFeatures(e,i,a,d,m){for(const _ of this.patternFeatures)this.addFeature(_,_.geometry,_.index,i,a,d)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Mm),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(e,i,a,d,m,_=[]){for(const w of Xp(i,500)){let T=0;for(const ne of w)T+=ne.length;const M=this.segments.prepareSegment(T,this.layoutVertexArray,this.indexArray),L=M.vertexLength,z=[],V=[];for(const ne of w){if(0===ne.length)continue;ne!==w[0]&&V.push(z.length/2);const ge=this.segments2.prepareSegment(ne.length,this.layoutVertexArray,this.indexArray2),ze=ge.vertexLength;this.layoutVertexArray.emplaceBack(ne[0].x,ne[0].y),this.indexArray2.emplaceBack(ze+ne.length-1,ze),z.push(ne[0].x),z.push(ne[0].y);for(let rt=1;rt<ne.length;rt++)this.layoutVertexArray.emplaceBack(ne[rt].x,ne[rt].y),this.indexArray2.emplaceBack(ze+rt-1,ze+rt),z.push(ne[rt].x),z.push(ne[rt].y);ge.vertexLength+=ne.length,ge.primitiveLength+=ne.length}const K=_l.exports(z,V);for(let ne=0;ne<K.length;ne+=3)this.indexArray.emplaceBack(L+K[ne],L+K[ne+1],L+K[ne+2]);M.vertexLength+=T,M.primitiveLength+=K.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,a,m,_,d)}}Jn(Vu,"FillBucket",{omit:["layers","patternFeatures"]});const Qp=new Bn({"fill-sort-key":new Nt(on.layout_fill["fill-sort-key"])});var g_={paint:new Bn({"fill-antialias":new Kt(on.paint_fill["fill-antialias"]),"fill-opacity":new Nt(on.paint_fill["fill-opacity"]),"fill-color":new Nt(on.paint_fill["fill-color"]),"fill-outline-color":new Nt(on.paint_fill["fill-outline-color"]),"fill-translate":new Kt(on.paint_fill["fill-translate"]),"fill-translate-anchor":new Kt(on.paint_fill["fill-translate-anchor"]),"fill-pattern":new qn(on.paint_fill["fill-pattern"])}),layout:Qp};const ef=Nn([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),Ed=Nn([{name:"a_centroid_pos",components:2,type:"Uint16"}]),__=Nn([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:y_}=ef;var kh={},v_=te,Rm=ju;function ju(n,e,i,a,d){this.properties={},this.extent=i,this.type=0,this._pbf=n,this._geometry=-1,this._keys=a,this._values=d,n.readFields(x_,this,e)}function x_(n,e,i){1==n?e.id=i.readVarint():2==n?function(a,d){for(var m=a.readVarint()+a.pos;a.pos<m;){var _=d._keys[a.readVarint()],w=d._values[a.readVarint()];d.properties[_]=w}}(i,e):3==n?e.type=i.readVarint():4==n&&(e._geometry=i.pos)}function $u(n){for(var e,i,a=0,d=0,m=n.length,_=m-1;d<m;_=d++)a+=((i=n[_]).x-(e=n[d]).x)*(e.y+i.y);return a}ju.types=["Unknown","Point","LineString","Polygon"],ju.prototype.loadGeometry=function(){var n=this._pbf;n.pos=this._geometry;for(var e,i=n.readVarint()+n.pos,a=1,d=0,m=0,_=0,w=[];n.pos<i;){if(d<=0){var T=n.readVarint();a=7&T,d=T>>3}if(d--,1===a||2===a)m+=n.readSVarint(),_+=n.readSVarint(),1===a&&(e&&w.push(e),e=[]),e.push(new v_(m,_));else{if(7!==a)throw new Error("unknown command "+a);e&&e.push(e[0].clone())}}return e&&w.push(e),w},ju.prototype.bbox=function(){var n=this._pbf;n.pos=this._geometry;for(var e=n.readVarint()+n.pos,i=1,a=0,d=0,m=0,_=1/0,w=-1/0,T=1/0,M=-1/0;n.pos<e;){if(a<=0){var L=n.readVarint();i=7&L,a=L>>3}if(a--,1===i||2===i)(d+=n.readSVarint())<_&&(_=d),d>w&&(w=d),(m+=n.readSVarint())<T&&(T=m),m>M&&(M=m);else if(7!==i)throw new Error("unknown command "+i)}return[_,T,w,M]},ju.prototype.toGeoJSON=function(n,e,i){var a,d,m=this.extent*Math.pow(2,i),_=this.extent*n,w=this.extent*e,T=this.loadGeometry(),M=ju.types[this.type];function L(K){for(var ne=0;ne<K.length;ne++){var ge=K[ne];K[ne]=[360*(ge.x+_)/m-180,360/Math.PI*Math.atan(Math.exp((180-360*(ge.y+w)/m)*Math.PI/180))-90]}}switch(this.type){case 1:var z=[];for(a=0;a<T.length;a++)z[a]=T[a][0];L(T=z);break;case 2:for(a=0;a<T.length;a++)L(T[a]);break;case 3:for(T=function(K){var ne=K.length;if(ne<=1)return[K];for(var ge,ze,rt=[],wt=0;wt<ne;wt++){var it=$u(K[wt]);0!==it&&(void 0===ze&&(ze=it<0),ze===it<0?(ge&&rt.push(ge),ge=[K[wt]]):ge.push(K[wt]))}return ge&&rt.push(ge),rt}(T),a=0;a<T.length;a++)for(d=0;d<T[a].length;d++)L(T[a][d])}1===T.length?T=T[0]:M="Multi"+M;var V={type:"Feature",geometry:{type:M,coordinates:T},properties:this.properties};return"id"in this&&(V.id=this.id),V};var pc=Rm,Lm=Fm;function Fm(n,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=n,this._keys=[],this._values=[],this._features=[],n.readFields(By,this,e),this.length=this._features.length}function By(n,e,i){15===n?e.version=i.readVarint():1===n?e.name=i.readString():5===n?e.extent=i.readVarint():2===n?e._features.push(i.pos):3===n?e._keys.push(i.readString()):4===n&&e._values.push(function(a){for(var d=null,m=a.readVarint()+a.pos;a.pos<m;){var _=a.readVarint()>>3;d=1===_?a.readString():2===_?a.readFloat():3===_?a.readDouble():4===_?a.readVarint64():5===_?a.readVarint():6===_?a.readSVarint():7===_?a.readBoolean():null}return d}(i))}Fm.prototype.feature=function(n){if(n<0||n>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[n];var e=this._pbf.readVarint()+this._pbf.pos;return new pc(this._pbf,e,this.extent,this._keys,this._values)};var zy=Lm;function km(n,e,i){if(3===n){var a=new zy(i,i.readVarint()+i.pos);a.length&&(e[a.name]=a)}}var Bm=kh.VectorTile=function(n,e){this.layers=n.readFields(km,{},e)},Dd=kh.VectorTileFeature=Rm;function Id(n,e,i,a){const d=[],m=0===a?(_,w,T,M,L,z)=>{_.push(new te(z,T+(z-w)/(M-w)*(L-T)))}:(_,w,T,M,L,z)=>{_.push(new te(w+(z-T)/(L-T)*(M-w),z))};for(const _ of n){const w=[];for(const T of _){if(T.length<=2)continue;const M=[];for(let V=0;V<T.length-1;V++){const K=T[V].x,ne=T[V].y,ge=T[V+1].x,ze=T[V+1].y,rt=0===a?K:ne,wt=0===a?ge:ze;rt<e?wt>e&&m(M,K,ne,ge,ze,e):rt>i?wt<i&&m(M,K,ne,ge,ze,i):M.push(T[V]),wt<e&&rt>=e&&m(M,K,ne,ge,ze,e),wt>i&&rt<=i&&m(M,K,ne,ge,ze,i)}let L=T[T.length-1];const z=0===a?L.x:L.y;z>=e&&z<=i&&M.push(L),M.length&&(L=M[M.length-1],M[0].x===L.x&&M[0].y===L.y||M.push(M[0]),w.push(M))}w.length&&d.push(w)}return d}kh.VectorTileLayer=Lm;const b_=Dd.types,zm=Math.pow(2,13);function Md(n,e,i,a,d,m,_,w){n.emplaceBack((e<<1)+_,(i<<1)+m,(Math.floor(a*zm)<<1)+d,Math.round(w))}function Sd(n,e,i){n.emplaceBack(e.x,e.y,e.z,16384*i[0],16384*i[1],16384*i[2])}class Qa{constructor(){this.acc=new te(0,0),this.polyCount=[]}startRing(e){this.currentPolyCount={edges:0,top:0},this.polyCount.push(this.currentPolyCount),this.min||(this.min=new te(e.x,e.y),this.max=new te(e.x,e.y))}append(e,i){this.currentPolyCount.edges++,this.acc._add(e);const a=this.min,d=this.max;e.x<a.x?a.x=e.x:e.x>d.x&&(d.x=e.x),e.y<a.y?a.y=e.y:e.y>d.y&&(d.y=e.y),((0===e.x||e.x===Si)&&e.x===i.x)!=((0===e.y||e.y===Si)&&e.y===i.y)&&this.processBorderOverlap(e,i),i.x<0!=e.x<0&&this.addBorderIntersection(0,ji(i.y,e.y,(0-i.x)/(e.x-i.x))),i.x>Si!=e.x>Si&&this.addBorderIntersection(1,ji(i.y,e.y,(Si-i.x)/(e.x-i.x))),i.y<0!=e.y<0&&this.addBorderIntersection(2,ji(i.x,e.x,(0-i.y)/(e.y-i.y))),i.y>Si!=e.y>Si&&this.addBorderIntersection(3,ji(i.x,e.x,(Si-i.y)/(e.y-i.y)))}addBorderIntersection(e,i){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const a=this.borders[e];i<a[0]&&(a[0]=i),i>a[1]&&(a[1]=i)}processBorderOverlap(e,i){if(e.x===i.x){if(e.y===i.y)return;const a=0===e.x?0:1;this.addBorderIntersection(a,i.y),this.addBorderIntersection(a,e.y)}else{const a=0===e.y?2:3;this.addBorderIntersection(a,i.x),this.addBorderIntersection(a,e.x)}}centroid(){const e=this.polyCount.reduce((i,a)=>i+a.edges,0);return 0!==e?this.acc.div(e)._round():new te(0,0)}span(){return new te(this.max.x-this.min.x,this.max.y-this.min.y)}intersectsCount(){return this.borders.reduce((e,i)=>e+ +(i[0]!==Number.MAX_VALUE),0)}}class Ad{constructor(e){this.zoom=e.zoom,this.canonical=e.canonical,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(i=>i.id),this.index=e.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=e.projection,this.layoutVertexArray=new Ir,this.centroidVertexArray=new yp,this.indexArray=new ys,this.programConfigurations=new cc(e.layers,e.zoom),this.segments=new Lo,this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id),this.enableTerrain=e.enableTerrain}populate(e,i,a,d){this.features=[],this.hasPattern=Fh("fill-extrusion",this.layers,i),this.featuresOnBorder=[],this.borders=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=function(m){const _=Math.exp(Math.PI*(1-m.y/(1<<m.z)*2));return 80150034*_/(_*_+1)/Si/(1<<m.z)}(a),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter;for(const{feature:m,id:_,index:w,sourceLayerIndex:T}of e){const M=this.layers[0]._featureFilter.needGeometry,L=uc(m,M);if(!this.layers[0]._featureFilter.filter(new ot(this.zoom),L,a))continue;const z={id:_,sourceLayerIndex:T,index:w,geometry:M?L.geometry:Ja(m,a,d),properties:m.properties,type:m.type,patterns:{}},V=this.layoutVertexArray.length;this.hasPattern?this.features.push(Kp("fill-extrusion",this.layers,z,this.zoom,i)):this.addFeature(z,z.geometry,w,a,{},i.availableImages,d),i.featureIndex.insert(m,z.geometry,w,T,this.index,V)}this.sortBorders()}addFeatures(e,i,a,d,m){for(const _ of this.features){const{geometry:w}=_;this.addFeature(_,w,_.index,i,a,d,m)}this.sortBorders()}update(e,i,a,d){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,i,this.stateDependentLayers,a,d)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,y_),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=e.createVertexBuffer(this.layoutVertexExtArray,__.members,!0))),this.programConfigurations.upload(e),this.uploaded=!0}uploadCentroid(e){0!==this.centroidVertexArray.length&&(this.centroidVertexBuffer?this.needsCentroidUpdate&&this.centroidVertexBuffer.updateData(this.centroidVertexArray):this.centroidVertexBuffer=e.createVertexBuffer(this.centroidVertexArray,Ed.members,!0),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(e,i,a,d,m,_,w){const T=[new te(0,0),new te(Si,Si)],M=w.projection,L="globe"===M.name,z=this.enableTerrain&&!L?new Qa:null,V="Polygon"===b_[e.type];L&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new pp);const K=Xp(i,500);for(let rt=K.length-1;rt>=0;rt--){const wt=K[rt];(0===wt.length||(ne=wt[0]).every(it=>it.x<=0)||ne.every(it=>it.x>=Si)||ne.every(it=>it.y<=0)||ne.every(it=>it.y>=Si))&&K.splice(rt,1)}var ne;let ge;if(L)ge=$m(K,T,d);else{ge=[];for(const rt of K)ge.push({polygon:rt,bounds:T})}const ze=V?this.edgeRadius:0;for(const{polygon:rt,bounds:wt}of ge){let it=0,ft=0;for(const mt of rt)V&&!mt[0].equals(mt[mt.length-1])&&mt.push(mt[0]),ft+=V?mt.length-1:mt.length;const At=this.segments.prepareSegment((V?5:4)*ft,this.layoutVertexArray,this.indexArray);if(V){const mt=[],rn=[];it=At.vertexLength;for(const mn of rt){let Pn,sn;mn.length&&mn!==rt[0]&&rn.push(mt.length/2),Pn=mn[1].sub(mn[0])._perp()._unit();for(let vn=1;vn<mn.length;vn++){const xn=mn[vn],Sn=mn[vn===mn.length-1?1:vn+1];let{x:On,y:ln}=xn;if(ze){sn=Sn.sub(xn)._perp()._unit();const $n=Pn.add(sn)._unit(),vi=ze*Math.min(4,1/(Pn.x*$n.x+Pn.y*$n.y));On+=vi*$n.x,ln+=vi*$n.y,Pn=sn}Md(this.layoutVertexArray,On,ln,0,0,1,1,0),At.vertexLength++,mt.push(xn.x,xn.y),L&&Sd(this.layoutVertexExtArray,M.projectTilePoint(On,ln,d),M.upVector(d,On,ln))}}const en=_l.exports(mt,rn);for(let mn=0;mn<en.length;mn+=3)this.indexArray.emplaceBack(it+en[mn],it+en[mn+2],it+en[mn+1]),At.primitiveLength++}for(const mt of rt){z&&mt.length&&z.startRing(mt[0]);let rn,en,mn,Pn=mt.length>4&&Vm(mt[mt.length-2],mt[0],mt[1]),sn=ze?w_(mt[mt.length-2],mt[0],mt[1],ze):0;en=mt[1].sub(mt[0])._perp()._unit();let vn=!0;for(let xn=1,Sn=0;xn<mt.length;xn++){let On=mt[xn-1],ln=mt[xn];const $n=mt[xn===mt.length-1?1:xn+1];if(z&&V&&z.currentPolyCount.top++,Um(ln,On,wt)){ze&&(en=$n.sub(ln)._perp()._unit(),vn=!vn);continue}z&&z.append(ln,On);const vi=ln.sub(On)._perp(),Xn=vi.x/(Math.abs(vi.x)+Math.abs(vi.y)),oi=vi.y>0?1:0,Hn=On.dist(ln);if(Sn+Hn>32768&&(Sn=0),ze){mn=$n.sub(ln)._perp()._unit();let hr=Nm(On,ln,$n,tf(en,mn),ze);isNaN(hr)&&(hr=0);const Fi=ln.sub(On)._unit();On=On.add(Fi.mult(sn))._round(),ln=ln.add(Fi.mult(-hr))._round(),sn=hr,en=mn}const Ti=At.vertexLength,Li=mt.length>4&&Vm(On,ln,$n);let zi=nf(Sn,Pn,vn);if(Md(this.layoutVertexArray,On.x,On.y,Xn,oi,0,0,zi),Md(this.layoutVertexArray,On.x,On.y,Xn,oi,0,1,zi),Sn+=Hn,zi=nf(Sn,Li,!vn),Pn=Li,Md(this.layoutVertexArray,ln.x,ln.y,Xn,oi,0,0,zi),Md(this.layoutVertexArray,ln.x,ln.y,Xn,oi,0,1,zi),At.vertexLength+=4,this.indexArray.emplaceBack(Ti+0,Ti+1,Ti+2),this.indexArray.emplaceBack(Ti+1,Ti+3,Ti+2),At.primitiveLength+=2,ze){const hr=it+(1===xn?mt.length-2:xn-2),Fi=1===xn?it:hr+1;if(this.indexArray.emplaceBack(Ti+1,hr,Ti+3),this.indexArray.emplaceBack(hr,Fi,Ti+3),At.primitiveLength+=2,void 0===rn&&(rn=Ti),!Um($n,mt[xn],wt)){const Xr=xn===mt.length-1?rn:At.vertexLength;this.indexArray.emplaceBack(Ti+2,Ti+3,Xr),this.indexArray.emplaceBack(Ti+3,Xr+1,Xr),this.indexArray.emplaceBack(Ti+3,Fi,Xr+1),At.primitiveLength+=3}vn=!vn}if(L){const hr=this.layoutVertexExtArray,Fi=M.projectTilePoint(On.x,On.y,d),Xr=M.projectTilePoint(ln.x,ln.y,d),Zi=M.upVector(d,On.x,On.y),Qi=M.upVector(d,ln.x,ln.y);Sd(hr,Fi,Zi),Sd(hr,Fi,Zi),Sd(hr,Xr,Qi),Sd(hr,Xr,Qi)}}V&&(it+=mt.length-1)}}if(z&&z.polyCount.length>0){if(z.borders){z.vertexArrayOffset=this.centroidVertexArray.length;const rt=z.borders,wt=this.featuresOnBorder.push(z)-1;for(let it=0;it<4;it++)rt[it][0]!==Number.MAX_VALUE&&this.borders[it].push(wt)}this.encodeCentroid(z.borders?void 0:z.centroid(),z)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,a,m,_,d)}sortBorders(){for(let e=0;e<4;e++)this.borders[e].sort((i,a)=>this.featuresOnBorder[i].borders[e][0]-this.featuresOnBorder[a].borders[e][0])}encodeCentroid(e,i,a=!0){let d,m;if(e)if(0!==e.y){const w=i.span()._mult(this.tileToMeter);d=(Math.max(e.x,1)<<3)+Math.min(7,Math.round(w.x/10)),m=(Math.max(e.y,1)<<3)+Math.min(7,Math.round(w.y/10))}else d=Math.ceil(7*(e.x+450)),m=0;else d=0,m=+a;let _=a?this.centroidVertexArray.length:i.vertexArrayOffset;for(const w of i.polyCount){a&&this.centroidVertexArray.resize(this.centroidVertexArray.length+4*w.edges+w.top);for(let T=0;T<w.top;T++)this.centroidVertexArray.emplace(_++,d,m);for(let T=0;T<2*w.edges;T++)this.centroidVertexArray.emplace(_++,0,m),this.centroidVertexArray.emplace(_++,d,m)}}}function tf(n,e){const i=n.add(e)._unit();return n.x*i.x+n.y*i.y}function w_(n,e,i,a){const d=e.sub(n)._perp()._unit(),m=i.sub(e)._perp()._unit();return Nm(n,e,i,tf(d,m),a)}function Nm(n,e,i,a,d){const m=Math.sqrt(1-a*a);return Math.min(n.dist(e)/3,e.dist(i)/3,d*m/a)}function Um(n,e,i){return n.x<i[0].x&&e.x<i[0].x||n.x>i[1].x&&e.x>i[1].x||n.y<i[0].y&&e.y<i[0].y||n.y>i[1].y&&e.y>i[1].y}function Vm(n,e,i){if(n.x<0||n.x>=Si||e.x<0||e.x>=Si||i.x<0||i.x>=Si)return!1;const a=i.sub(e),d=a.perp(),m=n.sub(e);return(a.x*m.x+a.y*m.y)/Math.sqrt((a.x*a.x+a.y*a.y)*(m.x*m.x+m.y*m.y))>-.866&&d.x*m.x+d.y*m.y<0}function nf(n,e,i){const a=e?2|n:-3&n;return i?1|a:-2&a}function jm(){const n=Math.PI/32,e=Math.tan(n),i=hh;return i*Math.sqrt(1+2*e*e)-i}function $m(n,e,i){const a=1<<i.z,d=Zs(i.x/a),m=Zs((i.x+1)/a),_=os(i.y/a),w=os((i.y+1)/a);return function(T,M,L,z,V=0,K){const ne=[];if(!T.length||!L||!z)return ne;const ge=(mt,rn)=>{for(const en of mt)ne.push({polygon:en,bounds:rn})},ze=Math.ceil(Math.log2(L)),rt=Math.ceil(Math.log2(z)),wt=ze-rt,it=[];for(let mt=0;mt<Math.abs(wt);mt++)it.push(wt>0?0:1);for(let mt=0;mt<Math.min(ze,rt);mt++)it.push(0),it.push(1);let ft=T;if(ft=Id(ft,M[0].y-V,M[1].y+V,1),ft=Id(ft,M[0].x-V,M[1].x+V,0),!ft.length)return ne;const At=[];for(it.length?At.push({polygons:ft,bounds:M,depth:0}):ge(ft,M);At.length;){const mt=At.pop(),rn=mt.depth,en=it[rn],mn=mt.bounds[0],Pn=mt.bounds[1],sn=0===en?mn.x:mn.y,vn=0===en?Pn.x:Pn.y,xn=K?K(en,sn,vn):.5*(sn+vn),Sn=Id(mt.polygons,sn-V,xn+V,en),On=Id(mt.polygons,xn-V,vn+V,en);if(Sn.length){const ln=[mn,new te(0===en?xn:Pn.x,1===en?xn:Pn.y)];it.length>rn+1?At.push({polygons:Sn,bounds:ln,depth:rn+1}):ge(Sn,ln)}if(On.length){const ln=[new te(0===en?xn:mn.x,1===en?xn:mn.y),Pn];it.length>rn+1?At.push({polygons:On,bounds:ln,depth:rn+1}):ge(On,ln)}}return ne}(n,e,Math.ceil((m-d)/11.25),Math.ceil((_-w)/11.25),1,(T,M,L)=>{if(0===T)return.5*(M+L);{const z=os((i.y+M/Si)/a);return(fl(.5*(os((i.y+L/Si)/a)+z))*a-i.y)*Si}})}Jn(Ad,"FillExtrusionBucket",{omit:["layers","features"]}),Jn(Qa,"PartMetadata");const C_=new Bn({"fill-extrusion-edge-radius":new Kt(on["layout_fill-extrusion"]["fill-extrusion-edge-radius"])});var Ki={paint:new Bn({"fill-extrusion-opacity":new Kt(on["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Nt(on["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Kt(on["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Kt(on["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new qn(on["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Nt(on["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Nt(on["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Kt(on["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new Kt(on["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new Kt(on["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"])}),layout:C_};function rf(n,e,i){var a=2*Math.PI*6378137/256/Math.pow(2,i);return[n*a-2*Math.PI*6378137/2,e*a-2*Math.PI*6378137/2]}class Pd{constructor(e,i,a){this.z=e,this.x=i,this.y=a,this.key=Od(0,e,e,i,a)}equals(e){return this.z===e.z&&this.x===e.x&&this.y===e.y}url(e,i){const a=(_=this.y,w=this.z,T=rf(256*(m=this.x),256*(_=Math.pow(2,w)-_-1),w),M=rf(256*(m+1),256*(_+1),w),T[0]+","+T[1]+","+M[0]+","+M[1]),d=function(m,_,w){let T,M="";for(let L=m;L>0;L--)T=1<<L-1,M+=(_&T?1:0)+(w&T?2:0);return M}(this.z,this.x,this.y);var m,_,w,T,M;return e[(this.x+this.y)%e.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String("tms"===i?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",d).replace("{bbox-epsg-3857}",a)}toString(){return`${this.z}/${this.x}/${this.y}`}}class sf{constructor(e,i){this.wrap=e,this.canonical=i,this.key=Od(e,i.z,i.z,i.x,i.y)}}class Hs{constructor(e,i,a,d,m){this.overscaledZ=e,this.wrap=i,this.canonical=new Pd(a,+d,+m),this.key=0===i&&e===a?this.canonical.key:Od(i,e,a,d,m)}equals(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)}scaledTo(e){const i=this.canonical.z-e;return e>this.canonical.z?new Hs(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Hs(e,this.wrap,e,this.canonical.x>>i,this.canonical.y>>i)}calculateScaledKey(e,i=!0){if(this.overscaledZ===e&&i)return this.key;if(e>this.canonical.z)return Od(this.wrap*+i,e,this.canonical.z,this.canonical.x,this.canonical.y);{const a=this.canonical.z-e;return Od(this.wrap*+i,e,e,this.canonical.x>>a,this.canonical.y>>a)}}isChildOf(e){if(e.wrap!==this.wrap)return!1;const i=this.canonical.z-e.canonical.z;return 0===e.overscaledZ||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>i&&e.canonical.y===this.canonical.y>>i}children(e){if(this.overscaledZ>=e)return[new Hs(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const i=this.canonical.z+1,a=2*this.canonical.x,d=2*this.canonical.y;return[new Hs(i,this.wrap,i,a,d),new Hs(i,this.wrap,i,a+1,d),new Hs(i,this.wrap,i,a,d+1),new Hs(i,this.wrap,i,a+1,d+1)]}isLessThan(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))}wrapped(){return new Hs(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(e){return new Hs(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new sf(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function Od(n,e,i,a,d){const m=1<<Math.min(i,22);let _=m*(d%m)+a%m;return n&&i<22&&(_+=m*m*((n<0?-2*n-1:2*n)%(1<<2*(22-i)))),16*(32*_+i)+(e-i)}Jn(Pd,"CanonicalTileID"),Jn(Hs,"OverscaledTileID",{omit:["projMatrix"]});class lu extends te{constructor(e,i,a){super(e,i),this.z=a}}function Rd(n,e){return n.x*e.x+n.y*e.y}function af(n,e){if(1===n.length){let i=0;const a=e[i++];let d;for(;!d||a.equals(d);)if(d=e[i++],!d)return 1/0;for(;i<e.length;i++){const m=e[i],_=n[0],w=d.sub(a),T=m.sub(a),M=_.sub(a),L=Rd(w,w),z=Rd(w,T),V=Rd(T,T),K=Rd(M,w),ne=Rd(M,T),ge=L*V-z*z,ze=(V*K-z*ne)/ge,rt=(L*ne-z*K)/ge,wt=a.z*(1-ze-rt)+d.z*ze+m.z*rt;if(isFinite(wt))return wt}return 1/0}{let i=1/0;for(const a of e)i=Math.min(i,a.z);return i}}function Zm(n,e,i,a,d,m,_,w){const T=_*d.getElevationAt(n,e,!0,!0),M=0!==m[0],L=M?0===m[1]?_*(m[0]/7-450):_*function(z,V,K){const ne=Math.floor(V[0]/8),ge=Math.floor(V[1]/8),ze=10*(V[0]-8*ne),rt=10*(V[1]-8*ge),wt=z.getElevationAt(ne,ge,!0,!0),it=z.getMeterToDEM(K),ft=Math.floor(.5*(ze*it-1)),At=Math.floor(.5*(rt*it-1)),mt=z.tileCoordToPixel(ne,ge),rn=2*ft+1,en=2*At+1,mn=(vi=rn,Xn=en,[(On=z).getElevationAtPixel(ln=mt.x-ft,$n=mt.y-At,!0),On.getElevationAtPixel(ln+Xn,$n,!0),On.getElevationAtPixel(ln,$n+Xn,!0),On.getElevationAtPixel(ln+vi,$n+Xn,!0)]),Pn=Math.abs(mn[0]-mn[1]),sn=Math.abs(mn[2]-mn[3]),vn=Math.abs(mn[0]-mn[2])+Math.abs(mn[1]-mn[3]),xn=Math.min(.25,.5*it*(Pn+sn)/rn),Sn=Math.min(.25,.5*it*vn/en);var On,ln,$n,vi,Xn;return wt+Math.max(xn*ze,Sn*rt)}(d,m,w):T;return{base:T+(0===i)?-1:i,top:M?Math.max(L+a,T+i+2):T+a}}const T_=Nn([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:Ny}=T_,Gm=Nn([{name:"a_packed",components:4,type:"Float32"}]),{members:Hm}=Gm,cu=Dd.types,E_=Math.cos(Math.PI/180*37.5);class Zu{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(i=>i.id),this.index=e.index,this.projection=e.projection,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(i=>{this.gradients[i.id]={}}),this.layoutVertexArray=new Ar,this.layoutVertexArray2=new qo,this.indexArray=new ys,this.programConfigurations=new cc(e.layers,e.zoom),this.segments=new Lo,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id)}populate(e,i,a,d){this.hasPattern=Fh("line",this.layers,i);const m=this.layers[0].layout.get("line-sort-key"),_=[];for(const{feature:L,id:z,index:V,sourceLayerIndex:K}of e){const ne=this.layers[0]._featureFilter.needGeometry,ge=uc(L,ne);if(!this.layers[0]._featureFilter.filter(new ot(this.zoom),ge,a))continue;const ze=m?m.evaluate(ge,{},a):void 0,rt={id:z,properties:L.properties,type:L.type,sourceLayerIndex:K,index:V,geometry:ne?ge.geometry:Ja(L,a,d),patterns:{},sortKey:ze};_.push(rt)}m&&_.sort((L,z)=>L.sortKey-z.sortKey);const{lineAtlas:w,featureIndex:T}=i,M=this.addConstantDashes(w);for(const L of _){const{geometry:z,index:V,sourceLayerIndex:K}=L;if(M&&this.addFeatureDashes(L,w),this.hasPattern){const ne=Kp("line",this.layers,L,this.zoom,i);this.patternFeatures.push(ne)}else this.addFeature(L,z,V,a,w.positions,i.availableImages);T.insert(e[V].feature,z,V,K,this.index)}}addConstantDashes(e){let i=!1;for(const a of this.layers){const d=a.paint.get("line-dasharray").value,m=a.layout.get("line-cap").value;if("constant"!==d.kind||"constant"!==m.kind)i=!0;else{const _=m.value,w=d.value;if(!w)continue;e.addDash(w.from,_),e.addDash(w.to,_),w.other&&e.addDash(w.other,_)}}return i}addFeatureDashes(e,i){const a=this.zoom;for(const d of this.layers){const m=d.paint.get("line-dasharray").value,_=d.layout.get("line-cap").value;if("constant"===m.kind&&"constant"===_.kind)continue;let w,T,M,L,z,V;if("constant"===m.kind){const ze=m.value;if(!ze)continue;w=ze.other||ze.to,T=ze.to,M=ze.from}else w=m.evaluate({zoom:a-1},e),T=m.evaluate({zoom:a},e),M=m.evaluate({zoom:a+1},e);"constant"===_.kind?L=z=V=_.value:(L=_.evaluate({zoom:a-1},e),z=_.evaluate({zoom:a},e),V=_.evaluate({zoom:a+1},e)),i.addDash(w,L),i.addDash(T,z),i.addDash(M,V);const K=i.getKey(w,L),ne=i.getKey(T,z),ge=i.getKey(M,V);e.patterns[d.id]={min:K,mid:ne,max:ge}}}update(e,i,a,d){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,i,this.stateDependentLayers,a,d)}addFeatures(e,i,a,d,m){for(const _ of this.patternFeatures)this.addFeature(_,_.geometry,_.index,i,a,d)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(0!==this.layoutVertexArray2.length&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,Hm)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Ny),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(e){if(e.properties&&e.properties.hasOwnProperty("mapbox_clip_start")&&e.properties.hasOwnProperty("mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}}addFeature(e,i,a,d,m,_){const w=this.layers[0].layout,T=w.get("line-join").evaluate(e,{}),M=w.get("line-cap").evaluate(e,{}),L=w.get("line-miter-limit"),z=w.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(const V of i)this.addLine(V,e,T,M,L,z);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,a,m,_,d)}addLine(e,i,a,d,m,_){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let rt=0;rt<e.length-1;rt++)this.totalDistance+=e[rt].dist(e[rt+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const w="Polygon"===cu[i.type];let T=e.length;for(;T>=2&&e[T-1].equals(e[T-2]);)T--;let M=0;for(;M<T-1&&e[M].equals(e[M+1]);)M++;if(T<(w?3:2))return;"bevel"===a&&(m=1.05);const L=this.overscaling<=16?122880/(512*this.overscaling):0,z=this.segments.prepareSegment(10*T,this.layoutVertexArray,this.indexArray);let V,K,ne,ge,ze;this.e1=this.e2=-1,w&&(V=e[T-2],ze=e[M].sub(V)._unit()._perp());for(let rt=M;rt<T;rt++){if(ne=rt===T-1?w?e[M+1]:void 0:e[rt+1],ne&&e[rt].equals(ne))continue;ze&&(ge=ze),V&&(K=V),V=e[rt],ze=ne?ne.sub(V)._unit()._perp():ge,ge=ge||ze;let wt=ge.add(ze);0===wt.x&&0===wt.y||wt._unit();const it=ge.x*ze.x+ge.y*ze.y,ft=wt.x*ze.x+wt.y*ze.y,At=0!==ft?1/ft:1/0,mt=2*Math.sqrt(2-2*ft),rn=ft<E_&&K&&ne,en=ge.x*ze.y-ge.y*ze.x>0;if(rn&&rt>M){const sn=V.dist(K);if(sn>2*L){const vn=V.sub(V.sub(K)._mult(L/sn)._round());this.updateDistance(K,vn),this.addCurrentVertex(vn,ge,0,0,z),K=vn}}const mn=K&&ne;let Pn=mn?a:w?"butt":d;if(mn&&"round"===Pn&&(At<_?Pn="miter":At<=2&&(Pn="fakeround")),"miter"===Pn&&At>m&&(Pn="bevel"),"bevel"===Pn&&(At>2&&(Pn="flipbevel"),At<m&&(Pn="miter")),K&&this.updateDistance(K,V),"miter"===Pn)wt._mult(At),this.addCurrentVertex(V,wt,0,0,z);else if("flipbevel"===Pn){if(At>100)wt=ze.mult(-1);else{const sn=At*ge.add(ze).mag()/ge.sub(ze).mag();wt._perp()._mult(sn*(en?-1:1))}this.addCurrentVertex(V,wt,0,0,z),this.addCurrentVertex(V,wt.mult(-1),0,0,z)}else if("bevel"===Pn||"fakeround"===Pn){const sn=-Math.sqrt(At*At-1),vn=en?sn:0,xn=en?0:sn;if(K&&this.addCurrentVertex(V,ge,vn,xn,z),"fakeround"===Pn){const Sn=Math.round(180*mt/Math.PI/20);for(let On=1;On<Sn;On++){let ln=On/Sn;if(.5!==ln){const vi=ln-.5;ln+=ln*vi*(ln-1)*((1.0904+it*(it*(3.55645-1.43519*it)-3.2452))*vi*vi+(.848013+it*(.215638*it-1.06021)))}const $n=ze.sub(ge)._mult(ln)._add(ge)._unit()._mult(en?-1:1);this.addHalfVertex(V,$n.x,$n.y,!1,en,0,z)}}ne&&this.addCurrentVertex(V,ze,-vn,-xn,z)}else if("butt"===Pn)this.addCurrentVertex(V,wt,0,0,z);else if("square"===Pn){const sn=K?1:-1;K||this.addCurrentVertex(V,wt,sn,sn,z),this.addCurrentVertex(V,wt,0,0,z),K&&this.addCurrentVertex(V,wt,sn,sn,z)}else"round"===Pn&&(K&&(this.addCurrentVertex(V,ge,0,0,z),this.addCurrentVertex(V,ge,1,1,z,!0)),ne&&(this.addCurrentVertex(V,ze,-1,-1,z,!0),this.addCurrentVertex(V,ze,0,0,z)));if(rn&&rt<T-1){const sn=V.dist(ne);if(sn>2*L){const vn=V.add(ne.sub(V)._mult(L/sn)._round());this.updateDistance(V,vn),this.addCurrentVertex(vn,ze,0,0,z),V=vn}}}}addCurrentVertex(e,i,a,d,m,_=!1){const w=i.y*d-i.x,T=-i.y-i.x*d;this.addHalfVertex(e,i.x+i.y*a,i.y-i.x*a,_,!1,a,m),this.addHalfVertex(e,w,T,_,!0,-d,m)}addHalfVertex({x:e,y:i},a,d,m,_,w,T){this.layoutVertexArray.emplaceBack((e<<1)+(m?1:0),(i<<1)+(_?1:0),Math.round(63*a)+128,Math.round(63*d)+128,1+(0===w?0:w<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const M=T.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,M),T.primitiveLength++),_?this.e2=M:this.e1=M}updateScaledDistance(){if(this.lineClips){const e=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=e*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(e,i){this.distance+=e.dist(i),this.updateScaledDistance()}}Jn(Zu,"LineBucket",{omit:["layers","patternFeatures"]});const lf=new Bn({"line-cap":new Nt(on.layout_line["line-cap"]),"line-join":new Nt(on.layout_line["line-join"]),"line-miter-limit":new Kt(on.layout_line["line-miter-limit"]),"line-round-limit":new Kt(on.layout_line["line-round-limit"]),"line-sort-key":new Nt(on.layout_line["line-sort-key"])});var Wm={paint:new Bn({"line-opacity":new Nt(on.paint_line["line-opacity"]),"line-color":new Nt(on.paint_line["line-color"]),"line-translate":new Kt(on.paint_line["line-translate"]),"line-translate-anchor":new Kt(on.paint_line["line-translate-anchor"]),"line-width":new Nt(on.paint_line["line-width"]),"line-gap-width":new Nt(on.paint_line["line-gap-width"]),"line-offset":new Nt(on.paint_line["line-offset"]),"line-blur":new Nt(on.paint_line["line-blur"]),"line-dasharray":new qn(on.paint_line["line-dasharray"]),"line-pattern":new qn(on.paint_line["line-pattern"]),"line-gradient":new jn(on.paint_line["line-gradient"]),"line-trim-offset":new Kt(on.paint_line["line-trim-offset"])}),layout:lf};const D_=new class extends Nt{possiblyEvaluate(n,e){return e=new ot(Math.floor(e.zoom),{now:e.now,fadeDuration:e.fadeDuration,zoomHistory:e.zoomHistory,transition:e.transition}),super.possiblyEvaluate(n,e)}evaluate(n,e,i,a){return e=Et({},e,{zoom:Math.floor(e.zoom)}),super.evaluate(n,e,i,a)}}(Wm.paint.properties["line-width"].specification);function I_(n,e){return e>0?e+2*n:n}D_.useIntegerZoom=!0;const Uy=Nn([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),M_=Nn([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),qm=Nn([{name:"a_projected_pos",components:4,type:"Float32"}],4);Nn([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const Vy=Nn([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),S_=Nn([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"}]);Nn([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const uu=Nn([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),A_=Nn([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);Nn([{name:"triangle",components:3,type:"Uint16"}]),Nn([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),Nn([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),Nn([{type:"Float32",name:"offsetX"}]),Nn([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);const Oa=128;function cf(n,e){const{expression:i}=e;if("constant"===i.kind)return{kind:"constant",layoutSize:i.evaluate(new ot(n+1))};if("source"===i.kind)return{kind:"source"};{const{zoomStops:a,interpolationType:d}=i;let m=0;for(;m<a.length&&a[m]<=n;)m++;m=Math.max(0,m-1);let _=m;for(;_<a.length&&a[_]<n+1;)_++;_=Math.min(a.length-1,_);const w=a[m],T=a[_];return"composite"===i.kind?{kind:"composite",minZoom:w,maxZoom:T,interpolationType:d}:{kind:"camera",minZoom:w,maxZoom:T,minSize:i.evaluate(new ot(w)),maxSize:i.evaluate(new ot(T)),interpolationType:d}}}function Ld(n,{uSize:e,uSizeT:i},{lowerSize:a,upperSize:d}){return"source"===n.kind?a/Oa:"composite"===n.kind?ji(a/Oa,d/Oa,i):e}function Gu(n,e){let i=0,a=0;if("constant"===n.kind)a=n.layoutSize;else if("source"!==n.kind){const{interpolationType:d,minZoom:m,maxZoom:_}=n,w=d?_e(Dn.interpolationFactor(d,e,m,_),0,1):0;"camera"===n.kind?a=ji(n.minSize,n.maxSize,w):i=w}return{uSizeT:i,uSize:a}}var P_=Object.freeze({__proto__:null,getSizeData:cf,evaluateSizeForFeature:Ld,evaluateSizeForZoom:Gu,SIZE_PACK_FACTOR:Oa});function O_(n,e,i){return n.sections.forEach(a=>{a.text=function(d,m,_){const w=m.layout.get("text-transform").evaluate(_,{});return"uppercase"===w?d=d.toLocaleUpperCase():"lowercase"===w&&(d=d.toLocaleLowerCase()),yt.applyArabicShaping&&(d=yt.applyArabicShaping(d)),d}(a.text,e,i)}),n}const Fd={"!":"\ufe15","#":"\uff03",$:"\uff04","%":"\uff05","&":"\uff06","(":"\ufe35",")":"\ufe36","*":"\uff0a","+":"\uff0b",",":"\ufe10","-":"\ufe32",".":"\u30fb","/":"\uff0f",":":"\ufe13",";":"\ufe14","<":"\ufe3f","=":"\uff1d",">":"\ufe40","?":"\ufe16","@":"\uff20","[":"\ufe47","\\":"\uff3c","]":"\ufe48","^":"\uff3e",_:"\ufe33","`":"\uff40","{":"\ufe37","|":"\u2015","}":"\ufe38","~":"\uff5e","\xa2":"\uffe0","\xa3":"\uffe1","\xa5":"\uffe5","\xa6":"\uffe4","\xac":"\uffe2","\xaf":"\uffe3","\u2013":"\ufe32","\u2014":"\ufe31","\u2018":"\ufe43","\u2019":"\ufe44","\u201c":"\ufe41","\u201d":"\ufe42","\u2026":"\ufe19","\u2027":"\u30fb","\u20a9":"\uffe6","\u3001":"\ufe11","\u3002":"\ufe12","\u3008":"\ufe3f","\u3009":"\ufe40","\u300a":"\ufe3d","\u300b":"\ufe3e","\u300c":"\ufe41","\u300d":"\ufe42","\u300e":"\ufe43","\u300f":"\ufe44","\u3010":"\ufe3b","\u3011":"\ufe3c","\u3014":"\ufe39","\u3015":"\ufe3a","\u3016":"\ufe17","\u3017":"\ufe18","\uff01":"\ufe15","\uff08":"\ufe35","\uff09":"\ufe36","\uff0c":"\ufe10","\uff0d":"\ufe32","\uff0e":"\u30fb","\uff1a":"\ufe13","\uff1b":"\ufe14","\uff1c":"\ufe3f","\uff1e":"\ufe40","\uff1f":"\ufe16","\uff3b":"\ufe47","\uff3d":"\ufe48","\uff3f":"\ufe33","\uff5b":"\ufe37","\uff5c":"\u2015","\uff5d":"\ufe38","\uff5f":"\ufe35","\uff60":"\ufe36","\uff61":"\ufe12","\uff62":"\ufe41","\uff63":"\ufe42"};function R_(n){return"\ufe36"===n||"\ufe48"===n||"\ufe38"===n||"\ufe44"===n||"\ufe42"===n||"\ufe3e"===n||"\ufe3c"===n||"\ufe3a"===n||"\ufe18"===n||"\ufe40"===n||"\ufe10"===n||"\ufe13"===n||"\ufe14"===n||"\uff40"===n||"\uffe3"===n||"\ufe11"===n||"\ufe12"===n}function Ym(n){return"\ufe35"===n||"\ufe47"===n||"\ufe37"===n||"\ufe43"===n||"\ufe41"===n||"\ufe3d"===n||"\ufe3b"===n||"\ufe39"===n||"\ufe17"===n||"\ufe3f"===n}var kd=Fr,uf=function(n,e,i,a,d){var m,_,w=8*d-a-1,T=(1<<w)-1,M=T>>1,L=-7,z=i?d-1:0,V=i?-1:1,K=n[e+z];for(z+=V,m=K&(1<<-L)-1,K>>=-L,L+=w;L>0;m=256*m+n[e+z],z+=V,L-=8);for(_=m&(1<<-L)-1,m>>=-L,L+=a;L>0;_=256*_+n[e+z],z+=V,L-=8);if(0===m)m=1-M;else{if(m===T)return _?NaN:1/0*(K?-1:1);_+=Math.pow(2,a),m-=M}return(K?-1:1)*_*Math.pow(2,m-a)},df=function(n,e,i,a,d,m){var _,w,T,M=8*m-d-1,L=(1<<M)-1,z=L>>1,V=23===d?Math.pow(2,-24)-Math.pow(2,-77):0,K=a?0:m-1,ne=a?1:-1,ge=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(w=isNaN(e)?1:0,_=L):(_=Math.floor(Math.log(e)/Math.LN2),e*(T=Math.pow(2,-_))<1&&(_--,T*=2),(e+=_+z>=1?V/T:V*Math.pow(2,1-z))*T>=2&&(_++,T/=2),_+z>=L?(w=0,_=L):_+z>=1?(w=(e*T-1)*Math.pow(2,d),_+=z):(w=e*Math.pow(2,z-1)*Math.pow(2,d),_=0));d>=8;n[i+K]=255&w,K+=ne,w/=256,d-=8);for(_=_<<d|w,M+=d;M>0;n[i+K]=255&_,K+=ne,_/=256,M-=8);n[i+K-ne]|=128*ge};function Fr(n){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(n)?n:new Uint8Array(n||0),this.pos=0,this.type=0,this.length=this.buf.length}Fr.Varint=0,Fr.Fixed64=1,Fr.Bytes=2,Fr.Fixed32=5;var Jm=4294967296,Bh=1/Jm,Xm=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function $c(n){return n.type===Fr.Bytes?n.readVarint()+n.pos:n.pos+1}function hf(n,e,i){var a=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));i.realloc(a);for(var d=i.pos-1;d>=n;d--)i.buf[d+a]=i.buf[d]}function L_(n,e){for(var i=0;i<n.length;i++)e.writeVarint(n[i])}function Km(n,e){for(var i=0;i<n.length;i++)e.writeSVarint(n[i])}function F_(n,e){for(var i=0;i<n.length;i++)e.writeFloat(n[i])}function k_(n,e){for(var i=0;i<n.length;i++)e.writeDouble(n[i])}function zh(n,e){for(var i=0;i<n.length;i++)e.writeBoolean(n[i])}function Hu(n,e){for(var i=0;i<n.length;i++)e.writeFixed32(n[i])}function pf(n,e){for(var i=0;i<n.length;i++)e.writeSFixed32(n[i])}function Bd(n,e){for(var i=0;i<n.length;i++)e.writeFixed64(n[i])}function ff(n,e){for(var i=0;i<n.length;i++)e.writeSFixed64(n[i])}function du(n,e){return(n[e]|n[e+1]<<8|n[e+2]<<16)+16777216*n[e+3]}function hu(n,e,i){n[i]=e,n[i+1]=e>>>8,n[i+2]=e>>>16,n[i+3]=e>>>24}function Nh(n,e){return(n[e]|n[e+1]<<8|n[e+2]<<16)+(n[e+3]<<24)}function mf(n,e,i){e.glyphs=[],1===n&&i.readMessage(gf,e)}function gf(n,e,i){if(3===n){const{id:a,bitmap:d,width:m,height:_,left:w,top:T,advance:M}=i.readMessage(Qm,{});e.glyphs.push({id:a,bitmap:new gl({width:m+6,height:_+6},d),metrics:{width:m,height:_,left:w,top:T,advance:M}})}else 4===n?e.ascender=i.readSVarint():5===n&&(e.descender=i.readSVarint())}function Qm(n,e,i){1===n?e.id=i.readVarint():2===n?e.bitmap=i.readBytes():3===n?e.width=i.readVarint():4===n?e.height=i.readVarint():5===n?e.left=i.readSVarint():6===n?e.top=i.readSVarint():7===n&&(e.advance=i.readVarint())}function zd(n){let e=0,i=0;for(const _ of n)e+=_.w*_.h,i=Math.max(i,_.w);n.sort((_,w)=>w.h-_.h);const a=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),i),h:1/0}];let d=0,m=0;for(const _ of n)for(let w=a.length-1;w>=0;w--){const T=a[w];if(!(_.w>T.w||_.h>T.h)){if(_.x=T.x,_.y=T.y,m=Math.max(m,_.y+_.h),d=Math.max(d,_.x+_.w),_.w===T.w&&_.h===T.h){const M=a.pop();w<a.length&&(a[w]=M)}else _.h===T.h?(T.x+=_.w,T.w-=_.w):_.w===T.w?(T.y+=_.h,T.h-=_.h):(a.push({x:T.x+_.w,y:T.y,w:T.w-_.w,h:_.h}),T.y+=_.h,T.h-=_.h);break}}return{w:d,h:m,fill:e/(d*m)||0}}Fr.prototype={destroy:function(){this.buf=null},readFields:function(n,e,i){for(i=i||this.length;this.pos<i;){var a=this.readVarint(),d=a>>3,m=this.pos;this.type=7&a,n(d,e,this),this.pos===m&&this.skip(a)}return e},readMessage:function(n,e){return this.readFields(n,e,this.readVarint()+this.pos)},readFixed32:function(){var n=du(this.buf,this.pos);return this.pos+=4,n},readSFixed32:function(){var n=Nh(this.buf,this.pos);return this.pos+=4,n},readFixed64:function(){var n=du(this.buf,this.pos)+du(this.buf,this.pos+4)*Jm;return this.pos+=8,n},readSFixed64:function(){var n=du(this.buf,this.pos)+Nh(this.buf,this.pos+4)*Jm;return this.pos+=8,n},readFloat:function(){var n=uf(this.buf,this.pos,!0,23,4);return this.pos+=4,n},readDouble:function(){var n=uf(this.buf,this.pos,!0,52,8);return this.pos+=8,n},readVarint:function(n){var e,i,a=this.buf;return e=127&(i=a[this.pos++]),i<128?e:(e|=(127&(i=a[this.pos++]))<<7,i<128?e:(e|=(127&(i=a[this.pos++]))<<14,i<128?e:(e|=(127&(i=a[this.pos++]))<<21,i<128?e:function(d,m,_){var w,T,M=_.buf;if(w=(112&(T=M[_.pos++]))>>4,T<128||(w|=(127&(T=M[_.pos++]))<<3,T<128)||(w|=(127&(T=M[_.pos++]))<<10,T<128)||(w|=(127&(T=M[_.pos++]))<<17,T<128)||(w|=(127&(T=M[_.pos++]))<<24,T<128)||(w|=(1&(T=M[_.pos++]))<<31,T<128))return function yl(n,e,i){return i?4294967296*e+(n>>>0):4294967296*(e>>>0)+(n>>>0)}(d,w,m);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(i=a[this.pos]))<<28,n,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var n=this.readVarint();return n%2==1?(n+1)/-2:n/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var n=this.readVarint()+this.pos,e=this.pos;return this.pos=n,n-e>=12&&Xm?Xm.decode(this.buf.subarray(e,n)):function(i,a,d){for(var m="",_=a;_<d;){var w,T,M,L=i[_],z=null,V=L>239?4:L>223?3:L>191?2:1;if(_+V>d)break;1===V?L<128&&(z=L):2===V?128==(192&(w=i[_+1]))&&(z=(31&L)<<6|63&w)<=127&&(z=null):3===V?(T=i[_+2],128==(192&(w=i[_+1]))&&128==(192&T)&&((z=(15&L)<<12|(63&w)<<6|63&T)<=2047||z>=55296&&z<=57343)&&(z=null)):4===V&&(T=i[_+2],M=i[_+3],128==(192&(w=i[_+1]))&&128==(192&T)&&128==(192&M)&&((z=(15&L)<<18|(63&w)<<12|(63&T)<<6|63&M)<=65535||z>=1114112)&&(z=null)),null===z?(z=65533,V=1):z>65535&&(z-=65536,m+=String.fromCharCode(z>>>10&1023|55296),z=56320|1023&z),m+=String.fromCharCode(z),_+=V}return m}(this.buf,e,n)},readBytes:function(){var n=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,n);return this.pos=n,e},readPackedVarint:function(n,e){if(this.type!==Fr.Bytes)return n.push(this.readVarint(e));var i=$c(this);for(n=n||[];this.pos<i;)n.push(this.readVarint(e));return n},readPackedSVarint:function(n){if(this.type!==Fr.Bytes)return n.push(this.readSVarint());var e=$c(this);for(n=n||[];this.pos<e;)n.push(this.readSVarint());return n},readPackedBoolean:function(n){if(this.type!==Fr.Bytes)return n.push(this.readBoolean());var e=$c(this);for(n=n||[];this.pos<e;)n.push(this.readBoolean());return n},readPackedFloat:function(n){if(this.type!==Fr.Bytes)return n.push(this.readFloat());var e=$c(this);for(n=n||[];this.pos<e;)n.push(this.readFloat());return n},readPackedDouble:function(n){if(this.type!==Fr.Bytes)return n.push(this.readDouble());var e=$c(this);for(n=n||[];this.pos<e;)n.push(this.readDouble());return n},readPackedFixed32:function(n){if(this.type!==Fr.Bytes)return n.push(this.readFixed32());var e=$c(this);for(n=n||[];this.pos<e;)n.push(this.readFixed32());return n},readPackedSFixed32:function(n){if(this.type!==Fr.Bytes)return n.push(this.readSFixed32());var e=$c(this);for(n=n||[];this.pos<e;)n.push(this.readSFixed32());return n},readPackedFixed64:function(n){if(this.type!==Fr.Bytes)return n.push(this.readFixed64());var e=$c(this);for(n=n||[];this.pos<e;)n.push(this.readFixed64());return n},readPackedSFixed64:function(n){if(this.type!==Fr.Bytes)return n.push(this.readSFixed64());var e=$c(this);for(n=n||[];this.pos<e;)n.push(this.readSFixed64());return n},skip:function(n){var e=7&n;if(e===Fr.Varint)for(;this.buf[this.pos++]>127;);else if(e===Fr.Bytes)this.pos=this.readVarint()+this.pos;else if(e===Fr.Fixed32)this.pos+=4;else{if(e!==Fr.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(n,e){this.writeVarint(n<<3|e)},realloc:function(n){for(var e=this.length||16;e<this.pos+n;)e*=2;if(e!==this.length){var i=new Uint8Array(e);i.set(this.buf),this.buf=i,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(n){this.realloc(4),hu(this.buf,n,this.pos),this.pos+=4},writeSFixed32:function(n){this.realloc(4),hu(this.buf,n,this.pos),this.pos+=4},writeFixed64:function(n){this.realloc(8),hu(this.buf,-1&n,this.pos),hu(this.buf,Math.floor(n*Bh),this.pos+4),this.pos+=8},writeSFixed64:function(n){this.realloc(8),hu(this.buf,-1&n,this.pos),hu(this.buf,Math.floor(n*Bh),this.pos+4),this.pos+=8},writeVarint:function(n){(n=+n||0)>268435455||n<0?function(e,i){var a,d,m,w;if(e>=0?(a=e%4294967296|0,d=e/4294967296|0):(d=~(-e/4294967296),4294967295^(a=~(-e%4294967296))?a=a+1|0:(a=0,d=d+1|0)),e>=0x10000000000000000||e<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");i.realloc(10),m=a,(w=i).buf[w.pos++]=127&m|128,m>>>=7,w.buf[w.pos++]=127&m|128,m>>>=7,w.buf[w.pos++]=127&m|128,m>>>=7,w.buf[w.pos++]=127&m|128,w.buf[w.pos]=127&(m>>>=7),function(m,_){var w=(7&m)<<4;_.buf[_.pos++]|=w|((m>>>=3)?128:0),m&&(_.buf[_.pos++]=127&m|((m>>>=7)?128:0),m&&(_.buf[_.pos++]=127&m|((m>>>=7)?128:0),m&&(_.buf[_.pos++]=127&m|((m>>>=7)?128:0),m&&(_.buf[_.pos++]=127&m|((m>>>=7)?128:0),m&&(_.buf[_.pos++]=127&m)))))}(d,i)}(n,this):(this.realloc(4),this.buf[this.pos++]=127&n|(n>127?128:0),n<=127||(this.buf[this.pos++]=127&(n>>>=7)|(n>127?128:0),n<=127||(this.buf[this.pos++]=127&(n>>>=7)|(n>127?128:0),n<=127||(this.buf[this.pos++]=n>>>7&127))))},writeSVarint:function(n){this.writeVarint(n<0?2*-n-1:2*n)},writeBoolean:function(n){this.writeVarint(Boolean(n))},writeString:function(n){n=String(n),this.realloc(4*n.length),this.pos++;var e=this.pos;this.pos=function(a,d,m){for(var _,w,T=0;T<d.length;T++){if((_=d.charCodeAt(T))>55295&&_<57344){if(!w){_>56319||T+1===d.length?(a[m++]=239,a[m++]=191,a[m++]=189):w=_;continue}if(_<56320){a[m++]=239,a[m++]=191,a[m++]=189,w=_;continue}_=w-55296<<10|_-56320|65536,w=null}else w&&(a[m++]=239,a[m++]=191,a[m++]=189,w=null);_<128?a[m++]=_:(_<2048?a[m++]=_>>6|192:(_<65536?a[m++]=_>>12|224:(a[m++]=_>>18|240,a[m++]=_>>12&63|128),a[m++]=_>>6&63|128),a[m++]=63&_|128)}return m}(this.buf,n,this.pos);var i=this.pos-e;i>=128&&hf(e,i,this),this.pos=e-1,this.writeVarint(i),this.pos+=i},writeFloat:function(n){this.realloc(4),df(this.buf,n,this.pos,!0,23,4),this.pos+=4},writeDouble:function(n){this.realloc(8),df(this.buf,n,this.pos,!0,52,8),this.pos+=8},writeBytes:function(n){var e=n.length;this.writeVarint(e),this.realloc(e);for(var i=0;i<e;i++)this.buf[this.pos++]=n[i]},writeRawMessage:function(n,e){this.pos++;var i=this.pos;n(e,this);var a=this.pos-i;a>=128&&hf(i,a,this),this.pos=i-1,this.writeVarint(a),this.pos+=a},writeMessage:function(n,e,i){this.writeTag(n,Fr.Bytes),this.writeRawMessage(e,i)},writePackedVarint:function(n,e){e.length&&this.writeMessage(n,L_,e)},writePackedSVarint:function(n,e){e.length&&this.writeMessage(n,Km,e)},writePackedBoolean:function(n,e){e.length&&this.writeMessage(n,zh,e)},writePackedFloat:function(n,e){e.length&&this.writeMessage(n,F_,e)},writePackedDouble:function(n,e){e.length&&this.writeMessage(n,k_,e)},writePackedFixed32:function(n,e){e.length&&this.writeMessage(n,Hu,e)},writePackedSFixed32:function(n,e){e.length&&this.writeMessage(n,pf,e)},writePackedFixed64:function(n,e){e.length&&this.writeMessage(n,Bd,e)},writePackedSFixed64:function(n,e){e.length&&this.writeMessage(n,ff,e)},writeBytesField:function(n,e){this.writeTag(n,Fr.Bytes),this.writeBytes(e)},writeFixed32Field:function(n,e){this.writeTag(n,Fr.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(n,e){this.writeTag(n,Fr.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(n,e){this.writeTag(n,Fr.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(n,e){this.writeTag(n,Fr.Fixed64),this.writeSFixed64(e)},writeVarintField:function(n,e){this.writeTag(n,Fr.Varint),this.writeVarint(e)},writeSVarintField:function(n,e){this.writeTag(n,Fr.Varint),this.writeSVarint(e)},writeStringField:function(n,e){this.writeTag(n,Fr.Bytes),this.writeString(e)},writeFloatField:function(n,e){this.writeTag(n,Fr.Fixed32),this.writeFloat(e)},writeDoubleField:function(n,e){this.writeTag(n,Fr.Fixed64),this.writeDouble(e)},writeBooleanField:function(n,e){this.writeVarintField(n,Boolean(e))}};class _f{constructor(e,{pixelRatio:i,version:a,stretchX:d,stretchY:m,content:_}){this.paddedRect=e,this.pixelRatio=i,this.stretchX=d,this.stretchY=m,this.content=_,this.version=a}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class eg{constructor(e,i){const a={},d={};this.haveRenderCallbacks=[];const m=[];this.addImages(e,a,m),this.addImages(i,d,m);const{w:_,h:w}=zd(m),T=new Pa({width:_||1,height:w||1});for(const M in e){const L=e[M],z=a[M].paddedRect;Pa.copy(L.data,T,{x:0,y:0},{x:z.x+1,y:z.y+1},L.data)}for(const M in i){const L=i[M],z=d[M].paddedRect,V=z.x+1,K=z.y+1,ne=L.data.width,ge=L.data.height;Pa.copy(L.data,T,{x:0,y:0},{x:V,y:K},L.data),Pa.copy(L.data,T,{x:0,y:ge-1},{x:V,y:K-1},{width:ne,height:1}),Pa.copy(L.data,T,{x:0,y:0},{x:V,y:K+ge},{width:ne,height:1}),Pa.copy(L.data,T,{x:ne-1,y:0},{x:V-1,y:K},{width:1,height:ge}),Pa.copy(L.data,T,{x:0,y:0},{x:V+ne,y:K},{width:1,height:ge})}this.image=T,this.iconPositions=a,this.patternPositions=d}addImages(e,i,a){for(const d in e){const m=e[d],_={x:0,y:0,w:m.data.width+2,h:m.data.height+2};a.push(_),i[d]=new _f(_,m),m.hasRenderCallback&&this.haveRenderCallbacks.push(d)}}patchUpdatedImages(e,i){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(a=>e.hasImage(a)),e.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const a in e.updatedImages)this.patchUpdatedImage(this.iconPositions[a],e.getImage(a),i),this.patchUpdatedImage(this.patternPositions[a],e.getImage(a),i)}patchUpdatedImage(e,i,a){if(!e||!i||e.version===i.version)return;e.version=i.version;const[d,m]=e.tl;a.update(i.data,void 0,{x:d,y:m})}}Jn(_f,"ImagePosition"),Jn(eg,"ImageAtlas");const ga={horizontal:1,vertical:2,horizontalOnly:3};class Nd{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(e,i){const a=new Nd;return a.scale=e||1,a.fontStack=i,a}static forImage(e){const i=new Nd;return i.imageName=e,i}}class pu{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(e,i){const a=new pu;for(let d=0;d<e.sections.length;d++){const m=e.sections[d];m.image?a.addImageSection(m):a.addTextSection(m,i)}return a}length(){return this.text.length}getSection(e){return this.sections[this.sectionIndex[e]]}getSections(){return this.sections}getSectionIndex(e){return this.sectionIndex[e]}getCharCode(e){return this.text.charCodeAt(e)}verticalizePunctuation(e){this.text=function(i,a){let d="";for(let m=0;m<i.length;m++){const _=i.charCodeAt(m+1)||null,w=i.charCodeAt(m-1)||null;d+=!a&&(_&&D(_)&&!Fd[i[m+1]]||w&&D(w)&&!Fd[i[m-1]])||!Fd[i[m]]?i[m]:Fd[i[m]]}return d}(this.text,e)}trim(){let e=0;for(let a=0;a<this.text.length&&Vh[this.text.charCodeAt(a)];a++)e++;let i=this.text.length;for(let a=this.text.length-1;a>=0&&a>=e&&Vh[this.text.charCodeAt(a)];a--)i--;this.text=this.text.substring(e,i),this.sectionIndex=this.sectionIndex.slice(e,i)}substring(e,i){const a=new pu;return a.text=this.text.substring(e,i),a.sectionIndex=this.sectionIndex.slice(e,i),a.sections=this.sections,a}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((e,i)=>Math.max(e,this.sections[i].scale),0)}addTextSection(e,i){this.text+=e.text,this.sections.push(Nd.forText(e.scale,e.fontStack||i));const a=this.sections.length-1;for(let d=0;d<e.text.length;++d)this.sectionIndex.push(a)}addImageSection(e){const i=e.image?e.image.name:"";if(0===i.length)return void wn("Can't add FormattedSection with an empty image.");const a=this.getNextImageSectionCharCode();a?(this.text+=String.fromCharCode(a),this.sections.push(Nd.forImage(i)),this.sectionIndex.push(this.sections.length-1)):wn("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Uh(n,e,i,a,d,m,_,w,T,M,L,z,V,K,ne){const ge=pu.fromFeature(n,d);z===ga.vertical&&ge.verticalizePunctuation(V);let ze=[];const rt=function(mt,rn,en,mn,Pn,sn){if(!mt)return[];const vn=[],xn=function($n,vi,Xn,oi,Hn,Ti){let Li=0;for(let zi=0;zi<$n.length();zi++){const hr=$n.getSection(zi);Li+=_a($n.getCharCode(zi),hr,oi,Hn,vi,Ti)}return Li/Math.max(1,Math.ceil(Li/Xn))}(mt,rn,en,mn,Pn,sn),Sn=mt.text.indexOf("\u200b")>=0;let On=0;for(let $n=0;$n<mt.length();$n++){const vi=mt.getSection($n),Xn=mt.getCharCode($n);if(Vh[Xn]||(On+=_a(Xn,vi,mn,Pn,rn,sn)),$n<mt.length()-1){const oi=!((ln=Xn)<11904||!(Rc(ln)||Du(ln)||F(ln)||tu(ln)||wo(ln)||Ur(ln)||Ll(ln)||Oc(ln)||Lc(ln)||ll(ln)||Iu(ln)||t(ln)||Eu(ln)||eu(ln)||dd(ln)||hd(ln)||Ha(ln)||P(ln)||Ps(ln)||Fc(ln)));(B_[Xn]||oi||vi.imageName)&&vn.push(N_($n+1,On,xn,vn,z_(Xn,mt.getCharCode($n+1),oi&&Sn),!1))}}var ln;return jh(N_(mt.length(),On,xn,vn,0,!0))}(ge,M,m,e,a,K),{processBidirectionalText:wt,processStyledBidirectionalText:it}=yt;if(wt&&1===ge.sections.length){const mt=wt(ge.toString(),rt);for(const rn of mt){const en=new pu;en.text=rn,en.sections=ge.sections;for(let mn=0;mn<rn.length;mn++)en.sectionIndex.push(0);ze.push(en)}}else if(it){const mt=it(ge.text,ge.sectionIndex,rt);for(const rn of mt){const en=new pu;en.text=rn[0],en.sectionIndex=rn[1],en.sections=ge.sections,ze.push(en)}}else ze=function(mt,rn){const en=[],mn=mt.text;let Pn=0;for(const sn of rn)en.push(mt.substring(Pn,sn)),Pn=sn;return Pn<mn.length&&en.push(mt.substring(Pn,mn.length)),en}(ge,rt);const ft=[],At={positionedLines:ft,text:ge.toString(),top:L[1],bottom:L[1],left:L[0],right:L[0],writingMode:z,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(mt,rn,en,mn,Pn,sn,vn,xn,Sn,On,ln,$n){let vi=0,Xn=0,oi=0;const Hn="right"===xn?1:"left"===xn?0:.5;let Ti=!1;for(const Zi of Pn){const Qi=Zi.getSections();for(const kr of Qi){if(kr.imageName)continue;const Gr=rn[kr.fontStack];if(Gr&&(Ti=void 0!==Gr.ascender&&void 0!==Gr.descender,!Ti))break}if(!Ti)break}let Li=0;for(const Zi of Pn){Zi.trim();const Qi=Zi.getMaxScale(),kr=24*(Qi-1),Gr={positionedGlyphs:[],lineOffset:0};mt.positionedLines[Li]=Gr;const $r=Gr.positionedGlyphs;let Hr=0;if(!Zi.length()){Xn+=sn,++Li;continue}let Kr=0,yo=0;for(let Pr=0;Pr<Zi.length();Pr++){const ko=Zi.getSection(Pr),Do=Zi.getSectionIndex(Pr),yr=Zi.getCharCode(Pr);let oo=ko.scale,Go=null,Or=null,vo=null,vs=24,Xo=0;const Ko=!(Sn===ga.horizontal||!ln&&!b(yr)||ln&&(Vh[yr]||(zi=yr,Ga(zi)||Rl(zi)||Tu(zi)||sc(zi)||l(zi))));if(ko.imageName){const ks=mn[ko.imageName];if(!ks)continue;vo=ko.imageName,mt.iconsInText=mt.iconsInText||!0,Or=ks.paddedRect;const Qo=ks.displaySize;oo=24*oo/$n,Go={width:Qo[0],height:Qo[1],left:1,top:-3,advance:Ko?Qo[1]:Qo[0],localGlyph:!1},Xo=Ti?-Go.height*oo:24*Qi-17-Qo[1]*oo,vs=Go.advance;const Zl=(Ko?Qo[0]:Qo[1])*oo-24*Qi;Zl>0&&Zl>Hr&&(Hr=Zl)}else{const ks=en[ko.fontStack];if(!ks)continue;ks[yr]&&(Or=ks[yr]);const Qo=rn[ko.fontStack];if(!Qo)continue;const Zl=Qo.glyphs[yr];if(!Zl)continue;if(Go=Zl.metrics,vs=8203!==yr?24:0,Ti){const bu=void 0!==Qo.ascender?Math.abs(Qo.ascender):0,sd=void 0!==Qo.descender?Math.abs(Qo.descender):0,ad=(bu+sd)*oo;Kr<ad&&(Kr=ad,yo=(bu-sd)/2*oo),Xo=-bu*oo}else Xo=24*(Qi-oo)-17}Ko?(mt.verticalizable=!0,$r.push({glyph:yr,imageName:vo,x:vi,y:Xn+Xo,vertical:Ko,scale:oo,localGlyph:Go.localGlyph,fontStack:ko.fontStack,sectionIndex:Do,metrics:Go,rect:Or}),vi+=vs*oo+On):($r.push({glyph:yr,imageName:vo,x:vi,y:Xn+Xo,vertical:Ko,scale:oo,localGlyph:Go.localGlyph,fontStack:ko.fontStack,sectionIndex:Do,metrics:Go,rect:Or}),vi+=Go.advance*oo+On)}0!==$r.length&&(oi=Math.max(vi-On,oi),Ti?tg($r,Hn,Hr,yo,sn*Qi/2):tg($r,Hn,Hr,0,sn/2)),vi=0;const as=sn*Qi+Hr;Gr.lineOffset=Math.max(Hr,kr),Xn+=as,++Li}var zi;const hr=Xn,{horizontalAlign:Fi,verticalAlign:Xr}=$h(vn);(function(Zi,Qi,kr,Gr,$r,Hr){const Kr=(Qi-kr)*$r,yo=-Hr*Gr;for(const as of Zi)for(const Pr of as.positionedGlyphs)Pr.x+=Kr,Pr.y+=yo})(mt.positionedLines,Hn,Fi,Xr,oi,hr),mt.top+=-Xr*hr,mt.bottom=mt.top+hr,mt.left+=-Fi*oi,mt.right=mt.left+oi,mt.hasBaseline=Ti}(At,e,i,a,ze,_,w,T,z,M,V,ne),!function(mt){for(const rn of mt)if(0!==rn.positionedGlyphs.length)return!1;return!0}(ft)&&At}const Vh={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},B_={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function _a(n,e,i,a,d,m){if(e.imageName){const _=a[e.imageName];return _?_.displaySize[0]*e.scale*24/m+d:0}{const _=i[e.fontStack],w=_&&_.glyphs[n];return w?w.metrics.advance*e.scale+d:0}}function yf(n,e,i,a){const d=Math.pow(n-e,2);return a?n<e?d/2:2*d:d+Math.abs(i)*i}function z_(n,e,i){let a=0;return 10===n&&(a-=1e4),i&&(a+=150),40!==n&&65288!==n||(a+=50),41!==e&&65289!==e||(a+=50),a}function N_(n,e,i,a,d,m){let _=null,w=yf(e,i,d,m);for(const T of a){const M=yf(e-T.x,i,d,m)+T.badness;M<=w&&(_=T,w=M)}return{index:n,x:e,priorBreak:_,badness:w}}function jh(n){return n?jh(n.priorBreak).concat(n.index):[]}function $h(n){let e=.5,i=.5;switch(n){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0}switch(n){case"bottom":case"bottom-right":case"bottom-left":i=1;break;case"top":case"top-right":case"top-left":i=0}return{horizontalAlign:e,verticalAlign:i}}function tg(n,e,i,a,d){if(!(e||i||a||d))return;const m=n.length-1,_=n[m],w=(_.x+_.metrics.advance*_.scale)*e;for(let T=0;T<=m;T++)n[T].x-=w,n[T].y+=i+a+d}function U_(n,e,i){const{horizontalAlign:a,verticalAlign:d}=$h(i),m=e[0]-n.displaySize[0]*a,_=e[1]-n.displaySize[1]*d;return{image:n,top:_,bottom:_+n.displaySize[1],left:m,right:m+n.displaySize[0]}}function ng(n,e,i,a,d,m){const _=n.image;let w;if(_.content){const ze=_.content,rt=_.pixelRatio||1;w=[ze[0]/rt,ze[1]/rt,_.displaySize[0]-ze[2]/rt,_.displaySize[1]-ze[3]/rt]}const T=e.left*m,M=e.right*m;let L,z,V,K;"width"===i||"both"===i?(K=d[0]+T-a[3],z=d[0]+M+a[1]):(K=d[0]+(T+M-_.displaySize[0])/2,z=K+_.displaySize[0]);const ne=e.top*m,ge=e.bottom*m;return"height"===i||"both"===i?(L=d[1]+ne-a[0],V=d[1]+ge+a[2]):(L=d[1]+(ne+ge-_.displaySize[1])/2,V=L+_.displaySize[1]),{image:_,top:L,right:z,bottom:V,left:K,collisionPadding:w}}class Vl extends te{constructor(e,i,a,d,m){super(e,i),this.angle=d,this.z=a,void 0!==m&&(this.segment=m)}clone(){return new Vl(this.x,this.y,this.z,this.angle,this.segment)}}function ig(n,e,i,a,d){if(void 0===e.segment)return!0;let m=e,_=e.segment+1,w=0;for(;w>-i/2;){if(_--,_<0)return!1;w-=n[_].dist(m),m=n[_]}w+=n[_].dist(n[_+1]),_++;const T=[];let M=0;for(;w<i/2;){const L=n[_],z=n[_+1];if(!z)return!1;let V=n[_-1].angleTo(L)-L.angleTo(z);for(V=Math.abs((V+3*Math.PI)%(2*Math.PI)-Math.PI),T.push({distance:w,angleDelta:V}),M+=V;w-T[0].distance>a;)M-=T.shift().angleDelta;if(M>d)return!1;_++,w+=L.dist(z)}return!0}function rg(n){let e=0;for(let i=0;i<n.length-1;i++)e+=n[i].dist(n[i+1]);return e}function Zh(n,e,i){return n?.6*e*i:0}function og(n,e){return Math.max(n?n.right-n.left:0,e?e.right-e.left:0)}function V_(n,e,i,a,d,m){const _=Zh(i,d,m),w=og(i,a)*m;let T=0;const M=rg(n)/2;for(let L=0;L<n.length-1;L++){const z=n[L],V=n[L+1],K=z.dist(V);if(T+K>M){const ne=(M-T)/K,ge=ji(z.x,V.x,ne),ze=ji(z.y,V.y,ne),rt=new Vl(ge,ze,0,V.angleTo(z),L);return!_||ig(n,rt,w,_,e)?rt:void 0}T+=K}}function j_(n,e,i,a,d,m,_,w,T){const M=Zh(a,m,_),L=og(a,d),z=L*_,V=0===n[0].x||n[0].x===T||0===n[0].y||n[0].y===T;return e-z<e/4&&(e=z+e/4),sg(n,V?e/2*w%e:(L/2+2*m)*_*w%e,e,M,i,z,V,!1,T)}function sg(n,e,i,a,d,m,_,w,T){const M=m/2,L=rg(n);let z=0,V=e-i,K=[];for(let ne=0;ne<n.length-1;ne++){const ge=n[ne],ze=n[ne+1],rt=ge.dist(ze),wt=ze.angleTo(ge);for(;V+i<z+rt;){V+=i;const it=(V-z)/rt,ft=ji(ge.x,ze.x,it),At=ji(ge.y,ze.y,it);if(ft>=0&&ft<T&&At>=0&&At<T&&V-M>=0&&V+M<=L){const mt=new Vl(ft,At,0,wt,ne);mt._round(),a&&!ig(n,mt,m,a,d)||K.push(mt)}}z+=rt}return w||K.length||_||(K=sg(n,z/2,i,a,d,m,_,!0,T)),K}function ag(n,e,i,a,d){const m=[];for(let _=0;_<n.length;_++){const w=n[_];let T;for(let M=0;M<w.length-1;M++){let L=w[M],z=w[M+1];L.x<e&&z.x<e||(L.x<e?L=new te(e,L.y+(e-L.x)/(z.x-L.x)*(z.y-L.y))._round():z.x<e&&(z=new te(e,L.y+(e-L.x)/(z.x-L.x)*(z.y-L.y))._round()),L.y<i&&z.y<i||(L.y<i?L=new te(L.x+(i-L.y)/(z.y-L.y)*(z.x-L.x),i)._round():z.y<i&&(z=new te(L.x+(i-L.y)/(z.y-L.y)*(z.x-L.x),i)._round()),L.x>=a&&z.x>=a||(L.x>=a?L=new te(a,L.y+(a-L.x)/(z.x-L.x)*(z.y-L.y))._round():z.x>=a&&(z=new te(a,L.y+(a-L.x)/(z.x-L.x)*(z.y-L.y))._round()),L.y>=d&&z.y>=d||(L.y>=d?L=new te(L.x+(d-L.y)/(z.y-L.y)*(z.x-L.x),d)._round():z.y>=d&&(z=new te(L.x+(d-L.y)/(z.y-L.y)*(z.x-L.x),d)._round()),T&&L.equals(T[T.length-1])||(T=[L],m.push(T)),T.push(z)))))}}return m}Jn(Vl,"Anchor");const ya=1e20;function Gh(n,e,i,a,d,m,_,w,T){for(let M=e;M<e+a;M++)lg(n,i*m+M,m,d,_,w,T);for(let M=i;M<i+d;M++)lg(n,M*m+e,1,a,_,w,T)}function lg(n,e,i,a,d,m,_){m[0]=0,_[0]=-ya,_[1]=ya,d[0]=n[e];for(let w=1,T=0,M=0;w<a;w++){d[w]=n[e+w*i];const L=w*w;do{const z=m[T];M=(d[w]-d[z]+L-z*z)/(w-z)/2}while(M<=_[T]&&--T>-1);T++,m[T]=w,_[T]=M,_[T+1]=ya}for(let w=0,T=0;w<a;w++){for(;_[T+1]<w;)T++;const M=m[T],L=w-M;n[e+w*i]=d[M]+L*L}}const vf={none:0,ideographs:1,all:2};class fu{constructor(e,i,a){this.requestManager=e,this.localGlyphMode=i,this.localFontFamily=a,this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(e){this.url=e}getGlyphs(e,i){const a=[];for(const d in e)for(const m of e[d])a.push({stack:d,id:m});Ee(a,({stack:d,id:m},_)=>{let w=this.entries[d];w||(w=this.entries[d]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let T=w.glyphs[m];if(void 0!==T)return void _(null,{stack:d,id:m,glyph:T});if(T=this._tinySDF(w,d,m),T)return w.glyphs[m]=T,void _(null,{stack:d,id:m,glyph:T});const M=Math.floor(m/256);if(256*M>65535)return void _(new Error("glyphs > 65535 not supported"));if(w.ranges[M])return void _(null,{stack:d,id:m,glyph:T});let L=w.requests[M];L||(L=w.requests[M]=[],fu.loadGlyphRange(d,M,this.url,this.requestManager,(z,V)=>{if(V){w.ascender=V.ascender,w.descender=V.descender;for(const K in V.glyphs)this._doesCharSupportLocalGlyph(+K)||(w.glyphs[+K]=V.glyphs[+K]);w.ranges[M]=!0}for(const K of L)K(z,V);delete w.requests[M]})),L.push((z,V)=>{z?_(z):V&&_(null,{stack:d,id:m,glyph:V.glyphs[m]||null})})},(d,m)=>{if(d)i(d);else if(m){const _={};for(const{stack:w,id:T,glyph:M}of m)void 0===_[w]&&(_[w]={}),void 0===_[w].glyphs&&(_[w].glyphs={}),_[w].glyphs[T]=M&&{id:M.id,bitmap:M.bitmap.clone(),metrics:M.metrics},_[w].ascender=this.entries[w].ascender,_[w].descender=this.entries[w].descender;i(null,_)}})}_doesCharSupportLocalGlyph(e){return this.localGlyphMode!==vf.none&&(this.localGlyphMode===vf.all?!!this.localFontFamily:!!this.localFontFamily&&(ll(e)||Sa(e)||Eu(e)||Ha(e)||Oc(e)))}_tinySDF(e,i,a){const d=this.localFontFamily;if(!d||!this._doesCharSupportLocalGlyph(a))return;let m=e.tinySDF;if(!m){let ge="400";/bold/i.test(i)?ge="900":/medium/i.test(i)?ge="500":/light/i.test(i)&&(ge="200"),m=e.tinySDF=new fu.TinySDF({fontFamily:d,fontWeight:ge,fontSize:48,buffer:6,radius:16}),m.fontWeight=ge}if(this.localGlyphs[m.fontWeight][a])return this.localGlyphs[m.fontWeight][a];const _=String.fromCharCode(a),{data:w,width:T,height:M,glyphWidth:L,glyphHeight:z,glyphLeft:V,glyphTop:K,glyphAdvance:ne}=m.draw(_);return this.localGlyphs[m.fontWeight][a]={id:a,bitmap:new gl({width:T,height:M},w),metrics:{width:L/2,height:z/2,left:V/2,top:K/2-27,advance:ne/2,localGlyph:!0}}}}function cg(n,e,i,a){const d=[],m=n.image,_=m.pixelRatio,w=m.paddedRect.w-2,T=m.paddedRect.h-2,M=n.right-n.left,L=n.bottom-n.top,z=m.stretchX||[[0,w]],V=m.stretchY||[[0,T]],K=(sn,vn)=>sn+vn[1]-vn[0],ne=z.reduce(K,0),ge=V.reduce(K,0),ze=w-ne,rt=T-ge;let wt=0,it=ne,ft=0,At=ge,mt=0,rn=ze,en=0,mn=rt;if(m.content&&a){const sn=m.content;wt=Hh(z,0,sn[0]),ft=Hh(V,0,sn[1]),it=Hh(z,sn[0],sn[2]),At=Hh(V,sn[1],sn[3]),mt=sn[0]-wt,en=sn[1]-ft,rn=sn[2]-sn[0]-it,mn=sn[3]-sn[1]-At}const Pn=(sn,vn,xn,Sn)=>{const On=Wu(sn.stretch-wt,it,M,n.left),ln=Wh(sn.fixed-mt,rn,sn.stretch,ne),$n=Wu(vn.stretch-ft,At,L,n.top),vi=Wh(vn.fixed-en,mn,vn.stretch,ge),Xn=Wu(xn.stretch-wt,it,M,n.left),oi=Wh(xn.fixed-mt,rn,xn.stretch,ne),Hn=Wu(Sn.stretch-ft,At,L,n.top),Ti=Wh(Sn.fixed-en,mn,Sn.stretch,ge),Li=new te(On,$n),zi=new te(Xn,$n),hr=new te(Xn,Hn),Fi=new te(On,Hn),Xr=new te(ln/_,vi/_),Zi=new te(oi/_,Ti/_),Qi=e*Math.PI/180;if(Qi){const $r=Math.sin(Qi),Hr=Math.cos(Qi),Kr=[Hr,-$r,$r,Hr];Li._matMult(Kr),zi._matMult(Kr),Fi._matMult(Kr),hr._matMult(Kr)}const kr=sn.stretch+sn.fixed,Gr=vn.stretch+vn.fixed;return{tl:Li,tr:zi,bl:Fi,br:hr,tex:{x:m.paddedRect.x+1+kr,y:m.paddedRect.y+1+Gr,w:xn.stretch+xn.fixed-kr,h:Sn.stretch+Sn.fixed-Gr},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Xr,pixelOffsetBR:Zi,minFontScaleX:rn/_/M,minFontScaleY:mn/_/L,isSDF:i}};if(a&&(m.stretchX||m.stretchY)){const sn=ug(z,ze,ne),vn=ug(V,rt,ge);for(let xn=0;xn<sn.length-1;xn++){const Sn=sn[xn],On=sn[xn+1];for(let ln=0;ln<vn.length-1;ln++)d.push(Pn(Sn,vn[ln],On,vn[ln+1]))}}else d.push(Pn({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:w+1},{fixed:0,stretch:T+1}));return d}function Hh(n,e,i){let a=0;for(const d of n)a+=Math.max(e,Math.min(i,d[1]))-Math.max(e,Math.min(i,d[0]));return a}function ug(n,e,i){const a=[{fixed:-1,stretch:0}];for(const[d,m]of n){const _=a[a.length-1];a.push({fixed:d-_.stretch,stretch:_.stretch}),a.push({fixed:d-_.stretch,stretch:_.stretch+(m-d)})}return a.push({fixed:e+1,stretch:i}),a}function Wu(n,e,i,a){return n/e*i+a}function Wh(n,e,i,a){return n-e*i/a}function $_(n,e,i,a){const d=e+n.positionedLines[a].lineOffset;return 0===a?i+d/2:i+(d+(e+n.positionedLines[a-1].lineOffset))/2}fu.loadGlyphRange=function(n,e,i,a,d){const m=256*e,_=m+255,w=a.transformRequest(a.normalizeGlyphsURL(i).replace("{fontstack}",n).replace("{range}",`${m}-${_}`),qe.Glyphs);Qt(w,(T,M)=>{if(T)d(T);else if(M){const L={},z=new kd(M).readFields(mf,{});for(const V of z.glyphs)L[V.id]=V;d(null,{glyphs:L,ascender:z.ascender,descender:z.descender})}})},fu.TinySDF=class{constructor({fontSize:n=24,buffer:e=3,radius:i=8,cutoff:a=.25,fontFamily:d="sans-serif",fontWeight:m="normal",fontStyle:_="normal"}={}){this.buffer=e,this.cutoff=a,this.radius=i;const w=this.size=n+4*e,T=this._createCanvas(w),M=this.ctx=T.getContext("2d",{willReadFrequently:!0});M.font=`${_} ${m} ${n}px ${d}`,M.textBaseline="alphabetic",M.textAlign="left",M.fillStyle="black",this.gridOuter=new Float64Array(w*w),this.gridInner=new Float64Array(w*w),this.f=new Float64Array(w),this.z=new Float64Array(w+1),this.v=new Uint16Array(w)}_createCanvas(n){const e=document.createElement("canvas");return e.width=e.height=n,e}draw(n){const{width:e,actualBoundingBoxAscent:i,actualBoundingBoxDescent:a,actualBoundingBoxLeft:d,actualBoundingBoxRight:m}=this.ctx.measureText(n),_=Math.ceil(i),w=Math.min(this.size-this.buffer,Math.ceil(m-d)),T=Math.min(this.size-this.buffer,_+Math.ceil(a)),M=w+2*this.buffer,L=T+2*this.buffer,z=Math.max(M*L,0),V=new Uint8ClampedArray(z),K={data:V,width:M,height:L,glyphWidth:w,glyphHeight:T,glyphTop:_,glyphLeft:0,glyphAdvance:e};if(0===w||0===T)return K;const{ctx:ne,buffer:ge,gridInner:ze,gridOuter:rt}=this;ne.clearRect(ge,ge,w,T),ne.fillText(n,ge,ge+_);const wt=ne.getImageData(ge,ge,w,T);rt.fill(ya,0,z),ze.fill(0,0,z);for(let it=0;it<T;it++)for(let ft=0;ft<w;ft++){const At=wt.data[4*(it*w+ft)+3]/255;if(0===At)continue;const mt=(it+ge)*M+ft+ge;if(1===At)rt[mt]=0,ze[mt]=ya;else{const rn=.5-At;rt[mt]=rn>0?rn*rn:0,ze[mt]=rn<0?rn*rn:0}}Gh(rt,0,0,M,L,M,this.f,this.v,this.z),Gh(ze,ge,ge,w,T,M,this.f,this.v,this.z);for(let it=0;it<z;it++){const ft=Math.sqrt(rt[it])-Math.sqrt(ze[it]);V[it]=Math.round(255-255*(ft/this.radius+this.cutoff))}return K}};class qh{constructor(e=[],i=xf){if(this.data=e,this.length=this.data.length,this.compare=i,this.length>0)for(let a=(this.length>>1)-1;a>=0;a--)this._down(a)}push(e){this.data.push(e),this.length++,this._up(this.length-1)}pop(){if(0===this.length)return;const e=this.data[0],i=this.data.pop();return this.length--,this.length>0&&(this.data[0]=i,this._down(0)),e}peek(){return this.data[0]}_up(e){const{data:i,compare:a}=this,d=i[e];for(;e>0;){const m=e-1>>1,_=i[m];if(a(d,_)>=0)break;i[e]=_,e=m}i[e]=d}_down(e){const{data:i,compare:a}=this,d=this.length>>1,m=i[e];for(;e<d;){let _=1+(e<<1),w=i[_];const T=_+1;if(T<this.length&&a(i[T],w)<0&&(_=T,w=i[T]),a(w,m)>=0)break;i[e]=w,e=_}i[e]=m}}function xf(n,e){return n<e?-1:n>e?1:0}function Yh(n,e=1,i=!1){let a=1/0,d=1/0,m=-1/0,_=-1/0;const w=n[0];for(let K=0;K<w.length;K++){const ne=w[K];(!K||ne.x<a)&&(a=ne.x),(!K||ne.y<d)&&(d=ne.y),(!K||ne.x>m)&&(m=ne.x),(!K||ne.y>_)&&(_=ne.y)}const T=Math.min(m-a,_-d);let M=T/2;const L=new qh([],jy);if(0===T)return new te(a,d);for(let K=a;K<m;K+=T)for(let ne=d;ne<_;ne+=T)L.push(new Zc(K+M,ne+M,M,n));let z=function(K){let ne=0,ge=0,ze=0;const rt=K[0];for(let wt=0,it=rt.length,ft=it-1;wt<it;ft=wt++){const At=rt[wt],mt=rt[ft],rn=At.x*mt.y-mt.x*At.y;ge+=(At.x+mt.x)*rn,ze+=(At.y+mt.y)*rn,ne+=3*rn}return new Zc(ge/ne,ze/ne,0,K)}(n),V=L.length;for(;L.length;){const K=L.pop();(K.d>z.d||!z.d)&&(z=K,i&&console.log("found best %d after %d probes",Math.round(1e4*K.d)/1e4,V)),K.max-z.d<=e||(M=K.h/2,L.push(new Zc(K.p.x-M,K.p.y-M,M,n)),L.push(new Zc(K.p.x+M,K.p.y-M,M,n)),L.push(new Zc(K.p.x-M,K.p.y+M,M,n)),L.push(new Zc(K.p.x+M,K.p.y+M,M,n)),V+=4)}return i&&(console.log(`num probes: ${V}`),console.log(`best distance: ${z.d}`)),z.p}function jy(n,e){return e.max-n.max}function Zc(n,e,i,a){this.p=new te(n,e),this.h=i,this.d=function(d,m){let _=!1,w=1/0;for(let T=0;T<m.length;T++){const M=m[T];for(let L=0,z=M.length,V=z-1;L<z;V=L++){const K=M[L],ne=M[V];K.y>d.y!=ne.y>d.y&&d.x<(ne.x-K.x)*(d.y-K.y)/(ne.y-K.y)+K.x&&(_=!_),w=Math.min(w,Op(d,K,ne))}}return(_?1:-1)*Math.sqrt(w)}(this.p,a),this.max=this.d+this.h*Math.SQRT2}const dg=Number.POSITIVE_INFINITY,hg=Math.sqrt(2);function bf(n,e){return e[1]!==dg?function(i,a,d){let m=0,_=0;switch(a=Math.abs(a),d=Math.abs(d),i){case"top-right":case"top-left":case"top":_=d-7;break;case"bottom-right":case"bottom-left":case"bottom":_=7-d}switch(i){case"top-right":case"bottom-right":case"right":m=-a;break;case"top-left":case"bottom-left":case"left":m=a}return[m,_]}(n,e[0],e[1]):function(i,a){let d=0,m=0;a<0&&(a=0);const _=a/hg;switch(i){case"top-right":case"top-left":m=_-7;break;case"bottom-right":case"bottom-left":m=7-_;break;case"bottom":m=7-a;break;case"top":m=a-7}switch(i){case"top-right":case"bottom-right":d=-_;break;case"top-left":case"bottom-left":d=_;break;case"left":d=a;break;case"right":d=-a}return[d,m]}(n,e[0])}function pg(n,e,i,a,d,m,_,w,T,M){n.createArrays(),n.tilePixelRatio=Si/(512*n.overscaling),n.compareText={},n.iconsNeedLinear=!1;const L=n.layers[0].layout,z=n.layers[0]._unevaluatedLayout._values,V={};if("composite"===n.textSizeData.kind){const{minZoom:ge,maxZoom:ze}=n.textSizeData;V.compositeTextSizes=[z["text-size"].possiblyEvaluate(new ot(ge),w),z["text-size"].possiblyEvaluate(new ot(ze),w)]}if("composite"===n.iconSizeData.kind){const{minZoom:ge,maxZoom:ze}=n.iconSizeData;V.compositeIconSizes=[z["icon-size"].possiblyEvaluate(new ot(ge),w),z["icon-size"].possiblyEvaluate(new ot(ze),w)]}V.layoutTextSize=z["text-size"].possiblyEvaluate(new ot(T+1),w),V.layoutIconSize=z["icon-size"].possiblyEvaluate(new ot(T+1),w),V.textMaxSize=z["text-size"].possiblyEvaluate(new ot(18),w);const K="map"===L.get("text-rotation-alignment")&&"point"!==L.get("symbol-placement"),ne=L.get("text-size");for(const ge of n.features){const ze=L.get("text-font").evaluate(ge,{},w).join(","),rt=ne.evaluate(ge,{},w),wt=V.layoutTextSize.evaluate(ge,{},w),it=(V.layoutIconSize.evaluate(ge,{},w),{horizontal:{},vertical:void 0}),ft=ge.text;let At,mt=[0,0];if(ft){const mn=ft.toString(),Pn=24*L.get("text-letter-spacing").evaluate(ge,{},w),sn=24*L.get("text-line-height").evaluate(ge,{},w),vn=p(mn)?Pn:0,xn=L.get("text-anchor").evaluate(ge,{},w),Sn=L.get("text-variable-anchor");if(!Sn){const Xn=L.get("text-radial-offset").evaluate(ge,{},w);mt=Xn?bf(xn,[24*Xn,dg]):L.get("text-offset").evaluate(ge,{},w).map(oi=>24*oi)}let On=K?"center":L.get("text-justify").evaluate(ge,{},w);const ln="point"===L.get("symbol-placement"),$n=ln?24*L.get("text-max-width").evaluate(ge,{},w):1/0,vi=Xn=>{n.allowVerticalPlacement&&s(mn)&&(it.vertical=Uh(ft,e,i,d,ze,$n,sn,xn,Xn,vn,mt,ga.vertical,!0,wt,rt))};if(!K&&Sn){const Xn="auto"===On?Sn.map(Hn=>Jh(Hn)):[On];let oi=!1;for(let Hn=0;Hn<Xn.length;Hn++){const Ti=Xn[Hn];if(!it.horizontal[Ti])if(oi)it.horizontal[Ti]=it.horizontal[0];else{const Li=Uh(ft,e,i,d,ze,$n,sn,"center",Ti,vn,mt,ga.horizontal,!1,wt,rt);Li&&(it.horizontal[Ti]=Li,oi=1===Li.positionedLines.length)}}vi("left")}else{if("auto"===On&&(On=Jh(xn)),ln||L.get("text-writing-mode").indexOf("horizontal")>=0||!s(mn)){const Xn=Uh(ft,e,i,d,ze,$n,sn,xn,On,vn,mt,ga.horizontal,!1,wt,rt);Xn&&(it.horizontal[On]=Xn)}vi(ln?"left":On)}}let rn=!1;if(ge.icon&&ge.icon.name){const mn=a[ge.icon.name];mn&&(At=U_(d[ge.icon.name],L.get("icon-offset").evaluate(ge,{},w),L.get("icon-anchor").evaluate(ge,{},w)),rn=mn.sdf,void 0===n.sdfIcons?n.sdfIcons=mn.sdf:n.sdfIcons!==mn.sdf&&wn("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(mn.pixelRatio!==n.pixelRatio||0!==L.get("icon-rotate").constantOr(1))&&(n.iconsNeedLinear=!0))}const en=Vd(it.horizontal)||it.vertical;n.iconsInText||(n.iconsInText=!!en&&en.iconsInText),(en||At)&&wf(n,ge,it,At,a,V,wt,0,mt,rn,_,w,M)}m&&n.generateCollisionDebugBuffers(T,n.collisionBoxArray)}function Jh(n){switch(n){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function wf(n,e,i,a,d,m,_,w,T,M,L,z,V){let K=m.textMaxSize.evaluate(e,{},z);void 0===K&&(K=_);const ne=n.layers[0].layout,ge=ne.get("icon-offset").evaluate(e,{},z),ze=Vd(i.horizontal)||i.vertical,rt="globe"===V.name,wt=_/24,it=n.tilePixelRatio*K/24,ft=(vn=n.overscaling,n.zoom>18&&vn>2&&(vn>>=1),Math.max(Si/(512*vn),1)*ne.get("symbol-spacing")),At=ne.get("text-padding")*n.tilePixelRatio,mt=ne.get("icon-padding")*n.tilePixelRatio,rn=ye(ne.get("text-max-angle")),en="map"===ne.get("text-rotation-alignment")&&"point"!==ne.get("symbol-placement"),mn="map"===ne.get("icon-rotation-alignment")&&"point"!==ne.get("symbol-placement"),Pn=ne.get("symbol-placement"),sn=ft/2;var vn;const xn=ne.get("icon-text-fit");let Sn;a&&"none"!==xn&&(n.allowVerticalPlacement&&i.vertical&&(Sn=ng(a,i.vertical,xn,ne.get("icon-text-fit-padding"),ge,wt)),ze&&(a=ng(a,ze,xn,ne.get("icon-text-fit-padding"),ge,wt)));const On=(ln,$n,vi)=>{if($n.x<0||$n.x>=Si||$n.y<0||$n.y>=Si)return;let Xn=null;if(rt){const{x:oi,y:Hn,z:Ti}=V.projectTilePoint($n.x,$n.y,vi);Xn={anchor:new Vl(oi,Hn,Ti,0,void 0),up:V.upVector(vi,$n.x,$n.y)}}!function(oi,Hn,Ti,Li,zi,hr,Fi,Xr,Zi,Qi,kr,Gr,$r,Hr,Kr,yo,as,Pr,ko,Do,yr,oo,Go,Or,vo){const vs=oi.addToLineVertexArray(Hn,Li);let Xo,Ko,ks,Qo,Zl,bu,sd,ad=0,Yc=0,Lg=0,Fg=0,Jc=-1,kg=-1;const nl={};let ty=Su.exports("");const Xc=Ti?Ti.anchor:Hn;let cp=0,Bg=0;if(void 0===Zi._unevaluatedLayout.getValue("text-radial-offset")?[cp,Bg]=Zi.layout.get("text-offset").evaluate(yr,{},vo).map(va=>24*va):(cp=24*Zi.layout.get("text-radial-offset").evaluate(yr,{},vo),Bg=dg),oi.allowVerticalPlacement&&zi.vertical){const va=zi.vertical;if(Kr)bu=Cf(va),Xr&&(sd=Cf(Xr));else{const ls=Zi.layout.get("text-rotate").evaluate(yr,{},vo)+90;ks=Gc(Qi,Xc,Hn,kr,Gr,$r,va,Hr,ls,yo),Xr&&(Qo=Gc(Qi,Xc,Hn,kr,Gr,$r,Xr,Pr,ls))}}if(hr){const va=Zi.layout.get("icon-rotate").evaluate(yr,{},vo),ls="none"!==Zi.layout.get("icon-text-fit"),ih=cg(hr,va,Go,ls),ld=Xr?cg(Xr,va,Go,ls):void 0;Ko=Gc(Qi,Xc,Hn,kr,Gr,$r,hr,Pr,va),ad=4*ih.length;const rh=oi.iconSizeData;let no=null;"source"===rh.kind?(no=[Oa*Zi.layout.get("icon-size").evaluate(yr,{},vo)],no[0]>Ws&&wn(`${oi.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):"composite"===rh.kind&&(no=[Oa*oo.compositeIconSizes[0].evaluate(yr,{},vo),Oa*oo.compositeIconSizes[1].evaluate(yr,{},vo)],(no[0]>Ws||no[1]>Ws)&&wn(`${oi.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),oi.addSymbols(oi.icon,ih,no,Do,ko,yr,!1,Ti,Hn,vs.lineStartIndex,vs.lineLength,-1,Or,vo),Jc=oi.icon.placedSymbolArray.length-1,ld&&(Yc=4*ld.length,oi.addSymbols(oi.icon,ld,no,Do,ko,yr,ga.vertical,Ti,Hn,vs.lineStartIndex,vs.lineLength,-1,Or,vo),kg=oi.icon.placedSymbolArray.length-1)}for(const va in zi.horizontal){const ls=zi.horizontal[va];Xo||(ty=Su.exports(ls.text),Kr?Zl=Cf(ls):Xo=Gc(Qi,Xc,Hn,kr,Gr,$r,ls,Hr,Zi.layout.get("text-rotate").evaluate(yr,{},vo),yo));const ih=1===ls.positionedLines.length;if(Lg+=Ud(oi,Ti,Hn,ls,Fi,Zi,Kr,yr,yo,vs,zi.vertical?ga.horizontal:ga.horizontalOnly,ih?Object.keys(zi.horizontal):[va],nl,Jc,oo,Or,vo),ih)break}zi.vertical&&(Fg+=Ud(oi,Ti,Hn,zi.vertical,Fi,Zi,Kr,yr,yo,vs,ga.vertical,["vertical"],nl,kg,oo,Or,vo));let Mi=-1;const Wf=(va,ls)=>va?Math.max(va,ls):ls;Mi=Wf(Zl,Mi),Mi=Wf(bu,Mi),Mi=Wf(sd,Mi);const ny=Mi>-1?1:0;oi.glyphOffsetArray.length>=qc.MAX_GLYPHS&&wn("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==yr.sortKey&&oi.addToSortKeyRanges(oi.symbolInstances.length,yr.sortKey),oi.symbolInstances.emplaceBack(Xc.x,Xc.y,Xc.z,Hn.x,Hn.y,nl.right>=0?nl.right:-1,nl.center>=0?nl.center:-1,nl.left>=0?nl.left:-1,nl.vertical>=0?nl.vertical:-1,Jc,kg,ty,void 0!==Xo?Xo:oi.collisionBoxArray.length,void 0!==Xo?Xo+1:oi.collisionBoxArray.length,void 0!==ks?ks:oi.collisionBoxArray.length,void 0!==ks?ks+1:oi.collisionBoxArray.length,void 0!==Ko?Ko:oi.collisionBoxArray.length,void 0!==Ko?Ko+1:oi.collisionBoxArray.length,Qo||oi.collisionBoxArray.length,Qo?Qo+1:oi.collisionBoxArray.length,kr,Lg,Fg,ad,Yc,ny,0,cp,Bg,Mi)}(n,$n,Xn,ln,i,a,d,Sn,n.layers[0],n.collisionBoxArray,e.index,e.sourceLayerIndex,n.index,At,en,T,0,mt,mn,ge,e,m,M,L,z)};if("line"===Pn)for(const ln of ag(e.geometry,0,0,Si,Si)){const $n=j_(ln,ft,rn,i.vertical||ze,a,24,it,n.overscaling,Si);for(const vi of $n){const Xn=ze;Xn&&fg(n,Xn.text,sn,vi)||On(ln,vi,z)}}else if("line-center"===Pn){for(const ln of e.geometry)if(ln.length>1){const $n=V_(ln,rn,i.vertical||ze,a,24,it);$n&&On(ln,$n,z)}}else if("Polygon"===e.type)for(const ln of Xp(e.geometry,0)){const $n=Yh(ln,16);On(ln[0],new Vl($n.x,$n.y,0,0,void 0),z)}else if("LineString"===e.type)for(const ln of e.geometry)On(ln,new Vl(ln[0].x,ln[0].y,0,0,void 0),z);else if("Point"===e.type)for(const ln of e.geometry)for(const $n of ln)On([$n],new Vl($n.x,$n.y,0,0,void 0),z)}const Ws=32640;function Ud(n,e,i,a,d,m,_,w,T,M,L,z,V,K,ne,ge,ze){const rt=function(ft,At,mt,rn,en,mn,Pn,sn){const vn=[];if(0===At.positionedLines.length)return vn;const xn=rn.layout.get("text-rotate").evaluate(mn,{})*Math.PI/180,Sn=function(Xn){const oi=Xn[0],Hn=Xn[1],Ti=oi*Hn;return Ti>0?[oi,-Hn]:Ti<0?[-oi,Hn]:0===oi?[Hn,oi]:[Hn,-oi]}(mt);let On=Math.abs(At.top-At.bottom);for(const Xn of At.positionedLines)On-=Xn.lineOffset;const ln=At.positionedLines.length,$n=On/ln;let vi=At.top-mt[1];for(let Xn=0;Xn<ln;++Xn){const oi=At.positionedLines[Xn];vi=$_(At,$n,vi,Xn);for(const Hn of oi.positionedGlyphs){if(!Hn.rect)continue;const Ti=Hn.rect||{};let Li=4,zi=!0,hr=1,Fi=0;if(Hn.imageName){const Or=Pn[Hn.imageName];if(!Or)continue;if(Or.sdf){wn("SDF images are not supported in formatted text and will be ignored.");continue}zi=!1,hr=Or.pixelRatio,Li=1/hr}const Xr=(en||sn)&&Hn.vertical,Zi=Hn.metrics.advance*Hn.scale/2,Qi=Hn.metrics,kr=Hn.rect;if(null===kr)continue;sn&&At.verticalizable&&(Fi=Hn.imageName?Zi-Hn.metrics.width*Hn.scale/2:0);const Gr=en?[Hn.x+Zi,Hn.y]:[0,0];let $r=[0,0],Hr=[0,0],Kr=!1;en||(Xr?(Hr=[Hn.x+Zi+Sn[0],Hn.y+Sn[1]-Fi],Kr=!0):$r=[Hn.x+Zi+mt[0],Hn.y+mt[1]-Fi]);const yo=kr.w*Hn.scale/(hr*(Hn.localGlyph?2:1)),as=kr.h*Hn.scale/(hr*(Hn.localGlyph?2:1));let Pr,ko,Do,yr;if(Xr){const Or=Hn.y-vi,vo=new te(-Zi,Zi-Or),vs=-Math.PI/2,Xo=new te(...Hr);Pr=new te(-Zi+$r[0],$r[1]),Pr._rotateAround(vs,vo)._add(Xo),Pr.x+=-Or+Zi,Pr.y-=(Qi.left-Li)*Hn.scale;const Ko=Hn.imageName?Qi.advance*Hn.scale:24*Hn.scale,ks=String.fromCharCode(Hn.glyph);R_(ks)?Pr.x+=(1-Li)*Hn.scale:Ym(ks)?Pr.x+=Ko-Qi.height*Hn.scale+(-Li-1)*Hn.scale:Pr.x+=Hn.imageName||Qi.width+2*Li===kr.w&&Qi.height+2*Li===kr.h?(Ko-as)/2:(Ko-(Qi.height+2*Li)*Hn.scale)/2,ko=new te(Pr.x,Pr.y-yo),Do=new te(Pr.x+as,Pr.y),yr=new te(Pr.x+as,Pr.y-yo)}else{const Or=(Qi.left-Li)*Hn.scale-Zi+$r[0],vo=(-Qi.top-Li)*Hn.scale+$r[1],vs=Or+yo,Xo=vo+as;Pr=new te(Or,vo),ko=new te(vs,vo),Do=new te(Or,Xo),yr=new te(vs,Xo)}if(xn){let Or;Or=en?new te(0,0):Kr?new te(Sn[0],Sn[1]):new te(mt[0],mt[1]),Pr._rotateAround(xn,Or),ko._rotateAround(xn,Or),Do._rotateAround(xn,Or),yr._rotateAround(xn,Or)}const oo=new te(0,0),Go=new te(0,0);vn.push({tl:Pr,tr:ko,bl:Do,br:yr,tex:Ti,writingMode:At.writingMode,glyphOffset:Gr,sectionIndex:Hn.sectionIndex,isSDF:zi,pixelOffsetTL:oo,pixelOffsetBR:Go,minFontScaleX:0,minFontScaleY:0})}}return vn}(0,a,T,m,_,w,d,n.allowVerticalPlacement),wt=n.textSizeData;let it=null;"source"===wt.kind?(it=[Oa*m.layout.get("text-size").evaluate(w,{},ze)],it[0]>Ws&&wn(`${n.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):"composite"===wt.kind&&(it=[Oa*ne.compositeTextSizes[0].evaluate(w,{},ze),Oa*ne.compositeTextSizes[1].evaluate(w,{},ze)],(it[0]>Ws||it[1]>Ws)&&wn(`${n.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),n.addSymbols(n.text,rt,it,T,_,w,L,e,i,M.lineStartIndex,M.lineLength,K,ge,ze);for(const ft of z)V[ft]=n.text.placedSymbolArray.length-1;return 4*rt.length}function Vd(n){for(const e in n)return n[e];return null}function Gc(n,e,i,a,d,m,_,w,T,M){let L=_.top,z=_.bottom,V=_.left,K=_.right;const ne=_.collisionPadding;if(ne&&(V-=ne[0],L-=ne[1],K+=ne[2],z+=ne[3]),T){const ge=new te(V,L),ze=new te(K,L),rt=new te(V,z),wt=new te(K,z),it=ye(T);let ft=new te(0,0);M&&(ft=new te(M[0],M[1])),ge._rotateAround(it,ft),ze._rotateAround(it,ft),rt._rotateAround(it,ft),wt._rotateAround(it,ft),V=Math.min(ge.x,ze.x,rt.x,wt.x),K=Math.max(ge.x,ze.x,rt.x,wt.x),L=Math.min(ge.y,ze.y,rt.y,wt.y),z=Math.max(ge.y,ze.y,rt.y,wt.y)}return n.emplaceBack(e.x,e.y,e.z,i.x,i.y,V,L,K,z,w,a,d,m),n.length-1}function Cf(n){n.collisionPadding&&(n.top-=n.collisionPadding[1],n.bottom+=n.collisionPadding[3]);const e=n.bottom-n.top;return e>0?Math.max(10,e):null}function fg(n,e,i,a){const d=n.compareText;if(e in d){const m=d[e];for(let _=m.length-1;_>=0;_--)if(a.dist(m[_])<i)return!0}else d[e]=[];return d[e].push(a),!1}const mg=Nn([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:gg}=mg,_g=Nn([{name:"a_pos_3",components:3,type:"Int16"}]);var fc=Nn([{name:"a_pos",type:"Int16",components:2}]);const mc=Si/Math.PI/2,yg=2*ta(1,0)*mc*Math.PI,Yu=[64,32,16],vl=-mc,xl=mc,Z_=[new na([vl,vl,vl],[xl,xl,xl]),new na([vl,vl,vl],[0,0,xl]),new na([0,vl,vl],[xl,0,xl]),new na([vl,0,vl],[0,xl,xl]),new na([0,0,vl],[xl,xl,xl])];function vg(n,e,i,a=!0){const d=Xa([],n._camera.position,n.worldSize),m=[e,i,1,1];su(m,m,n.pixelMatrixInverse),Zo(m,m,1/m[3]);const _=Gs([],ml([],m,d)),w=n.globeMatrix,T=[w[12],w[13],w[14]],M=ml([],T,d),L=Ru(M),z=Gs([],M),V=n.worldSize/(2*Math.PI),K=Ka(z,_),ne=Math.asin(V/L);if(ne<Math.acos(K)){if(!a)return null;const Pn=[],sn=[];Xa(Pn,_,L/K),Gs(sn,ml(sn,Pn,M)),Gs(_,Uc(_,M,Xa(_,sn,Math.tan(ne)*L)))}const ge=[];new Vp(d,_).closestPointOnSphere(T,V,ge);const ze=Gs([],Un(w,0)),rt=Gs([],Un(w,1)),wt=Gs([],Un(w,2)),it=Ka(ze,ge),ft=Ka(rt,ge),At=Ka(wt,ge),mt=Fe(Math.asin(-ft/V));let rn=Fe(Math.atan2(it,At));rn=n.center.lng+function(Pn,sn){const vn=(sn-Pn+180)%360-180;return vn<-180?vn+360:vn}(n.center.lng,rn);const en=qa(rn),mn=_e(fl(mt),0,1);return new Bl(en,mn)}class G_{constructor(e,i,a){this.a=ml([],e,a),this.b=ml([],i,a),this.center=a;const d=Gs([],this.a),m=Gs([],this.b);this.angle=Math.acos(Ka(d,m))}}function Xh(n,e){if(0===n.angle)return null;let i;return i=0===n.a[e]?1/n.angle*.5*Math.PI:1/n.angle*Math.atan(n.b[e]/n.a[e]/Math.sin(n.angle)-1/Math.tan(n.angle)),i<0||i>1?null:function(a,d,m,_){const w=Math.sin(m);return a*(Math.sin((1-_)*m)/w)+d*(Math.sin(_*m)/w)}(n.a[e],n.b[e],n.angle,_e(i,0,1))+n.center[e]}function el(n){if(n.z<=1)return Z_[n.z+2*n.y+n.x];const e=Tf(Qh(n));return na.fromPoints(e)}function mu(n,e,i){return Xa(n,n,1-i),Lu(n,n,e,i)}function Kh(n,e){const i=gc(e.zoom);if(0===i)return el(n);const a=Qh(n),d=Tf(a),m=qa(a.getWest())*e.worldSize,_=qa(a.getEast())*e.worldSize,w=fl(a.getNorth())*e.worldSize,T=fl(a.getSouth())*e.worldSize,M=[m,w,0],L=[_,w,0],z=[m,T,0],V=[_,T,0],K=_m([],e.globeMatrix);return Fo(M,M,K),Fo(L,L,K),Fo(z,z,K),Fo(V,V,K),d[0]=mu(d[0],z,i),d[1]=mu(d[1],V,i),d[2]=mu(d[2],L,i),d[3]=mu(d[3],M,i),na.fromPoints(d)}function xg(n,e,i){for(const a of n)Fo(a,a,e),Xa(a,a,i)}function Qh({x:n,y:e,z:i}){const a=1/(1<<i),d=new _r(Zs(n*a),os((e+1)*a)),m=new _r(Zs((n+1)*a),os(e*a));return new pl(d,m)}function Tf(n){const e=ye(n.getNorth()),i=ye(n.getSouth()),a=Math.cos(e),d=Math.cos(i),m=Math.sin(e),_=Math.sin(i),w=n.getWest(),T=n.getEast();return[Ju(d,_,w),Ju(d,_,T),Ju(a,m,T),Ju(a,m,w)]}function Ju(n,e,i,a=mc){return i=ye(i),[n*Math.sin(i)*a,-e*a,n*Math.cos(i)*a]}function jd(n,e,i){return Ju(Math.cos(ye(n)),Math.sin(ye(n)),e,i)}function $d(n,e,i,a){const d=1<<i.z,m=(n/Si+i.x)/d;return jd(os((e/Si+i.y)/d),Zs(m),a)}function Zd({min:n,max:e}){return 16383/Math.max(e[0]-n[0],e[1]-n[1],e[2]-n[2])}const Ef=new Float64Array(16);function Gd(n){const e=Zd(n),i=Ch(Ef,[e,e,e]);return vd(i,i,((a=[])[0]=-(d=n.min)[0],a[1]=-d[1],a[2]=-d[2],a));var a,d}function bg(n){const e=(a=n.min,(i=Ef)[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=1,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=1,i[11]=0,i[12]=a[0],i[13]=a[1],i[14]=a[2],i[15]=1,i);var i,a;const d=1/Zd(n);return ru(e,e,[d,d,d])}function Df(n,e,i,a,d){const m=function(T){const M=Si/(2*Math.PI);return T/(2*Math.PI)/M}(i),_=[n,e,-i/(2*Math.PI)],w=dc(new Float64Array(16));return vd(w,w,_),ru(w,w,[m,m,m]),Fp(w,w,ye(-d)),wh(w,w,ye(-a)),w}function gc(n){return pe(5,6,n)}function Hc(n,e){const i=jd(e.lat,e.lng);return _=(d=ym([],function(ne){const ge=jd(ne._center.lat,ne._center.lng);let ze=Bp([],bd(0,1,0),ge);const rt=Nl([],-ne.angle,ge);ze=Fo(ze,ze,rt),Nl(rt,-ne._pitch,ze);const wt=Gs([],ge);return Xa(wt,wt,ne.cameraToCenterDistance/ne.pixelsPerMeter*yg),Fo(wt,wt,rt),Uc([],ge,wt)}(n),i))[0],w=d[1],T=d[2],M=(m=i)[0],L=m[1],z=m[2],K=(V=Math.sqrt(_*_+w*w+T*T)*Math.sqrt(M*M+L*L+z*z))&&Ka(d,m)/V,Math.acos(Math.min(Math.max(K,-1),1));var d,m,_,w,T,M,L,z,V,K}const W_=ye(85),Hd=Math.cos(W_),q_=Math.sin(W_);function wg(n,e){const i=n.fovAboveCenter,a=n.elevation?n.elevation.getMinElevationBelowMSL()*e:0,d=(n._camera.position[2]*n.worldSize-a)/Math.cos(n._pitch),m=Math.sin(i)*d/Math.sin(Math.max(Math.PI/2-n._pitch-i,.01)),_=Math.sin(n._pitch)*m+d;return Math.min(1.01*_,d*(1/n._horizonShift))}function _c(n,e){if(!e.isReprojectedInTileSpace)return{scale:1<<n.z,x:n.x,y:n.y,x2:n.x+1,y2:n.y+1,projection:e};const i=Math.pow(2,-n.z),a=n.x*i,d=(n.x+1)*i,m=n.y*i,_=(n.y+1)*i,w=Zs(a),T=Zs(d),M=os(m),L=os(_),z=e.project(w,M),V=e.project(T,M),K=e.project(T,L),ne=e.project(w,L);let ge=Math.min(z.x,V.x,K.x,ne.x),ze=Math.min(z.y,V.y,K.y,ne.y),rt=Math.max(z.x,V.x,K.x,ne.x),wt=Math.max(z.y,V.y,K.y,ne.y);const it=i/16;function ft(mt,rn,en,mn,Pn,sn){const vn=(en+Pn)/2,xn=(mn+sn)/2,Sn=e.project(Zs(vn),os(xn)),On=Math.max(0,ge-Sn.x,ze-Sn.y,Sn.x-rt,Sn.y-wt);ge=Math.min(ge,Sn.x),rt=Math.max(rt,Sn.x),ze=Math.min(ze,Sn.y),wt=Math.max(wt,Sn.y),On>it&&(ft(mt,Sn,en,mn,vn,xn),ft(Sn,rn,vn,xn,Pn,sn))}ft(z,V,a,m,d,m),ft(V,K,d,m,d,_),ft(K,ne,d,_,a,_),ft(ne,z,a,_,a,m),ge-=it,ze-=it,rt+=it,wt+=it;const At=1/Math.max(rt-ge,wt-ze);return{scale:At,x:ge*At,y:ze*At,x2:rt*At,y2:wt*At,projection:e}}const Y_=dc(new Float32Array(16));class Fs{constructor(e){this.spec=e,this.name=e.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(e,i){return{x:0,y:0,z:0}}unproject(e,i){return new _r(0,0)}projectTilePoint(e,i,a){return{x:e,y:i,z:0}}locationPoint(e,i,a=!0){return e._coordinatePoint(e.locationCoordinate(i),a)}pixelsPerMeter(e,i){return ta(1,e)*i}pixelSpaceConversion(e,i,a){return 1}farthestPixelDistance(e){return wg(e,e.pixelsPerMeter)}pointCoordinate(e,i,a,d){const m=e.horizonLineFromTop(!1),_=new te(i,Math.max(m,a));return e.rayIntersectionCoordinate(e.pointRayIntersection(_,d))}pointCoordinate3D(e,i,a){const d=new te(i,a);if(e.elevation)return e.elevation.pointCoordinate(d);{const m=this.pointCoordinate(e,d.x,d.y,0);return[m.x,m.y,m.z]}}isPointAboveHorizon(e,i){if(e.elevation)return!this.pointCoordinate3D(e,i.x,i.y);const a=e.horizonLineFromTop();return i.y<a}createInversionMatrix(e,i){return Y_}createTileMatrix(e,i,a){let d,m,_;const w=a.canonical,T=dc(new Float64Array(16));if(this.isReprojectedInTileSpace){const M=_c(w,this);d=1,m=M.x+a.wrap*M.scale,_=M.y,ru(T,T,[d/M.scale,d/M.scale,e.pixelsPerMeter/i])}else d=i/e.zoomScale(w.z),m=(w.x+Math.pow(2,w.z)*a.wrap)*d,_=w.y*d;return vd(T,T,[m,_,0]),ru(T,T,[d/Si,d/Si,1]),T}upVector(e,i,a){return[0,0,1]}upVectorScale(e,i,a){return{metersToTile:1}}}class Wd extends Fs{constructor(e){super(e),this.range=[4,7],this.center=e.center||[-96,37.5];const[i,a]=this.parallels=e.parallels||[29.5,45.5],d=Math.sin(ye(i));this.n=(d+Math.sin(ye(a)))/2,this.c=1+d*(2*this.n-d),this.r0=Math.sqrt(this.c)/this.n}project(e,i){const{n:a,c:d,r0:m}=this,_=ye(e-this.center[0]),w=ye(i),T=Math.sqrt(d-2*a*Math.sin(w))/a;return{x:T*Math.sin(_*a),y:T*Math.cos(_*a)-m,z:0}}unproject(e,i){const{n:a,c:d,r0:m}=this,_=m+i;let w=Math.atan2(e,Math.abs(_))*Math.sign(_);_*a<0&&(w-=Math.PI*Math.sign(e)*Math.sign(_));const T=ye(this.center[0])*a;w=ae(w,-Math.PI-T,Math.PI-T);const M=_e(Fe(w/a)+this.center[0],-180,180),L=Math.asin(_e((d-(e*e+_*_)*a*a)/(2*a),-1,1)),z=_e(Fe(L),-85.051129,Ya);return new _r(M,z)}}const Yo=1.340264,bl=-.081106,Wc=893e-6,qs=.003796,Xu=Math.sqrt(3)/2;class Ku extends Fs{project(e,i){i=i/180*Math.PI,e=e/180*Math.PI;const a=Math.asin(Xu*Math.sin(i)),d=a*a,m=d*d*d;return{x:.5*(e*Math.cos(a)/(Xu*(Yo+3*bl*d+m*(7*Wc+9*qs*d)))/Math.PI+.5),y:1-.5*(a*(Yo+bl*d+m*(Wc+qs*d))/Math.PI+1),z:0}}unproject(e,i){e=(2*e-.5)*Math.PI;let a=i=(2*(1-i)-1)*Math.PI,d=a*a,m=d*d*d;for(let L,z,V,K=0;K<12&&(z=a*(Yo+bl*d+m*(Wc+qs*d))-i,V=Yo+3*bl*d+m*(7*Wc+9*qs*d),L=z/V,a=_e(a-L,-Math.PI/3,Math.PI/3),d=a*a,m=d*d*d,!(Math.abs(L)<1e-12));++K);const _=Xu*e*(Yo+3*bl*d+m*(7*Wc+9*qs*d))/Math.cos(a),w=Math.asin(Math.sin(a)/Xu),T=_e(180*_/Math.PI,-180,180),M=_e(180*w/Math.PI,-85.051129,Ya);return new _r(T,M)}}class Qu extends Fs{constructor(e){super(e),this.wrap=!0,this.supportsWorldCopies=!0}project(e,i){return{x:.5+e/360,y:.5-i/360,z:0}}unproject(e,i){const a=360*(e-.5),d=_e(360*(.5-i),-85.051129,Ya);return new _r(a,d)}}const wl=Math.PI/2;function yc(n){return Math.tan((wl+n)/2)}class ed extends Fs{constructor(e){super(e),this.center=e.center||[0,30];const[i,a]=this.parallels=e.parallels||[30,30];let d=ye(i),m=ye(a);this.southernCenter=d+m<0,this.southernCenter&&(d=-d,m=-m);const _=Math.cos(d),w=yc(d);this.n=d===m?Math.sin(d):Math.log(_/Math.cos(m))/Math.log(yc(m)/w),this.f=_*Math.pow(yc(d),this.n)/this.n}project(e,i){i=ye(i),this.southernCenter&&(i=-i),e=ye(e-this.center[0]);const a=1e-6,{n:d,f:m}=this;m>0?i<-wl+a&&(i=-wl+a):i>wl-a&&(i=wl-a);const _=m/Math.pow(yc(i),d);let w=_*Math.sin(d*e),T=m-_*Math.cos(d*e);return w=.5*(w/Math.PI+.5),T=.5*(T/Math.PI+.5),{x:w,y:this.southernCenter?T:1-T,z:0}}unproject(e,i){e=(2*e-.5)*Math.PI,this.southernCenter&&(i=1-i),i=(2*(1-i)-.5)*Math.PI;const{n:a,f:d}=this,m=d-i,_=Math.sign(m),w=Math.sign(a)*Math.sqrt(e*e+m*m);let T=Math.atan2(e,Math.abs(m))*_;m*a<0&&(T-=Math.PI*Math.sign(e)*_);const M=_e(Fe(T/a)+this.center[0],-180,180),L=_e(Fe(2*Math.atan(Math.pow(d/w,1/a))-wl),-85.051129,Ya);return new _r(M,this.southernCenter?-L:L)}}class gu extends Fs{constructor(e){super(e),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(e,i){return{x:qa(e),y:fl(i),z:0}}unproject(e,i){const a=Zs(e),d=os(i);return new _r(a,d)}}const _u=ye(Ya);class td extends Fs{project(e,i){const a=(i=ye(i))*i,d=a*a;return{x:.5*((e=ye(e))*(.8707-.131979*a+d*(d*(.003971*a-.001529*d)-.013791))/Math.PI+.5),y:1-.5*(i*(1.007226+a*(.015085+d*(.028874*a-.044475-.005916*d)))/Math.PI+1),z:0}}unproject(e,i){e=(2*e-.5)*Math.PI;let a=i=(2*(1-i)-1)*Math.PI,d=25,m=0,_=a*a;do{_=a*a;const M=_*_;m=(a*(1.007226+_*(.015085+M*(.028874*_-.044475-.005916*M)))-i)/(1.007226+_*(.045255+M*(.259866*_-.311325-.005916*11*M))),a=_e(a-m,-_u,_u)}while(Math.abs(m)>1e-6&&--d>0);_=a*a;const w=_e(Fe(e/(.8707+_*(_*(_*_*_*(.003971-.001529*_)-.013791)-.131979))),-180,180),T=Fe(a);return new _r(w,T)}}const yu=ye(Ya);class Cg extends Fs{project(e,i){i=ye(i),e=ye(e);const a=Math.cos(i),d=2/Math.PI,m=Math.acos(a*Math.cos(e/2)),_=Math.sin(m)/m,w=.5*(e*d+2*a*Math.sin(e/2)/_)||0,T=.5*(i+Math.sin(i)/_)||0;return{x:.5*(w/Math.PI+.5),y:1-.5*(T/Math.PI+1),z:0}}unproject(e,i){let a=e=(2*e-.5)*Math.PI,d=i=(2*(1-i)-1)*Math.PI,m=25;const _=1e-6;let w=0,T=0;do{const M=Math.cos(d),L=Math.sin(d),z=2*L*M,V=L*L,K=M*M,ne=Math.cos(a/2),ge=Math.sin(a/2),ze=2*ne*ge,rt=ge*ge,wt=1-K*ne*ne,it=wt?1/wt:0,ft=wt?Math.acos(M*ne)*Math.sqrt(1/wt):0,At=.5*(2*ft*M*ge+2*a/Math.PI)-e,mt=.5*(ft*L+d)-i,rn=.5*it*(K*rt+ft*M*ne*V)+1/Math.PI,en=it*(ze*z/4-ft*L*ge),mn=.125*it*(z*ge-ft*L*K*ze),Pn=.5*it*(V*ne+ft*rt*M)+.5,sn=en*mn-Pn*rn;w=(mt*en-At*Pn)/sn,T=(At*mn-mt*rn)/sn,a=_e(a-w,-Math.PI,Math.PI),d=_e(d-T,-yu,yu)}while((Math.abs(w)>_||Math.abs(T)>_)&&--m>0);return new _r(Fe(a),Fe(d))}}class If extends Fs{constructor(e){super(e),this.center=e.center||[0,0],this.parallels=e.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(ye(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(e,i){const{scale:a,cosPhi:d}=this;return{x:ye(e)*d*a+.5,y:-Math.sin(ye(i))/d*a+.5,z:0}}unproject(e,i){const{scale:a,cosPhi:d}=this,m=-(i-.5)/a,_=_e(Fe((e-.5)/a)/d,-180,180),w=Math.asin(_e(m*d,-1,1)),T=_e(Fe(w),-85.051129,Ya);return new _r(_,T)}}class Tg extends gu{constructor(e){super(e),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug","custom"],this.range=[3,5]}projectTilePoint(e,i,a){const d=$d(e,i,a);return Fo(d,d,Gd(el(a))),{x:d[0],y:d[1],z:d[2]}}locationPoint(e,i){const a=jd(i.lat,i.lng),d=Gs([],a),m=e.elevation?e.elevation.getAtPointOrZero(e.locationCoordinate(i),e._centerAltitude):e._centerAltitude;Lu(a,a,d,ta(1,0)*Si*m);const _=dc(new Float64Array(16));return iu(_,e.pixelMatrix,e.globeMatrix),Fo(a,a,_),new te(a[0],a[1])}pixelsPerMeter(e,i){return ta(1,0)*i}pixelSpaceConversion(e,i,a){const d=ta(1,e)*i,m=ji(ta(1,45)*i,d,a);return this.pixelsPerMeter(e,i)/m}createTileMatrix(e,i,a){const d=bg(el(a.canonical));return iu(new Float64Array(16),e.globeMatrix,d)}createInversionMatrix(e,i){const{center:a}=e,d=Gd(el(i));return wh(d,d,ye(a.lng)),Fp(d,d,ye(a.lat)),ru(d,d,[e._pixelsPerMercatorPixel,e._pixelsPerMercatorPixel,1]),Float32Array.from(d)}pointCoordinate(e,i,a,d){return vg(e,i,a,!0)||new Bl(0,0)}pointCoordinate3D(e,i,a){const d=this.pointCoordinate(e,i,a,0);return[d.x,d.y,d.z]}isPointAboveHorizon(e,i){return!vg(e,i.x,i.y,!1)}farthestPixelDistance(e){const i=function(d,m){const _=d.cameraToCenterDistance,w=d._centerAltitude*m,T=d._camera,M=d._camera.forward(),L=Uc([],Xa([],M,-_),[0,0,w]),z=d.worldSize/(2*Math.PI),V=[0,0,-z],K=d.width/d.height,ne=Math.tan(d.fovAboveCenter),ge=Xa([],T.up(),ne),ze=Xa([],T.right(),ne*K),rt=Gs([],Uc([],Uc([],M,ge),ze)),wt=[];let it;if(new Vp(L,rt).closestPointOnSphere(V,z,wt)){const ft=Uc([],wt,V),At=ml([],ft,L);it=Math.cos(d.fovAboveCenter)*Ru(At)}else{const ft=ml([],L,V),At=ml([],V,L);Gs(At,At);const mt=Ru(ft)-z;it=Math.sqrt(mt*(mt+2*z));const rn=Math.acos(it/(z+mt))-Math.acos(Ka(M,At));it*=Math.cos(rn)}return 1.01*it}(e,this.pixelsPerMeter(e.center.lat,e.worldSize)),a=gc(e.zoom);if(a>0){const d=wg(e,ta(1,e.center.lat)*e.worldSize),m=e.worldSize/(2*Math.PI),_=Math.max(e.width,e.height)/e.worldSize*Math.PI;return ji(i,d+m*(1-Math.cos(_)),Math.pow(a,10))}return i}upVector(e,i,a){return $d(i,a,e,1)}upVectorScale(e){return{metersToTile:yg*Zd(el(e))}}}function Mf(n){const e=n.parallels,i=!!e&&Math.abs(e[0]+e[1])<.01;switch(n.name){case"mercator":return new gu(n);case"equirectangular":return new Qu(n);case"naturalEarth":return new td(n);case"equalEarth":return new Ku(n);case"winkelTripel":return new Cg(n);case"albers":return i?new If(n):new Wd(n);case"lambertConformalConic":return i?new If(n):new ed(n);case"globe":return new Tg(n)}throw new Error(`Invalid projection name: ${n.name}`)}const Eg=Dd.types,Dg=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function qd(n,e,i,a,d,m,_,w,T,M,L,z,V){const K=w?Math.min(Ws,Math.round(w[0])):0,ne=w?Math.min(Ws,Math.round(w[1])):0;n.emplaceBack(e,i,Math.round(32*a),Math.round(32*d),m,_,(K<<1)+(T?1:0),ne,16*M,16*L,256*z,256*V)}function Yd(n,e,i,a,d,m,_){n.emplaceBack(e,i,a,d,m,_)}function Jd(n,e,i,a,d){n.emplaceBack(e,i,a,d),n.emplaceBack(e,i,a,d),n.emplaceBack(e,i,a,d),n.emplaceBack(e,i,a,d)}function J_(n){for(const e of n.sections)if(H(e.text))return!0;return!1}class Sf{constructor(e){this.layoutVertexArray=new fo,this.indexArray=new ys,this.programConfigurations=e,this.segments=new Lo,this.dynamicLayoutVertexArray=new qo,this.opacityVertexArray=new Ro,this.placedSymbolArray=new ah,this.globeExtVertexArray=new Mr}isEmpty(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length}upload(e,i,a,d){this.isEmpty()||(a&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Uy.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,i),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,qm.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,Dg,!0),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=e.createVertexBuffer(this.globeExtVertexArray,M_.members,!0)),this.opacityVertexBuffer.itemSize=1),(a||d)&&this.programConfigurations.upload(e))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}}Jn(Sf,"SymbolBuffers");class ep{constructor(e,i,a){this.layoutVertexArray=new e,this.layoutAttributes=i,this.indexArray=new a,this.segments=new Lo,this.collisionVertexArray=new Fl,this.collisionVertexArrayExt=new ma}upload(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,Vy.members,!0),this.collisionVertexBufferExt=e.createVertexBuffer(this.collisionVertexArrayExt,S_.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}Jn(ep,"CollisionBuffers");class qc{constructor(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(_=>_.id),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=dc([]),this.placementViewportMatrix=dc([]);const i=this.layers[0]._unevaluatedLayout._values;this.textSizeData=cf(this.zoom,i["text-size"]),this.iconSizeData=cf(this.zoom,i["icon-size"]);const a=this.layers[0].layout,d=a.get("symbol-sort-key"),m=a.get("symbol-z-order");this.canOverlap=a.get("text-allow-overlap")||a.get("icon-allow-overlap")||a.get("text-ignore-placement")||a.get("icon-ignore-placement"),this.sortFeaturesByKey="viewport-y"!==m&&void 0!==d.constantOr(1),this.sortFeaturesByY=("viewport-y"===m||"auto"===m&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=a.get("text-writing-mode").map(_=>ga[_]),this.stateDependentLayerIds=this.layers.filter(_=>_.isStateDependent()).map(_=>_.id),this.sourceID=e.sourceID,this.projection=e.projection}createArrays(){this.text=new Sf(new cc(this.layers,this.zoom,e=>/^text/.test(e))),this.icon=new Sf(new cc(this.layers,this.zoom,e=>/^icon/.test(e))),this.glyphOffsetArray=new Rs,this.lineVertexArray=new Mu,this.symbolInstances=new lh}calculateGlyphDependencies(e,i,a,d,m){for(let _=0;_<e.length;_++)if(i[e.charCodeAt(_)]=!0,d&&m){const w=Fd[e.charAt(_)];w&&(i[w.charCodeAt(0)]=!0)}}populate(e,i,a,d){const m=this.layers[0],_=m.layout,w="globe"===this.projection.name,T=_.get("text-font"),M=_.get("text-field"),L=_.get("icon-image"),z=("constant"!==M.value.kind||M.value.value instanceof bo&&!M.value.value.isEmpty()||M.value.value.toString().length>0)&&("constant"!==T.value.kind||T.value.value.length>0),V="constant"!==L.value.kind||!!L.value.value||Object.keys(L.parameters).length>0,K=_.get("symbol-sort-key");if(this.features=[],!z&&!V)return;const ne=i.iconDependencies,ge=i.glyphDependencies,ze=i.availableImages,rt=new ot(this.zoom);for(const{feature:wt,id:it,index:ft,sourceLayerIndex:At}of e){const mt=m._featureFilter.needGeometry,rn=uc(wt,mt);if(!m._featureFilter.filter(rt,rn,a))continue;if(mt||(rn.geometry=Ja(wt,a,d)),w&&1!==wt.type&&a.z<=5){const sn=rn.geometry,vn=.98078528056,xn=(Sn,On)=>Ka($d(Sn.x,Sn.y,a,1),$d(On.x,On.y,a,1))<vn;for(let Sn=0;Sn<sn.length;Sn++)sn[Sn]=t_(sn[Sn],xn)}let en,mn;if(z){const sn=m.getValueAndResolveTokens("text-field",rn,a,ze),vn=bo.factory(sn);J_(vn)&&(this.hasRTLText=!0),(!this.hasRTLText||"unavailable"===We()||this.hasRTLText&&yt.isParsed())&&(en=O_(vn,m,rn))}if(V){const sn=m.getValueAndResolveTokens("icon-image",rn,a,ze);mn=sn instanceof io?sn:io.fromString(sn)}if(!en&&!mn)continue;const Pn=this.sortFeaturesByKey?K.evaluate(rn,{},a):void 0;if(this.features.push({id:it,text:en,icon:mn,index:ft,sourceLayerIndex:At,geometry:rn.geometry,properties:wt.properties,type:Eg[wt.type],sortKey:Pn}),mn&&(ne[mn.name]=!0),en){const sn=T.evaluate(rn,{},a).join(","),vn="map"===_.get("text-rotation-alignment")&&"point"!==_.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(ga.vertical)>=0;for(const xn of en.sections)if(xn.image)ne[xn.image.name]=!0;else{const Sn=s(en.toString()),On=xn.fontStack||sn,ln=ge[On]=ge[On]||{};this.calculateGlyphDependencies(xn.text,ln,vn,this.allowVerticalPlacement,Sn)}}}"line"===_.get("symbol-placement")&&(this.features=function(wt){const it={},ft={},At=[];let mt=0;function rn(sn){At.push(wt[sn]),mt++}function en(sn,vn,xn){const Sn=ft[sn];return delete ft[sn],ft[vn]=Sn,At[Sn].geometry[0].pop(),At[Sn].geometry[0]=At[Sn].geometry[0].concat(xn[0]),Sn}function mn(sn,vn,xn){const Sn=it[vn];return delete it[vn],it[sn]=Sn,At[Sn].geometry[0].shift(),At[Sn].geometry[0]=xn[0].concat(At[Sn].geometry[0]),Sn}function Pn(sn,vn,xn){const Sn=xn?vn[0][vn[0].length-1]:vn[0][0];return`${sn}:${Sn.x}:${Sn.y}`}for(let sn=0;sn<wt.length;sn++){const vn=wt[sn],xn=vn.geometry,Sn=vn.text?vn.text.toString():null;if(!Sn){rn(sn);continue}const On=Pn(Sn,xn),ln=Pn(Sn,xn,!0);if(On in ft&&ln in it&&ft[On]!==it[ln]){const $n=mn(On,ln,xn),vi=en(On,ln,At[$n].geometry);delete it[On],delete ft[ln],ft[Pn(Sn,At[vi].geometry,!0)]=vi,At[$n].geometry=null}else On in ft?en(On,ln,xn):ln in it?mn(On,ln,xn):(rn(sn),it[On]=mt-1,ft[ln]=mt-1)}return At.filter(sn=>sn.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((wt,it)=>wt.sortKey-it.sortKey)}update(e,i,a,d){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,i,this.layers,a,d),this.icon.programConfigurations.updatePaintArrays(e,i,this.layers,a,d))}isEmpty(){return 0===this.symbolInstances.length&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=Mf(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(e,i){const a=this.lineVertexArray.length,d=e.segment;if(void 0!==d){let m=e.dist(i[d+1]),_=e.dist(i[d]);const w={};for(let T=d+1;T<i.length;T++)w[T]={x:i[T].x,y:i[T].y,tileUnitDistanceFromAnchor:m},T<i.length-1&&(m+=i[T+1].dist(i[T]));for(let T=d||0;T>=0;T--)w[T]={x:i[T].x,y:i[T].y,tileUnitDistanceFromAnchor:_},T>0&&(_+=i[T-1].dist(i[T]));for(let T=0;T<i.length;T++){const M=w[T];this.lineVertexArray.emplaceBack(M.x,M.y,M.tileUnitDistanceFromAnchor)}}return{lineStartIndex:a,lineLength:this.lineVertexArray.length-a}}addSymbols(e,i,a,d,m,_,w,T,M,L,z,V,K,ne){const ge=e.indexArray,ze=e.layoutVertexArray,rt=e.globeExtVertexArray,wt=e.segments.prepareSegment(4*i.length,ze,ge,this.canOverlap?_.sortKey:void 0),it=this.glyphOffsetArray.length,ft=wt.vertexLength,At=this.allowVerticalPlacement&&w===ga.vertical?Math.PI/2:0,mt=_.text&&_.text.sections;for(let en=0;en<i.length;en++){const{tl:mn,tr:Pn,bl:sn,br:vn,tex:xn,pixelOffsetTL:Sn,pixelOffsetBR:On,minFontScaleX:ln,minFontScaleY:$n,glyphOffset:vi,isSDF:Xn,sectionIndex:oi}=i[en],Hn=wt.vertexLength,Ti=vi[1];if(qd(ze,M.x,M.y,mn.x,Ti+mn.y,xn.x,xn.y,a,Xn,Sn.x,Sn.y,ln,$n),qd(ze,M.x,M.y,Pn.x,Ti+Pn.y,xn.x+xn.w,xn.y,a,Xn,On.x,Sn.y,ln,$n),qd(ze,M.x,M.y,sn.x,Ti+sn.y,xn.x,xn.y+xn.h,a,Xn,Sn.x,On.y,ln,$n),qd(ze,M.x,M.y,vn.x,Ti+vn.y,xn.x+xn.w,xn.y+xn.h,a,Xn,On.x,On.y,ln,$n),T){const Li=T.anchor,zi=T.up;Yd(rt,Li.x,Li.y,Li.z,zi[0],zi[1],zi[2]),Yd(rt,Li.x,Li.y,Li.z,zi[0],zi[1],zi[2]),Yd(rt,Li.x,Li.y,Li.z,zi[0],zi[1],zi[2]),Yd(rt,Li.x,Li.y,Li.z,zi[0],zi[1],zi[2]),Jd(e.dynamicLayoutVertexArray,Li.x,Li.y,Li.z,At)}else Jd(e.dynamicLayoutVertexArray,M.x,M.y,M.z,At);ge.emplaceBack(Hn,Hn+1,Hn+2),ge.emplaceBack(Hn+1,Hn+2,Hn+3),wt.vertexLength+=4,wt.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(vi[0]),en!==i.length-1&&oi===i[en+1].sectionIndex||e.programConfigurations.populatePaintArrays(ze.length,_,_.index,{},K,ne,mt&&mt[oi])}const rn=T?T.anchor:M;e.placedSymbolArray.emplaceBack(rn.x,rn.y,rn.z,M.x,M.y,it,this.glyphOffsetArray.length-it,ft,L,z,M.segment,a?a[0]:0,a?a[1]:0,d[0],d[1],w,0,!1,0,V,0)}_commitLayoutVertex(e,i,a,d,m,_,w){e.emplaceBack(i,a,d,m,_,Math.round(w.x),Math.round(w.y))}_addCollisionDebugVertices(e,i,a,d,m,_,w){const T=a.segments.prepareSegment(4,a.layoutVertexArray,a.indexArray),M=T.vertexLength,L=w.tileAnchorX,z=w.tileAnchorY;for(let K=0;K<4;K++)a.collisionVertexArray.emplaceBack(0,0,0,0);a.collisionVertexArrayExt.emplaceBack(i,-e.padding,-e.padding),a.collisionVertexArrayExt.emplaceBack(i,e.padding,-e.padding),a.collisionVertexArrayExt.emplaceBack(i,e.padding,e.padding),a.collisionVertexArrayExt.emplaceBack(i,-e.padding,e.padding),this._commitLayoutVertex(a.layoutVertexArray,d,m,_,L,z,new te(e.x1,e.y1)),this._commitLayoutVertex(a.layoutVertexArray,d,m,_,L,z,new te(e.x2,e.y1)),this._commitLayoutVertex(a.layoutVertexArray,d,m,_,L,z,new te(e.x2,e.y2)),this._commitLayoutVertex(a.layoutVertexArray,d,m,_,L,z,new te(e.x1,e.y2)),T.vertexLength+=4;const V=a.indexArray;V.emplaceBack(M,M+1),V.emplaceBack(M+1,M+2),V.emplaceBack(M+2,M+3),V.emplaceBack(M+3,M),T.primitiveLength+=4}_addTextDebugCollisionBoxes(e,i,a,d,m,_){for(let w=d;w<m;w++){const T=a.get(w),M=this.getSymbolInstanceTextSize(e,_,i,w);this._addCollisionDebugVertices(T,M,this.textCollisionBox,T.projectedAnchorX,T.projectedAnchorY,T.projectedAnchorZ,_)}}_addIconDebugCollisionBoxes(e,i,a,d,m,_){for(let w=d;w<m;w++){const T=a.get(w),M=this.getSymbolInstanceIconSize(e,i,_.placedIconSymbolIndex);this._addCollisionDebugVertices(T,M,this.iconCollisionBox,T.projectedAnchorX,T.projectedAnchorY,T.projectedAnchorZ,_)}}generateCollisionDebugBuffers(e,i){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new ep(Vr,uu.members,Qs),this.iconCollisionBox=new ep(Vr,uu.members,Qs);const a=Gu(this.iconSizeData,e),d=Gu(this.textSizeData,e);for(let m=0;m<this.symbolInstances.length;m++){const _=this.symbolInstances.get(m);this._addTextDebugCollisionBoxes(d,e,i,_.textBoxStartIndex,_.textBoxEndIndex,_),this._addTextDebugCollisionBoxes(d,e,i,_.verticalTextBoxStartIndex,_.verticalTextBoxEndIndex,_),this._addIconDebugCollisionBoxes(a,e,i,_.iconBoxStartIndex,_.iconBoxEndIndex,_),this._addIconDebugCollisionBoxes(a,e,i,_.verticalIconBoxStartIndex,_.verticalIconBoxEndIndex,_)}}getSymbolInstanceTextSize(e,i,a,d){const m=this.text.placedSymbolArray.get(i.rightJustifiedTextSymbolIndex>=0?i.rightJustifiedTextSymbolIndex:i.centerJustifiedTextSymbolIndex>=0?i.centerJustifiedTextSymbolIndex:i.leftJustifiedTextSymbolIndex>=0?i.leftJustifiedTextSymbolIndex:i.verticalPlacedTextSymbolIndex>=0?i.verticalPlacedTextSymbolIndex:d),_=Ld(this.textSizeData,e,m)/24;return this.tilePixelRatio*_}getSymbolInstanceIconSize(e,i,a){const d=this.icon.placedSymbolArray.get(a),m=Ld(this.iconSizeData,e,d);return this.tilePixelRatio*m}_commitDebugCollisionVertexUpdate(e,i,a){e.emplaceBack(i,-a,-a),e.emplaceBack(i,a,-a),e.emplaceBack(i,a,a),e.emplaceBack(i,-a,a)}_updateTextDebugCollisionBoxes(e,i,a,d,m,_){for(let w=d;w<m;w++){const T=a.get(w),M=this.getSymbolInstanceTextSize(e,_,i,w);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,M,T.padding)}}_updateIconDebugCollisionBoxes(e,i,a,d,m,_){for(let w=d;w<m;w++){const T=a.get(w),M=this.getSymbolInstanceIconSize(e,i,_);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,M,T.padding)}}updateCollisionDebugBuffers(e,i){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const a=Gu(this.iconSizeData,e),d=Gu(this.textSizeData,e);for(let m=0;m<this.symbolInstances.length;m++){const _=this.symbolInstances.get(m);this._updateTextDebugCollisionBoxes(d,e,i,_.textBoxStartIndex,_.textBoxEndIndex,_),this._updateTextDebugCollisionBoxes(d,e,i,_.verticalTextBoxStartIndex,_.verticalTextBoxEndIndex,_),this._updateIconDebugCollisionBoxes(a,e,i,_.iconBoxStartIndex,_.iconBoxEndIndex,_.placedIconSymbolIndex),this._updateIconDebugCollisionBoxes(a,e,i,_.verticalIconBoxStartIndex,_.verticalIconBoxEndIndex,_.placedIconSymbolIndex)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(e,i,a,d,m,_,w,T,M){const L={};for(let z=i;z<a;z++){const V=e.get(z);L.textBox={x1:V.x1,y1:V.y1,x2:V.x2,y2:V.y2,padding:V.padding,projectedAnchorX:V.projectedAnchorX,projectedAnchorY:V.projectedAnchorY,projectedAnchorZ:V.projectedAnchorZ,tileAnchorX:V.tileAnchorX,tileAnchorY:V.tileAnchorY},L.textFeatureIndex=V.featureIndex;break}for(let z=d;z<m;z++){const V=e.get(z);L.verticalTextBox={x1:V.x1,y1:V.y1,x2:V.x2,y2:V.y2,padding:V.padding,projectedAnchorX:V.projectedAnchorX,projectedAnchorY:V.projectedAnchorY,projectedAnchorZ:V.projectedAnchorZ,tileAnchorX:V.tileAnchorX,tileAnchorY:V.tileAnchorY},L.verticalTextFeatureIndex=V.featureIndex;break}for(let z=_;z<w;z++){const V=e.get(z);L.iconBox={x1:V.x1,y1:V.y1,x2:V.x2,y2:V.y2,padding:V.padding,projectedAnchorX:V.projectedAnchorX,projectedAnchorY:V.projectedAnchorY,projectedAnchorZ:V.projectedAnchorZ,tileAnchorX:V.tileAnchorX,tileAnchorY:V.tileAnchorY},L.iconFeatureIndex=V.featureIndex;break}for(let z=T;z<M;z++){const V=e.get(z);L.verticalIconBox={x1:V.x1,y1:V.y1,x2:V.x2,y2:V.y2,padding:V.padding,projectedAnchorX:V.projectedAnchorX,projectedAnchorY:V.projectedAnchorY,projectedAnchorZ:V.projectedAnchorZ,tileAnchorX:V.tileAnchorX,tileAnchorY:V.tileAnchorY},L.verticalIconFeatureIndex=V.featureIndex;break}return L}deserializeCollisionBoxes(e){this.collisionArrays=[];for(let i=0;i<this.symbolInstances.length;i++){const a=this.symbolInstances.get(i);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,a.textBoxStartIndex,a.textBoxEndIndex,a.verticalTextBoxStartIndex,a.verticalTextBoxEndIndex,a.iconBoxStartIndex,a.iconBoxEndIndex,a.verticalIconBoxStartIndex,a.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(e,i){const a=e.placedSymbolArray.get(i),d=a.vertexStartIndex+4*a.numGlyphs;for(let m=a.vertexStartIndex;m<d;m+=4)e.indexArray.emplaceBack(m,m+1,m+2),e.indexArray.emplaceBack(m+1,m+2,m+3)}getSortedSymbolIndexes(e){if(this.sortedAngle===e&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;const i=Math.sin(e),a=Math.cos(e),d=[],m=[],_=[];for(let w=0;w<this.symbolInstances.length;++w){_.push(w);const T=this.symbolInstances.get(w);d.push(0|Math.round(i*T.tileAnchorX+a*T.tileAnchorY)),m.push(T.featureIndex)}return _.sort((w,T)=>d[w]-d[T]||m[T]-m[w]),_}addToSortKeyRanges(e,i){const a=this.sortKeyRanges[this.sortKeyRanges.length-1];a&&a.sortKey===i?a.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:i,symbolInstanceStart:e,symbolInstanceEnd:e+1})}sortFeatures(e){if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const i of this.symbolInstanceIndexes){const a=this.symbolInstances.get(i);this.featureSortOrder.push(a.featureIndex),[a.rightJustifiedTextSymbolIndex,a.centerJustifiedTextSymbolIndex,a.leftJustifiedTextSymbolIndex].forEach((d,m,_)=>{d>=0&&_.indexOf(d)===m&&this.addIndicesForPlacedSymbol(this.text,d)}),a.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,a.verticalPlacedTextSymbolIndex),a.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,a.placedIconSymbolIndex),a.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,a.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}Jn(qc,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),qc.MAX_GLYPHS=65535,qc.addDynamicAttributes=Jd;const Ig=new Bn({"symbol-placement":new Kt(on.layout_symbol["symbol-placement"]),"symbol-spacing":new Kt(on.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Kt(on.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Nt(on.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Kt(on.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Kt(on.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Kt(on.layout_symbol["icon-ignore-placement"]),"icon-optional":new Kt(on.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Kt(on.layout_symbol["icon-rotation-alignment"]),"icon-size":new Nt(on.layout_symbol["icon-size"]),"icon-text-fit":new Kt(on.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Kt(on.layout_symbol["icon-text-fit-padding"]),"icon-image":new Nt(on.layout_symbol["icon-image"]),"icon-rotate":new Nt(on.layout_symbol["icon-rotate"]),"icon-padding":new Kt(on.layout_symbol["icon-padding"]),"icon-keep-upright":new Kt(on.layout_symbol["icon-keep-upright"]),"icon-offset":new Nt(on.layout_symbol["icon-offset"]),"icon-anchor":new Nt(on.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Kt(on.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Kt(on.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Kt(on.layout_symbol["text-rotation-alignment"]),"text-field":new Nt(on.layout_symbol["text-field"]),"text-font":new Nt(on.layout_symbol["text-font"]),"text-size":new Nt(on.layout_symbol["text-size"]),"text-max-width":new Nt(on.layout_symbol["text-max-width"]),"text-line-height":new Nt(on.layout_symbol["text-line-height"]),"text-letter-spacing":new Nt(on.layout_symbol["text-letter-spacing"]),"text-justify":new Nt(on.layout_symbol["text-justify"]),"text-radial-offset":new Nt(on.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Kt(on.layout_symbol["text-variable-anchor"]),"text-anchor":new Nt(on.layout_symbol["text-anchor"]),"text-max-angle":new Kt(on.layout_symbol["text-max-angle"]),"text-writing-mode":new Kt(on.layout_symbol["text-writing-mode"]),"text-rotate":new Nt(on.layout_symbol["text-rotate"]),"text-padding":new Kt(on.layout_symbol["text-padding"]),"text-keep-upright":new Kt(on.layout_symbol["text-keep-upright"]),"text-transform":new Nt(on.layout_symbol["text-transform"]),"text-offset":new Nt(on.layout_symbol["text-offset"]),"text-allow-overlap":new Kt(on.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Kt(on.layout_symbol["text-ignore-placement"]),"text-optional":new Kt(on.layout_symbol["text-optional"])});var Xd={paint:new Bn({"icon-opacity":new Nt(on.paint_symbol["icon-opacity"]),"icon-color":new Nt(on.paint_symbol["icon-color"]),"icon-halo-color":new Nt(on.paint_symbol["icon-halo-color"]),"icon-halo-width":new Nt(on.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Nt(on.paint_symbol["icon-halo-blur"]),"icon-translate":new Kt(on.paint_symbol["icon-translate"]),"icon-translate-anchor":new Kt(on.paint_symbol["icon-translate-anchor"]),"text-opacity":new Nt(on.paint_symbol["text-opacity"]),"text-color":new Nt(on.paint_symbol["text-color"],{runtimeType:Wn,getOverride:n=>n.textColor,hasOverride:n=>!!n.textColor}),"text-halo-color":new Nt(on.paint_symbol["text-halo-color"]),"text-halo-width":new Nt(on.paint_symbol["text-halo-width"]),"text-halo-blur":new Nt(on.paint_symbol["text-halo-blur"]),"text-translate":new Kt(on.paint_symbol["text-translate"]),"text-translate-anchor":new Kt(on.paint_symbol["text-translate-anchor"])}),layout:Ig};class tp{constructor(e){this.type=e.property.overrides?e.property.overrides.runtimeType:cr,this.defaultValue=e}evaluate(e){if(e.formattedSection){const i=this.defaultValue.property.overrides;if(i&&i.hasOverride(e.formattedSection))return i.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default}eachChild(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Jn(tp,"FormatSectionOverride",{omit:["defaultValue"]});class np extends Ls{constructor(e){super(e,Xd)}recalculate(e,i){super.recalculate(e,i),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const a=this.layout.get("text-writing-mode");if(a){const d=[];for(const m of a)d.indexOf(m)<0&&d.push(m);this.layout._values["text-writing-mode"]=d}else this.layout._values["text-writing-mode"]="point"===this.layout.get("symbol-placement")?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(e,i,a,d){const m=this.layout.get(e).evaluate(i,{},a,d),_=this._unevaluatedLayout._values[e];return _.isDataDriven()||dr(_.value)||!m?m:(w=i.properties,m.replace(/{([^{}]+)}/g,(M,L)=>L in w?String(w[L]):""));var w}createBucket(e){return new qc(e)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const e of Xd.paint.overridableProperties){if(!np.hasPaintOverride(this.layout,e))continue;const i=this.paint.get(e),a=new tp(i),d=new nr(a,i.property.specification);let m=null;m="constant"===i.value.kind||"source"===i.value.kind?new Sr("source",d):new gr("composite",d,i.value.zoomStops,i.value._interpolationType),this.paint._values[e]=new bn(i.property,m,i.parameters)}}_handleOverridablePaintPropertyUpdate(e,i,a){return!(!this.layout||i.isDataDriven()||a.isDataDriven())&&np.hasPaintOverride(this.layout,e)}static hasPaintOverride(e,i){const a=e.get("text-field"),d=Xd.paint.properties[i];let m=!1;const _=w=>{for(const T of w)if(d.overrides&&d.overrides.hasOverride(T))return void(m=!0)};if("constant"===a.value.kind&&a.value.value instanceof bo)_(a.value.value.sections);else if("source"===a.value.kind){const w=M=>{m||(M instanceof ra&&Dr(M.value)===$t?_(M.value.sections):M instanceof ao?_(M.sections):M.eachChild(w))},T=a.value;T._styleExpression&&w(T._styleExpression.expression)}return m}getProgramConfiguration(e){return new lc(this,e)}}var ip={paint:new Bn({"background-color":new Kt(on.paint_background["background-color"]),"background-pattern":new zn(on.paint_background["background-pattern"]),"background-opacity":new Kt(on.paint_background["background-opacity"])})},rp={paint:new Bn({"raster-opacity":new Kt(on.paint_raster["raster-opacity"]),"raster-hue-rotate":new Kt(on.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Kt(on.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Kt(on.paint_raster["raster-brightness-max"]),"raster-saturation":new Kt(on.paint_raster["raster-saturation"]),"raster-contrast":new Kt(on.paint_raster["raster-contrast"]),"raster-resampling":new Kt(on.paint_raster["raster-resampling"]),"raster-fade-duration":new Kt(on.paint_raster["raster-fade-duration"])})};class Af extends Ls{constructor(e){super(e,{}),this.implementation=e}is3D(){return"3d"===this.implementation.renderingMode}hasOffscreenPass(){return void 0!==this.implementation.prerender}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(e){this.implementation.onAdd&&this.implementation.onAdd(e,e.painter.context.gl)}onRemove(e){this.implementation.onRemove&&this.implementation.onRemove(e,e.painter.context.gl)}}var X_={paint:new Bn({"sky-type":new Kt(on.paint_sky["sky-type"]),"sky-atmosphere-sun":new Kt(on.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new Kt(on.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new Kt(on.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new Kt(on.paint_sky["sky-gradient-radius"]),"sky-gradient":new jn(on.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new Kt(on.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new Kt(on.paint_sky["sky-atmosphere-color"]),"sky-opacity":new Kt(on.paint_sky["sky-opacity"])})};function nd(n,e,i){const a=[0,0,1],d=Up([]);return bm(d,d,i?-ye(n)+Math.PI:ye(n)),xm(d,d,-ye(e)),zp(a,a,d),Gs(a,a)}const op={circle:class extends Ls{constructor(n){super(n,yd)}createBucket(n){return new Pp(n)}queryRadius(n){const e=n;return Ou("circle-radius",this,e)+Ou("circle-stroke-width",this,e)+xh(this.paint.get("circle-translate"))}queryIntersectsFeature(n,e,i,a,d,m,_,w){const T=gm(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),m.angle,n.pixelToTileUnitsFactor),M=this.paint.get("circle-radius").evaluate(e,i)+this.paint.get("circle-stroke-width").evaluate(e,i);return Fu(n,a,m,_,w,"map"===this.paint.get("circle-pitch-alignment"),"map"===this.paint.get("circle-pitch-scale"),T,M)}getProgramIds(){return["circle"]}getProgramConfiguration(n){return new lc(this,n)}},heatmap:class extends Ls{createBucket(n){return new Em(n)}constructor(n){super(n,Gp),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(n){"heatmap-color"===n&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Hp({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(n){return Ou("heatmap-radius",this,n)}queryIntersectsFeature(n,e,i,a,d,m,_,w){const T=this.paint.get("heatmap-radius").evaluate(e,i);return Fu(n,a,m,_,w,!0,!0,new te(0,0),T)}hasOffscreenPass(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility}getProgramIds(){return["heatmap","heatmapTexture"]}getProgramConfiguration(n){return new lc(this,n)}},hillshade:class extends Ls{constructor(n){super(n,Wp)}hasOffscreenPass(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility}getProgramIds(){return["hillshade","hillshadePrepare"]}},fill:class extends Ls{constructor(n){super(n,g_)}getProgramIds(){const n=this.paint.get("fill-pattern"),e=n&&n.constantOr(1),i=[e?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&i.push(e&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),i}getProgramConfiguration(n){return new lc(this,n)}recalculate(n,e){super.recalculate(n,e);const i=this.paint._values["fill-outline-color"];"constant"===i.value.kind&&void 0===i.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(n){return new Vu(n)}queryRadius(){return xh(this.paint.get("fill-translate"))}queryIntersectsFeature(n,e,i,a,d,m){return!n.queryGeometry.isAboveHorizon&&_h(mm(n.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),m.angle,n.pixelToTileUnitsFactor),a)}isTileClipped(){return!0}},"fill-extrusion":class extends Ls{constructor(n){super(n,Ki)}createBucket(n){return new Ad(n)}queryRadius(){return xh(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}getProgramConfiguration(n){return new lc(this,n)}queryIntersectsFeature(n,e,i,a,d,m,_,w,T){const M=gm(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),m.angle,n.pixelToTileUnitsFactor),L=this.paint.get("fill-extrusion-height").evaluate(e,i),z=this.paint.get("fill-extrusion-base").evaluate(e,i),V=[0,0],K=w&&m.elevation,ne=m.elevation?m.elevation.exaggeration():1,ge=n.tile.getBucket(this);if(K&&ge instanceof Ad){const ft=ge.centroidVertexArray,At=T+1;if(At<ft.length){const mt=ft.get(At);V[0]=mt.a_centroid_pos0,V[1]=mt.a_centroid_pos1}}if(0===V[0]&&1===V[1])return!1;"globe"===m.projection.name&&(a=$m([a],[new te(0,0),new te(Si,Si)],n.tileID.canonical).map(ft=>ft.polygon).flat());const ze=K?w:null,[rt,wt]=(At=a,mt=z,rn=L,en=M,mn=_,Pn=ze,sn=V,vn=ne,xn=m.center.lat,"globe"===(ft=m).projection.name?function(On,ln,$n,vi,Xn,oi,Hn,Ti,Li,zi,hr){const Fi=[],Xr=[],Zi=On.projection.upVectorScale(hr,On.center.lat,On.worldSize).metersToTile,Qi=[0,0,0,1],kr=[0,0,0,1],Gr=(Hr,Kr,yo,as)=>{Hr[0]=Kr,Hr[1]=yo,Hr[2]=as,Hr[3]=1},$r=jm();$n>0&&($n+=$r),vi+=$r;for(const Hr of ln){const Kr=[],yo=[];for(const as of Hr){const Pr=as.x+Xn.x,ko=as.y+Xn.y,Do=On.projection.projectTilePoint(Pr,ko,hr),yr=On.projection.upVector(hr,as.x,as.y);let oo=$n,Go=vi;if(Hn){const Or=Zm(Pr,ko,$n,vi,Hn,Ti,Li,zi);oo+=Or.base,Go+=Or.top}0!==$n?Gr(Qi,Do.x+yr[0]*Zi*oo,Do.y+yr[1]*Zi*oo,Do.z+yr[2]*Zi*oo):Gr(Qi,Do.x,Do.y,Do.z),Gr(kr,Do.x+yr[0]*Zi*Go,Do.y+yr[1]*Zi*Go,Do.z+yr[2]*Zi*Go),Fo(Qi,Qi,oi),Fo(kr,kr,oi),Kr.push(new lu(Qi[0],Qi[1],Qi[2])),yo.push(new lu(kr[0],kr[1],kr[2]))}Fi.push(Kr),Xr.push(yo)}return[Fi,Xr]}(ft,At,mt,rn,en,mn,Pn,sn,vn,xn,n.tileID.canonical):Pn?function(On,ln,$n,vi,Xn,oi,Hn,Ti,Li){const zi=[],hr=[],Fi=[0,0,0,1];for(const Xr of On){const Zi=[],Qi=[];for(const kr of Xr){const Gr=kr.x+vi.x,$r=kr.y+vi.y,Hr=Zm(Gr,$r,ln,$n,oi,Hn,Ti,Li);Fi[0]=Gr,Fi[1]=$r,Fi[2]=Hr.base,Fi[3]=1,su(Fi,Fi,Xn),Fi[3]=Math.max(Fi[3],1e-5);const Kr=new lu(Fi[0]/Fi[3],Fi[1]/Fi[3],Fi[2]/Fi[3]);Fi[0]=Gr,Fi[1]=$r,Fi[2]=Hr.top,Fi[3]=1,su(Fi,Fi,Xn),Fi[3]=Math.max(Fi[3],1e-5);const yo=new lu(Fi[0]/Fi[3],Fi[1]/Fi[3],Fi[2]/Fi[3]);Zi.push(Kr),Qi.push(yo)}zi.push(Zi),hr.push(Qi)}return[zi,hr]}(At,mt,rn,en,mn,Pn,sn,vn,xn):function(On,ln,$n,vi,Xn){const oi=[],Hn=[],Ti=Xn[8]*ln,Li=Xn[9]*ln,zi=Xn[10]*ln,hr=Xn[11]*ln,Fi=Xn[8]*$n,Xr=Xn[9]*$n,Zi=Xn[10]*$n,Qi=Xn[11]*$n;for(const kr of On){const Gr=[],$r=[];for(const Hr of kr){const Kr=Hr.x+vi.x,yo=Hr.y+vi.y,as=Xn[0]*Kr+Xn[4]*yo+Xn[12],Pr=Xn[1]*Kr+Xn[5]*yo+Xn[13],ko=Xn[2]*Kr+Xn[6]*yo+Xn[14],Do=Xn[3]*Kr+Xn[7]*yo+Xn[15],yr=as+Ti,oo=Pr+Li,Go=ko+zi,Or=Math.max(Do+hr,1e-5),vo=as+Fi,vs=Pr+Xr,Xo=ko+Zi,Ko=Math.max(Do+Qi,1e-5);Gr.push(new lu(yr/Or,oo/Or,Go/Or)),$r.push(new lu(vo/Ko,vs/Ko,Xo/Ko))}oi.push(Gr),Hn.push($r)}return[oi,Hn]}(At,mt,rn,en,mn)),it=n.queryGeometry;var ft,At,mt,rn,en,mn,Pn,sn,vn,xn;return function(ft,At,mt){let rn=1/0;_h(mt,At)&&(rn=af(mt,At[0]));for(let en=0;en<At.length;en++){const mn=At[en],Pn=ft[en];for(let sn=0;sn<mn.length-1;sn++){const vn=mn[sn],xn=[vn,mn[sn+1],Pn[sn+1],Pn[sn],vn];n_(mt,xn)&&(rn=Math.min(rn,af(mt,xn)))}}return rn!==1/0&&rn}(rt,wt,it.isPointQuery()?it.screenBounds:it.screenGeometry)}},line:class extends Ls{constructor(n){super(n,Wm),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(n){if("line-gradient"===n){const e=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=e._styleExpression&&e._styleExpression.expression instanceof Es,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(n,e){super.recalculate(n,e),this.paint._values["line-floorwidth"]=D_.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,n)}createBucket(n){return new Zu(n)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getProgramConfiguration(n){return new lc(this,n)}queryRadius(n){const e=n,i=I_(Ou("line-width",this,e),Ou("line-gap-width",this,e)),a=Ou("line-offset",this,e);return i/2+Math.abs(a)+xh(this.paint.get("line-translate"))}queryIntersectsFeature(n,e,i,a,d,m){if(n.queryGeometry.isAboveHorizon)return!1;const _=mm(n.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),m.angle,n.pixelToTileUnitsFactor),w=n.pixelToTileUnitsFactor/2*I_(this.paint.get("line-width").evaluate(e,i),this.paint.get("line-gap-width").evaluate(e,i)),T=this.paint.get("line-offset").evaluate(e,i);return T&&(a=function(M,L){const z=[],V=new te(0,0);for(let K=0;K<M.length;K++){const ne=M[K],ge=[];for(let ze=0;ze<ne.length;ze++){const rt=ne[ze-1],wt=ne[ze],it=ne[ze+1],ft=0===ze?V:wt.sub(rt)._unit()._perp(),At=ze===ne.length-1?V:it.sub(wt)._unit()._perp(),mt=ft._add(At)._unit();mt._mult(1/(mt.x*At.x+mt.y*At.y)),ge.push(mt._mult(L)._add(wt))}z.push(ge)}return z}(a,T*n.pixelToTileUnitsFactor)),function(M,L,z){for(let V=0;V<L.length;V++){const K=L[V];if(M.length>=3)for(let ne=0;ne<K.length;ne++)if(zc(M,K[ne]))return!0;if(r_(M,K,z))return!0}return!1}(_,a,w)}isTileClipped(){return!0}},symbol:np,background:class extends Ls{constructor(n){super(n,ip)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}},raster:class extends Ls{constructor(n){super(n,rp)}getProgramIds(){return["raster"]}},sky:class extends Ls{constructor(n){super(n,X_),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(n){"sky-gradient"===n?this._updateColorRamp():"sky-atmosphere-sun"!==n&&"sky-atmosphere-halo-color"!==n&&"sky-atmosphere-color"!==n&&"sky-atmosphere-sun-intensity"!==n||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=Hp({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(n){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const e=n.style.light.properties.get("position");return this._lightPosition.azimuthal!==e.azimuthal||this._lightPosition.polar!==e.polar}return!1}getCenter(n,e){if("atmosphere"===this.paint.get("sky-type")){const a=this.paint.get("sky-atmosphere-sun"),d=!a,m=n.style.light,_=m.properties.get("position");return d&&"viewport"===m.properties.get("anchor")&&wn("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),d?nd(_.azimuthal,90-_.polar,e):nd(a[0],90-a[1],e)}const i=this.paint.get("sky-gradient-center");return nd(i[0],90-i[1],e)}is3D(){return!1}isSky(){return!0}markSkyboxValid(n){this._skyboxInvalidated=!1,this._lightPosition=n.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const n=this.paint.get("sky-type");return"atmosphere"===n?["skyboxCapture","skybox"]:"gradient"===n?["skyboxGradient"]:null}}};class vu{constructor(e,i,a,d){this.context=e,this.format=a,this.texture=e.gl.createTexture(),this.update(i,d)}update(e,i,a){const{width:d,height:m}=e,{context:_}=this,{gl:w}=_,{HTMLImageElement:T,HTMLCanvasElement:M,HTMLVideoElement:L,ImageData:z,ImageBitmap:V}=Y;if(w.bindTexture(w.TEXTURE_2D,this.texture),_.pixelStoreUnpackFlipY.set(!1),_.pixelStoreUnpack.set(1),_.pixelStoreUnpackPremultiplyAlpha.set(this.format===w.RGBA&&(!i||!1!==i.premultiply)),a||this.size&&this.size[0]===d&&this.size[1]===m){const{x:K,y:ne}=a||{x:0,y:0};e instanceof T||e instanceof M||e instanceof L||e instanceof z||V&&e instanceof V?w.texSubImage2D(w.TEXTURE_2D,0,K,ne,w.RGBA,w.UNSIGNED_BYTE,e):w.texSubImage2D(w.TEXTURE_2D,0,K,ne,d,m,w.RGBA,w.UNSIGNED_BYTE,e.data)}else this.size=[d,m],e instanceof T||e instanceof M||e instanceof L||e instanceof z||V&&e instanceof V?w.texImage2D(w.TEXTURE_2D,0,this.format,this.format,w.UNSIGNED_BYTE,e):w.texImage2D(w.TEXTURE_2D,0,this.format,d,m,0,this.format,w.UNSIGNED_BYTE,e.data);this.useMipmap=Boolean(i&&i.useMipmap&&this.isSizePowerOfTwo()),this.useMipmap&&w.generateMipmap(w.TEXTURE_2D)}bind(e,i){const{context:a}=this,{gl:d}=a;d.bindTexture(d.TEXTURE_2D,this.texture),e!==this.filter&&(d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,e),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,this.useMipmap?e===d.NEAREST?d.NEAREST_MIPMAP_NEAREST:d.LINEAR_MIPMAP_NEAREST:e),this.filter=e),i!==this.wrap&&(d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,i),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,i),this.wrap=i)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:e}=this.context;e.deleteTexture(this.texture),this.texture=null}}class Mg{constructor(e){this._callback=e,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class Pf{constructor(){this.tasks={},this.taskQueue=[],ct(["process"],this),this.invoker=new Mg(this.process),this.nextId=0}add(e,i){const a=this.nextId++,d=function({type:m,isSymbolTile:_,zoom:w}){return w=w||0,"message"===m?0:"maybePrepare"!==m||_?"parseTile"!==m||_?"parseTile"===m&&_?300-w:"maybePrepare"===m&&_?400-w:500:200-w:100-w}(i);if(0===d){ut();try{e()}finally{}return{cancel:()=>{}}}return this.tasks[a]={fn:e,metadata:i,priority:d,id:a},this.taskQueue.push(a),this.invoker.trigger(),{cancel:()=>{delete this.tasks[a]}}}process(){ut();try{if(this.taskQueue=this.taskQueue.filter(a=>!!this.tasks[a]),!this.taskQueue.length)return;const e=this.pick();if(null===e)return;const i=this.tasks[e];if(delete this.tasks[e],this.taskQueue.length&&this.invoker.trigger(),!i)return;i.fn()}finally{}}pick(){let e=null,i=1/0;for(let d=0;d<this.taskQueue.length;d++){const m=this.tasks[this.taskQueue[d]];m.priority<i&&(i=m.priority,e=d)}if(null===e)return null;const a=this.taskQueue[e];return this.taskQueue.splice(e,1),a}remove(){this.invoker.remove()}}class Of{constructor(e){this._stringToNumber={},this._numberToString=[];for(let i=0;i<e.length;i++){const a=e[i];this._stringToNumber[a]=i,this._numberToString[i]=a}}encode(e){return this._stringToNumber[e]}decode(e){return this._numberToString[e]}}const Sg=["tile","layer","source","sourceLayer","state"];class sp{constructor(e,i,a,d,m){this.type="Feature",this._vectorTileFeature=e,this._z=i,this._x=a,this._y=d,this.properties=e.properties,this.id=m}get geometry(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(e){this._geometry=e}toJSON(){const e={type:"Feature",geometry:this.geometry,properties:this.properties};void 0!==this.id&&(e.id=this.id);for(const i of Sg)void 0!==this[i]&&(e[i]=this[i]);return e}}const vc=new Uint16Array(8184);for(let n=0;n<2046;n++){let e=n+2,i=0,a=0,d=0,m=0,_=0,w=0;for(1&e?d=m=_=32:i=a=w=32;(e>>=1)>1;){const M=i+d>>1,L=a+m>>1;1&e?(d=i,m=a,i=_,a=w):(i=d,a=m,d=_,m=w),_=M,w=L}const T=4*n;vc[T+0]=i,vc[T+1]=a,vc[T+2]=d,vc[T+3]=m}const Cl=new Uint16Array(2178),xc=new Uint8Array(1089),Kd=new Uint16Array(1089);function Ag(n){return 0===n?-.03125:32===n?.03125:0}var Rf=Nn([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);const Lf={type:2,extent:Si,loadGeometry:()=>[[new te(0,0),new te(8193,0),new te(8193,8193),new te(0,8193),new te(0,0)]]};class Qd{constructor(e,i,a,d,m){this.tileID=e,this.uid=Ft(),this.uses=0,this.tileSize=i,this.tileZoom=a,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=m,this.expiredRequestCount=0,this.state="loading",d&&d.transform&&(this.projection=d.transform.projection)}registerFadeDuration(e){const i=e+this.timeAdded;i<gi.now()||this.fadeEndTime&&i<this.fadeEndTime||(this.fadeEndTime=i)}wasRequested(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state}get tileTransform(){return this._tileTransform||(this._tileTransform=_c(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(e,i,a){if(this.unloadVectorData(),this.state="loaded",e){e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(d,m){const _={};if(!m)return _;for(const w of d){const T=w.layerIds.map(M=>m.getLayer(M)).filter(Boolean);if(0!==T.length){w.layers=T,w.stateDependentLayerIds&&(w.stateDependentLayers=w.stateDependentLayerIds.map(M=>T.filter(L=>L.id===M)[0]));for(const M of T)_[M.id]=w}}return _}(e.buckets,i.style),this.hasSymbolBuckets=!1;for(const d in this.buckets){const m=this.buckets[d];if(m instanceof qc){if(this.hasSymbolBuckets=!0,!a)break;m.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const d in this.buckets){const m=this.buckets[d];if(m instanceof qc&&m.hasRTLText){this.hasRTLText=!0,yt.isLoading()||yt.isLoaded()||"deferred"!==We()||gt();break}}this.queryPadding=0;for(const d in this.buckets){const m=this.buckets[d];this.queryPadding=Math.max(this.queryPadding,i.style.getLayer(d).queryRadius(m))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage),e.lineAtlas&&(this.lineAtlas=e.lineAtlas)}else this.collisionBoxArray=new fp}unloadVectorData(){if(this.hasData()){for(const e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(e){return this.buckets[e.id]}upload(e){for(const a in this.buckets){const d=this.buckets[a];d.uploadPending()&&d.upload(e)}const i=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new vu(e,this.imageAtlas.image,i.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new vu(e,this.glyphAtlasImage,i.ALPHA),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new vu(e,this.lineAtlas.image,i.ALPHA),this.lineAtlas.uploaded=!0)}prepare(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)}queryRenderedFeatures(e,i,a,d,m,_,w,T){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:d,pixelPosMatrix:w,transform:_,params:m,tileTransform:this.tileTransform},e,i,a):{}}querySourceFeatures(e,i){const a=this.latestFeatureIndex;if(!a||!a.rawTileData)return;const d=a.loadVTLayers(),m=i?i.sourceLayer:"",_=d._geojsonTileLayer||d[m];if(!_)return;const w=pa(i&&i.filter),{z:T,x:M,y:L}=this.tileID.canonical,z={z:T,x:M,y:L};for(let V=0;V<_.length;V++){const K=_.feature(V);if(w.needGeometry){const ze=uc(K,!0);if(!w.filter(new ot(this.tileID.overscaledZ),ze,this.tileID.canonical))continue}else if(!w.filter(new ot(this.tileID.overscaledZ),K))continue;const ne=a.getId(K,m),ge=new sp(K,T,M,L,ne);ge.tile=z,e.push(ge)}}hasData(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(e){const i=this.expirationTime;if(e.cacheControl){const a=jt(e.cacheControl);a["max-age"]&&(this.expirationTime=Date.now()+1e3*a["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){const a=Date.now();let d=!1;if(this.expirationTime>a)d=!1;else if(i)if(this.expirationTime<i)d=!0;else{const m=this.expirationTime-i;m?this.expirationTime=a+Math.max(m,3e4):d=!0}else d=!0;d?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)}setFeatureState(e,i){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||0===Object.keys(e).length||!i)return;const a=this.latestFeatureIndex.loadVTLayers(),d=i.style.listImages();for(const m in this.buckets){if(!i.style.hasLayer(m))continue;const _=this.buckets[m],w=_.layers[0].sourceLayer||"_geojsonTileLayer",T=a[w],M=e[w];if(!T||!M||0===Object.keys(M).length)continue;if(_.update(M,T,d,this.imageAtlas&&this.imageAtlas.patternPositions||{}),_ instanceof Zu||_ instanceof Vu){const z=i.style._getSourceCache(_.layers[0].source);i._terrain&&i._terrain.enabled&&z&&_.programConfigurations.needsUpload&&i._terrain._clearRenderCacheForTile(z.id,this.tileID)}const L=i&&i.style&&i.style.getLayer(m);L&&(this.queryPadding=Math.max(this.queryPadding,L.queryRadius(_)))}}holdingForFade(){return void 0!==this.symbolFadeHoldUntil}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<gi.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(e){this.symbolFadeHoldUntil=gi.now()+e}setTexture(e,i){const a=i.context,d=a.gl;this.texture=this.texture||i.getTileTexture(e.width),this.texture?this.texture.update(e,{useMipmap:!0}):(this.texture=new vu(a,e,d.RGBA,{useMipmap:!0}),this.texture.bind(d.LINEAR,d.CLAMP_TO_EDGE),a.extTextureFilterAnisotropic&&d.texParameterf(d.TEXTURE_2D,a.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,a.extTextureFilterAnisotropicMax))}setDependencies(e,i){const a={};for(const d of i)a[d]=!0;this.dependencies[e]=a}hasDependency(e,i){for(const a of e){const d=this.dependencies[a];if(d)for(const m of i)if(d[m])return!0}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(e,i){if(!i||"mercator"===i.name||this._tileDebugBuffer)return;const a=Ja(Lf,this.tileID.canonical,this.tileTransform)[0],d=new $i,m=new pd;for(let _=0;_<a.length;_++){const{x:w,y:T}=a[_];d.emplaceBack(w,T),m.emplaceBack(_)}m.emplaceBack(0),this._tileDebugIndexBuffer=e.createIndexBuffer(m),this._tileDebugBuffer=e.createVertexBuffer(d,fc.members),this._tileDebugSegments=Lo.simpleSegment(0,0,d.length,m.length)}_makeTileBoundsBuffers(e,i){if(this._tileBoundsBuffer||!i||"mercator"===i.name)return;const a=Ja(Lf,this.tileID.canonical,this.tileTransform)[0];let d,m;if(this.isRaster){const _=function(w,T){const M=_c(w,T),L=Math.pow(2,w.z);for(let ze=0;ze<33;ze++)for(let rt=0;rt<33;rt++){const wt=Zs((w.x+(rt+Ag(rt))/32)/L),it=os((w.y+(ze+Ag(ze))/32)/L),ft=T.project(wt,it),At=33*ze+rt;Cl[2*At+0]=Math.round((ft.x*M.scale-M.x)*Si),Cl[2*At+1]=Math.round((ft.y*M.scale-M.y)*Si)}xc.fill(0),Kd.fill(0);for(let ze=2045;ze>=0;ze--){const rt=4*ze,wt=vc[rt+0],it=vc[rt+1],ft=vc[rt+2],At=vc[rt+3],mt=wt+ft>>1,rn=it+At>>1,en=mt+rn-it,mn=rn+wt-mt,Pn=33*it+wt,sn=33*At+ft,vn=33*rn+mt,xn=Math.hypot((Cl[2*Pn+0]+Cl[2*sn+0])/2-Cl[2*vn+0],(Cl[2*Pn+1]+Cl[2*sn+1])/2-Cl[2*vn+1])>=16;if(xc[vn]=xc[vn]||(xn?1:0),ze<1022){const Sn=33*(it+mn>>1)+(wt+en>>1),On=33*(At+mn>>1)+(ft+en>>1);xc[vn]=xc[vn]||xc[Sn]||xc[On]}}const z=new Ir,V=new ys;let K=0;function ne(ze,rt){const wt=33*rt+ze;return 0===Kd[wt]&&(z.emplaceBack(Cl[2*wt+0],Cl[2*wt+1],ze*Si/32,rt*Si/32),Kd[wt]=++K),Kd[wt]-1}function ge(ze,rt,wt,it,ft,At){const mt=ze+wt>>1,rn=rt+it>>1;if(Math.abs(ze-ft)+Math.abs(rt-At)>1&&xc[33*rn+mt])ge(ft,At,ze,rt,mt,rn),ge(wt,it,ft,At,mt,rn);else{const en=ne(ze,rt),mn=ne(wt,it),Pn=ne(ft,At);V.emplaceBack(en,mn,Pn)}}return ge(0,0,32,32,32,0),ge(32,32,0,0,0,32),{vertices:z,indices:V}}(this.tileID.canonical,i);d=_.vertices,m=_.indices}else{d=new Ir,m=new ys;for(const{x:w,y:T}of a)d.emplaceBack(w,T,0,0);const _=_l.exports(d.int16,void 0,4);for(let w=0;w<_.length;w+=3)m.emplaceBack(_[w],_[w+1],_[w+2])}this._tileBoundsBuffer=e.createVertexBuffer(d,Rf.members),this._tileBoundsIndexBuffer=e.createIndexBuffer(m),this._tileBoundsSegments=Lo.simpleSegment(0,0,d.length,m.length)}_makeGlobeTileDebugBuffers(e,i){const a=i.projection;if(!a||"globe"!==a.name||i.freezeTileCoverage)return;const d=this.tileID.canonical,m=Gd(Kh(d,i)),_=gc(i.zoom);let w;_>0&&(w=_m(new Float64Array(16),i.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(e,d,i,m,w,_),this._makeGlobeTileDebugTextBuffer(e,d,i,m,w,_)}_globePoint(e,i,a,d,m,_,w){let T=$d(e,i,a);if(_){const M=1<<a.z,L=qa(d.center.lng),z=fl(d.center.lat),V=(a.x+.5)/M-L;let K=0;V>.5?K=-1:V<-.5&&(K=1);let ne=(e/Si+a.x)/M+K,ge=(i/Si+a.y)/M;ne=(ne-L)*d._pixelsPerMercatorPixel+L,ge=(ge-z)*d._pixelsPerMercatorPixel+z;const ze=[ne*d.worldSize,ge*d.worldSize,0];Fo(ze,ze,_),T=mu(T,ze,w)}return Fo(T,T,m)}_makeGlobeTileDebugBorderBuffer(e,i,a,d,m,_){const w=new $i,T=new pd,M=new Lr,L=(V,K,ne,ge,ze)=>{const rt=(ne-V)/(ze-1),wt=(ge-K)/(ze-1),it=w.length;for(let ft=0;ft<ze;ft++){const At=V+ft*rt,mt=K+ft*wt;w.emplaceBack(At,mt);const rn=this._globePoint(At,mt,i,a,d,m,_);M.emplaceBack(rn[0],rn[1],rn[2]),T.emplaceBack(it+ft)}},z=Si;L(0,0,z,0,16),L(z,0,z,z,16),L(z,z,0,z,16),L(0,z,0,0,16),this._tileDebugIndexBuffer=e.createIndexBuffer(T),this._tileDebugBuffer=e.createVertexBuffer(w,fc.members),this._globeTileDebugBorderBuffer=e.createVertexBuffer(M,_g.members),this._tileDebugSegments=Lo.simpleSegment(0,0,w.length,T.length)}_makeGlobeTileDebugTextBuffer(e,i,a,d,m,_){const w=new $i,T=new ys,M=new Lr,L=25;T.reserve(32),w.reserve(L),M.reserve(L);const z=(V,K)=>L*V+K;for(let V=0;V<L;V++){const K=2048*V;for(let ne=0;ne<L;ne++){const ge=2048*ne;w.emplaceBack(ge,K);const ze=this._globePoint(ge,K,i,a,d,m,_);M.emplaceBack(ze[0],ze[1],ze[2])}}for(let V=0;V<4;V++)for(let K=0;K<4;K++){const ne=z(V,K),ge=z(V,K+1),ze=z(V+1,K),rt=z(V+1,K+1);T.emplaceBack(ne,ge,ze),T.emplaceBack(ze,ge,rt)}this._tileDebugTextIndexBuffer=e.createIndexBuffer(T),this._tileDebugTextBuffer=e.createVertexBuffer(w,fc.members),this._globeTileDebugTextBuffer=e.createVertexBuffer(M,_g.members),this._tileDebugTextSegments=Lo.simpleSegment(0,0,L,32)}}class Ff{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(e,i,a){const d=String(i);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][d]=this.stateChanges[e][d]||{},Et(this.stateChanges[e][d],a),null===this.deletedStates[e]){this.deletedStates[e]={};for(const m in this.state[e])m!==d&&(this.deletedStates[e][m]=null)}else if(this.deletedStates[e]&&null===this.deletedStates[e][d]){this.deletedStates[e][d]={};for(const m in this.state[e][d])a[m]||(this.deletedStates[e][d][m]=null)}else for(const m in a)this.deletedStates[e]&&this.deletedStates[e][d]&&null===this.deletedStates[e][d][m]&&delete this.deletedStates[e][d][m]}removeFeatureState(e,i,a){if(null===this.deletedStates[e])return;const d=String(i);if(this.deletedStates[e]=this.deletedStates[e]||{},a&&void 0!==i)null!==this.deletedStates[e][d]&&(this.deletedStates[e][d]=this.deletedStates[e][d]||{},this.deletedStates[e][d][a]=null);else if(void 0!==i)if(this.stateChanges[e]&&this.stateChanges[e][d])for(a in this.deletedStates[e][d]={},this.stateChanges[e][d])this.deletedStates[e][d][a]=null;else this.deletedStates[e][d]=null;else this.deletedStates[e]=null}getState(e,i){const a=String(i),d=Et({},(this.state[e]||{})[a],(this.stateChanges[e]||{})[a]);if(null===this.deletedStates[e])return{};if(this.deletedStates[e]){const m=this.deletedStates[e][i];if(null===m)return{};for(const _ in m)delete d[_]}return d}initializeTileState(e,i){e.setFeatureState(this.state,i)}coalesceChanges(e,i){const a={};for(const d in this.stateChanges){this.state[d]=this.state[d]||{};const m={};for(const _ in this.stateChanges[d])this.state[d][_]||(this.state[d][_]={}),Et(this.state[d][_],this.stateChanges[d][_]),m[_]=this.state[d][_];a[d]=m}for(const d in this.deletedStates){this.state[d]=this.state[d]||{};const m={};if(null===this.deletedStates[d])for(const _ in this.state[d])m[_]={},this.state[d][_]={};else for(const _ in this.deletedStates[d]){if(null===this.deletedStates[d][_])this.state[d][_]={};else for(const w of Object.keys(this.deletedStates[d][_]))delete this.state[d][_][w];m[_]=this.state[d][_]}a[d]=a[d]||{},Et(a[d],m)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(a).length)for(const d in e)e[d].setFeatureState(a,i)}}class kf{constructor(e){this.size=e,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(e,i){const a=this.toIdx(e,i);return{min:this.minimums[a],max:this.maximums[a]}}isLeaf(e,i){return this.leaves[this.toIdx(e,i)]}toIdx(e,i){return i*this.size+e}}function Bf(n,e,i,a){let d=0,m=Number.MAX_VALUE;for(let _=0;_<3;_++)if(Math.abs(a[_])<1e-15){if(i[_]<n[_]||i[_]>e[_])return null}else{const w=1/a[_];let T=(n[_]-i[_])*w,M=(e[_]-i[_])*w;if(T>M){const L=T;T=M,M=L}if(T>d&&(d=T),M<m&&(m=M),d>m)return null}return d}function zf(n,e,i,a,d,m,_,w,T,M,L){const z=a-n,V=d-e,K=m-i,ne=_-n,ge=w-e,ze=T-i,rt=L[1]*ze-L[2]*ge,wt=L[2]*ne-L[0]*ze,it=L[0]*ge-L[1]*ne,ft=z*rt+V*wt+K*it;if(Math.abs(ft)<1e-15)return null;const At=1/ft,mt=M[0]-n,rn=M[1]-e,en=M[2]-i,mn=(mt*rt+rn*wt+en*it)*At;if(mn<0||mn>1)return null;const Pn=rn*K-en*V,sn=en*z-mt*K,vn=mt*V-rn*z,xn=(L[0]*Pn+L[1]*sn+L[2]*vn)*At;return xn<0||mn+xn>1?null:(ne*Pn+ge*sn+ze*vn)*At}function Nf(n,e,i){return(n-e)/(i-e)}function Uf(n,e,i,a,d,m,_,w,T){const M=1<<i,L=m-a,z=_-d,V=(n+1)/M*L+a,K=(e+0)/M*z+d,ne=(e+1)/M*z+d;w[0]=(n+0)/M*L+a,w[1]=K,T[0]=V,T[1]=ne}class Vf{constructor(e){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=e,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const i=function(m){const _=Math.ceil(Math.log2(m.dim/8)),w=[];let T=Math.ceil(Math.pow(2,_));const M=1/T,L=(K,ne,ge,ze,rt)=>{const wt=ze?1:0,it=(K+1)*ge-wt,ft=ne*ge,At=(ne+1)*ge-wt;rt[0]=K*ge,rt[1]=ft,rt[2]=it,rt[3]=At};let z=new kf(T);const V=[];for(let K=0;K<T*T;K++){L(K%T,Math.floor(K/T),M,!1,V);const ne=bc(V[0],V[1],m),ge=bc(V[2],V[1],m),ze=bc(V[2],V[3],m),rt=bc(V[0],V[3],m);z.minimums.push(Math.min(ne,ge,ze,rt)),z.maximums.push(Math.max(ne,ge,ze,rt)),z.leaves.push(1)}for(w.push(z),T/=2;T>=1;T/=2){const K=w[w.length-1];z=new kf(T);for(let ne=0;ne<T*T;ne++){L(ne%T,Math.floor(ne/T),2,!0,V);const ge=K.getElevation(V[0],V[1]),ze=K.getElevation(V[2],V[1]),rt=K.getElevation(V[2],V[3]),wt=K.getElevation(V[0],V[3]),it=K.isLeaf(V[0],V[1]),ft=K.isLeaf(V[2],V[1]),At=K.isLeaf(V[2],V[3]),mt=K.isLeaf(V[0],V[3]),rn=Math.min(ge.min,ze.min,rt.min,wt.min),en=Math.max(ge.max,ze.max,rt.max,wt.max),mn=it&&ft&&At&&mt;z.maximums.push(en),z.minimums.push(rn),z.leaves.push(en-rn<=5&&mn?1:0)}w.push(z)}return w}(this.dem),a=i.length-1,d=i[a];this._addNode(d.minimums[0],d.maximums[0],d.leaves[0]),this._construct(i,0,0,a,0)}raycastRoot(e,i,a,d,m,_,w=1){return Bf([e,i,-100],[a,d,this.maximums[0]*w],m,_)}raycast(e,i,a,d,m,_,w=1){if(!this.nodeCount)return null;const T=this.raycastRoot(e,i,a,d,m,_,w);if(null==T)return null;const M=[],L=[],z=[],V=[],K=[{idx:0,t:T,nodex:0,nodey:0,depth:0}];for(;K.length>0;){const{idx:ne,t:ge,nodex:ze,nodey:rt,depth:wt}=K.pop();if(this.leaves[ne]){Uf(ze,rt,wt,e,i,a,d,z,V);const ft=1<<wt,At=(ze+0)/ft,mt=(ze+1)/ft,rn=(rt+0)/ft,en=(rt+1)/ft,mn=bc(At,rn,this.dem)*w,Pn=bc(mt,rn,this.dem)*w,sn=bc(mt,en,this.dem)*w,vn=bc(At,en,this.dem)*w,xn=zf(z[0],z[1],mn,V[0],z[1],Pn,V[0],V[1],sn,m,_),Sn=zf(V[0],V[1],sn,z[0],V[1],vn,z[0],z[1],mn,m,_),On=Math.min(null!==xn?xn:Number.MAX_VALUE,null!==Sn?Sn:Number.MAX_VALUE);if(On!==Number.MAX_VALUE)return On;{const ln=Lu([],m,_,ge);if(jf(mn,Pn,vn,sn,Nf(ln[0],z[0],V[0]),Nf(ln[1],z[1],V[1]))>=ln[2])return ge}continue}let it=0;for(let ft=0;ft<this._siblingOffset.length;ft++){Uf((ze<<1)+this._siblingOffset[ft][0],(rt<<1)+this._siblingOffset[ft][1],wt+1,e,i,a,d,z,V),z[2]=-100,V[2]=this.maximums[this.childOffsets[ne]+ft]*w;const At=Bf(z,V,m,_);if(null!=At){const mt=At;M[ft]=mt;let rn=!1;for(let en=0;en<it&&!rn;en++)mt>=M[L[en]]&&(L.splice(en,0,ft),rn=!0);rn||(L[it]=ft),it++}}for(let ft=0;ft<it;ft++){const At=L[ft];K.push({idx:this.childOffsets[ne]+At,t:M[At],nodex:(ze<<1)+this._siblingOffset[At][0],nodey:(rt<<1)+this._siblingOffset[At][1],depth:wt+1})}}return null}_addNode(e,i,a){return this.minimums.push(e),this.maximums.push(i),this.leaves.push(a),this.childOffsets.push(0),this.nodeCount++}_construct(e,i,a,d,m){if(1===e[d].isLeaf(i,a))return;this.childOffsets[m]||(this.childOffsets[m]=this.nodeCount);const _=d-1,w=e[_];let T=0,M=0;for(let L=0;L<this._siblingOffset.length;L++){const z=2*i+this._siblingOffset[L][0],V=2*a+this._siblingOffset[L][1],K=w.getElevation(z,V),ne=w.isLeaf(z,V),ge=this._addNode(K.min,K.max,ne);ne&&(T|=1<<L),M||(M=ge)}for(let L=0;L<this._siblingOffset.length;L++)T&1<<L||this._construct(e,2*i+this._siblingOffset[L][0],2*a+this._siblingOffset[L][1],_,M+L)}}function jf(n,e,i,a,d,m){return ji(ji(n,i,m),ji(e,a,m),d)}function bc(n,e,i){const a=i.dim,d=_e(n*a-.5,0,a-1),m=_e(e*a-.5,0,a-1),_=Math.floor(d),w=Math.floor(m),T=Math.min(_+1,a-1),M=Math.min(w+1,a-1);return jf(i.get(_,w),i.get(T,w),i.get(_,M),i.get(T,M),d-_,m-w)}const eh={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};class Tl{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(e,i,a,d=!1,m=!1){if(this.uid=e,i.height!==i.width)throw new RangeError("DEM tiles must be square");if(a&&"mapbox"!==a&&"terrarium"!==a)return wn(`"${a}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=i.height;const _=this.dim=i.height-2,w=new Uint32Array(i.data.buffer);if(this.pixels=new Uint8Array(i.data.buffer),this.encoding=a||"mapbox",this.borderReady=d,!d){for(let T=0;T<_;T++)w[this._idx(-1,T)]=w[this._idx(0,T)],w[this._idx(_,T)]=w[this._idx(_-1,T)],w[this._idx(T,-1)]=w[this._idx(T,0)],w[this._idx(T,_)]=w[this._idx(T,_-1)];w[this._idx(-1,-1)]=w[this._idx(0,0)],w[this._idx(_,-1)]=w[this._idx(_-1,0)],w[this._idx(-1,_)]=w[this._idx(0,_-1)],w[this._idx(_,_)]=w[this._idx(_-1,_-1)],m&&this._buildQuadTree()}}_buildQuadTree(){this._tree=new Vf(this)}get(e,i,a=!1){a&&(e=_e(e,-1,this.dim),i=_e(i,-1,this.dim));const d=4*this._idx(e,i);return("terrarium"===this.encoding?this._unpackTerrarium:this._unpackMapbox)(this.pixels[d],this.pixels[d+1],this.pixels[d+2])}static getUnpackVector(e){return eh[e]}get unpackVector(){return eh[this.encoding]}_idx(e,i){if(e<-1||e>=this.dim+1||i<-1||i>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(i+1)*this.stride+(e+1)}_unpackMapbox(e,i,a){return(256*e*256+256*i+a)/10-1e4}_unpackTerrarium(e,i,a){return 256*e+i+a/256-32768}static pack(e,i){const a=[0,0,0,0],d=Tl.getUnpackVector(i);let m=Math.floor((e+d[3])/d[2]);return a[2]=m%256,m=Math.floor(m/256),a[1]=m%256,m=Math.floor(m/256),a[0]=m,a}getPixels(){return new Pa({width:this.stride,height:this.stride},this.pixels)}backfillBorder(e,i,a){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");let d=i*this.dim,m=i*this.dim+this.dim,_=a*this.dim,w=a*this.dim+this.dim;switch(i){case-1:d=m-1;break;case 1:m=d+1}switch(a){case-1:_=w-1;break;case 1:w=_+1}const T=-i*this.dim,M=-a*this.dim;for(let L=_;L<w;L++)for(let z=d;z<m;z++){const V=4*this._idx(z,L),K=4*this._idx(z+T,L+M);this.pixels[V+0]=e.pixels[K+0],this.pixels[V+1]=e.pixels[K+1],this.pixels[V+2]=e.pixels[K+2],this.pixels[V+3]=e.pixels[K+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}Jn(Tl,"DEMData"),Jn(Vf,"DemMinMaxQuadTree",{omit:["dem"]});class K_{constructor(e,i){this.max=e,this.onRemove=i,this.reset()}reset(){for(const e in this.data)for(const i of this.data[e])i.timeout&&clearTimeout(i.timeout),this.onRemove(i.value);return this.data={},this.order=[],this}add(e,i,a){const d=e.wrapped().key;void 0===this.data[d]&&(this.data[d]=[]);const m={value:i,timeout:void 0};if(void 0!==a&&(m.timeout=setTimeout(()=>{this.remove(e,m)},a)),this.data[d].push(m),this.order.push(d),this.order.length>this.max){const _=this._getAndRemoveByKey(this.order[0]);_&&this.onRemove(_)}return this}has(e){return e.wrapped().key in this.data}getAndRemove(e){return this.has(e)?this._getAndRemoveByKey(e.wrapped().key):null}_getAndRemoveByKey(e){const i=this.data[e].shift();return i.timeout&&clearTimeout(i.timeout),0===this.data[e].length&&delete this.data[e],this.order.splice(this.order.indexOf(e),1),i.value}getByKey(e){const i=this.data[e];return i?i[0].value:null}get(e){return this.has(e)?this.data[e.wrapped().key][0].value:null}remove(e,i){if(!this.has(e))return this;const a=e.wrapped().key,d=void 0===i?0:this.data[a].indexOf(i),m=this.data[a][d];return this.data[a].splice(d,1),m.timeout&&clearTimeout(m.timeout),0===this.data[a].length&&delete this.data[a],this.onRemove(m.value),this.order.splice(this.order.indexOf(a),1),this}setMaxSize(e){for(this.max=e;this.order.length>this.max;){const i=this._getAndRemoveByKey(this.order[0]);i&&this.onRemove(i)}return this}filter(e){const i=[];for(const a in this.data)for(const d of this.data[a])e(d.value)||i.push(d);for(const a of i)this.remove(a.value.tileID,a)}}class id{constructor(e,i,a){this.func=e,this.mask=i,this.range=a}}id.ReadOnly=!1,id.ReadWrite=!0,id.disabled=new id(519,id.ReadOnly,[0,1]);class wc{constructor(e,i,a,d,m,_){this.test=e,this.ref=i,this.mask=a,this.fail=d,this.depthFail=m,this.pass=_}}wc.disabled=new wc({func:519,mask:0},0,0,7680,7680,7680);class tl{constructor(e,i,a){this.blendFunction=e,this.blendColor=i,this.mask=a}}tl.Replace=[1,0],tl.disabled=new tl(tl.Replace,fr.transparent,[!1,!1,!1,!1]),tl.unblended=new tl(tl.Replace,fr.transparent,[!0,!0,!0,!0]),tl.alphaBlended=new tl([1,771],fr.transparent,[!0,!0,!0,!0]);class $l{constructor(e,i,a){this.enable=e,this.mode=i,this.frontFace=a}}$l.disabled=new $l(!1,1029,2305),$l.backCCW=new $l(!0,1029,2305),$l.backCW=new $l(!0,1029,2304),$l.frontCW=new $l(!0,1028,2304),$l.frontCCW=new $l(!0,1028,2305);class rd extends Cr{constructor(e,i,a){super(),this.id=e,this._onlySymbols=a,i.on("data",d=>{"source"===d.dataType&&"metadata"===d.sourceDataType&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&"source"===d.dataType&&"content"===d.sourceDataType&&(this.reload(),this.transform&&this.update(this.transform))}),i.on("error",()=>{this._sourceErrored=!0}),this._source=i,this._tiles={},this._cache=new K_(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=i.minTileCacheSize,this._maxTileCacheSize=i.maxTileCacheSize,this._loadedParentTiles={},this._coveredTiles={},this._state=new Ff,this._isRaster="raster"===this._source.type||"raster-dem"===this._source.type||"custom"===this._source.type&&"raster"===this._source._dataType}onAdd(e){this.map=e,this._minTileCacheSize=void 0===this._minTileCacheSize&&e?e._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=void 0===this._maxTileCacheSize&&e?e._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const e in this._tiles){const i=this._tiles[e];if("loaded"!==i.state&&"errored"!==i.state)return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const e=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,e&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(e,i){return e.isSymbolTile=this._onlySymbols,this._source.loadTile(e,i)}_unloadTile(e){if(this._source.unloadTile)return this._source.unloadTile(e,()=>{})}_abortTile(e){if(this._source.abortTile)return this._source.abortTile(e,()=>{})}serialize(){return this._source.serialize()}prepare(e){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const i in this._tiles){const a=this._tiles[i];a.upload(e),a.prepare(this.map.style.imageManager)}}getIds(){return vt(this._tiles).map(e=>e.tileID).sort(Pg).map(e=>e.key)}getRenderableIds(e){const i=[];for(const a in this._tiles)this._isIdRenderable(+a,e)&&i.push(this._tiles[a]);return e?i.sort((a,d)=>{const m=a.tileID,_=d.tileID,w=new te(m.canonical.x,m.canonical.y)._rotate(this.transform.angle),T=new te(_.canonical.x,_.canonical.y)._rotate(this.transform.angle);return m.overscaledZ-_.overscaledZ||T.y-w.y||T.x-w.x}).map(a=>a.tileID.key):i.map(a=>a.tileID).sort(Pg).map(a=>a.key)}hasRenderableParent(e){const i=this.findLoadedParent(e,0);return!!i&&this._isIdRenderable(i.tileID.key)}_isIdRenderable(e,i){return this._tiles[e]&&this._tiles[e].hasData()&&!this._coveredTiles[e]&&(i||!this._tiles[e].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const e in this._tiles)"errored"!==this._tiles[e].state&&this._reloadTile(+e,"reloading")}}_reloadTile(e,i){const a=this._tiles[e];a&&("loading"!==a.state&&(a.state=i),this._loadTile(a,this._tileLoaded.bind(this,a,e,i)))}_tileLoaded(e,i,a,d){if(d)if(e.state="errored",404!==d.status)this._source.fire(new Qr(d,{tile:e}));else if("raster-dem"===this._source.type&&this.usedForTerrain&&this.map.painter.terrain){const m=this.map.painter.terrain;this.update(this.transform,m.getScaledDemTileSize(),!0),m.resetTileLookupCache(this.id)}else this.update(this.transform);else e.timeAdded=gi.now(),"expired"===a&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(i,e),"raster-dem"===this._source.type&&e.dem&&this._backfillDEM(e),this._state.initializeTileState(e,this.map?this.map.painter:null),this._source.fire(new Bi("data",{dataType:"source",tile:e,coord:e.tileID,sourceCacheId:this.id}))}_backfillDEM(e){const i=this.getRenderableIds();for(let d=0;d<i.length;d++){const m=i[d];if(e.neighboringTiles&&e.neighboringTiles[m]){const _=this.getTileByID(m);a(e,_),a(_,e)}}function a(d,m){if(!d.dem||d.dem.borderReady)return;d.needsHillshadePrepare=!0,d.needsDEMTextureUpload=!0;let _=m.tileID.canonical.x-d.tileID.canonical.x;const w=m.tileID.canonical.y-d.tileID.canonical.y,T=Math.pow(2,d.tileID.canonical.z),M=m.tileID.key;0===_&&0===w||Math.abs(w)>1||(Math.abs(_)>1&&(1===Math.abs(_+T)?_+=T:1===Math.abs(_-T)&&(_-=T)),m.dem&&d.dem&&(d.dem.backfillBorder(m.dem,_,w),d.neighboringTiles&&d.neighboringTiles[M]&&(d.neighboringTiles[M].backfilled=!0)))}}getTile(e){return this.getTileByID(e.key)}getTileByID(e){return this._tiles[e]}_retainLoadedChildren(e,i,a,d){for(const m in this._tiles){let _=this._tiles[m];if(d[m]||!_.hasData()||_.tileID.overscaledZ<=i||_.tileID.overscaledZ>a)continue;let w=_.tileID;for(;_&&_.tileID.overscaledZ>i+1;){const M=_.tileID.scaledTo(_.tileID.overscaledZ-1);_=this._tiles[M.key],_&&_.hasData()&&(w=M)}let T=w;for(;T.overscaledZ>i;)if(T=T.scaledTo(T.overscaledZ-1),e[T.key]){d[w.key]=w;break}}}findLoadedParent(e,i){if(e.key in this._loadedParentTiles){const a=this._loadedParentTiles[e.key];return a&&a.tileID.overscaledZ>=i?a:null}for(let a=e.overscaledZ-1;a>=i;a--){const d=e.scaledTo(a),m=this._getLoadedTile(d);if(m)return m}}_getLoadedTile(e){const i=this._tiles[e.key];return i&&i.hasData()?i:this._cache.getByKey(this._source.reparseOverscaled?e.wrapped().key:e.canonical.key)}updateCacheSize(e,i){i=i||this._source.tileSize;const a=Math.ceil(e.width/i)+1,d=Math.ceil(e.height/i)+1,m=Math.floor(a*d*5),_="number"==typeof this._minTileCacheSize?Math.max(this._minTileCacheSize,m):m,w="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,_):_;this._cache.setMaxSize(w)}handleWrapJump(e){const i=Math.round((e-(void 0===this._prevLng?e:this._prevLng))/360);if(this._prevLng=e,i){const a={};for(const d in this._tiles){const m=this._tiles[d];m.tileID=m.tileID.unwrapTo(m.tileID.wrap+i),a[m.tileID.key]=m}this._tiles=a;for(const d in this._timers)clearTimeout(this._timers[d]),delete this._timers[d];for(const d in this._tiles)this._setTileReloadTimer(+d,this._tiles[d])}}update(e,i,a){if(this.transform=e,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!a)return;let d;this.updateCacheSize(e,i),"globe"!==this.transform.projection.name&&this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?d=e.getVisibleUnwrappedCoordinates(this._source.tileID).map(w=>new Hs(w.canonical.z,w.wrap,w.canonical.z,w.canonical.x,w.canonical.y)):(d=e.coveringTiles({tileSize:i||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!a,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(d=d.filter(w=>this._source.hasTile(w)))):d=[];const m=this._updateRetainedTiles(d);if(Og(this._source.type)&&0!==d.length){const w={},T={},M=Object.keys(m);for(const z of M){const V=m[z],K=this._tiles[z];if(!K||K.fadeEndTime&&K.fadeEndTime<=gi.now())continue;const ne=this.findLoadedParent(V,Math.max(V.overscaledZ-rd.maxOverzooming,this._source.minzoom));ne&&(this._addTile(ne.tileID),w[ne.tileID.key]=ne.tileID),T[z]=V}const L=d[d.length-1].overscaledZ;for(const z in this._tiles){const V=this._tiles[z];if(m[z]||!V.hasData())continue;let K=V.tileID;for(;K.overscaledZ>L;){K=K.scaledTo(K.overscaledZ-1);const ne=this._tiles[K.key];if(ne&&ne.hasData()&&T[K.key]){m[z]=V.tileID;break}}}for(const z in w)m[z]||(this._coveredTiles[z]=!0,m[z]=w[z])}for(const w in m)this._tiles[w].clearFadeHold();const _=function(w,T){const M=[];for(const L in w)L in T||M.push(L);return M}(this._tiles,m);for(const w of _){const T=this._tiles[w];T.hasSymbolBuckets&&!T.holdingForFade()?T.setHoldDuration(this.map._fadeDuration):T.hasSymbolBuckets&&!T.symbolFadeFinished()||this._removeTile(+w)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const e in this._tiles)this._tiles[e].holdingForFade()&&this._removeTile(+e)}_updateRetainedTiles(e){const i={};if(0===e.length)return i;const a={},d=e.reduce((M,L)=>Math.min(M,L.overscaledZ),1/0),m=e[0].overscaledZ,_=Math.max(m-rd.maxOverzooming,this._source.minzoom),w=Math.max(m+rd.maxUnderzooming,this._source.minzoom),T={};for(const M of e){const L=this._addTile(M);i[M.key]=M,L.hasData()||d<this._source.maxzoom&&(T[M.key]=M)}this._retainLoadedChildren(T,d,w,i);for(const M of e){let L=this._tiles[M.key];if(L.hasData())continue;if(M.canonical.z>=this._source.maxzoom){const V=M.children(this._source.maxzoom)[0],K=this.getTile(V);if(K&&K.hasData()){i[V.key]=V;continue}}else{const V=M.children(this._source.maxzoom);if(i[V[0].key]&&i[V[1].key]&&i[V[2].key]&&i[V[3].key])continue}let z=L.wasRequested();for(let V=M.overscaledZ-1;V>=_;--V){const K=M.scaledTo(V);if(a[K.key]||(a[K.key]=!0,L=this.getTile(K),!L&&z&&(L=this._addTile(K)),L&&(i[K.key]=K,z=L.wasRequested(),L.hasData())))break}}return i}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const e in this._tiles){const i=[];let a,d=this._tiles[e].tileID;for(;d.overscaledZ>0;){if(d.key in this._loadedParentTiles){a=this._loadedParentTiles[d.key];break}i.push(d.key);const m=d.scaledTo(d.overscaledZ-1);if(a=this._getLoadedTile(m),a)break;d=m}for(const m of i)this._loadedParentTiles[m]=a}}_addTile(e){let i=this._tiles[e.key];if(i)return i;i=this._cache.getAndRemove(e),i&&(this._setTileReloadTimer(e.key,i),i.tileID=e,this._state.initializeTileState(i,this.map?this.map.painter:null),this._cacheTimers[e.key]&&(clearTimeout(this._cacheTimers[e.key]),delete this._cacheTimers[e.key],this._setTileReloadTimer(e.key,i)));const a=Boolean(i);if(!a){const d=this.map?this.map.painter:null;i=new Qd(e,this._source.tileSize*e.overscaleFactor(),this.transform.tileZoom,d,this._isRaster),this._loadTile(i,this._tileLoaded.bind(this,i,e.key,i.state))}return i?(i.uses++,this._tiles[e.key]=i,a||this._source.fire(new Bi("dataloading",{tile:i,coord:i.tileID,dataType:"source"})),i):null}_setTileReloadTimer(e,i){e in this._timers&&(clearTimeout(this._timers[e]),delete this._timers[e]);const a=i.getExpiryTimeout();a&&(this._timers[e]=setTimeout(()=>{this._reloadTile(e,"expired"),delete this._timers[e]},a))}_removeTile(e){const i=this._tiles[e];i&&(i.uses--,delete this._tiles[e],this._timers[e]&&(clearTimeout(this._timers[e]),delete this._timers[e]),i.uses>0||(i.hasData()&&"reloading"!==i.state?this._cache.add(i.tileID,i,i.getExpiryTimeout()):(i.aborted=!0,this._abortTile(i),this._unloadTile(i))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const e in this._tiles)this._removeTile(+e);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(e,i,a){const d=[],m=this.transform;if(!m)return d;const _="globe"===m.projection.name,w=qa(m.center.lng);for(const T in this._tiles){const M=this._tiles[T];if(a&&M.clearQueryDebugViz(),M.holdingForFade())continue;let L;if(_){const z=M.tileID.canonical;if(0===z.z){const V=[Math.abs(_e(w,...od(z,-1))-w),Math.abs(_e(w,...od(z,1))-w)];L=[0,2*V.indexOf(Math.min(...V))-1]}else{const V=[Math.abs(_e(w,...od(z,-1))-w),Math.abs(_e(w,...od(z,0))-w),Math.abs(_e(w,...od(z,1))-w)];L=[V.indexOf(Math.min(...V))-1]}}else L=[0];for(const z of L){const V=e.containsTile(M,m,i,z);V&&d.push(V)}}return d}getVisibleCoordinates(e){const i=this.getRenderableIds(e).map(a=>this._tiles[a].tileID);for(const a of i)a.projMatrix=this.transform.calculateProjMatrix(a.toUnwrapped());return i}hasTransition(){if(this._source.hasTransition())return!0;if(Og(this._source.type))for(const e in this._tiles){const i=this._tiles[e];if(void 0!==i.fadeEndTime&&i.fadeEndTime>=gi.now())return!0}return!1}setFeatureState(e,i,a){this._state.updateState(e=e||"_geojsonTileLayer",i,a)}removeFeatureState(e,i,a){this._state.removeFeatureState(e=e||"_geojsonTileLayer",i,a)}getFeatureState(e,i){return this._state.getState(e=e||"_geojsonTileLayer",i)}setDependencies(e,i,a){const d=this._tiles[e];d&&d.setDependencies(i,a)}reloadTilesForDependencies(e,i){for(const a in this._tiles)this._tiles[a].hasDependency(e,i)&&this._reloadTile(+a,"reloading");this._cache.filter(a=>!a.hasDependency(e,i))}_preloadTiles(e,i){const a=new Map,d=Array.isArray(e)?e:[e],m=this.map.painter.terrain,_=this.usedForTerrain&&m?m.getScaledDemTileSize():this._source.tileSize;for(const w of d){const T=w.coveringTiles({tileSize:_,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const M of T)a.set(M.key,M);this.usedForTerrain&&w.updateElevation(!1)}Ee(Array.from(a.values()),(w,T)=>{const M=new Qd(w,this._source.tileSize*w.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(M,L=>{"raster-dem"===this._source.type&&M.dem&&this._backfillDEM(M),T(L,M)})},i)}}function Pg(n,e){const i=Math.abs(2*n.wrap)-+(n.wrap<0),a=Math.abs(2*e.wrap)-+(e.wrap<0);return n.overscaledZ-e.overscaledZ||a-i||e.canonical.y-n.canonical.y||e.canonical.x-n.canonical.x}function Og(n){return"raster"===n||"image"===n||"video"===n||"custom"===n}function od(n,e){const i=1<<n.z;return[n.x/i+e,(n.x+1)/i+e]}rd.maxOverzooming=10,rd.maxUnderzooming=3;class ap{constructor(e,i,a){this._demTile=e,this._dem=this._demTile.dem,this._scale=i,this._offset=a}static create(e,i,a){const d=a||e.findDEMTileFor(i);if(!d||!d.dem)return;const m=d.dem,_=d.tileID,w=1<<i.canonical.z-_.canonical.z;return new ap(d,d.tileSize/Si/w,[(i.canonical.x/w-_.canonical.x)*m.dim,(i.canonical.y/w-_.canonical.y)*m.dim])}tileCoordToPixel(e,i){const a=i*this._scale+this._offset[1],d=Math.floor(e*this._scale+this._offset[0]),m=Math.floor(a);return new te(d,m)}getElevationAt(e,i,a,d){const m=e*this._scale+this._offset[0],_=i*this._scale+this._offset[1],w=Math.floor(m),T=Math.floor(_),M=this._dem;return d=!!d,a?ji(ji(M.get(w,T,d),M.get(w,T+1,d),_-T),ji(M.get(w+1,T,d),M.get(w+1,T+1,d),_-T),m-w):M.get(w,T,d)}getElevationAtPixel(e,i,a){return this._dem.get(e,i,!!a)}getMeterToDEM(e){return(1<<this._demTile.tileID.canonical.z)*ta(1,e)*this._dem.stride}}class Jo{constructor(e,i){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new As(Si,16,0),this.featureIndexArray=new _p,this.promoteId=i}insert(e,i,a,d,m,_=0){const w=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(a,d,m,_);const T=this.grid;for(let M=0;M<i.length;M++){const L=i[M],z=[1/0,1/0,-1/0,-1/0];for(let V=0;V<L.length;V++){const K=L[V];z[0]=Math.min(z[0],K.x),z[1]=Math.min(z[1],K.y),z[2]=Math.max(z[2],K.x),z[3]=Math.max(z[3],K.y)}z[0]<Si&&z[1]<Si&&z[2]>=0&&z[3]>=0&&T.insert(w,z[0],z[1],z[2],z[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new Bm(new kd(this.rawTileData)).layers,this.sourceLayerCoder=new Of(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const e in this.vtLayers)this.vtFeatures[e]=[]}return this.vtLayers}query(e,i,a,d){this.loadVTLayers();const m=e.params||{},_=pa(m.filter),w=e.tileResult,T=e.transform,M=w.bufferedTilespaceBounds,L=this.grid.query(M.min.x,M.min.y,M.max.x,M.max.y,(ne,ge,ze,rt)=>Lp(w.bufferedTilespaceGeometry,ne,ge,ze,rt));L.sort(Q_);let z=null;T.elevation&&L.length>0&&(z=ap.create(T.elevation,this.tileID));const V={};let K;for(let ne=0;ne<L.length;ne++){const ge=L[ne];if(ge===K)continue;K=ge;const ze=this.featureIndexArray.get(ge);let rt=null;this.loadMatchingFeature(V,ze,_,m.layers,m.availableImages,i,a,d,(wt,it,ft,At=0)=>(rt||(rt=Ja(wt,this.tileID.canonical,e.tileTransform)),it.queryIntersectsFeature(w,wt,ft,rt,this.z,e.transform,e.pixelPosMatrix,z,At)))}return V}loadMatchingFeature(e,i,a,d,m,_,w,T,M){const{featureIndex:L,bucketIndex:z,sourceLayerIndex:V,layoutVertexArrayOffset:K}=i,ne=this.bucketLayerIDs[z];if(d&&!function(wt,it){for(let ft=0;ft<wt.length;ft++)if(it.indexOf(wt[ft])>=0)return!0;return!1}(d,ne))return;const ge=this.sourceLayerCoder.decode(V),ze=this.vtLayers[ge].feature(L);if(a.needGeometry){const wt=uc(ze,!0);if(!a.filter(new ot(this.tileID.overscaledZ),wt,this.tileID.canonical))return}else if(!a.filter(new ot(this.tileID.overscaledZ),ze))return;const rt=this.getId(ze,ge);for(let wt=0;wt<ne.length;wt++){const it=ne[wt];if(d&&d.indexOf(it)<0)continue;const ft=_[it];if(!ft)continue;let At={};void 0!==rt&&T&&(At=T.getState(ft.sourceLayer||"_geojsonTileLayer",rt));const mt=Et({},w[it]);mt.paint=Zf(mt.paint,ft.paint,ze,At,m),mt.layout=Zf(mt.layout,ft.layout,ze,At,m);const rn=!M||M(ze,ft,At,K);if(!rn)continue;const en=new sp(ze,this.z,this.x,this.y,rt);en.layer=mt;let mn=e[it];void 0===mn&&(mn=e[it]=[]),mn.push({featureIndex:L,feature:en,intersectionZ:rn})}}lookupSymbolFeatures(e,i,a,d,m,_,w,T){const M={};this.loadVTLayers();const L=pa(m);for(const z of e)this.loadMatchingFeature(M,{bucketIndex:a,sourceLayerIndex:d,featureIndex:z,layoutVertexArrayOffset:0},L,_,w,T,i);return M}loadFeature(e){const{featureIndex:i,sourceLayerIndex:a}=e;this.loadVTLayers();const d=this.sourceLayerCoder.decode(a),m=this.vtFeatures[d];if(m[i])return m[i];const _=this.vtLayers[d].feature(i);return m[i]=_,_}hasLayer(e){for(const i of this.bucketLayerIDs)for(const a of i)if(e===a)return!0;return!1}getId(e,i){let a=e.id;if(this.promoteId){const d="string"==typeof this.promoteId?this.promoteId:this.promoteId[i];null!=d&&(a=e.properties[d]),"boolean"==typeof a&&(a=Number(a))}return a}}function Zf(n,e,i,a,d){return Ce(n,(m,_)=>{const w=e instanceof yn?e.get(_):null;return w&&w.evaluate?w.evaluate(i,a,d):w})}function Q_(n,e){return e-n}Jn(Jo,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});class Rg{constructor(e,i){this.width=e,this.height=i,this.nextRow=0,this.image=new gl({width:e,height:i}),this.positions={},this.uploaded=!1}getDash(e,i){const a=this.getKey(e,i);return this.positions[a]}trim(){const e=this.width,i=this.height=Pt(this.nextRow);this.image.resize({width:e,height:i})}getKey(e,i){return e.join(",")+i}getDashRanges(e,i,a){const d=[];let m=e.length%2==1?-e[e.length-1]*a:0,_=e[0]*a,w=!0;d.push({left:m,right:_,isDash:w,zeroLength:0===e[0]});let T=e[0];for(let M=1;M<e.length;M++){w=!w;const L=e[M];m=T*a,T+=L,_=T*a,d.push({left:m,right:_,isDash:w,zeroLength:0===L})}return d}addRoundDash(e,i,a){const d=i/2;for(let m=-a;m<=a;m++){const _=this.width*(this.nextRow+a+m);let w=0,T=e[w];for(let M=0;M<this.width;M++){M/T.right>1&&(T=e[++w]);const L=Math.abs(M-T.left),z=Math.abs(M-T.right),V=Math.min(L,z);let K;const ne=m/a*(d+1);if(T.isDash){const ge=d-Math.abs(ne);K=Math.sqrt(V*V+ge*ge)}else K=d-Math.sqrt(V*V+ne*ne);this.image.data[_+M]=Math.max(0,Math.min(255,K+128))}}}addRegularDash(e,i){for(let T=e.length-1;T>=0;--T){const M=e[T],L=e[T+1];M.zeroLength?e.splice(T,1):L&&L.isDash===M.isDash&&(L.left=M.left,e.splice(T,1))}const a=e[0],d=e[e.length-1];a.isDash===d.isDash&&(a.left=d.left-this.width,d.right=a.right+this.width);const m=this.width*this.nextRow;let _=0,w=e[_];for(let T=0;T<this.width;T++){T/w.right>1&&(w=e[++_]);const M=Math.abs(T-w.left),L=Math.abs(T-w.right),z=Math.min(M,L);this.image.data[m+T]=Math.max(0,Math.min(255,(w.isDash?z:-z)+i+128))}}addDash(e,i){const a=this.getKey(e,i);if(this.positions[a])return this.positions[a];const d="round"===i,m=d?7:0,_=2*m+1;if(this.nextRow+_>this.height)return wn("LineAtlas out of space"),null;0===e.length&&e.push(1);let w=0;for(let L=0;L<e.length;L++)e[L]<0&&(wn("Negative value is found in line dasharray, replacing values with 0"),e[L]=0),w+=e[L];if(0!==w){const L=this.width/w,z=this.getDashRanges(e,this.width,L);d?this.addRoundDash(z,L,m):this.addRegularDash(z,"square"===i?.5*L:0)}const T=this.nextRow+m;this.nextRow+=_;const M={tl:[T,m],br:[w,0]};return this.positions[a]=M,M}}Jn(Rg,"LineAtlas");class Gf{constructor(e){const i={},a=[];for(const w in e){const T=e[w],M=i[w]={};for(const L in T.glyphs){const z=T.glyphs[+L];if(!z||0===z.bitmap.width||0===z.bitmap.height)continue;const V=z.metrics.localGlyph?2:1,K={x:0,y:0,w:z.bitmap.width+2*V,h:z.bitmap.height+2*V};a.push(K),M[L]=K}}const{w:d,h:m}=zd(a),_=new gl({width:d||1,height:m||1});for(const w in e){const T=e[w];for(const M in T.glyphs){const L=T.glyphs[+M];if(!L||0===L.bitmap.width||0===L.bitmap.height)continue;const z=i[w][M],V=L.metrics.localGlyph?2:1;gl.copy(L.bitmap,_,{x:0,y:0},{x:z.x+V,y:z.y+V},L.bitmap)}}this.image=_,this.positions=i}}Jn(Gf,"GlyphAtlas");class ey{constructor(e){this.tileID=new Hs(e.tileID.overscaledZ,e.tileID.wrap,e.tileID.canonical.z,e.tileID.canonical.x,e.tileID.canonical.y),this.tileZoom=e.tileZoom,this.uid=e.uid,this.zoom=e.zoom,this.canonical=e.tileID.canonical,this.pixelRatio=e.pixelRatio,this.tileSize=e.tileSize,this.source=e.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=e.showCollisionBoxes,this.collectResourceTiming=!!e.collectResourceTiming,this.returnDependencies=!!e.returnDependencies,this.promoteId=e.promoteId,this.enableTerrain=!!e.enableTerrain,this.isSymbolTile=e.isSymbolTile,this.tileTransform=_c(e.tileID.canonical,e.projection),this.projection=e.projection}parse(e,i,a,d,m){this.status="parsing",this.data=e,this.collisionBoxArray=new fp;const _=new Of(Object.keys(e.layers).sort()),w=new Jo(this.tileID,this.promoteId);w.bucketLayerIDs=[];const T={},M=new Rg(256,256),L={featureIndex:w,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:M,availableImages:a},z=i.familiesBySource[this.source];for(const At in z){const mt=e.layers[At];if(!mt)continue;let rn=!1,en=!1;for(const sn of z[At])"symbol"===sn[0].type?rn=!0:en=!0;if(!0===this.isSymbolTile&&!rn||!1===this.isSymbolTile&&!en)continue;1===mt.version&&wn(`Vector tile source "${this.source}" layer "${At}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const mn=_.encode(At),Pn=[];for(let sn=0;sn<mt.length;sn++){const vn=mt.feature(sn),xn=w.getId(vn,At);Pn.push({feature:vn,id:xn,index:sn,sourceLayerIndex:mn})}for(const sn of z[At]){const vn=sn[0];void 0!==this.isSymbolTile&&"symbol"===vn.type!==this.isSymbolTile||vn.minzoom&&this.zoom<Math.floor(vn.minzoom)||vn.maxzoom&&this.zoom>=vn.maxzoom||"none"!==vn.visibility&&(lp(sn,this.zoom,a),(T[vn.id]=vn.createBucket({index:w.bucketLayerIDs.length,layers:sn,zoom:this.zoom,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:mn,sourceID:this.source,enableTerrain:this.enableTerrain,projection:this.projection.spec,availableImages:a})).populate(Pn,L,this.tileID.canonical,this.tileTransform),w.bucketLayerIDs.push(sn.map(xn=>xn.id)))}}let V,K,ne,ge;M.trim();const ze={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},rt=Ce(L.glyphDependencies,At=>Object.keys(At).map(Number));Object.keys(rt).length?d.send("getGlyphs",{uid:this.uid,stacks:rt},(At,mt)=>{V||(V=At,K=mt,ft.call(this))},void 0,!1,ze):K={};const wt=Object.keys(L.iconDependencies);wt.length?d.send("getImages",{icons:wt,source:this.source,tileID:this.tileID,type:"icons"},(At,mt)=>{V||(V=At,ne=mt,ft.call(this))},void 0,!1,ze):ne={};const it=Object.keys(L.patternDependencies);function ft(){if(V)return m(V);if(K&&ne&&ge){const At=new Gf(K),mt=new eg(ne,ge);for(const rn in T){const en=T[rn];en instanceof qc?(lp(en.layers,this.zoom,a),pg(en,K,At.positions,ne,mt.iconPositions,this.showCollisionBoxes,a,this.tileID.canonical,this.tileZoom,this.projection)):en.hasPattern&&(en instanceof Zu||en instanceof Vu||en instanceof Ad)&&(lp(en.layers,this.zoom,a),en.addFeatures(L,this.tileID.canonical,mt.patternPositions,a,this.tileTransform))}this.status="done",m(null,{buckets:vt(T).filter(rn=>!rn.isEmpty()),featureIndex:w,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:At.image,lineAtlas:M,imageAtlas:mt,glyphMap:this.returnDependencies?K:null,iconMap:this.returnDependencies?ne:null,glyphPositions:this.returnDependencies?At.positions:null})}}it.length?d.send("getImages",{icons:it,source:this.source,tileID:this.tileID,type:"patterns"},(At,mt)=>{V||(V=At,ge=mt,ft.call(this))},void 0,!1,ze):ge={},ft.call(this)}}function lp(n,e,i){const a=new ot(e);for(const d of n)d.recalculate(a,i)}class Hf{constructor(e){this.entries={},this.scheduler=e}request(e,i,a,d){const m=this.entries[e]=this.entries[e]||{callbacks:[]};if(m.result){const[_,w]=m.result;return this.scheduler?this.scheduler.add(()=>{d(_,w)},i):d(_,w),()=>{}}return m.callbacks.push(d),m.cancel||(m.cancel=a((_,w)=>{m.result=[_,w];for(const T of m.callbacks)this.scheduler?this.scheduler.add(()=>{T(_,w)},i):T(_,w);setTimeout(()=>delete this.entries[e],3e3)})),()=>{m.result||(m.callbacks=m.callbacks.filter(_=>_!==d),m.callbacks.length||(m.cancel(),delete this.entries[e]))}}}function xu(n,e,i){const a=JSON.stringify(n.request);return n.data&&(this.deduped.entries[a]={result:[null,n.data]}),this.deduped.request(a,{type:"parseTile",isSymbolTile:n.isSymbolTile,zoom:n.tileZoom},d=>{const m=Qt(n.request,(_,w,T,M)=>{_?d(_):w&&d(null,{vectorTile:i?void 0:new Bm(new kd(w)),rawData:w,cacheControl:T,expires:M})});return()=>{m.cancel(),d()}},e)}c.ARRAY_TYPE=Aa,c.AUTH_ERR_MSG=Pi,c.Aabb=na,c.Actor=class{constructor(n,e,i){this.target=n,this.parent=e,this.mapId=i,this.callbacks={},this.cancelCallbacks={},ct(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.globalScope=ut()?n:Y,this.scheduler=new Pf}send(n,e,i,a,d=!1,m){const _=Math.round(1e18*Math.random()).toString(36).substring(0,10);i&&(i.metadata=m,this.callbacks[_]=i);const w=ni(this.globalScope)?void 0:[];return this.target.postMessage({id:_,type:n,hasCallback:!!i,targetMapId:a,mustQueue:d,sourceMapId:this.mapId,data:Ma(e,w)},w),{cancel:()=>{i&&delete this.callbacks[_],this.target.postMessage({id:_,type:"<cancel>",targetMapId:a,sourceMapId:this.mapId})}}}receive(n){const e=n.data,i=e.id;if(i&&(!e.targetMapId||this.mapId===e.targetMapId))if("<cancel>"===e.type){const a=this.cancelCallbacks[i];delete this.cancelCallbacks[i],a&&a.cancel()}else if(e.mustQueue||ut()){const a=this.callbacks[i];this.cancelCallbacks[i]=this.scheduler.add(()=>this.processTask(i,e),a&&a.metadata||{type:"message"})}else this.processTask(i,e)}processTask(n,e){if("<response>"===e.type){const i=this.callbacks[n];delete this.callbacks[n],i&&(e.error?i(Za(e.error)):i(null,Za(e.data)))}else{const i=ni(this.globalScope)?void 0:[],a=e.hasCallback?(m,_)=>{delete this.cancelCallbacks[n],this.target.postMessage({id:n,type:"<response>",sourceMapId:this.mapId,error:m?Ma(m):null,data:Ma(_,i)},i)}:m=>{},d=Za(e.data);if(this.parent[e.type])this.parent[e.type](e.sourceMapId,d,a);else if(this.parent.getWorkerSource){const m=e.type.split(".");this.parent.getWorkerSource(e.sourceMapId,m[0],d.source)[m[1]](d,a)}else a(new Error(`Could not find function ${e.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}},c.CanonicalTileID=Pd,c.Color=fr,c.ColorMode=tl,c.CullFaceMode=$l,c.DEMData=Tl,c.DataConstantProperty=Kt,c.DedupedRequest=Hf,c.DepthMode=id,c.EXTENT=Si,c.Elevation=class{isDataAvailableAtPoint(n){const e=this._source();if(this.isUsingMockSource()||!e||n.y<0||n.y>1)return!1;const i=e.getSource().maxzoom,a=1<<i,d=Math.floor(n.x),m=Math.floor((n.x-d)*a),_=Math.floor(n.y*a),w=this.findDEMTileFor(new Hs(i,d,i,m,_));return!(!w||!w.dem)}getAtPointOrZero(n,e=0){return this.getAtPoint(n,e)||0}getAtPoint(n,e,i=!0){if(this.isUsingMockSource())return null;null==e&&(e=null);const a=this._source();if(!a||n.y<0||n.y>1)return e;const d=a.getSource().maxzoom,m=1<<d,_=Math.floor(n.x),w=n.x-_,T=new Hs(d,_,d,Math.floor(w*m),Math.floor(n.y*m)),M=this.findDEMTileFor(T);if(!M||!M.dem)return e;const L=M.dem,z=1<<M.tileID.canonical.z,V=(w*z-M.tileID.canonical.x)*L.dim,K=(n.y*z-M.tileID.canonical.y)*L.dim,ne=Math.floor(V),ge=Math.floor(K);return(i?this.exaggeration():1)*ji(ji(L.get(ne,ge),L.get(ne,ge+1),K-ge),ji(L.get(ne+1,ge),L.get(ne+1,ge+1),K-ge),V-ne)}getAtTileOffset(n,e,i){const a=1<<n.canonical.z;return this.getAtPointOrZero(new Bl(n.wrap+(n.canonical.x+e/Si)/a,(n.canonical.y+i/Si)/a))}getAtTileOffsetFunc(n,e,i,a){return d=>{const m=this.getAtTileOffset(n,d.x,d.y),_=a.upVector(n.canonical,d.x,d.y);return Xa(_,_,m*a.upVectorScale(n.canonical,e,i).metersToTile),_}}getForTilePoints(n,e,i,a){if(this.isUsingMockSource())return!1;const d=ap.create(this,n,a);return!!d&&(e.forEach(m=>{m[2]=this.exaggeration()*d.getElevationAt(m[0],m[1],i)}),!0)}getMinMaxForTile(n){if(this.isUsingMockSource())return null;const e=this.findDEMTileFor(n);if(!e||!e.dem)return null;const i=e.dem.tree,a=e.tileID,d=1<<n.canonical.z-a.canonical.z;let m=n.canonical.x/d-a.canonical.x,_=n.canonical.y/d-a.canonical.y,w=0;for(let T=0;T<n.canonical.z-a.canonical.z&&!i.leaves[w];T++){m*=2,_*=2;const M=2*Math.floor(_)+Math.floor(m);w=i.childOffsets[w]+M,m%=1,_%=1}return{min:this.exaggeration()*i.minimums[w],max:this.exaggeration()*i.maximums[w]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(n,e,i){throw new Error("Pure virtual method called.")}pointCoordinate(n){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(n){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}},c.ErrorEvent=Qr,c.EvaluationParameters=ot,c.Event=Bi,c.Evented=Cr,c.FillExtrusionBucket=Ad,c.Frustum=wm,c.FrustumCorners=Mh,c.GLOBE_METERS_TO_ECEF=yg,c.GLOBE_RADIUS=mc,c.GLOBE_SCALE_MATCH_LATITUDE=45,c.GLOBE_ZOOM_THRESHOLD_MAX=6,c.GLOBE_ZOOM_THRESHOLD_MIN=5,c.GlobeSharedBuffers=class{constructor(n){this._createGrid(n),this._createPoles(n)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const n of this._poleSegments)n.destroy();for(const n of this._gridSegments)n.destroy();if(this._wireframeIndexBuffer){this._wireframeIndexBuffer.destroy();for(const n of this._wireframeSegments)n.destroy()}}_createGrid(n){const e=new $i,i=new ys,a=65;for(let d=0;d<a;d++)for(let m=0;m<a;m++)e.emplaceBack(m,d);this._gridSegments=[];for(let d=0,m=0;d<Yu.length;d++){const _=Yu[d];for(let T=0;T<_;T++)for(let M=0;M<64;M++){const L=T*a+M;i.emplaceBack(L+1,L,L+a),i.emplaceBack(L+a,L+a+1,L+1)}const w=64*_*2;this._gridSegments.push(Lo.simpleSegment(0,m,(_+1)*a,w)),m+=w}this._gridBuffer=n.createVertexBuffer(e,fc.members),this._gridIndexBuffer=n.createIndexBuffer(i,!0)}_createPoles(n){const e=new ys;for(let d=0;d<=64;d++)e.emplaceBack(0,d+1,d+2);this._poleIndexBuffer=n.createIndexBuffer(e,!0);const i=new Wa,a=new Wa;this._poleSegments=[];for(let d=0,m=0;d<5;d++){const _=360/(1<<d);i.emplaceBack(0,-mc,0,.5,0),a.emplaceBack(0,-mc,0,.5,1);for(let w=0;w<=64;w++){const T=w/64,M=ji(0,_,T),[L,z,V]=Ju(Hd,q_,M,mc);i.emplaceBack(L,z,V,T,0),a.emplaceBack(L,z,V,T,1)}this._poleSegments.push(Lo.simpleSegment(m,0,66,64)),m+=66}this._poleNorthVertexBuffer=n.createVertexBuffer(i,gg,!1),this._poleSouthVertexBuffer=n.createVertexBuffer(a,gg,!1)}getGridBuffers(n){return[this._gridBuffer,this._gridIndexBuffer,this._gridSegments[n]]}getPoleBuffers(n){return[this._poleNorthVertexBuffer,this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[n]]}getWirefameBuffers(n,e){if(!this._wireframeSegments){const i=new Qs,a=64,d=a+1;this._wireframeSegments=[];for(let m=0,_=0;m<Yu.length;m++){const w=Yu[m];for(let M=0;M<w;M++)for(let L=0;L<a;L++){const z=M*d+L;i.emplaceBack(z,z+1),i.emplaceBack(z,z+d),i.emplaceBack(z,z+d+1)}const T=w*a*3;this._wireframeSegments.push(Lo.simpleSegment(0,_,(w+1)*d,T)),_+=T}this._wireframeIndexBuffer=n.createIndexBuffer(i)}return[this._gridBuffer,this._wireframeIndexBuffer,this._wireframeSegments[e]]}},c.GlyphManager=fu,c.ImagePosition=_f,c.LivePerformanceUtils=Ue,c.LngLat=_r,c.LngLatBounds=pl,c.LocalGlyphMode=vf,c.MAX_MERCATOR_LATITUDE=Ya,c.MercatorCoordinate=Bl,c.ONE_EM=24,c.OverscaledTileID=Hs,c.PerformanceMarkers=Pe,c.Properties=Bn,c.RGBAImage=Pa,c.Ray=Vp,c.RequestManager=class{constructor(n,e,i){this._transformRequestFn=n,this._customAccessToken=e,this._silenceAuthErrors=!!i,this._createSkuToken()}_createSkuToken(){const n=function(){let e="";for(let i=0;i<10;i++)e+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",he,e].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=n.token,this._skuTokenExpiresAt=n.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(n,e){return this._transformRequestFn&&this._transformRequestFn(n,e)||{url:n}}normalizeStyleURL(n,e){if(!br(n))return n;const i=_t(n);return i.path=`/styles/v1${i.path}`,this._makeAPIURL(i,this._customAccessToken||e)}normalizeGlyphsURL(n,e){if(!br(n))return n;const i=_t(n);return i.path=`/fonts/v1${i.path}`,this._makeAPIURL(i,this._customAccessToken||e)}normalizeSourceURL(n,e,i,a){if(!br(n))return n;const d=_t(n);return d.path=`/v4/${d.authority}.json`,d.params.push("secure"),i&&d.params.push(`language=${i}`),a&&d.params.push(`worldview=${a}`),this._makeAPIURL(d,this._customAccessToken||e)}normalizeSpriteURL(n,e,i,a){const d=_t(n);return br(n)?(d.path=`/styles/v1${d.path}/sprite${e}${i}`,this._makeAPIURL(d,this._customAccessToken||a)):(d.path+=`${e}${i}`,kt(d))}normalizeTileURL(n,e,i){if(this._isSkuTokenExpired()&&this._createSkuToken(),n&&!br(n))return n;const a=_t(n);a.path=a.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${e||i&&"raster"!==a.authority&&512===i?"@2x":""}${Ie.supported?".webp":"$1"}`),"raster"===a.authority?a.path=`/${fe.RASTER_URL_PREFIX}${a.path}`:(a.path=a.path.replace(/^.+\/v4\//,"/"),a.path=`/${fe.TILE_URL_VERSION}${a.path}`);const d=this._customAccessToken||function(m){for(const _ of m){const w=_.match(/^access_token=(.*)$/);if(w)return w[1]}return null}(a.params)||fe.ACCESS_TOKEN;return fe.REQUIRE_ACCESS_TOKEN&&d&&this._skuToken&&a.params.push(`sku=${this._skuToken}`),this._makeAPIURL(a,d)}canonicalizeTileURL(n,e){const i=_t(n);if(!i.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!i.path.match(/\.[\w]+$/))return n;let a="mapbox://";i.path.match(/^\/raster\/v1\//)?a+=`raster/${i.path.replace(`/${fe.RASTER_URL_PREFIX}/`,"")}`:a+=`tiles/${i.path.replace(`/${fe.TILE_URL_VERSION}/`,"")}`;let d=i.params;return e&&(d=d.filter(m=>!m.match(/^access_token=/))),d.length&&(a+=`?${d.join("&")}`),a}canonicalizeTileset(n,e){const i=!!e&&br(e),a=[];for(const d of n.tiles||[])wr(d)?a.push(this.canonicalizeTileURL(d,i)):a.push(d);return a}_makeAPIURL(n,e){const i="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",a=_t(fe.API_URL);if(n.protocol=a.protocol,n.authority=a.authority,"http"===n.protocol){const d=n.params.indexOf("secure");d>=0&&n.params.splice(d,1)}if("/"!==a.path&&(n.path=`${a.path}${n.path}`),!fe.REQUIRE_ACCESS_TOKEN)return kt(n);if(e=e||fe.ACCESS_TOKEN,!this._silenceAuthErrors){if(!e)throw new Error(`An API access token is required to use Mapbox GL. ${i}`);if("s"===e[0])throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${i}`)}return n.params=n.params.filter(d=>-1===d.indexOf("access_token")),n.params.push(`access_token=${e||""}`),kt(n)}},c.ResourceType=qe,c.SegmentVector=Lo,c.SourceCache=rd,c.StencilMode=wc,c.StructArrayLayout1ui2=pd,c.StructArrayLayout2f1f2i16=_s,c.StructArrayLayout2i4=$i,c.StructArrayLayout2ui4=Qs,c.StructArrayLayout3f12=ma,c.StructArrayLayout3ui6=ys,c.StructArrayLayout4i8=Ir,c.StructArrayLayout5f20=Wa,c.Texture=vu,c.Tile=Qd,c.Transitionable=cn,c.Uniform1f=fd,c.Uniform1i=class extends dl{constructor(n){super(n),this.current=0}set(n,e,i){this.fetchUniformLocation(n,e)&&this.current!==i&&(this.current=i,this.gl.uniform1i(this.location,i))}},c.Uniform2f=class extends dl{constructor(n){super(n),this.current=[0,0]}set(n,e,i){this.fetchUniformLocation(n,e)&&(i[0]===this.current[0]&&i[1]===this.current[1]||(this.current=i,this.gl.uniform2f(this.location,i[0],i[1])))}},c.Uniform3f=class extends dl{constructor(n){super(n),this.current=[0,0,0]}set(n,e,i){this.fetchUniformLocation(n,e)&&(i[0]===this.current[0]&&i[1]===this.current[1]&&i[2]===this.current[2]||(this.current=i,this.gl.uniform3f(this.location,i[0],i[1],i[2])))}},c.Uniform4f=nu,c.UniformColor=dh,c.UniformMatrix2f=class extends dl{constructor(n){super(n),this.current=bp}set(n,e,i){if(this.fetchUniformLocation(n,e))for(let a=0;a<4;a++)if(i[a]!==this.current[a]){this.current=i,this.gl.uniformMatrix2fv(this.location,!1,i);break}}},c.UniformMatrix3f=class extends dl{constructor(n){super(n),this.current=Kg}set(n,e,i){if(this.fetchUniformLocation(n,e))for(let a=0;a<9;a++)if(i[a]!==this.current[a]){this.current=i,this.gl.uniformMatrix3fv(this.location,!1,i);break}}},c.UniformMatrix4f=class extends dl{constructor(n){super(n),this.current=um}set(n,e,i){if(this.fetchUniformLocation(n,e)){if(i[12]!==this.current[12]||i[0]!==this.current[0])return this.current=i,void this.gl.uniformMatrix4fv(this.location,!1,i);for(let a=1;a<16;a++)if(i[a]!==this.current[a]){this.current=i,this.gl.uniformMatrix4fv(this.location,!1,i);break}}}},c.UnwrappedTileID=sf,c.ValidationError=Gn,c.VectorTileFeature=Dd,c.VectorTileWorkerSource=class extends Cr{constructor(n,e,i,a,d){super(),this.actor=n,this.layerIndex=e,this.availableImages=i,this.loadVectorData=d||xu,this.loading={},this.loaded={},this.deduped=new Hf(n.scheduler),this.isSpriteLoaded=a,this.scheduler=n.scheduler}loadTile(n,e){const i=n.uid,a=n&&n.request,d=a&&a.collectResourceTiming,m=this.loading[i]=new ey(n);m.abort=this.loadVectorData(n,(_,w)=>{const T=!this.loading[i];if(delete this.loading[i],T||_||!w)return m.status="done",T||(this.loaded[i]=m),e(_);const M=w.rawData,L={};w.expires&&(L.expires=w.expires),w.cacheControl&&(L.cacheControl=w.cacheControl),m.vectorTile=w.vectorTile||new Bm(new kd(M));const z=()=>{m.parse(m.vectorTile,this.layerIndex,this.availableImages,this.actor,(V,K)=>{if(V||!K)return e(V);const ne={};if(d){const ge=zt(a);ge.length>0&&(ne.resourceTiming=JSON.parse(JSON.stringify(ge)))}e(null,Et({rawTileData:M.slice(0)},K,L,ne))})};this.isSpriteLoaded?z():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(z,{type:"parseTile",isSymbolTile:n.isSymbolTile,zoom:n.tileZoom}):z()}),this.loaded=this.loaded||{},this.loaded[i]=m})}reloadTile(n,e){const i=this.loaded,a=n.uid,d=this;if(i&&i[a]){const m=i[a];m.showCollisionBoxes=n.showCollisionBoxes,m.enableTerrain=!!n.enableTerrain,m.projection=n.projection,m.tileTransform=_c(n.tileID.canonical,n.projection);const _=(w,T)=>{const M=m.reloadCallback;M&&(delete m.reloadCallback,m.parse(m.vectorTile,d.layerIndex,this.availableImages,d.actor,M)),e(w,T)};"parsing"===m.status?m.reloadCallback=_:"done"===m.status&&(m.vectorTile?m.parse(m.vectorTile,this.layerIndex,this.availableImages,this.actor,_):_())}}abortTile(n,e){const i=n.uid,a=this.loading[i];a&&(a.abort&&a.abort(),delete this.loading[i]),e()}removeTile(n,e){const i=this.loaded,a=n.uid;i&&i[a]&&delete i[a],e()}},c.WritingMode=ga,c.ZoomHistory=oc,c.add=Uc,c.addDynamicAttributes=Jd,c.adjoint=function(n,e){var i=e[0],a=e[1],d=e[2],m=e[3],_=e[4],w=e[5],T=e[6],M=e[7],L=e[8];return n[0]=_*L-w*M,n[1]=d*M-a*L,n[2]=a*w-d*_,n[3]=w*T-m*L,n[4]=i*L-d*T,n[5]=d*m-i*w,n[6]=m*M-_*T,n[7]=a*T-i*M,n[8]=i*_-a*m,n},c.asyncAll=Ee,c.bezier=et,c.bindAll=ct,c.boundsAttributes=Rf,c.bufferConvexPolygon=function(n,e){const i=[];for(let a=0;a<n.length;a++){const d=ae(a-1,-1,n.length-1),m=ae(a+1,-1,n.length-1),_=n[a],w=n[m],T=n[d].sub(_).unit(),M=w.sub(_).unit(),L=M.angleWithSep(T.x,T.y),z=T.add(M).unit().mult(-1*e/Math.sin(L/2));i.push(_.add(z))}return i},c.cacheEntryPossiblyAdded=function(n){Mt++,Mt>Ii&&(n.getActor().send("enforceCacheSizeLimit",Ni),Mt=0)},c.calculateGlobeLabelMatrix=function(n,e){const{x:i,y:a}=n.point,d=Df(i,a,n.worldSize/n._pixelsPerMercatorPixel,0,0);return iu(d,d,bg(el(e)))},c.calculateGlobeMatrix=function(n){const{x:e,y:i}=n.point,{lng:a,lat:d}=n._center;return Df(e,i,n.worldSize,a,d)},c.calculateGlobeMercatorMatrix=function(n){const e=n.pixelsPerMeter,i=e/ta(1,n.center.lat),a=dc(new Float64Array(16));return vd(a,a,[n.point.x,n.point.y,0]),ru(a,a,[i,i,e]),Float32Array.from(a)},c.circumferenceAtLatitude=ph,c.clamp=_e,c.clearTileCache=function(n){if(!Ui())return;const e=Y.caches.delete(_i);n&&e.catch(n).then(()=>n())},c.clipLine=ag,c.clone=function(n){var e=new Aa(16);return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],e[9]=n[9],e[10]=n[10],e[11]=n[11],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15],e},c.clone$1=Ut,c.collisionCircleLayout=A_,c.config=fe,c.conjugate=function(n,e){return n[0]=-e[0],n[1]=-e[1],n[2]=-e[2],n[3]=e[3],n},c.create=function(){var n=new Aa(16);return Aa!=Float32Array&&(n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[11]=0,n[12]=0,n[13]=0,n[14]=0),n[0]=1,n[5]=1,n[10]=1,n[15]=1,n},c.create$1=s_,c.createExpression=Wi,c.createLayout=Nn,c.createStyleLayer=function(n){return"custom"===n.type?new Af(n):new op[n.type](n)},c.cross=Bp,c.degToRad=ye,c.distance=function(n,e){return Math.hypot(e[0]-n[0],e[1]-n[1],e[2]-n[2])},c.div=function(n,e,i){return n[0]=e[0]/i[0],n[1]=e[1]/i[1],n[2]=e[2]/i[2],n},c.dot=Ka,c.earthRadius=hh,c.ease=Je,c.easeCubicInOut=we,c.ecefToLatLng=function([n,e,i]){const a=Math.hypot(n,e,i),d=Math.atan2(n,i),m=.5*Math.PI-Math.acos(-e/a);return new _r(Fe(d),Fe(m))},c.emitValidationErrors=rc,c.endsWith=ht,c.enforceCacheSizeLimit=function(n){Yi(),wi&&wi.then(e=>{e.keys().then(i=>{for(let a=0;a<i.length-n;a++)e.delete(i[a])})})},c.evaluateSizeForFeature=Ld,c.evaluateSizeForZoom=Gu,c.evaluateVariableOffset=bf,c.evented=Xe,c.exactEquals=function(n,e){return n[0]===e[0]&&n[1]===e[1]&&n[2]===e[2]&&n[3]===e[3]},c.exactEquals$1=function(n,e){return n[0]===e[0]&&n[1]===e[1]&&n[2]===e[2]},c.exported=gi,c.exported$1=Ie,c.extend=Et,c.extend$1=ar,c.fillExtrusionHeightLift=jm,c.filterObject=Ct,c.fromMat4=function(n,e){return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[4],n[4]=e[5],n[5]=e[6],n[6]=e[8],n[7]=e[9],n[8]=e[10],n},c.fromQuat=function(n,e){var i=e[0],a=e[1],d=e[2],m=e[3],_=i+i,w=a+a,T=d+d,M=i*_,L=a*_,z=a*w,V=d*_,K=d*w,ne=d*T,ge=m*_,ze=m*w,rt=m*T;return n[0]=1-z-ne,n[1]=L+rt,n[2]=V-ze,n[3]=0,n[4]=L-rt,n[5]=1-M-ne,n[6]=K+ge,n[7]=0,n[8]=V+ze,n[9]=K-ge,n[10]=1-M-z,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n},c.fromRotation=function(n,e){var i=Math.sin(e),a=Math.cos(e);return n[0]=a,n[1]=i,n[2]=0,n[3]=-i,n[4]=a,n[5]=0,n[6]=0,n[7]=0,n[8]=1,n},c.fromScaling=Ch,c.furthestTileCorner=function(n){const e=Math.round((n+45+360)%360/90)%4;return Ne[e]},c.getAABBPointSquareDist=function(n,e,i){let a=0;for(let d=0;d<2;++d){const m=i?i[d]:0;n[d]>m&&(a+=(n[d]-m)*(n[d]-m)),e[d]<m&&(a+=(m-e[d])*(m-e[d]))}return a},c.getAnchorAlignment=$h,c.getAnchorJustification=Jh,c.getBounds=function(n){let e=1/0,i=1/0,a=-1/0,d=-1/0;for(const m of n)e=Math.min(e,m.x),i=Math.min(i,m.y),a=Math.max(a,m.x),d=Math.max(d,m.y);return{min:new te(e,i),max:new te(a,d)}},c.getColumn=Un,c.getGridMatrix=function(n,e,i,a){const d=e.getNorth(),m=e.getSouth(),_=e.getWest(),w=e.getEast(),T=1<<n.z,M=w-_,L=d-m,z=M/64,V=-L/Yu[i],K=[0,z,0,V,0,0,d,_,0];if(n.z>0){const ne=180/a;a_(K,K,[ne/M+1,0,0,0,ne/L+1,0,-.5*ne/z,.5*ne/V,1])}return K[2]=T,K[5]=n.x,K[8]=n.y,K},c.getImage=xr,c.getJSON=function(n,e){return Wt(Et(n,{type:"json"}),e)},c.getLatitudinalLod=function(n){const e=80.051129;n=_e(n,-80.051129,e)/e*90;const i=Math.pow(Math.abs(Math.sin(ye(n))),3);return Math.round(i*(Yu.length-1))},c.getMapSessionAPI=Rt,c.getPerformanceMeasurement=zt,c.getProjection=Mf,c.getRTLTextPluginStatus=We,c.getReferrer=tt,c.getTilePoint=function(n,{x:e,y:i},a=0){return new te(((e-a)*n.scale-n.x)*Si,(i*n.scale-n.y)*Si)},c.getTileVec3=function(n,e,i=0){return bd(((e.x-i)*n.scale-n.x)*Si,(e.y*n.scale-n.y)*Si,fh(e.z,e.y))},c.getVideo=function(n,e){const i=Y.document.createElement("video");i.muted=!0,i.onloadstart=function(){e(null,i)};for(let a=0;a<n.length;a++){const d=Y.document.createElement("source");fi(n[a])||(i.crossOrigin="Anonymous"),d.src=n[a],i.appendChild(d)}return{cancel:()=>{}}},c.globeCenterToScreenPoint=function(n){const e=[0,0,0],i=dc(new Float64Array(16));return iu(i,n.pixelMatrix,n.globeMatrix),Fo(e,e,i),new te(e[0],e[1])},c.globeDenormalizeECEF=bg,c.globeECEFOrigin=function(n,e){const i=[0,0,0];return Fo(i,i,Gd(el(e.canonical))),Fo(i,i,n),i},c.globeNormalizeECEF=Gd,c.globePixelsToTileUnits=function(n,e){return Si/(512*Math.pow(2,n))*Zd(el(e))},c.globePoleMatrixForTile=function(n,e,i){const a=dc(new Float64Array(16)),d=(e/(1<<n)-.5)*Math.PI*2;return wh(a,i.globeMatrix,d),Float32Array.from(a)},c.globeTileBounds=el,c.globeTiltAtLngLat=Hc,c.globeToMercatorTransition=gc,c.globeUseCustomAntiAliasing=function(n,e,i){const a=gc(i.zoom),d=n.style.map._antialias,m=!!e.extStandardDerivatives,_=e.extStandardDerivativesForceOff||n.terrain&&n.terrain.exaggeration()>0;return 0===a&&!d&&!_&&m},c.identity=dc,c.identity$1=Up,c.invert=_m,c.isFullscreen=function(){return!!Y.document.fullscreenElement||!!Y.document.webkitFullscreenElement},c.isLngLatBehindGlobe=function(n,e){return Hc(n,e)>Math.PI/2*1.01},c.isMapAuthenticated=function(n){return at.has(n)},c.isMapboxURL=br,c.isSafariWithAntialiasingBug=function(n){const e=n.navigator?n.navigator.userAgent:null;return!!ni(n)&&e&&(e.match("Version/15.4")||e.match("Version/15.5")||e.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},c.latFromMercatorY=os,c.latLngToECEF=jd,c.len=l_,c.length=Ru,c.length$1=function(n){return Math.hypot(n[0],n[1],n[2],n[3])},c.lngFromMercatorX=Zs,c.loadVectorTile=xu,c.makeRequest=Wt,c.mapValue=function(n,e,i,a,d){return _e((n-e)/(i-e)*(d-a)+a,a,d)},c.mercatorScale=mh,c.mercatorXfromLng=qa,c.mercatorYfromLat=fl,c.mercatorZfromAltitude=ta,c.mul=xd,c.mul$1=Np,c.multiply=iu,c.multiply$1=a_,c.multiply$2=Eh,c.nextPowerOfTwo=Pt,c.normalize=Gs,c.normalize$1=c_,c.normalize$2=vm,c.number=ji,c.ortho=function(n,e,i,a,d,m,_){var w=1/(e-i),T=1/(a-d),M=1/(m-_);return n[0]=-2*w,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=-2*T,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=2*M,n[11]=0,n[12]=(e+i)*w,n[13]=(d+a)*T,n[14]=(_+m)*M,n[15]=1,n},c.pbf=kd,c.perspective=function(n,e,i,a,d){var m,_=1/Math.tan(e/2);return n[0]=_/i,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=_,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[11]=-1,n[12]=0,n[13]=0,n[15]=0,null!=d&&d!==1/0?(n[10]=(d+a)*(m=1/(a-d)),n[14]=2*d*a*m):(n[10]=-1,n[14]=-2*a),n},c.pick=function(n,e){const i={};for(let a=0;a<e.length;a++){const d=e[a];d in n&&(i[d]=n[d])}return i},c.plugin=yt,c.pointGeometry=te,c.polygonContainsPoint=zc,c.polygonIntersectsBox=Lp,c.polygonIntersectsPolygon=n_,c.polygonizeBounds=function(n,e,i=0,a=!0){const d=new te(i,i),m=n.sub(d),_=e.add(d),w=[m,new te(_.x,m.y),_,new te(m.x,_.y)];return a&&w.push(m.clone()),w},c.posAttributes=fc,c.postMapLoadEvent=de,c.postPerformanceEvent=st,c.postTurnstileEvent=R,c.potpack=zd,c.prevPowerOfTwo=function(n){return n<=1?1:Math.pow(2,Math.floor(Math.log(n)/Math.LN2))},c.radToDeg=Fe,c.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],c.registerForPluginStateChange=function(n){return n({pluginStatus:ke,pluginURL:Ye}),Xe.on("pluginStateChange",n),n},c.removeAuthState=function(n){at.delete(n)},c.renderColorRamp=Hp,c.resample=Ip,c.rotateX=Fp,c.rotateX$1=xm,c.rotateY=wh,c.rotateY$1=bm,c.rotateZ=function(n,e,i){var a=Math.sin(i),d=Math.cos(i),m=e[0],_=e[1],w=e[2],T=e[3],M=e[4],L=e[5],z=e[6],V=e[7];return e!==n&&(n[8]=e[8],n[9]=e[9],n[10]=e[10],n[11]=e[11],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n[0]=m*d+M*a,n[1]=_*d+L*a,n[2]=w*d+z*a,n[3]=T*d+V*a,n[4]=M*d-m*a,n[5]=L*d-_*a,n[6]=z*d-w*a,n[7]=V*d-T*a,n},c.rotateZ$1=function(n,e,i){i*=.5;var a=e[0],d=e[1],m=e[2],_=e[3],w=Math.sin(i),T=Math.cos(i);return n[0]=a*T+d*w,n[1]=d*T-a*w,n[2]=m*T+_*w,n[3]=_*T-m*w,n},c.scale=ru,c.scale$1=Zo,c.scale$2=Xa,c.scaleAndAdd=Lu,c.set=function(n,e,i,a){return n[0]=e,n[1]=i,n[2]=a,n},c.setCacheLimits=function(n,e){Ni=n,Ii=e},c.setColumn=function(n,e,i){n[4*e+0]=i[0],n[4*e+1]=i[1],n[4*e+2]=i[2],n[4*e+3]=i[3]},c.setRTLTextPlugin=function(n,e,i=!1){if(ke===J||ke===ue||ke===De)throw new Error("setRTLTextPlugin cannot be called multiple times.");Ye=gi.resolveURL(n),ke=J,je=e,Be(),i||gt()},c.smoothstep=pe,c.spec=on,c.squaredLength=function(n){var e=n[0],i=n[1],a=n[2];return e*e+i*i+a*a},c.storeAuthState=function(n,e){e?at.add(n):at.delete(n)},c.sub=ml,c.subtract=ym,c.symbolSize=P_,c.tileAABB=function(n,e,i,a,d,m,_,w,T){if("globe"===T.name)return function H_(n,e,i){const a=e/n.worldSize,d=n.globeMatrix;if(i.z<=1){const en=el(i).getCorners();return xg(en,d,a),na.fromPoints(en)}const m=Qh(i),_=Tf(m);xg(_,d,a);const w=Number.MAX_VALUE,T=[-w,-w,-w],M=[w,w,w];if(m.contains(n.center)){for(const Pn of _)ou(M,M,Pn),Dh(T,T,Pn);T[2]=0;const en=n.point,mn=[en.x*a,en.y*a,0];return ou(M,M,mn),Dh(T,T,mn),new na(M,T)}const L=[d[12]*a,d[13]*a,d[14]*a],z=m.getCenter(),V=_e(n.center.lat,-85.051129,Ya),K=_e(z.lat,-85.051129,Ya),ne=qa(n.center.lng),ge=fl(V);let ze=ne-qa(z.lng);const rt=ge-fl(K);ze>.5?ze-=1:ze<-.5&&(ze+=1);let wt=0;Math.abs(ze)>Math.abs(rt)?wt=ze>=0?1:3:(wt=rt>=0?0:2,Lu(L,L,[d[4]*a,d[5]*a,d[6]*a],-Math.sin(ye(rt>=0?m.getSouth():m.getNorth()))*mc));const it=_[wt],ft=_[(wt+1)%4],At=new G_(it,ft,L),mt=[Xh(At,0)||it[0],Xh(At,1)||it[1],Xh(At,2)||it[2]],rn=gc(n.zoom);if(rn>0){const en=function({x:Pn,y:sn,z:vn},xn,Sn,On,ln){const $n=1/(1<<vn);let vi=Pn*$n,Xn=vi+$n,oi=sn*$n,Hn=oi+$n,Ti=0;const Li=(vi+Xn)/2-On;return Li>.5?Ti=-1:Li<-.5&&(Ti=1),vi=((vi+Ti)*xn-(On*=xn))*Sn+On,Xn=((Xn+Ti)*xn-On)*Sn+On,oi=(oi*xn-(ln*=xn))*Sn+ln,Hn=(Hn*xn-ln)*Sn+ln,[[vi,Hn,0],[Xn,Hn,0],[Xn,oi,0],[vi,oi,0]]}(i,e,n._pixelsPerMercatorPixel,ne,ge);for(let Pn=0;Pn<_.length;Pn++)mu(_[Pn],en[Pn],rn);const mn=Uc([],en[wt],en[(wt+1)%4]);Xa(mn,mn,.5),mu(mt,mn,rn)}for(const en of _)ou(M,M,en),Dh(T,T,en);return M[2]=Math.min(it[2],ft[2]),ou(M,M,mt),Dh(T,T,mt),new na(M,T)}(n,e,new Pd(i,a,d));const M=_c({z:i,x:a,y:d},T);return new na([(m+M.x/M.scale)*e,e*(M.y/M.scale),_],[(m+M.x2/M.scale)*e,e*(M.y2/M.scale),w])},c.tileCornersToBounds=Qh,c.tileTransform=_c,c.transformMat3=function(n,e,i){var a=e[0],d=e[1],m=e[2];return n[0]=a*i[0]+d*i[3]+m*i[6],n[1]=a*i[1]+d*i[4]+m*i[7],n[2]=a*i[2]+d*i[5]+m*i[8],n},c.transformMat4=Fo,c.transformMat4$1=su,c.transformQuat=zp,c.transitionTileAABBinECEF=Kh,c.translate=vd,c.transpose=function(n,e){if(n===e){var i=e[1],a=e[2],d=e[5];n[1]=e[3],n[2]=e[6],n[3]=i,n[5]=e[7],n[6]=a,n[7]=d}else n[0]=e[0],n[1]=e[3],n[2]=e[6],n[3]=e[1],n[4]=e[4],n[5]=e[7],n[6]=e[2],n[7]=e[5],n[8]=e[8];return n},c.triggerPluginCompletionEvent=$e,c.uniqueId=Ft,c.updateGlobeVertexNormal=function(n,e,i,a,d){const m=5*e+2;n.float32[m+0]=i,n.float32[m+1]=a,n.float32[m+2]=d},c.validateCustomStyleLayer=function(n){const e=[],i=n.id;return void 0===i&&e.push({message:`layers.${i}: missing required property "id"`}),void 0===n.render&&e.push({message:`layers.${i}: missing required method "render"`}),n.renderingMode&&"2d"!==n.renderingMode&&"3d"!==n.renderingMode&&e.push({message:`layers.${i}: property "renderingMode" must be either "2d" or "3d"`}),e},c.validateFilter=n=>Ks(Kl(n)),c.validateFog=n=>Ks(ic(n)),c.validateLayer=n=>Ks(tc(n)),c.validateLight=n=>Ks(To(n)),c.validateSource=n=>Ks(nc(n)),c.validateStyle=Cu,c.validateTerrain=n=>Ks(Ac(n)),c.values=vt,c.vectorTile=kh,c.version=se,c.warnOnce=wn,c.window=Y,c.wrap=ae}),g(0,function(c){function Y(le){if("number"==typeof le||"boolean"==typeof le||"string"==typeof le||null==le)return JSON.stringify(le);if(Array.isArray(le)){let j="[";for(const de of le)j+=`${Y(de)},`;return`${j}]`}let R="{";for(const j of Object.keys(le).sort())R+=`${j}:${Y(le[j])},`;return`${R}}`}function se(le){let R="";for(const j of c.refProperties)R+=`/${Y(le[j])}`;return R}class y{constructor(R){this.keyCache={},R&&this.replace(R)}replace(R){this._layerConfigs={},this._layers={},this.update(R,[])}update(R,j){for(const Le of R)this._layerConfigs[Le.id]=Le,(this._layers[Le.id]=c.createStyleLayer(Le)).compileFilter(),this.keyCache[Le.id]&&delete this.keyCache[Le.id];for(const Le of j)delete this.keyCache[Le],delete this._layerConfigs[Le],delete this._layers[Le];this.familiesBySource={};const de=function(Le,st){const Bt={};for(let at=0;at<Le.length;at++){const Pe=st&&st[Le[at].id]||se(Le[at]);st&&(st[Le[at].id]=Pe);let Ue=Bt[Pe];Ue||(Ue=Bt[Pe]=[]),Ue.push(Le[at])}const Rt=[];for(const at in Bt)Rt.push(Bt[at]);return Rt}(c.values(this._layerConfigs),this.keyCache);for(const Le of de){const st=Le.map(Re=>this._layers[Re.id]),Bt=st[0];if("none"===Bt.visibility)continue;const Rt=Bt.source||"";let at=this.familiesBySource[Rt];at||(at=this.familiesBySource[Rt]={});const Pe=Bt.sourceLayer||"_geojsonTileLayer";let Ue=at[Pe];Ue||(Ue=at[Pe]=[]),Ue.push(st)}}}class fe{loadTile(R,j){const{uid:de,encoding:Le,rawImageData:st,padding:Bt,buildQuadTree:Rt}=R,at=c.window.ImageBitmap&&st instanceof c.window.ImageBitmap?this.getImageData(st,Bt):st;j(null,new c.DEMData(de,at,Le,Bt<1,Rt))}getImageData(R,j){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(R.width,R.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=R.width,this.offscreenCanvas.height=R.height,this.offscreenCanvasContext.drawImage(R,0,0,R.width,R.height);const de=this.offscreenCanvasContext.getImageData(-j,-j,R.width+2*j,R.height+2*j);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),de}}var Ie=function le(R,j){var de,Le=R&&R.type;if("FeatureCollection"===Le)for(de=0;de<R.features.length;de++)le(R.features[de],j);else if("GeometryCollection"===Le)for(de=0;de<R.geometries.length;de++)le(R.geometries[de],j);else if("Feature"===Le)le(R.geometry,j);else if("Polygon"===Le)Ge(R.coordinates,j);else if("MultiPolygon"===Le)for(de=0;de<R.coordinates.length;de++)Ge(R.coordinates[de],j);return R};function Ge(le,R){if(0!==le.length){Q(le[0],R);for(var j=1;j<le.length;j++)Q(le[j],!R)}}function Q(le,R){for(var j=0,de=0,Le=0,st=le.length,Bt=st-1;Le<st;Bt=Le++){var Rt=(le[Le][0]-le[Bt][0])*(le[Bt][1]+le[Le][1]),at=j+Rt;de+=Math.abs(j)>=Math.abs(Rt)?j-at+Rt:Rt-at+j,j=at}j+de>=0!=!!R&&le.reverse()}const be=c.VectorTileFeature.prototype.toGeoJSON;class me{constructor(R){this._feature=R,this.extent=c.EXTENT,this.type=R.type,this.properties=R.tags,"id"in R&&!isNaN(R.id)&&(this.id=parseInt(R.id,10))}loadGeometry(){if(1===this._feature.type){const R=[];for(const j of this._feature.geometry)R.push([new c.pointGeometry(j[0],j[1])]);return R}{const R=[];for(const j of this._feature.geometry){const de=[];for(const Le of j)de.push(new c.pointGeometry(Le[0],Le[1]));R.push(de)}return R}}toGeoJSON(R,j,de){return be.call(this,R,j,de)}}class Ze{constructor(R){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=c.EXTENT,this.length=R.length,this._features=R}feature(R){return new me(this._features[R])}}var he={exports:{}},Ke=c.pointGeometry,Ae=c.vectorTile.VectorTileFeature,te=Qe;function Qe(le,R){this.options=R||{},this.features=le,this.length=le.length}function Ot(le,R){this.id="number"==typeof le.id?le.id:void 0,this.type=le.type,this.rawGeometry=1===le.type?[le.geometry]:le.geometry,this.properties=le.tags,this.extent=R||4096}Qe.prototype.feature=function(le){return new Ot(this.features[le],this.options.extent)},Ot.prototype.loadGeometry=function(){var le=this.rawGeometry;this.geometry=[];for(var R=0;R<le.length;R++){for(var j=le[R],de=[],Le=0;Le<j.length;Le++)de.push(new Ke(j[Le][0],j[Le][1]));this.geometry.push(de)}return this.geometry},Ot.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var le=this.geometry,R=1/0,j=-1/0,de=1/0,Le=-1/0,st=0;st<le.length;st++)for(var Bt=le[st],Rt=0;Rt<Bt.length;Rt++){var at=Bt[Rt];R=Math.min(R,at.x),j=Math.max(j,at.x),de=Math.min(de,at.y),Le=Math.max(Le,at.y)}return[R,de,j,Le]},Ot.prototype.toGeoJSON=Ae.prototype.toGeoJSON;var dt=c.pbf,ye=te;function Fe(le){var R=new dt;return function(j,de){for(var Le in j.layers)de.writeMessage(3,Ne,j.layers[Le])}(le,R),R.finish()}function Ne(le,R){var j;R.writeVarintField(15,le.version||1),R.writeStringField(1,le.name||""),R.writeVarintField(5,le.extent||4096);var de={keys:[],values:[],keycache:{},valuecache:{}};for(j=0;j<le.length;j++)de.feature=le.feature(j),R.writeMessage(2,we,de);var Le=de.keys;for(j=0;j<Le.length;j++)R.writeStringField(3,Le[j]);var st=de.values;for(j=0;j<st.length;j++)R.writeMessage(4,ae,st[j])}function we(le,R){var j=le.feature;void 0!==j.id&&R.writeVarintField(1,j.id),R.writeMessage(2,et,le),R.writeVarintField(3,j.type),R.writeMessage(4,pe,j)}function et(le,R){var j=le.feature,de=le.keys,Le=le.values,st=le.keycache,Bt=le.valuecache;for(var Rt in j.properties){var at=j.properties[Rt],Pe=st[Rt];if(null!==at){void 0===Pe&&(de.push(Rt),st[Rt]=Pe=de.length-1),R.writeVarint(Pe);var Ue=typeof at;"string"!==Ue&&"boolean"!==Ue&&"number"!==Ue&&(at=JSON.stringify(at));var Re=Ue+":"+at,nt=Bt[Re];void 0===nt&&(Le.push(at),Bt[Re]=nt=Le.length-1),R.writeVarint(nt)}}}function Je(le,R){return(R<<3)+(7&le)}function _e(le){return le<<1^le>>31}function pe(le,R){for(var j=le.loadGeometry(),de=le.type,Le=0,st=0,Bt=j.length,Rt=0;Rt<Bt;Rt++){var at=j[Rt],Pe=1;1===de&&(Pe=at.length),R.writeVarint(Je(1,Pe));for(var Ue=3===de?at.length-1:at.length,Re=0;Re<Ue;Re++){1===Re&&1!==de&&R.writeVarint(Je(2,Ue-1));var nt=at[Re].x-Le,zt=at[Re].y-st;R.writeVarint(_e(nt)),R.writeVarint(_e(zt)),Le+=nt,st+=zt}3===de&&R.writeVarint(Je(7,1))}}function ae(le,R){var j=typeof le;"string"===j?R.writeStringField(1,le):"boolean"===j?R.writeBooleanField(7,le):"number"===j&&(le%1!=0?R.writeDoubleField(3,le):le<0?R.writeSVarintField(6,le):R.writeVarintField(5,le))}function Ee(le,R,j,de,Le,st){if(Le-de<=j)return;const Bt=de+Le>>1;vt(le,R,Bt,de,Le,st%2),Ee(le,R,j,de,Bt-1,st+1),Ee(le,R,j,Bt+1,Le,st+1)}function vt(le,R,j,de,Le,st){for(;Le>de;){if(Le-de>600){const Pe=Le-de+1,Ue=j-de+1,Re=Math.log(Pe),nt=.5*Math.exp(2*Re/3),zt=.5*Math.sqrt(Re*nt*(Pe-nt)/Pe)*(Ue-Pe/2<0?-1:1);vt(le,R,j,Math.max(de,Math.floor(j-Ue*nt/Pe+zt)),Math.min(Le,Math.floor(j+(Pe-Ue)*nt/Pe+zt)),st)}const Bt=R[2*j+st];let Rt=de,at=Le;for(Et(le,R,de,j),R[2*Le+st]>Bt&&Et(le,R,de,Le);Rt<at;){for(Et(le,R,Rt,at),Rt++,at--;R[2*Rt+st]<Bt;)Rt++;for(;R[2*at+st]>Bt;)at--}R[2*de+st]===Bt?Et(le,R,de,at):(at++,Et(le,R,at,Le)),at<=j&&(de=at+1),j<=at&&(Le=at-1)}}function Et(le,R,j,de){qt(le,j,de),qt(R,2*j,2*de),qt(R,2*j+1,2*de+1)}function qt(le,R,j){const de=le[R];le[R]=le[j],le[j]=de}function Ft(le,R,j,de){const Le=le-j,st=R-de;return Le*Le+st*st}he.exports=Fe,he.exports.fromVectorTileJs=Fe,he.exports.fromGeojsonVt=function(le,R){R=R||{};var j={};for(var de in le)j[de]=new ye(le[de].features,R),j[de].name=de,j[de].version=R.version,j[de].extent=R.extent;return Fe({layers:j})},he.exports.GeoJSONWrapper=ye;const xt=le=>le[0],Pt=le=>le[1];class bt{constructor(R,j=xt,de=Pt,Le=64,st=Float64Array){this.nodeSize=Le,this.points=R;const Bt=R.length<65536?Uint16Array:Uint32Array,Rt=this.ids=new Bt(R.length),at=this.coords=new st(2*R.length);for(let Pe=0;Pe<R.length;Pe++)Rt[Pe]=Pe,at[2*Pe]=j(R[Pe]),at[2*Pe+1]=de(R[Pe]);Ee(Rt,at,Le,0,Rt.length-1,0)}range(R,j,de,Le){return function(st,Bt,Rt,at,Pe,Ue,Re){const nt=[0,st.length-1,0],zt=[];let _n,Mn;for(;nt.length;){const Yn=nt.pop(),di=nt.pop(),gi=nt.pop();if(di-gi<=Re){for(let Bi=gi;Bi<=di;Bi++)_n=Bt[2*Bi],Mn=Bt[2*Bi+1],_n>=Rt&&_n<=Pe&&Mn>=at&&Mn<=Ue&&zt.push(st[Bi]);continue}const Kn=Math.floor((gi+di)/2);_n=Bt[2*Kn],Mn=Bt[2*Kn+1],_n>=Rt&&_n<=Pe&&Mn>=at&&Mn<=Ue&&zt.push(st[Kn]);const Vi=(Yn+1)%2;(0===Yn?Rt<=_n:at<=Mn)&&(nt.push(gi),nt.push(Kn-1),nt.push(Vi)),(0===Yn?Pe>=_n:Ue>=Mn)&&(nt.push(Kn+1),nt.push(di),nt.push(Vi))}return zt}(this.ids,this.coords,R,j,de,Le,this.nodeSize)}within(R,j,de){return function(Le,st,Bt,Rt,at,Pe){const Ue=[0,Le.length-1,0],Re=[],nt=at*at;for(;Ue.length;){const zt=Ue.pop(),_n=Ue.pop(),Mn=Ue.pop();if(_n-Mn<=Pe){for(let Vi=Mn;Vi<=_n;Vi++)Ft(st[2*Vi],st[2*Vi+1],Bt,Rt)<=nt&&Re.push(Le[Vi]);continue}const Yn=Math.floor((Mn+_n)/2),di=st[2*Yn],gi=st[2*Yn+1];Ft(di,gi,Bt,Rt)<=nt&&Re.push(Le[Yn]);const Kn=(zt+1)%2;(0===zt?Bt-at<=di:Rt-at<=gi)&&(Ue.push(Mn),Ue.push(Yn-1),Ue.push(Kn)),(0===zt?Bt+at>=di:Rt+at>=gi)&&(Ue.push(Yn+1),Ue.push(_n),Ue.push(Kn))}return Re}(this.ids,this.coords,R,j,de,this.nodeSize)}}const ct={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:le=>le},ht=Math.fround||(Ce=new Float32Array(1),le=>(Ce[0]=+le,Ce[0]));var Ce;class Ct{constructor(R){this.options=En(Object.create(ct),R),this.trees=new Array(this.options.maxZoom+1)}load(R){const{log:j,minZoom:de,maxZoom:Le,nodeSize:st}=this.options;j&&console.time("total time");const Bt=`prepare ${R.length} points`;j&&console.time(Bt),this.points=R;let Rt=[];for(let at=0;at<R.length;at++)R[at].geometry&&Rt.push(Gt(R[at],at));this.trees[Le+1]=new bt(Rt,ni,ci,st,Float32Array),j&&console.timeEnd(Bt);for(let at=Le;at>=de;at--){const Pe=+Date.now();Rt=this._cluster(Rt,at),this.trees[at]=new bt(Rt,ni,ci,st,Float32Array),j&&console.log("z%d: %d clusters in %dms",at,Rt.length,+Date.now()-Pe)}return j&&console.timeEnd("total time"),this}getClusters(R,j){let de=((R[0]+180)%360+360)%360-180;const Le=Math.max(-90,Math.min(90,R[1]));let st=180===R[2]?180:((R[2]+180)%360+360)%360-180;const Bt=Math.max(-90,Math.min(90,R[3]));if(R[2]-R[0]>=360)de=-180,st=180;else if(de>st){const Ue=this.getClusters([de,Le,180,Bt],j),Re=this.getClusters([-180,Le,st,Bt],j);return Ue.concat(Re)}const Rt=this.trees[this._limitZoom(j)],at=Rt.range(un(de),ut(Bt),un(st),ut(Le)),Pe=[];for(const Ue of at){const Re=Rt.points[Ue];Pe.push(Re.numPoints?wn(Re):this.points[Re.index])}return Pe}getChildren(R){const j=this._getOriginId(R),de=this._getOriginZoom(R),Le="No cluster with the specified id.",st=this.trees[de];if(!st)throw new Error(Le);const Bt=st.points[j];if(!Bt)throw new Error(Le);const Rt=this.options.radius/(this.options.extent*Math.pow(2,de-1)),at=st.within(Bt.x,Bt.y,Rt),Pe=[];for(const Ue of at){const Re=st.points[Ue];Re.parentId===R&&Pe.push(Re.numPoints?wn(Re):this.points[Re.index])}if(0===Pe.length)throw new Error(Le);return Pe}getLeaves(R,j,de){const Le=[];return this._appendLeaves(Le,R,j=j||10,de=de||0,0),Le}getTile(R,j,de){const Le=this.trees[this._limitZoom(R)],st=Math.pow(2,R),{extent:Bt,radius:Rt}=this.options,at=Rt/Bt,Pe=(de-at)/st,Ue=(de+1+at)/st,Re={features:[]};return this._addTileFeatures(Le.range((j-at)/st,Pe,(j+1+at)/st,Ue),Le.points,j,de,st,Re),0===j&&this._addTileFeatures(Le.range(1-at/st,Pe,1,Ue),Le.points,st,de,st,Re),j===st-1&&this._addTileFeatures(Le.range(0,Pe,at/st,Ue),Le.points,-1,de,st,Re),Re.features.length?Re:null}getClusterExpansionZoom(R){let j=this._getOriginZoom(R)-1;for(;j<=this.options.maxZoom;){const de=this.getChildren(R);if(j++,1!==de.length)break;R=de[0].properties.cluster_id}return j}_appendLeaves(R,j,de,Le,st){const Bt=this.getChildren(j);for(const Rt of Bt){const at=Rt.properties;if(at&&at.cluster?st+at.point_count<=Le?st+=at.point_count:st=this._appendLeaves(R,at.cluster_id,de,Le,st):st<Le?st++:R.push(Rt),R.length===de)break}return st}_addTileFeatures(R,j,de,Le,st,Bt){for(const Rt of R){const at=j[Rt],Pe=at.numPoints;let Ue,Re,nt;if(Pe)Ue=Fn(at),Re=at.x,nt=at.y;else{const Mn=this.points[at.index];Ue=Mn.properties,Re=un(Mn.geometry.coordinates[0]),nt=ut(Mn.geometry.coordinates[1])}const zt={type:1,geometry:[[Math.round(this.options.extent*(Re*st-de)),Math.round(this.options.extent*(nt*st-Le))]],tags:Ue};let _n;Pe?_n=at.id:this.options.generateId?_n=at.index:this.points[at.index].id&&(_n=this.points[at.index].id),void 0!==_n&&(zt.id=_n),Bt.features.push(zt)}}_limitZoom(R){return Math.max(this.options.minZoom,Math.min(Math.floor(+R),this.options.maxZoom+1))}_cluster(R,j){const de=[],{radius:Le,extent:st,reduce:Bt,minPoints:Rt}=this.options,at=Le/(st*Math.pow(2,j));for(let Pe=0;Pe<R.length;Pe++){const Ue=R[Pe];if(Ue.zoom<=j)continue;Ue.zoom=j;const Re=this.trees[j+1],nt=Re.within(Ue.x,Ue.y,at),zt=Ue.numPoints||1;let _n=zt;for(const Mn of nt){const Yn=Re.points[Mn];Yn.zoom>j&&(_n+=Yn.numPoints||1)}if(_n>zt&&_n>=Rt){let Mn=Ue.x*zt,Yn=Ue.y*zt,di=Bt&&zt>1?this._map(Ue,!0):null;const gi=(Pe<<5)+(j+1)+this.points.length;for(const Kn of nt){const Vi=Re.points[Kn];if(Vi.zoom<=j)continue;Vi.zoom=j;const Bi=Vi.numPoints||1;Mn+=Vi.x*Bi,Yn+=Vi.y*Bi,Vi.parentId=gi,Bt&&(di||(di=this._map(Ue,!0)),Bt(di,this._map(Vi)))}Ue.parentId=gi,de.push(Ut(Mn/_n,Yn/_n,gi,_n,di))}else if(de.push(Ue),_n>1)for(const Mn of nt){const Yn=Re.points[Mn];Yn.zoom<=j||(Yn.zoom=j,de.push(Yn))}}return de}_getOriginId(R){return R-this.points.length>>5}_getOriginZoom(R){return(R-this.points.length)%32}_map(R,j){if(R.numPoints)return j?En({},R.properties):R.properties;const de=this.points[R.index].properties,Le=this.options.map(de);return j&&Le===de?En({},Le):Le}}function Ut(le,R,j,de,Le){return{x:ht(le),y:ht(R),zoom:1/0,id:j,parentId:-1,numPoints:de,properties:Le}}function Gt(le,R){const[j,de]=le.geometry.coordinates;return{x:ht(un(j)),y:ht(ut(de)),zoom:1/0,index:R,parentId:-1}}function wn(le){return{type:"Feature",id:le.id,properties:Fn(le),geometry:{type:"Point",coordinates:[(R=le.x,360*(R-.5)),jt(le.y)]}};var R}function Fn(le){const R=le.numPoints,j=R>=1e4?`${Math.round(R/1e3)}k`:R>=1e3?Math.round(R/100)/10+"k":R;return En(En({},le.properties),{cluster:!0,cluster_id:le.id,point_count:R,point_count_abbreviated:j})}function un(le){return le/360+.5}function ut(le){const R=Math.sin(le*Math.PI/180),j=.5-.25*Math.log((1+R)/(1-R))/Math.PI;return j<0?0:j>1?1:j}function jt(le){const R=(180-360*le)*Math.PI/180;return 360*Math.atan(Math.exp(R))/Math.PI-90}function En(le,R){for(const j in R)le[j]=R[j];return le}function ni(le){return le.x}function ci(le){return le.y}function Un(le,R,j,de){for(var Le,st=de,Bt=j-R>>1,Rt=j-R,at=le[R],Pe=le[R+1],Ue=le[j],Re=le[j+1],nt=R+3;nt<j;nt+=3){var zt=_i(le[nt],le[nt+1],at,Pe,Ue,Re);if(zt>st)Le=nt,st=zt;else if(zt===st){var _n=Math.abs(nt-Bt);_n<Rt&&(Le=nt,Rt=_n)}}st>de&&(Le-R>3&&Un(le,R,Le,de),le[Le+2]=st,j-Le>3&&Un(le,Le,j,de))}function _i(le,R,j,de,Le,st){var Bt=Le-j,Rt=st-de;if(0!==Bt||0!==Rt){var at=((le-j)*Bt+(R-de)*Rt)/(Bt*Bt+Rt*Rt);at>1?(j=Le,de=st):at>0&&(j+=Bt*at,de+=Rt*at)}return(Bt=le-j)*Bt+(Rt=R-de)*Rt}function wi(le,R,j,de){var Le={id:void 0===le?null:le,type:R,geometry:j,tags:de,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(st){var Bt=st.geometry,Rt=st.type;if("Point"===Rt||"MultiPoint"===Rt||"LineString"===Rt)xi(st,Bt);else if("Polygon"===Rt||"MultiLineString"===Rt)for(var at=0;at<Bt.length;at++)xi(st,Bt[at]);else if("MultiPolygon"===Rt)for(at=0;at<Bt.length;at++)for(var Pe=0;Pe<Bt[at].length;Pe++)xi(st,Bt[at][Pe])}(Le),Le}function xi(le,R){for(var j=0;j<R.length;j+=3)le.minX=Math.min(le.minX,R[j]),le.minY=Math.min(le.minY,R[j+1]),le.maxX=Math.max(le.maxX,R[j]),le.maxY=Math.max(le.maxY,R[j+1])}function Ni(le,R,j,de){if(R.geometry){var Le=R.geometry.coordinates,st=R.geometry.type,Bt=Math.pow(j.tolerance/((1<<j.maxZoom)*j.extent),2),Rt=[],at=R.id;if(j.promoteId?at=R.properties[j.promoteId]:j.generateId&&(at=de||0),"Point"===st)Ii(Le,Rt);else if("MultiPoint"===st)for(var Pe=0;Pe<Le.length;Pe++)Ii(Le[Pe],Rt);else if("LineString"===st)Ui(Le,Rt,Bt,!1);else if("MultiLineString"===st){if(j.lineMetrics){for(Pe=0;Pe<Le.length;Pe++)Ui(Le[Pe],Rt=[],Bt,!1),le.push(wi(at,"LineString",Rt,R.properties));return}Yi(Le,Rt,Bt,!1)}else if("Polygon"===st)Yi(Le,Rt,Bt,!0);else{if("MultiPolygon"!==st){if("GeometryCollection"===st){for(Pe=0;Pe<R.geometry.geometries.length;Pe++)Ni(le,{id:at,geometry:R.geometry.geometries[Pe],properties:R.properties},j,de);return}throw new Error("Input data is not a valid GeoJSON object.")}for(Pe=0;Pe<Le.length;Pe++){var Ue=[];Yi(Le[Pe],Ue,Bt,!0),Rt.push(Ue)}}le.push(wi(at,st,Rt,R.properties))}}function Ii(le,R){R.push(Ht(le[0])),R.push(Mt(le[1])),R.push(0)}function Ui(le,R,j,de){for(var Le,st,Bt=0,Rt=0;Rt<le.length;Rt++){var at=Ht(le[Rt][0]),Pe=Mt(le[Rt][1]);R.push(at),R.push(Pe),R.push(0),Rt>0&&(Bt+=de?(Le*Pe-at*st)/2:Math.sqrt(Math.pow(at-Le,2)+Math.pow(Pe-st,2))),Le=at,st=Pe}var Ue=R.length-3;R[2]=1,Un(R,0,Ue,j),R[Ue+2]=1,R.size=Math.abs(Bt),R.start=0,R.end=R.size}function Yi(le,R,j,de){for(var Le=0;Le<le.length;Le++){var st=[];Ui(le[Le],st,j,de),R.push(st)}}function Ht(le){return le/360+.5}function Mt(le){var R=Math.sin(le*Math.PI/180),j=.5-.25*Math.log((1+R)/(1-R))/Math.PI;return j<0?0:j>1?1:j}function qe(le,R,j,de,Le,st,Bt,Rt){if(de/=R,st>=(j/=R)&&Bt<de)return le;if(Bt<j||st>=de)return null;for(var at=[],Pe=0;Pe<le.length;Pe++){var Ue=le[Pe],Re=Ue.geometry,nt=Ue.type,zt=0===Le?Ue.minX:Ue.minY,_n=0===Le?Ue.maxX:Ue.maxY;if(zt>=j&&_n<de)at.push(Ue);else if(!(_n<j||zt>=de)){var Mn=[];if("Point"===nt||"MultiPoint"===nt)re(Re,Mn,j,de,Le);else if("LineString"===nt)tt(Re,Mn,j,de,Le,!1,Rt.lineMetrics);else if("MultiLineString"===nt)Qt(Re,Mn,j,de,Le,!1);else if("Polygon"===nt)Qt(Re,Mn,j,de,Le,!0);else if("MultiPolygon"===nt)for(var Yn=0;Yn<Re.length;Yn++){var di=[];Qt(Re[Yn],di,j,de,Le,!0),di.length&&Mn.push(di)}if(Mn.length){if(Rt.lineMetrics&&"LineString"===nt){for(Yn=0;Yn<Mn.length;Yn++)at.push(wi(Ue.id,nt,Mn[Yn],Ue.tags));continue}"LineString"!==nt&&"MultiLineString"!==nt||(1===Mn.length?(nt="LineString",Mn=Mn[0]):nt="MultiLineString"),"Point"!==nt&&"MultiPoint"!==nt||(nt=3===Mn.length?"Point":"MultiPoint"),at.push(wi(Ue.id,nt,Mn,Ue.tags))}}}return at.length?at:null}function re(le,R,j,de,Le){for(var st=0;st<le.length;st+=3){var Bt=le[st+Le];Bt>=j&&Bt<=de&&(R.push(le[st]),R.push(le[st+1]),R.push(le[st+2]))}}function tt(le,R,j,de,Le,st,Bt){for(var Rt,at,Pe=Wt(le),Ue=0===Le?Ai:er,Re=le.start,nt=0;nt<le.length-3;nt+=3){var zt=le[nt],_n=le[nt+1],Mn=le[nt+2],Yn=le[nt+3],di=le[nt+4],gi=0===Le?zt:_n,Kn=0===Le?Yn:di,Vi=!1;Bt&&(Rt=Math.sqrt(Math.pow(zt-Yn,2)+Math.pow(_n-di,2))),gi<j?Kn>j&&(at=Ue(Pe,zt,_n,Yn,di,j),Bt&&(Pe.start=Re+Rt*at)):gi>de?Kn<de&&(at=Ue(Pe,zt,_n,Yn,di,de),Bt&&(Pe.start=Re+Rt*at)):fi(Pe,zt,_n,Mn),Kn<j&&gi>=j&&(at=Ue(Pe,zt,_n,Yn,di,j),Vi=!0),Kn>de&&gi<=de&&(at=Ue(Pe,zt,_n,Yn,di,de),Vi=!0),!st&&Vi&&(Bt&&(Pe.end=Re+Rt*at),R.push(Pe),Pe=Wt(le)),Bt&&(Re+=Rt)}var Bi=le.length-3;zt=le[Bi],_n=le[Bi+1],Mn=le[Bi+2],(gi=0===Le?zt:_n)>=j&&gi<=de&&fi(Pe,zt,_n,Mn),Bi=Pe.length-3,st&&Bi>=3&&(Pe[Bi]!==Pe[0]||Pe[Bi+1]!==Pe[1])&&fi(Pe,Pe[0],Pe[1],Pe[2]),Pe.length&&R.push(Pe)}function Wt(le){var R=[];return R.size=le.size,R.start=le.start,R.end=le.end,R}function Qt(le,R,j,de,Le,st){for(var Bt=0;Bt<le.length;Bt++)tt(le[Bt],R,j,de,Le,st,!1)}function fi(le,R,j,de){le.push(R),le.push(j),le.push(de)}function Ai(le,R,j,de,Le,st){var Bt=(st-R)/(de-R);return le.push(st),le.push(j+(Le-j)*Bt),le.push(1),Bt}function er(le,R,j,de,Le,st){var Bt=(st-j)/(Le-j);return le.push(R+(de-R)*Bt),le.push(st),le.push(1),Bt}function mi(le,R){for(var j=[],de=0;de<le.length;de++){var Le,st=le[de],Bt=st.type;if("Point"===Bt||"MultiPoint"===Bt||"LineString"===Bt)Le=xr(st.geometry,R);else if("MultiLineString"===Bt||"Polygon"===Bt){Le=[];for(var Rt=0;Rt<st.geometry.length;Rt++)Le.push(xr(st.geometry[Rt],R))}else if("MultiPolygon"===Bt)for(Le=[],Rt=0;Rt<st.geometry.length;Rt++){for(var at=[],Pe=0;Pe<st.geometry[Rt].length;Pe++)at.push(xr(st.geometry[Rt][Pe],R));Le.push(at)}j.push(wi(st.id,Bt,Le,st.tags))}return j}function xr(le,R){var j=[];j.size=le.size,void 0!==le.start&&(j.start=le.start,j.end=le.end);for(var de=0;de<le.length;de+=3)j.push(le[de]+R,le[de+1],le[de+2]);return j}function Pi(le,R){if(le.transformed)return le;var j,de,Le,st=1<<le.z,Bt=le.x,Rt=le.y;for(j=0;j<le.features.length;j++){var at=le.features[j],Pe=at.geometry,Ue=at.type;if(at.geometry=[],1===Ue)for(de=0;de<Pe.length;de+=2)at.geometry.push(br(Pe[de],Pe[de+1],R,st,Bt,Rt));else for(de=0;de<Pe.length;de++){var Re=[];for(Le=0;Le<Pe[de].length;Le+=2)Re.push(br(Pe[de][Le],Pe[de][Le+1],R,st,Bt,Rt));at.geometry.push(Re)}}return le.transformed=!0,le}function br(le,R,j,de,Le,st){return[Math.round(j*(le*de-Le)),Math.round(j*(R*de-st))]}function wr(le,R,j,de,Le){for(var st=R===Le.maxZoom?0:Le.tolerance/((1<<R)*Le.extent),Bt={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:j,y:de,z:R,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},Rt=0;Rt<le.length;Rt++){Bt.numFeatures++,Er(Bt,le[Rt],st,Le);var at=le[Rt].minX,Pe=le[Rt].minY,Ue=le[Rt].maxX,Re=le[Rt].maxY;at<Bt.minX&&(Bt.minX=at),Pe<Bt.minY&&(Bt.minY=Pe),Ue>Bt.maxX&&(Bt.maxX=Ue),Re>Bt.maxY&&(Bt.maxY=Re)}return Bt}function Er(le,R,j,de){var Le=R.geometry,st=R.type,Bt=[];if("Point"===st||"MultiPoint"===st)for(var Rt=0;Rt<Le.length;Rt+=3)Bt.push(Le[Rt]),Bt.push(Le[Rt+1]),le.numPoints++,le.numSimplified++;else if("LineString"===st)ui(Bt,Le,le,j,!1,!1);else if("MultiLineString"===st||"Polygon"===st)for(Rt=0;Rt<Le.length;Rt++)ui(Bt,Le[Rt],le,j,"Polygon"===st,0===Rt);else if("MultiPolygon"===st)for(var at=0;at<Le.length;at++){var Pe=Le[at];for(Rt=0;Rt<Pe.length;Rt++)ui(Bt,Pe[Rt],le,j,!0,0===Rt)}if(Bt.length){var Ue=R.tags||null;if("LineString"===st&&de.lineMetrics){for(var Re in Ue={},R.tags)Ue[Re]=R.tags[Re];Ue.mapbox_clip_start=Le.start/Le.size,Ue.mapbox_clip_end=Le.end/Le.size}var nt={geometry:Bt,type:"Polygon"===st||"MultiPolygon"===st?3:"LineString"===st||"MultiLineString"===st?2:1,tags:Ue};null!==R.id&&(nt.id=R.id),le.features.push(nt)}}function ui(le,R,j,de,Le,st){var Bt=de*de;if(de>0&&R.size<(Le?Bt:de))j.numPoints+=R.length/3;else{for(var Rt=[],at=0;at<R.length;at+=3)(0===de||R[at+2]>Bt)&&(j.numSimplified++,Rt.push(R[at]),Rt.push(R[at+1])),j.numPoints++;Le&&function(Pe,Ue){for(var Re=0,nt=0,zt=Pe.length,_n=zt-2;nt<zt;_n=nt,nt+=2)Re+=(Pe[nt]-Pe[_n])*(Pe[nt+1]+Pe[_n+1]);if(Re>0===Ue)for(nt=0,zt=Pe.length;nt<zt/2;nt+=2){var Mn=Pe[nt],Yn=Pe[nt+1];Pe[nt]=Pe[zt-2-nt],Pe[nt+1]=Pe[zt-1-nt],Pe[zt-2-nt]=Mn,Pe[zt-1-nt]=Yn}}(Rt,st),le.push(Rt)}}function pn(le,R){var j=(R=this.options=function(Le,st){for(var Bt in st)Le[Bt]=st[Bt];return Le}(Object.create(this.options),R)).debug;if(j&&console.time("preprocess data"),R.maxZoom<0||R.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(R.promoteId&&R.generateId)throw new Error("promoteId and generateId cannot be used together.");var Le,st,Bt,Rt,at,Pe,de=function(Le,st){var Bt=[];if("FeatureCollection"===Le.type)for(var Rt=0;Rt<Le.features.length;Rt++)Ni(Bt,Le.features[Rt],st,Rt);else Ni(Bt,"Feature"===Le.type?Le:{geometry:Le},st);return Bt}(le,R);this.tiles={},this.tileCoords=[],j&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",R.indexMaxZoom,R.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),Rt=Le=de,at=qe(Le,1,-1-(Bt=(st=R).buffer/st.extent),Bt,0,-1,2,st),Pe=qe(Le,1,1-Bt,2+Bt,0,-1,2,st),(at||Pe)&&(Rt=qe(Le,1,-Bt,1+Bt,0,-1,2,st)||[],at&&(Rt=mi(at,1).concat(Rt)),Pe&&(Rt=Rt.concat(mi(Pe,-1)))),(de=Rt).length&&this.splitTile(de,0,0,0),j&&(de.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function _t(le,R,j){return 32*((1<<le)*j+R)+le}function kt(le,R){const j=le.tileID.canonical;if(!this._geoJSONIndex)return R(null,null);const de=this._geoJSONIndex.getTile(j.z,j.x,j.y);if(!de)return R(null,null);const Le=new Ze(de.features);let st=he.exports(Le);0===st.byteOffset&&st.byteLength===st.buffer.byteLength||(st=new Uint8Array(st)),R(null,{vectorTile:Le,rawData:st.buffer})}pn.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},pn.prototype.splitTile=function(le,R,j,de,Le,st,Bt){for(var Rt=[le,R,j,de],at=this.options,Pe=at.debug;Rt.length;){de=Rt.pop(),j=Rt.pop(),R=Rt.pop(),le=Rt.pop();var Ue=1<<R,Re=_t(R,j,de),nt=this.tiles[Re];if(!nt&&(Pe>1&&console.time("creation"),nt=this.tiles[Re]=wr(le,R,j,de,at),this.tileCoords.push({z:R,x:j,y:de}),Pe)){Pe>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",R,j,de,nt.numFeatures,nt.numPoints,nt.numSimplified),console.timeEnd("creation"));var zt="z"+R;this.stats[zt]=(this.stats[zt]||0)+1,this.total++}if(nt.source=le,Le){if(R===at.maxZoom||R===Le)continue;var _n=1<<Le-R;if(j!==Math.floor(st/_n)||de!==Math.floor(Bt/_n))continue}else if(R===at.indexMaxZoom||nt.numPoints<=at.indexMaxPoints)continue;if(nt.source=null,0!==le.length){Pe>1&&console.time("clipping");var Mn,Yn,di,gi,Kn,Vi,Bi=.5*at.buffer/at.extent,Qr=.5-Bi,Cr=.5+Bi,on=1+Bi;Mn=Yn=di=gi=null,Kn=qe(le,Ue,j-Bi,j+Cr,0,nt.minX,nt.maxX,at),Vi=qe(le,Ue,j+Qr,j+on,0,nt.minX,nt.maxX,at),le=null,Kn&&(Mn=qe(Kn,Ue,de-Bi,de+Cr,1,nt.minY,nt.maxY,at),Yn=qe(Kn,Ue,de+Qr,de+on,1,nt.minY,nt.maxY,at),Kn=null),Vi&&(di=qe(Vi,Ue,de-Bi,de+Cr,1,nt.minY,nt.maxY,at),gi=qe(Vi,Ue,de+Qr,de+on,1,nt.minY,nt.maxY,at),Vi=null),Pe>1&&console.timeEnd("clipping"),Rt.push(Mn||[],R+1,2*j,2*de),Rt.push(Yn||[],R+1,2*j,2*de+1),Rt.push(di||[],R+1,2*j+1,2*de),Rt.push(gi||[],R+1,2*j+1,2*de+1)}}},pn.prototype.getTile=function(le,R,j){var de=this.options,Le=de.extent,st=de.debug;if(le<0||le>24)return null;var Bt=1<<le,Rt=_t(le,R=(R%Bt+Bt)%Bt,j);if(this.tiles[Rt])return Pi(this.tiles[Rt],Le);st>1&&console.log("drilling down to z%d-%d-%d",le,R,j);for(var at,Pe=le,Ue=R,Re=j;!at&&Pe>0;)Pe--,Ue=Math.floor(Ue/2),Re=Math.floor(Re/2),at=this.tiles[_t(Pe,Ue,Re)];return at&&at.source?(st>1&&console.log("found parent tile z%d-%d-%d",Pe,Ue,Re),st>1&&console.time("drilling down"),this.splitTile(at.source,Pe,Ue,Re,le,R,j),st>1&&console.timeEnd("drilling down"),this.tiles[Rt]?Pi(this.tiles[Rt],Le):null):null};class gn extends c.VectorTileWorkerSource{constructor(R,j,de,Le,st){super(R,j,de,Le,kt),st&&(this.loadGeoJSON=st)}loadData(R,j){const de=R&&R.request,Le=de&&de.collectResourceTiming;this.loadGeoJSON(R,(st,Bt)=>{if(st||!Bt)return j(st);if("object"!=typeof Bt)return j(new Error(`Input data given to '${R.source}' is not a valid GeoJSON object.`));{Ie(Bt,!0);try{if(R.filter){const at=c.createExpression(R.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if("error"===at.result)throw new Error(at.value.map(Ue=>`${Ue.key}: ${Ue.message}`).join(", "));Bt={type:"FeatureCollection",features:Bt.features.filter(Ue=>at.value.evaluate({zoom:0},Ue))}}this._geoJSONIndex=R.cluster?new Ct(function({superclusterOptions:at,clusterProperties:Pe}){if(!Pe||!at)return at;const Ue={},Re={},nt={accumulated:null,zoom:0},zt={properties:null},_n=Object.keys(Pe);for(const Mn of _n){const[Yn,di]=Pe[Mn],gi=c.createExpression(di),Kn=c.createExpression("string"==typeof Yn?[Yn,["accumulated"],["get",Mn]]:Yn);Ue[Mn]=gi.value,Re[Mn]=Kn.value}return at.map=Mn=>{zt.properties=Mn;const Yn={};for(const di of _n)Yn[di]=Ue[di].evaluate(nt,zt);return Yn},at.reduce=(Mn,Yn)=>{zt.properties=Yn;for(const di of _n)nt.accumulated=Mn[di],Mn[di]=Re[di].evaluate(nt,zt)},at}(R)).load(Bt.features):new pn(at=Bt,R.geojsonVtOptions)}catch(at){return j(at)}this.loaded={};const Rt={};if(Le){const at=c.getPerformanceMeasurement(de);at&&(Rt.resourceTiming={},Rt.resourceTiming[R.source]=JSON.parse(JSON.stringify(at)))}j(null,Rt)}var at})}reloadTile(R,j){const de=this.loaded;return de&&de[R.uid]?super.reloadTile(R,j):this.loadTile(R,j)}loadGeoJSON(R,j){if(R.request)c.getJSON(R.request,j);else{if("string"!=typeof R.data)return j(new Error(`Input data given to '${R.source}' is not a valid GeoJSON object.`));try{return j(null,JSON.parse(R.data))}catch{return j(new Error(`Input data given to '${R.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(R,j){try{j(null,this._geoJSONIndex.getClusterExpansionZoom(R.clusterId))}catch(de){j(de)}}getClusterChildren(R,j){try{j(null,this._geoJSONIndex.getChildren(R.clusterId))}catch(de){j(de)}}getClusterLeaves(R,j){try{j(null,this._geoJSONIndex.getLeaves(R.clusterId,R.limit,R.offset))}catch(de){j(de)}}}class Ve{constructor(R){this.self=R,this.actor=new c.Actor(R,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=c.getProjection({name:"mercator"}),this.workerSourceTypes={vector:c.VectorTileWorkerSource,geojson:gn},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(j,de)=>{if(this.workerSourceTypes[j])throw new Error(`Worker source with name "${j}" already registered.`);this.workerSourceTypes[j]=de},this.self.registerRTLTextPlugin=j=>{if(c.plugin.isParsed())throw new Error("RTL text plugin already registered.");c.plugin.applyArabicShaping=j.applyArabicShaping,c.plugin.processBidirectionalText=j.processBidirectionalText,c.plugin.processStyledBidirectionalText=j.processStyledBidirectionalText}}clearCaches(R,j,de){delete this.layerIndexes[R],delete this.availableImages[R],delete this.workerSources[R],delete this.demWorkerSources[R],de()}checkIfReady(R,j,de){de()}setReferrer(R,j){this.referrer=j}spriteLoaded(R,j){this.isSpriteLoaded[R]=j;for(const de in this.workerSources[R]){const Le=this.workerSources[R][de];for(const st in Le)Le[st]instanceof c.VectorTileWorkerSource&&(Le[st].isSpriteLoaded=j,Le[st].fire(new c.Event("isSpriteLoaded")))}}setImages(R,j,de){this.availableImages[R]=j;for(const Le in this.workerSources[R]){const st=this.workerSources[R][Le];for(const Bt in st)st[Bt].availableImages=j}de()}enableTerrain(R,j,de){this.terrain=j,de()}setProjection(R,j){this.projections[R]=c.getProjection(j)}setLayers(R,j,de){this.getLayerIndex(R).replace(j),de()}updateLayers(R,j,de){this.getLayerIndex(R).update(j.layers,j.removedIds),de()}loadTile(R,j,de){const Le=this.enableTerrain?c.extend({enableTerrain:this.terrain},j):j;Le.projection=this.projections[R]||this.defaultProjection,this.getWorkerSource(R,j.type,j.source).loadTile(Le,de)}loadDEMTile(R,j,de){const Le=this.enableTerrain?c.extend({buildQuadTree:this.terrain},j):j;this.getDEMWorkerSource(R,j.source).loadTile(Le,de)}reloadTile(R,j,de){const Le=this.enableTerrain?c.extend({enableTerrain:this.terrain},j):j;Le.projection=this.projections[R]||this.defaultProjection,this.getWorkerSource(R,j.type,j.source).reloadTile(Le,de)}abortTile(R,j,de){this.getWorkerSource(R,j.type,j.source).abortTile(j,de)}removeTile(R,j,de){this.getWorkerSource(R,j.type,j.source).removeTile(j,de)}removeSource(R,j,de){if(!this.workerSources[R]||!this.workerSources[R][j.type]||!this.workerSources[R][j.type][j.source])return;const Le=this.workerSources[R][j.type][j.source];delete this.workerSources[R][j.type][j.source],void 0!==Le.removeSource?Le.removeSource(j,de):de()}loadWorkerSource(R,j,de){try{this.self.importScripts(j.url),de()}catch(Le){de(Le.toString())}}syncRTLPluginState(R,j,de){try{c.plugin.setState(j);const Le=c.plugin.getPluginURL();if(c.plugin.isLoaded()&&!c.plugin.isParsed()&&null!=Le){this.self.importScripts(Le);const st=c.plugin.isParsed();de(st?void 0:new Error(`RTL Text Plugin failed to import scripts from ${Le}`),st)}}catch(Le){de(Le.toString())}}getAvailableImages(R){let j=this.availableImages[R];return j||(j=[]),j}getLayerIndex(R){let j=this.layerIndexes[R];return j||(j=this.layerIndexes[R]=new y),j}getWorkerSource(R,j,de){return this.workerSources[R]||(this.workerSources[R]={}),this.workerSources[R][j]||(this.workerSources[R][j]={}),this.workerSources[R][j][de]||(this.workerSources[R][j][de]=new this.workerSourceTypes[j]({send:(st,Bt,Rt,at,Pe,Ue)=>{this.actor.send(st,Bt,Rt,R,Pe,Ue)},scheduler:this.actor.scheduler},this.getLayerIndex(R),this.getAvailableImages(R),this.isSpriteLoaded[R])),this.workerSources[R][j][de]}getDEMWorkerSource(R,j){return this.demWorkerSources[R]||(this.demWorkerSources[R]={}),this.demWorkerSources[R][j]||(this.demWorkerSources[R][j]=new fe),this.demWorkerSources[R][j]}enforceCacheSizeLimit(R,j){c.enforceCacheSizeLimit(j)}getWorkerPerformanceMetrics(R,j,de){de(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new Ve(self)),Ve}),g(0,function(c){function Y(l,t){if(Array.isArray(l)){if(!Array.isArray(t)||l.length!==t.length)return!1;for(let s=0;s<l.length;s++)if(!Y(l[s],t[s]))return!1;return!0}if("object"==typeof l&&null!==l&&null!==t){if("object"!=typeof t||Object.keys(l).length!==Object.keys(t).length)return!1;for(const s in l)if(!Y(l[s],t[s]))return!1;return!0}return l===t}var se=y;function y(l){return t=l,!(typeof window>"u"||typeof document>"u"||!(Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray)||!Function.prototype||!Function.prototype.bind||!(Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions)||!("JSON"in window&&"parse"in JSON&&"stringify"in JSON)||!function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var p,v,b=new Blob([""],{type:"text/javascript"}),D=URL.createObjectURL(b);try{v=new Worker(D),p=!0}catch{p=!1}return v&&v.terminate(),URL.revokeObjectURL(D),p}()||!("Uint8ClampedArray"in window)||!ArrayBuffer.isView||!function(){var p=document.createElement("canvas");p.width=p.height=1;var v=p.getContext("2d");if(!v)return!1;var b=v.getImageData(0,0,1,1);return b&&b.width===p.width}()||(void 0===fe[s=t&&t.failIfMajorPerformanceCaveat]&&(fe[s]=function(p){var v,D,O,k,b=(D=p,O=document.createElement("canvas"),(k=Object.create(y.webGLContextAttributes)).failIfMajorPerformanceCaveat=D,O.getContext("webgl",k)||O.getContext("experimental-webgl",k));if(!b)return!1;try{v=b.createShader(b.VERTEX_SHADER)}catch{return!1}return!(!v||b.isContextLost())&&(b.shaderSource(v,"void main() {}"),b.compileShader(v),!0===b.getShaderParameter(v,b.COMPILE_STATUS))}(s)),!fe[s]||document.documentMode));var t,s}var fe={};function Ie(l,t,s){const p=c.window.document.createElement(l);return void 0!==t&&(p.className=t),s&&s.appendChild(p),p}function Ge(l,t,s){const p=c.window.document.createElementNS("http://www.w3.org/2000/svg",l);for(const v of Object.keys(t))p.setAttributeNS(null,v,t[v]);return s&&s.appendChild(p),p}y.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const Q=c.window.document&&c.window.document.documentElement.style,be=Q&&void 0!==Q.userSelect?"userSelect":"WebkitUserSelect";let me;function Ze(){Q&&be&&(me=Q[be],Q[be]="none")}function he(){Q&&be&&(Q[be]=me)}function Ke(l){l.preventDefault(),l.stopPropagation(),c.window.removeEventListener("click",Ke,!0)}function Ae(){c.window.addEventListener("click",Ke,!0),c.window.setTimeout(()=>{c.window.removeEventListener("click",Ke,!0)},0)}function te(l,t){const s=l.getBoundingClientRect();return dt(l,s,t)}function Qe(l,t){const s=l.getBoundingClientRect(),p=[];for(let v=0;v<t.length;v++)p.push(dt(l,s,t[v]));return p}function Ot(l){return void 0!==c.window.InstallTrigger&&2===l.button&&l.ctrlKey&&c.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:l.button}function dt(l,t,s){const p=l.offsetWidth===t.width?1:l.offsetWidth/t.width;return new c.pointGeometry((s.clientX-t.left)*p,(s.clientY-t.top)*p)}function ye(l,t){var s=t[0],p=t[1],v=t[2],b=t[3],D=s*b-v*p;return D?(l[0]=b*(D=1/D),l[1]=-p*D,l[2]=-v*D,l[3]=s*D,l):null}function Fe(l){const{userImage:t}=l;return!!(t&&t.render&&t.render())&&(l.data.replace(new Uint8Array(t.data.buffer)),!0)}class Ne extends c.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new c.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(t){if(this.loaded!==t&&(this.loaded=t,t)){for(const{ids:s,callback:p}of this.requestors)this._notify(s,p);this.requestors=[]}}hasImage(t){return!!this.getImage(t)}getImage(t){return this.images[t]}addImage(t,s){this._validate(t,s)&&(this.images[t]=s)}_validate(t,s){let p=!0;return this._validateStretch(s.stretchX,s.data&&s.data.width)||(this.fire(new c.ErrorEvent(new Error(`Image "${t}" has invalid "stretchX" value`))),p=!1),this._validateStretch(s.stretchY,s.data&&s.data.height)||(this.fire(new c.ErrorEvent(new Error(`Image "${t}" has invalid "stretchY" value`))),p=!1),this._validateContent(s.content,s)||(this.fire(new c.ErrorEvent(new Error(`Image "${t}" has invalid "content" value`))),p=!1),p}_validateStretch(t,s){if(!t)return!0;let p=0;for(const v of t){if(v[0]<p||v[1]<v[0]||s<v[1])return!1;p=v[1]}return!0}_validateContent(t,s){return!(t&&(4!==t.length||t[0]<0||s.data.width<t[0]||t[1]<0||s.data.height<t[1]||t[2]<0||s.data.width<t[2]||t[3]<0||s.data.height<t[3]||t[2]<t[0]||t[3]<t[1]))}updateImage(t,s){s.version=this.images[t].version+1,this.images[t]=s,this.updatedImages[t]=!0}removeImage(t){const s=this.images[t];delete this.images[t],delete this.patterns[t],s.userImage&&s.userImage.onRemove&&s.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(t,s){let p=!0;if(!this.isLoaded())for(const v of t)this.images[v]||(p=!1);this.isLoaded()||p?this._notify(t,s):this.requestors.push({ids:t,callback:s})}_notify(t,s){const p={};for(const v of t){this.images[v]||this.fire(new c.Event("styleimagemissing",{id:v}));const b=this.images[v];b?p[v]={data:b.data.clone(),pixelRatio:b.pixelRatio,sdf:b.sdf,version:b.version,stretchX:b.stretchX,stretchY:b.stretchY,content:b.content,hasRenderCallback:Boolean(b.userImage&&b.userImage.render)}:c.warnOnce(`Image "${v}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}s(null,p)}getPixelSize(){const{width:t,height:s}=this.atlasImage;return{width:t,height:s}}getPattern(t){const s=this.patterns[t],p=this.getImage(t);if(!p)return null;if(s&&s.position.version===p.version)return s.position;if(s)s.position.version=p.version;else{const v={w:p.data.width+2,h:p.data.height+2,x:0,y:0},b=new c.ImagePosition(v,p);this.patterns[t]={bin:v,position:b}}return this._updatePatternAtlas(),this.patterns[t].position}bind(t){const s=t.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new c.Texture(t,this.atlasImage,s.RGBA),this.atlasTexture.bind(s.LINEAR,s.CLAMP_TO_EDGE)}_updatePatternAtlas(){const t=[];for(const b in this.patterns)t.push(this.patterns[b].bin);const{w:s,h:p}=c.potpack(t),v=this.atlasImage;v.resize({width:s||1,height:p||1});for(const b in this.patterns){const{bin:D}=this.patterns[b],O=D.x+1,k=D.y+1,H=this.images[b].data,J=H.width,ue=H.height;c.RGBAImage.copy(H,v,{x:0,y:0},{x:O,y:k},{width:J,height:ue}),c.RGBAImage.copy(H,v,{x:0,y:ue-1},{x:O,y:k-1},{width:J,height:1}),c.RGBAImage.copy(H,v,{x:0,y:0},{x:O,y:k+ue},{width:J,height:1}),c.RGBAImage.copy(H,v,{x:J-1,y:0},{x:O-1,y:k},{width:1,height:ue}),c.RGBAImage.copy(H,v,{x:0,y:0},{x:O+J,y:k},{width:1,height:ue})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(t){for(const s of t){if(this.callbackDispatchedThisFrame[s])continue;this.callbackDispatchedThisFrame[s]=!0;const p=this.images[s];Fe(p)&&this.updateImage(s,p)}}}const we=new c.Properties({anchor:new c.DataConstantProperty(c.spec.light.anchor),position:new class{constructor(){this.specification=c.spec.light.position}possiblyEvaluate(l,t){return function([s,p,v]){const b=c.degToRad(p+90),D=c.degToRad(v);return{x:s*Math.cos(b)*Math.sin(D),y:s*Math.sin(b)*Math.sin(D),z:s*Math.cos(D),azimuthal:p,polar:v}}(l.expression.evaluate(t))}interpolate(l,t,s){return{x:c.number(l.x,t.x,s),y:c.number(l.y,t.y,s),z:c.number(l.z,t.z,s),azimuthal:c.number(l.azimuthal,t.azimuthal,s),polar:c.number(l.polar,t.polar,s)}}},color:new c.DataConstantProperty(c.spec.light.color),intensity:new c.DataConstantProperty(c.spec.light.intensity)}),et="-transition";class Je extends c.Evented{constructor(t){super(),this._transitionable=new c.Transitionable(we),this.setLight(t),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(t,s={}){if(!this._validate(c.validateLight,t,s))for(const p in t){const v=t[p];c.endsWith(p,et)?this._transitionable.setTransition(p.slice(0,-et.length),v):this._transitionable.setValue(p,v)}}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}_validate(t,s,p){return(!p||!1!==p.validate)&&c.emitValidationErrors(this,t.call(c.validateStyle,c.extend({value:s,style:{glyphs:!0,sprite:!0},styleSpec:c.spec})))}}const _e=new c.Properties({source:new c.DataConstantProperty(c.spec.terrain.source),exaggeration:new c.DataConstantProperty(c.spec.terrain.exaggeration)}),pe="-transition";class ae extends c.Evented{constructor(t,s){super(),this._transitionable=new c.Transitionable(_e),this.set(t),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=s}get(){return this._transitionable.serialize()}set(t){for(const s in t){const p=t[s];c.endsWith(s,pe)?this._transitionable.setTransition(s.slice(0,-pe.length),p):this._transitionable.setValue(s,p)}}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}}function Ee(l,t,s,p){const v=c.smoothstep(45,65,s),[b,D]=vt(l,p),O=c.length(t);let k=1-Math.min(1,Math.exp((O-b)/(D-b)*-6));return k*=k*k,k=Math.min(1,1.00747*k),k*v*l.alpha}function vt(l,t){const s=.5/Math.tan(.5*t);return[l.range[0]+s,l.range[1]+s]}const Et=new c.Properties({range:new c.DataConstantProperty(c.spec.fog.range),color:new c.DataConstantProperty(c.spec.fog.color),"high-color":new c.DataConstantProperty(c.spec.fog["high-color"]),"space-color":new c.DataConstantProperty(c.spec.fog["space-color"]),"horizon-blend":new c.DataConstantProperty(c.spec.fog["horizon-blend"]),"star-intensity":new c.DataConstantProperty(c.spec.fog["star-intensity"])}),qt="-transition";class Ft extends c.Evented{constructor(t,s){super(),this._transitionable=new c.Transitionable(Et),this.set(t),this._transitioning=this._transitionable.untransitioned(),this._transform=s}get state(){const t=this._transform,s="globe"===t.projection.name,p=c.globeToMercatorTransition(t.zoom),v=this.properties.get("range"),b=[.5,3];return{range:s?[c.number(b[0],v[0],p),c.number(b[1],v[1],p)]:v,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(t,s={}){if(!this._validate(c.validateFog,t,s)){for(const p of Object.keys(c.spec.fog))t&&void 0===t[p]&&(t[p]=c.spec.fog[p].default);for(const p in t){const v=t[p];c.endsWith(p,qt)?this._transitionable.setTransition(p.slice(0,-qt.length),v):this._transitionable.setValue(p,v)}}}getOpacity(t){if(!this._transform.projection.supportsFog)return 0;const s=this.properties&&this.properties.get("color")||1;return("globe"===this._transform.projection.name?1:c.smoothstep(45,65,t))*s.a}getOpacityAtLatLng(t,s){return this._transform.projection.supportsFog?function(p,v,b){const D=c.MercatorCoordinate.fromLngLat(v),O=b.elevation?b.elevation.getAtPointOrZero(D):0,k=[D.x,D.y,O];return c.transformMat4(k,k,b.mercatorFogMatrix),Ee(p,k,b.pitch,b._fov)}(this.state,t,s):0}getFovAdjustedRange(t){return this._transform.projection.supportsFog?vt(this.state,t):[0,1]}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}_validate(t,s,p){return(!p||!1!==p.validate)&&c.emitValidationErrors(this,t.call(c.validateStyle,c.extend({value:s,style:{glyphs:!0,sprite:!0},styleSpec:c.spec})))}}class xt{constructor(t,s){this.workerPool=t,this.actors=[],this.currentActor=0,this.id=c.uniqueId();const p=this.workerPool.acquire(this.id);for(let v=0;v<p.length;v++){const b=new xt.Actor(p[v],s,this.id);b.name=`Worker ${v}`,this.actors.push(b)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(t,s,p){c.asyncAll(this.actors,(v,b)=>{v.send(t,s,b)},p=p||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(t=>{t.remove()}),this.actors=[],this.workerPool.release(this.id)}}function Pt(l,t,s){return t*(c.EXTENT/(l.tileSize*Math.pow(2,s-l.tileID.overscaledZ)))}xt.Actor=c.Actor;class bt{constructor(t,s,p,v){this.screenBounds=t,this.cameraPoint=s,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=p,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,v)}static createFromScreenPoints(t,s){let p,v;if(t instanceof c.pointGeometry||"number"==typeof t[0]){const b=c.pointGeometry.convert(t);p=[b],v=s.isPointAboveHorizon(b)}else{const b=c.pointGeometry.convert(t[0]),D=c.pointGeometry.convert(t[1]);p=[b,D],v=c.polygonizeBounds(b,D).every(O=>s.isPointAboveHorizon(O))}return new bt(p,s.getCameraPoint(),v,s)}isPointQuery(){return 1===this.screenBounds.length}bufferedScreenGeometry(t){return c.polygonizeBounds(this.screenBounds[0],1===this.screenBounds.length?this.screenBounds[0]:this.screenBounds[1],t)}bufferedCameraGeometry(t){const s=this.screenBounds[0],p=1===this.screenBounds.length?this.screenBounds[0].add(new c.pointGeometry(1,1)):this.screenBounds[1],v=c.polygonizeBounds(s,p,0,!1);return this.cameraPoint.y>p.y&&(this.cameraPoint.x>s.x&&this.cameraPoint.x<p.x?v.splice(3,0,this.cameraPoint):this.cameraPoint.x>=p.x?v[2]=this.cameraPoint:this.cameraPoint.x<=s.x&&(v[3]=this.cameraPoint)),c.bufferConvexPolygon(v,t)}bufferedCameraGeometryGlobe(t){const s=this.screenBounds[0],p=1===this.screenBounds.length?this.screenBounds[0].add(new c.pointGeometry(1,1)):this.screenBounds[1],v=c.polygonizeBounds(s,p,t),b=this.cameraPoint.clone();switch(3*((b.y>s.y)+(b.y>p.y))+((b.x>s.x)+(b.x>p.x))){case 0:v[0]=b,v[4]=b.clone();break;case 1:v.splice(1,0,b);break;case 2:v[1]=b;break;case 3:v.splice(4,0,b);break;case 5:v.splice(2,0,b);break;case 6:v[3]=b;break;case 7:v.splice(3,0,b);break;case 8:v[2]=b}return v}containsTile(t,s,p,v=0){const b=t.queryPadding/s._pixelsPerMercatorPixel+1,D=p?this._bufferedCameraMercator(b,s):this._bufferedScreenMercator(b,s);let O=t.tileID.wrap+(D.unwrapped?v:0);const k=D.polygon.map($e=>c.getTilePoint(t.tileTransform,$e,O));if(!c.polygonIntersectsBox(k,0,0,c.EXTENT,c.EXTENT))return;O=t.tileID.wrap+(this.screenGeometryMercator.unwrapped?v:0);const H=this.screenGeometryMercator.polygon.map($e=>c.getTileVec3(t.tileTransform,$e,O)),J=H.map($e=>new c.pointGeometry($e[0],$e[1])),ue=s.getFreeCameraOptions().position||new c.MercatorCoordinate(0,0,0),De=c.getTileVec3(t.tileTransform,ue,O),je=H.map($e=>{const Be=c.sub($e,$e,De);return c.normalize(Be,Be),new c.Ray(De,Be)}),ke=Pt(t,1,s.zoom)*s._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:J,tilespaceRays:je,bufferedTilespaceGeometry:k,bufferedTilespaceBounds:(Ye=c.getBounds(k),Ye.min.x=c.clamp(Ye.min.x,0,c.EXTENT),Ye.min.y=c.clamp(Ye.min.y,0,c.EXTENT),Ye.max.x=c.clamp(Ye.max.x,0,c.EXTENT),Ye.max.y=c.clamp(Ye.max.y,0,c.EXTENT),Ye),tile:t,tileID:t.tileID,pixelToTileUnitsFactor:ke};var Ye}_bufferedScreenMercator(t,s){const p=Ce(t);if(this._screenRaycastCache[p])return this._screenRaycastCache[p];{let v;return v="globe"===s.projection.name?this._projectAndResample(this.bufferedScreenGeometry(t),s):{polygon:this.bufferedScreenGeometry(t).map(b=>s.pointCoordinate3D(b)),unwrapped:!0},this._screenRaycastCache[p]=v,v}}_bufferedCameraMercator(t,s){const p=Ce(t);if(this._cameraRaycastCache[p])return this._cameraRaycastCache[p];{let v;return v="globe"===s.projection.name?this._projectAndResample(this.bufferedCameraGeometryGlobe(t),s):{polygon:this.bufferedCameraGeometry(t).map(b=>s.pointCoordinate3D(b)),unwrapped:!0},this._cameraRaycastCache[p]=v,v}}_projectAndResample(t,s){const p=function(b,D){const O=c.multiply([],D.pixelMatrix,D.globeMatrix),k=[0,-c.GLOBE_RADIUS,0,1],H=[0,c.GLOBE_RADIUS,0,1],J=[0,0,0,1];c.transformMat4$1(k,k,O),c.transformMat4$1(H,H,O),c.transformMat4$1(J,J,O);const ue=new c.pointGeometry(k[0]/k[3],k[1]/k[3]),De=new c.pointGeometry(H[0]/H[3],H[1]/H[3]),je=c.polygonContainsPoint(b,ue)&&k[3]<J[3],ke=c.polygonContainsPoint(b,De)&&H[3]<J[3];if(!je&&!ke)return null;const Ye=function(It,Jt,cn){for(let Xt=1;Xt<It.length;Xt++){const An=ht(Jt.pointCoordinate3D(It[Xt-1]).x),Zt=ht(Jt.pointCoordinate3D(It[Xt]).x);if(cn<0){if(An<Zt)return{idx:Xt,t:-An/(Zt-1-An)}}else if(Zt<An)return{idx:Xt,t:(1-An)/(Zt+1-An)}}return null}(b,D,je?-1:1);if(!Ye)return null;const{idx:$e,t:Be}=Ye;let Xe=$e>1?ct(b.slice(0,$e),D):[],We=$e<b.length?ct(b.slice($e),D):[];Xe=Xe.map(It=>new c.pointGeometry(ht(It.x),It.y)),We=We.map(It=>new c.pointGeometry(ht(It.x),It.y));const gt=[...Xe];0===gt.length&&gt.push(We[We.length-1]);const yt=c.number(gt[gt.length-1].y,(0===We.length?Xe[0]:We[0]).y,Be);let ot;return ot=je?[new c.pointGeometry(0,yt),new c.pointGeometry(0,0),new c.pointGeometry(1,0),new c.pointGeometry(1,yt)]:[new c.pointGeometry(1,yt),new c.pointGeometry(1,1),new c.pointGeometry(0,1),new c.pointGeometry(0,yt)],gt.push(...ot),0===We.length?gt.push(Xe[0]):gt.push(...We),{polygon:gt.map(It=>new c.MercatorCoordinate(It.x,It.y)),unwrapped:!1}}(t,s);if(p)return p;const v=function(b,D){let O=!1,k=-1/0,H=0;for(let ue=0;ue<b.length-1;ue++)b[ue].x>k&&(k=b[ue].x,H=ue);for(let ue=0;ue<b.length-1;ue++){const De=(H+ue)%(b.length-1),je=b[De],ke=b[De+1];Math.abs(je.x-ke.x)>.5&&(je.x<ke.x?(je.x+=1,0===De&&(b[b.length-1].x+=1)):(ke.x+=1,De+1===b.length-1&&(b[0].x+=1)),O=!0)}const J=c.mercatorXfromLng(D.center.lng);return O&&J<Math.abs(J-1)&&b.forEach(ue=>{ue.x-=1}),{polygon:b,unwrapped:O}}(ct(t,s).map(b=>new c.pointGeometry(ht(b.x),b.y)),s);return{polygon:v.polygon.map(b=>new c.MercatorCoordinate(b.x,b.y)),unwrapped:v.unwrapped}}}function ct(l,t){return c.resample(l,s=>{const p=t.pointCoordinate3D(s);s.x=p.x,s.y=p.y},1/256)}function ht(l){return l<0?1+l%1:l%1}function Ce(l){return 100*l|0}function Ct(l,t,s,p,v){const b=function(D,O){if(D)return v(D);if(O){l.url&&O.tiles&&l.tiles&&delete l.tiles;const k=c.pick(c.extend(O,l),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);O.vector_layers&&(k.vectorLayers=O.vector_layers,k.vectorLayerIds=k.vectorLayers.map(H=>H.id)),k.tiles=t.canonicalizeTileset(k,l.url),v(null,k)}};return l.url?c.getJSON(t.transformRequest(t.normalizeSourceURL(l.url,null,s,p),c.ResourceType.Source),b):c.exported.frame(()=>b(null,l))}class Ut{constructor(t,s,p){this.bounds=c.LngLatBounds.convert(this.validateBounds(t)),this.minzoom=s||0,this.maxzoom=p||24}validateBounds(t){return Array.isArray(t)&&4===t.length?[Math.max(-180,t[0]),Math.max(-90,t[1]),Math.min(180,t[2]),Math.min(90,t[3])]:[-180,-90,180,90]}contains(t){const s=Math.pow(2,t.z),p=Math.floor(c.mercatorXfromLng(this.bounds.getWest())*s),v=Math.floor(c.mercatorYfromLat(this.bounds.getNorth())*s),b=Math.ceil(c.mercatorXfromLng(this.bounds.getEast())*s),D=Math.ceil(c.mercatorYfromLat(this.bounds.getSouth())*s);return t.x>=p&&t.x<b&&t.y>=v&&t.y<D}}class Gt{constructor(t,s,p){this.context=t;const v=t.gl;this.buffer=v.createBuffer(),this.dynamicDraw=Boolean(p),this.context.unbindVAO(),t.bindElementBuffer.set(this.buffer),v.bufferData(v.ELEMENT_ARRAY_BUFFER,s.arrayBuffer,this.dynamicDraw?v.DYNAMIC_DRAW:v.STATIC_DRAW),this.dynamicDraw||s.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(t){const s=this.context.gl;this.context.unbindVAO(),this.bind(),s.bufferSubData(s.ELEMENT_ARRAY_BUFFER,0,t.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const wn={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Fn{constructor(t,s,p,v){this.length=s.length,this.attributes=p,this.itemSize=s.bytesPerElement,this.dynamicDraw=v,this.context=t;const b=t.gl;this.buffer=b.createBuffer(),t.bindVertexBuffer.set(this.buffer),b.bufferData(b.ARRAY_BUFFER,s.arrayBuffer,this.dynamicDraw?b.DYNAMIC_DRAW:b.STATIC_DRAW),this.dynamicDraw||s.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(t){const s=this.context.gl;this.bind(),s.bufferSubData(s.ARRAY_BUFFER,0,t.arrayBuffer)}enableAttributes(t,s){for(let p=0;p<this.attributes.length;p++){const v=s.attributes[this.attributes[p].name];void 0!==v&&t.enableVertexAttribArray(v)}}setVertexAttribPointers(t,s,p){for(let v=0;v<this.attributes.length;v++){const b=this.attributes[v],D=s.attributes[b.name];void 0!==D&&t.vertexAttribPointer(D,b.components,t[wn[b.type]],!1,this.itemSize,b.offset+this.itemSize*(p||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class un{constructor(t){this.gl=t.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(t){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class ut extends un{getDefault(){return c.Color.transparent}set(t){const s=this.current;(t.r!==s.r||t.g!==s.g||t.b!==s.b||t.a!==s.a||this.dirty)&&(this.gl.clearColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class jt extends un{getDefault(){return 1}set(t){(t!==this.current||this.dirty)&&(this.gl.clearDepth(t),this.current=t,this.dirty=!1)}}class En extends un{getDefault(){return 0}set(t){(t!==this.current||this.dirty)&&(this.gl.clearStencil(t),this.current=t,this.dirty=!1)}}class ni extends un{getDefault(){return[!0,!0,!0,!0]}set(t){const s=this.current;(t[0]!==s[0]||t[1]!==s[1]||t[2]!==s[2]||t[3]!==s[3]||this.dirty)&&(this.gl.colorMask(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class ci extends un{getDefault(){return!0}set(t){(t!==this.current||this.dirty)&&(this.gl.depthMask(t),this.current=t,this.dirty=!1)}}class Un extends un{getDefault(){return 255}set(t){(t!==this.current||this.dirty)&&(this.gl.stencilMask(t),this.current=t,this.dirty=!1)}}class _i extends un{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(t){const s=this.current;(t.func!==s.func||t.ref!==s.ref||t.mask!==s.mask||this.dirty)&&(this.gl.stencilFunc(t.func,t.ref,t.mask),this.current=t,this.dirty=!1)}}class wi extends un{getDefault(){const t=this.gl;return[t.KEEP,t.KEEP,t.KEEP]}set(t){const s=this.current;(t[0]!==s[0]||t[1]!==s[1]||t[2]!==s[2]||this.dirty)&&(this.gl.stencilOp(t[0],t[1],t[2]),this.current=t,this.dirty=!1)}}class xi extends un{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const s=this.gl;t?s.enable(s.STENCIL_TEST):s.disable(s.STENCIL_TEST),this.current=t,this.dirty=!1}}class Ni extends un{getDefault(){return[0,1]}set(t){const s=this.current;(t[0]!==s[0]||t[1]!==s[1]||this.dirty)&&(this.gl.depthRange(t[0],t[1]),this.current=t,this.dirty=!1)}}class Ii extends un{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const s=this.gl;t?s.enable(s.DEPTH_TEST):s.disable(s.DEPTH_TEST),this.current=t,this.dirty=!1}}class Ui extends un{getDefault(){return this.gl.LESS}set(t){(t!==this.current||this.dirty)&&(this.gl.depthFunc(t),this.current=t,this.dirty=!1)}}class Yi extends un{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const s=this.gl;t?s.enable(s.BLEND):s.disable(s.BLEND),this.current=t,this.dirty=!1}}class Ht extends un{getDefault(){const t=this.gl;return[t.ONE,t.ZERO]}set(t){const s=this.current;(t[0]!==s[0]||t[1]!==s[1]||this.dirty)&&(this.gl.blendFunc(t[0],t[1]),this.current=t,this.dirty=!1)}}class Mt extends un{getDefault(){return c.Color.transparent}set(t){const s=this.current;(t.r!==s.r||t.g!==s.g||t.b!==s.b||t.a!==s.a||this.dirty)&&(this.gl.blendColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class qe extends un{getDefault(){return this.gl.FUNC_ADD}set(t){(t!==this.current||this.dirty)&&(this.gl.blendEquation(t),this.current=t,this.dirty=!1)}}class re extends un{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const s=this.gl;t?s.enable(s.CULL_FACE):s.disable(s.CULL_FACE),this.current=t,this.dirty=!1}}class tt extends un{getDefault(){return this.gl.BACK}set(t){(t!==this.current||this.dirty)&&(this.gl.cullFace(t),this.current=t,this.dirty=!1)}}class Wt extends un{getDefault(){return this.gl.CCW}set(t){(t!==this.current||this.dirty)&&(this.gl.frontFace(t),this.current=t,this.dirty=!1)}}class Qt extends un{getDefault(){return null}set(t){(t!==this.current||this.dirty)&&(this.gl.useProgram(t),this.current=t,this.dirty=!1)}}class fi extends un{getDefault(){return this.gl.TEXTURE0}set(t){(t!==this.current||this.dirty)&&(this.gl.activeTexture(t),this.current=t,this.dirty=!1)}}class Ai extends un{getDefault(){const t=this.gl;return[0,0,t.drawingBufferWidth,t.drawingBufferHeight]}set(t){const s=this.current;(t[0]!==s[0]||t[1]!==s[1]||t[2]!==s[2]||t[3]!==s[3]||this.dirty)&&(this.gl.viewport(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class er extends un{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const s=this.gl;s.bindFramebuffer(s.FRAMEBUFFER,t),this.current=t,this.dirty=!1}}class mi extends un{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const s=this.gl;s.bindRenderbuffer(s.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class xr extends un{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const s=this.gl;s.bindTexture(s.TEXTURE_2D,t),this.current=t,this.dirty=!1}}class Pi extends un{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const s=this.gl;s.bindBuffer(s.ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class br extends un{getDefault(){return null}set(t){const s=this.gl;s.bindBuffer(s.ELEMENT_ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class wr extends un{constructor(t){super(t),this.vao=t.extVertexArrayObject}getDefault(){return null}set(t){this.vao&&(t!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(t),this.current=t,this.dirty=!1)}}class Er extends un{getDefault(){return 4}set(t){if(t===this.current&&!this.dirty)return;const s=this.gl;s.pixelStorei(s.UNPACK_ALIGNMENT,t),this.current=t,this.dirty=!1}}class ui extends un{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const s=this.gl;s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t),this.current=t,this.dirty=!1}}class pn extends un{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const s=this.gl;s.pixelStorei(s.UNPACK_FLIP_Y_WEBGL,t),this.current=t,this.dirty=!1}}class _t extends un{constructor(t,s){super(t),this.context=t,this.parent=s}getDefault(){return null}}class kt extends _t{setDirty(){this.dirty=!0}set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const s=this.gl;s.framebufferTexture2D(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.TEXTURE_2D,t,0),this.current=t,this.dirty=!1}}class gn extends _t{attachment(){return this.gl.DEPTH_ATTACHMENT}set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const s=this.gl;s.framebufferRenderbuffer(s.FRAMEBUFFER,this.attachment(),s.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class Ve extends gn{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class le{constructor(t,s,p,v){this.context=t,this.width=s,this.height=p;const b=this.framebuffer=t.gl.createFramebuffer();this.colorAttachment=new kt(t,b),v&&(this.depthAttachment=new gn(t,b))}destroy(){const t=this.context.gl,s=this.colorAttachment.get();if(s&&t.deleteTexture(s),this.depthAttachment){const p=this.depthAttachment.get();p&&t.deleteRenderbuffer(p)}t.deleteFramebuffer(this.framebuffer)}}class R{constructor(t){this.gl=t,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new ut(this),this.clearDepth=new jt(this),this.clearStencil=new En(this),this.colorMask=new ni(this),this.depthMask=new ci(this),this.stencilMask=new Un(this),this.stencilFunc=new _i(this),this.stencilOp=new wi(this),this.stencilTest=new xi(this),this.depthRange=new Ni(this),this.depthTest=new Ii(this),this.depthFunc=new Ui(this),this.blend=new Yi(this),this.blendFunc=new Ht(this),this.blendColor=new Mt(this),this.blendEquation=new qe(this),this.cullFace=new re(this),this.cullFaceSide=new tt(this),this.frontFace=new Wt(this),this.program=new Qt(this),this.activeTexture=new fi(this),this.viewport=new Ai(this),this.bindFramebuffer=new er(this),this.bindRenderbuffer=new mi(this),this.bindTexture=new xr(this),this.bindVertexBuffer=new Pi(this),this.bindElementBuffer=new br(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new wr(this),this.pixelStoreUnpack=new Er(this),this.pixelStoreUnpackPremultiplyAlpha=new ui(this),this.pixelStoreUnpackFlipY=new pn(this),this.extTextureFilterAnisotropic=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=t.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureFilterAnisotropicForceOff=!1,this.extStandardDerivativesForceOff=!1,this.extDebugRendererInfo=t.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=t.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=t.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),this.extTextureHalfFloat=t.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(t.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=t.getExtension("EXT_color_buffer_half_float")),this.extStandardDerivatives=t.getExtension("OES_standard_derivatives"),this.extTimerQuery=t.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(t,s){return new Gt(this,t,s)}createVertexBuffer(t,s,p){return new Fn(this,t,s,p)}createRenderbuffer(t,s,p){const v=this.gl,b=v.createRenderbuffer();return this.bindRenderbuffer.set(b),v.renderbufferStorage(v.RENDERBUFFER,t,s,p),this.bindRenderbuffer.set(null),b}createFramebuffer(t,s,p){return new le(this,t,s,p)}clear({color:t,depth:s,stencil:p}){const v=this.gl;let b=0;t&&(b|=v.COLOR_BUFFER_BIT,this.clearColor.set(t),this.colorMask.set([!0,!0,!0,!0])),void 0!==s&&(b|=v.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(s),this.depthMask.set(!0)),void 0!==p&&(b|=v.STENCIL_BUFFER_BIT,this.clearStencil.set(p),this.stencilMask.set(255)),v.clear(b)}setCullFace(t){!1===t.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(t.mode),this.frontFace.set(t.frontFace))}setDepthMode(t){t.func!==this.gl.ALWAYS||t.mask?(this.depthTest.set(!0),this.depthFunc.set(t.func),this.depthMask.set(t.mask),this.depthRange.set(t.range)):this.depthTest.set(!1)}setStencilMode(t){t.test.func!==this.gl.ALWAYS||t.mask?(this.stencilTest.set(!0),this.stencilMask.set(t.mask),this.stencilOp.set([t.fail,t.depthFail,t.pass]),this.stencilFunc.set({func:t.test.func,ref:t.ref,mask:t.test.mask})):this.stencilTest.set(!1)}setColorMode(t){Y(t.blendFunction,c.ColorMode.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(t.blendFunction),this.blendColor.set(t.blendColor)),this.colorMask.set(t.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class j extends c.Evented{constructor(t,s,p,v){super(),this.id=t,this.dispatcher=p,this.setEventedParent(v),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=c.extend({type:"raster"},s),c.extend(this,c.pick(s,["url","scheme","tileSize"]))}load(){this._loaded=!1,this.fire(new c.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Ct(this._options,this.map._requestManager,null,null,(t,s)=>{this._tileJSONRequest=null,this._loaded=!0,t?this.fire(new c.ErrorEvent(t)):s&&(c.extend(this,s),s.bounds&&(this.tileBounds=new Ut(s.bounds,this.minzoom,this.maxzoom)),c.postTurnstileEvent(s.tiles),this.fire(new c.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new c.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}onAdd(t){this.map=t,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return c.extend({},this._options)}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}loadTile(t,s){const p=c.exported.devicePixelRatio>=2,v=this.map._requestManager.normalizeTileURL(t.tileID.canonical.url(this.tiles,this.scheme),p,this.tileSize);t.request=c.getImage(this.map._requestManager.transformRequest(v,c.ResourceType.Tile),(b,D,O,k)=>(delete t.request,t.aborted?(t.state="unloaded",s(null)):b?(t.state="errored",s(b)):D?(this.map._refreshExpiredTiles&&t.setExpiryData({cacheControl:O,expires:k}),t.setTexture(D,this.map.painter),t.state="loaded",c.cacheEntryPossiblyAdded(this.dispatcher),void s(null)):s(null)))}static loadTileData(t,s,p){t.setTexture(s,p)}static unloadTileData(t,s){t.texture&&s.saveTileTexture(t.texture)}abortTile(t,s){t.request&&(t.request.cancel(),delete t.request),s()}unloadTile(t,s){t.texture&&this.map.painter.saveTileTexture(t.texture),s()}hasTransition(){return!1}}let de;function Le(l,t,s,p,v,b,D,O){const k=[l,s,v,t,p,b,1,1,1],H=[D,O,1],J=c.adjoint([],k),[ue,De,je]=c.transformMat3(H,H,c.transpose(J,J));return c.multiply$1(k,[ue,0,0,0,De,0,0,0,je],k)}class st extends c.Evented{constructor(t,s,p,v){super(),this.id=t,this.dispatcher=p,this.coordinates=s.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(v),this.options=s,this._dirty=!1}load(t,s){this._loaded=s||!1,this.fire(new c.Event("dataloading",{dataType:"source"})),this.url=this.options.url,this._imageRequest=c.getImage(this.map._requestManager.transformRequest(this.url,c.ResourceType.Image),(p,v)=>{if(this._imageRequest=null,this._loaded=!0,p)this.fire(new c.ErrorEvent(p));else if(v){const{HTMLImageElement:b}=c.window;this.image=v instanceof b?c.exported.getImageData(v):v,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,t&&(this.coordinates=t),this._finishLoading()}})}loaded(){return this._loaded}updateImage(t){return this.image&&t.url?(this._imageRequest&&t.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=t.url,this.load(t.coordinates,this._loaded),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new c.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(t){this.map=t,this.load()}onRemove(){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),this.texture&&this.texture.destroy()}setCoordinates(t){this.coordinates=t,this._boundsArray=void 0;const s=t.map(c.MercatorCoordinate.fromLngLat);return this.tileID=function(p){let v=1/0,b=1/0,D=-1/0,O=-1/0;for(const ue of p)v=Math.min(v,ue.x),b=Math.min(b,ue.y),D=Math.max(D,ue.x),O=Math.max(O,ue.y);const k=Math.max(D-v,O-b),H=Math.max(0,Math.floor(-Math.log(k)/Math.LN2)),J=Math.pow(2,H);return new c.CanonicalTileID(H,Math.floor((v+D)/2*J),Math.floor((b+O)/2*J))}(s),this.minzoom=this.maxzoom=this.tileID.z,this.fire(new c.Event("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0}_prepareData(t){for(const k in this.tiles){const H=this.tiles[k];"loaded"!==H.state&&(H.state="loaded",H.texture=this.texture)}if(this._boundsArray)return;const s=c.tileTransform(this.tileID,this.map.transform.projection),[p,v,b,D]=this.coordinates.map(k=>{const H=s.projection.project(k[0],k[1]);return c.getTilePoint(s,H)._round()});this.perspectiveTransform=function(k,H,J,ue,De,je,ke,Ye,$e,Be){const Xe=Le(0,0,k,0,0,H,k,H),We=Le(J,ue,De,je,ke,Ye,$e,Be);return c.multiply$1(We,c.adjoint(Xe,Xe),We),[We[6]/We[8]*k/c.EXTENT,We[7]/We[8]*H/c.EXTENT]}(this.width,this.height,p.x,p.y,v.x,v.y,D.x,D.y,b.x,b.y);const O=this._boundsArray=new c.StructArrayLayout4i8;O.emplaceBack(p.x,p.y,0,0),O.emplaceBack(v.x,v.y,c.EXTENT,0),O.emplaceBack(D.x,D.y,0,c.EXTENT),O.emplaceBack(b.x,b.y,c.EXTENT,c.EXTENT),this.boundsBuffer&&this.boundsBuffer.destroy(),this.boundsBuffer=t.createVertexBuffer(O,c.boundsAttributes.members),this.boundsSegments=c.SegmentVector.simpleSegment(0,0,4,2)}prepare(){if(0===Object.keys(this.tiles).length||!this.image)return;const t=this.map.painter.context,s=t.gl;this._dirty&&(this.texture?this.texture.update(this.image):(this.texture=new c.Texture(t,this.image,s.RGBA),this.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE)),this._dirty=!1),this._prepareData(t)}loadTile(t,s){this.tileID&&this.tileID.equals(t.tileID.canonical)?(this.tiles[String(t.tileID.wrap)]=t,t.buckets={},s(null)):(t.state="errored",s(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}const Bt={vector:class extends c.Evented{constructor(l,t,s,p){if(super(),this.id=l,this.dispatcher=s,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,c.extend(this,c.pick(t,["url","scheme","tileSize","promoteId"])),this._options=c.extend({type:"vector"},t),this._collectResourceTiming=t.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(p),this._tileWorkers={},this._deduped=new c.DedupedRequest}load(l){this._loaded=!1,this.fire(new c.Event("dataloading",{dataType:"source"}));const t=Array.isArray(this.map._language)?this.map._language.join():this.map._language,s=this.map._worldview;this._tileJSONRequest=Ct(this._options,this.map._requestManager,t,s,(p,v)=>{this._tileJSONRequest=null,this._loaded=!0,p?(t&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${t}`),s&&2!==s.length&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${s}`),this.fire(new c.ErrorEvent(p))):v&&(c.extend(this,v),v.bounds&&(this.tileBounds=new Ut(v.bounds,this.minzoom,this.maxzoom)),c.postTurnstileEvent(v.tiles,this.map._requestManager._customAccessToken),this.fire(new c.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new c.Event("data",{dataType:"source",sourceDataType:"content"}))),l&&l(p)})}loaded(){return this._loaded}hasTile(l){return!this.tileBounds||this.tileBounds.contains(l.canonical)}onAdd(l){this.map=l,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>{const l=this.map.style._getSourceCaches(this.id);for(const t of l)t.clearTiles()})}setSourceProperty(l){l(),this.reload()}setTiles(l){return this._options.tiles=l,this.reload(),this}setUrl(l){return this.url=l,this._options.url=l,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return c.extend({},this._options)}loadTile(l,t){const s=this.map._requestManager.normalizeTileURL(l.tileID.canonical.url(this.tiles,this.scheme)),p={request:this.map._requestManager.transformRequest(s,c.ResourceType.Tile),data:void 0,uid:l.uid,tileID:l.tileID,tileZoom:l.tileZoom,zoom:l.tileID.overscaledZ,tileSize:this.tileSize*l.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:c.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:l.isSymbolTile};if(p.request.collectResourceTiming=this._collectResourceTiming,l.actor&&"expired"!==l.state)"loading"===l.state?l.reloadCallback=t:l.request=l.actor.send("reloadTile",p,v.bind(this));else if(l.actor=this._tileWorkers[s]=this._tileWorkers[s]||this.dispatcher.getActor(),this.dispatcher.ready)l.request=l.actor.send("loadTile",p,v.bind(this),void 0,!0);else{const b=c.loadVectorTile.call({deduped:this._deduped},p,(D,O)=>{D||!O?v.call(this,D):(p.data={cacheControl:O.cacheControl,expires:O.expires,rawData:O.rawData.slice(0)},l.actor&&l.actor.send("loadTile",p,v.bind(this),void 0,!0))},!0);l.request={cancel:b}}function v(b,D){return delete l.request,l.aborted?t(null):b&&404!==b.status?t(b):(D&&D.resourceTiming&&(l.resourceTiming=D.resourceTiming),this.map._refreshExpiredTiles&&D&&l.setExpiryData(D),l.loadVectorData(D,this.map.painter),c.cacheEntryPossiblyAdded(this.dispatcher),t(null),void(l.reloadCallback&&(this.loadTile(l,l.reloadCallback),l.reloadCallback=null)))}}abortTile(l){l.request&&(l.request.cancel(),delete l.request),l.actor&&l.actor.send("abortTile",{uid:l.uid,type:this.type,source:this.id})}unloadTile(l){l.unloadVectorData(),l.actor&&l.actor.send("removeTile",{uid:l.uid,type:this.type,source:this.id})}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}},raster:j,"raster-dem":class extends j{constructor(l,t,s,p){super(l,t,s,p),this.type="raster-dem",this.maxzoom=22,this._options=c.extend({type:"raster-dem"},t),this.encoding=t.encoding||"mapbox"}loadTile(l,t){const s=this.map._requestManager.normalizeTileURL(l.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function p(v,b){v&&(l.state="errored",t(v)),b&&(l.dem=b,l.dem.onDeserialize(),l.needsHillshadePrepare=!0,l.needsDEMTextureUpload=!0,l.state="loaded",t(null))}l.request=c.getImage(this.map._requestManager.transformRequest(s,c.ResourceType.Tile),function(v,b,D,O){if(delete l.request,l.aborted)l.state="unloaded",t(null);else if(v)l.state="errored",t(v);else if(b){this.map._refreshExpiredTiles&&l.setExpiryData({cacheControl:D,expires:O});const k=c.window.ImageBitmap&&b instanceof c.window.ImageBitmap&&(null==de&&(de=c.window.OffscreenCanvas&&new c.window.OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof c.window.createImageBitmap),de),H=1-(b.width-c.prevPowerOfTwo(b.width))/2;H<1||l.neighboringTiles||(l.neighboringTiles=this._getNeighboringTiles(l.tileID));const J=k?b:c.exported.getImageData(b,H),ue={uid:l.uid,coord:l.tileID,source:this.id,rawImageData:J,encoding:this.encoding,padding:H};l.actor&&"expired"!==l.state||(l.actor=this.dispatcher.getActor(),l.actor.send("loadDEMTile",ue,p.bind(this),void 0,!0))}}.bind(this))}_getNeighboringTiles(l){const t=l.canonical,s=Math.pow(2,t.z),p=(t.x-1+s)%s,v=0===t.x?l.wrap-1:l.wrap,b=(t.x+1+s)%s,D=t.x+1===s?l.wrap+1:l.wrap,O={};return O[new c.OverscaledTileID(l.overscaledZ,v,t.z,p,t.y).key]={backfilled:!1},O[new c.OverscaledTileID(l.overscaledZ,D,t.z,b,t.y).key]={backfilled:!1},t.y>0&&(O[new c.OverscaledTileID(l.overscaledZ,v,t.z,p,t.y-1).key]={backfilled:!1},O[new c.OverscaledTileID(l.overscaledZ,l.wrap,t.z,t.x,t.y-1).key]={backfilled:!1},O[new c.OverscaledTileID(l.overscaledZ,D,t.z,b,t.y-1).key]={backfilled:!1}),t.y+1<s&&(O[new c.OverscaledTileID(l.overscaledZ,v,t.z,p,t.y+1).key]={backfilled:!1},O[new c.OverscaledTileID(l.overscaledZ,l.wrap,t.z,t.x,t.y+1).key]={backfilled:!1},O[new c.OverscaledTileID(l.overscaledZ,D,t.z,b,t.y+1).key]={backfilled:!1}),O}unloadTile(l){l.demTexture&&this.map.painter.saveTileTexture(l.demTexture),l.fbo&&(l.fbo.destroy(),delete l.fbo),l.dem&&delete l.dem,delete l.neighboringTiles,l.state="unloaded"}},geojson:class extends c.Evented{constructor(l,t,s,p){super(),this.id=l,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=s.getActor(),this.setEventedParent(p),this._data=t.data,this._options=c.extend({},t),this._collectResourceTiming=t.collectResourceTiming,void 0!==t.maxzoom&&(this.maxzoom=t.maxzoom),t.type&&(this.type=t.type),t.attribution&&(this.attribution=t.attribution),this.promoteId=t.promoteId;const v=c.EXTENT/this.tileSize;this.workerOptions=c.extend({source:this.id,cluster:t.cluster||!1,geojsonVtOptions:{buffer:(void 0!==t.buffer?t.buffer:128)*v,tolerance:(void 0!==t.tolerance?t.tolerance:.375)*v,extent:c.EXTENT,maxZoom:this.maxzoom,lineMetrics:t.lineMetrics||!1,generateId:t.generateId||!1},superclusterOptions:{maxZoom:void 0!==t.clusterMaxZoom?t.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,t.clusterMinPoints||2),extent:c.EXTENT,radius:(void 0!==t.clusterRadius?t.clusterRadius:50)*v,log:!1,generateId:t.generateId||!1},clusterProperties:t.clusterProperties,filter:t.filter},t.workerOptions)}onAdd(l){this.map=l,this.setData(this._data)}setData(l){return this._data=l,this._updateWorkerData(),this}getClusterExpansionZoom(l,t){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:l,source:this.id},t),this}getClusterChildren(l,t){return this.actor.send("geojson.getClusterChildren",{clusterId:l,source:this.id},t),this}getClusterLeaves(l,t,s,p){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:l,limit:t,offset:s},p),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new c.Event("dataloading",{dataType:"source"})),this._loaded=!1;const l=c.extend({},this.workerOptions),t=this._data;"string"==typeof t?(l.request=this.map._requestManager.transformRequest(c.exported.resolveURL(t),c.ResourceType.Source),l.request.collectResourceTiming=this._collectResourceTiming):l.data=JSON.stringify(t),this._pendingLoad=this.actor.send(`${this.type}.loadData`,l,(s,p)=>{if(this._loaded=!0,this._pendingLoad=null,s)this.fire(new c.ErrorEvent(s));else{const v={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&p&&p.resourceTiming&&p.resourceTiming[this.id]&&(v.resourceTiming=p.resourceTiming[this.id]),this.fire(new c.Event("data",v)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(l,t){const s=l.actor?"reloadTile":"loadTile";l.actor=this.actor,l.request=this.actor.send(s,{type:this.type,uid:l.uid,tileID:l.tileID,tileZoom:l.tileZoom,zoom:l.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:c.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},(p,v)=>(delete l.request,l.unloadVectorData(),l.aborted?t(null):p?t(p):(l.loadVectorData(v,this.map.painter,"reloadTile"===s),t(null))),void 0,"loadTile"===s)}abortTile(l){l.request&&(l.request.cancel(),delete l.request),l.aborted=!0}unloadTile(l){l.unloadVectorData(),this.actor.send("removeTile",{uid:l.uid,type:this.type,source:this.id})}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return c.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends st{constructor(l,t,s,p){super(l,t,s,p),this.roundZoom=!0,this.type="video",this.options=t}load(){this._loaded=!1;const l=this.options;this.urls=[];for(const t of l.urls)this.urls.push(this.map._requestManager.transformRequest(t,c.ResourceType.Source).url);c.getVideo(this.urls,(t,s)=>{this._loaded=!0,t?this.fire(new c.ErrorEvent(t)):s&&(this.video=s,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(l){if(this.video){const t=this.video.seekable;l<t.start(0)||l>t.end(0)?this.fire(new c.ErrorEvent(new c.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${t.start(0)} and ${t.end(0)}-second mark.`))):this.video.currentTime=l}}getVideo(){return this.video}onAdd(l){this.map||(this.map=l,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(0===Object.keys(this.tiles).length||this.video.readyState<2)return;const l=this.map.painter.context,t=l.gl;this.texture?this.video.paused||(this.texture.bind(t.LINEAR,t.CLAMP_TO_EDGE),t.texSubImage2D(t.TEXTURE_2D,0,0,0,t.RGBA,t.UNSIGNED_BYTE,this.video)):(this.texture=new c.Texture(l,this.video,t.RGBA),this.texture.bind(t.LINEAR,t.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(l)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:st,canvas:class extends st{constructor(l,t,s,p){super(l,t,s,p),t.coordinates?Array.isArray(t.coordinates)&&4===t.coordinates.length&&!t.coordinates.some(v=>!Array.isArray(v)||2!==v.length||v.some(b=>"number"!=typeof b))||this.fire(new c.ErrorEvent(new c.ValidationError(`sources.${l}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new c.ErrorEvent(new c.ValidationError(`sources.${l}`,null,'missing required property "coordinates"'))),t.animate&&"boolean"!=typeof t.animate&&this.fire(new c.ErrorEvent(new c.ValidationError(`sources.${l}`,null,'optional "animate" property must be a boolean value'))),t.canvas?"string"==typeof t.canvas||t.canvas instanceof c.window.HTMLCanvasElement||this.fire(new c.ErrorEvent(new c.ValidationError(`sources.${l}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new c.ErrorEvent(new c.ValidationError(`sources.${l}`,null,'missing required property "canvas"'))),this.options=t,this.animate=void 0===t.animate||t.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof c.window.HTMLCanvasElement?this.options.canvas:c.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new c.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(l){this.map=l,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let l=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,l=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,l=!0),this._hasInvalidDimensions()||0===Object.keys(this.tiles).length)return;const t=this.map.painter.context;this.texture?(l||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new c.Texture(t,this.canvas,t.gl.RGBA,{premultiply:!0}),this._prepareData(t)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const l of[this.canvas.width,this.canvas.height])if(isNaN(l)||l<=0)return!0;return!1}},custom:class extends c.Evented{constructor(l,t,s,p){super(),this.id=l,this.type="custom",this._dataType="raster",this._dispatcher=s,this._implementation=t,this.setEventedParent(p),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new c.ErrorEvent(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new c.ErrorEvent(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new Ut(this._implementation.bounds,this.minzoom,this.maxzoom)),t.update=this._update.bind(this),t.clearTiles=this._clearTiles.bind(this),t.coveringTiles=this._coveringTiles.bind(this),c.extend(this,c.pick(t,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return c.pick(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new c.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new c.Event("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(l){this._map=l,this._loaded=!1,this.fire(new c.Event("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(l),this.load()}onRemove(l){this._implementation.onRemove&&this._implementation.onRemove(l)}hasTile(l){if(this._implementation.hasTile){const{x:t,y:s,z:p}=l.canonical;return this._implementation.hasTile({x:t,y:s,z:p})}return!this.tileBounds||this.tileBounds.contains(l.canonical)}loadTile(l,t){const{x:s,y:p,z:v}=l.tileID.canonical,b=new c.window.AbortController;l.request=Promise.resolve(this._implementation.loadTile({x:s,y:p,z:v},{signal:b.signal})).then(function(D){return delete l.request,l.aborted?(l.state="unloaded",t(null)):void 0===D?(l.state="errored",t(null)):null===D?(this.loadTileData(l,{width:this.tileSize,height:this.tileSize,data:null}),l.state="loaded",t(null)):(O=D)instanceof c.window.ImageData||O instanceof c.window.HTMLCanvasElement||O instanceof c.window.ImageBitmap||O instanceof c.window.HTMLImageElement?(this.loadTileData(l,D),l.state="loaded",void t(null)):(l.state="errored",t(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)));var O}.bind(this)).catch(D=>{20!==D.code&&(l.state="errored",t(D))}),l.request.cancel=()=>b.abort()}loadTileData(l,t){j.loadTileData(l,t,this._map.painter)}unloadTileData(l){j.unloadTileData(l,this._map.painter)}unloadTile(l,t){if(this.unloadTileData(l),this._implementation.unloadTile){const{x:s,y:p,z:v}=l.tileID.canonical;this._implementation.unloadTile({x:s,y:p,z:v})}t()}abortTile(l,t){l.request&&l.request.cancel&&(l.request.cancel(),delete l.request),t()}hasTransition(){return!1}_coveringTiles(){return this._map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(l=>({x:l.canonical.x,y:l.canonical.y,z:l.canonical.z}))}_clearTiles(){this._map.style._clearSource(this.id)}_update(){this.fire(new c.Event("data",{dataType:"source",sourceDataType:"content"}))}}},Rt=function(l,t,s,p){const v=new Bt[t.type](l,t,s,p);if(v.id!==l)throw new Error(`Expected Source id to be ${l} instead of ${v.id}`);return c.bindAll(["load","abort","unload","serialize","prepare"],v),v};function at(l,t){const s=c.identity([]);return c.scale(s,s,[.5*l.width,.5*-l.height,1]),c.translate(s,s,[1,-1,0]),c.multiply(s,s,l.calculateProjMatrix(t.toUnwrapped())),Float32Array.from(s)}function Pe(l,t,s,p,v,b,D,O=!1){const k=l.tilesIn(p,D,O);k.sort(Re);const H=[];for(const ue of k)H.push({wrappedTileID:ue.tile.tileID.wrapped().key,queryResults:ue.tile.queryRenderedFeatures(t,s,l._state,ue,v,b,at(l.transform,ue.tile.tileID),O)});const J=function(ue){const De={},je={};for(const ke of ue){const Ye=ke.queryResults,$e=ke.wrappedTileID,Be=je[$e]=je[$e]||{};for(const Xe in Ye){const We=Ye[Xe],gt=Be[Xe]=Be[Xe]||{},yt=De[Xe]=De[Xe]||[];for(const ot of We)gt[ot.featureIndex]||(gt[ot.featureIndex]=!0,yt.push(ot))}}return De}(H);for(const ue in J)J[ue].forEach(De=>{const je=De.feature,ke=je.layer;ke&&"background"!==ke.type&&"sky"!==ke.type&&(je.source=ke.source,ke["source-layer"]&&(je.sourceLayer=ke["source-layer"]),je.state=void 0!==je.id?l.getFeatureState(ke["source-layer"],je.id):{})});return J}function Ue(l,t){const s=l.getRenderableIds().map(b=>l.getTileByID(b)),p=[],v={};for(let b=0;b<s.length;b++){const D=s[b],O=D.tileID.canonical.key;v[O]||(v[O]=!0,D.querySourceFeatures(p,t))}return p}function Re(l,t){const s=l.tileID,p=t.tileID;return s.overscaledZ-p.overscaledZ||s.canonical.y-p.canonical.y||s.wrap-p.wrap||s.canonical.x-p.canonical.x}function nt(){return null!=S.workerClass?new S.workerClass:new c.window.Worker(S.workerUrl)}const zt="mapboxgl_preloaded_worker_pool";class _n{constructor(){this.active={}}acquire(t){if(!this.workers)for(this.workers=[];this.workers.length<_n.workerCount;)this.workers.push(new nt);return this.active[t]=!0,this.workers.slice()}release(t){delete this.active[t],0===this.numActive()&&(this.workers.forEach(s=>{s.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[zt]}numActive(){return Object.keys(this.active).length}}let Mn;function Yn(){return Mn||(Mn=new _n),Mn}function di(l,t){const s={};for(const p in l)"ref"!==p&&(s[p]=l[p]);return c.refProperties.forEach(p=>{p in t&&(s[p]=t[p])}),s}function gi(l){l=l.slice();const t=Object.create(null);for(let s=0;s<l.length;s++)t[l[s].id]=l[s];for(let s=0;s<l.length;s++)"ref"in l[s]&&(l[s]=di(l[s],t[l[s].ref]));return l}_n.workerCount=2;const Kn={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setProjection:"setProjection"};function Vi(l,t,s){s.push({command:Kn.addSource,args:[l,t[l]]})}function Bi(l,t,s){t.push({command:Kn.removeSource,args:[l]}),s[l]=!0}function Qr(l,t,s,p){Bi(l,s,p),Vi(l,t,s)}function Cr(l,t,s){let p;for(p in l[s])if(l[s].hasOwnProperty(p)&&"data"!==p&&!Y(l[s][p],t[s][p]))return!1;for(p in t[s])if(t[s].hasOwnProperty(p)&&"data"!==p&&!Y(l[s][p],t[s][p]))return!1;return!0}function on(l,t,s,p,v,b){let D;for(D in t=t||{},l=l||{})l.hasOwnProperty(D)&&(Y(l[D],t[D])||s.push({command:b,args:[p,D,t[D],v]}));for(D in t)t.hasOwnProperty(D)&&!l.hasOwnProperty(D)&&(Y(l[D],t[D])||s.push({command:b,args:[p,D,t[D],v]}))}function ar(l){return l.id}function pr(l,t){return l[t.id]=t,l}class xo{constructor(t,s){this.reset(t,s)}reset(t,s){this.points=t||[],this._distances=[0];for(let p=1;p<this.points.length;p++)this._distances[p]=this._distances[p-1]+this.points[p].dist(this.points[p-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(s||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(t){if(1===this.points.length)return this.points[0];t=c.clamp(t,0,1);let s=1,p=this._distances[s];const v=t*this.paddedLength+this.padding;for(;p<v&&s<this._distances.length;)p=this._distances[++s];const b=s-1,D=this._distances[b],O=p-D,k=O>0?(v-D)/O:0;return this.points[b].mult(1-k).add(this.points[s].mult(k))}}class zo{constructor(t,s,p){const v=this.boxCells=[],b=this.circleCells=[];this.xCellCount=Math.ceil(t/p),this.yCellCount=Math.ceil(s/p);for(let D=0;D<this.xCellCount*this.yCellCount;D++)v.push([]),b.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=t,this.height=s,this.xScale=this.xCellCount/t,this.yScale=this.yCellCount/s,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(t,s,p,v,b){this._forEachCell(s,p,v,b,this._insertBoxCell,this.boxUid++),this.boxKeys.push(t),this.bboxes.push(s),this.bboxes.push(p),this.bboxes.push(v),this.bboxes.push(b)}insertCircle(t,s,p,v){this._forEachCell(s-v,p-v,s+v,p+v,this._insertCircleCell,this.circleUid++),this.circleKeys.push(t),this.circles.push(s),this.circles.push(p),this.circles.push(v)}_insertBoxCell(t,s,p,v,b,D){this.boxCells[b].push(D)}_insertCircleCell(t,s,p,v,b,D){this.circleCells[b].push(D)}_query(t,s,p,v,b,D){if(p<0||t>this.width||v<0||s>this.height)return!b&&[];const O=[];if(t<=0&&s<=0&&this.width<=p&&this.height<=v){if(b)return!0;for(let k=0;k<this.boxKeys.length;k++)O.push({key:this.boxKeys[k],x1:this.bboxes[4*k],y1:this.bboxes[4*k+1],x2:this.bboxes[4*k+2],y2:this.bboxes[4*k+3]});for(let k=0;k<this.circleKeys.length;k++){const H=this.circles[3*k],J=this.circles[3*k+1],ue=this.circles[3*k+2];O.push({key:this.circleKeys[k],x1:H-ue,y1:J-ue,x2:H+ue,y2:J+ue})}return D?O.filter(D):O}return this._forEachCell(t,s,p,v,this._queryCell,O,{hitTest:b,seenUids:{box:{},circle:{}}},D),b?O.length>0:O}_queryCircle(t,s,p,v,b){const D=t-p,O=t+p,k=s-p,H=s+p;if(O<0||D>this.width||H<0||k>this.height)return!v&&[];const J=[];return this._forEachCell(D,k,O,H,this._queryCellCircle,J,{hitTest:v,circle:{x:t,y:s,radius:p},seenUids:{box:{},circle:{}}},b),v?J.length>0:J}query(t,s,p,v,b){return this._query(t,s,p,v,!1,b)}hitTest(t,s,p,v,b){return this._query(t,s,p,v,!0,b)}hitTestCircle(t,s,p,v){return this._queryCircle(t,s,p,!0,v)}_queryCell(t,s,p,v,b,D,O,k){const H=O.seenUids,J=this.boxCells[b];if(null!==J){const De=this.bboxes;for(const je of J)if(!H.box[je]){H.box[je]=!0;const ke=4*je;if(t<=De[ke+2]&&s<=De[ke+3]&&p>=De[ke+0]&&v>=De[ke+1]&&(!k||k(this.boxKeys[je]))){if(O.hitTest)return D.push(!0),!0;D.push({key:this.boxKeys[je],x1:De[ke],y1:De[ke+1],x2:De[ke+2],y2:De[ke+3]})}}}const ue=this.circleCells[b];if(null!==ue){const De=this.circles;for(const je of ue)if(!H.circle[je]){H.circle[je]=!0;const ke=3*je;if(this._circleAndRectCollide(De[ke],De[ke+1],De[ke+2],t,s,p,v)&&(!k||k(this.circleKeys[je]))){if(O.hitTest)return D.push(!0),!0;{const Ye=De[ke],$e=De[ke+1],Be=De[ke+2];D.push({key:this.circleKeys[je],x1:Ye-Be,y1:$e-Be,x2:Ye+Be,y2:$e+Be})}}}}}_queryCellCircle(t,s,p,v,b,D,O,k){const H=O.circle,J=O.seenUids,ue=this.boxCells[b];if(null!==ue){const je=this.bboxes;for(const ke of ue)if(!J.box[ke]){J.box[ke]=!0;const Ye=4*ke;if(this._circleAndRectCollide(H.x,H.y,H.radius,je[Ye+0],je[Ye+1],je[Ye+2],je[Ye+3])&&(!k||k(this.boxKeys[ke])))return D.push(!0),!0}}const De=this.circleCells[b];if(null!==De){const je=this.circles;for(const ke of De)if(!J.circle[ke]){J.circle[ke]=!0;const Ye=3*ke;if(this._circlesCollide(je[Ye],je[Ye+1],je[Ye+2],H.x,H.y,H.radius)&&(!k||k(this.circleKeys[ke])))return D.push(!0),!0}}}_forEachCell(t,s,p,v,b,D,O,k){const H=this._convertToXCellCoord(t),J=this._convertToYCellCoord(s),ue=this._convertToXCellCoord(p),De=this._convertToYCellCoord(v);for(let je=H;je<=ue;je++)for(let ke=J;ke<=De;ke++)if(b.call(this,t,s,p,v,this.xCellCount*ke+je,D,O,k))return}_convertToXCellCoord(t){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(t*this.xScale)))}_convertToYCellCoord(t){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(t*this.yScale)))}_circlesCollide(t,s,p,v,b,D){const O=v-t,k=b-s,H=p+D;return H*H>O*O+k*k}_circleAndRectCollide(t,s,p,v,b,D,O){const k=(D-v)/2,H=Math.abs(t-(v+k));if(H>k+p)return!1;const J=(O-b)/2,ue=Math.abs(s-(b+J));if(ue>J+p)return!1;if(H<=k||ue<=J)return!0;const De=H-k,je=ue-J;return De*De+je*je<=p*p}}const Br=Math.tan(85*Math.PI/180);function Oi(l,t,s,p,v,b,D){const O=c.create();if(s)if("globe"===b.name){const k=c.calculateGlobeLabelMatrix(v,t);c.multiply(O,O,k)}else{const k=ye([],D);O[0]=k[0],O[1]=k[1],O[4]=k[2],O[5]=k[3],p||c.rotateZ(O,O,v.angle)}else c.multiply(O,v.labelPlaneMatrix,l);return O}function lr(l,t,s,p,v,b,D){const O=Oi(l,t,s,p,v,b,D);return"globe"===b.name&&s||(O[2]=O[6]=O[10]=O[14]=0),O}function cr(l,t,s,p,v,b,D){if(s){if("globe"===b.name){const O=Oi(l,t,s,p,v,b,D);return c.invert(O,O),c.multiply(O,l,O),O}{const O=c.clone(l),k=c.identity([]);return k[0]=D[0],k[1]=D[1],k[4]=D[2],k[5]=D[3],c.multiply(O,O,k),p||c.rotateZ(O,O,-v.angle),O}}return v.glCoordMatrix}function Ln(l,t,s=0){const p=[l.x,l.y,s,1];s?c.transformMat4$1(p,p,t):nn(p,p,t);const v=p[3];return{point:[p[0]/v,p[1]/v,p[2]/v],signedDistanceFromCamera:v}}function hi(l,t){const s=[l[0],l[1],l[2],1];c.transformMat4$1(s,s,t);const p=s[3];return{point:[s[0]/p,s[1]/p,s[2]/p],signedDistanceFromCamera:p}}function ri(l,t){return Math.min(.5+l/t*.5,1.5)}function Wn(l,t){const s=l[0]/l[3],p=l[1]/l[3];return s>=-t[0]&&s<=t[0]&&p>=-t[1]&&p<=t[1]}function xe(l,t,s,p,v,b,D,O,k,H){const J=s.transform,ue=p?l.textSizeData:l.iconSizeData,De=c.evaluateSizeForZoom(ue,s.transform.zoom),je="globe"===J.projection.name,ke=[256/s.width*2+1,256/s.height*2+1],Ye=p?l.text.dynamicLayoutVertexArray:l.icon.dynamicLayoutVertexArray;Ye.clear();let $e=null;je&&($e=p?l.text.globeExtVertexArray:l.icon.globeExtVertexArray);const Be=l.lineVertexArray,Xe=p?l.text.placedSymbolArray:l.icon.placedSymbolArray,We=s.transform.width/s.transform.height;let gt=!1;for(let yt=0;yt<Xe.length;yt++){const ot=Xe.get(yt);if(ot.writingMode!==c.WritingMode.vertical||gt||0!==yt&&Xe.get(yt-1).writingMode===c.WritingMode.horizontal||(gt=!0),(ot.hidden||ot.writingMode===c.WritingMode.vertical)&&!gt){hn(ot.numGlyphs,Ye);continue}gt=!1;const It=new c.pointGeometry(ot.tileAnchorX,ot.tileAnchorY),Jt=k?k(It):[0,0,0],cn=J.projection.projectTilePoint(It.x,It.y,H.canonical),Xt=[cn.x+Jt[0],cn.y+Jt[1],cn.z+Jt[2]],An=[...Xt,1];if(c.transformMat4$1(An,An,t),!Wn(An,ke)){hn(ot.numGlyphs,Ye);continue}const Zt=ri(s.transform.cameraToCenterDistance,An[3]),bn=c.evaluateSizeForFeature(ue,De,ot),yn=D?bn/Zt:bn*Zt,Kt=Ln(new c.pointGeometry(Xt[0],Xt[1]),v,Xt[2]);if(Kt.signedDistanceFromCamera<=0){hn(ot.numGlyphs,Ye);continue}let Nt={};const qn=D?null:k,zn=$t(ot,yn,!1,O,t,v,b,l.glyphOffsetArray,Be,Ye,$e,Kt.point,It,Nt,We,qn,J.projection,H,D);gt=zn.useVertical,qn&&zn.needsFlipping&&(Nt={}),(zn.notEnoughRoom||gt||zn.needsFlipping&&$t(ot,yn,!0,O,t,v,b,l.glyphOffsetArray,Be,Ye,$e,Kt.point,It,Nt,We,qn,J.projection,H,D).notEnoughRoom)&&hn(ot.numGlyphs,Ye)}p?(l.text.dynamicLayoutVertexBuffer.updateData(Ye),$e&&l.text.globeExtVertexBuffer.updateData($e)):(l.icon.dynamicLayoutVertexBuffer.updateData(Ye),$e&&l.icon.globeExtVertexBuffer.updateData($e))}function Oe(l,t,s,p,v,b,D,O,k,H,J,ue,De,je,ke,Ye){const $e=O.glyphStartIndex+O.numGlyphs,Be=O.lineStartIndex,Xe=O.lineStartIndex+O.lineLength,We=t.getoffsetX(O.glyphStartIndex),gt=t.getoffsetX($e-1),yt=pt(l*We,s,p,v,b,D,O.segment,Be,Xe,k,H,J,ue,De,!0,je,ke,Ye);if(!yt)return null;const ot=pt(l*gt,s,p,v,b,D,O.segment,Be,Xe,k,H,J,ue,De,!0,je,ke,Ye);return ot?{first:yt,last:ot}:null}function Lt(l,t,s,p){return l.writingMode===c.WritingMode.horizontal&&Math.abs(s.y-t.y)>Math.abs(s.x-t.x)*p?{useVertical:!0}:l.writingMode===c.WritingMode.vertical?t.y<s.y?{needsFlipping:!0}:null:0!==l.flipState&&function(v,b,D){const O=(b.x-v.x)*D;return 0===O||Math.abs((b.y-v.y)/O)>Br}(t,s,p)?1===l.flipState?{needsFlipping:!0}:null:t.x>s.x?{needsFlipping:!0}:null}function $t(l,t,s,p,v,b,D,O,k,H,J,ue,De,je,ke,Ye,$e,Be,Xe){const We=t/24,gt=l.lineOffsetX*We,yt=l.lineOffsetY*We;let ot=[];if(l.numGlyphs>1){const It=l.glyphStartIndex+l.numGlyphs,Jt=l.lineStartIndex,cn=l.lineStartIndex+l.lineLength,Xt=Oe(We,O,gt,yt,s,ue,De,l,k,b,je,Ye,!1,$e,Be,Xe);if(!Xt)return{notEnoughRoom:!0};const An=hi(Xt.first.point,D).point,Zt=hi(Xt.last.point,D).point,bn=new c.pointGeometry(An[0],An[1]),yn=new c.pointGeometry(Zt[0],Zt[1]);if(p&&!s){const Kt=Lt(l,bn,yn,ke);if(l.flipState=Kt&&Kt.needsFlipping?1:2,Kt)return Kt}ot=[Xt.first];for(let Kt=l.glyphStartIndex+1;Kt<It-1;Kt++){const Nt=pt(We*O.getoffsetX(Kt),gt,yt,s,ue,De,l.segment,Jt,cn,k,b,je,Ye,!1,!1,$e,Be,Xe);if(!Nt)return{notEnoughRoom:!0};ot.push(Nt)}ot.push(Xt.last)}else{if(p&&!s){const Jt=Ln(De,v).point,cn=l.lineStartIndex+l.segment+1,Xt=new c.pointGeometry(k.getx(cn),k.gety(cn)),An=Ln(Xt,v),Zt=An.signedDistanceFromCamera>0?An.point:He(De,Xt,Jt,1,v,void 0,$e,Be.canonical),bn=Lt(l,new c.pointGeometry(Jt[0],Jt[1]),new c.pointGeometry(Zt[0],Zt[1]),ke);if(l.flipState=bn&&bn.needsFlipping?1:2,bn)return bn}const It=pt(We*O.getoffsetX(l.glyphStartIndex),gt,yt,s,ue,De,l.segment,l.lineStartIndex,l.lineStartIndex+l.lineLength,k,b,je,Ye,!1,!1,$e,Be,Xe);if(!It)return{notEnoughRoom:!0};ot=[It]}if(J)for(const It of ot)c.updateGlobeVertexNormal(J,H.length+0,It.up[0],It.up[1],It.up[2]),c.updateGlobeVertexNormal(J,H.length+1,It.up[0],It.up[1],It.up[2]),c.updateGlobeVertexNormal(J,H.length+2,It.up[0],It.up[1],It.up[2]),c.updateGlobeVertexNormal(J,H.length+3,It.up[0],It.up[1],It.up[2]),c.addDynamicAttributes(H,It.point[0],It.point[1],It.point[2],It.angle);else for(const It of ot)c.addDynamicAttributes(H,It.point[0],It.point[1],It.point[2],It.angle);return{}}function tn(l,t,s,p,v){const b=p.projectTilePoint(l.x,l.y,t);if(!v)return Ln(b,s,b.z);const D=v(l);return Ln(new c.pointGeometry(b.x+D[0],b.y+D[1]),s,b.z+D[2])}function He(l,t,s,p,v,b,D,O){const k=tn(l.add(l.sub(t)._unit()),O,v,D,b).point,H=c.sub([],s,k);return c.scaleAndAdd([],s,H,p/c.length(H))}function pt(l,t,s,p,v,b,D,O,k,H,J,ue,De,je,ke,Ye,$e,Be){const Xe=p?l-t:l+t;let We=Xe>0?1:-1,gt=0;p&&(We*=-1,gt=Math.PI),We<0&&(gt+=Math.PI);let yt=We>0?O+D:O+D+1,ot=v,It=v,Jt=0,cn=0;const Xt=Math.abs(Xe),An=[],Zt=[];let bn=b;const yn=()=>{const Nn=yt-We;return 0===Jt?b:new c.pointGeometry(H.getx(Nn),H.gety(Nn))},Kt=()=>{const Nn=yn();return He(Nn,bn||Nn,It,Xt-Jt+1,J,De,Ye,$e.canonical)};for(;Jt+cn<=Xt;){if(yt+=We,yt<O||yt>=k)return null;if(It=ot,An.push(ot),je&&Zt.push(bn||yn()),ot=ue[yt],void 0===ot){bn=new c.pointGeometry(H.getx(yt),H.gety(yt));const Nn=tn(bn,$e.canonical,J,Ye,De);ot=Nn.signedDistanceFromCamera>0?ue[yt]=Nn.point:Kt()}else bn=null;Jt+=cn,cn=c.distance(It,ot)}bn=bn||new c.pointGeometry(H.getx(yt),H.gety(yt));const Nt=yn();ke&&De&&(ue[yt]=ot=void 0===ue[yt]?ot:Kt(),cn=c.distance(It,ot));const qn=(Xt-Jt)/cn,zn=bn.sub(Nt).mult(qn)._add(Nt),jn=c.sub([],ot,It),Bn=c.scaleAndAdd([],It,jn,qn);let si=[0,0,1],Di=jn[0],yi=jn[1];if(Be&&(si=Ye.upVector($e.canonical,zn.x,zn.y),0!==si[0]||0!==si[1]||1!==si[2])){const Nn=[1,0,0],Ri=[0,1,0];Nn[0]=si[2],Nn[1]=0,Nn[2]=-si[0],c.cross(Ri,si,Nn),c.normalize(Nn,Nn),c.normalize(Ri,Ri),Di=c.dot(jn,Nn),yi=c.dot(jn,Ri)}if(s){const Nn=c.cross([],si,jn);c.normalize(Nn,Nn),c.scaleAndAdd(Bn,Bn,Nn,s*We)}const pi=gt+Math.atan2(yi,Di);return An.push(Bn),je&&Zt.push(zn),{point:Bn,angle:pi,path:An,tilePath:Zt,up:si}}const Yt=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function hn(l,t){for(let s=0;s<l;s++){const p=t.length;t.resize(p+4),t.float32.set(Yt,4*p)}}function nn(l,t,s){const p=t[0],v=t[1];return l[0]=s[0]*p+s[4]*v+s[12],l[1]=s[1]*p+s[5]*v+s[13],l[3]=s[3]*p+s[7]*v+s[15],l}const kn=100;class ei{constructor(t,s,p=new zo(t.width+200,t.height+200,25),v=new zo(t.width+200,t.height+200,25)){this.transform=t,this.grid=p,this.ignoredGrid=v,this.pitchfactor=Math.cos(t._pitch)*t.cameraToCenterDistance,this.screenRightBoundary=t.width+kn,this.screenBottomBoundary=t.height+kn,this.gridRightBoundary=t.width+200,this.gridBottomBoundary=t.height+200,this.fogState=s}placeCollisionBox(t,s,p,v,b,D,O,k){let H=p.projectedAnchorX,J=p.projectedAnchorY,ue=p.projectedAnchorZ;const De=p.elevation,je=p.tileID;if(De&&je){const yt=t.getProjection().upVector(je.canonical,p.tileAnchorX,p.tileAnchorY),ot=t.getProjection().upVectorScale(je.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;H+=yt[0]*De*ot,J+=yt[1]*De*ot,ue+=yt[2]*De*ot}const ke=this.projectAndGetPerspectiveRatio(O,[H,J,ue],p.tileID,"globe"===t.projection.name||!!De||this.transform.pitch>0,t.getProjection()),Ye=D*ke.perspectiveRatio,$e=(p.x1*s+v.x-p.padding)*Ye+ke.point.x,Be=(p.y1*s+v.y-p.padding)*Ye+ke.point.y,Xe=(p.x2*s+v.x+p.padding)*Ye+ke.point.x,We=(p.y2*s+v.y+p.padding)*Ye+ke.point.y,gt=ke.perspectiveRatio<=.55||ke.occluded;return!this.isInsideGrid($e,Be,Xe,We)||!b&&this.grid.hitTest($e,Be,Xe,We,k)||gt?{box:[],offscreen:!1,occluded:ke.occluded}:{box:[$e,Be,Xe,We],offscreen:this.isOffscreen($e,Be,Xe,We),occluded:!1}}placeCollisionCircles(t,s,p,v,b,D,O,k,H,J,ue,De,je,ke,Ye){const $e=[],Be=this.transform.elevation,Xe=Be?Be.getAtTileOffsetFunc(Ye,this.transform.center.lat,this.transform.worldSize,t.getProjection()):Nt=>[0,0,0],We=new c.pointGeometry(p.tileAnchorX,p.tileAnchorY),gt=t.getProjection().projectTilePoint(p.tileAnchorX,p.tileAnchorY,Ye.canonical),yt=Xe(We),ot=[gt.x+yt[0],gt.y+yt[1],gt.z+yt[2]],It="globe"===t.projection.name,Jt=this.projectAndGetPerspectiveRatio(O,[ot[0],ot[1],ot[2]],Ye,It||!!Be||this.transform.pitch>0,t.getProjection()),{perspectiveRatio:cn}=Jt,Xt=(ue?D/cn:D*cn)/c.ONE_EM,An=Ln(new c.pointGeometry(ot[0],ot[1]),k,ot[2]).point,Zt=Jt.signedDistanceFromCamera>0?Oe(Xt,b,p.lineOffsetX*Xt,p.lineOffsetY*Xt,!1,An,We,p,v,k,{},Be&&!ue?Xe:null,ue&&!!Be,t.getProjection(),Ye,ue):null;let bn=!1,yn=!1,Kt=!0;if(Zt&&!Jt.occluded){const Nt=.5*je*cn+ke,qn=new c.pointGeometry(-100,-100),zn=new c.pointGeometry(this.screenRightBoundary,this.screenBottomBoundary),jn=new xo,Bn=Zt.first,si=Zt.last;let Di=[];for(let Nn=Bn.path.length-1;Nn>=1;Nn--)Di.push(Bn.path[Nn]);for(let Nn=1;Nn<si.path.length;Nn++)Di.push(si.path[Nn]);const yi=2.5*Nt;if(H){const Nn=Di.map(Be&&!It?(Ri,$i)=>{const Lr=Xe($i<Bn.path.length-1?Bn.tilePath[Bn.path.length-1-$i]:si.tilePath[$i-Bn.path.length+2]);return Ri[2]=Lr[2],hi(Ri,H)}:Ri=>hi(Ri,H));Di=Nn.some(Ri=>Ri.signedDistanceFromCamera<=0)?[]:Nn.map(Ri=>Ri.point)}let pi=[];if(Di.length>0){const Nn=Di.map(Ar=>new c.pointGeometry(Ar[0],Ar[1]));let Ri=1/0,$i=-1/0,Lr=1/0,Ir=-1/0;for(let Ar=0;Ar<Nn.length;Ar++)Ri=Math.min(Ri,Nn[Ar].x),Lr=Math.min(Lr,Nn[Ar].y),$i=Math.max($i,Nn[Ar].x),Ir=Math.max(Ir,Nn[Ar].y);pi=Ri>=qn.x&&$i<=zn.x&&Lr>=qn.y&&Ir<=zn.y?[Nn]:$i<qn.x||Ri>zn.x||Ir<qn.y||Lr>zn.y?[]:c.clipLine([Nn],qn.x,qn.y,zn.x,zn.y)}for(const Nn of pi){jn.reset(Nn,.25*Nt);let Ri=0;Ri=jn.length<=.5*Nt?1:Math.ceil(jn.paddedLength/yi)+1;for(let $i=0;$i<Ri;$i++){const Lr=$i/Math.max(Ri-1,1),Ir=jn.lerp(Lr),Ar=Ir.x+kn,qo=Ir.y+kn;$e.push(Ar,qo,Nt,0);const is=Ar-Nt,cl=qo-Nt,Jr=Ar+Nt,fo=qo+Nt;if(Kt=Kt&&this.isOffscreen(is,cl,Jr,fo),yn=yn||this.isInsideGrid(is,cl,Jr,fo),!s&&this.grid.hitTestCircle(Ar,qo,Nt,De)&&(bn=!0,!J))return{circles:[],offscreen:!1,collisionDetected:bn,occluded:!1}}}}return{circles:!J&&bn||!yn?[]:$e,offscreen:Kt,collisionDetected:bn,occluded:Jt.occluded}}queryRenderedSymbols(t){if(0===t.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};const s=[];let p=1/0,v=1/0,b=-1/0,D=-1/0;for(const J of t){const ue=new c.pointGeometry(J.x+kn,J.y+kn);p=Math.min(p,ue.x),v=Math.min(v,ue.y),b=Math.max(b,ue.x),D=Math.max(D,ue.y),s.push(ue)}const O=this.grid.query(p,v,b,D).concat(this.ignoredGrid.query(p,v,b,D)),k={},H={};for(const J of O){const ue=J.key;if(void 0===k[ue.bucketInstanceId]&&(k[ue.bucketInstanceId]={}),k[ue.bucketInstanceId][ue.featureIndex])continue;const De=[new c.pointGeometry(J.x1,J.y1),new c.pointGeometry(J.x2,J.y1),new c.pointGeometry(J.x2,J.y2),new c.pointGeometry(J.x1,J.y2)];c.polygonIntersectsPolygon(s,De)&&(k[ue.bucketInstanceId][ue.featureIndex]=!0,void 0===H[ue.bucketInstanceId]&&(H[ue.bucketInstanceId]=[]),H[ue.bucketInstanceId].push(ue.featureIndex))}return H}insertCollisionBox(t,s,p,v,b){(s?this.ignoredGrid:this.grid).insert({bucketInstanceId:p,featureIndex:v,collisionGroupID:b},t[0],t[1],t[2],t[3])}insertCollisionCircles(t,s,p,v,b){const D=s?this.ignoredGrid:this.grid,O={bucketInstanceId:p,featureIndex:v,collisionGroupID:b};for(let k=0;k<t.length;k+=4)D.insertCircle(O,t[k],t[k+1],t[k+2])}projectAndGetPerspectiveRatio(t,s,p,v,b){const D=[s[0],s[1],s[2],1];let O=!1;if(s[2]||this.transform.pitch>0){c.transformMat4$1(D,D,t);const k="globe"===b.name;this.fogState&&p&&!k&&(O=function(H,J,ue,De,je,ke){const Ye=ke.calculateFogTileMatrix(je),$e=[J,ue,De];return c.transformMat4($e,$e,Ye),Ee(H,$e,ke.pitch,ke._fov)}(this.fogState,s[0],s[1],s[2],p.toUnwrapped(),this.transform)>.9)}else nn(D,D,t);return{point:new c.pointGeometry((D[0]/D[3]+1)/2*this.transform.width+kn,(-D[1]/D[3]+1)/2*this.transform.height+kn),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(b)/D[3]*.5,1.5),signedDistanceFromCamera:D[3],occluded:v&&D[2]>D[3]||O}}isOffscreen(t,s,p,v){return p<kn||t>=this.screenRightBoundary||v<kn||s>this.screenBottomBoundary}isInsideGrid(t,s,p,v){return p>=0&&t<this.gridRightBoundary&&v>=0&&s<this.gridBottomBoundary}getViewportMatrix(){const t=c.identity([]);return c.translate(t,t,[-100,-100,0]),t}}function Ci(l,t,s){const p=t.createTileMatrix(l,l.worldSize,s.toUnwrapped());return c.multiply(new Float32Array(16),l.projMatrix,p)}function qi(l,t,s){if(t.projection.name===s.projection.name)return l.projMatrix;const p=s.clone();return p.setProjection(t.projection),Ci(p,t.getProjection(),l)}function ki(l,t,s){return t.name===s.projection.name?l.projMatrix:Ci(s,t,l)}class jr{constructor(t,s,p,v){this.opacity=t?Math.max(0,Math.min(1,t.opacity+(t.placed?s:-s))):v&&p?1:0,this.placed=p}isHidden(){return 0===this.opacity&&!this.placed}}class Rr{constructor(t,s,p,v,b,D=!1){this.text=new jr(t?t.text:null,s,p,b),this.icon=new jr(t?t.icon:null,s,v,b),this.clipped=D}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class tr{constructor(t,s,p,v=!1){this.text=t,this.icon=s,this.skipFade=p,this.clipped=v}}class fr{constructor(){this.invProjMatrix=c.create(),this.viewportMatrix=c.create(),this.circles=[]}}class es{constructor(t,s,p,v,b){this.bucketInstanceId=t,this.featureIndex=s,this.sourceLayerIndex=p,this.bucketIndex=v,this.tileID=b}}class mr{constructor(t){this.crossSourceCollisions=t,this.maxGroupID=0,this.collisionGroups={}}get(t){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[t]){const s=++this.maxGroupID;this.collisionGroups[t]={ID:s,predicate:p=>p.collisionGroupID===s}}return this.collisionGroups[t]}}function bo(l,t,s,p,v){const{horizontalAlign:b,verticalAlign:D}=c.getAnchorAlignment(l),O=-(b-.5)*t,k=-(D-.5)*s,H=c.evaluateVariableOffset(l,p);return new c.pointGeometry(O+H[0]*v,k+H[1]*v)}function io(l,t,s,p,v){const b=new c.pointGeometry(l,t);return s&&b._rotate(p?v:-v),b}class ia{constructor(t,s,p,v,b){this.transform=t.clone(),this.projection=t.projection.name,this.collisionIndex=new ei(this.transform,b),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=s,this.retainedQueryData={},this.collisionGroups=new mr(p),this.collisionCircleArrays={},this.prevPlacement=v,v&&(v.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(t,s,p,v){const b=p.getBucket(s),D=p.latestFeatureIndex;if(!b||!D||s.id!==b.layerIds[0])return;const O=b.layers[0].layout,k=p.collisionBoxArray,H=Math.pow(2,this.transform.zoom-p.tileID.overscaledZ),J=p.tileSize/c.EXTENT,ue=p.tileID.toUnwrapped();this.transform.setProjection(b.projection);const De=(je=p.tileID,ke=b.getProjection(),Ye=this.transform,ke.name===this.projection?Ye.calculateProjMatrix(je.toUnwrapped()):Ci(Ye,ke,je));var je,ke,Ye;const $e="map"===O.get("text-pitch-alignment"),Be="map"===O.get("text-rotation-alignment");s.compileFilter();const Xe=s.dynamicFilter(),We=s.dynamicFilterNeedsFeature(),gt=this.transform.calculatePixelsToTileUnitsMatrix(p),yt=lr(De,p.tileID.canonical,$e,Be,this.transform,b.getProjection(),gt);let ot=null;if($e){const cn=cr(De,p.tileID.canonical,$e,Be,this.transform,b.getProjection(),gt);ot=c.multiply([],this.transform.labelPlaneMatrix,cn)}let It=null;Xe&&p.latestFeatureIndex&&(It={unwrappedTileID:ue,dynamicFilter:Xe,dynamicFilterNeedsFeature:We,featureIndex:p.latestFeatureIndex}),this.retainedQueryData[b.bucketInstanceId]=new es(b.bucketInstanceId,D,b.sourceLayerIndex,b.index,p.tileID);const Jt={bucket:b,layout:O,posMatrix:De,textLabelPlaneMatrix:yt,labelToScreenMatrix:ot,clippingData:It,scale:H,textPixelRatio:J,holdingForFade:p.holdingForFade(),collisionBoxArray:k,partiallyEvaluatedTextSize:c.evaluateSizeForZoom(b.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:c.evaluateSizeForZoom(b.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(b.sourceID)};if(v)for(const cn of b.sortKeyRanges){const{sortKey:Xt,symbolInstanceStart:An,symbolInstanceEnd:Zt}=cn;t.push({sortKey:Xt,symbolInstanceStart:An,symbolInstanceEnd:Zt,parameters:Jt})}else t.push({symbolInstanceStart:0,symbolInstanceEnd:b.symbolInstances.length,parameters:Jt})}attemptAnchorPlacement(t,s,p,v,b,D,O,k,H,J,ue,De,je,ke,Ye,$e,Be,Xe){const We=[De.textOffset0,De.textOffset1],gt=bo(t,p,v,We,b),yt=this.collisionIndex.placeCollisionBox(ke,b,s,io(gt.x,gt.y,D,O,this.transform.angle),ue,k,H,J.predicate);if($e){const ot=ke.getSymbolInstanceIconSize(Xe,this.transform.zoom,De.placedIconSymbolIndex);if(0===this.collisionIndex.placeCollisionBox(ke,ot,$e,io(gt.x,gt.y,D,O,this.transform.angle),ue,k,H,J.predicate).box.length)return}if(yt.box.length>0){let ot;return this.prevPlacement&&this.prevPlacement.variableOffsets[De.crossTileID]&&this.prevPlacement.placements[De.crossTileID]&&this.prevPlacement.placements[De.crossTileID].text&&(ot=this.prevPlacement.variableOffsets[De.crossTileID].anchor),this.variableOffsets[De.crossTileID]={textOffset:We,width:p,height:v,anchor:t,textScale:b,prevAnchor:ot},this.markUsedJustification(ke,t,De,Ye),ke.allowVerticalPlacement&&(this.markUsedOrientation(ke,Ye,De),this.placedOrientations[De.crossTileID]=Ye),{shift:gt,placedGlyphBoxes:yt}}}placeLayerBucketPart(t,s,p,v){const{bucket:b,layout:D,posMatrix:O,textLabelPlaneMatrix:k,labelToScreenMatrix:H,clippingData:J,textPixelRatio:ue,holdingForFade:De,collisionBoxArray:je,partiallyEvaluatedTextSize:ke,partiallyEvaluatedIconSize:Ye,collisionGroup:$e}=t.parameters,Be=D.get("text-optional"),Xe=D.get("icon-optional"),We=D.get("text-allow-overlap"),gt=D.get("icon-allow-overlap"),yt="map"===D.get("text-rotation-alignment"),ot="map"===D.get("text-pitch-alignment"),It="none"!==D.get("icon-text-fit"),Jt="viewport-y"===D.get("symbol-z-order");this.transform.setProjection(b.projection);let cn=We&&(gt||!b.hasIconData()||Xe),Xt=gt&&(We||!b.hasTextData()||Be);!b.collisionArrays&&je&&b.deserializeCollisionBoxes(je),p&&v&&b.updateCollisionDebugBuffers(this.transform.zoom,je);const An=(Zt,bn,yn)=>{if(J){const Jr={zoom:this.transform.zoom,pitch:this.transform.pitch};let fo=null;if(J.dynamicFilterNeedsFeature){const Mr=this.retainedQueryData[b.bucketInstanceId];fo=J.featureIndex.loadFeature({featureIndex:Zt.featureIndex,bucketIndex:Mr.bucketIndex,sourceLayerIndex:Mr.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,J.dynamicFilter)(Jr,fo,this.retainedQueryData[b.bucketInstanceId].tileID.canonical,new c.pointGeometry(Zt.tileAnchorX,Zt.tileAnchorY),this.transform.calculateDistanceTileData(J.unwrappedTileID)))return this.placements[Zt.crossTileID]=new tr(!1,!1,!1,!0),void(s[Zt.crossTileID]=!0)}if(s[Zt.crossTileID])return;if(De)return void(this.placements[Zt.crossTileID]=new tr(!1,!1,!1));let Kt=!1,Nt=!1,qn=!0,zn=!1,jn=!1,Bn=null,si={box:null,offscreen:null,occluded:null},Di={box:null,offscreen:null,occluded:null},yi=null,pi=null,Nn=null,Ri=0,$i=0,Lr=0;yn.textFeatureIndex?Ri=yn.textFeatureIndex:Zt.useRuntimeCollisionCircles&&(Ri=Zt.featureIndex),yn.verticalTextFeatureIndex&&($i=yn.verticalTextFeatureIndex);const Ir=Jr=>{Jr.tileID=this.retainedQueryData[b.bucketInstanceId].tileID,(this.transform.elevation||Jr.elevation)&&(Jr.elevation=this.transform.elevation?this.transform.elevation.getAtTileOffset(this.retainedQueryData[b.bucketInstanceId].tileID,Jr.tileAnchorX,Jr.tileAnchorY):0)},Ar=yn.textBox;if(Ar){Ir(Ar);const Jr=Mr=>{let Ro=c.WritingMode.horizontal;if(b.allowVerticalPlacement&&!Mr&&this.prevPlacement){const gs=this.prevPlacement.placedOrientations[Zt.crossTileID];gs&&(this.placedOrientations[Zt.crossTileID]=gs,Ro=gs,this.markUsedOrientation(b,Ro,Zt))}return Ro},fo=(Mr,Ro)=>{if(b.allowVerticalPlacement&&Zt.numVerticalGlyphVertices>0&&yn.verticalTextBox){for(const gs of b.writingModes)if(gs===c.WritingMode.vertical?(si=Ro(),Di=si):si=Mr(),si&&si.box&&si.box.length)break}else si=Mr()};if(D.get("text-variable-anchor")){let Mr=D.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[Zt.crossTileID]){const Vr=this.prevPlacement.variableOffsets[Zt.crossTileID];Mr.indexOf(Vr.anchor)>0&&(Mr=Mr.filter(_s=>_s!==Vr.anchor),Mr.unshift(Vr.anchor))}const Ro=(Vr,_s,Fl)=>{const ma=b.getSymbolInstanceTextSize(ke,Zt,this.transform.zoom,bn),ys=(Vr.x2-Vr.x1)*ma+2*Vr.padding,Os=(Vr.y2-Vr.y1)*ma+2*Vr.padding,kl=It&&!gt?_s:null;kl&&Ir(kl);let rs={box:[],offscreen:!1,occluded:!1};const Wa=We?2*Mr.length:Mr.length;for(let ul=0;ul<Wa;++ul){const Qs=this.attemptAnchorPlacement(Mr[ul%Mr.length],Vr,ys,Os,ma,yt,ot,ue,O,$e,ul>=Mr.length,Zt,bn,b,Fl,kl,ke,Ye);if(Qs&&(rs=Qs.placedGlyphBoxes,rs&&rs.box&&rs.box.length)){Kt=!0,Bn=Qs.shift;break}}return rs};fo(()=>Ro(Ar,yn.iconBox,c.WritingMode.horizontal),()=>{const Vr=yn.verticalTextBox;return Vr&&Ir(Vr),b.allowVerticalPlacement&&!(si&&si.box&&si.box.length)&&Zt.numVerticalGlyphVertices>0&&Vr?Ro(Vr,yn.verticalIconBox,c.WritingMode.vertical):{box:null,offscreen:null,occluded:null}}),si&&(Kt=si.box,qn=si.offscreen,zn=si.occluded);const gs=Jr(si&&si.box);if(!Kt&&this.prevPlacement){const Vr=this.prevPlacement.variableOffsets[Zt.crossTileID];Vr&&(this.variableOffsets[Zt.crossTileID]=Vr,this.markUsedJustification(b,Vr.anchor,Zt,gs))}}else{const Mr=(Ro,gs)=>{const Vr=b.getSymbolInstanceTextSize(ke,Zt,this.transform.zoom,bn),_s=this.collisionIndex.placeCollisionBox(b,Vr,Ro,new c.pointGeometry(0,0),We,ue,O,$e.predicate);return _s&&_s.box&&_s.box.length&&(this.markUsedOrientation(b,gs,Zt),this.placedOrientations[Zt.crossTileID]=gs),_s};fo(()=>Mr(Ar,c.WritingMode.horizontal),()=>{const Ro=yn.verticalTextBox;return b.allowVerticalPlacement&&Zt.numVerticalGlyphVertices>0&&Ro?(Ir(Ro),Mr(Ro,c.WritingMode.vertical)):{box:null,offscreen:null,occluded:null}}),Jr(si&&si.box&&si.box.length)}}if(yi=si,Kt=yi&&yi.box&&yi.box.length>0,qn=yi&&yi.offscreen,zn=yi&&yi.occluded,Zt.useRuntimeCollisionCircles){const Jr=b.text.placedSymbolArray.get(Zt.centerJustifiedTextSymbolIndex>=0?Zt.centerJustifiedTextSymbolIndex:Zt.verticalPlacedTextSymbolIndex),fo=c.evaluateSizeForFeature(b.textSizeData,ke,Jr),Mr=D.get("text-padding");pi=this.collisionIndex.placeCollisionCircles(b,We,Jr,b.lineVertexArray,b.glyphOffsetArray,fo,O,k,H,p,ot,$e.predicate,Zt.collisionCircleDiameter*fo/c.ONE_EM,Mr,this.retainedQueryData[b.bucketInstanceId].tileID),Kt=We||pi.circles.length>0&&!pi.collisionDetected,qn=qn&&pi.offscreen,zn=pi.occluded}if(yn.iconFeatureIndex&&(Lr=yn.iconFeatureIndex),yn.iconBox){const Jr=fo=>{Ir(fo);const Mr=It&&Bn?io(Bn.x,Bn.y,yt,ot,this.transform.angle):new c.pointGeometry(0,0),Ro=b.getSymbolInstanceIconSize(Ye,this.transform.zoom,Zt.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(b,Ro,fo,Mr,gt,ue,O,$e.predicate)};Di&&Di.box&&Di.box.length&&yn.verticalIconBox?(Nn=Jr(yn.verticalIconBox),Nt=Nn.box.length>0):(Nn=Jr(yn.iconBox),Nt=Nn.box.length>0),qn=qn&&Nn.offscreen,jn=Nn.occluded}const qo=Be||0===Zt.numHorizontalGlyphVertices&&0===Zt.numVerticalGlyphVertices,is=Xe||0===Zt.numIconVertices;if(qo||is?is?qo||(Nt=Nt&&Kt):Kt=Nt&&Kt:Nt=Kt=Nt&&Kt,Kt&&yi&&yi.box&&this.collisionIndex.insertCollisionBox(yi.box,D.get("text-ignore-placement"),b.bucketInstanceId,Di&&Di.box&&$i?$i:Ri,$e.ID),Nt&&Nn&&this.collisionIndex.insertCollisionBox(Nn.box,D.get("icon-ignore-placement"),b.bucketInstanceId,Lr,$e.ID),pi&&(Kt&&this.collisionIndex.insertCollisionCircles(pi.circles,D.get("text-ignore-placement"),b.bucketInstanceId,Ri,$e.ID),p)){const Jr=b.bucketInstanceId;let fo=this.collisionCircleArrays[Jr];void 0===fo&&(fo=this.collisionCircleArrays[Jr]=new fr);for(let Mr=0;Mr<pi.circles.length;Mr+=4)fo.circles.push(pi.circles[Mr+0]),fo.circles.push(pi.circles[Mr+1]),fo.circles.push(pi.circles[Mr+2]),fo.circles.push(pi.collisionDetected?1:0)}const cl="globe"!==b.projection.name;cn=cn&&(cl||!zn),Xt=Xt&&(cl||!jn),this.placements[Zt.crossTileID]=new tr(Kt||cn,Nt||Xt,qn||b.justReloaded),s[Zt.crossTileID]=!0};if(Jt){const Zt=b.getSortedSymbolIndexes(this.transform.angle);for(let bn=Zt.length-1;bn>=0;--bn){const yn=Zt[bn];An(b.symbolInstances.get(yn),yn,b.collisionArrays[yn])}}else for(let Zt=t.symbolInstanceStart;Zt<t.symbolInstanceEnd;Zt++)An(b.symbolInstances.get(Zt),Zt,b.collisionArrays[Zt]);if(p&&b.bucketInstanceId in this.collisionCircleArrays){const Zt=this.collisionCircleArrays[b.bucketInstanceId];c.invert(Zt.invProjMatrix,O),Zt.viewportMatrix=this.collisionIndex.getViewportMatrix()}b.justReloaded=!1}markUsedJustification(t,s,p,v){let b;b=v===c.WritingMode.vertical?p.verticalPlacedTextSymbolIndex:{left:p.leftJustifiedTextSymbolIndex,center:p.centerJustifiedTextSymbolIndex,right:p.rightJustifiedTextSymbolIndex}[c.getAnchorJustification(s)];const D=[p.leftJustifiedTextSymbolIndex,p.centerJustifiedTextSymbolIndex,p.rightJustifiedTextSymbolIndex,p.verticalPlacedTextSymbolIndex];for(const O of D)O>=0&&(t.text.placedSymbolArray.get(O).crossTileID=b>=0&&O!==b?0:p.crossTileID)}markUsedOrientation(t,s,p){const v=s===c.WritingMode.horizontal||s===c.WritingMode.horizontalOnly?s:0,b=s===c.WritingMode.vertical?s:0,D=[p.leftJustifiedTextSymbolIndex,p.centerJustifiedTextSymbolIndex,p.rightJustifiedTextSymbolIndex].filter(O=>-1!==O);for(const O of D)t.text.placedSymbolArray.get(O).placedOrientation=v;-1!==p.verticalPlacedTextSymbolIndex&&(t.text.placedSymbolArray.get(p.verticalPlacedTextSymbolIndex).placedOrientation=b)}commit(t){this.commitTime=t,this.zoomAtLastRecencyCheck=this.transform.zoom;const s=this.prevPlacement;let p=!1;this.prevZoomAdjustment=s?s.zoomAdjustment(this.transform.zoom):0;const v=s?s.symbolFadeChange(t):1,b=s?s.opacities:{},D=s?s.variableOffsets:{},O=s?s.placedOrientations:{};for(const k in this.placements){const H=this.placements[k],J=b[k];J?(this.opacities[k]=new Rr(J,v,H.text,H.icon,null,H.clipped),p=p||H.text!==J.text.placed||H.icon!==J.icon.placed):(this.opacities[k]=new Rr(null,v,H.text,H.icon,H.skipFade,H.clipped),p=p||H.text||H.icon)}for(const k in b){const H=b[k];if(!this.opacities[k]){const J=new Rr(H,v,!1,!1);J.isHidden()||(this.opacities[k]=J,p=p||H.text.placed||H.icon.placed)}}for(const k in D)this.variableOffsets[k]||!this.opacities[k]||this.opacities[k].isHidden()||(this.variableOffsets[k]=D[k]);for(const k in O)this.placedOrientations[k]||!this.opacities[k]||this.opacities[k].isHidden()||(this.placedOrientations[k]=O[k]);p?this.lastPlacementChangeTime=t:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=s?s.lastPlacementChangeTime:t)}updateLayerOpacities(t,s){const p={};for(const v of s){const b=v.getBucket(t);b&&v.latestFeatureIndex&&t.id===b.layerIds[0]&&this.updateBucketOpacities(b,p,v.collisionBoxArray)}}updateBucketOpacities(t,s,p){t.hasTextData()&&t.text.opacityVertexArray.clear(),t.hasIconData()&&t.icon.opacityVertexArray.clear(),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexArray.clear(),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexArray.clear();const v=t.layers[0].layout,b=!!t.layers[0].dynamicFilter(),D=new Rr(null,0,!1,!1,!0),O=v.get("text-allow-overlap"),k=v.get("icon-allow-overlap"),H=v.get("text-variable-anchor"),J="map"===v.get("text-rotation-alignment"),ue="map"===v.get("text-pitch-alignment"),De="none"!==v.get("icon-text-fit"),je=new Rr(null,0,O&&(k||!t.hasIconData()||v.get("icon-optional")),k&&(O||!t.hasTextData()||v.get("text-optional")),!0);!t.collisionArrays&&p&&(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData())&&t.deserializeCollisionBoxes(p);const ke=($e,Be,Xe)=>{for(let We=0;We<Be/4;We++)$e.opacityVertexArray.emplaceBack(Xe)};let Ye=0;for(let $e=0;$e<t.symbolInstances.length;$e++){const Be=t.symbolInstances.get($e),{numHorizontalGlyphVertices:Xe,numVerticalGlyphVertices:We,crossTileID:gt}=Be;let yt=this.opacities[gt];s[gt]?yt=D:yt||(yt=je,this.opacities[gt]=yt),s[gt]=!0;const ot=Xe>0||We>0,It=Be.numIconVertices>0,Jt=this.placedOrientations[Be.crossTileID],cn=Jt===c.WritingMode.vertical,Xt=Jt===c.WritingMode.horizontal||Jt===c.WritingMode.horizontalOnly;if(!ot&&!It||yt.isHidden()||Ye++,ot){const An=so(yt.text);ke(t.text,Xe,cn?ao:An),ke(t.text,We,Xt?ao:An);const Zt=yt.text.isHidden();[Be.rightJustifiedTextSymbolIndex,Be.centerJustifiedTextSymbolIndex,Be.leftJustifiedTextSymbolIndex].forEach(Kt=>{Kt>=0&&(t.text.placedSymbolArray.get(Kt).hidden=Zt||cn?1:0)}),Be.verticalPlacedTextSymbolIndex>=0&&(t.text.placedSymbolArray.get(Be.verticalPlacedTextSymbolIndex).hidden=Zt||Xt?1:0);const bn=this.variableOffsets[Be.crossTileID];bn&&this.markUsedJustification(t,bn.anchor,Be,Jt);const yn=this.placedOrientations[Be.crossTileID];yn&&(this.markUsedJustification(t,"left",Be,yn),this.markUsedOrientation(t,yn,Be))}if(It){const An=so(yt.icon);Be.placedIconSymbolIndex>=0&&(ke(t.icon,Be.numIconVertices,cn?ao:An),t.icon.placedSymbolArray.get(Be.placedIconSymbolIndex).hidden=yt.icon.isHidden()),Be.verticalPlacedIconSymbolIndex>=0&&(ke(t.icon,Be.numVerticalIconVertices,Xt?ao:An),t.icon.placedSymbolArray.get(Be.verticalPlacedIconSymbolIndex).hidden=yt.icon.isHidden())}if(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData()){const An=t.collisionArrays[$e];if(An){let Zt=new c.pointGeometry(0,0),bn=!0;if(An.textBox||An.verticalTextBox){if(H){const Kt=this.variableOffsets[gt];Kt?(Zt=bo(Kt.anchor,Kt.width,Kt.height,Kt.textOffset,Kt.textScale),J&&Zt._rotate(ue?this.transform.angle:-this.transform.angle)):bn=!1}b&&(bn=!yt.clipped),An.textBox&&Io(t.textCollisionBox.collisionVertexArray,yt.text.placed,!bn||cn,Zt.x,Zt.y),An.verticalTextBox&&Io(t.textCollisionBox.collisionVertexArray,yt.text.placed,!bn||Xt,Zt.x,Zt.y)}const yn=bn&&Boolean(!Xt&&An.verticalIconBox);An.iconBox&&Io(t.iconCollisionBox.collisionVertexArray,yt.icon.placed,yn,De?Zt.x:0,De?Zt.y:0),An.verticalIconBox&&Io(t.iconCollisionBox.collisionVertexArray,yt.icon.placed,!yn,De?Zt.x:0,De?Zt.y:0)}}}if(t.fullyClipped=0===Ye,t.sortFeatures(this.transform.angle),this.retainedQueryData[t.bucketInstanceId]&&(this.retainedQueryData[t.bucketInstanceId].featureSortOrder=t.featureSortOrder),t.hasTextData()&&t.text.opacityVertexBuffer&&t.text.opacityVertexBuffer.updateData(t.text.opacityVertexArray),t.hasIconData()&&t.icon.opacityVertexBuffer&&t.icon.opacityVertexBuffer.updateData(t.icon.opacityVertexArray),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexBuffer&&t.iconCollisionBox.collisionVertexBuffer.updateData(t.iconCollisionBox.collisionVertexArray),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexBuffer&&t.textCollisionBox.collisionVertexBuffer.updateData(t.textCollisionBox.collisionVertexArray),t.bucketInstanceId in this.collisionCircleArrays){const $e=this.collisionCircleArrays[t.bucketInstanceId];t.placementInvProjMatrix=$e.invProjMatrix,t.placementViewportMatrix=$e.viewportMatrix,t.collisionCircleArray=$e.circles,delete this.collisionCircleArrays[t.bucketInstanceId]}}symbolFadeChange(t){return 0===this.fadeDuration?1:(t-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(t){return Math.max(0,(this.transform.zoom-t)/1.5)}hasTransitions(t){return this.stale||t-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(t,s){const p=this.zoomAtLastRecencyCheck===s?1-this.zoomAdjustment(s):1;return this.zoomAtLastRecencyCheck=s,this.commitTime+this.fadeDuration*p>t}setStale(){this.stale=!0}}function Io(l,t,s,p,v){l.emplaceBack(t?1:0,s?1:0,p||0,v||0),l.emplaceBack(t?1:0,s?1:0,p||0,v||0),l.emplaceBack(t?1:0,s?1:0,p||0,v||0),l.emplaceBack(t?1:0,s?1:0,p||0,v||0)}const Dr=Math.pow(2,25),Mo=Math.pow(2,24),Zr=Math.pow(2,17),ra=Math.pow(2,16),rr=Math.pow(2,9),So=Math.pow(2,8),xs=Math.pow(2,1);function so(l){if(0===l.opacity&&!l.placed)return 0;if(1===l.opacity&&l.placed)return 4294967295;const t=l.placed?1:0,s=Math.floor(127*l.opacity);return s*Dr+t*Mo+s*Zr+t*ra+s*rr+t*So+s*xs+t}const ao=0;class Wr{constructor(t){this._sortAcrossTiles="viewport-y"!==t.layout.get("symbol-z-order")&&void 0!==t.layout.get("symbol-sort-key").constantOr(1),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(t,s,p,v,b){const D=this._bucketParts;for(;this._currentTileIndex<t.length;)if(s.getBucketParts(D,v,t[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,b())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,D.sort((O,k)=>O.sortKey-k.sortKey));this._currentPartIndex<D.length;){const O=D[this._currentPartIndex];if(s.placeLayerBucketPart(O,this._seenCrossTileIDs,p,0===O.symbolInstanceStart),this._currentPartIndex++,b())return!0}return!1}}class Ho{constructor(t,s,p,v,b,D,O,k){this.placement=new ia(t,b,D,O,k),this._currentPlacementIndex=s.length-1,this._forceFullPlacement=p,this._showCollisionBoxes=v,this._done=!1}isDone(){return this._done}continuePlacement(t,s,p){const v=c.exported.now(),b=()=>{const D=c.exported.now()-v;return!this._forceFullPlacement&&D>2};for(;this._currentPlacementIndex>=0;){const D=s[t[this._currentPlacementIndex]],O=this.placement.collisionIndex.transform.zoom;if("symbol"===D.type&&(!D.minzoom||D.minzoom<=O)&&(!D.maxzoom||D.maxzoom>O)){if(this._inProgressLayer||(this._inProgressLayer=new Wr(D)),this._inProgressLayer.continuePlacement(p[D.source],this.placement,this._showCollisionBoxes,D,b))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(t){return this.placement.commit(t),this.placement}}const us=512/c.EXTENT/2;class ds{constructor(t,s,p){this.tileID=t,this.indexedSymbolInstances={},this.bucketInstanceId=p;for(let v=0;v<s.length;v++){const b=s.get(v),D=b.key;this.indexedSymbolInstances[D]||(this.indexedSymbolInstances[D]=[]),this.indexedSymbolInstances[D].push({crossTileID:b.crossTileID,coord:this.getScaledCoordinates(b,t)})}}getScaledCoordinates(t,s){const p=us/Math.pow(2,s.canonical.z-this.tileID.canonical.z);return{x:Math.floor((s.canonical.x*c.EXTENT+t.tileAnchorX)*p),y:Math.floor((s.canonical.y*c.EXTENT+t.tileAnchorY)*p)}}findMatches(t,s,p){const v=this.tileID.canonical.z<s.canonical.z?1:Math.pow(2,this.tileID.canonical.z-s.canonical.z);for(let b=0;b<t.length;b++){const D=t.get(b);if(D.crossTileID)continue;const O=this.indexedSymbolInstances[D.key];if(!O)continue;const k=this.getScaledCoordinates(D,s);for(const H of O)if(Math.abs(H.coord.x-k.x)<=v&&Math.abs(H.coord.y-k.y)<=v&&!p[H.crossTileID]){p[H.crossTileID]=!0,D.crossTileID=H.crossTileID;break}}}}class Bs{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class oa{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(t){const s=Math.round((t-this.lng)/360);if(0!==s)for(const p in this.indexes){const v=this.indexes[p],b={};for(const D in v){const O=v[D];O.tileID=O.tileID.unwrapTo(O.tileID.wrap+s),b[O.tileID.key]=O}this.indexes[p]=b}this.lng=t}addBucket(t,s,p){if(this.indexes[t.overscaledZ]&&this.indexes[t.overscaledZ][t.key]){if(this.indexes[t.overscaledZ][t.key].bucketInstanceId===s.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(t.overscaledZ,this.indexes[t.overscaledZ][t.key])}for(let b=0;b<s.symbolInstances.length;b++)s.symbolInstances.get(b).crossTileID=0;this.usedCrossTileIDs[t.overscaledZ]||(this.usedCrossTileIDs[t.overscaledZ]={});const v=this.usedCrossTileIDs[t.overscaledZ];for(const b in this.indexes){const D=this.indexes[b];if(Number(b)>t.overscaledZ)for(const O in D){const k=D[O];k.tileID.isChildOf(t)&&k.findMatches(s.symbolInstances,t,v)}else{const O=D[t.scaledTo(Number(b)).key];O&&O.findMatches(s.symbolInstances,t,v)}}for(let b=0;b<s.symbolInstances.length;b++){const D=s.symbolInstances.get(b);D.crossTileID||(D.crossTileID=p.generate(),v[D.crossTileID]=!0)}return void 0===this.indexes[t.overscaledZ]&&(this.indexes[t.overscaledZ]={}),this.indexes[t.overscaledZ][t.key]=new ds(t,s.symbolInstances,s.bucketInstanceId),!0}removeBucketCrossTileIDs(t,s){for(const p in s.indexedSymbolInstances)for(const v of s.indexedSymbolInstances[p])delete this.usedCrossTileIDs[t][v.crossTileID]}removeStaleBuckets(t){let s=!1;for(const p in this.indexes){const v=this.indexes[p];for(const b in v)t[v[b].bucketInstanceId]||(this.removeBucketCrossTileIDs(p,v[b]),delete v[b],s=!0)}return s}}class mo{constructor(){this.layerIndexes={},this.crossTileIDs=new Bs,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(t,s,p,v){let b=this.layerIndexes[t.id];void 0===b&&(b=this.layerIndexes[t.id]=new oa);let D=!1;const O={};"globe"!==v.name&&b.handleWrapJump(p);for(const k of s){const H=k.getBucket(t);H&&t.id===H.layerIds[0]&&(H.bucketInstanceId||(H.bucketInstanceId=++this.maxBucketInstanceId),b.addBucket(k.tileID,H,this.crossTileIDs)&&(D=!0),O[H.bucketInstanceId]=!0)}return b.removeStaleBuckets(O)&&(D=!0),D}pruneUnusedLayers(t){const s={};t.forEach(p=>{s[p]=!0});for(const p in this.layerIndexes)s[p]||delete this.layerIndexes[p]}}const No=(l,t)=>c.emitValidationErrors(l,t&&t.filter(s=>"source.canvas"!==s.identifier)),Ys=c.pick(Kn,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection"]),go=c.pick(Kn,["setCenter","setZoom","setBearing","setPitch"]),xa={version:8,layers:[],sources:{}},sa={fill:!0,line:!0,background:!0,hillshade:!0,raster:!0};class Ao extends c.Evented{constructor(t,s={}){super(),this.map=t,this.dispatcher=new xt(Yn(),this),this.imageManager=new Ne,this.imageManager.setEventedParent(this),this.glyphManager=new c.GlyphManager(t._requestManager,s.localFontFamily?c.LocalGlyphMode.all:s.localIdeographFontFamily?c.LocalGlyphMode.ideographs:c.LocalGlyphMode.none,s.localFontFamily||s.localIdeographFontFamily),this.crossTileSymbolIndex=new mo,this._layers={},this._num3DLayers=0,this._numSymbolLayers=0,this._numCircleLayers=0,this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this.zoomHistory=new c.ZoomHistory,this._loaded=!1,this._availableImages=[],this._order=[],this._drapedFirstOrder=[],this._markersNeedUpdate=!1,this._resetUpdates(),this.dispatcher.broadcast("setReferrer",c.getReferrer());const p=this;this._rtlTextPluginCallback=Ao.registerForPluginStateChange(v=>{p.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:v.pluginStatus,pluginURL:v.pluginURL},(b,D)=>{if(c.triggerPluginCompletionEvent(b),D&&D.every(O=>O))for(const O in p._sourceCaches){const k=p._sourceCaches[O],H=k.getSource().type;"vector"!==H&&"geojson"!==H||k.reload()}})}),this.on("data",v=>{if("source"!==v.dataType||"metadata"!==v.sourceDataType)return;const b=this.getSource(v.sourceId);if(b&&b.vectorLayerIds)for(const D in this._layers){const O=this._layers[D];O.source===b.id&&this._validateLayer(O)}})}loadURL(t,s={}){this.fire(new c.Event("dataloading",{dataType:"style"}));const p="boolean"==typeof s.validate?s.validate:!c.isMapboxURL(t);t=this.map._requestManager.normalizeStyleURL(t,s.accessToken);const v=this.map._requestManager.transformRequest(t,c.ResourceType.Style);this._request=c.getJSON(v,(b,D)=>{this._request=null,b?this.fire(new c.ErrorEvent(b)):D&&this._load(D,p)})}loadJSON(t,s={}){this.fire(new c.Event("dataloading",{dataType:"style"})),this._request=c.exported.frame(()=>{this._request=null,this._load(t,!1!==s.validate)})}loadEmpty(){this.fire(new c.Event("dataloading",{dataType:"style"})),this._load(xa,!1)}_updateLayerCount(t,s){const p=s?1:-1;t.is3D()&&(this._num3DLayers+=p),"circle"===t.type&&(this._numCircleLayers+=p),"symbol"===t.type&&(this._numSymbolLayers+=p)}_load(t,s){if(s&&No(this,c.validateStyle(t)))return;this._loaded=!0,this.stylesheet=c.clone$1(t),this._updateMapProjection();for(const v in t.sources)this.addSource(v,t.sources[v],{validate:!1});this._changed=!1,t.sprite?this._loadSprite(t.sprite):(this.imageManager.setLoaded(!0),this.dispatcher.broadcast("spriteLoaded",!0)),this.glyphManager.setURL(t.glyphs);const p=gi(this.stylesheet.layers);this._order=p.map(v=>v.id),this._layers={},this._serializedLayers={};for(let v of p)v=c.createStyleLayer(v),v.setEventedParent(this,{layer:{id:v.id}}),this._layers[v.id]=v,this._serializedLayers[v.id]=v.serialize(),this._updateLayerCount(v,!0);this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new Je(this.stylesheet.light),this.stylesheet.terrain&&!this.terrainSetForDrapingOnly()&&this._createTerrain(this.stylesheet.terrain,1),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this._updateDrapeFirstLayers(),this.fire(new c.Event("data",{dataType:"style"})),this.fire(new c.Event("style.load"))}terrainSetForDrapingOnly(){return!!this.terrain&&0===this.terrain.drapeRenderMode}setProjection(t){t?this.stylesheet.projection=t:delete this.stylesheet.projection,this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?this.getTerrain()||this.stylesheet.terrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null))}_updateMapProjection(){this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.stylesheet.projection)}_loadSprite(t){this._spriteRequest=function(s,p,v){let b,D,O;const k=c.exported.devicePixelRatio>1?"@2x":"";let H=c.getJSON(p.transformRequest(p.normalizeSpriteURL(s,k,".json"),c.ResourceType.SpriteJSON),(De,je)=>{H=null,O||(O=De,b=je,ue())}),J=c.getImage(p.transformRequest(p.normalizeSpriteURL(s,k,".png"),c.ResourceType.SpriteImage),(De,je)=>{J=null,O||(O=De,D=je,ue())});function ue(){if(O)v(O);else if(b&&D){const De=c.exported.getImageData(D),je={};for(const ke in b){const{width:Ye,height:$e,x:Be,y:Xe,sdf:We,pixelRatio:gt,stretchX:yt,stretchY:ot,content:It}=b[ke],Jt=new c.RGBAImage({width:Ye,height:$e});c.RGBAImage.copy(De,Jt,{x:Be,y:Xe},{x:0,y:0},{width:Ye,height:$e}),je[ke]={data:Jt,pixelRatio:gt,sdf:We,stretchX:yt,stretchY:ot,content:It}}v(null,je)}}return{cancel(){H&&(H.cancel(),H=null),J&&(J.cancel(),J=null)}}}(t,this.map._requestManager,(s,p)=>{if(this._spriteRequest=null,s)this.fire(new c.ErrorEvent(s));else if(p)for(const v in p)this.imageManager.addImage(v,p[v]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.dispatcher.broadcast("spriteLoaded",!0),this.fire(new c.Event("data",{dataType:"style"}))})}_validateLayer(t){const s=this.getSource(t.source);if(!s)return;const p=t.sourceLayer;p&&("geojson"===s.type||s.vectorLayerIds&&-1===s.vectorLayerIds.indexOf(p))&&this.fire(new c.ErrorEvent(new Error(`Source layer "${p}" does not exist on source "${s.id}" as specified by style layer "${t.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const t in this._sourceCaches)if(!this._sourceCaches[t].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(t){const s=[];for(const p of t){const v=this._layers[p];"custom"!==v.type&&s.push(v.serialize())}return s}hasTransitions(){if(this.light&&this.light.hasTransition()||this.fog&&this.fog.hasTransition())return!0;for(const t in this._sourceCaches)if(this._sourceCaches[t].hasTransition())return!0;for(const t in this._layers)if(this._layers[t].hasTransition())return!0;return!1}get order(){return this.map._optimizeForTerrain&&this.terrain?this._drapedFirstOrder:this._order}isLayerDraped(t){return!!this.terrain&&sa[t.type]}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}update(t){if(!this._loaded)return;const s=this._changed;if(this._changed){const v=Object.keys(this._updatedLayers),b=Object.keys(this._removedLayers);(v.length||b.length)&&this._updateWorkerLayers(v,b);for(const D in this._updatedSources){const O=this._updatedSources[D];"reload"===O?this._reloadSource(D):"clear"===O&&this._clearSource(D)}this._updateTilesForChangedImages();for(const D in this._updatedPaintProps)this._layers[D].updateTransitions(t);this.light.updateTransitions(t),this.fog&&this.fog.updateTransitions(t),this._resetUpdates()}const p={};for(const v in this._sourceCaches){const b=this._sourceCaches[v];p[v]=b.used,b.used=!1}for(const v of this._order){const b=this._layers[v];if(b.recalculate(t,this._availableImages),!b.isHidden(t.zoom)){const O=this._getLayerSourceCache(b);O&&(O.used=!0)}const D=this.map.painter;if(D){const O=b.getProgramIds();if(!O)continue;const k=b.getProgramConfiguration(t.zoom);for(const H of O)D.useProgram(H,k)}}for(const v in p){const b=this._sourceCaches[v];p[v]!==b.used&&b.getSource().fire(new c.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:b.getSource().id}))}this.light.recalculate(t),this.terrain&&this.terrain.recalculate(t),this.fog&&this.fog.recalculate(t),this.z=t.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),s&&this.fire(new c.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const t=Object.keys(this._changedImages);if(t.length){for(const s in this._sourceCaches)this._sourceCaches[s].reloadTilesForDependencies(["icons","patterns"],t);this._changedImages={}}}_updateWorkerLayers(t,s){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(t),removedIds:s})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setState(t){if(this._checkLoaded(),No(this,c.validateStyle(t)))return!1;(t=c.clone$1(t)).layers=gi(t.layers);const s=function(v,b){if(!v)return[{command:Kn.setStyle,args:[b]}];let D=[];try{if(!Y(v.version,b.version))return[{command:Kn.setStyle,args:[b]}];Y(v.center,b.center)||D.push({command:Kn.setCenter,args:[b.center]}),Y(v.zoom,b.zoom)||D.push({command:Kn.setZoom,args:[b.zoom]}),Y(v.bearing,b.bearing)||D.push({command:Kn.setBearing,args:[b.bearing]}),Y(v.pitch,b.pitch)||D.push({command:Kn.setPitch,args:[b.pitch]}),Y(v.sprite,b.sprite)||D.push({command:Kn.setSprite,args:[b.sprite]}),Y(v.glyphs,b.glyphs)||D.push({command:Kn.setGlyphs,args:[b.glyphs]}),Y(v.transition,b.transition)||D.push({command:Kn.setTransition,args:[b.transition]}),Y(v.light,b.light)||D.push({command:Kn.setLight,args:[b.light]}),Y(v.fog,b.fog)||D.push({command:Kn.setFog,args:[b.fog]}),Y(v.projection,b.projection)||D.push({command:Kn.setProjection,args:[b.projection]});const O={},k=[];!function(ue,De,je,ke){let Ye;for(Ye in De=De||{},ue=ue||{})ue.hasOwnProperty(Ye)&&(De.hasOwnProperty(Ye)||Bi(Ye,je,ke));for(Ye in De)De.hasOwnProperty(Ye)&&(ue.hasOwnProperty(Ye)?Y(ue[Ye],De[Ye])||("geojson"===ue[Ye].type&&"geojson"===De[Ye].type&&Cr(ue,De,Ye)?je.push({command:Kn.setGeoJSONSourceData,args:[Ye,De[Ye].data]}):Qr(Ye,De,je,ke)):Vi(Ye,De,je))}(v.sources,b.sources,k,O);const H=[];v.layers&&v.layers.forEach(ue=>{ue.source&&O[ue.source]?D.push({command:Kn.removeLayer,args:[ue.id]}):H.push(ue)});let J=v.terrain;J&&O[J.source]&&(D.push({command:Kn.setTerrain,args:[void 0]}),J=void 0),D=D.concat(k),Y(J,b.terrain)||D.push({command:Kn.setTerrain,args:[b.terrain]}),function(ue,De,je){De=De||[];const ke=(ue=ue||[]).map(ar),Ye=De.map(ar),$e=ue.reduce(pr,{}),Be=De.reduce(pr,{}),Xe=ke.slice(),We=Object.create(null);let gt,yt,ot,It,Jt,cn,Xt;for(gt=0,yt=0;gt<ke.length;gt++)ot=ke[gt],Be.hasOwnProperty(ot)?yt++:(je.push({command:Kn.removeLayer,args:[ot]}),Xe.splice(Xe.indexOf(ot,yt),1));for(gt=0,yt=0;gt<Ye.length;gt++)ot=Ye[Ye.length-1-gt],Xe[Xe.length-1-gt]!==ot&&($e.hasOwnProperty(ot)?(je.push({command:Kn.removeLayer,args:[ot]}),Xe.splice(Xe.lastIndexOf(ot,Xe.length-yt),1)):yt++,cn=Xe[Xe.length-gt],je.push({command:Kn.addLayer,args:[Be[ot],cn]}),Xe.splice(Xe.length-gt,0,ot),We[ot]=!0);for(gt=0;gt<Ye.length;gt++)if(ot=Ye[gt],It=$e[ot],Jt=Be[ot],!We[ot]&&!Y(It,Jt))if(Y(It.source,Jt.source)&&Y(It["source-layer"],Jt["source-layer"])&&Y(It.type,Jt.type)){for(Xt in on(It.layout,Jt.layout,je,ot,null,Kn.setLayoutProperty),on(It.paint,Jt.paint,je,ot,null,Kn.setPaintProperty),Y(It.filter,Jt.filter)||je.push({command:Kn.setFilter,args:[ot,Jt.filter]}),Y(It.minzoom,Jt.minzoom)&&Y(It.maxzoom,Jt.maxzoom)||je.push({command:Kn.setLayerZoomRange,args:[ot,Jt.minzoom,Jt.maxzoom]}),It)It.hasOwnProperty(Xt)&&"layout"!==Xt&&"paint"!==Xt&&"filter"!==Xt&&"metadata"!==Xt&&"minzoom"!==Xt&&"maxzoom"!==Xt&&(0===Xt.indexOf("paint.")?on(It[Xt],Jt[Xt],je,ot,Xt.slice(6),Kn.setPaintProperty):Y(It[Xt],Jt[Xt])||je.push({command:Kn.setLayerProperty,args:[ot,Xt,Jt[Xt]]}));for(Xt in Jt)Jt.hasOwnProperty(Xt)&&!It.hasOwnProperty(Xt)&&"layout"!==Xt&&"paint"!==Xt&&"filter"!==Xt&&"metadata"!==Xt&&"minzoom"!==Xt&&"maxzoom"!==Xt&&(0===Xt.indexOf("paint.")?on(It[Xt],Jt[Xt],je,ot,Xt.slice(6),Kn.setPaintProperty):Y(It[Xt],Jt[Xt])||je.push({command:Kn.setLayerProperty,args:[ot,Xt,Jt[Xt]]}))}else je.push({command:Kn.removeLayer,args:[ot]}),cn=Xe[Xe.lastIndexOf(ot)+1],je.push({command:Kn.addLayer,args:[Jt,cn]})}(H,b.layers,D)}catch(O){console.warn("Unable to compute style diff:",O),D=[{command:Kn.setStyle,args:[b]}]}return D}(this.serialize(),t).filter(v=>!(v.command in go));if(0===s.length)return!1;const p=s.filter(v=>!(v.command in Ys));if(p.length>0)throw new Error(`Unimplemented: ${p.map(v=>v.command).join(", ")}.`);return s.forEach(v=>{"setTransition"!==v.command&&"setProjection"!==v.command&&this[v.command].apply(this,v.args)}),this.stylesheet=t,this._updateMapProjection(),!0}addImage(t,s){return this.getImage(t)?this.fire(new c.ErrorEvent(new Error("An image with this name already exists."))):(this.imageManager.addImage(t,s),this._afterImageUpdated(t),this)}updateImage(t,s){this.imageManager.updateImage(t,s)}getImage(t){return this.imageManager.getImage(t)}removeImage(t){return this.getImage(t)?(this.imageManager.removeImage(t),this._afterImageUpdated(t),this):this.fire(new c.ErrorEvent(new Error("No image with this name exists.")))}_afterImageUpdated(t){this._availableImages=this.imageManager.listImages(),this._changedImages[t]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new c.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addSource(t,s,p={}){if(this._checkLoaded(),void 0!==this.getSource(t))throw new Error("There is already a source with this ID");if(!s.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(s).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(s.type)>=0&&this._validate(c.validateSource,`sources.${t}`,s,null,p))return;this.map&&this.map._collectResourceTiming&&(s.collectResourceTiming=!0);const v=Rt(t,s,this.dispatcher,this);v.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(t),source:v.serialize(),sourceId:t}));const b=D=>{const O=(D?"symbol:":"other:")+t,k=this._sourceCaches[O]=new c.SourceCache(O,v,D);(D?this._symbolSourceCaches:this._otherSourceCaches)[t]=k,k.style=this,k.onAdd(this.map)};b(!1),"vector"!==s.type&&"geojson"!==s.type||b(!0),v.onAdd&&v.onAdd(this.map),this._changed=!0}removeSource(t){this._checkLoaded();const s=this.getSource(t);if(!s)throw new Error("There is no source with this ID");for(const v in this._layers)if(this._layers[v].source===t)return this.fire(new c.ErrorEvent(new Error(`Source "${t}" cannot be removed while layer "${v}" is using it.`)));if(this.terrain&&this.terrain.get().source===t)return this.fire(new c.ErrorEvent(new Error(`Source "${t}" cannot be removed while terrain is using it.`)));const p=this._getSourceCaches(t);for(const v of p)delete this._sourceCaches[v.id],delete this._updatedSources[v.id],v.fire(new c.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:v.getSource().id})),v.setEventedParent(null),v.clearTiles();return delete this._otherSourceCaches[t],delete this._symbolSourceCaches[t],s.setEventedParent(null),s.onRemove&&s.onRemove(this.map),this._changed=!0,this}setGeoJSONSourceData(t,s){this._checkLoaded(),this.getSource(t).setData(s),this._changed=!0}getSource(t){const s=this._getSourceCache(t);return s&&s.getSource()}_getSources(){const t=[];for(const s in this._otherSourceCaches){const p=this._getSourceCache(s);p&&t.push(p.getSource())}return t}addLayer(t,s,p={}){this._checkLoaded();const v=t.id;if(this.getLayer(v))return void this.fire(new c.ErrorEvent(new Error(`Layer with id "${v}" already exists on this map`)));let b;if("custom"===t.type){if(No(this,c.validateCustomStyleLayer(t)))return;b=c.createStyleLayer(t)}else{if("object"==typeof t.source&&(this.addSource(v,t.source),t=c.clone$1(t),t=c.extend(t,{source:v})),this._validate(c.validateLayer,`layers.${v}`,t,{arrayIndex:-1},p))return;b=c.createStyleLayer(t),this._validateLayer(b),b.setEventedParent(this,{layer:{id:v}}),this._serializedLayers[b.id]=b.serialize(),this._updateLayerCount(b,!0)}const D=s?this._order.indexOf(s):this._order.length;if(s&&-1===D)return void this.fire(new c.ErrorEvent(new Error(`Layer with id "${s}" does not exist on this map.`)));this._order.splice(D,0,v),this._layerOrderChanged=!0,this._layers[v]=b;const O=this._getLayerSourceCache(b);if(this._removedLayers[v]&&b.source&&O&&"custom"!==b.type){const k=this._removedLayers[v];delete this._removedLayers[v],k.type!==b.type?this._updatedSources[b.source]="clear":(this._updatedSources[b.source]="reload",O.pause())}this._updateLayer(b),b.onAdd&&b.onAdd(this.map),this._updateDrapeFirstLayers()}moveLayer(t,s){if(this._checkLoaded(),this._changed=!0,!this._layers[t])return void this.fire(new c.ErrorEvent(new Error(`The layer '${t}' does not exist in the map's style and cannot be moved.`)));if(t===s)return;const p=this._order.indexOf(t);this._order.splice(p,1);const v=s?this._order.indexOf(s):this._order.length;s&&-1===v?this.fire(new c.ErrorEvent(new Error(`Layer with id "${s}" does not exist on this map.`))):(this._order.splice(v,0,t),this._layerOrderChanged=!0,this._updateDrapeFirstLayers())}removeLayer(t){this._checkLoaded();const s=this._layers[t];if(!s)return void this.fire(new c.ErrorEvent(new Error(`The layer '${t}' does not exist in the map's style and cannot be removed.`)));s.setEventedParent(null),this._updateLayerCount(s,!1);const p=this._order.indexOf(t);this._order.splice(p,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[t]=s,delete this._layers[t],delete this._serializedLayers[t],delete this._updatedLayers[t],delete this._updatedPaintProps[t],s.onRemove&&s.onRemove(this.map),this._updateDrapeFirstLayers()}getLayer(t){return this._layers[t]}hasLayer(t){return t in this._layers}hasLayerType(t){for(const s in this._layers)if(this._layers[s].type===t)return!0;return!1}setLayerZoomRange(t,s,p){this._checkLoaded();const v=this.getLayer(t);v?v.minzoom===s&&v.maxzoom===p||(null!=s&&(v.minzoom=s),null!=p&&(v.maxzoom=p),this._updateLayer(v)):this.fire(new c.ErrorEvent(new Error(`The layer '${t}' does not exist in the map's style and cannot have zoom extent.`)))}setFilter(t,s,p={}){this._checkLoaded();const v=this.getLayer(t);if(v){if(!Y(v.filter,s))return null==s?(v.filter=void 0,void this._updateLayer(v)):void(this._validate(c.validateFilter,`layers.${v.id}.filter`,s,{layerType:v.type},p)||(v.filter=c.clone$1(s),this._updateLayer(v)))}else this.fire(new c.ErrorEvent(new Error(`The layer '${t}' does not exist in the map's style and cannot be filtered.`)))}getFilter(t){const s=this.getLayer(t);return s&&c.clone$1(s.filter)}setLayoutProperty(t,s,p,v={}){this._checkLoaded();const b=this.getLayer(t);b?Y(b.getLayoutProperty(s),p)||(b.setLayoutProperty(s,p,v),this._updateLayer(b)):this.fire(new c.ErrorEvent(new Error(`The layer '${t}' does not exist in the map's style and cannot be styled.`)))}getLayoutProperty(t,s){const p=this.getLayer(t);if(p)return p.getLayoutProperty(s);this.fire(new c.ErrorEvent(new Error(`The layer '${t}' does not exist in the map's style.`)))}setPaintProperty(t,s,p,v={}){this._checkLoaded();const b=this.getLayer(t);b?Y(b.getPaintProperty(s),p)||(b.setPaintProperty(s,p,v)&&this._updateLayer(b),this._changed=!0,this._updatedPaintProps[t]=!0):this.fire(new c.ErrorEvent(new Error(`The layer '${t}' does not exist in the map's style and cannot be styled.`)))}getPaintProperty(t,s){const p=this.getLayer(t);return p&&p.getPaintProperty(s)}setFeatureState(t,s){this._checkLoaded();const p=t.source,v=t.sourceLayer,b=this.getSource(p);if(!b)return void this.fire(new c.ErrorEvent(new Error(`The source '${p}' does not exist in the map's style.`)));const D=b.type;if("geojson"===D&&v)return void this.fire(new c.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if("vector"===D&&!v)return void this.fire(new c.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));void 0===t.id&&this.fire(new c.ErrorEvent(new Error("The feature id parameter must be provided.")));const O=this._getSourceCaches(p);for(const k of O)k.setFeatureState(v,t.id,s)}removeFeatureState(t,s){this._checkLoaded();const p=t.source,v=this.getSource(p);if(!v)return void this.fire(new c.ErrorEvent(new Error(`The source '${p}' does not exist in the map's style.`)));const b=v.type,D="vector"===b?t.sourceLayer:void 0;if("vector"===b&&!D)return void this.fire(new c.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));if(s&&"string"!=typeof t.id&&"number"!=typeof t.id)return void this.fire(new c.ErrorEvent(new Error("A feature id is required to remove its specific state property.")));const O=this._getSourceCaches(p);for(const k of O)k.removeFeatureState(D,t.id,s)}getFeatureState(t){this._checkLoaded();const s=t.source,p=t.sourceLayer,v=this.getSource(s);if(v){if("vector"!==v.type||p)return void 0===t.id&&this.fire(new c.ErrorEvent(new Error("The feature id parameter must be provided."))),this._getSourceCaches(s)[0].getFeatureState(p,t.id);this.fire(new c.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new c.ErrorEvent(new Error(`The source '${s}' does not exist in the map's style.`)))}getTransition(){return c.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){const t={};for(const s in this._sourceCaches){const p=this._sourceCaches[s].getSource();t[p.id]||(t[p.id]=p.serialize())}return c.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,terrain:this.getTerrain()||void 0,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:t,layers:this._serializeLayers(this._order)},s=>void 0!==s)}_updateLayer(t){this._updatedLayers[t.id]=!0;const s=this._getLayerSourceCache(t);t.source&&!this._updatedSources[t.source]&&s&&"raster"!==s.getSource().type&&(this._updatedSources[t.source]="reload",s.pause()),this._changed=!0,t.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(t){const s=D=>"fill-extrusion"===this._layers[D].type,p={},v=[];for(let D=this._order.length-1;D>=0;D--){const O=this._order[D];if(s(O)){p[O]=D;for(const k of t){const H=k[O];if(H)for(const J of H)v.push(J)}}}v.sort((D,O)=>O.intersectionZ-D.intersectionZ);const b=[];for(let D=this._order.length-1;D>=0;D--){const O=this._order[D];if(s(O))for(let k=v.length-1;k>=0;k--){const H=v[k].feature;if(p[H.layer.id]<D)break;b.push(H),v.pop()}else for(const k of t){const H=k[O];if(H)for(const J of H)b.push(J.feature)}}return b}queryRenderedFeatures(t,s,p){s&&s.filter&&this._validate(c.validateFilter,"queryRenderedFeatures.filter",s.filter,null,s);const v={};if(s&&s.layers){if(!Array.isArray(s.layers))return this.fire(new c.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const k of s.layers){const H=this._layers[k];if(!H)return this.fire(new c.ErrorEvent(new Error(`The layer '${k}' does not exist in the map's style and cannot be queried for features.`))),[];v[H.source]=!0}}const b=[];s.availableImages=this._availableImages;const D=s&&s.layers?s.layers.some(k=>{const H=this.getLayer(k);return H&&H.is3D()}):this.has3DLayers(),O=bt.createFromScreenPoints(t,p);for(const k in this._sourceCaches){const H=this._sourceCaches[k].getSource().id;s.layers&&!v[H]||b.push(Pe(this._sourceCaches[k],this._layers,this._serializedLayers,O,s,p,D,!!this.map._showQueryGeometry))}return this.placement&&b.push(function(k,H,J,ue,De,je,ke){const Ye={},$e=je.queryRenderedSymbols(ue),Be=[];for(const Xe of Object.keys($e).map(Number))Be.push(ke[Xe]);Be.sort(Re);for(const Xe of Be){const We=Xe.featureIndex.lookupSymbolFeatures($e[Xe.bucketInstanceId],H,Xe.bucketIndex,Xe.sourceLayerIndex,De.filter,De.layers,De.availableImages,k);for(const gt in We){const yt=Ye[gt]=Ye[gt]||[],ot=We[gt];ot.sort((It,Jt)=>{const cn=Xe.featureSortOrder;if(cn){const Xt=cn.indexOf(It.featureIndex);return cn.indexOf(Jt.featureIndex)-Xt}return Jt.featureIndex-It.featureIndex});for(const It of ot)yt.push(It)}}for(const Xe in Ye)Ye[Xe].forEach(We=>{const gt=We.feature,yt=J(k[Xe]).getFeatureState(gt.layer["source-layer"],gt.id);gt.source=gt.layer.source,gt.layer["source-layer"]&&(gt.sourceLayer=gt.layer["source-layer"]),gt.state=yt});return Ye}(this._layers,this._serializedLayers,this._getLayerSourceCache.bind(this),O.screenGeometry,s,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(b)}querySourceFeatures(t,s){s&&s.filter&&this._validate(c.validateFilter,"querySourceFeatures.filter",s.filter,null,s);const p=this._getSourceCaches(t);let v=[];for(const b of p)v=v.concat(Ue(b,s));return v}addSourceType(t,s,p){return Ao.getSourceType(t)?p(new Error(`A source type called "${t}" already exists.`)):(Ao.setSourceType(t,s),s.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:t,url:s.workerSourceURL},p):p(null,null))}getLight(){return this.light.getLight()}setLight(t,s={}){this._checkLoaded();const p=this.light.getLight();let v=!1;for(const D in t)if(!Y(t[D],p[D])){v=!0;break}if(!v)return;const b=this._setTransitionParameters({duration:300,delay:0});this.light.setLight(t,s),this.light.updateTransitions(b)}getTerrain(){return this.terrain&&1===this.terrain.drapeRenderMode?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}setTerrain(t,s=1){if(this._checkLoaded(),!t)return delete this.terrain,delete this.stylesheet.terrain,this.dispatcher.broadcast("enableTerrain",!1),this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);if(1===s){if("object"==typeof t.source){const p="terrain-dem-src";this.addSource(p,t.source),t=c.clone$1(t),t=c.extend(t,{source:p})}if(this._validate(c.validateTerrain,"terrain",t))return}if(!this.terrain||this.terrain&&s!==this.terrain.drapeRenderMode)this._createTerrain(t,s);else{const p=this.terrain,v=p.get();for(const b of Object.keys(c.spec.terrain))!t.hasOwnProperty(b)&&c.spec.terrain[b].default&&(t[b]=c.spec.terrain[b].default);for(const b in t)if(!Y(t[b],v[b])){p.set(t),this.stylesheet.terrain=t;const D=this._setTransitionParameters({duration:0});p.updateTransitions(D);break}}this._updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(t){const s=this.fog=new Ft(t,this.map.transform);this.stylesheet.fog=t;const p=this._setTransitionParameters({duration:0});s.updateTransitions(p)}_updateMarkersOpacity(){0!==this.map._markers.length&&this.map._requestDomTask(()=>{for(const t of this.map._markers)t._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(t){if(this._checkLoaded(),!t)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const s=this.fog,p=s.get();0===Object.keys(t).length&&s.set(t);for(const v in t)if(!Y(t[v],p[v])){s.set(t),this.stylesheet.fog=t;const b=this._setTransitionParameters({duration:0});s.updateTransitions(b);break}}else this._createFog(t);this._markersNeedUpdate=!0}_setTransitionParameters(t){return{now:c.exported.now(),transition:c.extend(t,this.stylesheet.transition)}}_updateDrapeFirstLayers(){if(!this.map._optimizeForTerrain||!this.terrain)return;const t=this._order.filter(p=>this.isLayerDraped(this._layers[p])),s=this._order.filter(p=>!this.isLayerDraped(this._layers[p]));this._drapedFirstOrder=[],this._drapedFirstOrder.push(...t),this._drapedFirstOrder.push(...s)}_createTerrain(t,s){const p=this.terrain=new ae(t,s);this.stylesheet.terrain=t,this.dispatcher.broadcast("enableTerrain",!this.terrainSetForDrapingOnly()),this._force3DLayerUpdate();const v=this._setTransitionParameters({duration:0});p.updateTransitions(v)}_force3DLayerUpdate(){for(const t in this._layers){const s=this._layers[t];"fill-extrusion"===s.type&&this._updateLayer(s)}}_forceSymbolLayerUpdate(){for(const t in this._layers){const s=this._layers[t];"symbol"===s.type&&this._updateLayer(s)}}_validate(t,s,p,v,b={}){return(!b||!1!==b.validate)&&No(this,t.call(c.validateStyle,c.extend({key:s,style:this.serialize(),value:p,styleSpec:c.spec},v)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),c.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const t in this._layers)this._layers[t].setEventedParent(null);for(const t in this._sourceCaches)this._sourceCaches[t].clearTiles(),this._sourceCaches[t].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(t){const s=this._getSourceCaches(t);for(const p of s)p.clearTiles()}_reloadSource(t){const s=this._getSourceCaches(t);for(const p of s)p.resume(),p.reload()}_reloadSources(){for(const t of this._getSources())t.reload&&t.reload()}_updateSources(t){for(const s in this._sourceCaches)this._sourceCaches[s].update(t)}_generateCollisionBoxes(){for(const t in this._sourceCaches){const s=this._sourceCaches[t];s.resume(),s.reload()}}_updatePlacement(t,s,p,v,b=!1){let D=!1,O=!1;const k={};for(const H of this._order){const J=this._layers[H];if("symbol"!==J.type)continue;if(!k[J.source]){const De=this._getLayerSourceCache(J);if(!De)continue;k[J.source]=De.getRenderableIds(!0).map(je=>De.getTileByID(je)).sort((je,ke)=>ke.tileID.overscaledZ-je.tileID.overscaledZ||(je.tileID.isLessThan(ke.tileID)?-1:1))}const ue=this.crossTileSymbolIndex.addLayer(J,k[J.source],t.center.lng,t.projection);D=D||ue}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),b=b||this._layerOrderChanged||0===p,this._layerOrderChanged&&this.fire(new c.Event("neworder")),(b||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(c.exported.now(),t.zoom))&&(this.pauseablePlacement=new Ho(t,this._order,b,s,p,v,this.placement,this.fog&&t.projection.supportsFog?this.fog.state:null),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,k),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(c.exported.now()),O=!0),D&&this.pauseablePlacement.placement.setStale()),O||D)for(const H of this._order){const J=this._layers[H];"symbol"===J.type&&this.placement.updateLayerOpacities(J,k[J.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(c.exported.now())}_releaseSymbolFadeTiles(){for(const t in this._sourceCaches)this._sourceCaches[t].releaseSymbolFadeTiles()}getImages(t,s,p){this.imageManager.getImages(s.icons,p),this._updateTilesForChangedImages();const v=b=>{b&&b.setDependencies(s.tileID.key,s.type,s.icons)};v(this._otherSourceCaches[s.source]),v(this._symbolSourceCaches[s.source])}getGlyphs(t,s,p){this.glyphManager.getGlyphs(s.stacks,p)}getResource(t,s,p){return c.makeRequest(s,p)}_getSourceCache(t){return this._otherSourceCaches[t]}_getLayerSourceCache(t){return"symbol"===t.type?this._symbolSourceCaches[t.source]:this._otherSourceCaches[t.source]}_getSourceCaches(t){const s=[];return this._otherSourceCaches[t]&&s.push(this._otherSourceCaches[t]),this._symbolSourceCaches[t]&&s.push(this._symbolSourceCaches[t]),s}_isSourceCacheLoaded(t){const s=this._getSourceCaches(t);return 0===s.length?(this.fire(new c.ErrorEvent(new Error(`There is no source with ID '${t}'`))),!1):s.every(p=>p.loaded())}has3DLayers(){return this._num3DLayers>0}hasSymbolLayers(){return this._numSymbolLayers>0}hasCircleLayers(){return this._numCircleLayers>0}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}Ao.getSourceType=function(l){return Bt[l]},Ao.setSourceType=function(l,t){Bt[l]=t},Ao.registerForPluginStateChange=c.registerForPluginStateChange;var ba="\n#define EPSILON 0.0000001\n#define PI 3.141592653589793\n#define EXTENT 8192.0\n#define HALF_PI PI/2.0\n#define QUARTER_PI PI/4.0\n#define RAD_TO_DEG 180.0/PI\n#define DEG_TO_RAD PI/180.0\n#define GLOBE_RADIUS EXTENT/PI/2.0",zs="attribute highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;varying highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",il="\n#define ELEVATION_SCALE 7.0\n#define ELEVATION_OFFSET 450.0\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(\nmix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}\n#else\nvec3 elevationVector(vec2 pos) { return vec3(0,0,1); }\n#endif\n#ifdef TERRAIN\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nuniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;\n#else\nuniform sampler2D u_dem;uniform sampler2D u_dem_prev;\n#endif\nuniform vec4 u_dem_unpack;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float decodeElevation(vec4 v) {return dot(vec4(v.xyz*255.0,-1.0),u_dem_unpack);}float currentElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem,pos).a;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem,pos));\n#ifdef TERRAIN_DEM_NEAREST_FILTER\nreturn u_exaggeration*tl;\n#endif\nfloat tr=decodeElevation(texture2D(u_dem,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}float prevElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem_prev,pos).a;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem_prev,pos));float tr=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem_prev,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}\n#ifdef TERRAIN_VERTEX_MORPHING\nfloat elevation(vec2 apos) {float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}\n#else\nfloat elevation(vec2 apos) {return currentElevation(apos);}\n#endif\nhighp float unpack_depth(highp vec4 rgba_depth)\n{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture2D(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(\nunpack_depth(texture2D(u_depth,uv-df.xz)),unpack_depth(texture2D(u_depth,uv+df.xz)),unpack_depth(texture2D(u_depth,uv-df.zy)),unpack_depth(texture2D(u_depth,uv+df.zy))\n);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nfloat tl=texture2D(u_dem,pos).a;float tr=texture2D(u_dem,pos+vec2(off.x,0.0)).a;float bl=texture2D(u_dem,pos+vec2(0.0,off.y)).a;float br=texture2D(u_dem,pos+off).a;\n#else\nvec4 demtl=vec4(texture2D(u_dem,pos).xyz*255.0,-1.0);float tl=dot(demtl,u_dem_unpack);vec4 demtr=vec4(texture2D(u_dem,pos+vec2(off.x,0.0)).xyz*255.0,-1.0);float tr=dot(demtr,u_dem_unpack);vec4 dembl=vec4(texture2D(u_dem,pos+vec2(0.0,off.y)).xyz*255.0,-1.0);float bl=dot(dembl,u_dem_unpack);vec4 dembr=vec4(texture2D(u_dem,pos+off).xyz*255.0,-1.0);float br=dot(dembr,u_dem_unpack);\n#endif\nreturn vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;vec4 bounds=vec4(d,vec2(1.0)-d);h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}\n#else\nfloat elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }\n#endif",Uo="#ifdef FOG\nuniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;varying vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}\n#endif",Fa="#ifdef FOG\nuniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump float u_fog_temporal_offset;varying vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,opacity);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec3 fog_dither(vec3 color) {vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}\n#endif";let bs={},aa={};const Wo=[];qr(ba,Wo),qr(il,Wo),qr(Uo,Wo),qr(Fa,Wo),bs=Hi("",il),aa=Hi(Fa,Uo);const Js=Hi("\nhighp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}highp float unpack_depth(highp vec4 rgba_depth)\n{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}","\nfloat wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {\n#ifndef PROJECTED_POS_ON_VIEWPORT\nfloat tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;\n#else\nreturn vec3(0.0);\n#endif\n}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(\nunpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);//Normalized device coordinate that is not rendered."),ts=ba,ws="\n#ifdef GL_ES\nprecision mediump float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif";var Ns={background:Hi("uniform vec4 u_color;uniform float u_opacity;void main() {vec4 out_color=u_color;\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),backgroundPattern:Hi("uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 out_color=mix(color1,color2,u_mix);\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),circle:Hi("varying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(\nantialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)\n);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef FOG\nout_color=fog_apply_premultiplied(out_color,v_fog_pos);\n#endif\ngl_FragColor=out_color*(v_visibility*opacity_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","#define NUM_VISIBILITY_RINGS 2\n#define INV_SQRT2 0.70710678\n#define ELEVATION_BIAS 0.0001\n#define NUM_SAMPLES_PER_RING 16\nuniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;\n#endif\nvarying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {\n#if defined(TERRAIN)\nreturn elevation(pos)+ELEVATION_BIAS;\n#else\nreturn 0.0;\n#endif\n}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);\n#ifdef PITCH_WITH_MAP\n#ifdef PROJECTION_GLOBE_VIEW\nreturn u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );\n#else\nreturn u_matrix*( world_center+vec4(sample_offset,0,0) );\n#endif\n#else\nreturn projected_center+vec4(sample_offset,0,0);\n#endif\n}float get_sample_step() {\n#ifdef PITCH_WITH_MAP\nreturn 2.0*PI/float(NUM_SAMPLES_PER_RING);\n#else\nreturn PI/float(NUM_SAMPLES_PER_RING);\n#endif\n}void main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);\n#else \nsurface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);\n#endif\nvec4 projected_center=u_matrix*world_center;float view_scale=0.0;\n#ifdef PITCH_WITH_MAP\n#ifdef SCALE_WITH_MAP\nview_scale=1.0;\n#else\nview_scale=projected_center.w/u_camera_to_center_distance;\n#endif\n#else\n#ifdef SCALE_WITH_MAP\nview_scale=u_camera_to_center_distance;\n#else\nview_scale=projected_center.w;\n#endif\n#endif\ngl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;\n#ifdef TERRAIN\nfloat step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;\n#ifdef PITCH_WITH_MAP\nfloat cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;\n#else\nocclusion_world_center=world_center;occlusion_projected_center=projected_center;\n#endif\nfor(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);\n#else\nvisibility=1.0;\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nvisibility=1.0;\n#endif\nv_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);\n#ifdef FOG\nv_fog_pos=fog_position(world_center.xyz);\n#endif\n}"),clippingMask:Hi("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Hi("uniform highp float u_intensity;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef FOG\nif (u_is_globe==0) {gl_FragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;\n#endif\nvarying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#else\npos=vec3(tilePos+extrude,elevation(tilePos));\n#endif\ngl_Position=u_matrix*vec4(pos,1);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),heatmapTexture:Hi("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}","attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:Hi("varying float v_placed;varying float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);gl_FragColor =mix(red,blue,step(0.5,v_placed))*0.5;gl_FragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}","attribute vec3 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;attribute float a_size_scale;attribute vec2 a_padding;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*elevation(a_anchor_pos),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:Hi("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos_2f;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(\nmix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:Hi("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;\n#endif\nvarying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;\n#ifdef PROJECTION_GLOBE_VIEW\ngl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);\n#else\ngl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);\n#endif\n}"),fill:Hi("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\nvec4 out_color=color;\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillOutline:Hi("varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillOutlinePattern:Hi("uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=mix(color1,color2,u_fade);\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillPattern:Hi("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 out_color=mix(color1,color2,u_fade);\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillExtrusion:Hi("varying vec4 v_color;\n#ifdef RENDER_SHADOWS\nvarying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;\n#endif\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#ifdef ZERO_ROOF_RADIUS\nvarying vec4 v_roof_color;\n#endif\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nvarying highp vec3 v_normal;\n#endif\nvoid main() {\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nvec3 normal=v_normal;\n#endif\nfloat z;vec4 color;\n#ifdef ZERO_ROOF_RADIUS\nz=float(normal.z > 0.00001);color=mix(v_color,v_roof_color,z);\n#else\ncolor=v_color;\n#endif\n#ifdef FAUX_AO\nfloat intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;\n#ifdef ZERO_ROOF_RADIUS\nconcave*=(1.0-z);\n#endif\nfloat x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);color.rgb=color.rgb*shade;\n#endif\n#ifdef RENDER_SHADOWS\n#ifdef ZERO_ROOF_RADIUS\nnormal=mix(normal,vec3(0.0,0.0,1.0),z);\n#endif\ncolor.xyz=shadowed_color_normal(color.xyz,normalize(normal),v_pos_light_view_0,v_pos_light_view_1,v_depth);\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;\n#endif\nvarying vec4 v_color;\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;\n#endif\n#ifdef ZERO_ROOF_RADIUS\nvarying vec4 v_roof_color;\n#endif\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nvarying highp vec3 v_normal;\n#endif\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nv_normal=normal;\n#endif\nbase=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\nfloat ele=0.0;float h=0.0;float c_ele;vec3 pos;\n#ifdef TERRAIN\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);pos=vec3(pos_nx.xy,h);\n#else\nh=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nfloat lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#endif\nfloat hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);\n#ifdef RENDER_SHADOWS\nv_pos_light_view_0=u_light_matrix_0*vec4(pos,1);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1);v_depth=gl_Position.w;\n#endif\nfloat colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}\n#ifdef FAUX_AO\nfloat concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;\n#ifdef TERRAIN\ntop_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);\n#endif\nv_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);directional*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);\n#ifdef PROJECTION_GLOBE_VIEW\ntop_height+=u_height_lift;\n#endif\ngl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;\n#endif\nv_color.rgb+=clamp(color.rgb*directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_color*=u_opacity;\n#ifdef ZERO_ROOF_RADIUS\nv_roof_color=vec4(0.0,0.0,0.0,1.0);float roof_radiance=clamp(u_lightpos.z,0.0,1.0);roof_radiance=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roof_radiance);v_roof_color.rgb+=clamp(color.rgb*roof_radiance*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_roof_color*=u_opacity;\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),fillExtrusionPattern:Hi("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\nvarying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 out_color=mix(color1,color2,u_fade);out_color=out_color*v_lighting;\n#ifdef FAUX_AO\nfloat intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;\n#endif\nvarying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\nfloat ele=0.0;float h=z;vec3 p;float c_ele;\n#ifdef TERRAIN\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);p=vec3(pos_nx.xy,h);\n#else\np=vec3(pos_nx.xy,z);\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nfloat lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#endif\nfloat hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0\n? pos_nx.xy\n: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}\n#ifdef FAUX_AO\nfloat concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;\n#ifdef TERRAIN\ntop_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);\n#endif\nv_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);directional*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);\n#ifdef PROJECTION_GLOBE_VIEW\ntop_height+=u_height_lift;\n#endif\ngl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;\n#endif\nv_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;\n#ifdef FOG\nv_fog_pos=fog_position(p);\n#endif\n}"),hillshadePrepare:Hi("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nreturn texture2D(u_image,coord).a/4.0;\n#else\nvec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;\n#endif\n}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos);float f=getElevation(v_pos+vec2(epsilon.x,0));float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float h=getElevation(v_pos+vec2(0,epsilon.y));float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(\n(c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c)\n)/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(\nderiv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Hi("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef FOG\ngl_FragColor=fog_dither(fog_apply_premultiplied(gl_FragColor,v_fog_pos));\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),line:Hi("uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec4 v_uv;\n#ifdef RENDER_LINE_DASH\nuniform sampler2D u_dash_image;uniform float u_mix;uniform vec3 u_scale;varying vec2 v_tex_a;varying vec2 v_tex_b;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nuniform sampler2D u_gradient_image;\n#endif\nuniform float u_border_width;uniform vec4 u_border_color;float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash_from\n#pragma mapbox: define lowp vec4 dash_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize lowp vec4 dash_from\n#pragma mapbox: initialize lowp vec4 dash_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);\n#ifdef RENDER_LINE_DASH\nfloat sdfdist_a=texture2D(u_dash_image,v_tex_a).a;float sdfdist_b=texture2D(u_dash_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);float sdfwidth=min(dash_from.z*u_scale.y,dash_to.z*u_scale.z);float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/sdfwidth;alpha*=smoothstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);\n#endif\n#ifdef RENDER_LINE_GRADIENT\nhighp vec4 out_color=texture2D(u_gradient_image,v_uv.xy);\n#else\nvec4 out_color=color;\n#endif\n#ifdef RENDER_LINE_TRIM_OFFSET\nhighp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {out_color=vec4(0,0,0,0);}}\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\n#ifdef RENDER_LINE_ALPHA_DISCARD\nif (alpha < u_alpha_discard_threshold) {discard;}\n#endif\n#ifdef RENDER_LINE_BORDER\nfloat edgeBlur=(u_border_width+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);\n#ifdef RENDER_LINE_BORDER_AUTO\nfloat Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}\n#else\nout_color.rgb=mix(u_border_color.rgb,out_color.rgb,smoothAlpha);\n#endif\n}\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define EXTRUDE_SCALE 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;\n#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)\nattribute highp vec4 a_packed;\n#endif\n#ifdef RENDER_LINE_DASH\nattribute float a_linesofar;\n#endif\nuniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec4 v_uv;\n#ifdef RENDER_LINE_DASH\nuniform vec2 u_texsize;uniform mediump vec3 u_scale;varying vec2 v_tex_a;varying vec2 v_tex_b;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nuniform float u_image_height;\n#endif\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash_from\n#pragma mapbox: define lowp vec4 dash_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize lowp vec4 dash_from\n#pragma mapbox: initialize lowp vec4 dash_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\n#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)\nfloat a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];\n#ifdef RENDER_LINE_GRADIENT\nhighp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);\n#else\nv_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);\n#endif\n#endif\n#ifdef RENDER_LINE_DASH\nfloat tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;float scaleA=dash_from.z==0.0 ? 0.0 : tileZoomRatio/(dash_from.z*fromScale);float scaleB=dash_to.z==0.0 ? 0.0 : tileZoomRatio/(dash_to.z*toScale);float heightA=dash_from.y;float heightB=dash_to.y;v_tex_a=vec2(a_linesofar*scaleA/floorwidth,(-normal.y*heightA+dash_from.x+0.5)/u_texsize.y);v_tex_b=vec2(a_linesofar*scaleB/floorwidth,(-normal.y*heightB+dash_to.x+0.5)/u_texsize.y);\n#endif\nv_width2=vec2(outset,inset);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),linePattern:Hi("uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\nv_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),raster:Hi("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(\ndot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);\n#ifdef FOG\nout_color=fog_dither(fog_apply(out_color,v_fog_pos));\n#endif\ngl_FragColor=vec4(out_color*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {float w=1.0+dot(a_texture_pos,u_perspective_transform);gl_Position=u_matrix*vec4(a_pos*w,0,w);v_pos0=a_texture_pos/8192.0;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),symbolIcon:Hi("uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform vec3 u_up_vector;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nvarying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjected_point;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetProjected_point=u_matrix*vec4(a_globe_anchor+displacement,1);\n#else\noffsetProjected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);\n#endif\nvec2 a=projected_point.xy/projected_point.w;vec2 b=offsetProjected_point.xy/offsetProjected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#endif\nfloat projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nv_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;}"),symbolSDF:Hi("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nvarying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);\n#else\noffsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);\n#endif\nvec2 a=projected_point.xy/projected_point.w;vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#endif\nfloat gamma_scale=gl_Position.w;float projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nvec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade);}"),symbolTextAndIcon:Hi("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_projected_pos;attribute float a_fade_opacity;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nvarying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offset_projected_point=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offset_projected_point.xy/offset_projected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*font_scale);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#endif\nfloat gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nv_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade,is_sdf);}"),terrainRaster:Hi("uniform sampler2D u_image0;varying vec2 v_pos0;\n#ifdef FOG\nvarying float v_fog_opacity;\n#endif\n#ifdef RENDER_SHADOWS\nvarying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;\n#endif\nvoid main() {vec4 color=texture2D(u_image0,v_pos0);\n#ifdef RENDER_SHADOWS\ncolor.xyz=shadowed_color(color.xyz,v_pos_light_view_0,v_pos_light_view_1,v_depth);\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_from_vert(color,v_fog_opacity));\n#endif\ngl_FragColor=color;\n#ifdef TERRAIN_WIREFRAME\ngl_FragColor=vec4(1.0,0.0,0.0,0.8);\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_skirt_height;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;\n#ifdef FOG\nvarying float v_fog_opacity;\n#endif\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;\n#endif\nconst float skirtOffset=24575.0;const float wireframeOffset=0.00015;void main() {v_pos0=a_texture_pos/8192.0;float skirt=float(a_pos.x >=skirtOffset);float elevation=elevation(a_texture_pos)-skirt*u_skirt_height;\n#ifdef TERRAIN_WIREFRAME\nelevation+=u_skirt_height*u_skirt_height*wireframeOffset;\n#endif\nvec2 decodedPos=a_pos-vec2(skirt*skirtOffset,0.0);gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);\n#ifdef FOG\nv_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));\n#endif\n#ifdef RENDER_SHADOWS\nvec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);v_depth=gl_Position.w;\n#endif\n}"),terrainDepth:Hi("#ifdef GL_ES\nprecision highp float;\n#endif\nvarying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying float v_depth;void main() {float elevation=elevation(a_texture_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}"),skybox:Hi("\nvarying lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(\ncos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=textureCube(u_cubemap,uv).rgb;\n#ifdef FOG\nsky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);\n#endif\nsky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);gl_FragColor=vec4(sky_color*u_opacity,u_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}",zs),skyboxGradient:Hi("varying highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture2D(u_color_ramp,vec2(progress,0.5));\n#ifdef FOG\ncolor.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;\n#endif\ncolor*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}",zs),skyboxCapture:Hi("\nvarying highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;\n#ifdef GL_ES\nprecision highp float;\n#endif\n#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)\n#define BETA_M                  vec3(21e-6,21e-6,21e-6)\n#define MIE_G                   0.76\n#define DENSITY_HEIGHT_SCALE_R  8000.0\n#define DENSITY_HEIGHT_SCALE_M  1200.0\n#define PLANET_RADIUS           6360e3\n#define ATMOSPHERE_RADIUS       6420e3\n#define SAMPLE_STEPS            10\n#define DENSITY_STEPS           4\nfloat ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;gl_FragColor=vec4(color,1.0);}","attribute highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;varying highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:Hi("uniform sampler2D u_image0;varying vec2 v_pos0;\n#ifndef FOG\nuniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;\n#endif\nvoid main() {vec4 color;\n#ifdef CUSTOM_ANTIALIASING\nvec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture2D(u_image0,v_pos0);color=vec4(raster.rgb*antialias,raster.a*antialias);\n#else\ncolor=texture2D(u_image0,v_pos0);\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color;\n#ifdef TERRAIN_WIREFRAME\ngl_FragColor=vec4(1.0,0.0,0.0,0.8);\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;\n#ifdef GLOBE_POLES\nattribute vec3 a_globe_pos;attribute vec2 a_uv;\n#else\nattribute vec2 a_pos;\n#endif\nvarying vec2 v_pos0;const float wireframeOffset=1e3;float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(QUARTER_PI+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}void main() {\n#ifdef GLOBE_POLES\nvec3 globe_pos=a_globe_pos;vec2 uv=a_uv;\n#else\nfloat tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 latLng=u_grid_matrix*vec3(a_pos,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);\n#endif\nv_pos0=uv;vec2 tile_pos=uv*EXTENT;\n#ifdef GLOBE_POLES\nvec3 up_vector=normalize(globe_pos)*u_tile_up_scale;\n#else\nvec3 up_vector=elevationVector(tile_pos);\n#endif\nfloat height=elevation(tile_pos);\n#ifdef TERRAIN_WIREFRAME\nheight+=wireframeOffset;\n#endif\nglobe_pos+=up_vector*height;\n#ifdef GLOBE_POLES\nvec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);\n#else\nvec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);\n#endif\ngl_Position=u_proj_matrix*interpolated_pos;\n#ifdef FOG\nv_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);\n#endif\n}"),globeAtmosphere:Hi("uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec3 u_start_color;uniform vec4 u_color;uniform vec4 u_space_color;uniform vec4 u_high_color;uniform float u_star_intensity;uniform float u_star_size;uniform float u_star_density;uniform float u_horizon_angle;uniform mat4 u_rotation_matrix;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;highp float random(highp vec3 p) {p=fract(p*vec3(23.2342,97.1231,91.2342));p+=dot(p.zxy,p.yxz+123.1234);return fract(p.x*p.y);}float stars(vec3 p,float scale,vec2 offset) {vec2 uv_scale=(u_viewport/u_star_size)*scale;vec3 position=vec3(p.xy*uv_scale+offset*u_viewport,p.z);vec3 q=fract(position)-0.5;vec3 id=floor(position);float random_visibility=step(random(id),u_star_density);float circle=smoothstep(0.5+u_star_intensity,0.5,length(q));return circle*random_visibility;}void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;\n#ifdef PROJECTION_GLOBE_VIEW\nglobe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {discard;return;}\n#endif\nhighp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?\n0.0 : max(acos(dot(dir,horizon_dir)),0.0);float horizon_angle;\n#ifdef PROJECTION_GLOBE_VIEW\nhighp vec3 closest_point=globe_pos_dot_dir*dir;float closest_point_to_center=length(closest_point-u_globe_pos);float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?\nPI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);\n#else\nhorizon_angle=horizon_angle_mercator;\n#endif\nhorizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c =mix(color_stop_2,c2,t);float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);vec2 uv=gl_FragCoord.xy/u_viewport-0.5;float aspect_ratio=u_viewport.x/u_viewport.y;vec4 uv_dir=vec4(normalize(vec3(uv.x*aspect_ratio,uv.y,1.0)),1.0);uv_dir=u_rotation_matrix*uv_dir;vec3 n=abs(uv_dir.xyz);vec2 uv_remap=(n.x > n.y && n.x > n.z) ? uv_dir.yz/uv_dir.x:\n(n.y > n.x && n.y > n.z) ? uv_dir.zx/uv_dir.y:\nuv_dir.xy/uv_dir.z;uv_remap.x/=aspect_ratio;vec3 D=vec3(uv_remap,1.0);highp float star_field=0.0;if (u_star_intensity > 0.0) {star_field+=stars(D,1.2,vec2(0.0,0.0));star_field+=stars(D,1.0,vec2(1.0,0.0));star_field+=stars(D,0.8,vec2(0.0,1.0));star_field+=stars(D,0.6,vec2(1.0,1.0));star_field*=(1.0-pow(t,0.25+(1.0-u_high_color.a)*0.75));c+=star_field*alpha_2;}c=dither(c,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=vec4(c,a);}","attribute vec3 a_pos;attribute vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(\nmix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}")};function qr(l,t){const s=l.replace(/\s*\/\/[^\n]*\n/g,"\n").split("\n");for(let p of s)if(p=p.trim(),"#"===p[0]&&p.includes("if")&&!p.includes("endif")){p=p.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const v=p.split(" ");for(const b of v)t.includes(b)||t.push(b)}}function Hi(l,t){const s=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,p=t.match(/attribute (highp |mediump |lowp )?([\w]+) ([\w]+)/g),v={},b=[...Wo];return qr(l,b),qr(t,b),{fragmentSource:l=l.replace(s,(D,O,k,H,J)=>(v[J]=!0,"define"===O?`\n#ifndef HAS_UNIFORM_u_${J}\nvarying ${k} ${H} ${J};\n#else\nuniform ${k} ${H} u_${J};\n#endif\n`:`\n#ifdef HAS_UNIFORM_u_${J}\n    ${k} ${H} ${J} = u_${J};\n#endif\n`)),vertexSource:t=t.replace(s,(D,O,k,H,J)=>{const ue="float"===H?"vec2":"vec4",De=J.match(/color/)?"color":ue;return v[J]?"define"===O?`\n#ifndef HAS_UNIFORM_u_${J}\nuniform lowp float u_${J}_t;\nattribute ${k} ${ue} a_${J};\nvarying ${k} ${H} ${J};\n#else\nuniform ${k} ${H} u_${J};\n#endif\n`:"vec4"===De?`\n#ifndef HAS_UNIFORM_u_${J}\n    ${J} = a_${J};\n#else\n    ${k} ${H} ${J} = u_${J};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${J}\n    ${J} = unpack_mix_${De}(a_${J}, u_${J}_t);\n#else\n    ${k} ${H} ${J} = u_${J};\n#endif\n`:"define"===O?`\n#ifndef HAS_UNIFORM_u_${J}\nuniform lowp float u_${J}_t;\nattribute ${k} ${ue} a_${J};\n#else\nuniform ${k} ${H} u_${J};\n#endif\n`:"vec4"===De?`\n#ifndef HAS_UNIFORM_u_${J}\n    ${k} ${H} ${J} = a_${J};\n#else\n    ${k} ${H} ${J} = u_${J};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${J}\n    ${k} ${H} ${J} = unpack_mix_${De}(a_${J}, u_${J}_t);\n#else\n    ${k} ${H} ${J} = u_${J};\n#endif\n`}),staticAttributes:p,usedDefines:b}}class Us{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(t,s,p,v,b,D,O){this.context=t;let k=this.boundPaintVertexBuffers.length!==v.length;for(let J=0;!k&&J<v.length;J++)this.boundPaintVertexBuffers[J]!==v[J]&&(k=!0);let H=this.boundDynamicVertexBuffers.length!==O.length;for(let J=0;!H&&J<O.length;J++)this.boundDynamicVertexBuffers[J]!==O[J]&&(H=!0);if(!t.extVertexArrayObject||!this.vao||this.boundProgram!==s||this.boundLayoutVertexBuffer!==p||k||H||this.boundIndexBuffer!==b||this.boundVertexOffset!==D)this.freshBind(s,p,v,b,D,O);else{t.bindVertexArrayOES.set(this.vao);for(const J of O)J&&J.bind();b&&b.dynamicDraw&&b.bind()}}freshBind(t,s,p,v,b,D){let O;const k=t.numAttributes,H=this.context,J=H.gl;if(H.extVertexArrayObject)this.vao&&this.destroy(),this.vao=H.extVertexArrayObject.createVertexArrayOES(),H.bindVertexArrayOES.set(this.vao),O=0,this.boundProgram=t,this.boundLayoutVertexBuffer=s,this.boundPaintVertexBuffers=p,this.boundIndexBuffer=v,this.boundVertexOffset=b,this.boundDynamicVertexBuffers=D;else{O=H.currentNumAttributes||0;for(let ue=k;ue<O;ue++)J.disableVertexAttribArray(ue)}s.enableAttributes(J,t),s.bind(),s.setVertexAttribPointers(J,t,b);for(const ue of p)ue.enableAttributes(J,t),ue.bind(),ue.setVertexAttribPointers(J,t,b);for(const ue of D)ue&&(ue.enableAttributes(J,t),ue.bind(),ue.setVertexAttribPointers(J,t,b));v&&v.bind(),H.currentNumAttributes=k}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function Cs(l,t){const s=Math.pow(2,t.canonical.z),p=t.canonical.y;return[new c.MercatorCoordinate(0,p/s).toLngLat().lat,new c.MercatorCoordinate(0,(p+1)/s).toLngLat().lat]}function Vs(l,t,s,p,v,b,D){const O=l.context,k=O.gl,H=s.fbo;if(!H)return;l.prepareDrawTile();const J=l.useProgram("hillshade");O.activeTexture.set(k.TEXTURE0),k.bindTexture(k.TEXTURE_2D,H.colorAttachment.get());const ue=((Ye,$e,Be,Xe)=>{const We=Be.paint.get("hillshade-shadow-color"),gt=Be.paint.get("hillshade-highlight-color"),yt=Be.paint.get("hillshade-accent-color");let ot=Be.paint.get("hillshade-illumination-direction")*(Math.PI/180);"viewport"===Be.paint.get("hillshade-illumination-anchor")&&(ot-=Ye.transform.angle);const It=!Ye.options.moving;return{u_matrix:Xe||Ye.transform.calculateProjMatrix($e.tileID.toUnwrapped(),It),u_image:0,u_latrange:Cs(0,$e.tileID),u_light:[Be.paint.get("hillshade-exaggeration"),ot],u_shadow:We,u_highlight:gt,u_accent:yt}})(l,s,p,l.terrain?t.projMatrix:null);l.prepareDrawProgram(O,J,t.toUnwrapped());const{tileBoundsBuffer:De,tileBoundsIndexBuffer:je,tileBoundsSegments:ke}=l.getTileBoundsBuffers(s);J.draw(O,k.TRIANGLES,v,b,D,c.CullFaceMode.disabled,ue,p.id,De,je,ke)}function ns(l,t,s){if(!t.needsDEMTextureUpload)return;const p=l.context,v=p.gl;p.pixelStoreUnpackPremultiplyAlpha.set(!1),t.demTexture=t.demTexture||l.getTileTexture(s.stride);const b=s.getPixels();t.demTexture?t.demTexture.update(b,{premultiply:!1}):t.demTexture=new c.Texture(p,b,v.RGBA,{premultiply:!1}),t.needsDEMTextureUpload=!1}function Ts(l,t,s,p,v,b){const D=l.context,O=D.gl;if(!t.dem)return;const k=t.dem;if(D.activeTexture.set(O.TEXTURE1),ns(l,t,k),!t.demTexture)return;t.demTexture.bind(O.NEAREST,O.CLAMP_TO_EDGE);const H=k.dim;D.activeTexture.set(O.TEXTURE0);let J=t.fbo;if(!J){const ke=new c.Texture(D,{width:H,height:H,data:null},O.RGBA);ke.bind(O.LINEAR,O.CLAMP_TO_EDGE),J=t.fbo=D.createFramebuffer(H,H,!0),J.colorAttachment.set(ke.texture)}D.bindFramebuffer.set(J.framebuffer),D.viewport.set([0,0,H,H]);const{tileBoundsBuffer:ue,tileBoundsIndexBuffer:De,tileBoundsSegments:je}=l.getMercatorTileBoundsBuffers();l.useProgram("hillshadePrepare").draw(D,O.TRIANGLES,p,v,b,c.CullFaceMode.disabled,((ke,Ye)=>{const $e=Ye.stride,Be=c.create();return c.ortho(Be,0,c.EXTENT,-c.EXTENT,0,0,1),c.translate(Be,Be,[0,-c.EXTENT,0]),{u_matrix:Be,u_image:1,u_dimension:[$e,$e],u_zoom:ke.overscaledZ,u_unpack:Ye.unpackVector}})(t.tileID,k),s.id,ue,De,je),t.needsHillshadePrepare=!1}const hs=l=>({u_matrix:new c.UniformMatrix4f(l),u_image0:new c.Uniform1i(l),u_skirt_height:new c.Uniform1f(l)}),Po=(l,t)=>({u_matrix:l,u_image0:0,u_skirt_height:t}),ps=(l,t,s,p,v,b,D,O,k,H,J,ue,De,je)=>({u_proj_matrix:Float32Array.from(l),u_globe_matrix:t,u_normalize_matrix:Float32Array.from(p),u_merc_matrix:s,u_zoom_transition:v,u_merc_center:b,u_image0:0,u_frustum_tl:D,u_frustum_tr:O,u_frustum_br:k,u_frustum_bl:H,u_globe_pos:J,u_globe_radius:ue,u_viewport:De,u_grid_matrix:je?Float32Array.from(je):new Float32Array(9)});function fs(l,t){return null!=l&&null!=t&&!(!l.hasData()||!t.hasData())&&null!=l.demTexture&&null!=t.demTexture&&l.tileID.key!==t.tileID.key}const Tr=new class{constructor(){this.operations={}}newMorphing(l,t,s,p,v){if(l in this.operations){const b=this.operations[l];b.to.tileID.key!==s.tileID.key&&(b.queued=s)}else this.operations[l]={startTime:p,phase:0,duration:v,from:t,to:s,queued:null}}getMorphValuesForProxy(l){if(!(l in this.operations))return null;const t=this.operations[l];return{from:t.from,to:t.to,phase:t.phase}}update(l){for(const t in this.operations){const s=this.operations[t];for(s.phase=(l-s.startTime)/s.duration;s.phase>=1||!this._validOp(s);)if(!this._nextOp(s,l)){delete this.operations[t];break}}}_nextOp(l,t){return!!l.queued&&(l.from=l.to,l.to=l.queued,l.queued=null,l.phase=0,l.startTime=t,!0)}_validOp(l){return l.from.hasData()&&l.to.hasData()}},Es={0:null,1:"TERRAIN_VERTEX_MORPHING",2:"TERRAIN_WIREFRAME"};function ji(l,t){const s=1<<l.z;return!t&&(0===l.x||l.x===s-1)||0===l.y||l.y===s-1}const zr=l=>({u_matrix:l});function wa(l,t,s,p,v){if(v>0){const b=c.exported.now(),D=(b-l.timeAdded)/v,O=t?(b-t.timeAdded)/v:-1,k=s.getSource(),H=p.coveringZoomLevel({tileSize:k.tileSize,roundZoom:k.roundZoom}),J=!t||Math.abs(t.tileID.overscaledZ-H)>Math.abs(l.tileID.overscaledZ-H),ue=J&&l.refreshedUponExpiration?1:c.clamp(J?D:1-O,0,1);return l.refreshedUponExpiration&&D>=1&&(l.refreshedUponExpiration=!1),t?{opacity:1,mix:1-ue}:{opacity:ue,mix:0}}return{opacity:1,mix:0}}class Co extends c.SourceCache{constructor(t){const s={type:"raster-dem",maxzoom:t.transform.maxZoom},p=new xt(Yn(),null),v=Rt("mock-dem",s,p,t.style);super("mock-dem",v,!1),v.setEventedParent(this),this._sourceLoaded=!0}_loadTile(t,s){t.state="loaded",s(null)}}class ms extends c.SourceCache{constructor(t){const s=Rt("proxy",{type:"geojson",maxzoom:t.transform.maxZoom},new xt(Yn(),null),t.style);super("proxy",s,!1),s.setEventedParent(this),this.map=this.getSource().map=t,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(t,s,p){if(t.freezeTileCoverage)return;this.transform=t;const v=t.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((b,D)=>{if(b[D.key]="",!this._tiles[D.key]){const O=new c.Tile(D,this._source.tileSize*D.overscaleFactor(),t.tileZoom);O.state="loaded",this._tiles[D.key]=O}return b},{});for(const b in this._tiles)b in v||(this.freeFBO(b),this._tiles[b].unloadVectorData(),delete this._tiles[b])}freeFBO(t){const s=this.proxyCachedFBO[t];if(void 0!==s){const p=Object.values(s);this.renderCachePool.push(...p),delete this.proxyCachedFBO[t]}}deallocRenderCache(){this.renderCache.forEach(t=>t.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class Yr extends c.OverscaledTileID{constructor(t,s,p){super(t.overscaledZ,t.wrap,t.canonical.z,t.canonical.x,t.canonical.y),this.proxyTileKey=s,this.projMatrix=p}}class ka extends c.Elevation{constructor(t,s){super(),this.painter=t,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[p,v,b]=function(k){const H=new c.StructArrayLayout4i8,J=new c.StructArrayLayout3ui6;H.reserve(17161),J.reserve(33800);const De=c.EXTENT/128,je=c.EXTENT+De/2,ke=je+De;for(let $e=-De;$e<ke;$e+=De)for(let Be=-De;Be<ke;Be+=De){const Xe=Be<0||Be>je||$e<0||$e>je?24575:0,We=c.clamp(Math.round(Be),0,c.EXTENT),gt=c.clamp(Math.round($e),0,c.EXTENT);H.emplaceBack(We+Xe,gt,We,gt)}const Ye=($e,Be)=>{const Xe=131*Be+$e;J.emplaceBack(Xe+1,Xe,Xe+131),J.emplaceBack(Xe+131,Xe+131+1,Xe+1)};for(let $e=1;$e<129;$e++)for(let Be=1;Be<129;Be++)Ye(Be,$e);return[0,129].forEach($e=>{for(let Be=0;Be<130;Be++)Ye(Be,$e),Ye($e,Be)}),[H,J,32768]}(),D=t.context;this.gridBuffer=D.createVertexBuffer(p,c.boundsAttributes.members),this.gridIndexBuffer=D.createIndexBuffer(v),this.gridSegments=c.SegmentVector.simpleSegment(0,0,p.length,v.length),this.gridNoSkirtSegments=c.SegmentVector.simpleSegment(0,0,p.length,b),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new ms(s.map),this.orthoMatrix=c.create(),c.ortho(this.orthoMatrix,"globe"===this.painter.transform.projection.name?.015:0,c.EXTENT,0,c.EXTENT,0,1);const O=D.gl;this._overlapStencilMode=new c.StencilMode({func:O.GEQUAL,mask:255},0,255,O.KEEP,O.KEEP,O.REPLACE),this._previousZoom=t.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=s,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new Co(s.map)}set style(t){t.on("data",this._onStyleDataEvent.bind(this)),t.on("neworder",this._checkRenderCacheEfficiency.bind(this)),this._style=t,this._checkRenderCacheEfficiency()}update(t,s,p){if(t&&t.terrain){this._style!==t&&(this.style=t),this.enabled=!0;const v=t.terrain.properties;this.sourceCache=0===t.terrain.drapeRenderMode?this._mockSourceCache:t._getSourceCache(v.get("source")),this._exaggeration=v.get("exaggeration");const b=()=>{this.sourceCache.used&&c.warnOnce(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.\nThis leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const D=this.getScaledDemTileSize();this.sourceCache.update(s,D,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,b(),this._initializing=!0),b(),s.updateElevation(!p),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(s),this._emptyDEMTextureDirty=!0}else this._disable()}resetTileLookupCache(t){this._findCoveringTileCache[t]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_checkRenderCacheEfficiency(){const t=this.renderCacheEfficiency(this._style);this._style.map._optimizeForTerrain||100!==t.efficiency&&c.warnOnce(`Terrain render cache efficiency is not optimal (${t.efficiency}%) and performance\n                may be affected negatively, consider placing all background, fill and line layers before layer\n                with id '${t.firstUndrapedLayer}' or create a map using optimizeForTerrain: true option.`)}_onStyleDataEvent(t){t.coord&&"source"===t.dataType?this._clearRenderCacheForTile(t.sourceCacheId,t.coord):"style"===t.dataType&&(this._invalidateRenderCache=!0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const t in this._style._sourceCaches)this._style._sourceCaches[t].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this._emptyDepthBufferTexture&&this._emptyDepthBufferTexture.destroy(),this.pool.forEach(t=>t.fb.destroy()),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0)}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const t=2*this.proxySourceCache.getSource().tileSize;return[t,t]}set useVertexMorphing(t){this._useVertexMorphing=t}updateTileBinding(t){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const s=this.proxySourceCache,p=this.painter.transform;this._initializing&&(this._initializing=0===p._centerAltitude&&-1===this.getAtPointOrZero(c.MercatorCoordinate.fromLngLat(p.center),-1),this._emptyDEMTextureDirty=!this._initializing);const v=this.proxyCoords=s.getIds().map(k=>{const H=s.getTileByID(k).tileID;return H.projMatrix=p.calculateProjMatrix(H.toUnwrapped()),H});(function(k,H){const J=H.transform.pointCoordinate(H.transform.getCameraPoint()),ue=new c.pointGeometry(J.x,J.y);k.sort((De,je)=>{if(je.overscaledZ-De.overscaledZ)return je.overscaledZ-De.overscaledZ;const ke=new c.pointGeometry(De.canonical.x+(1<<De.canonical.z)*De.wrap,De.canonical.y),Ye=new c.pointGeometry(je.canonical.x+(1<<je.canonical.z)*je.wrap,je.canonical.y),$e=ue.mult(1<<De.canonical.z);return $e.x-=.5,$e.y-=.5,$e.distSqr(ke)-$e.distSqr(Ye)})})(v,this.painter),this._previousZoom=p.zoom;const b=this.proxyToSource||{};this.proxyToSource={},v.forEach(k=>{this.proxyToSource[k.key]={}}),this.terrainTileForTile={};const D=this._style._sourceCaches;for(const k in D){const H=D[k];if(!H.used||(H!==this.sourceCache&&this.resetTileLookupCache(H.id),this._setupProxiedCoordsForOrtho(H,t[k],b),H.usedForTerrain))continue;const J=t[k];H.getSource().reparseOverscaled&&this._assignTerrainTiles(J)}this.proxiedCoords[s.id]=v.map(k=>new Yr(k,k.key,this.orthoMatrix)),this._assignTerrainTiles(v),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(b),this.renderingToTexture=!1,this._updateTimestamp=c.exported.now();const O={};this._visibleDemTiles=[];for(const k of this.proxyCoords){const H=this.terrainTileForTile[k.key];if(!H)continue;const J=H.tileID.key;J in O||(this._visibleDemTiles.push(H),O[J]=J)}}_assignTerrainTiles(t){this._initializing||t.forEach(s=>{if(this.terrainTileForTile[s.key])return;const p=this._findTileCoveringTileID(s,this.sourceCache);p&&(this.terrainTileForTile[s.key]=p)})}_prepareDEMTextures(){const t=this.painter.context,s=t.gl;for(const p in this.terrainTileForTile){const v=this.terrainTileForTile[p],b=v.dem;!b||v.demTexture&&!v.needsDEMTextureUpload||(t.activeTexture.set(s.TEXTURE1),ns(this.painter,v,b))}}_prepareDemTileUniforms(t,s,p,v){if(!s||null==s.demTexture)return!1;const b=t.tileID.canonical,D=Math.pow(2,s.tileID.canonical.z-b.z),O=v||"";return p[`u_dem_tl${O}`]=[b.x*D%1,b.y*D%1],p[`u_dem_scale${O}`]=D,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}get emptyDepthBufferTexture(){const t=this.painter.context,s=t.gl;if(!this._emptyDepthBufferTexture){const p=new c.RGBAImage({width:1,height:1},Uint8Array.of(255,255,255,255));this._emptyDepthBufferTexture=new c.Texture(t,p,s.RGBA,{premultiply:!1})}return this._emptyDepthBufferTexture}_getLoadedAreaMinimum(){let t=0;const s=this._visibleDemTiles.reduce((p,v)=>{if(!v.dem)return p;const b=v.dem.tree.minimums[0];return b>0&&t++,p+b},0);return t?s/t:0}_updateEmptyDEMTexture(){const t=this.painter.context,s=t.gl;t.activeTexture.set(s.TEXTURE2);const p=this._getLoadedAreaMinimum(),v=new c.RGBAImage({width:1,height:1},new Uint8Array(c.DEMData.pack(p,this.sourceCache.getSource().encoding)));this._emptyDEMTextureDirty=!1;let b=this._emptyDEMTexture;return b?b.update(v,{premultiply:!1}):b=this._emptyDEMTexture=new c.Texture(t,v,s.RGBA,{premultiply:!1}),b}setupElevationDraw(t,s,p){const v=this.painter.context,b=v.gl,D=(O=this.sourceCache.getSource().encoding,{u_dem:2,u_dem_prev:4,u_dem_unpack:c.DEMData.getUnpackVector(O),u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0});var O;D.u_dem_size=this.sourceCache.getSource().tileSize,D.u_exaggeration=this.exaggeration();let k=null,H=null,J=1;if(p&&p.morphing&&this._useVertexMorphing){const ue=p.morphing.srcDemTile,De=p.morphing.dstDemTile;J=p.morphing.phase,ue&&De&&(this._prepareDemTileUniforms(t,ue,D,"_prev")&&(H=ue),this._prepareDemTileUniforms(t,De,D)&&(k=De))}if(H&&k?(v.activeTexture.set(b.TEXTURE2),k.demTexture.bind(b.NEAREST,b.CLAMP_TO_EDGE,b.NEAREST),v.activeTexture.set(b.TEXTURE4),H.demTexture.bind(b.NEAREST,b.CLAMP_TO_EDGE,b.NEAREST),D.u_dem_lerp=J):(k=this.terrainTileForTile[t.tileID.key],v.activeTexture.set(b.TEXTURE2),(this._prepareDemTileUniforms(t,k,D)?k.demTexture:this.emptyDEMTexture).bind(b.NEAREST,b.CLAMP_TO_EDGE)),v.activeTexture.set(b.TEXTURE3),p&&p.useDepthForOcclusion?(this._depthTexture&&this._depthTexture.bind(b.NEAREST,b.CLAMP_TO_EDGE),this._depthFBO&&(D.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height])):(this.emptyDepthBufferTexture.bind(b.NEAREST,b.CLAMP_TO_EDGE),D.u_depth_size_inv=[1,1]),p&&p.useMeterToDem&&k){const ue=(1<<k.tileID.canonical.z)*c.mercatorZfromAltitude(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;D.u_meter_to_dem=ue}if(p&&p.labelPlaneMatrixInv&&(D.u_label_plane_matrix_inv=p.labelPlaneMatrixInv),s.setTerrainUniformValues(v,D),"globe"===this.painter.transform.projection.name){const ue=this.globeUniformValues(this.painter.transform,t.tileID.canonical,p&&p.useDenormalizedUpVectorScale);s.setGlobeUniformValues(v,ue)}}globeUniformValues(t,s,p){const v=t.projection;return{u_tile_tl_up:v.upVector(s,0,0),u_tile_tr_up:v.upVector(s,c.EXTENT,0),u_tile_br_up:v.upVector(s,c.EXTENT,c.EXTENT),u_tile_bl_up:v.upVector(s,0,c.EXTENT),u_tile_up_scale:p?c.GLOBE_METERS_TO_ECEF:v.upVectorScale(s,t.center.lat,t.worldSize).metersToTile}}renderToBackBuffer(t){const s=this.painter,p=this.painter.context;0!==t.length&&(p.bindFramebuffer.set(null),p.viewport.set([0,0,s.width,s.height]),s.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(v,b,D,O,k){if("globe"===v.transform.projection.name)!function(H,J,ue,De,je){const ke=H.context,Ye=ke.gl;let $e,Be;const Xe=H.options.showTerrainWireframe?2:0,We=H.transform,gt=c.globeUseCustomAntiAliasing(H,ke,We),yt=(Kt,Nt)=>{if(Be===Kt)return;const qn=[Es[Kt],"PROJECTION_GLOBE_VIEW"];gt&&qn.push("CUSTOM_ANTIALIASING"),Nt&&qn.push(Es[Xe]),$e=H.useProgram("globeRaster",null,qn),Be=Kt},ot=H.colorModeForRenderPass(),It=new c.DepthMode(Ye.LEQUAL,c.DepthMode.ReadWrite,H.depthRangeFor3D);Tr.update(je);const Jt=c.calculateGlobeMercatorMatrix(We),cn=[c.mercatorXfromLng(We.center.lng),c.mercatorYfromLat(We.center.lat)],Xt=Xe?[!1,!0]:[!1],An=H.globeSharedBuffers,Zt=[We.width*c.exported.devicePixelRatio,We.height*c.exported.devicePixelRatio],bn=Float32Array.from(We.globeMatrix),yn={useDenormalizedUpVectorScale:!0};if(Xt.forEach(Kt=>{Be=-1;const Nt=Kt?Ye.LINES:Ye.TRIANGLES;for(const qn of De){const zn=ue.getTile(qn),jn=c.StencilMode.disabled,Bn=J.prevTerrainTileForTile[qn.key],si=J.terrainTileForTile[qn.key];fs(Bn,si)&&Tr.newMorphing(qn.key,Bn,si,je,250),ke.activeTexture.set(Ye.TEXTURE0),zn.texture.bind(Ye.LINEAR,Ye.CLAMP_TO_EDGE);const Di=Tr.getMorphValuesForProxy(qn.key),yi=Di?1:0;Di&&c.extend$1(yn,{morphing:{srcDemTile:Di.from,dstDemTile:Di.to,phase:c.easeCubicInOut(Di.phase)}});const pi=c.tileCornersToBounds(qn.canonical),Nn=c.getLatitudinalLod(pi.getCenter().lat),Ri=c.getGridMatrix(qn.canonical,pi,Nn,We.worldSize/We._pixelsPerMercatorPixel),$i=c.globeNormalizeECEF(c.globeTileBounds(qn.canonical)),Lr=ps(We.projMatrix,bn,Jt,$i,c.globeToMercatorTransition(We.zoom),cn,We.frustumCorners.TL,We.frustumCorners.TR,We.frustumCorners.BR,We.frustumCorners.BL,We.globeCenterInViewSpace,We.globeRadius,Zt,Ri);if(yt(yi,Kt),J.setupElevationDraw(zn,$e,yn),H.prepareDrawProgram(ke,$e,qn.toUnwrapped()),An){const[Ir,Ar,qo]=Kt?An.getWirefameBuffers(H.context,Nn):An.getGridBuffers(Nn);$e.draw(ke,Nt,It,jn,ot,c.CullFaceMode.backCCW,Lr,"globe_raster",Ir,Ar,qo)}}}),An){const Kt=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];gt&&Kt.push("CUSTOM_ANTIALIASING"),$e=H.useProgram("globeRaster",null,Kt);for(const Nt of De){const{x:qn,y:zn,z:jn}=Nt.canonical,Bn=0===zn,si=zn===(1<<jn)-1,[Di,yi,pi,Nn]=An.getPoleBuffers(jn);if(Nn&&(Bn||si)){const Ri=ue.getTile(Nt);ke.activeTexture.set(Ye.TEXTURE0),Ri.texture.bind(Ye.LINEAR,Ye.CLAMP_TO_EDGE);let $i=c.globePoleMatrixForTile(jn,qn,We);const Lr=c.globeNormalizeECEF(c.globeTileBounds(Nt.canonical)),Ir=(Ar,qo)=>Ar.draw(ke,Ye.TRIANGLES,It,c.StencilMode.disabled,ot,c.CullFaceMode.disabled,ps(We.projMatrix,$i,$i,Lr,0,cn,We.frustumCorners.TL,We.frustumCorners.TR,We.frustumCorners.BR,We.frustumCorners.BL,We.globeCenterInViewSpace,We.globeRadius,Zt),"globe_pole_raster",qo,pi,Nn);J.setupElevationDraw(Ri,$e,yn),H.prepareDrawProgram(ke,$e,Nt.toUnwrapped()),Bn&&Ir($e,Di),si&&($i=c.scale(c.create(),$i,[1,-1,1]),Ir($e,yi))}}}}(v,b,D,O,k);else{const H=v.context,J=H.gl;let ue,De;const je=v.options.showTerrainWireframe?2:0,ke=(We,gt)=>{if(De===We)return;const yt=[Es[We]];gt&&yt.push(Es[je]),ue=v.useProgram("terrainRaster",null,yt),De=We},Ye=v.colorModeForRenderPass(),$e=new c.DepthMode(J.LEQUAL,c.DepthMode.ReadWrite,v.depthRangeFor3D);Tr.update(k);const Be=v.transform,Xe=6*Math.pow(1.5,22-Be.zoom)*b.exaggeration();(je?[!1,!0]:[!1]).forEach(We=>{De=-1;const gt=We?J.LINES:J.TRIANGLES,[yt,ot]=We?b.getWirefameBuffer():[b.gridIndexBuffer,b.gridSegments];for(const It of O){const Jt=D.getTile(It),cn=c.StencilMode.disabled,Xt=b.prevTerrainTileForTile[It.key],An=b.terrainTileForTile[It.key];fs(Xt,An)&&Tr.newMorphing(It.key,Xt,An,k,250),H.activeTexture.set(J.TEXTURE0),Jt.texture.bind(J.LINEAR,J.CLAMP_TO_EDGE,J.LINEAR_MIPMAP_NEAREST);const Zt=Tr.getMorphValuesForProxy(It.key),bn=Zt?1:0;let yn;Zt&&(yn={morphing:{srcDemTile:Zt.from,dstDemTile:Zt.to,phase:c.easeCubicInOut(Zt.phase)}});const Kt=Po(It.projMatrix,ji(It.canonical,Be.renderWorldCopies)?Xe/10:Xe);ke(bn,We),b.setupElevationDraw(Jt,ue,yn),v.prepareDrawProgram(H,ue,It.toUnwrapped()),ue.draw(H,gt,$e,cn,Ye,c.CullFaceMode.backCCW,Kt,"terrain_raster",b.gridBuffer,yt,ot)}})}}(s,this,this.proxySourceCache,t,this._updateTimestamp),this.renderingToTexture=!0,s.gpuTimingDeferredRenderEnd(),t.splice(0,t.length))}renderBatch(t){if(0===this._drapedRenderBatches.length)return t+1;this.renderingToTexture=!0;const s=this.painter,p=this.painter.context,v=this.proxySourceCache,b=this.proxiedCoords[v.id],D=this._drapedRenderBatches.shift(),O=[],k=s.style.order;let H=0;for(const J of b){const ue=v.getTileByID(J.proxyTileKey),De=v.proxyCachedFBO[J.key]?v.proxyCachedFBO[J.key][t]:void 0,je=void 0!==De?v.renderCache[De]:this.pool[H++],ke=void 0!==De;if(ue.texture=je.tex,ke&&!je.dirty){O.push(ue.tileID);continue}let Ye;p.bindFramebuffer.set(je.fb.framebuffer),this.renderedToTile=!1,je.dirty&&(p.clear({color:c.Color.transparent,stencil:0}),je.dirty=!1);for(let $e=D.start;$e<=D.end;++$e){const Be=s.style._layers[k[$e]];if(Be.isHidden(s.transform.zoom))continue;const Xe=s.style._getLayerSourceCache(Be),We=Xe?this.proxyToSource[J.key][Xe.id]:[J];if(!We)continue;const gt=We;p.viewport.set([0,0,je.fb.width,je.fb.height]),Ye!==(Xe?Xe.id:null)&&(this._setupStencil(je,We,Be,Xe),Ye=Xe?Xe.id:null),s.renderLayer(s,Xe,Be,gt)}this.renderedToTile?(je.dirty=!0,O.push(ue.tileID)):ke||--H,5===H&&(H=0,this.renderToBackBuffer(O))}return this.renderToBackBuffer(O),this.renderingToTexture=!1,p.bindFramebuffer.set(null),p.viewport.set([0,0,s.width,s.height]),D.end+1}postRender(){}renderCacheEfficiency(t){const s=t.order.length;if(0===s)return{efficiency:100};let p,v=0,b=0,D=!1;for(let O=0;O<s;++O){const k=t._layers[t.order[O]];this._style.isLayerDraped(k)?(D&&++v,++b):D||(D=!0,p=k.id)}return 0===b?{efficiency:100}:{efficiency:100*(1-v/b),firstUndrapedLayer:p}}getMinElevationBelowMSL(){let t=0;return this._visibleDemTiles.filter(s=>s.dem).forEach(s=>{t=Math.min(t,s.dem.tree.minimums[0])}),0===t?t:(t-30)*this._exaggeration}raycast(t,s,p){if(!this._visibleDemTiles)return null;const v=this._visibleDemTiles.filter(b=>b.dem).map(b=>{const D=b.tileID,O=1<<D.overscaledZ,{x:k,y:H}=D.canonical,J=k/O,ue=(k+1)/O,De=H/O,je=(H+1)/O;return{minx:J,miny:De,maxx:ue,maxy:je,t:b.dem.tree.raycastRoot(J,De,ue,je,t,s,p),tile:b}});v.sort((b,D)=>(null!==b.t?b.t:Number.MAX_VALUE)-(null!==D.t?D.t:Number.MAX_VALUE));for(const b of v){if(null==b.t)return null;const D=b.tile.dem.tree.raycast(b.minx,b.miny,b.maxx,b.maxy,t,s,p);if(null!=D)return D}return null}_createFBO(){const t=this.painter.context,s=t.gl,p=this.drapeBufferSize;t.activeTexture.set(s.TEXTURE0);const v=new c.Texture(t,{width:p[0],height:p[1],data:null},s.RGBA);v.bind(s.LINEAR,s.CLAMP_TO_EDGE);const b=t.createFramebuffer(p[0],p[1],!1);return b.colorAttachment.set(v.texture),b.depthAttachment=new Ve(t,b.framebuffer),void 0===this._sharedDepthStencil?(this._sharedDepthStencil=t.createRenderbuffer(t.gl.DEPTH_STENCIL,p[0],p[1]),this._stencilRef=0,b.depthAttachment.set(this._sharedDepthStencil),t.clear({stencil:0})):b.depthAttachment.set(this._sharedDepthStencil),t.extTextureFilterAnisotropic&&!t.extTextureFilterAnisotropicForceOff&&s.texParameterf(s.TEXTURE_2D,t.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,t.extTextureFilterAnisotropicMax),{fb:b,tex:v,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._style.light&&this._style.light.hasTransition())return!0;for(const t in this._style._sourceCaches)if(this._style._sourceCaches[t].hasTransition())return!0;return this._style.order.some(t=>{const s=this._style._layers[t],p=s.isHidden(this.painter.transform.zoom),v=s.getCrossfadeParameters(),b=!!v&&1!==v.t,D=s.hasTransition();return"custom"!==s.type&&!p&&(b||D)})}_clearRasterFadeFromRenderCache(){let t=!1;for(const s in this._style._sourceCaches)if(this._style._sourceCaches[s]._source instanceof j){t=!0;break}if(t)for(let s=0;s<this._style.order.length;++s){const p=this._style._layers[this._style.order[s]],v=p.isHidden(this.painter.transform.zoom),b=this._style._getLayerSourceCache(p);if("raster"!==p.type||v||!b)continue;const D=p.paint.get("raster-fade-duration");for(const O of this.proxyCoords){const k=this.proxyToSource[O.key][b.id];if(k)for(const H of k){const J=wa(b.getTile(H),b.findLoadedParent(H,0),b,this.painter.transform,D);(1!==J.opacity||0!==J.mix)&&this._clearRenderCacheForTile(b.id,H)}}}}_setupDrapedRenderBatches(){const t=this._style.order,s=t.length;if(0===s)return;const p=[];let v,b=0,D=this._style._layers[t[b]];for(;!this._style.isLayerDraped(D)&&D.isHidden(this.painter.transform.zoom)&&++b<s;)D=this._style._layers[t[b]];for(;b<s;++b){const O=this._style._layers[t[b]];O.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(O)?void 0===v&&(v=b):void 0!==v&&(p.push({start:v,end:b-1}),v=void 0))}void 0!==v&&p.push({start:v,end:b-1}),this._drapedRenderBatches=p}_setupRenderCache(t){const s=this.proxySourceCache;if(this._shouldDisableRenderCache()||this._invalidateRenderCache){if(this._invalidateRenderCache=!1,s.renderCache.length>s.renderCachePool.length){const D=Object.values(s.proxyCachedFBO);s.proxyCachedFBO={};for(let O=0;O<D.length;++O){const k=Object.values(D[O]);s.renderCachePool.push(...k)}}return}this._clearRasterFadeFromRenderCache();const p=this.proxyCoords,v=this._tilesDirty;for(let D=p.length-1;D>=0;D--){const O=p[D];if(s.getTileByID(O.key),void 0!==s.proxyCachedFBO[O.key]){const k=t[O.key],H=this.proxyToSource[O.key];let J=0;for(const ue in H){const De=H[ue],je=k[ue];if(!je||je.length!==De.length||De.some((ke,Ye)=>ke!==je[Ye]||v[ue]&&v[ue].hasOwnProperty(ke.key))){J=-1;break}++J}for(const ue in s.proxyCachedFBO[O.key])s.renderCache[s.proxyCachedFBO[O.key][ue]].dirty=J<0||J!==Object.values(k).length}}const b=[...this._drapedRenderBatches];b.sort((D,O)=>O.end-O.start-(D.end-D.start));for(const D of b)for(const O of p){if(s.proxyCachedFBO[O.key])continue;let k=s.renderCachePool.pop();void 0===k&&s.renderCache.length<50&&(k=s.renderCache.length,s.renderCache.push(this._createFBO())),void 0!==k&&(s.proxyCachedFBO[O.key]={},s.proxyCachedFBO[O.key][D.start]=k,s.renderCache[k].dirty=!0)}this._tilesDirty={}}_setupStencil(t,s,p,v){if(!v||!this._sourceTilesOverlap[v.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const b=this.painter.context,D=b.gl;if(s.length<=1)return void(this._overlapStencilType=!1);let O;if(p.isTileClipped())O=s.length,this._overlapStencilMode.test={func:D.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(s[0].overscaledZ>s[s.length-1].overscaledZ))return void(this._overlapStencilType=!1);O=1,this._overlapStencilMode.test={func:D.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+O>255&&(b.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=O,this._overlapStencilMode.ref=this._stencilRef,p.isTileClipped()&&this._renderTileClippingMasks(s,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return"Clip"===this._overlapStencilType||"Mask"===this._overlapStencilType}stencilModeForRTTOverlap(t){return this.renderingToTexture&&this._overlapStencilType?("Clip"===this._overlapStencilType&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[t.key]),this._overlapStencilMode):c.StencilMode.disabled}_renderTileClippingMasks(t,s){const p=this.painter,v=this.painter.context,b=v.gl;p._tileClippingMaskIDs={},v.setColorMode(c.ColorMode.disabled),v.setDepthMode(c.DepthMode.disabled);const D=p.useProgram("clippingMask");for(const O of t){const k=p._tileClippingMaskIDs[O.key]=--s;D.draw(v,b.TRIANGLES,c.DepthMode.disabled,new c.StencilMode({func:b.ALWAYS,mask:0},k,255,b.KEEP,b.KEEP,b.REPLACE),c.ColorMode.disabled,c.CullFaceMode.disabled,zr(O.projMatrix),"$clipping",p.tileExtentBuffer,p.quadTriangleIndexBuffer,p.tileExtentSegments)}}pointCoordinate(t){const s=this.painter.transform;if(t.x<0||t.x>s.width||t.y<0||t.y>s.height)return null;const p=[t.x,t.y,1,1];c.transformMat4$1(p,p,s.pixelMatrixInverse),c.scale$1(p,p,1/p[3]),p[0]/=s.worldSize,p[1]/=s.worldSize;const v=s._camera.position,b=c.mercatorZfromAltitude(1,s.center.lat),D=[v[0],v[1],v[2]/b,0],O=c.subtract([],p.slice(0,3),D);c.normalize(O,O);const k=this.raycast(D,O,this._exaggeration);return null!==k&&k?(c.scaleAndAdd(D,D,O,k),D[3]=D[2],D[2]*=b,D):null}drawDepth(){const t=this.painter,s=t.context,p=this.proxySourceCache,v=Math.ceil(t.width),b=Math.ceil(t.height);if(!this._depthFBO||this._depthFBO.width===v&&this._depthFBO.height===b||(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),!this._depthFBO){const D=s.gl,O=s.createFramebuffer(v,b,!0);s.activeTexture.set(D.TEXTURE0);const k=new c.Texture(s,{width:v,height:b,data:null},D.RGBA);k.bind(D.NEAREST,D.CLAMP_TO_EDGE),O.colorAttachment.set(k.texture);const H=s.createRenderbuffer(s.gl.DEPTH_COMPONENT16,v,b);O.depthAttachment.set(H),this._depthFBO=O,this._depthTexture=k}s.bindFramebuffer.set(this._depthFBO.framebuffer),s.viewport.set([0,0,v,b]),function(D,O,k,H){if("globe"===D.transform.projection.name)return;const J=D.context,ue=J.gl;J.clear({depth:1});const De=D.useProgram("terrainDepth"),je=new c.DepthMode(ue.LESS,c.DepthMode.ReadWrite,D.depthRangeFor3D);for(const ke of H){const Ye=k.getTile(ke),$e=Po(ke.projMatrix,0);O.setupElevationDraw(Ye,De),De.draw(J,ue.TRIANGLES,je,c.StencilMode.disabled,c.ColorMode.unblended,c.CullFaceMode.backCCW,$e,"terrain_depth",O.gridBuffer,O.gridIndexBuffer,O.gridNoSkirtSegments)}}(t,this,p,this.proxyCoords)}_setupProxiedCoordsForOrtho(t,s,p){if(t.getSource()instanceof st)return this._setupProxiedCoordsForImageSource(t,s,p);this._findCoveringTileCache[t.id]=this._findCoveringTileCache[t.id]||{};const v=this.proxiedCoords[t.id]=[],b=this.proxyCoords;for(let O=0;O<b.length;O++){const k=b[O],H=this._findTileCoveringTileID(k,t);if(H){const J=this._createProxiedId(k,H,p[k.key]&&p[k.key][t.id]);v.push(J),this.proxyToSource[k.key][t.id]=[J]}}let D=!1;for(let O=0;O<s.length;O++){const k=t.getTile(s[O]);if(!k||!k.hasData())continue;const H=this._findTileCoveringTileID(k.tileID,this.proxySourceCache);if(H&&H.tileID.canonical.z!==k.tileID.canonical.z){const J=this.proxyToSource[H.tileID.key][t.id],ue=this._createProxiedId(H.tileID,k,p[H.tileID.key]&&p[H.tileID.key][t.id]);J?J.splice(J.length-1,0,ue):this.proxyToSource[H.tileID.key][t.id]=[ue],v.push(ue),D=!0}}this._sourceTilesOverlap[t.id]=D}_setupProxiedCoordsForImageSource(t,s,p){if(!t.getSource().loaded())return;const v=this.proxiedCoords[t.id]=[],b=this.proxyCoords,D=t.getSource(),O=new c.pointGeometry(D.tileID.x,D.tileID.y)._div(1<<D.tileID.z),k=D.coordinates.map(c.MercatorCoordinate.fromLngLat).reduce((J,ue)=>(J.min.x=Math.min(J.min.x,ue.x-O.x),J.min.y=Math.min(J.min.y,ue.y-O.y),J.max.x=Math.max(J.max.x,ue.x-O.x),J.max.y=Math.max(J.max.y,ue.y-O.y),J),{min:new c.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE),max:new c.pointGeometry(-Number.MAX_VALUE,-Number.MAX_VALUE)}),H=(J,ue)=>{const De=J.wrap+J.canonical.x/(1<<J.canonical.z),je=J.canonical.y/(1<<J.canonical.z),ke=c.EXTENT/(1<<J.canonical.z),Ye=ue.wrap+ue.canonical.x/(1<<ue.canonical.z),$e=ue.canonical.y/(1<<ue.canonical.z);return De+ke<Ye+k.min.x||De>Ye+k.max.x||je+ke<$e+k.min.y||je>$e+k.max.y};for(let J=0;J<b.length;J++){const ue=b[J];for(let De=0;De<s.length;De++){const je=t.getTile(s[De]);if(!je||!je.hasData()||H(ue,je.tileID))continue;const ke=this._createProxiedId(ue,je,p[ue.key]&&p[ue.key][t.id]),Ye=this.proxyToSource[ue.key][t.id];Ye?Ye.push(ke):this.proxyToSource[ue.key][t.id]=[ke],v.push(ke)}}}_createProxiedId(t,s,p){let v=this.orthoMatrix;if(p){const b=p.find(D=>D.key===s.tileID.key);if(b)return b}if(s.tileID.key!==t.key){const b=t.canonical.z-s.tileID.canonical.z;let D,O,k;v=c.create();const H=s.tileID.wrap-t.wrap<<t.overscaledZ;b>0?(D=c.EXTENT>>b,O=D*((s.tileID.canonical.x<<b)-t.canonical.x+H),k=D*((s.tileID.canonical.y<<b)-t.canonical.y)):(D=c.EXTENT<<-b,O=c.EXTENT*(s.tileID.canonical.x-(t.canonical.x+H<<-b)),k=c.EXTENT*(s.tileID.canonical.y-(t.canonical.y<<-b))),c.ortho(v,0,D,0,D,0,1),c.translate(v,v,[O,k,0])}return new Yr(s.tileID,t.key,v)}_findTileCoveringTileID(t,s){let p=s.getTile(t);if(p&&p.hasData())return p;const v=this._findCoveringTileCache[s.id],b=v[t.key];if(p=b?s.getTileByID(b):null,p&&p.hasData()||null===b)return p;let D=p?p.tileID:t,O=D.overscaledZ;const k=s.getSource().minzoom,H=[];if(!b){const ue=s.getSource().maxzoom;if(t.canonical.z>=ue){const De=t.canonical.z-ue;s.getSource().reparseOverscaled?(O=Math.max(t.canonical.z+2,s.transform.tileZoom),D=new c.OverscaledTileID(O,t.wrap,ue,t.canonical.x>>De,t.canonical.y>>De)):0!==De&&(O=ue,D=new c.OverscaledTileID(O,t.wrap,ue,t.canonical.x>>De,t.canonical.y>>De))}D.key!==t.key&&(H.push(D.key),p=s.getTile(D))}const J=ue=>{H.forEach(De=>{v[De]=ue}),H.length=0};for(O-=1;O>=k&&(!p||!p.hasData());O--){p&&J(p.tileID.key);const ue=D.calculateScaledKey(O);if(p=s.getTileByID(ue),p&&p.hasData())break;const De=v[ue];if(null===De)break;void 0===De?H.push(ue):p=s.getTileByID(De)}return J(p?p.tileID.key:null),p&&p.hasData()?p:null}findDEMTileFor(t){return this.enabled?this._findTileCoveringTileID(t,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(t,s){let p=this._tilesDirty[t];p||(p=this._tilesDirty[t]={}),p[s.key]=!0}getWirefameBuffer(){if(!this.wireframeSegments){const t=function(s){let p=0;const v=new c.StructArrayLayout2ui4,b=131;for(let D=1;D<129;D++){for(let O=1;O<129;O++)p=D*b+O,v.emplaceBack(p,p+1),v.emplaceBack(p,p+b),v.emplaceBack(p+1,p+b),128===D&&v.emplaceBack(p+b,p+b+1);v.emplaceBack(p+1,p+1+b)}return v}();this.wireframeIndexBuffer=this.painter.context.createIndexBuffer(t),this.wireframeSegments=c.SegmentVector.simpleSegment(0,0,this.gridBuffer.length,t.length)}return[this.wireframeIndexBuffer,this.wireframeSegments]}}class Ca{static cacheKey(t,s,p,v){let b=`${s}${v?v.cacheKey:""}`;for(const D of p)t.usedDefines.includes(D)&&(b+=`/${D}`);return b}constructor(t,s,p,v,b,D){const O=t.gl;this.program=O.createProgram();const k=function($e){const Be=[];for(let Xe=0;Xe<$e.length;Xe++){if(null===$e[Xe])continue;const We=$e[Xe].split(" ");Be.push(We.pop())}return Be}(p.staticAttributes),H=v?v.getBinderAttributes():[],J=k.concat(H);let ue=v?v.defines():[];ue=ue.concat(D.map($e=>`#define ${$e}`));const De=ue.concat(t.extStandardDerivatives?"#extension GL_OES_standard_derivatives : enable\n".concat(ws):ws,ws,ts,Js.fragmentSource,aa.fragmentSource,p.fragmentSource).join("\n"),je=ue.concat("\n#ifdef GL_ES\nprecision highp float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif",ts,Js.vertexSource,aa.vertexSource,bs.vertexSource,p.vertexSource).join("\n"),ke=O.createShader(O.FRAGMENT_SHADER);if(O.isContextLost())return void(this.failedToCreate=!0);O.shaderSource(ke,De),O.compileShader(ke),O.attachShader(this.program,ke);const Ye=O.createShader(O.VERTEX_SHADER);if(O.isContextLost())this.failedToCreate=!0;else{O.shaderSource(Ye,je),O.compileShader(Ye),O.attachShader(this.program,Ye),this.attributes={},this.numAttributes=J.length;for(let $e=0;$e<this.numAttributes;$e++)J[$e]&&(O.bindAttribLocation(this.program,$e,J[$e]),this.attributes[J[$e]]=$e);O.linkProgram(this.program),O.deleteShader(Ye),O.deleteShader(ke),this.fixedUniforms=b(t),this.binderUniforms=v?v.getUniforms(t):[],D.includes("TERRAIN")&&(this.terrainUniforms={u_dem:new c.Uniform1i($e=t),u_dem_prev:new c.Uniform1i($e),u_dem_unpack:new c.Uniform4f($e),u_dem_tl:new c.Uniform2f($e),u_dem_scale:new c.Uniform1f($e),u_dem_tl_prev:new c.Uniform2f($e),u_dem_scale_prev:new c.Uniform1f($e),u_dem_size:new c.Uniform1f($e),u_dem_lerp:new c.Uniform1f($e),u_exaggeration:new c.Uniform1f($e),u_depth:new c.Uniform1i($e),u_depth_size_inv:new c.Uniform2f($e),u_meter_to_dem:new c.Uniform1f($e),u_label_plane_matrix_inv:new c.UniformMatrix4f($e)}),D.includes("GLOBE")&&(this.globeUniforms=($e=>({u_tile_tl_up:new c.Uniform3f($e),u_tile_tr_up:new c.Uniform3f($e),u_tile_br_up:new c.Uniform3f($e),u_tile_bl_up:new c.Uniform3f($e),u_tile_up_scale:new c.Uniform1f($e)}))(t)),D.includes("FOG")&&(this.fogUniforms=($e=>({u_fog_matrix:new c.UniformMatrix4f($e),u_fog_range:new c.Uniform2f($e),u_fog_color:new c.Uniform4f($e),u_fog_horizon_blend:new c.Uniform1f($e),u_fog_temporal_offset:new c.Uniform1f($e),u_frustum_tl:new c.Uniform3f($e),u_frustum_tr:new c.Uniform3f($e),u_frustum_br:new c.Uniform3f($e),u_frustum_bl:new c.Uniform3f($e),u_globe_pos:new c.Uniform3f($e),u_globe_radius:new c.Uniform1f($e),u_globe_transition:new c.Uniform1f($e),u_is_globe:new c.Uniform1i($e),u_viewport:new c.Uniform2f($e)}))(t))}var $e}setTerrainUniformValues(t,s){if(!this.terrainUniforms)return;const p=this.terrainUniforms;if(!this.failedToCreate){t.program.set(this.program);for(const v in s)p[v]&&p[v].set(this.program,v,s[v])}}setGlobeUniformValues(t,s){if(!this.globeUniforms)return;const p=this.globeUniforms;if(!this.failedToCreate){t.program.set(this.program);for(const v in s)p[v]&&p[v].set(this.program,v,s[v])}}setFogUniformValues(t,s){if(!this.fogUniforms)return;const p=this.fogUniforms;if(!this.failedToCreate){t.program.set(this.program);for(const v in s)p[v].set(this.program,v,s[v])}}draw(t,s,p,v,b,D,O,k,H,J,ue,De,je,ke,Ye){const $e=t.gl;if(this.failedToCreate)return;t.program.set(this.program),t.setDepthMode(p),t.setStencilMode(v),t.setColorMode(b),t.setCullFace(D);for(const Xe of Object.keys(this.fixedUniforms))this.fixedUniforms[Xe].set(this.program,Xe,O[Xe]);ke&&ke.setUniforms(this.program,t,this.binderUniforms,De,{zoom:je});const Be={[$e.LINES]:2,[$e.TRIANGLES]:3,[$e.LINE_STRIP]:1}[s];for(const Xe of ue.get()){const We=Xe.vaos||(Xe.vaos={});(We[k]||(We[k]=new Us)).bind(t,this,H,ke?ke.getPaintVertexBuffers():[],J,Xe.vertexOffset,Ye||[]),$e.drawElements(s,Xe.primitiveLength*Be,$e.UNSIGNED_SHORT,Xe.primitiveOffset*Be*2)}}}function Ta(l,t,s){const p=1/Pt(s,1,t.transform.tileZoom),v=Math.pow(2,s.tileID.overscaledZ),b=s.tileSize*Math.pow(2,t.transform.tileZoom)/v,D=b*(s.tileID.canonical.x+s.tileID.wrap*v),O=b*s.tileID.canonical.y;return{u_image:0,u_texsize:s.imageAtlasTexture.size,u_scale:[p,l.fromScale,l.toScale],u_fade:l.t,u_pixel_coord_upper:[D>>16,O>>16],u_pixel_coord_lower:[65535&D,65535&O]}}const ee=c.create(),X=(l,t,s,p,v,b,D,O,k,H,J)=>{const ue=t.style.light,De=ue.properties.get("position"),je=[De.x,De.y,De.z],ke=c.create$1();"viewport"===ue.properties.get("anchor")&&(c.fromRotation(ke,-t.transform.angle),c.transformMat3(je,je,ke));const Ye=ue.properties.get("color"),$e=t.transform,Be={u_matrix:l,u_lightpos:je,u_lightintensity:ue.properties.get("intensity"),u_lightcolor:[Ye.r,Ye.g,Ye.b],u_vertical_gradient:+s,u_opacity:p,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:ee,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_ao:v,u_edge_radius:b};return"globe"===$e.projection.name&&(Be.u_tile_id=[D.canonical.x,D.canonical.y,1<<D.canonical.z],Be.u_zoom_transition=k,Be.u_inv_rot_matrix=J,Be.u_merc_center=H,Be.u_up_dir=$e.projection.upVector(new c.CanonicalTileID(0,0,0),H[0]*c.EXTENT,H[1]*c.EXTENT),Be.u_height_lift=O),Be},q=(l,t,s,p,v,b,D,O,k,H,J,ue,De)=>{const je=X(l,t,s,p,v,b,D,H,J,ue,De),ke={u_height_factor:-Math.pow(2,D.overscaledZ)/k.tileSize/8};return c.extend(je,Ta(O,t,k),ke)},Te=l=>({u_matrix:l}),dn=(l,t,s,p)=>c.extend(Te(l),Ta(s,t,p)),ti=(l,t)=>({u_matrix:l,u_world:t}),Nr=(l,t,s,p,v)=>c.extend(dn(l,t,s,p),{u_world:v}),lo=c.create(),Vo=(l,t,s,p,v,b)=>{const D=l.transform,O="globe"===D.projection.name;let k;if("map"===b.paint.get("circle-pitch-alignment"))if(O){const J=c.globePixelsToTileUnits(D.zoom,t.canonical)*D._pixelsPerMercatorPixel;k=Float32Array.from([J,0,0,J])}else k=D.calculatePixelsToTileUnitsMatrix(s);else k=new Float32Array([D.pixelsToGLUnits[0],0,0,D.pixelsToGLUnits[1]]);const H={u_camera_to_center_distance:D.cameraToCenterDistance,u_matrix:l.translatePosMatrix(t.projMatrix,s,b.paint.get("circle-translate"),b.paint.get("circle-translate-anchor")),u_device_pixel_ratio:c.exported.devicePixelRatio,u_extrude_scale:k,u_inv_rot_matrix:lo,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(O){H.u_inv_rot_matrix=p,H.u_merc_center=v,H.u_tile_id=[t.canonical.x,t.canonical.y,1<<t.canonical.z],H.u_zoom_transition=c.globeToMercatorTransition(D.zoom);const J=v[0]*c.EXTENT,ue=v[1]*c.EXTENT;H.u_up_dir=D.projection.upVector(new c.CanonicalTileID(0,0,0),J,ue)}return H},la=l=>{const t=[];return"map"===l.paint.get("circle-pitch-alignment")&&t.push("PITCH_WITH_MAP"),"map"===l.paint.get("circle-pitch-scale")&&t.push("SCALE_WITH_MAP"),t},El=(l,t,s,p)=>{const v=c.EXTENT/s.tileSize;return{u_matrix:l,u_camera_to_center_distance:t.getCameraToCenterDistance(p),u_extrude_scale:[t.pixelsToGLUnits[0]/v,t.pixelsToGLUnits[1]/v]}},Dl=(l,t,s=1)=>({u_matrix:l,u_color:t,u_overlay:0,u_overlay_scale:s}),Dn=c.create(),Ji=(l,t,s,p,v,b,D)=>{const O=l.transform,k="globe"===O.projection.name,H=k?c.globePixelsToTileUnits(O.zoom,t.canonical)*O._pixelsPerMercatorPixel:Pt(s,1,b),J={u_matrix:t.projMatrix,u_extrude_scale:H,u_intensity:D,u_inv_rot_matrix:Dn,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(k){J.u_inv_rot_matrix=p,J.u_merc_center=v,J.u_tile_id=[t.canonical.x,t.canonical.y,1<<t.canonical.z],J.u_zoom_transition=c.globeToMercatorTransition(O.zoom);const ue=v[0]*c.EXTENT,De=v[1]*c.EXTENT;J.u_up_dir=O.projection.upVector(new c.CanonicalTileID(0,0,0),ue,De)}return J},Il=(l,t,s,p,v,b,D,O)=>{const k=l.transform,H=k.calculatePixelsToTileUnitsMatrix(t),J={u_matrix:ca(l,t,s,v),u_pixels_to_tile_units:H,u_device_pixel_ratio:D,u_units_to_pixels:[1/k.pixelsToGLUnits[0],1/k.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:b,u_texsize:[0,0],u_scale:[0,0,0],u_mix:0,u_alpha_discard_threshold:0,u_trim_offset:O};if(js(s)){const ue=ro(t,l.transform);J.u_texsize=t.lineAtlasTexture.size,J.u_scale=[ue,p.fromScale,p.toScale],J.u_mix=p.t}return J},Ml=(l,t,s,p,v,b)=>{const D=l.transform,O=ro(t,D);return{u_matrix:ca(l,t,s,v),u_texsize:t.imageAtlasTexture.size,u_pixels_to_tile_units:D.calculatePixelsToTileUnitsMatrix(t),u_device_pixel_ratio:b,u_image:0,u_scale:[O,p.fromScale,p.toScale],u_fade:p.t,u_units_to_pixels:[1/D.pixelsToGLUnits[0],1/D.pixelsToGLUnits[1]],u_alpha_discard_threshold:0}};function ro(l,t){return 1/Pt(l,1,t.tileZoom)}function ca(l,t,s,p){return l.translatePosMatrix(p||t.tileID.projMatrix,t,s.paint.get("line-translate"),s.paint.get("line-translate-anchor"))}function js(l){const t=l.paint.get("line-dasharray").value;return t.value||"constant"!==t.kind}const co=(l,t,s,p,v,b)=>{return{u_matrix:l,u_tl_parent:t,u_scale_parent:s,u_fade_t:p.mix,u_opacity:p.opacity*v.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:v.paint.get("raster-brightness-min"),u_brightness_high:v.paint.get("raster-brightness-max"),u_saturation_factor:(O=v.paint.get("raster-saturation"),O>0?1-1/(1.001-O):-O),u_contrast_factor:(D=v.paint.get("raster-contrast"),D>0?1/(1-D):1+D),u_spin_weights:Xs(v.paint.get("raster-hue-rotate")),u_perspective_transform:b};var D,O};function Xs(l){l*=Math.PI/180;const t=Math.sin(l),s=Math.cos(l);return[(2*s+1)/3,(-Math.sqrt(3)*t-s+1)/3,(Math.sqrt(3)*t-s+1)/3]}const ua=c.create(),Tc=(l,t,s,p,v,b,D,O,k,H,J,ue,De,je,ke,Ye)=>{const $e=v.transform,Be={u_is_size_zoom_constant:+("constant"===l||"source"===l),u_is_size_feature_constant:+("constant"===l||"camera"===l),u_size_t:t?t.uSizeT:0,u_size:t?t.uSize:0,u_camera_to_center_distance:$e.cameraToCenterDistance,u_rotate_symbol:+s,u_aspect_ratio:$e.width/$e.height,u_fade_change:v.options.fadeDuration?v.symbolFadeChange:1,u_matrix:b,u_label_plane_matrix:D,u_coord_matrix:O,u_is_text:+k,u_pitch_with_map:+p,u_texsize:H,u_texture:0,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:ua,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:ua,u_up_vector:[0,-1,0]};return"globe"===Ye.name&&(Be.u_tile_id=[J.canonical.x,J.canonical.y,1<<J.canonical.z],Be.u_zoom_transition=ue,Be.u_inv_rot_matrix=je,Be.u_merc_center=De,Be.u_camera_forward=$e._camera.forward(),Be.u_ecef_origin=c.globeECEFOrigin($e.globeMatrix,J.toUnwrapped()),Be.u_tile_matrix=Float32Array.from($e.globeMatrix),Be.u_up_vector=ke),Be},rl=(l,t,s,p,v,b,D,O,k,H,J,ue,De,je,ke,Ye,$e)=>c.extend(Tc(l,t,s,p,v,b,D,O,k,H,ue,De,je,ke,Ye,$e),{u_gamma_scale:p?v.transform.cameraToCenterDistance*Math.cos(v.terrain?0:v.transform._pitch):1,u_device_pixel_ratio:c.exported.devicePixelRatio,u_is_halo:+J}),ol=(l,t,s,p,v,b,D,O,k,H,J,ue,De,je,ke,Ye)=>c.extend(rl(l,t,s,p,v,b,D,O,!0,k,!0,J,ue,De,je,ke,Ye),{u_texsize_icon:H,u_texture_icon:1}),E=(l,t,s)=>({u_matrix:l,u_opacity:t,u_color:s}),Z=(l,t,s,p,v,b)=>c.extend(function(D,O,k,H){const J=k.imageManager.getPattern(D.from.toString()),ue=k.imageManager.getPattern(D.to.toString()),{width:De,height:je}=k.imageManager.getPixelSize(),ke=Math.pow(2,H.tileID.overscaledZ),Ye=H.tileSize*Math.pow(2,k.transform.tileZoom)/ke,$e=Ye*(H.tileID.canonical.x+H.tileID.wrap*ke),Be=Ye*H.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:J.tl,u_pattern_br_a:J.br,u_pattern_tl_b:ue.tl,u_pattern_br_b:ue.br,u_texsize:[De,je],u_mix:O.t,u_pattern_size_a:J.displaySize,u_pattern_size_b:ue.displaySize,u_scale_a:O.fromScale,u_scale_b:O.toScale,u_tile_units_to_pixels:1/Pt(H,1,k.transform.tileZoom),u_pixel_coord_upper:[$e>>16,Be>>16],u_pixel_coord_lower:[65535&$e,65535&Be]}}(p,b,s,v),{u_matrix:l,u_opacity:t}),I={fillExtrusion:l=>({u_matrix:new c.UniformMatrix4f(l),u_lightpos:new c.Uniform3f(l),u_lightintensity:new c.Uniform1f(l),u_lightcolor:new c.Uniform3f(l),u_vertical_gradient:new c.Uniform1f(l),u_opacity:new c.Uniform1f(l),u_edge_radius:new c.Uniform1f(l),u_ao:new c.Uniform2f(l),u_tile_id:new c.Uniform3f(l),u_zoom_transition:new c.Uniform1f(l),u_inv_rot_matrix:new c.UniformMatrix4f(l),u_merc_center:new c.Uniform2f(l),u_up_dir:new c.Uniform3f(l),u_height_lift:new c.Uniform1f(l)}),fillExtrusionPattern:l=>({u_matrix:new c.UniformMatrix4f(l),u_lightpos:new c.Uniform3f(l),u_lightintensity:new c.Uniform1f(l),u_lightcolor:new c.Uniform3f(l),u_vertical_gradient:new c.Uniform1f(l),u_height_factor:new c.Uniform1f(l),u_edge_radius:new c.Uniform1f(l),u_ao:new c.Uniform2f(l),u_tile_id:new c.Uniform3f(l),u_zoom_transition:new c.Uniform1f(l),u_inv_rot_matrix:new c.UniformMatrix4f(l),u_merc_center:new c.Uniform2f(l),u_up_dir:new c.Uniform3f(l),u_height_lift:new c.Uniform1f(l),u_image:new c.Uniform1i(l),u_texsize:new c.Uniform2f(l),u_pixel_coord_upper:new c.Uniform2f(l),u_pixel_coord_lower:new c.Uniform2f(l),u_scale:new c.Uniform3f(l),u_fade:new c.Uniform1f(l),u_opacity:new c.Uniform1f(l)}),fill:l=>({u_matrix:new c.UniformMatrix4f(l)}),fillPattern:l=>({u_matrix:new c.UniformMatrix4f(l),u_image:new c.Uniform1i(l),u_texsize:new c.Uniform2f(l),u_pixel_coord_upper:new c.Uniform2f(l),u_pixel_coord_lower:new c.Uniform2f(l),u_scale:new c.Uniform3f(l),u_fade:new c.Uniform1f(l)}),fillOutline:l=>({u_matrix:new c.UniformMatrix4f(l),u_world:new c.Uniform2f(l)}),fillOutlinePattern:l=>({u_matrix:new c.UniformMatrix4f(l),u_world:new c.Uniform2f(l),u_image:new c.Uniform1i(l),u_texsize:new c.Uniform2f(l),u_pixel_coord_upper:new c.Uniform2f(l),u_pixel_coord_lower:new c.Uniform2f(l),u_scale:new c.Uniform3f(l),u_fade:new c.Uniform1f(l)}),circle:l=>({u_camera_to_center_distance:new c.Uniform1f(l),u_extrude_scale:new c.UniformMatrix2f(l),u_device_pixel_ratio:new c.Uniform1f(l),u_matrix:new c.UniformMatrix4f(l),u_inv_rot_matrix:new c.UniformMatrix4f(l),u_merc_center:new c.Uniform2f(l),u_tile_id:new c.Uniform3f(l),u_zoom_transition:new c.Uniform1f(l),u_up_dir:new c.Uniform3f(l)}),collisionBox:l=>({u_matrix:new c.UniformMatrix4f(l),u_camera_to_center_distance:new c.Uniform1f(l),u_extrude_scale:new c.Uniform2f(l)}),collisionCircle:l=>({u_matrix:new c.UniformMatrix4f(l),u_inv_matrix:new c.UniformMatrix4f(l),u_camera_to_center_distance:new c.Uniform1f(l),u_viewport_size:new c.Uniform2f(l)}),debug:l=>({u_color:new c.UniformColor(l),u_matrix:new c.UniformMatrix4f(l),u_overlay:new c.Uniform1i(l),u_overlay_scale:new c.Uniform1f(l)}),clippingMask:l=>({u_matrix:new c.UniformMatrix4f(l)}),heatmap:l=>({u_extrude_scale:new c.Uniform1f(l),u_intensity:new c.Uniform1f(l),u_matrix:new c.UniformMatrix4f(l),u_inv_rot_matrix:new c.UniformMatrix4f(l),u_merc_center:new c.Uniform2f(l),u_tile_id:new c.Uniform3f(l),u_zoom_transition:new c.Uniform1f(l),u_up_dir:new c.Uniform3f(l)}),heatmapTexture:l=>({u_image:new c.Uniform1i(l),u_color_ramp:new c.Uniform1i(l),u_opacity:new c.Uniform1f(l)}),hillshade:l=>({u_matrix:new c.UniformMatrix4f(l),u_image:new c.Uniform1i(l),u_latrange:new c.Uniform2f(l),u_light:new c.Uniform2f(l),u_shadow:new c.UniformColor(l),u_highlight:new c.UniformColor(l),u_accent:new c.UniformColor(l)}),hillshadePrepare:l=>({u_matrix:new c.UniformMatrix4f(l),u_image:new c.Uniform1i(l),u_dimension:new c.Uniform2f(l),u_zoom:new c.Uniform1f(l),u_unpack:new c.Uniform4f(l)}),line:l=>({u_matrix:new c.UniformMatrix4f(l),u_pixels_to_tile_units:new c.UniformMatrix2f(l),u_device_pixel_ratio:new c.Uniform1f(l),u_units_to_pixels:new c.Uniform2f(l),u_dash_image:new c.Uniform1i(l),u_gradient_image:new c.Uniform1i(l),u_image_height:new c.Uniform1f(l),u_texsize:new c.Uniform2f(l),u_scale:new c.Uniform3f(l),u_mix:new c.Uniform1f(l),u_alpha_discard_threshold:new c.Uniform1f(l),u_trim_offset:new c.Uniform2f(l)}),linePattern:l=>({u_matrix:new c.UniformMatrix4f(l),u_texsize:new c.Uniform2f(l),u_pixels_to_tile_units:new c.UniformMatrix2f(l),u_device_pixel_ratio:new c.Uniform1f(l),u_image:new c.Uniform1i(l),u_units_to_pixels:new c.Uniform2f(l),u_scale:new c.Uniform3f(l),u_fade:new c.Uniform1f(l),u_alpha_discard_threshold:new c.Uniform1f(l)}),raster:l=>({u_matrix:new c.UniformMatrix4f(l),u_tl_parent:new c.Uniform2f(l),u_scale_parent:new c.Uniform1f(l),u_fade_t:new c.Uniform1f(l),u_opacity:new c.Uniform1f(l),u_image0:new c.Uniform1i(l),u_image1:new c.Uniform1i(l),u_brightness_low:new c.Uniform1f(l),u_brightness_high:new c.Uniform1f(l),u_saturation_factor:new c.Uniform1f(l),u_contrast_factor:new c.Uniform1f(l),u_spin_weights:new c.Uniform3f(l),u_perspective_transform:new c.Uniform2f(l)}),symbolIcon:l=>({u_is_size_zoom_constant:new c.Uniform1i(l),u_is_size_feature_constant:new c.Uniform1i(l),u_size_t:new c.Uniform1f(l),u_size:new c.Uniform1f(l),u_camera_to_center_distance:new c.Uniform1f(l),u_rotate_symbol:new c.Uniform1i(l),u_aspect_ratio:new c.Uniform1f(l),u_fade_change:new c.Uniform1f(l),u_matrix:new c.UniformMatrix4f(l),u_label_plane_matrix:new c.UniformMatrix4f(l),u_coord_matrix:new c.UniformMatrix4f(l),u_is_text:new c.Uniform1i(l),u_pitch_with_map:new c.Uniform1i(l),u_texsize:new c.Uniform2f(l),u_tile_id:new c.Uniform3f(l),u_zoom_transition:new c.Uniform1f(l),u_inv_rot_matrix:new c.UniformMatrix4f(l),u_merc_center:new c.Uniform2f(l),u_camera_forward:new c.Uniform3f(l),u_tile_matrix:new c.UniformMatrix4f(l),u_up_vector:new c.Uniform3f(l),u_ecef_origin:new c.Uniform3f(l),u_texture:new c.Uniform1i(l)}),symbolSDF:l=>({u_is_size_zoom_constant:new c.Uniform1i(l),u_is_size_feature_constant:new c.Uniform1i(l),u_size_t:new c.Uniform1f(l),u_size:new c.Uniform1f(l),u_camera_to_center_distance:new c.Uniform1f(l),u_rotate_symbol:new c.Uniform1i(l),u_aspect_ratio:new c.Uniform1f(l),u_fade_change:new c.Uniform1f(l),u_matrix:new c.UniformMatrix4f(l),u_label_plane_matrix:new c.UniformMatrix4f(l),u_coord_matrix:new c.UniformMatrix4f(l),u_is_text:new c.Uniform1i(l),u_pitch_with_map:new c.Uniform1i(l),u_texsize:new c.Uniform2f(l),u_texture:new c.Uniform1i(l),u_gamma_scale:new c.Uniform1f(l),u_device_pixel_ratio:new c.Uniform1f(l),u_tile_id:new c.Uniform3f(l),u_zoom_transition:new c.Uniform1f(l),u_inv_rot_matrix:new c.UniformMatrix4f(l),u_merc_center:new c.Uniform2f(l),u_camera_forward:new c.Uniform3f(l),u_tile_matrix:new c.UniformMatrix4f(l),u_up_vector:new c.Uniform3f(l),u_ecef_origin:new c.Uniform3f(l),u_is_halo:new c.Uniform1i(l)}),symbolTextAndIcon:l=>({u_is_size_zoom_constant:new c.Uniform1i(l),u_is_size_feature_constant:new c.Uniform1i(l),u_size_t:new c.Uniform1f(l),u_size:new c.Uniform1f(l),u_camera_to_center_distance:new c.Uniform1f(l),u_rotate_symbol:new c.Uniform1i(l),u_aspect_ratio:new c.Uniform1f(l),u_fade_change:new c.Uniform1f(l),u_matrix:new c.UniformMatrix4f(l),u_label_plane_matrix:new c.UniformMatrix4f(l),u_coord_matrix:new c.UniformMatrix4f(l),u_is_text:new c.Uniform1i(l),u_pitch_with_map:new c.Uniform1i(l),u_texsize:new c.Uniform2f(l),u_texsize_icon:new c.Uniform2f(l),u_texture:new c.Uniform1i(l),u_texture_icon:new c.Uniform1i(l),u_gamma_scale:new c.Uniform1f(l),u_device_pixel_ratio:new c.Uniform1f(l),u_is_halo:new c.Uniform1i(l)}),background:l=>({u_matrix:new c.UniformMatrix4f(l),u_opacity:new c.Uniform1f(l),u_color:new c.UniformColor(l)}),backgroundPattern:l=>({u_matrix:new c.UniformMatrix4f(l),u_opacity:new c.Uniform1f(l),u_image:new c.Uniform1i(l),u_pattern_tl_a:new c.Uniform2f(l),u_pattern_br_a:new c.Uniform2f(l),u_pattern_tl_b:new c.Uniform2f(l),u_pattern_br_b:new c.Uniform2f(l),u_texsize:new c.Uniform2f(l),u_mix:new c.Uniform1f(l),u_pattern_size_a:new c.Uniform2f(l),u_pattern_size_b:new c.Uniform2f(l),u_scale_a:new c.Uniform1f(l),u_scale_b:new c.Uniform1f(l),u_pixel_coord_upper:new c.Uniform2f(l),u_pixel_coord_lower:new c.Uniform2f(l),u_tile_units_to_pixels:new c.Uniform1f(l)}),terrainRaster:hs,terrainDepth:hs,skybox:l=>({u_matrix:new c.UniformMatrix4f(l),u_sun_direction:new c.Uniform3f(l),u_cubemap:new c.Uniform1i(l),u_opacity:new c.Uniform1f(l),u_temporal_offset:new c.Uniform1f(l)}),skyboxGradient:l=>({u_matrix:new c.UniformMatrix4f(l),u_color_ramp:new c.Uniform1i(l),u_center_direction:new c.Uniform3f(l),u_radius:new c.Uniform1f(l),u_opacity:new c.Uniform1f(l),u_temporal_offset:new c.Uniform1f(l)}),skyboxCapture:l=>({u_matrix_3f:new c.UniformMatrix3f(l),u_sun_direction:new c.Uniform3f(l),u_sun_intensity:new c.Uniform1f(l),u_color_tint_r:new c.Uniform4f(l),u_color_tint_m:new c.Uniform4f(l),u_luminance:new c.Uniform1f(l)}),globeRaster:l=>({u_proj_matrix:new c.UniformMatrix4f(l),u_globe_matrix:new c.UniformMatrix4f(l),u_normalize_matrix:new c.UniformMatrix4f(l),u_merc_matrix:new c.UniformMatrix4f(l),u_zoom_transition:new c.Uniform1f(l),u_merc_center:new c.Uniform2f(l),u_image0:new c.Uniform1i(l),u_grid_matrix:new c.UniformMatrix3f(l),u_frustum_tl:new c.Uniform3f(l),u_frustum_tr:new c.Uniform3f(l),u_frustum_br:new c.Uniform3f(l),u_frustum_bl:new c.Uniform3f(l),u_globe_pos:new c.Uniform3f(l),u_globe_radius:new c.Uniform1f(l),u_viewport:new c.Uniform2f(l)}),globeAtmosphere:l=>({u_frustum_tl:new c.Uniform3f(l),u_frustum_tr:new c.Uniform3f(l),u_frustum_br:new c.Uniform3f(l),u_frustum_bl:new c.Uniform3f(l),u_horizon:new c.Uniform1f(l),u_transition:new c.Uniform1f(l),u_fadeout_range:new c.Uniform1f(l),u_color:new c.Uniform4f(l),u_high_color:new c.Uniform4f(l),u_space_color:new c.Uniform4f(l),u_star_intensity:new c.Uniform1f(l),u_star_density:new c.Uniform1f(l),u_star_size:new c.Uniform1f(l),u_temporal_offset:new c.Uniform1f(l),u_horizon_angle:new c.Uniform1f(l),u_rotation_matrix:new c.UniformMatrix4f(l)})};let $;function ve(l,t,s,p,v,b,D){const O=l.context,k=O.gl,H=l.transform,J=l.useProgram("collisionBox"),ue=[];let De=0,je=0;for(let gt=0;gt<p.length;gt++){const yt=p[gt],ot=t.getTile(yt),It=ot.getBucket(s);if(!It)continue;const Jt=qi(yt,It,H);let cn=Jt;0===v[0]&&0===v[1]||(cn=l.translatePosMatrix(Jt,ot,v,b));const Xt=D?It.textCollisionBox:It.iconCollisionBox,An=It.collisionCircleArray;if(An.length>0){const Zt=c.create(),bn=cn;c.mul(Zt,It.placementInvProjMatrix,H.glCoordMatrix),c.mul(Zt,Zt,It.placementViewportMatrix),ue.push({circleArray:An,circleOffset:je,transform:bn,invTransform:Zt,projection:It.getProjection()}),De+=An.length/4,je=De}Xt&&(l.terrain&&l.terrain.setupElevationDraw(ot,J),J.draw(O,k.LINES,c.DepthMode.disabled,c.StencilMode.disabled,l.colorModeForRenderPass(),c.CullFaceMode.disabled,El(cn,H,ot,It.getProjection()),s.id,Xt.layoutVertexBuffer,Xt.indexBuffer,Xt.segments,null,H.zoom,null,[Xt.collisionVertexBuffer,Xt.collisionVertexBufferExt]))}if(!D||!ue.length)return;const ke=l.useProgram("collisionCircle"),Ye=new c.StructArrayLayout2f1f2i16;Ye.resize(4*De),Ye._trim();let $e=0;for(const gt of ue)for(let yt=0;yt<gt.circleArray.length/4;yt++){const ot=4*yt,It=gt.circleArray[ot+0],Jt=gt.circleArray[ot+1],cn=gt.circleArray[ot+2],Xt=gt.circleArray[ot+3];Ye.emplace($e++,It,Jt,cn,Xt,0),Ye.emplace($e++,It,Jt,cn,Xt,1),Ye.emplace($e++,It,Jt,cn,Xt,2),Ye.emplace($e++,It,Jt,cn,Xt,3)}(!$||$.length<2*De)&&($=function(gt){const yt=2*gt,ot=new c.StructArrayLayout3ui6;ot.resize(yt),ot._trim();for(let It=0;It<yt;It++){const Jt=6*It;ot.uint16[Jt+0]=4*It+0,ot.uint16[Jt+1]=4*It+1,ot.uint16[Jt+2]=4*It+2,ot.uint16[Jt+3]=4*It+2,ot.uint16[Jt+4]=4*It+3,ot.uint16[Jt+5]=4*It+0}return ot}(De));const Be=O.createIndexBuffer($,!0),Xe=O.createVertexBuffer(Ye,c.collisionCircleLayout.members,!0);for(const gt of ue){const yt={u_matrix:gt.transform,u_inv_matrix:gt.invTransform,u_camera_to_center_distance:(We=H).getCameraToCenterDistance(gt.projection),u_viewport_size:[We.width,We.height]};ke.draw(O,k.TRIANGLES,c.DepthMode.disabled,c.StencilMode.disabled,l.colorModeForRenderPass(),c.CullFaceMode.disabled,yt,s.id,Xe,Be,c.SegmentVector.simpleSegment(0,2*gt.circleOffset,gt.circleArray.length,gt.circleArray.length/2),null,H.zoom)}var We;Xe.destroy(),Be.destroy()}const St=c.create();function Cn(l,t,s,p,v,b){const{horizontalAlign:D,verticalAlign:O}=c.getAnchorAlignment(l),k=-(D-.5)*t,H=-(O-.5)*s,J=c.evaluateVariableOffset(l,p);return new c.pointGeometry((k/v+J[0])*b,(H/v+J[1])*b)}function Zn(l,t,s,p,v,b,D,O,k,H,J){const ue=l.text.placedSymbolArray,De=l.text.dynamicLayoutVertexArray,je=l.icon.dynamicLayoutVertexArray,ke={},Ye=ki(O,l.getProjection(),b),$e=b.elevation,Be=l.getProjection().upVectorScale(O.canonical,b.center.lat,b.worldSize);De.clear();for(let Xe=0;Xe<ue.length;Xe++){const We=ue.get(Xe),gt=l.allowVerticalPlacement&&!We.placedOrientation,yt=We.hidden||!We.crossTileID||gt?null:p[We.crossTileID];if(yt){const ot=new c.pointGeometry(We.tileAnchorX,We.tileAnchorY),It=l.getProjection().upVector(O.canonical,ot.x,ot.y),Jt=$e?$e.getAtTileOffset(O,ot.x,ot.y):0,cn=hi([We.projectedAnchorX+Jt*It[0]*Be.metersToTile,We.projectedAnchorY+Jt*It[1]*Be.metersToTile,We.projectedAnchorZ+Jt*It[2]*Be.metersToTile],s?Ye:D),Xt=ri(b.getCameraToCenterDistance(l.getProjection()),cn.signedDistanceFromCamera);let An=v.evaluateSizeForFeature(l.textSizeData,H,We)*Xt/c.ONE_EM;s&&(An*=l.tilePixelRatio/k);const{width:Zt,height:bn,anchor:yn,textOffset:Kt,textScale:Nt}=yt,qn=Cn(yn,Zt,bn,Kt,Nt,An);let zn;if(s){const Bn=ot.add(qn),{x:si,y:Di,z:yi}=l.getProjection().projectTilePoint(Bn.x,Bn.y,O.canonical);zn=hi([si+Jt*It[0]*Be.metersToTile,Di+Jt*It[1]*Be.metersToTile,yi+Jt*It[2]*Be.metersToTile],D).point}else{const Bn=t?qn.rotate(-b.angle):qn;zn=[cn.point[0]+Bn.x,cn.point[1]+Bn.y,0]}const jn=l.allowVerticalPlacement&&We.placedOrientation===c.WritingMode.vertical?Math.PI/2:0;for(let Bn=0;Bn<We.numGlyphs;Bn++)c.addDynamicAttributes(De,zn[0],zn[1],zn[2],jn);J&&We.associatedIconIndex>=0&&(ke[We.associatedIconIndex]={shiftedAnchor:zn,angle:jn})}else hn(We.numGlyphs,De)}if(J){je.clear();const Xe=l.icon.placedSymbolArray;for(let We=0;We<Xe.length;We++){const gt=Xe.get(We);if(gt.hidden)hn(gt.numGlyphs,je);else{const yt=ke[We];if(yt)for(let ot=0;ot<gt.numGlyphs;ot++)c.addDynamicAttributes(je,yt.shiftedAnchor[0],yt.shiftedAnchor[1],yt.shiftedAnchor[2],yt.angle);else hn(gt.numGlyphs,je)}}l.icon.dynamicLayoutVertexBuffer.updateData(je)}l.text.dynamicLayoutVertexBuffer.updateData(De)}function Ei(l,t,s){return s.iconsInText&&t?"symbolTextAndIcon":l?"symbolSDF":"symbolIcon"}function ii(l,t,s,p,v,b,D,O,k,H,J,ue){const De=l.context,je=De.gl,ke=l.transform,Ye="map"===O,$e="map"===k,Be=Ye&&"point"!==s.layout.get("symbol-placement"),Xe=Ye&&!$e&&!Be,We=void 0!==s.layout.get("symbol-sort-key").constantOr(1);let gt=!1;const yt=l.depthModeForSublayer(0,c.DepthMode.ReadOnly),ot=[c.mercatorXfromLng(ke.center.lng),c.mercatorYfromLat(ke.center.lat)],It=s.layout.get("text-variable-anchor"),Jt="globe"===ke.projection.name,cn=[],Xt=[0,-1,0];let An=Xt;!Jt&&!ke.mercatorFromTransition||Ye||(An=function(Zt){const bn=Zt._camera.getWorldToCamera(Zt.worldSize,1),yn=c.multiply([],bn,Zt.globeMatrix);c.invert(yn,yn);const Kt=[0,0,0],Nt=[0,1,0,0];return c.transformMat4$1(Nt,Nt,yn),Kt[0]=Nt[0],Kt[1]=Nt[1],Kt[2]=Nt[2],c.normalize(Kt,Kt),Kt}(ke));for(const Zt of p){const bn=t.getTile(Zt),yn=bn.getBucket(s);if(!yn||"mercator"===yn.projection.name&&Jt)continue;const Kt=v?yn.text:yn.icon;if(!Kt||yn.fullyClipped||!Kt.segments.get().length)continue;const Nt=Kt.programConfigurations.get(s.id),qn=v||yn.sdfIcons,zn=v?yn.textSizeData:yn.iconSizeData,jn=$e||0!==ke.pitch,Bn=c.evaluateSizeForZoom(zn,ke.zoom);let si,Di,yi,pi,Nn=[0,0],Ri=null;if(v){if(Di=bn.glyphAtlasTexture,yi=je.LINEAR,si=bn.glyphAtlasTexture.size,yn.iconsInText){Nn=bn.imageAtlasTexture.size,Ri=bn.imageAtlasTexture;const rs="composite"===zn.kind||"camera"===zn.kind;pi=jn||l.options.rotating||l.options.zooming||rs?je.LINEAR:je.NEAREST}}else{const rs=1!==s.layout.get("icon-size").constantOr(0)||yn.iconsNeedLinear;Di=bn.imageAtlasTexture,yi=qn||l.options.rotating||l.options.zooming||rs||jn?je.LINEAR:je.NEAREST,si=bn.imageAtlasTexture.size}const $i="globe"===yn.projection.name,Lr=$i?An:Xt,Ir=$i?c.globeToMercatorTransition(ke.zoom):0,Ar=ki(Zt,yn.getProjection(),ke),qo=ke.calculatePixelsToTileUnitsMatrix(bn),is=Oi(Ar,bn.tileID.canonical,$e,Ye,ke,yn.getProjection(),qo),cl=l.terrain&&$e&&Be?c.invert(c.create(),is):St,Jr=cr(Ar,bn.tileID.canonical,$e,Ye,ke,yn.getProjection(),qo),fo=It&&yn.hasTextData(),Mr="none"!==s.layout.get("icon-text-fit")&&fo&&yn.hasIconData();if(Be){const rs=ke.elevation,Wa=rs?rs.getAtTileOffsetFunc(Zt,ke.center.lat,ke.worldSize,yn.getProjection()):Qs=>[0,0,0],ul=lr(Ar,bn.tileID.canonical,$e,Ye,ke,yn.getProjection(),qo);xe(yn,Ar,l,v,ul,Jr,$e,H,Wa,Zt)}const Ro=Be||v&&It||Mr,gs=l.translatePosMatrix(Ar,bn,b,D),Vr=Ro?St:is,_s=l.translatePosMatrix(Jr,bn,b,D,!0),Fl=yn.getProjection().createInversionMatrix(ke,Zt.canonical),ma=[];l.terrainRenderModeElevated()&&$e&&ma.push("PITCH_WITH_MAP_TERRAIN"),$i&&ma.push("PROJECTION_GLOBE_VIEW"),Ro&&ma.push("PROJECTED_POS_ON_VIEWPORT");const ys=qn&&0!==s.paint.get(v?"text-halo-width":"icon-halo-width").constantOr(1);let Os;Os=qn?yn.iconsInText?ol(zn.kind,Bn,Xe,$e,l,gs,Vr,_s,si,Nn,Zt,Ir,ot,Fl,Lr,yn.getProjection()):rl(zn.kind,Bn,Xe,$e,l,gs,Vr,_s,v,si,!0,Zt,Ir,ot,Fl,Lr,yn.getProjection()):Tc(zn.kind,Bn,Xe,$e,l,gs,Vr,_s,v,si,Zt,Ir,ot,Fl,Lr,yn.getProjection());const kl={program:l.useProgram(Ei(qn,v,yn),Nt,ma),buffers:Kt,uniformValues:Os,atlasTexture:Di,atlasTextureIcon:Ri,atlasInterpolation:yi,atlasInterpolationIcon:pi,isSDF:qn,hasHalo:ys,tile:bn,labelPlaneMatrixInv:cl};if(We&&yn.canOverlap){gt=!0;const rs=Kt.segments.get();for(const Wa of rs)cn.push({segments:new c.SegmentVector([Wa]),sortKey:Wa.sortKey,state:kl})}else cn.push({segments:Kt.segments,sortKey:0,state:kl})}gt&&cn.sort((Zt,bn)=>Zt.sortKey-bn.sortKey);for(const Zt of cn){const bn=Zt.state;if(l.terrain&&l.terrain.setupElevationDraw(bn.tile,bn.program,{useDepthForOcclusion:!Jt,labelPlaneMatrixInv:bn.labelPlaneMatrixInv}),De.activeTexture.set(je.TEXTURE0),bn.atlasTexture.bind(bn.atlasInterpolation,je.CLAMP_TO_EDGE),bn.atlasTextureIcon&&(De.activeTexture.set(je.TEXTURE1),bn.atlasTextureIcon&&bn.atlasTextureIcon.bind(bn.atlasInterpolationIcon,je.CLAMP_TO_EDGE)),bn.isSDF){const yn=bn.uniformValues;bn.hasHalo&&(yn.u_is_halo=1,Xi(bn.buffers,Zt.segments,s,l,bn.program,yt,J,ue,yn)),yn.u_is_halo=0}Xi(bn.buffers,Zt.segments,s,l,bn.program,yt,J,ue,bn.uniformValues)}}function Xi(l,t,s,p,v,b,D,O,k){const H=p.context,J=[l.dynamicLayoutVertexBuffer,l.opacityVertexBuffer,l.globeExtVertexBuffer];v.draw(H,H.gl.TRIANGLES,b,D,O,c.CullFaceMode.disabled,k,s.id,l.layoutVertexBuffer,l.indexBuffer,t,s.paint,p.transform.zoom,l.programConfigurations.get(s.id),J)}function ur(l,t,s,p,v,b,D){const O=l.context.gl,k=s.paint.get("fill-pattern"),H=k&&k.constantOr(1),J=s.getCrossfadeParameters();let ue,De,je,ke,Ye;D?(De=H&&!s.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",ue=O.LINES):(De=H?"fillPattern":"fill",ue=O.TRIANGLES);for(const $e of p){const Be=t.getTile($e);if(H&&!Be.patternsLoaded())continue;const Xe=Be.getBucket(s);if(!Xe)continue;l.prepareDrawTile();const We=Xe.programConfigurations.get(s.id),gt=l.useProgram(De,We);H&&(l.context.activeTexture.set(O.TEXTURE0),Be.imageAtlasTexture.bind(O.LINEAR,O.CLAMP_TO_EDGE),We.updatePaintBuffers(J));const yt=k.constantOr(null);if(yt&&Be.imageAtlas){const It=Be.imageAtlas,Jt=It.patternPositions[yt.to.toString()],cn=It.patternPositions[yt.from.toString()];Jt&&cn&&We.setConstantPatternPositions(Jt,cn)}const ot=l.translatePosMatrix($e.projMatrix,Be,s.paint.get("fill-translate"),s.paint.get("fill-translate-anchor"));if(D){ke=Xe.indexBuffer2,Ye=Xe.segments2;const It=l.terrain&&l.terrain.renderingToTexture?l.terrain.drapeBufferSize:[O.drawingBufferWidth,O.drawingBufferHeight];je="fillOutlinePattern"===De&&H?Nr(ot,l,J,Be,It):ti(ot,It)}else ke=Xe.indexBuffer,Ye=Xe.segments,je=H?dn(ot,l,J,Be):Te(ot);l.prepareDrawProgram(l.context,gt,$e.toUnwrapped()),gt.draw(l.context,ue,v,l.stencilModeForClipping($e),b,c.CullFaceMode.disabled,je,s.id,Xe.layoutVertexBuffer,ke,Ye,s.paint,l.transform.zoom,We)}}function or(l,t,s,p,v,b,D){const O=l.context,k=O.gl,H=l.transform,J=s.paint.get("fill-extrusion-pattern"),ue=J.constantOr(1),De=s.getCrossfadeParameters(),je=s.paint.get("fill-extrusion-opacity"),ke=[s.paint.get("fill-extrusion-ambient-occlusion-intensity"),s.paint.get("fill-extrusion-ambient-occlusion-radius")],Ye=s.layout.get("fill-extrusion-edge-radius"),$e="globe"===H.projection.name?c.fillExtrusionHeightLift():0,Be="globe"===H.projection.name,Xe=Be?c.globeToMercatorTransition(H.zoom):0,We=[c.mercatorXfromLng(H.center.lng),c.mercatorYfromLat(H.center.lat)],gt=[];Be&&(gt.push("PROJECTION_GLOBE_VIEW"),l.style.terrainSetForDrapingOnly()&&gt.push("TERRAIN")),ke[0]>0&&gt.push("FAUX_AO");for(const yt of p){const ot=t.getTile(yt),It=ot.getBucket(s);if(!It||It.projection.name!==H.projection.name)continue;const Jt=It.programConfigurations.get(s.id),cn=l.useProgram(ue?"fillExtrusionPattern":"fillExtrusion",Jt,gt);if(l.terrain){const Nt=l.terrain;if(l.style.terrainSetForDrapingOnly())Nt.setupElevationDraw(ot,cn,{useMeterToDem:!0});else{if(!It.enableTerrain)continue;if(Nt.setupElevationDraw(ot,cn,{useMeterToDem:!0}),uo(O,t,yt,It,s,Nt),!It.centroidVertexBuffer){const qn=cn.attributes.a_centroid_pos;void 0!==qn&&k.vertexAttrib2f(qn,0,0)}}}ue&&(l.context.activeTexture.set(k.TEXTURE0),ot.imageAtlasTexture.bind(k.LINEAR,k.CLAMP_TO_EDGE),Jt.updatePaintBuffers(De));const Xt=J.constantOr(null);if(Xt&&ot.imageAtlas){const Nt=ot.imageAtlas,qn=Nt.patternPositions[Xt.to.toString()],zn=Nt.patternPositions[Xt.from.toString()];qn&&zn&&Jt.setConstantPatternPositions(qn,zn)}const An=l.translatePosMatrix(yt.projMatrix,ot,s.paint.get("fill-extrusion-translate"),s.paint.get("fill-extrusion-translate-anchor")),Zt=H.projection.createInversionMatrix(H,yt.canonical),bn=s.paint.get("fill-extrusion-vertical-gradient"),yn=ue?q(An,l,bn,je,ke,Ye,yt,De,ot,$e,Xe,We,Zt):X(An,l,bn,je,ke,Ye,yt,$e,Xe,We,Zt);l.prepareDrawProgram(O,cn,yt.toUnwrapped());const Kt=[];l.terrain&&Kt.push(It.centroidVertexBuffer),Be&&Kt.push(It.layoutVertexExtBuffer),cn.draw(O,O.gl.TRIANGLES,v,b,D,c.CullFaceMode.backCCW,yn,s.id,It.layoutVertexBuffer,It.indexBuffer,It.segments,s.paint,l.transform.zoom,Jt,Kt)}}function uo(l,t,s,p,v,b){const D=[Be=>{let Xe=Be.canonical.x-1,We=Be.wrap;return Xe<0&&(Xe=(1<<Be.canonical.z)-1,We--),new c.OverscaledTileID(Be.overscaledZ,We,Be.canonical.z,Xe,Be.canonical.y)},Be=>{let Xe=Be.canonical.x+1,We=Be.wrap;return Xe===1<<Be.canonical.z&&(Xe=0,We++),new c.OverscaledTileID(Be.overscaledZ,We,Be.canonical.z,Xe,Be.canonical.y)},Be=>new c.OverscaledTileID(Be.overscaledZ,Be.wrap,Be.canonical.z,Be.canonical.x,(0===Be.canonical.y?1<<Be.canonical.z:Be.canonical.y)-1),Be=>new c.OverscaledTileID(Be.overscaledZ,Be.wrap,Be.canonical.z,Be.canonical.x,Be.canonical.y===(1<<Be.canonical.z)-1?0:Be.canonical.y+1)],O=Be=>{const Xe=t.getSource().minzoom,We=yt=>{const ot=t.getTileByID(yt);if(ot&&ot.hasData())return ot.getBucket(v)},gt=[0,-1,1];for(const yt of gt){if(Be.overscaledZ+yt<Xe)continue;const ot=We(Be.calculateScaledKey(Be.overscaledZ+yt));if(ot)return ot}},k=[0,0,0],H=(Be,Xe)=>(k[0]=Math.min(Be.min.y,Xe.min.y),k[1]=Math.max(Be.max.y,Xe.max.y),k[2]=c.EXTENT-Xe.min.x>Be.max.x?Xe.min.x-c.EXTENT:Be.max.x,k),J=(Be,Xe)=>(k[0]=Math.min(Be.min.x,Xe.min.x),k[1]=Math.max(Be.max.x,Xe.max.x),k[2]=c.EXTENT-Xe.min.y>Be.max.y?Xe.min.y-c.EXTENT:Be.max.y,k),ue=[(Be,Xe)=>H(Be,Xe),(Be,Xe)=>H(Xe,Be),(Be,Xe)=>J(Be,Xe),(Be,Xe)=>J(Xe,Be)],De=new c.pointGeometry(0,0);let je,ke,Ye;const $e=(Be,Xe,We,gt,yt)=>{const ot=[[gt?We:Be,gt?Be:We,0],[gt?We:Xe,gt?Xe:We,0]],It=yt<0?c.EXTENT+yt:yt,Jt=[gt?It:(Be+Xe)/2,gt?(Be+Xe)/2:It,0];return 0===We&&yt<0||0!==We&&yt>0?b.getForTilePoints(Ye,[Jt],!0,ke):ot.push(Jt),b.getForTilePoints(s,ot,!0,je),Math.max(ot[0][2],ot[1][2],Jt[2])/b.exaggeration()};for(let Be=0;Be<4;Be++){const Xe=(Be<2?1:5)-Be,We=p.borders[Be];if(0===We.length)continue;const gt=Ye=D[Be](s),yt=O(gt);if(!(yt&&yt instanceof c.FillExtrusionBucket&&yt.enableTerrain)||p.borderDoneWithNeighborZ[Be]===yt.canonical.z&&yt.borderDoneWithNeighborZ[Xe]===p.canonical.z||(ke=b.findDEMTileFor(gt),!ke||!ke.dem))continue;if(!je){const cn=b.findDEMTileFor(s);if(!cn||!cn.dem)return;je=cn}const ot=yt.borders[Xe];let It=0;const Jt=yt.borderDoneWithNeighborZ[Xe]!==p.canonical.z;if(p.canonical.z===yt.canonical.z){for(let cn=0;cn<We.length;cn++){const Xt=p.featuresOnBorder[We[cn]],An=Xt.borders[Be];let Zt;for(;It<ot.length&&(Zt=yt.featuresOnBorder[ot[It]],!(Zt.borders[Xe][1]>An[0]+3));)Jt&&yt.encodeCentroid(void 0,Zt,!1),It++;if(Zt&&It<ot.length){const bn=It;let yn=0;for(;!(Zt.borders[Xe][0]>An[1]-3)&&(yn++,++It!==ot.length);)Zt=yt.featuresOnBorder[ot[It]];if(Zt=yt.featuresOnBorder[ot[bn]],Xt.intersectsCount()>1||Zt.intersectsCount()>1||1!==yn){1!==yn&&(It=bn),p.encodeCentroid(void 0,Xt,!1),Jt&&yt.encodeCentroid(void 0,Zt,!1);continue}const Kt=ue[Be](Xt,Zt),Nt=Be%2?c.EXTENT-1:0;De.x=$e(Kt[0],Math.min(c.EXTENT-1,Kt[1]),Nt,Be<2,Kt[2]),De.y=0,p.encodeCentroid(De,Xt,!1),Jt&&yt.encodeCentroid(De,Zt,!1)}else p.encodeCentroid(void 0,Xt,!1)}p.borderDoneWithNeighborZ[Be]=yt.canonical.z,p.needsCentroidUpdate=!0,Jt&&(yt.borderDoneWithNeighborZ[Xe]=p.canonical.z,yt.needsCentroidUpdate=!0)}else{for(const cn of We)p.encodeCentroid(void 0,p.featuresOnBorder[cn],!1);if(Jt){for(const cn of ot)yt.encodeCentroid(void 0,yt.featuresOnBorder[cn],!1);yt.borderDoneWithNeighborZ[Xe]=p.canonical.z,yt.needsCentroidUpdate=!0}p.borderDoneWithNeighborZ[Be]=yt.canonical.z,p.needsCentroidUpdate=!0}}(p.needsCentroidUpdate||!p.centroidVertexBuffer&&0!==p.centroidVertexArray.length)&&p.uploadCentroid(l)}const eo=new c.Color(1,0,0,1),Ds=new c.Color(0,1,0,1),Is=new c.Color(0,0,1,1),Ba=new c.Color(1,0,1,1),za=new c.Color(0,1,1,1);function da(l,t,s){const p=l.context,v=l.transform,b=p.gl,D="globe"===v.projection.name,O=D?["PROJECTION_GLOBE_VIEW"]:null;let k=s.projMatrix;if(D&&c.globeToMercatorTransition(v.zoom)>0){const Xt=c.transitionTileAABBinECEF(s.canonical,v),An=c.globeDenormalizeECEF(Xt);k=c.multiply(new Float32Array(16),v.globeMatrix,An),c.multiply(k,v.projMatrix,k)}const H=l.useProgram("debug",null,O),J=t.getTileByID(s.key);l.terrain&&l.terrain.setupElevationDraw(J,H);const ue=c.DepthMode.disabled,De=c.StencilMode.disabled,je=l.colorModeForRenderPass();p.activeTexture.set(b.TEXTURE0),l.emptyTexture.bind(b.LINEAR,b.CLAMP_TO_EDGE),D?J._makeGlobeTileDebugBuffers(l.context,v):J._makeDebugTileBoundsBuffers(l.context,v.projection);const Ye=J._tileDebugBuffer||l.debugBuffer,$e=J._tileDebugIndexBuffer||l.debugIndexBuffer,Be=J._tileDebugSegments||l.debugSegments;H.draw(p,b.LINE_STRIP,ue,De,je,c.CullFaceMode.disabled,Dl(k,c.Color.red),"$debug",Ye,$e,Be,null,null,null,[J._globeTileDebugBorderBuffer]);const Xe=J.latestRawTileData,We=Math.floor((Xe&&Xe.byteLength||0)/1024),gt=t.getTile(s).tileSize,yt=512/Math.min(gt,512)*(s.overscaledZ/v.zoom)*.5;let ot=s.canonical.toString();s.overscaledZ!==s.canonical.z&&(ot+=` => ${s.overscaledZ}`),ot+=` ${We}kb`,function(Xt,An){Xt.initDebugOverlayCanvas();const Zt=Xt.debugOverlayCanvas,bn=Xt.context.gl,yn=Xt.debugOverlayCanvas.getContext("2d");yn.clearRect(0,0,Zt.width,Zt.height),yn.shadowColor="white",yn.shadowBlur=2,yn.lineWidth=1.5,yn.strokeStyle="white",yn.textBaseline="top",yn.font="bold 36px Open Sans, sans-serif",yn.fillText(An,5,5),yn.strokeText(An,5,5),Xt.debugOverlayTexture.update(Zt),Xt.debugOverlayTexture.bind(bn.LINEAR,bn.CLAMP_TO_EDGE)}(l,ot);const It=J._tileDebugTextBuffer||l.debugBuffer,Jt=J._tileDebugTextIndexBuffer||l.quadTriangleIndexBuffer,cn=J._tileDebugTextSegments||l.debugSegments;H.draw(p,b.TRIANGLES,ue,De,c.ColorMode.alphaBlended,c.CullFaceMode.disabled,Dl(k,c.Color.transparent,yt),"$debug",It,Jt,cn,null,null,null,[J._globeTileDebugTextBuffer])}function Ms(l,t,s,p){ha(l,0,t+s/2,l.transform.width,s,p)}function Hl(l,t,s,p){ha(l,t-s/2,0,s,l.transform.height,p)}function ha(l,t,s,p,v,b){const D=l.context,O=D.gl;O.enable(O.SCISSOR_TEST),O.scissor(t*c.exported.devicePixelRatio,s*c.exported.devicePixelRatio,p*c.exported.devicePixelRatio,v*c.exported.devicePixelRatio),D.clear({color:b}),O.disable(O.SCISSOR_TEST)}const _o=c.createLayout([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:Ea}=_o;function vr(l,t,s,p){l.emplaceBack(t,s,p)}class U{constructor(t){this.vertexArray=new c.StructArrayLayout3f12,this.indices=new c.StructArrayLayout3ui6,vr(this.vertexArray,-1,-1,1),vr(this.vertexArray,1,-1,1),vr(this.vertexArray,-1,1,1),vr(this.vertexArray,1,1,1),vr(this.vertexArray,-1,-1,-1),vr(this.vertexArray,1,-1,-1),vr(this.vertexArray,-1,1,-1),vr(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=t.createVertexBuffer(this.vertexArray,Ea),this.indexBuffer=t.createIndexBuffer(this.indices),this.segment=c.SegmentVector.simpleSegment(0,0,36,12)}}function ce(l,t,s,p,v,b){const D=l.gl,O=t.paint.get("sky-atmosphere-color"),k=t.paint.get("sky-atmosphere-halo-color"),H=t.paint.get("sky-atmosphere-sun-intensity"),J={u_matrix_3f:c.fromMat4(c.create$1(),p),u_sun_direction:v,u_sun_intensity:H,u_color_tint_r:[(ke=O).r,ke.g,ke.b,ke.a],u_color_tint_m:[(Ye=k).r,Ye.g,Ye.b,Ye.a],u_luminance:5e-5};var ke,Ye;D.framebufferTexture2D(D.FRAMEBUFFER,D.COLOR_ATTACHMENT0,D.TEXTURE_CUBE_MAP_POSITIVE_X+b,t.skyboxTexture,0),s.draw(l,D.TRIANGLES,c.DepthMode.disabled,c.StencilMode.disabled,c.ColorMode.unblended,c.CullFaceMode.frontCW,J,"skyboxCapture",t.skyboxGeometry.vertexBuffer,t.skyboxGeometry.indexBuffer,t.skyboxGeometry.segment)}const W=c.createLayout([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class Me{constructor(t){const s=new c.StructArrayLayout5f20;s.emplaceBack(-1,1,1,0,0),s.emplaceBack(1,1,1,1,0),s.emplaceBack(1,-1,1,1,1),s.emplaceBack(-1,-1,1,0,1);const p=new c.StructArrayLayout3ui6;p.emplaceBack(0,1,2),p.emplaceBack(2,3,0),this.vertexBuffer=t.createVertexBuffer(s,W.members),this.indexBuffer=t.createIndexBuffer(p),this.segments=c.SegmentVector.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const Tt={symbol:function(l,t,s,p,v){if("translucent"!==l.renderPass)return;const b=c.StencilMode.disabled,D=l.colorModeForRenderPass();s.layout.get("text-variable-anchor")&&function(O,k,H,J,ue,De,je){const ke=k.transform,Ye="map"===ue,$e="map"===De;for(const Be of O){const Xe=J.getTile(Be),We=Xe.getBucket(H);if(!We||!We.text||!We.text.segments.get().length)continue;const gt=c.evaluateSizeForZoom(We.textSizeData,ke.zoom),yt=ki(Be,We.getProjection(),ke),ot=ke.calculatePixelsToTileUnitsMatrix(Xe),It=Oi(yt,Xe.tileID.canonical,$e,Ye,ke,We.getProjection(),ot),Jt="none"!==H.layout.get("icon-text-fit")&&We.hasIconData();if(gt){const cn=Math.pow(2,ke.zoom-Xe.tileID.overscaledZ);Zn(We,Ye,$e,je,c.symbolSize,ke,It,Be,cn,gt,Jt)}}}(p,l,s,t,s.layout.get("text-rotation-alignment"),s.layout.get("text-pitch-alignment"),v),0!==s.paint.get("icon-opacity").constantOr(1)&&ii(l,t,s,p,!1,s.paint.get("icon-translate"),s.paint.get("icon-translate-anchor"),s.layout.get("icon-rotation-alignment"),s.layout.get("icon-pitch-alignment"),s.layout.get("icon-keep-upright"),b,D),0!==s.paint.get("text-opacity").constantOr(1)&&ii(l,t,s,p,!0,s.paint.get("text-translate"),s.paint.get("text-translate-anchor"),s.layout.get("text-rotation-alignment"),s.layout.get("text-pitch-alignment"),s.layout.get("text-keep-upright"),b,D),t.map.showCollisionBoxes&&(ve(l,t,s,p,s.paint.get("text-translate"),s.paint.get("text-translate-anchor"),!0),ve(l,t,s,p,s.paint.get("icon-translate"),s.paint.get("icon-translate-anchor"),!1))},circle:function(l,t,s,p){if("translucent"!==l.renderPass)return;const v=s.paint.get("circle-opacity"),b=s.paint.get("circle-stroke-width"),D=s.paint.get("circle-stroke-opacity"),O=void 0!==s.layout.get("circle-sort-key").constantOr(1);if(0===v.constantOr(1)&&(0===b.constantOr(1)||0===D.constantOr(1)))return;const k=l.context,H=k.gl,J=l.transform,ue=l.depthModeForSublayer(0,c.DepthMode.ReadOnly),De=c.StencilMode.disabled,je=l.colorModeForRenderPass(),ke="globe"===J.projection.name,Ye=[c.mercatorXfromLng(J.center.lng),c.mercatorYfromLat(J.center.lat)],$e=[];for(let Xe=0;Xe<p.length;Xe++){const We=p[Xe],gt=t.getTile(We),yt=gt.getBucket(s);if(!yt||yt.projection.name!==J.projection.name)continue;const ot=yt.programConfigurations.get(s.id),It=la(s);ke&&It.push("PROJECTION_GLOBE_VIEW");const Jt=l.useProgram("circle",ot,It),cn=yt.layoutVertexBuffer,Xt=yt.globeExtVertexBuffer,An=yt.indexBuffer,Zt=J.projection.createInversionMatrix(J,We.canonical),bn={programConfiguration:ot,program:Jt,layoutVertexBuffer:cn,globeExtVertexBuffer:Xt,indexBuffer:An,uniformValues:Vo(l,We,gt,Zt,Ye,s),tile:gt};if(O){const yn=yt.segments.get();for(const Kt of yn)$e.push({segments:new c.SegmentVector([Kt]),sortKey:Kt.sortKey,state:bn})}else $e.push({segments:yt.segments,sortKey:0,state:bn})}O&&$e.sort((Xe,We)=>Xe.sortKey-We.sortKey);const Be={useDepthForOcclusion:!ke};for(const Xe of $e){const{programConfiguration:We,program:gt,layoutVertexBuffer:yt,globeExtVertexBuffer:ot,indexBuffer:It,uniformValues:Jt,tile:cn}=Xe.state,Xt=Xe.segments;l.terrain&&l.terrain.setupElevationDraw(cn,gt,Be),l.prepareDrawProgram(k,gt,cn.tileID.toUnwrapped()),gt.draw(k,H.TRIANGLES,ue,De,je,c.CullFaceMode.disabled,Jt,s.id,yt,It,Xt,s.paint,J.zoom,We,[ot])}},heatmap:function(l,t,s,p){if(0!==s.paint.get("heatmap-opacity"))if("offscreen"===l.renderPass){const v=l.context,b=v.gl,D=c.StencilMode.disabled,O=new c.ColorMode([b.ONE,b.ONE],c.Color.transparent,[!0,!0,!0,!0]);(function(je,ke,Ye,$e){const Be=je.gl,Xe=ke.width*$e,We=ke.height*$e;je.activeTexture.set(Be.TEXTURE1),je.viewport.set([0,0,Xe,We]);let gt=Ye.heatmapFbo;if(!gt||gt&&(gt.width!==Xe||gt.height!==We)){gt&&gt.destroy();const yt=Be.createTexture();Be.bindTexture(Be.TEXTURE_2D,yt),Be.texParameteri(Be.TEXTURE_2D,Be.TEXTURE_WRAP_S,Be.CLAMP_TO_EDGE),Be.texParameteri(Be.TEXTURE_2D,Be.TEXTURE_WRAP_T,Be.CLAMP_TO_EDGE),Be.texParameteri(Be.TEXTURE_2D,Be.TEXTURE_MIN_FILTER,Be.LINEAR),Be.texParameteri(Be.TEXTURE_2D,Be.TEXTURE_MAG_FILTER,Be.LINEAR),gt=Ye.heatmapFbo=je.createFramebuffer(Xe,We,!1),function(ot,It,Jt,cn,Xt,An){const Zt=ot.gl;Zt.texImage2D(Zt.TEXTURE_2D,0,Zt.RGBA,Xt,An,0,Zt.RGBA,ot.extRenderToTextureHalfFloat?ot.extTextureHalfFloat.HALF_FLOAT_OES:Zt.UNSIGNED_BYTE,null),cn.colorAttachment.set(Jt)}(je,0,yt,gt,Xe,We)}else Be.bindTexture(Be.TEXTURE_2D,gt.colorAttachment.get()),je.bindFramebuffer.set(gt.framebuffer)})(v,l,s,"globe"===l.transform.projection.name?.5:.25),v.clear({color:c.Color.transparent});const k=l.transform,H="globe"===k.projection.name,J=H?["PROJECTION_GLOBE_VIEW"]:null,ue=H?c.CullFaceMode.frontCCW:c.CullFaceMode.disabled,De=[c.mercatorXfromLng(k.center.lng),c.mercatorYfromLat(k.center.lat)];for(let je=0;je<p.length;je++){const ke=p[je];if(t.hasRenderableParent(ke))continue;const Ye=t.getTile(ke),$e=Ye.getBucket(s);if(!$e||$e.projection.name!==k.projection.name)continue;const Be=$e.programConfigurations.get(s.id),Xe=l.useProgram("heatmap",Be,J),{zoom:We}=l.transform;l.terrain&&l.terrain.setupElevationDraw(Ye,Xe),l.prepareDrawProgram(v,Xe,ke.toUnwrapped());const gt=k.projection.createInversionMatrix(k,ke.canonical);Xe.draw(v,b.TRIANGLES,c.DepthMode.disabled,D,O,ue,Ji(l,ke,Ye,gt,De,We,s.paint.get("heatmap-intensity")),s.id,$e.layoutVertexBuffer,$e.indexBuffer,$e.segments,s.paint,l.transform.zoom,Be,H?[$e.globeExtVertexBuffer]:null)}v.viewport.set([0,0,l.width,l.height])}else"translucent"===l.renderPass&&(l.context.setColorMode(l.colorModeForRenderPass()),function(v,b){const D=v.context,O=D.gl,k=b.heatmapFbo;if(!k)return;D.activeTexture.set(O.TEXTURE0),O.bindTexture(O.TEXTURE_2D,k.colorAttachment.get()),D.activeTexture.set(O.TEXTURE1);let H=b.colorRampTexture;H||(H=b.colorRampTexture=new c.Texture(D,b.colorRamp,O.RGBA)),H.bind(O.LINEAR,O.CLAMP_TO_EDGE),v.useProgram("heatmapTexture").draw(D,O.TRIANGLES,c.DepthMode.disabled,c.StencilMode.disabled,v.colorModeForRenderPass(),c.CullFaceMode.disabled,{u_image:0,u_color_ramp:1,u_opacity:b.paint.get("heatmap-opacity")},b.id,v.viewportBuffer,v.quadTriangleIndexBuffer,v.viewportSegments,b.paint,v.transform.zoom)}(l,s))},line:function(l,t,s,p){if("translucent"!==l.renderPass)return;const v=s.paint.get("line-opacity"),b=s.paint.get("line-width");if(0===v.constantOr(1)||0===b.constantOr(1))return;const D=l.depthModeForSublayer(0,c.DepthMode.ReadOnly),O=l.colorModeForRenderPass(),k=l.terrain&&l.terrain.renderingToTexture?1:c.exported.devicePixelRatio,H=s.paint.get("line-dasharray"),J=H.constantOr(1),ue=s.layout.get("line-cap"),De=s.paint.get("line-pattern"),je=De.constantOr(1),ke=s.paint.get("line-gradient"),Ye=s.getCrossfadeParameters(),$e=je?"linePattern":"line",Be=l.context,Xe=Be.gl,We=(yt=>{const ot=[];js(yt)&&ot.push("RENDER_LINE_DASH"),yt.paint.get("line-gradient")&&ot.push("RENDER_LINE_GRADIENT");const It=yt.paint.get("line-trim-offset");0===It[0]&&0===It[1]||ot.push("RENDER_LINE_TRIM_OFFSET");const Jt=yt.paint.get("line-pattern").constantOr(1),cn=1!==yt.paint.get("line-opacity").constantOr(1);return!Jt&&cn&&ot.push("RENDER_LINE_ALPHA_DISCARD"),ot})(s);let gt=We.includes("RENDER_LINE_ALPHA_DISCARD");l.terrain&&l.terrain.clipOrMaskOverlapStencilType()&&(gt=!1);for(const yt of p){const ot=t.getTile(yt);if(je&&!ot.patternsLoaded())continue;const It=ot.getBucket(s);if(!It)continue;l.prepareDrawTile();const Jt=It.programConfigurations.get(s.id),cn=l.useProgram($e,Jt,We),Xt=De.constantOr(null);if(Xt&&ot.imageAtlas){const zn=ot.imageAtlas,jn=zn.patternPositions[Xt.to.toString()],Bn=zn.patternPositions[Xt.from.toString()];jn&&Bn&&Jt.setConstantPatternPositions(jn,Bn)}const An=H.constantOr(null),Zt=ue.constantOr(null);if(!je&&An&&Zt&&ot.lineAtlas){const zn=ot.lineAtlas,jn=zn.getDash(An.to,Zt),Bn=zn.getDash(An.from,Zt);jn&&Bn&&Jt.setConstantPatternPositions(jn,Bn)}let[bn,yn]=s.paint.get("line-trim-offset");("round"===Zt||"square"===Zt)&&bn!==yn&&(0===bn&&(bn-=1),1===yn&&(yn+=1));const Kt=l.terrain?yt.projMatrix:null,Nt=je?Ml(l,ot,s,Ye,Kt,k):Il(l,ot,s,Ye,Kt,It.lineClipsArray.length,k,[bn,yn]);if(ke){const zn=It.gradients[s.id];let jn=zn.texture;if(s.gradientVersion!==zn.version){let Bn=256;if(s.stepInterpolant){const si=t.getSource().maxzoom,Di=yt.canonical.z===si?Math.ceil(1<<l.transform.maxZoom-yt.canonical.z):1;Bn=c.clamp(c.nextPowerOfTwo(It.maxLineLength/c.EXTENT*1024*Di),256,Be.maxTextureSize)}zn.gradient=c.renderColorRamp({expression:s.gradientExpression(),evaluationKey:"lineProgress",resolution:Bn,image:zn.gradient||void 0,clips:It.lineClipsArray}),zn.texture?zn.texture.update(zn.gradient):zn.texture=new c.Texture(Be,zn.gradient,Xe.RGBA),zn.version=s.gradientVersion,jn=zn.texture}Be.activeTexture.set(Xe.TEXTURE1),jn.bind(s.stepInterpolant?Xe.NEAREST:Xe.LINEAR,Xe.CLAMP_TO_EDGE)}J&&(Be.activeTexture.set(Xe.TEXTURE0),ot.lineAtlasTexture.bind(Xe.LINEAR,Xe.REPEAT),Jt.updatePaintBuffers(Ye)),je&&(Be.activeTexture.set(Xe.TEXTURE0),ot.imageAtlasTexture.bind(Xe.LINEAR,Xe.CLAMP_TO_EDGE),Jt.updatePaintBuffers(Ye)),l.prepareDrawProgram(Be,cn,yt.toUnwrapped());const qn=zn=>{cn.draw(Be,Xe.TRIANGLES,D,zn,O,c.CullFaceMode.disabled,Nt,s.id,It.layoutVertexBuffer,It.indexBuffer,It.segments,s.paint,l.transform.zoom,Jt,[It.layoutVertexBuffer2])};if(gt){const zn=l.stencilModeForClipping(yt).ref;0===zn&&l.terrain&&Be.clear({stencil:0});const jn={func:Xe.EQUAL,mask:255};Nt.u_alpha_discard_threshold=.8,qn(new c.StencilMode(jn,zn,255,Xe.KEEP,Xe.KEEP,Xe.INVERT)),Nt.u_alpha_discard_threshold=0,qn(new c.StencilMode(jn,zn,255,Xe.KEEP,Xe.KEEP,Xe.KEEP))}else qn(l.stencilModeForClipping(yt))}gt&&(l.resetStencilClippingMasks(),l.terrain&&Be.clear({stencil:0}))},fill:function(l,t,s,p){const v=s.paint.get("fill-color"),b=s.paint.get("fill-opacity");if(0===b.constantOr(1))return;const D=l.colorModeForRenderPass(),O=s.paint.get("fill-pattern"),k=l.opaquePassEnabledForLayer()&&!O.constantOr(1)&&1===v.constantOr(c.Color.transparent).a&&1===b.constantOr(0)?"opaque":"translucent";if(l.renderPass===k){const H=l.depthModeForSublayer(1,"opaque"===l.renderPass?c.DepthMode.ReadWrite:c.DepthMode.ReadOnly);ur(l,t,s,p,H,D,!1)}if("translucent"===l.renderPass&&s.paint.get("fill-antialias")){const H=l.depthModeForSublayer(s.getPaintProperty("fill-outline-color")?2:0,c.DepthMode.ReadOnly);ur(l,t,s,p,H,D,!0)}},"fill-extrusion":function(l,t,s,p){const v=s.paint.get("fill-extrusion-opacity");if(0!==v&&"translucent"===l.renderPass){const b=new c.DepthMode(l.context.gl.LEQUAL,c.DepthMode.ReadWrite,l.depthRangeFor3D);if(1!==v||s.paint.get("fill-extrusion-pattern").constantOr(1))or(l,t,s,p,b,c.StencilMode.disabled,c.ColorMode.disabled),or(l,t,s,p,b,l.stencilModeFor3D(),l.colorModeForRenderPass()),l.resetStencilClippingMasks();else{const D=l.colorModeForRenderPass();or(l,t,s,p,b,c.StencilMode.disabled,D)}}},hillshade:function(l,t,s,p){if("offscreen"!==l.renderPass&&"translucent"!==l.renderPass)return;const v=l.context,b=l.depthModeForSublayer(0,c.DepthMode.ReadOnly),D=l.colorModeForRenderPass(),O=l.terrain&&l.terrain.renderingToTexture,[k,H]="translucent"!==l.renderPass||O?[{},p]:l.stencilConfigForOverlap(p);for(const J of H){const ue=t.getTile(J);if(ue.needsHillshadePrepare&&"offscreen"===l.renderPass)Ts(l,ue,s,b,c.StencilMode.disabled,D);else if("translucent"===l.renderPass){const De=O&&l.terrain?l.terrain.stencilModeForRTTOverlap(J):k[J.overscaledZ];Vs(l,J,ue,s,b,De,D)}}v.viewport.set([0,0,l.width,l.height]),l.resetStencilClippingMasks()},raster:function(l,t,s,p,v,b){if("translucent"!==l.renderPass||0===s.paint.get("raster-opacity")||!p.length)return;const D=l.context,O=D.gl,k=t.getSource(),H=l.useProgram("raster"),J=l.colorModeForRenderPass(),ue=l.terrain&&l.terrain.renderingToTexture,[De,je]=k instanceof st||ue?[{},p]:l.stencilConfigForOverlap(p),ke=je[je.length-1].overscaledZ,Ye=!l.options.moving;for(const $e of je){const Be=ue?c.DepthMode.disabled:l.depthModeForSublayer($e.overscaledZ-ke,1===s.paint.get("raster-opacity")?c.DepthMode.ReadWrite:c.DepthMode.ReadOnly,O.LESS),Xe=$e.toUnwrapped(),We=t.getTile($e);if(ue&&(!We||!We.hasData()))continue;const gt=ue?$e.projMatrix:l.transform.calculateProjMatrix(Xe,Ye),yt=l.terrain&&ue?l.terrain.stencilModeForRTTOverlap($e):De[$e.overscaledZ],ot=b?0:s.paint.get("raster-fade-duration");We.registerFadeDuration(ot);const It=t.findLoadedParent($e,0),Jt=wa(We,It,t,l.transform,ot);let cn,Xt;l.terrain&&l.terrain.prepareDrawTile();const An="nearest"===s.paint.get("raster-resampling")?O.NEAREST:O.LINEAR;D.activeTexture.set(O.TEXTURE0),We.texture.bind(An,O.CLAMP_TO_EDGE),D.activeTexture.set(O.TEXTURE1),It?(It.texture.bind(An,O.CLAMP_TO_EDGE),cn=Math.pow(2,It.tileID.overscaledZ-We.tileID.overscaledZ),Xt=[We.tileID.canonical.x*cn%1,We.tileID.canonical.y*cn%1]):We.texture.bind(An,O.CLAMP_TO_EDGE);const Zt=co(gt,Xt||[0,0],cn||1,Jt,s,k instanceof st?k.perspectiveTransform:[0,0]);if(l.prepareDrawProgram(D,H,Xe),k instanceof st)k.boundsBuffer&&k.boundsSegments&&H.draw(D,O.TRIANGLES,Be,c.StencilMode.disabled,J,c.CullFaceMode.disabled,Zt,s.id,k.boundsBuffer,l.quadTriangleIndexBuffer,k.boundsSegments);else{const{tileBoundsBuffer:bn,tileBoundsIndexBuffer:yn,tileBoundsSegments:Kt}=l.getTileBoundsBuffers(We);H.draw(D,O.TRIANGLES,Be,yt,J,c.CullFaceMode.disabled,Zt,s.id,bn,yn,Kt)}}l.resetStencilClippingMasks()},background:function(l,t,s,p){const v=s.paint.get("background-color"),b=s.paint.get("background-opacity");if(0===b)return;const D=l.context,O=D.gl,k=l.transform,H=k.tileSize,J=s.paint.get("background-pattern");if(l.isPatternMissing(J))return;const ue=!J&&1===v.a&&1===b&&l.opaquePassEnabledForLayer()?"opaque":"translucent";if(l.renderPass!==ue)return;const De=c.StencilMode.disabled,je=l.depthModeForSublayer(0,"opaque"===ue?c.DepthMode.ReadWrite:c.DepthMode.ReadOnly),ke=l.colorModeForRenderPass(),Ye=l.useProgram(J?"backgroundPattern":"background");let $e,Be=p;Be||($e=l.getBackgroundTiles(),Be=Object.values($e).map(We=>We.tileID)),J&&(D.activeTexture.set(O.TEXTURE0),l.imageManager.bind(l.context));const Xe=s.getCrossfadeParameters();for(const We of Be){const gt=We.toUnwrapped(),yt=p?We.projMatrix:l.transform.calculateProjMatrix(gt);l.prepareDrawTile();const ot=t?t.getTile(We):$e?$e[We.key]:new c.Tile(We,H,k.zoom,l),It=J?Z(yt,b,l,J,{tileID:We,tileSize:H},Xe):E(yt,b,v);l.prepareDrawProgram(D,Ye,gt);const{tileBoundsBuffer:Jt,tileBoundsIndexBuffer:cn,tileBoundsSegments:Xt}=l.getTileBoundsBuffers(ot);Ye.draw(D,O.TRIANGLES,je,De,ke,c.CullFaceMode.disabled,It,s.id,Jt,cn,Xt)}},sky:function(l,t,s){const p=l.transform,v="mercator"===p.projection.name||"globe"===p.projection.name?1:c.smoothstep(7,8,p.zoom),b=s.paint.get("sky-opacity")*v;if(0===b)return;const D=l.context,O=s.paint.get("sky-type"),k=new c.DepthMode(D.gl.LEQUAL,c.DepthMode.ReadOnly,[0,1]),H=l.frameCounter/1e3%1;"atmosphere"===O?"offscreen"===l.renderPass?s.needsSkyboxCapture(l)&&(function(J,ue,De,je){const ke=J.context,Ye=ke.gl;let $e=ue.skyboxFbo;if(!$e){$e=ue.skyboxFbo=ke.createFramebuffer(32,32,!1),ue.skyboxGeometry=new U(ke),ue.skyboxTexture=ke.gl.createTexture(),Ye.bindTexture(Ye.TEXTURE_CUBE_MAP,ue.skyboxTexture),Ye.texParameteri(Ye.TEXTURE_CUBE_MAP,Ye.TEXTURE_WRAP_S,Ye.CLAMP_TO_EDGE),Ye.texParameteri(Ye.TEXTURE_CUBE_MAP,Ye.TEXTURE_WRAP_T,Ye.CLAMP_TO_EDGE),Ye.texParameteri(Ye.TEXTURE_CUBE_MAP,Ye.TEXTURE_MIN_FILTER,Ye.LINEAR),Ye.texParameteri(Ye.TEXTURE_CUBE_MAP,Ye.TEXTURE_MAG_FILTER,Ye.LINEAR);for(let gt=0;gt<6;++gt)Ye.texImage2D(Ye.TEXTURE_CUBE_MAP_POSITIVE_X+gt,0,Ye.RGBA,32,32,0,Ye.RGBA,Ye.UNSIGNED_BYTE,null)}ke.bindFramebuffer.set($e.framebuffer),ke.viewport.set([0,0,32,32]);const Be=ue.getCenter(J,!0),Xe=J.useProgram("skyboxCapture"),We=new Float64Array(16);c.identity(We),c.rotateY(We,We,.5*-Math.PI),ce(ke,ue,Xe,We,Be,0),c.identity(We),c.rotateY(We,We,.5*Math.PI),ce(ke,ue,Xe,We,Be,1),c.identity(We),c.rotateX(We,We,.5*-Math.PI),ce(ke,ue,Xe,We,Be,2),c.identity(We),c.rotateX(We,We,.5*Math.PI),ce(ke,ue,Xe,We,Be,3),c.identity(We),ce(ke,ue,Xe,We,Be,4),c.identity(We),c.rotateY(We,We,Math.PI),ce(ke,ue,Xe,We,Be,5),ke.viewport.set([0,0,J.width,J.height])}(l,s),s.markSkyboxValid(l)):"sky"===l.renderPass&&function(J,ue,De,je,ke){const Ye=J.context,$e=Ye.gl,Be=J.transform,Xe=J.useProgram("skybox");Ye.activeTexture.set($e.TEXTURE0),$e.bindTexture($e.TEXTURE_CUBE_MAP,ue.skyboxTexture);const We={u_matrix:Be.skyboxMatrix,u_sun_direction:ue.getCenter(J,!1),u_cubemap:0,u_opacity:je,u_temporal_offset:ke};J.prepareDrawProgram(Ye,Xe),Xe.draw(Ye,$e.TRIANGLES,De,c.StencilMode.disabled,J.colorModeForRenderPass(),c.CullFaceMode.backCW,We,"skybox",ue.skyboxGeometry.vertexBuffer,ue.skyboxGeometry.indexBuffer,ue.skyboxGeometry.segment)}(l,s,k,b,H):"gradient"===O&&"sky"===l.renderPass&&function(J,ue,De,je,ke){const Ye=J.context,$e=Ye.gl,Be=J.transform,Xe=J.useProgram("skyboxGradient");ue.skyboxGeometry||(ue.skyboxGeometry=new U(Ye)),Ye.activeTexture.set($e.TEXTURE0);let We=ue.colorRampTexture;We||(We=ue.colorRampTexture=new c.Texture(Ye,ue.colorRamp,$e.RGBA)),We.bind($e.LINEAR,$e.CLAMP_TO_EDGE);const gt=(yt=Be.skyboxMatrix,ot=ue.getCenter(J,!1),It=ue.paint.get("sky-gradient-radius"),Jt=je,cn=ke,{u_matrix:yt,u_color_ramp:0,u_center_direction:ot,u_radius:c.degToRad(It),u_opacity:Jt,u_temporal_offset:cn});var yt,ot,It,Jt,cn;J.prepareDrawProgram(Ye,Xe),Xe.draw(Ye,$e.TRIANGLES,De,c.StencilMode.disabled,J.colorModeForRenderPass(),c.CullFaceMode.backCW,gt,"skyboxGradient",ue.skyboxGeometry.vertexBuffer,ue.skyboxGeometry.indexBuffer,ue.skyboxGeometry.segment)}(l,s,k,b,H)},debug:function(l,t,s){for(let p=0;p<s.length;p++)da(l,t,s[p])},custom:function(l,t,s){const p=l.context,v=s.implementation;if(l.transform.projection.unsupportedLayers&&l.transform.projection.unsupportedLayers.includes("custom"))c.warnOnce("Custom layers are not yet supported with non-mercator projections. Use mercator to enable custom layers.");else if("offscreen"===l.renderPass){const b=v.prerender;b&&(l.setCustomLayerDefaults(),p.setColorMode(l.colorModeForRenderPass()),b.call(v,p.gl,l.transform.customLayerMatrix()),p.setDirty(),l.setBaseState())}else if("translucent"===l.renderPass){l.setCustomLayerDefaults(),p.setColorMode(l.colorModeForRenderPass()),p.setStencilMode(c.StencilMode.disabled);const b="3d"===v.renderingMode?new c.DepthMode(l.context.gl.LEQUAL,c.DepthMode.ReadWrite,l.depthRangeFor3D):l.depthModeForSublayer(0,c.DepthMode.ReadOnly);p.setDepthMode(b),v.render(p.gl,l.transform.customLayerMatrix()),p.setDirty(),l.setBaseState(),p.bindFramebuffer.set(null)}}};class fn{constructor(t,s){this.context=new R(t),this.transform=s,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=c.SourceCache.maxUnderzooming+c.SourceCache.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new mo,this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={}}updateTerrain(t,s){const p=!!t&&!!t.terrain&&this.transform.projection.supportsTerrain;if(!(p||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new ka(this,t));const v=this._terrain;this.transform.elevation=p?v:null,v.update(t,this.transform,s)}_updateFog(t){const s=t.fog;if(!s||"globe"===this.transform.projection.name||s.getOpacity(this.transform.pitch)<1||s.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[p,v]=s.getFovAdjustedRange(this.transform._fov);if(p>v)return void(this.transform.fogCullDistSq=null);const b=p+.78*(v-p);this.transform.fogCullDistSq=b*b}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled?this._terrain:null}resize(t,s){if(this.width=t*c.exported.devicePixelRatio,this.height=s*c.exported.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const p of this.style.order)this.style._layers[p].resize()}setup(){const t=this.context,s=new c.StructArrayLayout2i4;s.emplaceBack(0,0),s.emplaceBack(c.EXTENT,0),s.emplaceBack(0,c.EXTENT),s.emplaceBack(c.EXTENT,c.EXTENT),this.tileExtentBuffer=t.createVertexBuffer(s,c.posAttributes.members),this.tileExtentSegments=c.SegmentVector.simpleSegment(0,0,4,2);const p=new c.StructArrayLayout2i4;p.emplaceBack(0,0),p.emplaceBack(c.EXTENT,0),p.emplaceBack(0,c.EXTENT),p.emplaceBack(c.EXTENT,c.EXTENT),this.debugBuffer=t.createVertexBuffer(p,c.posAttributes.members),this.debugSegments=c.SegmentVector.simpleSegment(0,0,4,5);const v=new c.StructArrayLayout2i4;v.emplaceBack(-1,-1),v.emplaceBack(1,-1),v.emplaceBack(-1,1),v.emplaceBack(1,1),this.viewportBuffer=t.createVertexBuffer(v,c.posAttributes.members),this.viewportSegments=c.SegmentVector.simpleSegment(0,0,4,2);const b=new c.StructArrayLayout4i8;b.emplaceBack(0,0,0,0),b.emplaceBack(c.EXTENT,0,c.EXTENT,0),b.emplaceBack(0,c.EXTENT,0,c.EXTENT),b.emplaceBack(c.EXTENT,c.EXTENT,c.EXTENT,c.EXTENT),this.mercatorBoundsBuffer=t.createVertexBuffer(b,c.boundsAttributes.members),this.mercatorBoundsSegments=c.SegmentVector.simpleSegment(0,0,4,2);const D=new c.StructArrayLayout3ui6;D.emplaceBack(0,1,2),D.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=t.createIndexBuffer(D);const O=new c.StructArrayLayout1ui2;for(const H of[0,1,3,2,0])O.emplaceBack(H);this.debugIndexBuffer=t.createIndexBuffer(O),this.emptyTexture=new c.Texture(t,new c.RGBAImage({width:1,height:1},Uint8Array.of(0,0,0,0)),t.gl.RGBA),this.identityMat=c.create();const k=this.context.gl;this.stencilClearMode=new c.StencilMode({func:k.ALWAYS,mask:0},0,255,k.ZERO,k.ZERO,k.ZERO),this.loadTimeStamps.push(c.window.performance.now()),this.atmosphereBuffer=new Me(this.context)}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(t){return t._makeTileBoundsBuffers(this.context,this.transform.projection),t._tileBoundsBuffer?{tileBoundsBuffer:t._tileBoundsBuffer,tileBoundsIndexBuffer:t._tileBoundsIndexBuffer,tileBoundsSegments:t._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const t=this.context,s=t.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.useProgram("clippingMask").draw(t,s.TRIANGLES,c.DepthMode.disabled,this.stencilClearMode,c.ColorMode.disabled,c.CullFaceMode.disabled,zr(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(t,s,p){if(!s||this.currentStencilSource===s.id||!t.isTileClipped()||!p||0===p.length)return;if(this._tileClippingMaskIDs&&!this.terrain){let O=!1;for(const k of p)if(void 0===this._tileClippingMaskIDs[k.key]){O=!0;break}if(!O)return}this.currentStencilSource=s.id;const v=this.context,b=v.gl;this.nextStencilID+p.length>256&&this.clearStencil(),v.setColorMode(c.ColorMode.disabled),v.setDepthMode(c.DepthMode.disabled);const D=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const O of p){const k=s.getTile(O),H=this._tileClippingMaskIDs[O.key]=this.nextStencilID++,{tileBoundsBuffer:J,tileBoundsIndexBuffer:ue,tileBoundsSegments:De}=this.getTileBoundsBuffers(k);D.draw(v,b.TRIANGLES,c.DepthMode.disabled,new c.StencilMode({func:b.ALWAYS,mask:0},H,255,b.KEEP,b.KEEP,b.REPLACE),c.ColorMode.disabled,c.CullFaceMode.disabled,zr(O.projMatrix),"$clipping",J,ue,De)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const t=this.nextStencilID++,s=this.context.gl;return new c.StencilMode({func:s.NOTEQUAL,mask:255},t,255,s.KEEP,s.KEEP,s.REPLACE)}stencilModeForClipping(t){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(t);const s=this.context.gl;return new c.StencilMode({func:s.EQUAL,mask:255},this._tileClippingMaskIDs[t.key],0,s.KEEP,s.KEEP,s.REPLACE)}stencilConfigForOverlap(t){const s=this.context.gl,p=t.sort((D,O)=>O.overscaledZ-D.overscaledZ),v=p[p.length-1].overscaledZ,b=p[0].overscaledZ-v+1;if(b>1){this.currentStencilSource=void 0,this.nextStencilID+b>256&&this.clearStencil();const D={};for(let O=0;O<b;O++)D[O+v]=new c.StencilMode({func:s.GEQUAL,mask:255},O+this.nextStencilID,255,s.KEEP,s.KEEP,s.REPLACE);return this.nextStencilID+=b,[D,p]}return[{[v]:c.StencilMode.disabled},p]}colorModeForRenderPass(){const t=this.context.gl;return this._showOverdrawInspector?new c.ColorMode([t.CONSTANT_COLOR,t.ONE],new c.Color(.125,.125,.125,0),[!0,!0,!0,!0]):"opaque"===this.renderPass?c.ColorMode.unblended:c.ColorMode.alphaBlended}depthModeForSublayer(t,s,p){if(!this.opaquePassEnabledForLayer())return c.DepthMode.disabled;const v=1-((1+this.currentLayer)*this.numSublayers+t)*this.depthEpsilon;return new c.DepthMode(p||this.context.gl.LEQUAL,s,[v,v])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(t,s){this.style=t,this.options=s,this.imageManager=t.imageManager,this.glyphManager=t.glyphManager,this.symbolFadeChange=t.placement.symbolFadeChange(c.exported.now()),this.imageManager.beginFrame();const p=this.style.order,v=this.style._sourceCaches;for(const k in v){const H=v[k];H.used&&H.prepare(this.context)}const b={},D={},O={};for(const k in v){const H=v[k];b[k]=H.getVisibleCoordinates(),D[k]=b[k].slice().reverse(),O[k]=H.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let k=0;k<p.length;k++)if(this.style._layers[p[k]].is3D()){this.opaquePassCutoff=k;break}if(this.terrain&&(this.terrain.updateTileBinding(O),this.opaquePassCutoff=0),"globe"!==this.transform.projection.name||this.globeSharedBuffers||(this.globeSharedBuffers=new c.GlobeSharedBuffers(this.context)),c.isMapAuthenticated(this.context.gl)){this.renderPass="offscreen";for(const k of p){const H=this.style._layers[k],J=t._getLayerSourceCache(H);if(!H.hasOffscreenPass()||H.isHidden(this.transform.zoom))continue;const ue=J?D[J.id]:void 0;("custom"===H.type||H.isSky()||ue&&ue.length)&&this.renderLayer(this,J,H,ue)}if(this.depthRangeFor3D=[0,1-(t.order.length+2)*this.numSublayers*this.depthEpsilon],this.terrain&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&this.terrain.drawDepth(),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]),this.context.clear({color:s.showOverdrawInspector?c.Color.black:c.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=s.showOverdrawInspector,this.renderPass="opaque",!this.terrain)for(this.currentLayer=p.length-1;this.currentLayer>=0;this.currentLayer--){const k=this.style._layers[p[this.currentLayer]],H=t._getLayerSourceCache(k);if(k.isSky())continue;const J=H?D[H.id]:void 0;this._renderTileClippingMasks(k,H,J),this.renderLayer(this,H,k,J)}if(this.style.fog&&this.transform.projection.supportsFog&&function(k,H){const J=k.context,ue=J.gl,De=k.transform,je=new c.DepthMode(ue.LEQUAL,c.DepthMode.ReadOnly,[0,1]),ke=k.useProgram("globeAtmosphere",null,"globe"===De.projection.name?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"]),Ye=c.globeToMercatorTransition(De.zoom),$e=H.properties.get("color").toArray01(),Be=H.properties.get("high-color").toArray01(),Xe=H.properties.get("space-color").toArray01PremultipliedAlpha(),We=c.identity$1([]);c.rotateY$1(We,We,-c.degToRad(De._center.lng)),c.rotateX$1(We,We,c.degToRad(De._center.lat)),c.rotateZ$1(We,We,De.angle),c.rotateX$1(We,We,-De._pitch);const gt=c.fromQuat(new Float32Array(16),We),yt=c.mapValue(H.properties.get("star-intensity"),0,1,0,.25),It=c.mapValue(H.properties.get("horizon-blend"),0,1,5e-4,.25),Jt=c.globeUseCustomAntiAliasing(k,J,De)&&5e-4===It?De.worldSize/(2*Math.PI*1.025)-1:De.globeRadius,cn=k.frameCounter/1e3%1,Xt=c.length(De.globeCenterInViewSpace),An=Math.sqrt(Math.pow(Xt,2)-Math.pow(Jt,2)),Zt=Math.acos(An/Xt),bn={u_frustum_tl:De.frustumCorners.TL,u_frustum_tr:De.frustumCorners.TR,u_frustum_br:De.frustumCorners.BR,u_frustum_bl:De.frustumCorners.BL,u_horizon:De.frustumCorners.horizon,u_transition:Ye,u_fadeout_range:It,u_color:$e,u_high_color:Be,u_space_color:Xe,u_star_intensity:yt,u_star_size:5*c.exported.devicePixelRatio,u_star_density:0,u_temporal_offset:cn,u_horizon_angle:Zt,u_rotation_matrix:gt};k.prepareDrawProgram(J,ke);const yn=k.atmosphereBuffer;yn&&ke.draw(J,ue.TRIANGLES,je,c.StencilMode.disabled,c.ColorMode.alphaBlended,c.CullFaceMode.backCW,bn,"skybox",yn.vertexBuffer,yn.indexBuffer,yn.segments)}(this,this.style.fog),this.renderPass="sky",(c.globeToMercatorTransition(this.transform.zoom)>0||"globe"!==this.transform.projection.name)&&this.transform.isHorizonVisible())for(this.currentLayer=0;this.currentLayer<p.length;this.currentLayer++){const k=this.style._layers[p[this.currentLayer]],H=t._getLayerSourceCache(k);k.isSky()&&this.renderLayer(this,H,k,H?D[H.id]:void 0)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<p.length;){const k=this.style._layers[p[this.currentLayer]],H=t._getLayerSourceCache(k);if(k.isSky()){++this.currentLayer;continue}if(this.terrain&&this.style.isLayerDraped(k)){if(k.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer);continue}const J=H?("symbol"===k.type?O:D)[H.id]:void 0;this._renderTileClippingMasks(k,H,H?b[H.id]:void 0),this.renderLayer(this,H,k,J),++this.currentLayer}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let k=null;c.values(this.style._layers).forEach(H=>{const J=t._getLayerSourceCache(H);J&&!H.isHidden(this.transform.zoom)&&(!k||k.getSource().maxzoom<J.getSource().maxzoom)&&(k=J)}),k&&this.options.showTileBoundaries&&Tt.debug(this,k,k.getVisibleCoordinates())}this.options.showPadding&&function(k){const H=k.transform.padding;Ms(k,k.transform.height-(H.top||0),3,eo),Ms(k,H.bottom||0,3,Ds),Hl(k,H.left||0,3,Is),Hl(k,k.transform.width-(H.right||0),3,Ba);const J=k.transform.centerPoint;var ue,De,je,ke;ha(ue=k,(De=J.x)-1,(je=k.transform.height-J.y)-10,2,20,ke=za),ha(ue,De-10,je-1,20,2,ke)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(c.window.performance.now()),this.saveCanvasCopy())}}renderLayer(t,s,p,v){p.isHidden(this.transform.zoom)||("background"===p.type||"sky"===p.type||"custom"===p.type||v&&v.length)&&(this.id=p.id,this.gpuTimingStart(p),t.transform.projection.unsupportedLayers&&t.transform.projection.unsupportedLayers.includes(p.type)||Tt[p.type](t,s,p,v,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(t){if(!this.options.gpuTiming)return;const s=this.context.extTimerQuery;let p=this.gpuTimers[t.id];p||(p=this.gpuTimers[t.id]={calls:0,cpuTime:0,query:s.createQueryEXT()}),p.calls++,s.beginQueryEXT(s.TIME_ELAPSED_EXT,p.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const t=this.context.extTimerQuery,s=t.createQueryEXT();this.deferredRenderGpuTimeQueries.push(s),t.beginQueryEXT(t.TIME_ELAPSED_EXT,s)}}gpuTimingDeferredRenderEnd(){if(!this.options.gpuTimingDeferredRender)return;const t=this.context.extTimerQuery;t.endQueryEXT(t.TIME_ELAPSED_EXT)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const t=this.context.extTimerQuery;t.endQueryEXT(t.TIME_ELAPSED_EXT)}collectGpuTimers(){const t=this.gpuTimers;return this.gpuTimers={},t}collectDeferredRenderGpuQueries(){const t=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],t}queryGpuTimers(t){const s={};for(const p in t){const v=t[p],b=this.context.extTimerQuery,D=b.getQueryObjectEXT(v.query,b.QUERY_RESULT_EXT)/1e6;b.deleteQueryEXT(v.query),s[p]=D}return s}queryGpuTimeDeferredRender(t){if(!this.options.gpuTimingDeferredRender)return 0;const s=this.context.extTimerQuery;let p=0;for(const v of t)p+=s.getQueryObjectEXT(v,s.QUERY_RESULT_EXT)/1e6,s.deleteQueryEXT(v);return p}translatePosMatrix(t,s,p,v,b){if(!p[0]&&!p[1])return t;const D=b?"map"===v?this.transform.angle:0:"viewport"===v?-this.transform.angle:0;if(D){const H=Math.sin(D),J=Math.cos(D);p=[p[0]*J-p[1]*H,p[0]*H+p[1]*J]}const O=[b?p[0]:Pt(s,p[0],this.transform.zoom),b?p[1]:Pt(s,p[1],this.transform.zoom),0],k=new Float32Array(16);return c.translate(k,t,O),k}saveTileTexture(t){const s=this._tileTextures[t.size[0]];s?s.push(t):this._tileTextures[t.size[0]]=[t]}getTileTexture(t){const s=this._tileTextures[t];return s&&s.length>0?s.pop():null}isPatternMissing(t){if(!t)return!1;if(!t.from||!t.to)return!0;const s=this.imageManager.getPattern(t.from.toString()),p=this.imageManager.getPattern(t.to.toString());return!s||!p}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture}currentGlobalDefines(){const t=this.terrain&&this.terrain.renderingToTexture,s=this.style&&this.style.fog,p=[];return this.terrainRenderModeElevated()&&p.push("TERRAIN"),"globe"===this.transform.projection.name&&p.push("GLOBE"),s&&!t&&0!==s.getOpacity(this.transform.pitch)&&p.push("FOG"),t&&p.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&p.push("OVERDRAW_INSPECTOR"),p}useProgram(t,s,p){this.cache=this.cache||{};const v=p||[],b=this.currentGlobalDefines().concat(v),D=Ca.cacheKey(Ns[t],t,b,s);return this.cache[D]||(this.cache[D]=new Ca(this.context,t,Ns[t],s,I[t],b)),this.cache[D]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const t=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(t.FUNC_ADD)}initDebugOverlayCanvas(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=c.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new c.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this.atmosphereBuffer&&this.atmosphereBuffer.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}prepareDrawProgram(t,s,p){if(this.terrain&&this.terrain.renderingToTexture)return;const v=this.style.fog;if(v){const b=v.getOpacity(this.transform.pitch),D=((O,k,H,J,ue,De,je,ke,Ye,$e,Be)=>{const Xe=O.transform,We=k.properties.get("color").toArray01();We[3]=J;const gt=O.frameCounter/1e3%1;return{u_fog_matrix:H?Xe.calculateFogTileMatrix(H):O.identityMat,u_fog_range:k.getFovAdjustedRange(Xe._fov),u_fog_color:We,u_fog_horizon_blend:k.properties.get("horizon-blend"),u_fog_temporal_offset:gt,u_frustum_tl:ue,u_frustum_tr:De,u_frustum_br:je,u_frustum_bl:ke,u_globe_pos:Ye,u_globe_radius:$e,u_viewport:Be,u_globe_transition:c.globeToMercatorTransition(Xe.zoom),u_is_globe:+("globe"===Xe.projection.name)}})(this,v,p,b,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*c.exported.devicePixelRatio,this.transform.height*c.exported.devicePixelRatio]);s.setFogUniformValues(t,D)}}setTileLoadedFlag(t){this.tileLoaded=t}saveCanvasCopy(){this.frameCopies.push(this.canvasCopy()),this.tileLoaded=!1}canvasCopy(){const t=this.context.gl,s=t.createTexture();return t.bindTexture(t.TEXTURE_2D,s),t.copyTexImage2D(t.TEXTURE_2D,0,t.RGBA,0,0,t.drawingBufferWidth,t.drawingBufferHeight,0),s}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const t=this.style&&this.style.fog;return!!t&&0!==t.getOpacity(this.transform.pitch)}getBackgroundTiles(){const t=this._backgroundTiles,s=this._backgroundTiles={},p=this.transform.coveringTiles({tileSize:512});for(const v of p)s[v.key]=t[v.key]||new c.Tile(v,512,this.transform.tileZoom,this);return s}clearBackgroundTiles(){this._backgroundTiles={}}}class Tn{constructor(t=0,s=0,p=0,v=0){if(isNaN(t)||t<0||isNaN(s)||s<0||isNaN(p)||p<0||isNaN(v)||v<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=t,this.bottom=s,this.left=p,this.right=v}interpolate(t,s,p){return null!=s.top&&null!=t.top&&(this.top=c.number(t.top,s.top,p)),null!=s.bottom&&null!=t.bottom&&(this.bottom=c.number(t.bottom,s.bottom,p)),null!=s.left&&null!=t.left&&(this.left=c.number(t.left,s.left,p)),null!=s.right&&null!=t.right&&(this.right=c.number(t.right,s.right,p)),this}getCenter(t,s){const p=c.clamp((this.left+t-this.right)/2,0,t),v=c.clamp((this.top+s-this.bottom)/2,0,s);return new c.pointGeometry(p,v)}equals(t){return this.top===t.top&&this.bottom===t.bottom&&this.left===t.left&&this.right===t.right}clone(){return new Tn(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function li(l,t){const s=c.getColumn(l,3);c.fromQuat(l,t),c.setColumn(l,3,s)}function sr(l,t){const s=c.identity$1([]);return c.rotateZ$1(s,s,-t),c.rotateX$1(s,s,-l),s}function nr(l,t){const s=[l[0],l[1],0],p=[t[0],t[1],0];if(c.length(s)>=1e-15){const D=c.normalize([],s);c.scale$2(p,D,c.dot(p,D)),t[0]=p[0],t[1]=p[1]}const v=c.cross([],t,l);if(c.len(v)<1e-15)return null;const b=Math.atan2(-v[1],v[0]);return sr(Math.atan2(Math.sqrt(l[0]*l[0]+l[1]*l[1]),-l[2]),b)}class dr{constructor(t,s){this.position=t,this.orientation=s}get position(){return this._position}set position(t){if(t){const s=t instanceof c.MercatorCoordinate?t:new c.MercatorCoordinate(t[0],t[1],t[2]);this._renderWorldCopies&&(s.x=c.wrap(s.x,0,1)),this._position=s}else this._position=null}lookAtPoint(t,s){if(this.orientation=null,!this.position)return;const p=this._elevation?this._elevation.getAtPointOrZero(c.MercatorCoordinate.fromLngLat(t)):0,v=this.position,b=c.MercatorCoordinate.fromLngLat(t,p),D=[b.x-v.x,b.y-v.y,b.z-v.z];s||(s=[0,0,1]),s[2]=Math.abs(s[2]),this.orientation=nr(D,s)}setPitchBearing(t,s){this.orientation=sr(c.degToRad(t),c.degToRad(-s))}}class Wi{constructor(t,s){this._transform=c.identity([]),this.orientation=s,this.position=t}get mercatorPosition(){const t=this.position;return new c.MercatorCoordinate(t[0],t[1],t[2])}get position(){const t=c.getColumn(this._transform,3);return[t[0],t[1],t[2]]}set position(t){var s;t&&c.setColumn(this._transform,3,[(s=t)[0],s[1],s[2],1])}get orientation(){return this._orientation}set orientation(t){this._orientation=t||c.identity$1([]),t&&li(this._transform,this._orientation)}getPitchBearing(){const t=this.forward(),s=this.right();return{bearing:Math.atan2(-s[1],s[0]),pitch:Math.atan2(Math.sqrt(t[0]*t[0]+t[1]*t[1]),-t[2])}}setPitchBearing(t,s){this._orientation=sr(t,s),li(this._transform,this._orientation)}forward(){const t=c.getColumn(this._transform,2);return[-t[0],-t[1],-t[2]]}up(){const t=c.getColumn(this._transform,1);return[-t[0],-t[1],-t[2]]}right(){const t=c.getColumn(this._transform,0);return[t[0],t[1],t[2]]}getCameraToWorld(t,s){const p=new Float64Array(16);return c.invert(p,this.getWorldToCamera(t,s)),p}getWorldToCameraPosition(t,s,p){const v=this.position;c.scale$2(v,v,-t);const b=new Float64Array(16);return c.fromScaling(b,[p,p,p]),c.translate(b,b,v),b[10]*=s,b}getWorldToCamera(t,s){const p=new Float64Array(16),v=new Float64Array(4),b=this.position;return c.conjugate(v,this._orientation),c.scale$2(b,b,-t),c.fromQuat(p,v),c.translate(p,p,b),p[1]*=-1,p[5]*=-1,p[9]*=-1,p[13]*=-1,p[8]*=s,p[9]*=s,p[10]*=s,p[11]*=s,p}getCameraToClipPerspective(t,s,p,v){const b=new Float64Array(16);return c.perspective(b,t,s,p,v),b}getDistanceToElevation(t){const s=0===t?0:c.mercatorZfromAltitude(t,this.position[1]),p=this.forward();return(s-this.position[2])/p[2]}clone(){return new Wi([...this.position],[...this.orientation])}}function Sr(l,t){const s=to(l.projection,l.zoom,l.width,l.height),p=function(b,D,O,k,H){const J=new c.LngLat(O.lng-180*jo,O.lat),ue=new c.LngLat(O.lng+180*jo,O.lat),De=b.project(J.lng,J.lat),je=b.project(ue.lng,ue.lat),ke=-Math.atan2(je.y-De.y,je.x-De.x),Ye=c.MercatorCoordinate.fromLngLat(O);Ye.y=c.clamp(Ye.y,-.999975,.999975);const $e=Ye.toLngLat(),Be=b.project($e.lng,$e.lat),Xe=c.MercatorCoordinate.fromLngLat($e);Xe.x+=jo;const We=Xe.toLngLat(),gt=b.project(We.lng,We.lat),yt=Gn(gt.x-Be.x,gt.y-Be.y,ke),ot=c.MercatorCoordinate.fromLngLat($e);ot.y+=jo;const It=ot.toLngLat(),Jt=b.project(It.lng,It.lat),cn=Gn(Jt.x-Be.x,Jt.y-Be.y,ke),Xt=Math.abs(yt.x)/Math.abs(cn.y),An=c.identity([]);c.rotateZ(An,An,-ke*(1-(H?0:k)));const Zt=c.identity([]);return c.scale(Zt,Zt,[1,1-(1-Xt)*k,1]),Zt[4]=-cn.x/cn.y*k,c.rotateZ(Zt,Zt,ke),c.multiply(Zt,An,Zt),Zt}(l.projection,0,l.center,s,t),v=gr(l);return c.scale(p,p,[v,v,1]),p}function gr(l){const t=l.projection,s=to(l.projection,l.zoom,l.width,l.height),p=Oo(t,l.center),v=Oo(t,c.LngLat.convert(t.center));return Math.pow(2,p*s+(1-s)*v)}function to(l,t,s,p,v=1/0){const b=l.range;if(!b)return 0;const D=Math.min(v,Math.max(s,p)),O=Math.log(D/1024)/Math.LN2;return c.smoothstep(b[0]+O,b[1]+O,t)}const jo=1/4e4;function Oo(l,t){const s=c.clamp(t.lat,-c.MAX_MERCATOR_LATITUDE,c.MAX_MERCATOR_LATITUDE),p=new c.LngLat(t.lng-180*jo,s),v=new c.LngLat(t.lng+180*jo,s),b=l.project(p.lng,s),D=l.project(v.lng,s),O=c.MercatorCoordinate.fromLngLat(p),k=c.MercatorCoordinate.fromLngLat(v),H=D.x-b.x,J=D.y-b.y,ue=k.x-O.x,De=k.y-O.y,je=Math.sqrt((ue*ue+De*De)/(H*H+J*J));return Math.log(je)/Math.LN2}function Gn(l,t,s){const p=Math.cos(s),v=Math.sin(s);return{x:l*p-t*v,y:l*v+t*p}}class ho{constructor(t,s,p,v,b,D,O){this.tileSize=512,this._renderWorldCopies=void 0===b||b,this._minZoom=t||0,this._maxZoom=s||22,this._minPitch=p??0,this._maxPitch=v??60,this.setProjection(D),this.setMaxBounds(O),this.width=0,this.height=0,this._center=new c.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new Tn,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._distanceTileDataCache={},this._camera=new Wi,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._horizonShift=.1}clone(){const t=new ho(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return t._elevation=this._elevation,t._centerAltitude=this._centerAltitude,t._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,t.tileSize=this.tileSize,t.mercatorFromTransition=this.mercatorFromTransition,t.width=this.width,t.height=this.height,t.cameraElevationReference=this.cameraElevationReference,t._center=this._center,t._setZoom(this.zoom),t._seaLevelZoom=this._seaLevelZoom,t.angle=this.angle,t._fov=this._fov,t._pitch=this._pitch,t._nearZ=this._nearZ,t._farZ=this._farZ,t._averageElevation=this._averageElevation,t._unmodified=this._unmodified,t._edgeInsets=this._edgeInsets.clone(),t._camera=this._camera.clone(),t._calcMatrices(),t.freezeTileCoverage=this.freezeTileCoverage,t.frustumCorners=this.frustumCorners,t}get elevation(){return this._elevation}set elevation(t){this._elevation!==t&&(this._elevation=t,this._updateCameraOnTerrain(),this._calcMatrices())}updateElevation(t){const s=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(null==this._seaLevelZoom||s)&&this._updateCameraOnTerrain(),(t||s)&&this._constrainCameraAltitude(),this._calcMatrices()}getProjection(){return c.pick(this.projection,["name","center","parallels"])}setProjection(t){this.projectionOptions=t||{name:"mercator"};const s=this.projection?this.getProjection():void 0;this.projection=c.getProjection(this.projectionOptions);const p=!Y(s,this.getProjection());return p&&this._calcMatrices(),this.mercatorFromTransition=!1,p}setMercatorFromTransition(){const t=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=c.getProjection({name:"mercator"});const s=t!==this.projection.name;return s&&this._calcMatrices(),s}get minZoom(){return this._minZoom}set minZoom(t){this._minZoom!==t&&(this._minZoom=t,this.zoom=Math.max(this.zoom,t))}get maxZoom(){return this._maxZoom}set maxZoom(t){this._maxZoom!==t&&(this._maxZoom=t,this.zoom=Math.min(this.zoom,t))}get minPitch(){return this._minPitch}set minPitch(t){this._minPitch!==t&&(this._minPitch=t,this.pitch=Math.max(this.pitch,t))}get maxPitch(){return this._maxPitch}set maxPitch(t){this._maxPitch!==t&&(this._maxPitch=t,this.pitch=Math.min(this.pitch,t))}get renderWorldCopies(){return this._renderWorldCopies&&!0===this.projection.supportsWorldCopies}set renderWorldCopies(t){void 0===t?t=!0:null===t&&(t=!1),this._renderWorldCopies=t}get worldSize(){return this.tileSize*this.scale}get cameraWorldSize(){const t=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(t))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return c.mercatorZfromAltitude(this.center.lat,this.cameraWorldSize)}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new c.pointGeometry(this.width,this.height)}get bearing(){return c.wrap(this.rotation,-180,180)}set bearing(t){this.rotation=t}get rotation(){return-this.angle/Math.PI*180}set rotation(t){const s=-t*Math.PI/180;var p,v,b,D,O,k,H,J,ue,De;this.angle!==s&&(this._unmodified=!1,this.angle=s,this._calcMatrices(),this.rotationMatrix=(p=new c.ARRAY_TYPE(4),c.ARRAY_TYPE!=Float32Array&&(p[1]=0,p[2]=0),p[0]=1,p[3]=1,p),v=this.rotationMatrix,D=this.angle,O=(b=this.rotationMatrix)[0],k=b[1],H=b[2],J=b[3],ue=Math.sin(D),De=Math.cos(D),v[0]=O*De+H*ue,v[1]=k*De+J*ue,v[2]=O*-ue+H*De,v[3]=k*-ue+J*De)}get pitch(){return this._pitch/Math.PI*180}set pitch(t){const s=c.clamp(t,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==s&&(this._unmodified=!1,this._pitch=s,this._calcMatrices())}get aspect(){return this.width/this.height}get fovX(){return this._fov}get fovY(){const t=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/t)}set fov(t){t=Math.max(.01,Math.min(60,t)),this._fov!==t&&(this._unmodified=!1,this._fov=c.degToRad(t),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(t){this._averageElevation=t,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(t){const s=Math.min(Math.max(t,this.minZoom),this.maxZoom);this._zoom!==s&&(this._unmodified=!1,this._setZoom(s),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(t){this._zoom=t,this.scale=this.zoomScale(t),this.tileZoom=Math.floor(t),this.zoomFraction=t-this.tileZoom}_updateCameraOnTerrain(){if(!this._elevation||!this._elevation.isDataAvailableAtPoint(this.locationCoordinate(this.center)))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const t=this._elevation;this._centerAltitude=t.getAtPointOrZero(this.locationCoordinate(this.center)),this._centerAltitudeValidForExaggeration=t.exaggeration(),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){void 0!==this._centerAltitudeValidForExaggeration&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const t=this._elevation,s=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],p=this.horizonLineFromTop();let v=0,b=0;for(let D=0;D<s.length;D++){const O=new c.pointGeometry(s[D][0]*this.width,p+s[D][1]*(this.height-p)),k=t.pointCoordinate(O);if(!k)continue;const H=1/Math.hypot(k[0]-this._camera.position[0],k[1]-this._camera.position[1]);v+=k[3]*H,b+=H}return 0===b?NaN:v/b}get center(){return this._center}set center(t){t.lat===this._center.lat&&t.lng===this._center.lng||(this._unmodified=!1,this._center=t,this._terrainEnabled()&&("ground"===this.cameraElevationReference?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(null==this._seaLevelZoom||!this._elevation)return;const t=this._seaLevelZoom,s=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),p=this.pixelsPerMeter/this.worldSize*s,v=this._mercatorZfromZoom(t),b=this._mercatorZfromZoom(this._maxZoom),D=Math.max(v-p,b);this._setZoom(this._zoomFromMercatorZ(D))}get padding(){return this._edgeInsets.toJSON()}set padding(t){this._edgeInsets.equals(t)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,t,1),this._calcMatrices())}computeZoomRelativeTo(t){const s=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,t.toAltitude()));let p;p=t.z<this._camera.position[2]?[s.x,s.y,s.z]:[t.x,t.y,t.z];const v=c.length(c.sub([],this._camera.position,p));return c.clamp(this._zoomFromMercatorZ(v),this._minZoom,this._maxZoom)}setFreeCameraOptions(t){if(!this.height||!t.position&&!t.orientation)return;this._updateCameraState();let s=!1;if(t.orientation&&!c.exactEquals(t.orientation,this._camera.orientation)&&(s=this._setCameraOrientation(t.orientation)),t.position){const p=[t.position.x,t.position.y,t.position.z];c.exactEquals$1(p,this._camera.position)||(this._setCameraPosition(p),s=!0)}s&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const t=this._camera.position,s=new dr;return s.position=new c.MercatorCoordinate(t[0],t[1],t[2]),s.orientation=this._camera.orientation,s._elevation=this.elevation,s._renderWorldCopies=this.renderWorldCopies,s}_setCameraOrientation(t){if(!c.length$1(t))return!1;c.normalize$1(t,t);const s=c.transformQuat([],[0,0,-1],t),p=c.transformQuat([],[0,-1,0],t);if(p[2]<0)return!1;const v=nr(s,p);return!!v&&(this._camera.orientation=v,!0)}_setCameraPosition(t){const s=this.zoomScale(this.minZoom)*this.tileSize,p=this.zoomScale(this.maxZoom)*this.tileSize,v=this.cameraToCenterDistance;t[2]=c.clamp(t[2],v/p,v/s),this._camera.position=t}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(t){return this._edgeInsets.equals(t)}interpolatePadding(t,s,p){this._unmodified=!1,this._edgeInsets.interpolate(t,s,p),this._constrain(),this._calcMatrices()}coveringZoomLevel(t){const s=(t.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/t.tileSize));return Math.max(0,s)}getVisibleUnwrappedCoordinates(t){const s=[new c.UnwrappedTileID(0,t)];if(this.renderWorldCopies){const p=this.pointCoordinate(new c.pointGeometry(0,0)),v=this.pointCoordinate(new c.pointGeometry(this.width,0)),b=this.pointCoordinate(new c.pointGeometry(this.width,this.height)),D=this.pointCoordinate(new c.pointGeometry(0,this.height)),O=Math.floor(Math.min(p.x,v.x,b.x,D.x)),k=Math.floor(Math.max(p.x,v.x,b.x,D.x)),H=1;for(let J=O-H;J<=k+H;J++)0!==J&&s.push(new c.UnwrappedTileID(J,t))}return s}coveringTiles(t){let s=this.coveringZoomLevel(t);const p=s,v=this.elevation&&!t.isTerrainDEM,b="mercator"===this.projection.name;if(void 0!==t.minzoom&&s<t.minzoom)return[];void 0!==t.maxzoom&&s>t.maxzoom&&(s=t.maxzoom);const D=this.locationCoordinate(this.center),O=this.center.lat,k=1<<s,H=[k*D.x,k*D.y,0],J="globe"===this.projection.name,ue=!J,De=c.Frustum.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,s,ue),je=J?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),ke=k*c.mercatorZfromAltitude(1,this.center.lat),Ye=this._camera.position[2]/c.mercatorZfromAltitude(1,this.center.lat),$e=[k*je.x,k*je.y,Ye*(ue?1:ke)],Be=this.cameraToCenterDistance/t.tileSize*(t.roundZoom?1:.502),Xe=this.pitch<=60&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace?s:0,We=t.isTerrainDEM&&this._elevation?1e4*this._elevation.exaggeration():this._centerAltitude,gt=t.isTerrainDEM?-We:this._elevation?this._elevation.getMinElevationBelowMSL():0,yt=this.projection.isReprojectedInTileSpace?gr(this):1,ot=Nt=>{const zn=new c.MercatorCoordinate(Nt.x+25e-6,Nt.y,Nt.z),jn=new c.MercatorCoordinate(Nt.x,Nt.y+25e-6,Nt.z),Bn=Nt.toLngLat(),si=zn.toLngLat(),Di=jn.toLngLat(),yi=this.locationCoordinate(Bn),pi=this.locationCoordinate(si),Nn=this.locationCoordinate(Di),Ri=Math.hypot(pi.x-yi.x,pi.y-yi.y),$i=Math.hypot(Nn.x-yi.x,Nn.y-yi.y);return Math.sqrt(Ri*$i)*yt/25e-6},It=Nt=>{const qn=We,zn=gt;return{aabb:c.tileAABB(this,k,0,0,0,Nt,zn,qn,this.projection),zoom:0,x:0,y:0,minZ:zn,maxZ:qn,wrap:Nt,fullyVisible:!1}},Jt=[];let cn=[];const Xt=s,An=t.reparseOverscaled?p:s,Zt=Nt=>Nt*Nt,bn=Zt((Ye-this._centerAltitude)*ke),yn=Nt=>{if(!this._elevation||!Nt.tileID||!b)return;const qn=this._elevation.getMinMaxForTile(Nt.tileID),zn=Nt.aabb;qn?(zn.min[2]=qn.min,zn.max[2]=qn.max,zn.center[2]=(zn.min[2]+zn.max[2])/2):(Nt.shouldSplit=Kt(Nt),Nt.shouldSplit||(zn.min[2]=zn.max[2]=zn.center[2]=this._centerAltitude))},Kt=Nt=>{if(Nt.zoom<Xe)return!0;if(Nt.zoom===Xt)return!1;if(null!=Nt.shouldSplit)return Nt.shouldSplit;const qn=Nt.aabb.distanceX($e),zn=Nt.aabb.distanceY($e);let jn=bn,Bn=1;if(J){jn=Zt(Nt.aabb.distanceZ($e));const yi=Math.pow(2,Nt.zoom),pi=c.latFromMercatorY((Nt.y+1)/yi),Nn=c.latFromMercatorY(Nt.y/yi),Ri=Math.min(Math.max(O,pi),Nn),$i=c.circumferenceAtLatitude(Ri)/c.circumferenceAtLatitude(O);if(Bn=Ri===O?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,$i/this._mercatorScaleRatio),this.zoom<=c.GLOBE_ZOOM_THRESHOLD_MIN&&Nt.zoom===Xt-1&&$i>=.9)return!0}else if(v&&(jn=Zt(Nt.aabb.distanceZ($e)*ke)),this.projection.isReprojectedInTileSpace&&p<=5){const yi=Math.pow(2,Nt.zoom),pi=ot(new c.MercatorCoordinate((Nt.x+.5)/yi,(Nt.y+.5)/yi));Bn=pi>.85?1:pi}const si=qn*qn+zn*zn+jn;return si<Zt((1<<Xt-Nt.zoom)*Be*Bn*((yi,pi)=>{if(pi*Zt(.707)<yi)return 1;const Nn=Math.sqrt(pi/yi);return Nn/(1.4144271570014144+(Math.pow(1.1,Nn-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(jn,bn),si))};if(this.renderWorldCopies)for(let Nt=1;Nt<=3;Nt++)Jt.push(It(-Nt)),Jt.push(It(Nt));for(Jt.push(It(0));Jt.length>0;){const Nt=Jt.pop(),qn=Nt.x,zn=Nt.y;let jn=Nt.fullyVisible;if(!jn){const Bn=Nt.aabb.intersects(De);if(0===Bn)continue;jn=2===Bn}if(Nt.zoom!==Xt&&Kt(Nt))for(let Bn=0;Bn<4;Bn++){const si=(qn<<1)+Bn%2,Di=(zn<<1)+(Bn>>1),yi={aabb:b?Nt.aabb.quadrant(Bn):c.tileAABB(this,k,Nt.zoom+1,si,Di,Nt.wrap,Nt.minZ,Nt.maxZ,this.projection),zoom:Nt.zoom+1,x:si,y:Di,wrap:Nt.wrap,fullyVisible:jn,tileID:void 0,shouldSplit:void 0,minZ:Nt.minZ,maxZ:Nt.maxZ};v&&!J&&(yi.tileID=new c.OverscaledTileID(Nt.zoom+1===Xt?An:Nt.zoom+1,Nt.wrap,Nt.zoom+1,si,Di),yn(yi)),Jt.push(yi)}else{const Bn=Nt.zoom===Xt?An:Nt.zoom;if(t.minzoom&&t.minzoom>Bn)continue;const si=H[0]-(.5+qn+(Nt.wrap<<Nt.zoom))*(1<<s-Nt.zoom),Di=H[1]-.5-zn,yi=Nt.tileID?Nt.tileID:new c.OverscaledTileID(Bn,Nt.wrap,Nt.zoom,qn,zn);cn.push({tileID:yi,distanceSq:si*si+Di*Di})}}if(this.fogCullDistSq){const Nt=this.fogCullDistSq,qn=this.horizonLineFromTop();cn=cn.filter(zn=>{const jn=[0,0,0,1],Bn=[c.EXTENT,c.EXTENT,0,1],si=this.calculateFogTileMatrix(zn.tileID.toUnwrapped());c.transformMat4$1(jn,jn,si),c.transformMat4$1(Bn,Bn,si);const Di=c.getAABBPointSquareDist(jn,Bn);if(0===Di)return!0;let yi=!1;const pi=this._elevation;if(pi&&Di>Nt&&0!==qn){const Nn=this.calculateProjMatrix(zn.tileID.toUnwrapped());let Ri;t.isTerrainDEM||(Ri=pi.getMinMaxForTile(zn.tileID)),Ri||(Ri={min:gt,max:We});const $i=c.furthestTileCorner(this.rotation),Lr=[$i[0]*c.EXTENT,$i[1]*c.EXTENT,Ri.max];c.transformMat4(Lr,Lr,Nn),yi=(1-Lr[1])*this.height*.5<qn}return Di<Nt||yi})}return cn.sort((Nt,qn)=>Nt.distanceSq-qn.distanceSq).map(Nt=>Nt.tileID)}resize(t,s){this.width=t,this.height=s,this.pixelsToGLUnits=[2/t,-2/s],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(t){return Math.pow(2,t)}scaleZoom(t){return Math.log(t)/Math.LN2}project(t){const s=c.clamp(t.lat,-c.MAX_MERCATOR_LATITUDE,c.MAX_MERCATOR_LATITUDE),p=this.projection.project(t.lng,s);return new c.pointGeometry(p.x*this.worldSize,p.y*this.worldSize)}unproject(t){return this.projection.unproject(t.x/this.worldSize,t.y/this.worldSize)}get point(){return this.project(this.center)}setLocationAtPoint(t,s){let p,v;const b=this.centerPoint;if("globe"===this.projection.name){const O=this.worldSize;p=(s.x-b.x)/O,v=(s.y-b.y)/O}else{const O=this.pointCoordinate(s),k=this.pointCoordinate(b);p=O.x-k.x,v=O.y-k.y}const D=this.locationCoordinate(t);this.setLocation(new c.MercatorCoordinate(D.x-p,D.y-v))}setLocation(t){this.center=this.coordinateLocation(t),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(t){return this.projection.locationPoint(this,t)}locationPoint3D(t){return this.projection.locationPoint(this,t,!0)}pointLocation(t){return this.coordinateLocation(this.pointCoordinate(t))}pointLocation3D(t){return this.coordinateLocation(this.pointCoordinate3D(t))}locationCoordinate(t,s){const p=s?c.mercatorZfromAltitude(s,t.lat):void 0,v=this.projection.project(t.lng,t.lat);return new c.MercatorCoordinate(v.x,v.y,p)}coordinateLocation(t){return this.projection.unproject(t.x,t.y)}pointRayIntersection(t,s){const p=s??this._centerAltitude,v=[t.x,t.y,0,1],b=[t.x,t.y,1,1];c.transformMat4$1(v,v,this.pixelMatrixInverse),c.transformMat4$1(b,b,this.pixelMatrixInverse);const D=b[3];c.scale$1(v,v,1/v[3]),c.scale$1(b,b,1/D);const O=v[2],k=b[2];return{p0:v,p1:b,t:O===k?0:(p-O)/(k-O)}}screenPointToMercatorRay(t){const s=[t.x,t.y,0,1],p=[t.x,t.y,1,1];return c.transformMat4$1(s,s,this.pixelMatrixInverse),c.transformMat4$1(p,p,this.pixelMatrixInverse),c.scale$1(s,s,1/s[3]),c.scale$1(p,p,1/p[3]),s[2]=c.mercatorZfromAltitude(s[2],this._center.lat)*this.worldSize,p[2]=c.mercatorZfromAltitude(p[2],this._center.lat)*this.worldSize,c.scale$1(s,s,1/this.worldSize),c.scale$1(p,p,1/this.worldSize),new c.Ray([s[0],s[1],s[2]],c.normalize([],c.sub([],p,s)))}rayIntersectionCoordinate(t){const{p0:s,p1:p,t:v}=t,b=c.mercatorZfromAltitude(s[2],this._center.lat),D=c.mercatorZfromAltitude(p[2],this._center.lat);return new c.MercatorCoordinate(c.number(s[0],p[0],v)/this.worldSize,c.number(s[1],p[1],v)/this.worldSize,c.number(b,D,v))}pointCoordinate(t,s=this._centerAltitude){return this.projection.pointCoordinate(this,t.x,t.y,s)}pointCoordinate3D(t){if(!this.elevation)return this.pointCoordinate(t);let s=this.projection.pointCoordinate3D(this,t.x,t.y);if(s)return new c.MercatorCoordinate(s[0],s[1],s[2]);let p=0,v=this.horizonLineFromTop();if(t.y>v)return this.pointCoordinate(t);const b=.02*v,D=t.clone();for(let O=0;O<10&&v-p>b;O++){D.y=c.number(p,v,.66);const k=this.projection.pointCoordinate3D(this,D.x,D.y);k?(v=D.y,s=k):p=D.y}return s?new c.MercatorCoordinate(s[0],s[1],s[2]):this.pointCoordinate(t)}isPointAboveHorizon(t){return this.projection.isPointAboveHorizon(this,t)}_coordinatePoint(t,s){const p=s&&this.elevation?this.elevation.getAtPointOrZero(t,this._centerAltitude):this._centerAltitude,v=[t.x*this.worldSize,t.y*this.worldSize,p+t.toAltitude(),1];return c.transformMat4$1(v,v,this.pixelMatrix),v[3]>0?new c.pointGeometry(v[0]/v[3],v[1]/v[3]):new c.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE)}_getGlobeBounds(){const{top:t,left:s}=this._edgeInsets,p=this.height-this._edgeInsets.bottom,v=this.width-this._edgeInsets.right,b=this.pointCoordinate3D(new c.pointGeometry(s,t)),D=this.pointCoordinate3D(new c.pointGeometry(v,t)),O=this.pointCoordinate3D(new c.pointGeometry(v,p)),k=this.pointCoordinate3D(new c.pointGeometry(s,p));let H=Math.min(b.x,k.x),J=Math.max(D.x,O.x),ue=Math.min(b.y,D.y),De=Math.max(k.y,O.y);const je=Math.pow(2,-this.zoom)/16,ke=(Be,Xe,We,gt)=>{const yt=(Be+We)/2,ot=(Xe+gt)/2,It=new c.pointGeometry(yt,ot),Jt=this.pointCoordinate3D(It),cn=Math.max(0,H-Jt.x,ue-Jt.y,Jt.x-J,Jt.y-De);H=Math.min(H,Jt.x),J=Math.max(J,Jt.x),ue=Math.min(ue,Jt.y),De=Math.max(De,Jt.y),cn>je&&(ke(Be,Xe,yt,ot),ke(yt,ot,We,gt))};ke(s,t,v,t),ke(v,t,v,p),ke(v,p,s,p),ke(s,p,s,t);const Ye=new c.LngLat(c.lngFromMercatorX(J),c.latFromMercatorY(ue)),$e=new c.LngLat(c.lngFromMercatorX(H),c.latFromMercatorY(De));return new c.LngLatBounds($e,Ye)}_getBounds(t,s){if("globe"===this.projection.name)return this._getGlobeBounds();const p=new c.pointGeometry(this._edgeInsets.left,this._edgeInsets.top),v=new c.pointGeometry(this.width-this._edgeInsets.right,this._edgeInsets.top),b=new c.pointGeometry(this.width-this._edgeInsets.right,this.height-this._edgeInsets.bottom),D=new c.pointGeometry(this._edgeInsets.left,this.height-this._edgeInsets.bottom);let O=this.pointCoordinate(p,t),k=this.pointCoordinate(v,t);const H=this.pointCoordinate(b,s),J=this.pointCoordinate(D,s),ue=(De,je)=>(je.y-De.y)/(je.x-De.x);return O.y>1&&k.y>=0?O=new c.MercatorCoordinate((1-J.y)/ue(J,O)+J.x,1):O.y<0&&k.y<=1&&(O=new c.MercatorCoordinate(-J.y/ue(J,O)+J.x,0)),k.y>1&&O.y>=0?k=new c.MercatorCoordinate((1-H.y)/ue(H,k)+H.x,1):k.y<0&&O.y<=1&&(k=new c.MercatorCoordinate(-H.y/ue(H,k)+H.x,0)),(new c.LngLatBounds).extend(this.coordinateLocation(O)).extend(this.coordinateLocation(k)).extend(this.coordinateLocation(J)).extend(this.coordinateLocation(H))}_getBounds3D(){const t=this.elevation;if(!t.visibleDemTiles.length||t.isUsingMockSource())return this._getBounds(0,0);const s=t.visibleDemTiles.reduce((p,v)=>{if(v.dem){const b=v.dem.tree;p.min=Math.min(p.min,b.minimums[0]),p.max=Math.max(p.max,b.maximums[0])}return p},{min:Number.MAX_VALUE,max:0});return this._getBounds(s.min*t.exaggeration(),s.max*t.exaggeration())}getBounds(){return this._terrainEnabled()?this._getBounds3D():this._getBounds(0,0)}horizonLineFromTop(t=!0){const s=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))+this.centerOffset.y,p=this.height/2-s*(1-this._horizonShift);return t?Math.max(0,p):p}getMaxBounds(){return this.maxBounds}setMaxBounds(t){this.maxBounds=t,this.minLat=-c.MAX_MERCATOR_LATITUDE,this.maxLat=c.MAX_MERCATOR_LATITUDE,this.minLng=-180,this.maxLng=180,t&&(this.minLat=t.getSouth(),this.maxLat=t.getNorth(),this.minLng=t.getWest(),this.maxLng=t.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=c.mercatorXfromLng(this.minLng)*this.tileSize,this.worldMaxX=c.mercatorXfromLng(this.maxLng)*this.tileSize,this.worldMinY=c.mercatorYfromLat(this.maxLat)*this.tileSize,this.worldMaxY=c.mercatorYfromLat(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(t,s){return this.projection.createTileMatrix(this,s,t)}calculateDistanceTileData(t){const s=t.key,p=this._distanceTileDataCache;if(p[s])return p[s];const v=t.canonical,b=1/this.height,D=this.cameraWorldSize/this.zoomScale(v.z),O=(v.x+Math.pow(2,v.z)*t.wrap)*D,k=v.y*D,H=this.point,J=this.angle,ue=Math.sin(-J),De=-Math.cos(-J);return p[s]={bearing:[ue,De],center:[(H.x-O)*b,(H.y-k)*b],scale:D/c.EXTENT*b},p[s]}calculateFogTileMatrix(t){const s=t.key,p=this._fogTileMatrixCache;if(p[s])return p[s];const v=this.projection.createTileMatrix(this,this.cameraWorldSize,t);return c.multiply(v,this.worldToFogMatrix,v),p[s]=new Float32Array(v),p[s]}calculateProjMatrix(t,s=!1){const p=t.key,v=s?this._alignedProjMatrixCache:this._projMatrixCache;if(v[p])return v[p];const b=this.calculatePosMatrix(t,this.worldSize);return c.multiply(b,this.projection.isReprojectedInTileSpace?this.mercatorMatrix:s?this.alignedProjMatrix:this.projMatrix,b),v[p]=new Float32Array(b),v[p]}calculatePixelsToTileUnitsMatrix(t){const s=t.tileID.key,p=this._pixelsToTileUnitsCache;if(p[s])return p[s];const v=function(b,D){const{scale:O}=b.tileTransform,k=O*c.EXTENT/(b.tileSize*Math.pow(2,D.zoom-b.tileID.overscaledZ+b.tileID.canonical.z));return H=new Float32Array(4),De=(J=D.inverseAdjustmentMatrix)[1],je=J[2],ke=J[3],$e=(ue=[k,k])[1],H[0]=J[0]*(Ye=ue[0]),H[1]=De*Ye,H[2]=je*$e,H[3]=ke*$e,H;var H,J,ue,De,je,ke,Ye,$e}(t,this);return p[s]=v,p[s]}customLayerMatrix(){return this.mercatorMatrix.slice()}recenterOnTerrain(){if(!this._elevation||"globe"===this.projection.name)return;const t=this._elevation;this._updateCameraState();const s=c.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,p=this._computeCameraPosition(s),v=this._camera.forward(),b=c.mercatorZfromAltitude(1,this._center.lat);p[2]/=b,v[2]/=b,c.normalize(v,v);const D=t.raycast(p,v,t.exaggeration());if(D){const O=c.scaleAndAdd([],p,v,D),k=new c.MercatorCoordinate(O[0],O[1],c.mercatorZfromAltitude(O[2],c.latFromMercatorY(O[1]))),H=(k.z+c.length([k.x-p[0],k.y-p[1],k.z-p[2]*b]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(H),this._centerAltitude=k.toAltitude(),this._center=this.coordinateLocation(k),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCameraAltitude(){if(!this._elevation)return;const t=this._elevation;this._updateCameraState();const s=c.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,p=this._computeCameraPosition(s),v=t.getAtPointOrZero(new c.MercatorCoordinate(...p)),b=this._minimumHeightOverTerrain()*Math.cos(c.degToRad(this._maxPitch)),D=this._camera.position[2]-this.pixelsPerMeter/this.worldSize*v;if(D<b){const O=this.locationCoordinate(this._center,this._centerAltitude),k=[O.x-p[0],O.y-p[1],O.z-p[2]],H=c.length(k);k[2]-=(b-D)/this._pixelsPerMercatorPixel;const J=c.length(k);if(0===J)return;c.scale$2(k,k,H/J*this._pixelsPerMercatorPixel),this._camera.position=[O.x-k[0],O.y-k[1],O.z*this._pixelsPerMercatorPixel-k[2]],this._camera.orientation=nr(k,this._camera.up()),this._updateStateFromCamera()}}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const t="globe"===this.projection.name||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||t){const De=this.center;return De.lat=c.clamp(De.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!t)&&(De.lng=c.clamp(De.lng,this.minLng,this.maxLng)),this.center=De,void(this._constraining=!1)}const s=this._unmodified,{x:p,y:v}=this.point;let b=0,D=p,O=v;const k=this.width/2,H=this.height/2,J=this.worldMinY*this.scale,ue=this.worldMaxY*this.scale;if(v-H<J&&(O=J+H),v+H>ue&&(O=ue-H),ue-J<this.height&&(b=Math.max(b,this.height/(ue-J)),O=(ue+J)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const De=this.worldMinX*this.scale,je=this.worldMaxX*this.scale,ke=this.worldSize/2-(De+je)/2;D=(p+ke+this.worldSize)%this.worldSize-ke,D-k<De&&(D=De+k),D+k>je&&(D=je-k),je-De<this.width&&(b=Math.max(b,this.width/(je-De)),D=(je+De)/2)}D===p&&O===v||(this.center=this.unproject(new c.pointGeometry(D,O))),b&&(this.zoom+=this.scaleZoom(b)),this._constrainCameraAltitude(),this._unmodified=s,this._constraining=!1}_minZoomForBounds(){let t=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(t=Math.max(t,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),t}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const t=this.centerOffset,s=this.pixelsPerMeter;"globe"===this.projection.name&&(this._mercatorScaleRatio=c.mercatorZfromAltitude(1,this.center.lat)/c.mercatorZfromAltitude(1,c.GLOBE_SCALE_MATCH_LATITUDE));const p=to(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,p),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const v=this._camera.getWorldToCamera(this.worldSize,"meters"===this.projection.zAxisUnit?s:1),b=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);b[8]=2*-t.x/this.width,b[9]=2*t.y/this.height;let D=c.mul([],b,v);if(this.projection.isReprojectedInTileSpace){const yt=this.locationCoordinate(this.center),ot=c.identity([]);c.translate(ot,ot,[yt.x*this.worldSize,yt.y*this.worldSize,0]),c.multiply(ot,ot,Sr(this)),c.translate(ot,ot,[-yt.x*this.worldSize,-yt.y*this.worldSize,0]),c.multiply(D,D,ot),this.inverseAdjustmentMatrix=function(It){const Jt=Sr(It,!0);return ye([],[Jt[0],Jt[1],Jt[4],Jt[5]])}(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];this.mercatorMatrix=c.scale([],D,[this.worldSize,this.worldSize,this.worldSize/s,1]),this.projMatrix=D,this.invProjMatrix=c.invert(new Float64Array(16),this.projMatrix);const O=c.invert([],b);this.frustumCorners=c.FrustumCorners.fromInvProjectionMatrix(O,this.horizonLineFromTop(),this.height);const k=new Float32Array(16);c.identity(k),c.scale(k,k,[1,-1,1]),c.rotateX(k,k,this._pitch),c.rotateZ(k,k,this.angle);const H=c.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ),J=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;H[8]=2*-t.x/this.width,H[9]=2*(t.y+J)/this.height,this.skyboxMatrix=c.multiply(k,H,k);const ue=this.point,De=ue.x,je=ue.y,ke=this.width%2/2,Ye=this.height%2/2,$e=Math.cos(this.angle),Be=Math.sin(this.angle),Xe=De-Math.round(De)+$e*ke+Be*Ye,We=je-Math.round(je)+$e*Ye+Be*ke,gt=new Float64Array(D);if(c.translate(gt,gt,[Xe>.5?Xe-1:Xe,We>.5?We-1:We,0]),this.alignedProjMatrix=gt,D=c.create(),c.scale(D,D,[this.width/2,-this.height/2,1]),c.translate(D,D,[1,-1,0]),this.labelPlaneMatrix=D,D=c.create(),c.scale(D,D,[1,-1,1]),c.translate(D,D,[-1,-1,0]),c.scale(D,D,[2/this.width,2/this.height,1]),this.glCoordMatrix=D,this.pixelMatrix=c.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),this._calcFogMatrices(),this._distanceTileDataCache={},D=c.invert(new Float64Array(16),this.pixelMatrix),!D)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=D,"globe"===this.projection.name||this.mercatorFromTransition){this.globeMatrix=c.calculateGlobeMatrix(this);const yt=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=c.transformMat4(yt,yt,v),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=D;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const t=this.cameraWorldSize,s=this.cameraPixelsPerMeter,p=this._camera.position,v=1/this.height/this._pixelsPerMercatorPixel,b=[t,t,s];c.scale$2(b,b,v),c.scale$2(p,p,-1),c.multiply$2(p,p,b);const D=c.create();c.translate(D,D,p),c.scale(D,D,b),this.mercatorFogMatrix=D,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(t,s,v)}_computeCameraPosition(t){const s=(t=t||this.pixelsPerMeter)/this.pixelsPerMeter,p=this._camera.forward(),v=this.point,b=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*s-t/this.worldSize*this._centerAltitude;return[v.x/this.worldSize-p[0]*b,v.y/this.worldSize-p[1]*b,t/this.worldSize*this._centerAltitude-p[2]*b]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(t){const s=this._maxCameraBoundsDistance()*Math.cos(this._pitch),p=this._camera.position[2],v=t[2];let b=1;this.projection.wrap&&(this.center=this.center.wrap()),v>0&&(b=Math.min((s-p)/v,1)),this._camera.position=c.scaleAndAdd([],this._camera.position,t,b),this._updateStateFromCamera()}_updateStateFromCamera(){const t=this._camera.position,s=this._camera.forward(),{pitch:p,bearing:v}=this._camera.getPitchBearing(),b=c.mercatorZfromAltitude(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,D=this._mercatorZfromZoom(this._maxZoom)*Math.cos(c.degToRad(this._maxPitch)),O=Math.max((t[2]-b)/Math.cos(p),D),k=this._zoomFromMercatorZ(O);c.scaleAndAdd(t,t,s,O),this._pitch=c.clamp(p,c.degToRad(this.minPitch),c.degToRad(this.maxPitch)),this.angle=c.wrap(v,-Math.PI,Math.PI),this._setZoom(c.clamp(k,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new c.MercatorCoordinate(t[0],t[1],t[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(t){return Math.pow(2,t)*this.tileSize}_mercatorZfromZoom(t){return this.cameraToCenterDistance/this._worldSizeFromZoom(t)}_minimumHeightOverTerrain(){const t=Math.min((null!=this._seaLevelZoom?this._seaLevelZoom:this._zoom)+2,this._maxZoom);return this._mercatorZfromZoom(t)}_zoomFromMercatorZ(t){return this.scaleZoom(this.cameraToCenterDistance/(t*this.tileSize))}zoomFromMercatorZAdjusted(t){const s=D=>{const O=this.getCameraToCenterDistance(this.projection,D);return this.scaleZoom(O/(t*this.tileSize))};let p,v=s(this.zoom),b=Math.abs(v-s(v));for(;p!==b;)v=s(v),p=b,b=Math.abs(v-s(v));return v}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(c.warnOnce("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(t,s){const p=Math.min(t.x,s.x),v=Math.max(t.x,s.x),b=Math.min(t.y,s.y),D=Math.max(t.y,s.y);if(b<this.horizonLineFromTop(!1))return!0;if("mercator"!==this.projection.name)return!1;const O=[new c.pointGeometry(p,b),new c.pointGeometry(v,D),new c.pointGeometry(p,D),new c.pointGeometry(v,b)],k=this.renderWorldCopies?-3:0,H=this.renderWorldCopies?4:1;for(const J of O){const ue=this.pointRayIntersection(J);if(ue.t<0)return!0;const De=this.rayIntersectionCoordinate(ue);if(De.x<k||De.y<0||De.x>H||De.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+c.radToDeg(this.fovAboveCenter)>88||this.anyCornerOffEdge(new c.pointGeometry(0,0),new c.pointGeometry(this.width,this.height))}zoomDeltaToMovement(t,s){const p=c.length(c.sub([],this._camera.position,t)),v=this._zoomFromMercatorZ(p)+s;return p-this._mercatorZfromZoom(v)}getCameraPoint(){if("globe"===this.projection.name){const t=function(s,p){const v=[s[0],s[1],s[2],1];c.transformMat4$1(v,v,p);const b=Math.max(v[3],1e-6);return[v[0]/b,v[1]/b,v[2]/b,b]}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new c.pointGeometry(t[0],t[1])}{const t=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new c.pointGeometry(0,t))}}getCameraToCenterDistance(t,s=this.zoom){const p=to(t,s,this.width,this.height,1024),v=t.pixelSpaceConversion(this.center.lat,this.worldSize,p);return.5/Math.tan(.5*this._fov)*this.height*v}getWorldToCameraMatrix(){const t=this._camera.getWorldToCamera(this.worldSize,"meters"===this.projection.zAxisUnit?this.pixelsPerMeter:1);return"globe"===this.projection.name&&c.multiply(t,t,this.globeMatrix),t}}function Na(l,t){let s=!1,p=null;const v=()=>{p=null,s&&(l(),p=setTimeout(v,t),s=!1)};return()=>(s=!0,p||v(),p)}class Wl{constructor(t){this._hashName=t&&encodeURIComponent(t),c.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=Na(this._updateHashUnthrottled.bind(this),300)}addTo(t){return this._map=t,c.window.addEventListener("hashchange",this._onHashChange,!1),t.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),c.window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const t=this._map;if(!t)return"";const s=ql(t);if(this._hashName){const p=this._hashName;let v=!1;const b=c.window.location.hash.slice(1).split("&").map(D=>{const O=D.split("=")[0];return O===p?(v=!0,`${O}=${s}`):D}).filter(D=>D);return v||b.push(`${p}=${s}`),`#${b.join("&")}`}return`#${s}`}_getCurrentHash(){const t=c.window.location.hash.replace("#","");if(this._hashName){let s;return t.split("&").map(p=>p.split("=")).forEach(p=>{p[0]===this._hashName&&(s=p)}),(s&&s[1]||"").split("/")}return t.split("/")}_onHashChange(){const t=this._map;if(!t)return!1;const s=this._getCurrentHash();if(s.length>=3&&!s.some(p=>isNaN(p))){const p=t.dragRotate.isEnabled()&&t.touchZoomRotate.isEnabled()?+(s[3]||0):t.getBearing();return t.jumpTo({center:[+s[2],+s[1]],zoom:+s[0],bearing:p,pitch:+(s[4]||0)}),!0}return!1}_updateHashUnthrottled(){const t=c.window.location.href.replace(/(#.+)?$/,this.getHashString());c.window.history.replaceState(c.window.history.state,null,t)}}function ql(l,t){const s=l.getCenter(),p=Math.round(100*l.getZoom())/100,v=Math.ceil((p*Math.LN2+Math.log(512/360/.5))/Math.LN10),b=Math.pow(10,v),D=Math.round(s.lng*b)/b,O=Math.round(s.lat*b)/b,k=l.getBearing(),H=l.getPitch();let J=t?`/${D}/${O}/${p}`:`${p}/${O}/${D}`;return(k||H)&&(J+="/"+Math.round(10*k)/10),H&&(J+=`/${Math.round(H)}`),J}const $s={linearity:.3,easing:c.bezier(0,0,.3,1)},Yl=c.extend({deceleration:2500,maxSpeed:1400},$s),Jl=c.extend({deceleration:20,maxSpeed:1400},$s),Ua=c.extend({deceleration:1e3,maxSpeed:360},$s),pa=c.extend({deceleration:1e3,maxSpeed:90},$s);class Xl{constructor(t){this._map=t,this.clear()}clear(){this._inertiaBuffer=[]}record(t){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:c.exported.now(),settings:t})}_drainInertiaBuffer(){const t=this._inertiaBuffer,s=c.exported.now();for(;t.length>0&&s-t[0].time>160;)t.shift()}_onMoveEnd(t){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const s={zoom:0,bearing:0,pitch:0,pan:new c.pointGeometry(0,0),pinchAround:void 0,around:void 0};for(const{settings:b}of this._inertiaBuffer)s.zoom+=b.zoomDelta||0,s.bearing+=b.bearingDelta||0,s.pitch+=b.pitchDelta||0,b.panDelta&&s.pan._add(b.panDelta),b.around&&(s.around=b.around),b.pinchAround&&(s.pinchAround=b.pinchAround);const p=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,v={};if(s.pan.mag()){const b=fa(s.pan.mag(),p,c.extend({},Yl,t||{}));v.offset=s.pan.mult(b.amount/s.pan.mag()),v.center=this._map.transform.center,Va(v,b)}if(s.zoom){const b=fa(s.zoom,p,Jl);v.zoom=this._map.transform.zoom+b.amount,Va(v,b)}if(s.bearing){const b=fa(s.bearing,p,Ua);v.bearing=this._map.transform.bearing+c.clamp(b.amount,-179,179),Va(v,b)}if(s.pitch){const b=fa(s.pitch,p,pa);v.pitch=this._map.transform.pitch+b.amount,Va(v,b)}if(v.zoom||v.bearing){const b=void 0===s.pinchAround?s.around:s.pinchAround;v.around=b?this._map.unproject(b):this._map.getCenter()}return this.clear(),v.noMoveStart=!0,v}}function Va(l,t){(!l.duration||l.duration<t.duration)&&(l.duration=t.duration,l.easing=t.easing)}function fa(l,t,s){const{maxSpeed:p,linearity:v,deceleration:b}=s,D=c.clamp(l*v/(t/1e3),-p,p),O=Math.abs(D)/(b*v);return{easing:s.easing,duration:1e3*O,amount:D*(O/2)}}class $o extends c.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,s,p,v={}){const b=te(s.getCanvasContainer(),p),D=s.unproject(b);super(t,c.extend({point:b,lngLat:D,originalEvent:p},v)),this._defaultPrevented=!1,this.target=s}}class ja extends c.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,s,p){const v="touchend"===t?p.changedTouches:p.touches,b=Qe(s.getCanvasContainer(),v),D=b.map(k=>s.unproject(k)),O=b.reduce((k,H,J,ue)=>k.add(H.div(ue.length)),new c.pointGeometry(0,0));super(t,{points:b,point:O,lngLats:D,lngLat:s.unproject(O),originalEvent:p}),this._defaultPrevented=!1}}class Sl extends c.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,s,p){super(t,{originalEvent:p}),this._defaultPrevented=!1}}class Ec{constructor(t,s){this._map=t,this._clickTolerance=s.clickTolerance}reset(){this._mousedownPos=void 0}wheel(t){return this._firePreventable(new Sl(t.type,this._map,t))}mousedown(t,s){return this._mousedownPos=s,this._firePreventable(new $o(t.type,this._map,t))}mouseup(t){this._map.fire(new $o(t.type,this._map,t))}preclick(t){const s=c.extend({},t);s.type="preclick",this._map.fire(new $o(s.type,this._map,s))}click(t,s){this._mousedownPos&&this._mousedownPos.dist(s)>=this._clickTolerance||(this.preclick(t),this._map.fire(new $o(t.type,this._map,t)))}dblclick(t){return this._firePreventable(new $o(t.type,this._map,t))}mouseover(t){this._map.fire(new $o(t.type,this._map,t))}mouseout(t){this._map.fire(new $o(t.type,this._map,t))}touchstart(t){return this._firePreventable(new ja(t.type,this._map,t))}touchmove(t){this._map.fire(new ja(t.type,this._map,t))}touchend(t){this._map.fire(new ja(t.type,this._map,t))}touchcancel(t){this._map.fire(new ja(t.type,this._map,t))}_firePreventable(t){if(this._map.fire(t),t.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Dc{constructor(t){this._map=t}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(t){this._map.fire(new $o(t.type,this._map,t))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new $o("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(t){this._delayContextMenu?this._contextMenuEvent=t:this._map.fire(new $o(t.type,this._map,t)),this._map.listens("contextmenu")&&t.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Ic{constructor(t,s){this._map=t,this._el=t.getCanvasContainer(),this._container=t.getContainer(),this._clickTolerance=s.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(t,s){this.isEnabled()&&t.shiftKey&&0===t.button&&(Ze(),this._startPos=this._lastPos=s,this._active=!0)}mousemoveWindow(t,s){if(!this._active)return;const p=s,v=this._startPos,b=this._lastPos;if(!v||!b||b.equals(p)||!this._box&&p.dist(v)<this._clickTolerance)return;this._lastPos=p,this._box||(this._box=Ie("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",t));const D=Math.min(v.x,p.x),O=Math.max(v.x,p.x),k=Math.min(v.y,p.y),H=Math.max(v.y,p.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${D}px,${k}px)`,this._box.style.width=O-D+"px",this._box.style.height=H-k+"px")})}mouseupWindow(t,s){if(!this._active)return;const p=this._startPos,v=s;if(p&&0===t.button){if(this.reset(),Ae(),p.x!==v.x||p.y!==v.y)return this._map.fire(new c.Event("boxzoomend",{originalEvent:t})),{cameraAnimation:b=>b.fitScreenCoordinates(p,v,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",t)}}keydown(t){this._active&&27===t.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",t))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),he(),delete this._startPos,delete this._lastPos}_fireEvent(t,s){return this._map.fire(new c.Event(t,{originalEvent:s}))}}function Mc(l,t){const s={};for(let p=0;p<l.length;p++)s[l[p].identifier]=t[p];return s}class Ss{constructor(t){this.reset(),this.numTouches=t.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(t,s,p){(this.centroid||p.length>this.numTouches)&&(this.aborted=!0),this.aborted||(0===this.startTime&&(this.startTime=t.timeStamp),p.length===this.numTouches&&(this.centroid=function(v){const b=new c.pointGeometry(0,0);for(const D of v)b._add(D);return b.div(v.length)}(s),this.touches=Mc(p,s)))}touchmove(t,s,p){if(this.aborted||!this.centroid)return;const v=Mc(p,s);for(const b in this.touches){const D=this.touches[b],O=v[b];(!O||O.dist(D)>30)&&(this.aborted=!0)}}touchend(t,s,p){if((!this.centroid||t.timeStamp-this.startTime>500)&&(this.aborted=!0),0===p.length){const v=!this.aborted&&this.centroid;if(this.reset(),v)return v}}}class Kl{constructor(t){this.singleTap=new Ss(t),this.numTaps=t.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(t,s,p){this.singleTap.touchstart(t,s,p)}touchmove(t,s,p){this.singleTap.touchmove(t,s,p)}touchend(t,s,p){const v=this.singleTap.touchend(t,s,p);if(v){const b=t.timeStamp-this.lastTime<500,D=!this.lastTap||this.lastTap.dist(v)<30;if(b&&D||this.reset(),this.count++,this.lastTime=t.timeStamp,this.lastTap=v,this.count===this.numTaps)return this.reset(),v}}}class $a{constructor(){this._zoomIn=new Kl({numTouches:1,numTaps:2}),this._zoomOut=new Kl({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(t,s,p){this._zoomIn.touchstart(t,s,p),this._zoomOut.touchstart(t,s,p)}touchmove(t,s,p){this._zoomIn.touchmove(t,s,p),this._zoomOut.touchmove(t,s,p)}touchend(t,s,p){const v=this._zoomIn.touchend(t,s,p),b=this._zoomOut.touchend(t,s,p);return v?(this._active=!0,t.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:D=>D.easeTo({duration:300,zoom:D.getZoom()+1,around:D.unproject(v)},{originalEvent:t})}):b?(this._active=!0,t.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:D=>D.easeTo({duration:300,zoom:D.getZoom()-1,around:D.unproject(b)},{originalEvent:t})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const Sc={0:1,2:2};class Ql{constructor(t){this.reset(),this._clickTolerance=t.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(t,s){return!1}_move(t,s){return{}}mousedown(t,s){if(this._lastPoint)return;const p=Ot(t);this._correctButton(t,p)&&(this._lastPoint=s,this._eventButton=p)}mousemoveWindow(t,s){const p=this._lastPoint;if(p)if(t.preventDefault(),null!=this._eventButton&&function(v,b){const D=Sc[b];return void 0===v.buttons||(v.buttons&D)!==D}(t,this._eventButton))this.reset();else if(this._moved||!(s.dist(p)<this._clickTolerance))return this._moved=!0,this._lastPoint=s,this._move(p,s)}mouseupWindow(t){this._lastPoint&&Ot(t)===this._eventButton&&(this._moved&&Ae(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class ec extends Ql{mousedown(t,s){super.mousedown(t,s),this._lastPoint&&(this._active=!0)}_correctButton(t,s){return 0===s&&!t.ctrlKey}_move(t,s){return{around:s,panDelta:s.sub(t)}}}class tc extends Ql{_correctButton(t,s){return 0===s&&t.ctrlKey||2===s}_move(t,s){const p=.8*(s.x-t.x);if(p)return this._active=!0,{bearingDelta:p}}contextmenu(t){t.preventDefault()}}class sl extends Ql{_correctButton(t,s){return 0===s&&t.ctrlKey||2===s}_move(t,s){const p=-.5*(s.y-t.y);if(p)return this._active=!0,{pitchDelta:p}}contextmenu(t){t.preventDefault()}}class Qc{constructor(t,s){this._map=t,this._el=t.getCanvasContainer(),this._minTouches=1,this._clickTolerance=s.clickTolerance||1,this.reset(),c.bindAll(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new c.pointGeometry(0,0)}touchstart(t,s,p){return this._calculateTransform(t,s,p)}touchmove(t,s,p){if(this._active&&!(p.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(1===p.length&&!c.isFullscreen())return void this._showTouchPanBlockerAlert();"hidden"!==this._alertContainer.style.visibility&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return t.cancelable&&t.preventDefault(),this._calculateTransform(t,s,p)}}touchend(t,s,p){this._calculateTransform(t,s,p),this._active&&p.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(t,s,p){p.length>0&&(this._active=!0);const v=Mc(p,s),b=new c.pointGeometry(0,0),D=new c.pointGeometry(0,0);let O=0;for(const H in v){const J=v[H],ue=this._touches[H];ue&&(b._add(J),D._add(J.sub(ue)),O++,v[H]=J)}if(this._touches=v,O<this._minTouches||!D.mag())return;const k=D.div(O);return this._sum._add(k),this._sum.mag()<this._clickTolerance?void 0:{around:b.div(O),panDelta:k}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=Ie("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","null")},500)}}class nc{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(t){}_move(t,s,p){return{}}touchstart(t,s,p){this._firstTwoTouches||p.length<2||(this._firstTwoTouches=[p[0].identifier,p[1].identifier],this._start([s[0],s[1]]))}touchmove(t,s,p){const v=this._firstTwoTouches;if(!v)return;t.preventDefault();const[b,D]=v,O=To(p,s,b),k=To(p,s,D);if(!O||!k)return;const H=this._aroundCenter?null:O.add(k).div(2);return this._move([O,k],H,t)}touchend(t,s,p){if(!this._firstTwoTouches)return;const[v,b]=this._firstTwoTouches,D=To(p,s,v),O=To(p,s,b);D&&O||(this._active&&Ae(),this.reset())}touchcancel(){this.reset()}enable(t){this._enabled=!0,this._aroundCenter=!!t&&"center"===t.around}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function To(l,t,s){for(let p=0;p<l.length;p++)if(l[p].identifier===s)return t[p]}function Ac(l,t){return Math.log(l/t)/Math.LN2}class ic extends nc{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(t){this._startDistance=this._distance=t[0].dist(t[1])}_move(t,s){const p=this._distance;if(this._distance=t[0].dist(t[1]),this._active||!(Math.abs(Ac(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Ac(this._distance,p),pinchAround:s}}}function Al(l,t){return 180*l.angleWith(t)/Math.PI}class po extends nc{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(t){this._startVector=this._vector=t[0].sub(t[1]),this._minDiameter=t[0].dist(t[1])}_move(t,s){const p=this._vector;if(this._vector=t[0].sub(t[1]),p&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:Al(this._vector,p),pinchAround:s}}_isBelowThreshold(t){this._minDiameter=Math.min(this._minDiameter,t.mag());const s=25/(Math.PI*this._minDiameter)*360,p=this._startVector;if(!p)return!1;const v=Al(t,p);return Math.abs(v)<s}}function Pc(l){return Math.abs(l.y)>Math.abs(l.x)}class Cu extends nc{constructor(t){super(),this._map=t}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(t){this._lastPoints=t,Pc(t[0].sub(t[1]))&&(this._valid=!1)}_move(t,s,p){const v=this._lastPoints;if(!v)return;const b=t[0].sub(v[0]),D=t[1].sub(v[1]);return this._map._cooperativeGestures&&!c.isFullscreen()&&p.touches.length<3||(this._valid=this.gestureBeginsVertically(b,D,p.timeStamp),!this._valid)?void 0:(this._lastPoints=t,this._active=!0,{pitchDelta:(b.y+D.y)/2*-.5})}gestureBeginsVertically(t,s,p){if(void 0!==this._valid)return this._valid;const v=t.mag()>=2,b=s.mag()>=2;if(!v&&!b)return;if(!v||!b)return null==this._firstMove&&(this._firstMove=p),p-this._firstMove<100&&void 0;const D=t.y>0==s.y>0;return Pc(t)&&Pc(s)&&D}}const ud={panStep:100,bearingStep:15,pitchStep:10};class Pl{constructor(){const t=ud;this._panStep=t.panStep,this._bearingStep=t.bearingStep,this._pitchStep=t.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(t){if(t.altKey||t.ctrlKey||t.metaKey)return;let s=0,p=0,v=0,b=0,D=0;switch(t.keyCode){case 61:case 107:case 171:case 187:s=1;break;case 189:case 109:case 173:s=-1;break;case 37:t.shiftKey?p=-1:(t.preventDefault(),b=-1);break;case 39:t.shiftKey?p=1:(t.preventDefault(),b=1);break;case 38:t.shiftKey?v=1:(t.preventDefault(),D=-1);break;case 40:t.shiftKey?v=-1:(t.preventDefault(),D=1);break;default:return}return this._rotationDisabled&&(p=0,v=0),{cameraAnimation:O=>{const k=O.getZoom();O.easeTo({duration:300,easeId:"keyboardHandler",easing:Ks,zoom:s?Math.round(k)+s*(t.shiftKey?2:1):k,bearing:O.getBearing()+p*this._bearingStep,pitch:O.getPitch()+v*this._pitchStep,offset:[-b*this._panStep,-D*this._panStep],center:O.getCenter()},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Ks(l){return l*(2-l)}const rc=4.000244140625;class As{constructor(t,s){this._map=t,this._el=t.getCanvasContainer(),this._handler=s,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,c.bindAll(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(t){this._defaultZoomRate=t}setWheelZoomRate(t){this._wheelZoomRate=t}isEnabled(){return!!this._enabled}isActive(){return this._active||void 0!==this._finishTimeout}isZooming(){return!!this._zooming}enable(t){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!t&&"center"===t.around,this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(t){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(t.ctrlKey||t.metaKey||this.isZooming()||c.isFullscreen()))return void this._showBlockerAlert();"hidden"!==this._alertContainer.style.visibility&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let s=t.deltaMode===c.window.WheelEvent.DOM_DELTA_LINE?40*t.deltaY:t.deltaY;const p=c.exported.now(),v=p-(this._lastWheelEventTime||0);this._lastWheelEventTime=p,0!==s&&s%rc==0?this._type="wheel":0!==s&&Math.abs(s)<4?this._type="trackpad":v>400?(this._type=null,this._lastValue=s,this._timeout=setTimeout(this._onTimeout,40,t)):this._type||(this._type=Math.abs(v*s)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,s+=this._lastValue)),t.shiftKey&&s&&(s/=4),this._type&&(this._lastWheelEvent=t,this._delta-=s,this._active||this._start(t)),t.preventDefault()}_onTimeout(t){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(t)}_start(t){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const s=te(this._el,t);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:s,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const t=this._map.transform;"wheel"===this._type&&t.projection.wrap&&(t._center.lng>=180||t._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const s=()=>t._terrainEnabled()&&this._aroundCoord?t.computeZoomRelativeTo(this._aroundCoord):t.zoom;if(0!==this._delta){const k="wheel"===this._type&&Math.abs(this._delta)>rc?this._wheelZoomRate:this._defaultZoomRate;let H=2/(1+Math.exp(-Math.abs(this._delta*k)));this._delta<0&&0!==H&&(H=1/H);const J=s(),ue=Math.pow(2,J),De="number"==typeof this._targetZoom?t.zoomScale(this._targetZoom):ue;this._targetZoom=Math.min(t.maxZoom,Math.max(t.minZoom,t.scaleZoom(De*H))),"wheel"===this._type&&(this._startZoom=J,this._easing=this._smoothOutEasing(200)),this._delta=0}const p="number"==typeof this._targetZoom?this._targetZoom:s(),v=this._startZoom,b=this._easing;let D,O=!1;if("wheel"===this._type&&v&&b){const k=Math.min((c.exported.now()-this._lastWheelEventTime)/200,1),H=b(k);D=c.number(v,p,H),k<1?this._frameId||(this._frameId=!0):O=!0}else D=p,O=!0;return this._active=!0,O&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!O,zoomDelta:D-s(),around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(t){let s=c.ease;if(this._prevEase){const p=this._prevEase,v=(c.exported.now()-p.start)/p.duration,b=p.easing(v+.01)-p.easing(v),D=.27/Math.sqrt(b*b+1e-4)*.01,O=Math.sqrt(.0729-D*D);s=c.bezier(D,O,.25,1)}return this._prevEase={start:c.exported.now(),duration:t,easing:s},s}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=Ie("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(c.window.navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","null")},200)}}class Da{constructor(t,s){this._clickZoom=t,this._tapZoom=s}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Ol{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(t,s){return t.preventDefault(),{cameraAnimation:p=>{p.easeTo({duration:300,zoom:p.getZoom()+(t.shiftKey?-1:1),around:p.unproject(s)},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Jn{constructor(){this._tap=new Kl({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(t,s,p){this._swipePoint||(this._tapTime&&t.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?p.length>0&&(this._swipePoint=s[0],this._swipeTouch=p[0].identifier):this._tap.touchstart(t,s,p))}touchmove(t,s,p){if(this._tapTime){if(this._swipePoint){if(p[0].identifier!==this._swipeTouch)return;const v=s[0],b=v.y-this._swipePoint.y;return this._swipePoint=v,t.preventDefault(),this._active=!0,{zoomDelta:b/128}}}else this._tap.touchmove(t,s,p)}touchend(t,s,p){this._tapTime?this._swipePoint&&0===p.length&&this.reset():this._tap.touchend(t,s,p)&&(this._tapTime=t.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ia{constructor(t,s,p){this._el=t,this._mousePan=s,this._touchPan=p}enable(t){this._inertiaOptions=t||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class al{constructor(t,s,p){this._pitchWithRotate=t.pitchWithRotate,this._mouseRotate=s,this._mousePitch=p}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class Ma{constructor(t,s,p,v){this._el=t,this._touchZoom=s,this._touchRotate=p,this._tapDragZoom=v,this._rotationDisabled=!1,this._enabled=!0}enable(t){this._touchZoom.enable(t),this._rotationDisabled||this._touchRotate.enable(t),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Za=l=>l.zoom||l.drag||l.pitch||l.rotate;class oc extends c.Event{}class Ga{constructor(){this.constants=[1,1,.01],this.radius=0}setup(t,s){const p=c.sub([],s,t);this.radius=c.length(p[2]<0?c.div([],p,this.constants):[p[0],p[1],0])}projectRay(t){c.div(t,t,this.constants),c.normalize(t,t),c.mul$1(t,t,this.constants);const s=c.scale$2([],t,this.radius);if(s[2]>0){const p=c.scale$2([],[0,0,1],c.dot(s,[0,0,1])),v=c.scale$2([],c.normalize([],[s[0],s[1],0]),this.radius),b=c.add([],s,c.scale$2([],c.sub([],c.add([],v,p),s),2));s[0]=b[0],s[1]=b[1]}return s}}function Rl(l){return l.panDelta&&l.panDelta.mag()||l.zoomDelta||l.bearingDelta||l.pitchDelta}class Tu{constructor(t,s){this._map=t,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Xl(t),this._bearingSnap=s.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new Ga,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(s),c.bindAll(["handleEvent","handleWindowEvent"],this);const p=this._el;this._listeners=[[p,"touchstart",{passive:!0}],[p,"touchmove",{passive:!1}],[p,"touchend",void 0],[p,"touchcancel",void 0],[p,"mousedown",void 0],[p,"mousemove",void 0],[p,"mouseup",void 0],[c.window.document,"mousemove",{capture:!0}],[c.window.document,"mouseup",void 0],[p,"mouseover",void 0],[p,"mouseout",void 0],[p,"dblclick",void 0],[p,"click",void 0],[p,"keydown",{capture:!1}],[p,"keyup",void 0],[p,"wheel",{passive:!1}],[p,"contextmenu",void 0],[c.window,"blur",void 0]];for(const[v,b,D]of this._listeners)v.addEventListener(b,v===c.window.document?this.handleWindowEvent:this.handleEvent,D)}destroy(){for(const[t,s,p]of this._listeners)t.removeEventListener(s,t===c.window.document?this.handleWindowEvent:this.handleEvent,p)}_addDefaultHandlers(t){const s=this._map,p=s.getCanvasContainer();this._add("mapEvent",new Ec(s,t));const v=s.boxZoom=new Ic(s,t);this._add("boxZoom",v);const b=new $a,D=new Ol;s.doubleClickZoom=new Da(D,b),this._add("tapZoom",b),this._add("clickZoom",D);const O=new Jn;this._add("tapDragZoom",O);const k=s.touchPitch=new Cu(s);this._add("touchPitch",k);const H=new tc(t),J=new sl(t);s.dragRotate=new al(t,H,J),this._add("mouseRotate",H,["mousePitch"]),this._add("mousePitch",J,["mouseRotate"]);const ue=new ec(t),De=new Qc(s,t);s.dragPan=new Ia(p,ue,De),this._add("mousePan",ue),this._add("touchPan",De,["touchZoom","touchRotate"]);const je=new po,ke=new ic;s.touchZoomRotate=new Ma(p,ke,je,O),this._add("touchRotate",je,["touchPan","touchZoom"]),this._add("touchZoom",ke,["touchPan","touchRotate"]),this._add("blockableMapEvent",new Dc(s));const Ye=s.scrollZoom=new As(s,this);this._add("scrollZoom",Ye,["mousePan"]);const $e=s.keyboard=new Pl;this._add("keyboard",$e);for(const Be of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])t.interactive&&t[Be]&&s[Be].enable(t[Be])}_add(t,s,p){this._handlers.push({handlerName:t,handler:s,allowed:p}),this._handlersById[t]=s}stop(t){if(!this._updatingCamera){for(const{handler:s}of this._handlers)s.reset();this._inertia.clear(),this._fireEvents({},{},t),this._changes=[]}}isActive(){for(const{handler:t}of this._handlers)if(t.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Za(this._eventsInProgress)||this.isZooming()}_blockedByActive(t,s,p){for(const v in t)if(v!==p&&(!s||s.indexOf(v)<0))return!0;return!1}handleWindowEvent(t){this.handleEvent(t,`${t.type}Window`)}_getMapTouches(t){const s=[];for(const p of t)this._el.contains(p.target)&&s.push(p);return s}handleEvent(t,s){this._updatingCamera=!0;const p="renderFrame"===t.type,v=p?void 0:t,b={needsRenderFrame:!1},D={},O={},k=t.touches?this._getMapTouches(t.touches):void 0,H=k?Qe(this._el,k):p?void 0:te(this._el,t);for(const{handlerName:De,handler:je,allowed:ke}of this._handlers){if(!je.isEnabled())continue;let Ye;this._blockedByActive(O,ke,De)?je.reset():je[s||t.type]&&(Ye=je[s||t.type](t,H,k),this.mergeHandlerResult(b,D,Ye,De,v),Ye&&Ye.needsRenderFrame&&this._triggerRenderFrame()),(Ye||je.isActive())&&(O[De]=je)}const J={};for(const De in this._previousActiveHandlers)O[De]||(J[De]=v);this._previousActiveHandlers=O,(Object.keys(J).length||Rl(b))&&(this._changes.push([b,D,J]),this._triggerRenderFrame()),(Object.keys(O).length||Rl(b))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:ue}=b;ue&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],ue(this._map))}mergeHandlerResult(t,s,p,v,b){if(!p)return;c.extend(t,p);const D={handlerName:v,originalEvent:p.originalEvent||b};void 0!==p.zoomDelta&&(s.zoom=D),void 0!==p.panDelta&&(s.drag=D),void 0!==p.pitchDelta&&(s.pitch=D),void 0!==p.bearingDelta&&(s.rotate=D)}_applyChanges(){const t={},s={},p={};for(const[v,b,D]of this._changes)v.panDelta&&(t.panDelta=(t.panDelta||new c.pointGeometry(0,0))._add(v.panDelta)),v.zoomDelta&&(t.zoomDelta=(t.zoomDelta||0)+v.zoomDelta),v.bearingDelta&&(t.bearingDelta=(t.bearingDelta||0)+v.bearingDelta),v.pitchDelta&&(t.pitchDelta=(t.pitchDelta||0)+v.pitchDelta),void 0!==v.around&&(t.around=v.around),void 0!==v.aroundCoord&&(t.aroundCoord=v.aroundCoord),void 0!==v.pinchAround&&(t.pinchAround=v.pinchAround),v.noInertia&&(t.noInertia=v.noInertia),c.extend(s,b),c.extend(p,D);this._updateMapTransform(t,s,p),this._changes=[]}_updateMapTransform(t,s,p){const v=this._map,b=v.transform,D=Xe=>[Xe.x,Xe.y,Xe.z];if((Xe=>{const We=this._eventsInProgress.drag;return We&&!this._handlersById[We.handlerName].isActive()})()&&!Rl(t)){const Xe=b.zoom;b.cameraElevationReference="sea",b.recenterOnTerrain(),b.cameraElevationReference="ground",Xe!==b.zoom&&this._map._update(!0)}if(!Rl(t))return void this._fireEvents(s,p,!0);let{panDelta:O,zoomDelta:k,bearingDelta:H,pitchDelta:J,around:ue,aroundCoord:De,pinchAround:je}=t;void 0!==je&&(ue=je),(Xe=>s.drag&&!this._eventsInProgress.drag)()&&ue&&(this._dragOrigin=D(b.pointCoordinate3D(ue)),this._trackingEllipsoid.setup(b._camera.position,this._dragOrigin)),b.cameraElevationReference="sea",v._stop(!0),ue=ue||v.transform.centerPoint,H&&(b.bearing+=H),J&&(b.pitch+=J),b._updateCameraState();const ke=[0,0,0];if(O)if("mercator"===b.projection.name){const Xe=this._trackingEllipsoid.projectRay(b.screenPointToMercatorRay(ue).dir),We=this._trackingEllipsoid.projectRay(b.screenPointToMercatorRay(ue.sub(O)).dir);ke[0]=We[0]-Xe[0],ke[1]=We[1]-Xe[1]}else{const Xe=b.pointCoordinate(ue);if("globe"===b.projection.name){O=O.rotate(-b.angle);const We=b._pixelsPerMercatorPixel/b.worldSize;ke[0]=-O.x*c.mercatorScale(c.latFromMercatorY(Xe.y))*We,ke[1]=-O.y*c.mercatorScale(b.center.lat)*We}else{const We=b.pointCoordinate(ue.sub(O));Xe&&We&&(ke[0]=We.x-Xe.x,ke[1]=We.y-Xe.y)}}const Ye=b.zoom,$e=[0,0,0];if(k){const Xe=D(De||b.pointCoordinate3D(ue)),We={dir:c.normalize([],c.sub([],Xe,b._camera.position))};if(We.dir[2]<0){const gt=b.zoomDeltaToMovement(Xe,k);c.scale$2($e,We.dir,gt)}}const Be=c.add(ke,ke,$e);b._translateCameraConstrained(Be),k&&Math.abs(b.zoom-Ye)>1e-4&&b.recenterOnTerrain(),b.cameraElevationReference="ground",this._map._update(),t.noInertia||this._inertia.record(t),this._fireEvents(s,p,!0)}_fireEvents(t,s,p){const v=Za(this._eventsInProgress),b=Za(t),D={};for(const J in t){const{originalEvent:ue}=t[J];this._eventsInProgress[J]||(D[`${J}start`]=ue),this._eventsInProgress[J]=t[J]}!v&&b&&this._fireEvent("movestart",b.originalEvent);for(const J in D)this._fireEvent(J,D[J]);b&&this._fireEvent("move",b.originalEvent);for(const J in t){const{originalEvent:ue}=t[J];this._fireEvent(J,ue)}const O={};let k;for(const J in this._eventsInProgress){const{handlerName:ue,originalEvent:De}=this._eventsInProgress[J];this._handlersById[ue].isActive()||(delete this._eventsInProgress[J],k=s[ue]||De,O[`${J}end`]=k)}for(const J in O)this._fireEvent(J,O[J]);const H=Za(this._eventsInProgress);if(p&&(v||b)&&!H){this._updatingCamera=!0;const J=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),ue=De=>0!==De&&-this._bearingSnap<De&&De<this._bearingSnap;J?(ue(J.bearing||this._map.getBearing())&&(J.bearing=0),this._map.easeTo(J,{originalEvent:k})):(this._map.fire(new c.Event("moveend",{originalEvent:k})),ue(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(t,s){this._map.fire(new c.Event(t,s?{originalEvent:s}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(t=>{this._frameId=void 0,this.handleEvent(new oc("renderFrame",{timeStamp:t})),this._applyChanges()})}_triggerRenderFrame(){void 0===this._frameId&&(this._frameId=this._requestFrame())}}const Ur="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class dd extends c.Evented{constructor(t,s){super(),this._moving=!1,this._zooming=!1,this.transform=t,this._bearingSnap=s.bearingSnap,c.bindAll(["_renderFrameCallback"],this)}getCenter(){return new c.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(t,s){return this.jumpTo({center:t},s)}panBy(t,s,p){return t=c.pointGeometry.convert(t).mult(-1),this.panTo(this.transform.center,c.extend({offset:t},s),p)}panTo(t,s,p){return this.easeTo(c.extend({center:t},s),p)}getZoom(){return this.transform.zoom}setZoom(t,s){return this.jumpTo({zoom:t},s),this}zoomTo(t,s,p){return this.easeTo(c.extend({zoom:t},s),p)}zoomIn(t,s){return this.zoomTo(this.getZoom()+1,t,s),this}zoomOut(t,s){return this.zoomTo(this.getZoom()-1,t,s),this}getBearing(){return this.transform.bearing}setBearing(t,s){return this.jumpTo({bearing:t},s),this}getPadding(){return this.transform.padding}setPadding(t,s){return this.jumpTo({padding:t},s),this}rotateTo(t,s,p){return this.easeTo(c.extend({bearing:t},s),p)}resetNorth(t,s){return this.rotateTo(0,c.extend({duration:1e3},t),s),this}resetNorthPitch(t,s){return this.easeTo(c.extend({bearing:0,pitch:0,duration:1e3},t),s),this}snapToNorth(t,s){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(t,s):this}getPitch(){return this.transform.pitch}setPitch(t,s){return this.jumpTo({pitch:t},s),this}cameraForBounds(t,s){t=c.LngLatBounds.convert(t);const p=s&&s.bearing||0,v=t.getNorthWest(),b=t.getSouthEast();return this._cameraForBounds(this.transform,v,b,p,s)}_extendCameraOptions(t){const s={top:0,bottom:0,right:0,left:0};if("number"==typeof(t=c.extend({padding:s,offset:[0,0],maxZoom:this.transform.maxZoom},t)).padding){const p=t.padding;t.padding={top:p,bottom:p,right:p,left:p}}return t.padding=c.extend(s,t.padding),t}_minimumAABBFrustumDistance(t,s){const p=s.max[0]-s.min[0],v=s.max[1]-s.min[1];return p/v>t.aspect?p/(2*Math.tan(.5*t.fovX)*t.aspect):v/(2*Math.tan(.5*t.fovY)*t.aspect)}_cameraForBoundsOnGlobe(t,s,p,v,b){const D=t.clone(),O=this._extendCameraOptions(b);D.bearing=v;const k=c.LngLat.convert(s),H=c.LngLat.convert(p),J=.5*(k.lat+H.lat),ue=.5*(k.lng+H.lng),De=c.latLngToECEF(J,ue),je=c.normalize([],De),ke=c.normalize([],c.cross([],je,[0,1,0])),Ye=c.cross([],ke,je),$e=[ke[0],ke[1],ke[2],0,Ye[0],Ye[1],Ye[2],0,je[0],je[1],je[2],0,0,0,0,1],Be=[De,c.latLngToECEF(k.lat,k.lng),c.latLngToECEF(H.lat,k.lng),c.latLngToECEF(H.lat,H.lng),c.latLngToECEF(k.lat,H.lng),c.latLngToECEF(J,k.lng),c.latLngToECEF(J,H.lng),c.latLngToECEF(k.lat,ue),c.latLngToECEF(H.lat,ue)];let Xe=c.Aabb.fromPoints(Be.map(zn=>[c.dot(ke,zn),c.dot(Ye,zn),c.dot(je,zn)]));const We=c.transformMat4([],Xe.center,$e);0===c.squaredLength(We)&&c.set(We,0,0,1),c.normalize(We,We),c.scale$2(We,We,c.GLOBE_RADIUS),D.center=c.ecefToLatLng(We);const gt=D.getWorldToCameraMatrix(),yt=c.invert(new Float64Array(16),gt);Xe=c.Aabb.applyTransform(Xe,c.multiply([],gt,$e)),c.transformMat4(We,We,gt);const ot=.5*(Xe.max[2]-Xe.min[2]),It=this._minimumAABBFrustumDistance(D,Xe),Jt=c.scale$2([],[0,0,1],ot),cn=c.add(Jt,We,Jt),Xt=It+(0===D.pitch?0:c.distance(We,cn)),An=D.globeCenterInViewSpace,Zt=c.sub([],We,[An[0],An[1],An[2]]);c.normalize(Zt,Zt),c.scale$2(Zt,Zt,Xt);const bn=c.add([],We,Zt);c.transformMat4(bn,bn,yt);const yn=c.earthRadius/c.GLOBE_RADIUS,Kt=c.length(bn),Nt=c.mercatorZfromAltitude(Kt*yn-c.earthRadius,0),qn=Math.min(D.zoomFromMercatorZAdjusted(Nt),O.maxZoom);return qn>.5*(c.GLOBE_ZOOM_THRESHOLD_MIN+c.GLOBE_ZOOM_THRESHOLD_MAX)?(D.setProjection({name:"mercator"}),D.zoom=qn,this._cameraForBounds(D,s,p,v,b)):{center:D.center,zoom:qn,bearing:v}}queryTerrainElevation(t,s){const p=this.transform.elevation;return p?(s=c.extend({},{exaggerated:!0},s),p.getAtPoint(c.MercatorCoordinate.fromLngLat(t),null,s.exaggerated)):null}_cameraForBounds(t,s,p,v,b){if("globe"===t.projection.name)return this._cameraForBoundsOnGlobe(t,s,p,v,b);const D=t.clone(),O=this._extendCameraOptions(b),k=D.padding;D.bearing=v;const H=c.LngLat.convert(s),J=c.LngLat.convert(p),ue=new c.LngLat(H.lng,J.lat),De=new c.LngLat(J.lng,H.lat),je=D.project(H),ke=D.project(J),Ye=this.queryTerrainElevation(H),$e=this.queryTerrainElevation(J),Be=this.queryTerrainElevation(ue),Xe=this.queryTerrainElevation(De),We=[[je.x,je.y,Math.min(Ye||0,$e||0,Be||0,Xe||0)],[ke.x,ke.y,Math.max(Ye||0,$e||0,Be||0,Xe||0)]];let gt=c.Aabb.fromPoints(We);const yt=D.getWorldToCameraMatrix(),ot=c.invert(new Float64Array(16),yt);gt=c.Aabb.applyTransform(gt,yt);const It=c.sub([],gt.max,gt.min),Jt=k.left||0,cn=k.right||0,Xt=k.bottom||0,An=k.top||0,{left:Zt,right:bn,top:yn,bottom:Kt}=O.padding,Nt=.5*(Jt+cn),qn=.5*(An+Xt),zn=Math.min(D.scaleZoom(D.scale*Math.min((D.width-(Jt+cn+Zt+bn))/It[0],(D.height-(Xt+An+Kt+yn))/It[1])),O.maxZoom),jn=D.scale/D.zoomScale(zn);gt=new c.Aabb([gt.min[0]-(Zt+Nt)*jn,gt.min[1]-(Kt+qn)*jn,gt.min[2]],[gt.max[0]+(bn+Nt)*jn,gt.max[1]+(yn+qn)*jn,gt.max[2]]);const Bn=.5*It[2],si=this._minimumAABBFrustumDistance(D,gt),Di=[0,0,1,0];c.transformMat4$1(Di,Di,yt),c.normalize$2(Di,Di);const yi=c.scale$2([],Di,si+Bn),pi=c.add([],gt.center,yi),Nn=("number"==typeof O.offset.x&&"number"==typeof O.offset.y?new c.pointGeometry(O.offset.x,O.offset.y):c.pointGeometry.convert(O.offset)).rotate(-c.degToRad(v));gt.center[0]-=Nn.x*jn,gt.center[1]+=Nn.y*jn,c.transformMat4(gt.center,gt.center,ot),c.transformMat4(pi,pi,ot);const Ri=[gt.center[0],gt.center[1],pi[2]*D.pixelsPerMeter];c.scale$2(Ri,Ri,1/D.worldSize);const $i=c.lngFromMercatorX(Ri[0]),Lr=c.latFromMercatorY(Ri[1]),Ir=Math.min(D._zoomFromMercatorZ(Ri[2]),O.maxZoom),Ar=new c.LngLat($i,Lr);return D.mercatorFromTransition&&Ir<.5*(c.GLOBE_ZOOM_THRESHOLD_MIN+c.GLOBE_ZOOM_THRESHOLD_MAX)?(D.setProjection({name:"globe"}),D.zoom=Ir,this._cameraForBounds(D,s,p,v,b)):{center:Ar,zoom:Ir,bearing:v}}fitBounds(t,s,p){const v=this.cameraForBounds(t,s);return this._fitInternal(v,s,p)}fitScreenCoordinates(t,s,p,v,b){const D=c.pointGeometry.convert(t),O=c.pointGeometry.convert(s),k=new c.pointGeometry(Math.min(D.x,O.x),Math.min(D.y,O.y)),H=new c.pointGeometry(Math.max(D.x,O.x),Math.max(D.y,O.y));if("mercator"===this.transform.projection.name&&this.transform.anyCornerOffEdge(D,O))return this;const J=this.transform.pointLocation3D(k),ue=this.transform.pointLocation3D(H),De=this.transform.pointLocation3D(new c.pointGeometry(k.x,H.y)),je=this.transform.pointLocation3D(new c.pointGeometry(H.x,k.y)),ke=[Math.min(J.lng,ue.lng,De.lng,je.lng),Math.min(J.lat,ue.lat,De.lat,je.lat)],Ye=[Math.max(J.lng,ue.lng,De.lng,je.lng),Math.max(J.lat,ue.lat,De.lat,je.lat)],$e=this._cameraForBounds(this.transform,ke,Ye,p,v);return this._fitInternal($e,v,b)}_fitInternal(t,s,p){return t?(delete(s=c.extend(t,s)).padding,s.linear?this.easeTo(s,p):this.flyTo(s,p)):this}jumpTo(t,s){this.stop();const p=t.preloadOnly?this.transform.clone():this.transform;let v=!1,b=!1,D=!1;return"zoom"in t&&p.zoom!==+t.zoom&&(v=!0,p.zoom=+t.zoom),void 0!==t.center&&(p.center=c.LngLat.convert(t.center)),"bearing"in t&&p.bearing!==+t.bearing&&(b=!0,p.bearing=+t.bearing),"pitch"in t&&p.pitch!==+t.pitch&&(D=!0,p.pitch=+t.pitch),null==t.padding||p.isPaddingEqual(t.padding)||(p.padding=t.padding),t.preloadOnly?(this._preloadTiles(p),this):(this.fire(new c.Event("movestart",s)).fire(new c.Event("move",s)),v&&this.fire(new c.Event("zoomstart",s)).fire(new c.Event("zoom",s)).fire(new c.Event("zoomend",s)),b&&this.fire(new c.Event("rotatestart",s)).fire(new c.Event("rotate",s)).fire(new c.Event("rotateend",s)),D&&this.fire(new c.Event("pitchstart",s)).fire(new c.Event("pitch",s)).fire(new c.Event("pitchend",s)),this.fire(new c.Event("moveend",s)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||c.warnOnce(Ur),this.transform.getFreeCameraOptions()}setFreeCameraOptions(t,s){const p=this.transform;if(!p.projection.supportsFreeCamera)return c.warnOnce(Ur),this;this.stop();const v=p.zoom,b=p.pitch,D=p.bearing;p.setFreeCameraOptions(t);const O=v!==p.zoom,k=b!==p.pitch,H=D!==p.bearing;return this.fire(new c.Event("movestart",s)).fire(new c.Event("move",s)),O&&this.fire(new c.Event("zoomstart",s)).fire(new c.Event("zoom",s)).fire(new c.Event("zoomend",s)),H&&this.fire(new c.Event("rotatestart",s)).fire(new c.Event("rotate",s)).fire(new c.Event("rotateend",s)),k&&this.fire(new c.Event("pitchstart",s)).fire(new c.Event("pitch",s)).fire(new c.Event("pitchend",s)),this.fire(new c.Event("moveend",s)),this}easeTo(t,s){this._stop(!1,t.easeId),(!1===(t=c.extend({offset:[0,0],duration:500,easing:c.ease},t)).animate||!t.essential&&c.exported.prefersReducedMotion)&&(t.duration=0);const p=this.transform,v=this.getZoom(),b=this.getBearing(),D=this.getPitch(),O=this.getPadding(),k="zoom"in t?+t.zoom:v,H="bearing"in t?this._normalizeBearing(t.bearing,b):b,J="pitch"in t?+t.pitch:D,ue="padding"in t?t.padding:p.padding,De=c.pointGeometry.convert(t.offset);let je,ke,Ye;if("globe"===p.projection.name){const cn=c.MercatorCoordinate.fromLngLat(p.center),Xt=De.rotate(-p.angle);cn.x+=Xt.x/p.worldSize,cn.y+=Xt.y/p.worldSize;const An=cn.toLngLat(),Zt=c.LngLat.convert(t.center||An);this._normalizeCenter(Zt),je=p.centerPoint.add(Xt),ke=new c.pointGeometry(cn.x,cn.y).mult(p.worldSize),Ye=new c.pointGeometry(c.mercatorXfromLng(Zt.lng),c.mercatorYfromLat(Zt.lat)).mult(p.worldSize).sub(ke)}else{je=p.centerPoint.add(De);const cn=p.pointLocation(je),Xt=c.LngLat.convert(t.center||cn);this._normalizeCenter(Xt),ke=p.project(cn),Ye=p.project(Xt).sub(ke)}const $e=p.zoomScale(k-v);let Be,Xe;t.around&&(Be=c.LngLat.convert(t.around),Xe=p.locationPoint(Be));const We=this._zooming||k!==v,gt=this._rotating||b!==H,yt=this._pitching||J!==D,ot=!p.isPaddingEqual(ue),It=cn=>Xt=>{if(We&&(cn.zoom=c.number(v,k,Xt)),gt&&(cn.bearing=c.number(b,H,Xt)),yt&&(cn.pitch=c.number(D,J,Xt)),ot&&(cn.interpolatePadding(O,ue,Xt),je=cn.centerPoint.add(De)),Be)cn.setLocationAtPoint(Be,Xe);else{const An=cn.zoomScale(cn.zoom-v),Zt=k>v?Math.min(2,$e):Math.max(.5,$e),bn=Math.pow(Zt,1-Xt),yn=cn.unproject(ke.add(Ye.mult(Xt*bn)).mult(An));cn.setLocationAtPoint(cn.renderWorldCopies?yn.wrap():yn,je)}return t.preloadOnly||this._fireMoveEvents(s),cn};if(t.preloadOnly){const cn=this._emulate(It,t.duration,p);return this._preloadTiles(cn),this}const Jt={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=We,this._rotating=gt,this._pitching=yt,this._padding=ot,this._easeId=t.easeId,this._prepareEase(s,t.noMoveStart,Jt),this._ease(It(p),cn=>{p.recenterOnTerrain(),this._afterEase(s,cn)},t),this}_prepareEase(t,s,p={}){this._moving=!0,this.transform.cameraElevationReference="sea",s||p.moving||this.fire(new c.Event("movestart",t)),this._zooming&&!p.zooming&&this.fire(new c.Event("zoomstart",t)),this._rotating&&!p.rotating&&this.fire(new c.Event("rotatestart",t)),this._pitching&&!p.pitching&&this.fire(new c.Event("pitchstart",t))}_fireMoveEvents(t){this.fire(new c.Event("move",t)),this._zooming&&this.fire(new c.Event("zoom",t)),this._rotating&&this.fire(new c.Event("rotate",t)),this._pitching&&this.fire(new c.Event("pitch",t))}_afterEase(t,s){if(this._easeId&&s&&this._easeId===s)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const p=this._zooming,v=this._rotating,b=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,p&&this.fire(new c.Event("zoomend",t)),v&&this.fire(new c.Event("rotateend",t)),b&&this.fire(new c.Event("pitchend",t)),this.fire(new c.Event("moveend",t))}flyTo(t,s){if(!t.essential&&c.exported.prefersReducedMotion){const jn=c.pick(t,["center","zoom","bearing","pitch","around"]);return this.jumpTo(jn,s)}this.stop(),t=c.extend({offset:[0,0],speed:1.2,curve:1.42,easing:c.ease},t);const p=this.transform,v=this.getZoom(),b=this.getBearing(),D=this.getPitch(),O=this.getPadding(),k="zoom"in t?c.clamp(+t.zoom,p.minZoom,p.maxZoom):v,H="bearing"in t?this._normalizeBearing(t.bearing,b):b,J="pitch"in t?+t.pitch:D,ue="padding"in t?t.padding:p.padding,De=p.zoomScale(k-v),je=c.pointGeometry.convert(t.offset);let ke=p.centerPoint.add(je);const Ye=p.pointLocation(ke),$e=c.LngLat.convert(t.center||Ye);this._normalizeCenter($e);const Be=p.project(Ye),Xe=p.project($e).sub(Be);let We=t.curve;const gt=Math.max(p.width,p.height),yt=gt/De,ot=Xe.mag();if("minZoom"in t){const jn=c.clamp(Math.min(t.minZoom,v,k),p.minZoom,p.maxZoom),Bn=gt/p.zoomScale(jn-v);We=Math.sqrt(Bn/ot*2)}const It=We*We;function Jt(jn){const Bn=(yt*yt-gt*gt+(jn?-1:1)*It*It*ot*ot)/(2*(jn?yt:gt)*It*ot);return Math.log(Math.sqrt(Bn*Bn+1)-Bn)}function cn(jn){return(Math.exp(jn)-Math.exp(-jn))/2}function Xt(jn){return(Math.exp(jn)+Math.exp(-jn))/2}const An=Jt(0);let Zt=function(jn){return Xt(An)/Xt(An+We*jn)},bn=function(jn){return gt*((Xt(An)*(cn(Bn=An+We*jn)/Xt(Bn))-cn(An))/It)/ot;var Bn},yn=(Jt(1)-An)/We;if(Math.abs(ot)<1e-6||!isFinite(yn)){if(Math.abs(gt-yt)<1e-6)return this.easeTo(t,s);const jn=yt<gt?-1:1;yn=Math.abs(Math.log(yt/gt))/We,bn=function(){return 0},Zt=function(Bn){return Math.exp(jn*We*Bn)}}t.duration="duration"in t?+t.duration:1e3*yn/("screenSpeed"in t?+t.screenSpeed/We:+t.speed),t.maxDuration&&t.duration>t.maxDuration&&(t.duration=0);const Kt=b!==H,Nt=J!==D,qn=!p.isPaddingEqual(ue),zn=jn=>Bn=>{const si=Bn*yn,Di=1/Zt(si);jn.zoom=1===Bn?k:v+jn.scaleZoom(Di),Kt&&(jn.bearing=c.number(b,H,Bn)),Nt&&(jn.pitch=c.number(D,J,Bn)),qn&&(jn.interpolatePadding(O,ue,Bn),ke=jn.centerPoint.add(je));const yi=1===Bn?$e:jn.unproject(Be.add(Xe.mult(bn(si))).mult(Di));return jn.setLocationAtPoint(jn.renderWorldCopies?yi.wrap():yi,ke),jn._updateCameraOnTerrain(),t.preloadOnly||this._fireMoveEvents(s),jn};if(t.preloadOnly){const jn=this._emulate(zn,t.duration,p);return this._preloadTiles(jn),this}return this._zooming=!0,this._rotating=Kt,this._pitching=Nt,this._padding=qn,this._prepareEase(s,!1),this._ease(zn(p),()=>this._afterEase(s),t),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(t,s){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const p=this._onEaseEnd;this._onEaseEnd=void 0,p.call(this,s)}if(!t){const p=this.handlers;p&&p.stop(!1)}return this}_ease(t,s,p){!1===p.animate||0===p.duration?(t(1),s()):(this._easeStart=c.exported.now(),this._easeOptions=p,this._onEaseFrame=t,this._onEaseEnd=s,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const t=Math.min((c.exported.now()-this._easeStart)/this._easeOptions.duration,1),s=this._onEaseFrame;s&&s(this._easeOptions.easing(t)),t<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(t,s){t=c.wrap(t,-180,180);const p=Math.abs(t-s);return Math.abs(t-360-s)<p&&(t-=360),Math.abs(t+360-s)<p&&(t+=360),t}_normalizeCenter(t){const s=this.transform;if(!s.renderWorldCopies||s.maxBounds)return;const p=t.lng-s.center.lng;t.lng+=p>180?-360:p<-180?360:0}_emulate(t,s,p){const v=Math.ceil(15*s/1e3),b=[],D=t(p.clone());for(let O=0;O<=v;O++){const k=D(O/v);b.push(k.clone())}return b}}class eu{constructor(t={}){this.options=t,c.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(t){const s=this.options&&this.options.compact;return this._map=t,this._container=Ie("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=Ie("button","mapboxgl-ctrl-attrib-button",this._container),Ie("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden","true"),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=Ie("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),s&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),void 0===s&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(t,s){const p=this._map._getUIString(`AttributionControl.${s}`);t.setAttribute("aria-label",p),t.removeAttribute("title"),t.firstElementChild&&t.firstElementChild.setAttribute("title",p)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let t=this._editLink;t||(t=this._editLink=this._container.querySelector(".mapbox-improve-map"));const s=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||c.config.ACCESS_TOKEN}];if(t){const p=s.reduce((v,b,D)=>(b.value&&(v+=`${b.key}=${b.value}${D<s.length-1?"&":""}`),v),"?");t.href=`${c.config.FEEDBACK_URL}/${p}#${ql(this._map,!0)}`,t.rel="noopener nofollow",this._setElementTitle(t,"MapFeedback")}}_updateData(t){!t||"metadata"!==t.sourceDataType&&"visibility"!==t.sourceDataType&&"style"!==t.dataType||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let t=[];if(this._map.style.stylesheet){const v=this._map.style.stylesheet;this.styleOwner=v.owner,this.styleId=v.id}const s=this._map.style._sourceCaches;for(const v in s){const b=s[v];if(b.used){const D=b.getSource();D.attribution&&t.indexOf(D.attribution)<0&&t.push(D.attribution)}}t.sort((v,b)=>v.length-b.length),t=t.filter((v,b)=>{for(let D=b+1;D<t.length;D++)if(t[D].indexOf(v)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?t=[...this.options.customAttribution,...t]:t.unshift(this.options.customAttribution));const p=t.join(" | ");p!==this._attribHTML&&(this._attribHTML=p,t.length?(this._innerContainer.innerHTML=p,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class Oc{constructor(){c.bindAll(["_updateLogo","_updateCompact"],this)}onAdd(t){this._map=t,this._container=Ie("div","mapboxgl-ctrl");const s=Ie("a","mapboxgl-ctrl-logo");return s.target="_blank",s.rel="noopener nofollow",s.href="https://www.mapbox.com/",s.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),s.setAttribute("rel","noopener nofollow"),this._container.appendChild(s),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(t){t&&"metadata"!==t.sourceDataType||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const t=this._map.style._sourceCaches;if(0===Object.entries(t).length)return!0;for(const s in t){const p=t[s].getSource();if(p.hasOwnProperty("mapbox_logo")&&!p.mapbox_logo)return!1}return!0}_updateCompact(){const t=this._container.children;if(t.length){const s=t[0];this._map.getCanvasContainer().offsetWidth<250?s.classList.add("mapboxgl-compact"):s.classList.remove("mapboxgl-compact")}}}class Eu{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(t){const s=++this._id;return this._queue.push({callback:t,id:s,cancelled:!1}),s}remove(t){const s=this._currentlyRunning,p=s?this._queue.concat(s):this._queue;for(const v of p)if(v.id===t)return void(v.cancelled=!0)}run(t=0){const s=this._currentlyRunning=this._queue;this._queue=[];for(const p of s)if(!p.cancelled&&(p.callback(t),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function Ha(l,t,s){if(l=new c.LngLat(l.lng,l.lat),t){const p=new c.LngLat(l.lng-360,l.lat),v=new c.LngLat(l.lng+360,l.lat),b=360*Math.ceil(Math.abs(l.lng-s.center.lng)/360),D=s.locationPoint(l).distSqr(t),O=t.x<0||t.y<0||t.x>s.width||t.y>s.height;s.locationPoint(p).distSqr(t)<D&&(O||Math.abs(p.lng-s.center.lng)<b)?l=p:s.locationPoint(v).distSqr(t)<D&&(O||Math.abs(v.lng-s.center.lng)<b)&&(l=v)}for(;Math.abs(l.lng-s.center.lng)>180;){const p=s.locationPoint(l);if(p.x>=0&&p.y>=0&&p.x<=s.width&&p.y<=s.height)break;l.lng>s.center.lng?l.lng-=360:l.lng+=360}return l}const Du={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class Rc extends c.Evented{constructor(t,s){if(super(),(t instanceof c.window.HTMLElement||s)&&(t=c.extend({element:t},s)),c.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=t&&t.anchor||"center",this._color=t&&t.color||"#3FB1CE",this._scale=t&&t.scale||1,this._draggable=t&&t.draggable||!1,this._clickTolerance=t&&t.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=t&&t.rotation||0,this._rotationAlignment=t&&t.rotationAlignment||"auto",this._pitchAlignment=t&&t.pitchAlignment&&t.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=t&&t.occludedOpacity||.2,t&&t.element)this._element=t.element,this._offset=c.pointGeometry.convert(t&&t.offset||[0,0]);else{this._defaultMarker=!0,this._element=Ie("div");const v=41,b=27,D=Ge("svg",{display:"block",height:v*this._scale+"px",width:b*this._scale+"px",viewBox:`0 0 ${b} ${v}`},this._element),O=Ge("radialGradient",{id:"shadowGradient"},Ge("defs",{},D));Ge("stop",{offset:"10%","stop-opacity":.4},O),Ge("stop",{offset:"100%","stop-opacity":.05},O),Ge("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},D),Ge("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},D),Ge("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},D),Ge("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},D),this._offset=c.pointGeometry.convert(t&&t.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",v=>{v.preventDefault()}),this._element.addEventListener("mousedown",v=>{v.preventDefault()});const p=this._element.classList;for(const v in Du)p.remove(`mapboxgl-marker-anchor-${v}`);p.add(`mapboxgl-marker-anchor-${this._anchor}`),this._popup=null}addTo(t){return t===this._map||(this.remove(),this._map=t,t.getCanvasContainer().appendChild(this._element),t.on("move",this._updateMoving),t.on("moveend",this._update),t.on("remove",this._clearFadeTimer),t._addMarker(this),this.setDraggable(this._draggable),this._update(),t.on("click",this._onMapClick)),this}remove(){const t=this._map;return t&&(t.off("click",this._onMapClick),t.off("move",this._updateMoving),t.off("moveend",this._update),t.off("mousedown",this._addDragHandler),t.off("touchstart",this._addDragHandler),t.off("mouseup",this._onUp),t.off("touchend",this._onUp),t.off("mousemove",this._onMove),t.off("touchmove",this._onMove),t.off("remove",this._clearFadeTimer),t._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(t){return this._lngLat=c.LngLat.convert(t),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(t){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),t){if(!("offset"in t.options)){const v=Math.sqrt(Math.pow(13.5,2)/2);t.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[v,-1*(24.6+v)],"bottom-right":[-v,-1*(24.6+v)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=t,t._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(t){const s=t.code,p=t.charCode||t.keyCode;"Space"!==s&&"Enter"!==s&&32!==p&&13!==p||this.togglePopup()}_onMapClick(t){const s=t.originalEvent.target,p=this._element;this._popup&&(s===p||p.contains(s))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const t=this._popup;return t?(t.isOpen()?(t.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(t.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const t=this._map,s=this._pos;if(!t||!s)return!1;const p=t.unproject(s),v=t.getFreeCameraOptions();if(!v.position)return!1;const b=v.position.toLngLat();return b.distanceTo(p)<.9*b.distanceTo(this._lngLat)}_evaluateOpacity(){const t=this._map;if(!t)return;const s=this._pos;if(!s||s.x<0||s.x>t.transform.width||s.y<0||s.y>t.transform.height)return void this._clearFadeTimer();const p=t.unproject(s);let v;t._showingGlobe()&&c.isLngLatBehindGlobe(t.transform,this._lngLat)?v=0:(v=1-t._queryFogOpacity(p),t.transform._terrainEnabled()&&t.getTerrain()&&this._behindTerrain()&&(v*=this._occludedOpacity)),this._element.style.opacity=`${v}`,this._element.style.pointerEvents=v>0?"auto":"none",this._popup&&this._popup._setOpacity(v),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const t=this._pos;if(!t||!this._map)return;const s=this._offset.mult(this._scale);this._element.style.transform=`\n            translate(${t.x}px,${t.y}px)\n            ${Du[this._anchor]}\n            ${this._calculateXYTransform()} ${this._calculateZTransform()}\n            translate(${s.x}px,${s.y}px)\n        `}_calculateXYTransform(){const t=this._pos,s=this._map,p=this.getPitchAlignment();if(!s||!t||"map"!==p)return"";if(!s._showingGlobe()){const k=s.getPitch();return k?`rotateX(${k}deg)`:""}const v=c.radToDeg(c.globeTiltAtLngLat(s.transform,this._lngLat)),b=t.sub(c.globeCenterToScreenPoint(s.transform)),D=Math.abs(b.x)+Math.abs(b.y);if(0===D)return"";const O=v/D;return`rotateX(${-b.y*O}deg) rotateY(${b.x*O}deg)`}_calculateZTransform(){const t=this._pos,s=this._map;if(!s||!t)return"";let p=0;const v=this.getRotationAlignment();if("map"===v)if(s._showingGlobe()){const b=s.project(new c.LngLat(this._lngLat.lng,this._lngLat.lat+.001)),D=s.project(new c.LngLat(this._lngLat.lng,this._lngLat.lat-.001)).sub(b);p=c.radToDeg(Math.atan2(D.y,D.x))-90}else p=-s.getBearing();else if("horizon"===v){const b=c.smoothstep(4,6,s.getZoom()),D=c.globeCenterToScreenPoint(s.transform);D.y+=b*s.transform.height;const O=t.sub(D),k=c.radToDeg(Math.atan2(O.y,O.x));p=(k>90?k-270:k+90)*(1-b)}return p+=this._rotation,p?`rotateZ(${p}deg)`:""}_update(t){c.window.cancelAnimationFrame(this._updateFrameId);const s=this._map;s&&(s.transform.renderWorldCopies&&(this._lngLat=Ha(this._lngLat,this._pos,s.transform)),this._pos=s.project(this._lngLat),!0===t?this._updateFrameId=c.window.requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),s._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(s._showingGlobe()||s.getTerrain()||s.getFog())&&!this._fadeTimer&&(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(t){return this._offset=c.pointGeometry.convert(t),this._update(),this}_onMove(t){const s=this._map;if(!s)return;const p=this._pointerdownPos,v=this._positionDelta;if(p&&v){if(!this._isDragging){const b=this._clickTolerance||s._clickTolerance;if(t.point.dist(p)<b)return;this._isDragging=!0}this._pos=t.point.sub(v),this._lngLat=s.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new c.Event("dragstart"))),this.fire(new c.Event("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const t=this._map;t&&(t.off("mousemove",this._onMove),t.off("touchmove",this._onMove)),"active"===this._state&&this.fire(new c.Event("dragend")),this._state="inactive"}_addDragHandler(t){const s=this._map,p=this._pos;s&&p&&this._element.contains(t.originalEvent.target)&&(t.preventDefault(),this._positionDelta=t.point.sub(p),this._pointerdownPos=t.point,this._state="pending",s.on("mousemove",this._onMove),s.on("touchmove",this._onMove),s.once("mouseup",this._onUp),s.once("touchend",this._onUp))}setDraggable(t){this._draggable=!!t;const s=this._map;return s&&(t?(s.on("mousedown",this._addDragHandler),s.on("touchstart",this._addDragHandler)):(s.off("mousedown",this._addDragHandler),s.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(t){return this._rotation=t||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(t){return this._rotationAlignment=t||"auto",this._update(),this}getRotationAlignment(){return"auto"===this._rotationAlignment||"horizon"===this._rotationAlignment&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(t){return this._pitchAlignment=t||"auto",this._update(),this}getPitchAlignment(){return"auto"===this._pitchAlignment?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(t){return this._occludedOpacity=t||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const Ll={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},hd=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Iu(l=new c.pointGeometry(0,0),t="bottom"){if("number"==typeof l){const s=Math.round(Math.sqrt(.5*Math.pow(l,2)));switch(t){case"top":return new c.pointGeometry(0,l);case"top-left":return new c.pointGeometry(s,s);case"top-right":return new c.pointGeometry(-s,s);case"bottom":return new c.pointGeometry(0,-l);case"bottom-left":return new c.pointGeometry(s,-s);case"bottom-right":return new c.pointGeometry(-s,-s);case"left":return new c.pointGeometry(l,0);case"right":return new c.pointGeometry(-l,0)}return new c.pointGeometry(0,0)}return l instanceof c.pointGeometry||Array.isArray(l)?c.pointGeometry.convert(l):c.pointGeometry.convert(l[t]||[0,0])}class wo{constructor(t){this.jumpTo(t)}getValue(t){if(t<=this._startTime)return this._start;if(t>=this._endTime)return this._end;const s=c.easeCubicInOut((t-this._startTime)/(this._endTime-this._startTime));return this._start*(1-s)+this._end*s}isEasing(t){return t>=this._startTime&&t<=this._endTime}jumpTo(t){this._startTime=-1/0,this._endTime=-1/0,this._start=t,this._end=t}easeTo(t,s,p){this._start=this.getValue(s),this._end=t,this._startTime=s,this._endTime=s+p}}const Lc={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use \u2318 + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},ll={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,optimizeForTerrain:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0};function Fc(l){l.parentNode&&l.parentNode.removeChild(l)}const Ps={showCompass:!0,showZoom:!0,visualizePitch:!1};class Sa{constructor(t,s,p=!1){this._clickTolerance=10,this.element=s,this.mouseRotate=new tc({clickTolerance:t.dragRotate._mouseRotate._clickTolerance}),this.map=t,p&&(this.mousePitch=new sl({clickTolerance:t.dragRotate._mousePitch._clickTolerance})),c.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),s.addEventListener("mousedown",this.mousedown),s.addEventListener("touchstart",this.touchstart,{passive:!1}),s.addEventListener("touchmove",this.touchmove),s.addEventListener("touchend",this.touchend),s.addEventListener("touchcancel",this.reset)}down(t,s){this.mouseRotate.mousedown(t,s),this.mousePitch&&this.mousePitch.mousedown(t,s),Ze()}move(t,s){const p=this.map,v=this.mouseRotate.mousemoveWindow(t,s),b=v&&v.bearingDelta;if(b&&p.setBearing(p.getBearing()+b),this.mousePitch){const D=this.mousePitch.mousemoveWindow(t,s),O=D&&D.pitchDelta;O&&p.setPitch(p.getPitch()+O)}}off(){const t=this.element;t.removeEventListener("mousedown",this.mousedown),t.removeEventListener("touchstart",this.touchstart,{passive:!1}),t.removeEventListener("touchmove",this.touchmove),t.removeEventListener("touchend",this.touchend),t.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){he(),c.window.removeEventListener("mousemove",this.mousemove),c.window.removeEventListener("mouseup",this.mouseup)}mousedown(t){this.down(c.extend({},t,{ctrlKey:!0,preventDefault:()=>t.preventDefault()}),te(this.element,t)),c.window.addEventListener("mousemove",this.mousemove),c.window.addEventListener("mouseup",this.mouseup)}mousemove(t){this.move(t,te(this.element,t))}mouseup(t){this.mouseRotate.mouseupWindow(t),this.mousePitch&&this.mousePitch.mouseupWindow(t),this.offTemp()}touchstart(t){1!==t.targetTouches.length?this.reset():(this._startPos=this._lastPos=Qe(this.element,t.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>t.preventDefault()},this._startPos))}touchmove(t){1!==t.targetTouches.length?this.reset():(this._lastPos=Qe(this.element,t.targetTouches)[0],this.move({preventDefault:()=>t.preventDefault()},this._lastPos))}touchend(t){0===t.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const tu={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},sc={maxWidth:100,unit:"metric"};function P(l,t,s){const p=F(t),v=p/t,b={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"}[s];this._map._requestDomTask(()=>{this._container.style.width=l*v+"px",this._container.innerHTML=`${p}&nbsp;${b}`})}function F(l){const t=Math.pow(10,`${Math.floor(l)}`.length-1);let s=l/t;return s=s>=10?10:s>=5?5:s>=3?3:s>=2?2:s>=1?1:function(p){const v=Math.pow(10,Math.ceil(-Math.log(p)/Math.LN10));return Math.round(p*v)/v}(s),t*s}const S={version:c.version,supported:se,setRTLTextPlugin:c.setRTLTextPlugin,getRTLTextPluginStatus:c.getRTLTextPluginStatus,Map:class extends dd{constructor(l){if(c.LivePerformanceUtils.mark(c.PerformanceMarkers.create),null!=(l=c.extend({},ll,l)).minZoom&&null!=l.maxZoom&&l.minZoom>l.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=l.minPitch&&null!=l.maxPitch&&l.minPitch>l.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=l.minPitch&&l.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(null!=l.maxPitch&&l.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(l.antialias&&c.isSafariWithAntialiasingBug(c.window)&&(l.antialias=!1,c.warnOnce("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new ho(l.minZoom,l.maxZoom,l.minPitch,l.maxPitch,l.renderWorldCopies),l),this._interactive=l.interactive,this._minTileCacheSize=l.minTileCacheSize,this._maxTileCacheSize=l.maxTileCacheSize,this._failIfMajorPerformanceCaveat=l.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=l.preserveDrawingBuffer,this._antialias=l.antialias,this._trackResize=l.trackResize,this._bearingSnap=l.bearingSnap,this._refreshExpiredTiles=l.refreshExpiredTiles,this._fadeDuration=l.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=l.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=l.collectResourceTiming,this._optimizeForTerrain=l.optimizeForTerrain,this._language=this._parseLanguage(l.language),this._worldview=l.worldview,this._renderTaskQueue=new Eu,this._domRenderTaskQueue=new Eu,this._controls=[],this._markers=[],this._popups=[],this._mapId=c.uniqueId(),this._locale=c.extend({},Lc,l.locale),this._clickTolerance=l.clickTolerance,this._cooperativeGestures=l.cooperativeGestures,this._performanceMetricsCollection=l.performanceMetricsCollection,this._containerWidth=0,this._containerHeight=0,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new wo(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._requestManager=new c.RequestManager(l.transformRequest,l.accessToken,l.testMode),this._silenceAuthErrors=!!l.testMode,"string"==typeof l.container){if(this._container=c.window.document.getElementById(l.container),!this._container)throw new Error(`Container '${l.container}' not found.`)}else{if(!(l.container instanceof c.window.HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=l.container}if(this._container.childNodes.length>0&&c.warnOnce("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),l.maxBounds&&this.setMaxBounds(l.maxBounds),c.bindAll(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),void 0===this.painter)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),void 0!==c.window&&(c.window.addEventListener("online",this._onWindowOnline,!1),c.window.addEventListener("resize",this._onWindowResize,!1),c.window.addEventListener("orientationchange",this._onWindowResize,!1),c.window.addEventListener("webkitfullscreenchange",this._onWindowResize,!1),c.window.addEventListener("visibilitychange",this._onVisibilityChange,!1)),this.handlers=new Tu(this,l),this._localFontFamily=l.localFontFamily,this._localIdeographFontFamily=l.localIdeographFontFamily,l.style&&this.setStyle(l.style,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),l.projection&&this.setProjection(l.projection),this._hash=l.hash&&new Wl("string"==typeof l.hash&&l.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:l.center,zoom:l.zoom,bearing:l.bearing,pitch:l.pitch}),l.bounds&&(this.resize(),this.fitBounds(l.bounds,c.extend({},l.fitBoundsOptions,{duration:0})))),this.resize(),l.attributionControl&&this.addControl(new eu({customAttribution:l.customAttribution})),this._logoControl=new Oc,this.addControl(this._logoControl,l.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",t=>{this._update("style"===t.dataType),this.fire(new c.Event(`${t.dataType}data`,t))}),this.on("dataloading",t=>{this.fire(new c.Event(`${t.dataType}dataloading`,t))})}_getMapId(){return this._mapId}addControl(l,t){if(void 0===t&&(t=l.getDefaultPosition?l.getDefaultPosition():"top-right"),!l||!l.onAdd)return this.fire(new c.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const s=l.onAdd(this);this._controls.push(l);const p=this._controlPositions[t];return-1!==t.indexOf("bottom")?p.insertBefore(s,p.firstChild):p.appendChild(s),this}removeControl(l){if(!l||!l.onRemove)return this.fire(new c.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const t=this._controls.indexOf(l);return t>-1&&this._controls.splice(t,1),l.onRemove(this),this}hasControl(l){return this._controls.indexOf(l)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(l){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const t=!this._moving;return t&&this.fire(new c.Event("movestart",l)).fire(new c.Event("move",l)),this.fire(new c.Event("resize",l)),t&&this.fire(new c.Event("moveend",l)),this}getBounds(){return"globe"===this.transform.projection.name&&c.warnOnce('Globe projection does not support getBounds API, this API may behave unexpectedly when viewing the poles."'),this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(l){return this.transform.setMaxBounds(c.LngLatBounds.convert(l)),this._update()}setMinZoom(l){if((l=l??-2)>=-2&&l<=this.transform.maxZoom)return this.transform.minZoom=l,this._update(),this.getZoom()<l?this.setZoom(l):this.fire(new c.Event("zoomstart")).fire(new c.Event("zoom")).fire(new c.Event("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(l){if((l=l??22)>=this.transform.minZoom)return this.transform.maxZoom=l,this._update(),this.getZoom()>l?this.setZoom(l):this.fire(new c.Event("zoomstart")).fire(new c.Event("zoom")).fire(new c.Event("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(l){if((l=l??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(l>=0&&l<=this.transform.maxPitch)return this.transform.minPitch=l,this._update(),this.getPitch()<l?this.setPitch(l):this.fire(new c.Event("pitchstart")).fire(new c.Event("pitch")).fire(new c.Event("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(l){if((l=l??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(l>=this.transform.minPitch)return this.transform.maxPitch=l,this._update(),this.getPitch()>l?this.setPitch(l):this.fire(new c.Event("pitchstart")).fire(new c.Event("pitch")).fire(new c.Event("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(l){return this.transform.renderWorldCopies=l,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(l){return"auto"===l?c.window.navigator.language:Array.isArray(l)?0===l.length?void 0:l.map(t=>"auto"===t?c.window.navigator.language:t):l}setLanguage(l){const t=this._parseLanguage(l);if(!this.style||t===this._language)return this;this._language=t,this.style._reloadSources();for(const s of this._controls)s._setLanguage&&s._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(l){return this.style&&l!==this._worldview?(this._worldview=l,this.style._reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return"globe"===this.transform.projection.name}setProjection(l){return this._lazyInitEmptyStyle(),l?"string"==typeof l&&(l={name:l}):l=null,this._useExplicitProjection=!!l,this._prioritizeAndUpdateProjection(l,this.style.stylesheet?this.style.stylesheet.projection:null)}_updateProjectionTransition(){if("globe"!==this.getProjection().name)return;const l=this.transform,t=l.projection.name;let s;"globe"===t&&l.zoom>=c.GLOBE_ZOOM_THRESHOLD_MAX?(l.setMercatorFromTransition(),s=!0):"mercator"===t&&l.zoom<c.GLOBE_ZOOM_THRESHOLD_MAX&&(l.setProjection({name:"globe"}),s=!0),s&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(l,t){return this._updateProjection(l||t||{name:"mercator"})}_updateProjection(l){let t;if(t="globe"===l.name&&this.transform.zoom>=c.GLOBE_ZOOM_THRESHOLD_MAX?this.transform.setMercatorFromTransition():this.transform.setProjection(l),this.style.applyProjectionUpdate(),t){this.painter.clearBackgroundTiles();for(const s in this.style._sourceCaches)this.style._sourceCaches[s].clearTiles();this._update(!0),this._forceMarkerAndPopupUpdate(!0)}return this}project(l){return this.transform.locationPoint3D(c.LngLat.convert(l))}unproject(l){return this.transform.pointLocation3D(c.pointGeometry.convert(l))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_createDelegatedListener(l,t,s){if("mouseenter"===l||"mouseover"===l){let p=!1;const v=D=>{const O=t.filter(H=>this.getLayer(H)),k=O.length?this.queryRenderedFeatures(D.point,{layers:O}):[];k.length?p||(p=!0,s.call(this,new $o(l,this,D.originalEvent,{features:k}))):p=!1},b=()=>{p=!1};return{layers:new Set(t),listener:s,delegates:{mousemove:v,mouseout:b}}}if("mouseleave"===l||"mouseout"===l){let p=!1;const v=D=>{const O=t.filter(k=>this.getLayer(k));(O.length?this.queryRenderedFeatures(D.point,{layers:O}):[]).length?p=!0:p&&(p=!1,s.call(this,new $o(l,this,D.originalEvent)))},b=D=>{p&&(p=!1,s.call(this,new $o(l,this,D.originalEvent)))};return{layers:new Set(t),listener:s,delegates:{mousemove:v,mouseout:b}}}{const p=v=>{const b=t.filter(O=>this.getLayer(O)),D=b.length?this.queryRenderedFeatures(v.point,{layers:b}):[];D.length&&(v.features=D,s.call(this,v),delete v.features)};return{layers:new Set(t),listener:s,delegates:{[l]:p}}}}on(l,t,s){if(void 0===s)return super.on(l,t);Array.isArray(t)||(t=[t]);const p=this._createDelegatedListener(l,t,s);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[l]=this._delegatedListeners[l]||[],this._delegatedListeners[l].push(p);for(const v in p.delegates)this.on(v,p.delegates[v]);return this}once(l,t,s){if(void 0===s)return super.once(l,t);Array.isArray(t)||(t=[t]);const p=this._createDelegatedListener(l,t,s);for(const v in p.delegates)this.once(v,p.delegates[v]);return this}off(l,t,s){if(void 0===s)return super.off(l,t);t=new Set(Array.isArray(t)?t:[t]);const p=(b,D)=>{if(b.size!==D.size)return!1;for(const O of b)if(!D.has(O))return!1;return!0},v=this._delegatedListeners?this._delegatedListeners[l]:void 0;return v&&(b=>{for(let D=0;D<b.length;D++){const O=b[D];if(O.listener===s&&p(O.layers,t)){for(const k in O.delegates)this.off(k,O.delegates[k]);return b.splice(D,1),this}}})(v),this}queryRenderedFeatures(l,t){return this.style?(void 0!==t||void 0===l||l instanceof c.pointGeometry||Array.isArray(l)||(t=l,l=void 0),this.style.queryRenderedFeatures(l=l||[[0,0],[this.transform.width,this.transform.height]],t=t||{},this.transform)):[]}querySourceFeatures(l,t){return this.style.querySourceFeatures(l,t)}setStyle(l,t){return!1!==(t=c.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},t)).diff&&t.localIdeographFontFamily===this._localIdeographFontFamily&&t.localFontFamily===this._localFontFamily&&this.style&&l?(this._diffStyle(l,t),this):(this._localIdeographFontFamily=t.localIdeographFontFamily,this._localFontFamily=t.localFontFamily,this._updateStyle(l,t))}_getUIString(l){const t=this._locale[l];if(null==t)throw new Error(`Missing UI string '${l}'`);return t}_updateStyle(l,t){return this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),l&&(this.style=new Ao(this,t||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof l?this.style.loadURL(l):this.style.loadJSON(l)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new Ao(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(l,t){if("string"==typeof l){const s=this._requestManager.normalizeStyleURL(l),p=this._requestManager.transformRequest(s,c.ResourceType.Style);c.getJSON(p,(v,b)=>{v?this.fire(new c.ErrorEvent(v)):b&&this._updateDiff(b,t)})}else"object"==typeof l&&this._updateDiff(l,t)}_updateDiff(l,t){try{this.style.setState(l)&&this._update(!0)}catch(s){c.warnOnce(`Unable to perform style diff: ${s.message||s.error||s}.  Rebuilding the style from scratch.`),this._updateStyle(l,t)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(c.warnOnce("There is no style added to the map."),!1)}addSource(l,t){return this._lazyInitEmptyStyle(),this.style.addSource(l,t),this._update(!0)}isSourceLoaded(l){return!!this.style&&this.style._isSourceCacheLoaded(l)}areTilesLoaded(){const l=this.style&&this.style._sourceCaches;for(const t in l){const s=l[t]._tiles;for(const p in s){const v=s[p];if("loaded"!==v.state&&"errored"!==v.state)return!1}}return!0}addSourceType(l,t,s){this._lazyInitEmptyStyle(),this.style.addSourceType(l,t,s)}removeSource(l){return this.style.removeSource(l),this._updateTerrain(),this._update(!0)}getSource(l){return this.style.getSource(l)}addImage(l,t,{pixelRatio:s=1,sdf:p=!1,stretchX:v,stretchY:b,content:D}={}){if(this._lazyInitEmptyStyle(),t instanceof c.window.HTMLImageElement||c.window.ImageBitmap&&t instanceof c.window.ImageBitmap){const{width:O,height:k,data:H}=c.exported.getImageData(t);this.style.addImage(l,{data:new c.RGBAImage({width:O,height:k},H),pixelRatio:s,stretchX:v,stretchY:b,content:D,sdf:p,version:0})}else if(void 0===t.width||void 0===t.height)this.fire(new c.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:O,height:k}=t,H=t;this.style.addImage(l,{data:new c.RGBAImage({width:O,height:k},new Uint8Array(H.data)),pixelRatio:s,stretchX:v,stretchY:b,content:D,sdf:p,version:0,userImage:H}),H.onAdd&&H.onAdd(this,l)}}updateImage(l,t){const s=this.style.getImage(l);if(!s)return void this.fire(new c.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const p=t instanceof c.window.HTMLImageElement||c.window.ImageBitmap&&t instanceof c.window.ImageBitmap?c.exported.getImageData(t):t,{width:v,height:b}=p;void 0!==v&&void 0!==b?v===s.data.width&&b===s.data.height?(s.data.replace(p.data,!(t instanceof c.window.HTMLImageElement||c.window.ImageBitmap&&t instanceof c.window.ImageBitmap)),this.style.updateImage(l,s)):this.fire(new c.ErrorEvent(new Error(`The width and height of the updated image (${v}, ${b})\n                must be that same as the previous version of the image\n                (${s.data.width}, ${s.data.height})`))):this.fire(new c.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")))}hasImage(l){return l?!!this.style.getImage(l):(this.fire(new c.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(l){this.style.removeImage(l)}loadImage(l,t){c.getImage(this._requestManager.transformRequest(l,c.ResourceType.Image),(s,p)=>{t(s,p instanceof c.window.HTMLImageElement?c.exported.getImageData(p):p)})}listImages(){return this.style.listImages()}addLayer(l,t){return this._lazyInitEmptyStyle(),this.style.addLayer(l,t),this._update(!0)}moveLayer(l,t){return this.style.moveLayer(l,t),this._update(!0)}removeLayer(l){return this.style.removeLayer(l),this._update(!0)}getLayer(l){return this.style.getLayer(l)}setLayerZoomRange(l,t,s){return this.style.setLayerZoomRange(l,t,s),this._update(!0)}setFilter(l,t,s={}){return this.style.setFilter(l,t,s),this._update(!0)}getFilter(l){return this.style.getFilter(l)}setPaintProperty(l,t,s,p={}){return this.style.setPaintProperty(l,t,s,p),this._update(!0)}getPaintProperty(l,t){return this.style.getPaintProperty(l,t)}setLayoutProperty(l,t,s,p={}){return this.style.setLayoutProperty(l,t,s,p),this._update(!0)}getLayoutProperty(l,t){return this.style.getLayoutProperty(l,t)}setLight(l,t={}){return this._lazyInitEmptyStyle(),this.style.setLight(l,t),this._update(!0)}getLight(){return this.style.getLight()}setTerrain(l){return this._lazyInitEmptyStyle(),!l&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(l),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(l){return this._lazyInitEmptyStyle(),this.style.setFog(l),this._update(!0)}getFog(){return this.style?this.style.getFog():null}_queryFogOpacity(l){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(c.LngLat.convert(l),this.transform):0}setFeatureState(l,t){return this.style.setFeatureState(l,t),this._update()}removeFeatureState(l,t){return this.style.removeFeatureState(l,t),this._update()}getFeatureState(l){return this.style.getFeatureState(l)}_updateContainerDimensions(){if(!this._container)return;const l=this._container.getBoundingClientRect().width||400,t=this._container.getBoundingClientRect().height||300;let s,p,v,b=this._container;for(;b&&(!p||!v);){const D=c.window.getComputedStyle(b).transform;D&&"none"!==D&&(s=D.match(/matrix.*\((.+)\)/)[1].split(", "),s[0]&&"0"!==s[0]&&"1"!==s[0]&&(p=s[0]),s[3]&&"0"!==s[3]&&"1"!==s[3]&&(v=s[3])),b=b.parentElement}this._containerWidth=p?Math.abs(l/p):l,this._containerHeight=v?Math.abs(t/v):t}_detectMissingCSS(){"rgb(250, 128, 114)"!==c.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")&&c.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const l=this._container;l.classList.add("mapboxgl-map"),(this._missingCSSCanary=Ie("div","mapboxgl-canary",l)).style.visibility="hidden",this._detectMissingCSS();const t=this._canvasContainer=Ie("div","mapboxgl-canvas-container",l);this._interactive&&t.classList.add("mapboxgl-interactive"),this._canvas=Ie("canvas","mapboxgl-canvas",t),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const s=this._controlContainer=Ie("div","mapboxgl-control-container",l),p=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(v=>{p[v]=Ie("div",`mapboxgl-ctrl-${v}`,s)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(l,t){const s=c.exported.devicePixelRatio||1;this._canvas.width=s*Math.ceil(l),this._canvas.height=s*Math.ceil(t),this._canvas.style.width=`${l}px`,this._canvas.style.height=`${t}px`}_addMarker(l){this._markers.push(l)}_removeMarker(l){const t=this._markers.indexOf(l);-1!==t&&this._markers.splice(t,1)}_addPopup(l){this._popups.push(l)}_removePopup(l){const t=this._popups.indexOf(l);-1!==t&&this._popups.splice(t,1)}_setupPainter(){const l=c.extend({},se.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),t=this._canvas.getContext("webgl",l)||this._canvas.getContext("experimental-webgl",l);t?(c.storeAuthState(t,!0),this.painter=new fn(t,this.transform),this.on("data",s=>{"source"===s.dataType&&this.painter.setTileLoadedFlag(!0)}),c.exported$1.testSupport(t)):this.fire(new c.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(l){l.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new c.Event("webglcontextlost",{originalEvent:l}))}_contextRestored(l){this._setupPainter(),this.resize(),this._update(),this.fire(new c.Event("webglcontextrestored",{originalEvent:l}))}_onMapScroll(l){if(l.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(l){return this.style?(this._styleDirty=this._styleDirty||l,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(l){return this._update(),this._renderTaskQueue.add(l)}_cancelRenderFrame(l){this._renderTaskQueue.remove(l)}_requestDomTask(l){!this.loaded()||this.loaded()&&!this.isMoving()?l():this._domRenderTaskQueue.add(l)}_render(l){let t;const s=this.painter.context.extTimerQuery,p=c.exported.now();if(this.listens("gpu-timing-frame")&&(t=s.createQueryEXT(),s.beginQueryEXT(s.TIME_ELAPSED_EXT,t)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],c.window.performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],c.window.performance.now())),this._renderTaskQueue.run(l),this._domRenderTaskQueue.run(l),this._removed)return;this._updateProjectionTransition();let v=!1;const b=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const k=this.transform.zoom,H=this.transform.pitch,J=c.exported.now();this.style.zoomHistory.update(k,J);const ue=new c.EvaluationParameters(k,{now:J,fadeDuration:b,pitch:H,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),De=ue.crossFadingFactor();1===De&&De===this._crossFadingFactor||(v=!0,this._crossFadingFactor=De),this.style.update(ue)}this.style&&this.style.fog&&this.style.fog.hasTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let D=!1;if(this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),D=this._updateAverageElevation(p),this.style._updateSources(this.transform),this._forceMarkerAndPopupUpdate()):D=this._updateAverageElevation(p),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,b,this._crossSourceCollisions),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showTerrainWireframe:this.showTerrainWireframe,showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:b,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new c.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new c.Event("load"))),this.style&&(this.style.hasTransitions()||v)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),t){const k=c.exported.now()-p;s.endQueryEXT(s.TIME_ELAPSED_EXT,t),setTimeout(()=>{const H=s.getQueryObjectEXT(t,s.QUERY_RESULT_EXT)/1e6;s.deleteQueryEXT(t),this.fire(new c.Event("gpu-timing-frame",{cpuTime:k,gpuTime:H})),c.window.performance.mark("frame-gpu",{startTime:p,detail:{gpuTime:H}})},50)}if(this.listens("gpu-timing-layer")){const k=this.painter.collectGpuTimers();setTimeout(()=>{const H=this.painter.queryGpuTimers(k);this.fire(new c.Event("gpu-timing-layer",{layerTimes:H}))},50)}if(this.listens("gpu-timing-deferred-render")){const k=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const H=this.painter.queryGpuTimeDeferredRender(k);this.fire(new c.Event("gpu-timing-deferred-render",{gpuTime:H}))},50)}const O=this._sourcesDirty||this._styleDirty||this._placementDirty||D;if(O||this._repaint)this.triggerRepaint();else{const k=!this.isMoving()&&this.loaded();if(k&&(D=this._updateAverageElevation(p,!0)),D)this.triggerRepaint();else if(this._triggerFrame(!1),k&&(this.fire(new c.Event("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const H=this._calculateSpeedIndex();this.fire(new c.Event("speedindexcompleted",{speedIndex:H})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||O||(this._fullyLoaded=!0,c.LivePerformanceUtils.mark(c.PerformanceMarkers.fullLoad),this._performanceMetricsCollection&&c.postPerformanceEvent(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.painter.transform.projection,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(l){for(const t of this._markers)l&&!this.getRenderWorldCopies()&&(t._lngLat=t._lngLat.wrap()),t._update();for(const t of this._popups)!l||this.getRenderWorldCopies()||t._trackPointer||(t._lngLat=t._lngLat.wrap()),t._update()}_updateAverageElevation(l,t=!1){const s=p=>(this.transform.averageElevation=p,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return 0!==this.transform.averageElevation&&s(0);if((t||l-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(l)){const p=this.transform.averageElevation;let v=this.transform.sampleAverageElevation(),b=!1;this.transform.elevation&&(b=this.transform.elevation.exaggeration()!==this._averageElevationExaggeration,this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(v)?v=0:this._averageElevationLastSampledAt=l;const D=Math.abs(p-v);if(D>1){if(this._isInitialLoad||b)return this._averageElevation.jumpTo(v),s(v);this._averageElevation.easeTo(v,l,300)}else if(D>1e-4)return this._averageElevation.jumpTo(v),s(v)}return!!this._averageElevation.isEasing(l)&&s(this._averageElevation.getValue(l))}_authenticate(){c.getMapSessionAPI(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,l=>{if(l&&(l.message===c.AUTH_ERR_MSG||401===l.status)){const t=this.painter.context.gl;c.storeAuthState(t,!1),this._logoControl instanceof Oc&&this._logoControl._updateLogo(),t&&t.clear(t.DEPTH_BUFFER_BIT|t.COLOR_BUFFER_BIT|t.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new c.ErrorEvent(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),c.postMapLoadEvent(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_updateTerrain(){this.painter.updateTerrain(this.style,this.isMoving()||this.isRotating()||this.isZooming())}_calculateSpeedIndex(){const l=this.painter.canvasCopy(),t=this.painter.getCanvasCopiesAndTimestamps();t.timeStamps.push(performance.now());const s=this.painter.context.gl,p=s.createFramebuffer();function v(b){s.framebufferTexture2D(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.TEXTURE_2D,b,0);const D=new Uint8Array(s.drawingBufferWidth*s.drawingBufferHeight*4);return s.readPixels(0,0,s.drawingBufferWidth,s.drawingBufferHeight,s.RGBA,s.UNSIGNED_BYTE,D),D}return s.bindFramebuffer(s.FRAMEBUFFER,p),this._canvasPixelComparison(v(l),t.canvasCopies.map(v),t.timeStamps)}_canvasPixelComparison(l,t,s){let p=s[1]-s[0];const v=l.length/4;for(let b=0;b<t.length;b++){const D=t[b];let O=0;for(let k=0;k<D.length;k+=4)D[k]===l[k]&&D[k+1]===l[k+1]&&D[k+2]===l[k+2]&&D[k+3]===l[k+3]&&(O+=1);p+=(s[b+2]-s[b+1])*(1-O/v)}return p}remove(){this._hash&&this._hash.remove();for(const t of this._controls)t.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),void 0!==c.window&&(c.window.removeEventListener("resize",this._onWindowResize,!1),c.window.removeEventListener("orientationchange",this._onWindowResize,!1),c.window.removeEventListener("webkitfullscreenchange",this._onWindowResize,!1),c.window.removeEventListener("online",this._onWindowOnline,!1),c.window.removeEventListener("visibilitychange",this._onVisibilityChange,!1));const l=this.painter.context.gl.getExtension("WEBGL_lose_context");l&&l.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),Fc(this._canvasContainer),Fc(this._controlContainer),Fc(this._missingCSSCanary),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),c.removeAuthState(this.painter.context.gl),this._removed=!0,this.fire(new c.Event("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(l){this._renderNextFrame=this._renderNextFrame||l,this.style&&!this._frame&&(this._frame=c.exported.frame(t=>{const s=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,s&&this._render(t)}))}_preloadTiles(l){const t=this.style?Object.values(this.style._sourceCaches):[];return c.asyncAll(t,(s,p)=>s._preloadTiles(l,p),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(l){this._trackResize&&this.resize({originalEvent:l})._update()}_onVisibilityChange(){"hidden"===c.window.document.visibilityState&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(l){this._showTileBoundaries!==l&&(this._showTileBoundaries=l,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(l){this._showTerrainWireframe!==l&&(this._showTerrainWireframe=l,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(l){this._speedIndexTiming!==l&&(this._speedIndexTiming=l,this._update())}get showPadding(){return!!this._showPadding}set showPadding(l){this._showPadding!==l&&(this._showPadding=l,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(l){this._showCollisionBoxes!==l&&(this._showCollisionBoxes=l,l?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(l){this._showOverdrawInspector!==l&&(this._showOverdrawInspector=l,this._update())}get repaint(){return!!this._repaint}set repaint(l){this._repaint!==l&&(this._repaint=l,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(l){this._vertices=l,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(l){this._showTileAABBs!==l&&(this._showTileAABBs=l,l&&this._update())}_setCacheLimits(l,t){c.setCacheLimits(l,t)}get version(){return c.version}},NavigationControl:class{constructor(l){this.options=c.extend({},Ps,l),this._container=Ie("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",t=>t.preventDefault()),this.options.showZoom&&(c.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",t=>{this._map&&this._map.zoomIn({},{originalEvent:t})}),Ie("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",t=>{this._map&&this._map.zoomOut({},{originalEvent:t})}),Ie("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(c.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",t=>{const s=this._map;s&&(this.options.visualizePitch?s.resetNorthPitch({},{originalEvent:t}):s.resetNorth({},{originalEvent:t}))}),this._compassIcon=Ie("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const l=this._map;if(!l)return;const t=l.getZoom(),s=t===l.getMaxZoom(),p=t===l.getMinZoom();this._zoomInButton.disabled=s,this._zoomOutButton.disabled=p,this._zoomInButton.setAttribute("aria-disabled",s.toString()),this._zoomOutButton.setAttribute("aria-disabled",p.toString())}_rotateCompassArrow(){const l=this._map;if(!l)return;const t=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(l.transform.pitch*(Math.PI/180)),.5)}) rotateX(${l.transform.pitch}deg) rotateZ(${l.transform.angle*(180/Math.PI)}deg)`:`rotate(${l.transform.angle*(180/Math.PI)}deg)`;l._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=t)})}onAdd(l){return this._map=l,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),l.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&l.on("pitch",this._rotateCompassArrow),l.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Sa(l,this._compass,this.options.visualizePitch)),this._container}onRemove(){const l=this._map;l&&(this._container.remove(),this.options.showZoom&&l.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&l.off("pitch",this._rotateCompassArrow),l.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(l,t){const s=Ie("button",l,this._container);return s.type="button",s.addEventListener("click",t),s}_setButtonTitle(l,t){if(!this._map)return;const s=this._map._getUIString(`NavigationControl.${t}`);l.setAttribute("aria-label",s),l.firstElementChild&&l.firstElementChild.setAttribute("title",s)}},GeolocateControl:class extends c.Evented{constructor(l){super(),this.options=c.extend({geolocation:c.window.navigator.geolocation},tu,l),c.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=Na(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(l){return this._map=l,this._container=Ie("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){void 0!==this._geolocationWatchID&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(l){const t=(s=!!this.options.geolocation)=>{this._supportsGeolocation=s,l(s)};void 0!==this._supportsGeolocation?l(this._supportsGeolocation):void 0!==c.window.navigator.permissions?c.window.navigator.permissions.query({name:"geolocation"}).then(s=>t("denied"!==s.state)).catch(()=>t()):t()}_isOutOfMapMaxBounds(l){const t=this._map.getMaxBounds(),s=l.coords;return!!t&&(s.longitude<t.getWest()||s.longitude>t.getEast()||s.latitude<t.getSouth()||s.latitude>t.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(l){if(this._map){if(this._isOutOfMapMaxBounds(l))return this._setErrorState(),this.fire(new c.Event("outofmaxbounds",l)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=l,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(l),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(l),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new c.Event("geolocate",l)),this._finish()}}_updateCamera(l){const t=new c.LngLat(l.coords.longitude,l.coords.latitude),s=l.coords.accuracy,p=this._map.getBearing(),v=c.extend({bearing:p},this.options.fitBoundsOptions);this._map.fitBounds(t.toBounds(s),v,{geolocateSource:!0})}_updateMarker(l){if(l){const t=new c.LngLat(l.coords.longitude,l.coords.latitude);this._accuracyCircleMarker.setLngLat(t).addTo(this._map),this._userLocationDotMarker.setLngLat(t).addTo(this._map),this._accuracy=l.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const l=this._map.transform,t=c.mercatorZfromAltitude(1,l._center.lat)*l.worldSize,s=Math.ceil(2*this._accuracy*t);this._circleElement.style.width=`${s}px`,this._circleElement.style.height=`${s}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&"number"==typeof this._heading?(this._userLocationDotMarker.setRotation(this._heading),this._dotElement.classList.add("mapboxgl-user-location-show-heading")):(this._dotElement.classList.remove("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(l){if(this._map){if(this.options.trackUserLocation)if(1===l.code){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const t=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",t),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",t),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===l.code&&this._noTimeout)return;this._setErrorState()}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new c.Event("error",l)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(l){if(this._container.addEventListener("contextmenu",t=>t.preventDefault()),this._geolocateButton=Ie("button","mapboxgl-ctrl-geolocate",this._container),Ie("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",!1===l){c.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const t=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",t),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",t)}else{const t=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",t),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",t)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=Ie("div","mapboxgl-user-location"),this._dotElement.appendChild(Ie("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(Ie("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new Rc({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=Ie("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Rc({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",t=>{t.geolocateSource||"ACTIVE_LOCK"!==this._watchState||t.originalEvent&&"resize"===t.originalEvent.type||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new c.Event("trackuserlocationend")))})}_onDeviceOrientation(l){this._userLocationDotMarker&&(l.webkitCompassHeading?this._heading=l.webkitCompassHeading:!0===l.absolute&&(this._heading=-1*l.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return c.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new c.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new c.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new c.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){let l;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(l={maximumAge:6e5,timeout:0},this._noTimeout=!0):(l=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,l),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const l=()=>{c.window.addEventListener("ondeviceorientationabsolute"in c.window?"deviceorientationabsolute":"deviceorientation",this._onDeviceOrientation)};void 0!==c.window.DeviceMotionEvent&&"function"==typeof c.window.DeviceMotionEvent.requestPermission?DeviceOrientationEvent.requestPermission().then(t=>{"granted"===t&&l()}).catch(console.error):l()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),c.window.removeEventListener("deviceorientation",this._onDeviceOrientation),c.window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:eu,ScaleControl:class{constructor(l){this.options=c.extend({},sc,l),function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"narrow",unit:"meter"}),!0}catch{return!1}}()||(this._setScale=P.bind(this)),c.bindAll(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const l=this.options.maxWidth||100,t=this._map,s=t._containerHeight/2,p=t._containerWidth/2-l/2,v=t.unproject([p,s]),b=t.unproject([p+l,s]),D=v.distanceTo(b);if("imperial"===this.options.unit){const O=3.2808*D;O>5280?this._setScale(l,O/5280,"mile"):this._setScale(l,O,"foot")}else"nautical"===this.options.unit?this._setScale(l,D/1852,"nautical-mile"):D>=1e3?this._setScale(l,D/1e3,"kilometer"):this._setScale(l,D,"meter")}_setScale(l,t,s){const p=F(t),v=p/t;this._map._requestDomTask(()=>{this._container.style.width=l*v+"px",this._container.innerHTML="nautical-mile"!==s?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"narrow",unit:s}).format(p):`${p}&nbsp;nm`})}onAdd(l){return this._map=l,this._language=l.getLanguage(),this._container=Ie("div","mapboxgl-ctrl mapboxgl-ctrl-scale",l.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(l){this._language=l,this._update()}setUnit(l){this.options.unit=l,this._update()}},FullscreenControl:class{constructor(l){this._fullscreen=!1,l&&l.container&&(l.container instanceof c.window.HTMLElement?this._container=l.container:c.warnOnce("Full screen control 'container' must be a DOM element.")),c.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in c.window.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in c.window.document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(l){return this._map=l,this._container||(this._container=this._map.getContainer()),this._controlContainer=Ie("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",c.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,c.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!c.window.document.fullscreenEnabled&&!c.window.document.webkitFullscreenEnabled)}_setupUI(){const l=this._fullscreenButton=Ie("button","mapboxgl-ctrl-fullscreen",this._controlContainer);Ie("span","mapboxgl-ctrl-icon",l).setAttribute("aria-hidden","true"),l.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),c.window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const l=this._getTitle();this._fullscreenButton.setAttribute("aria-label",l),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",l)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(c.window.document.fullscreenElement||c.window.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?c.window.document.exitFullscreen?c.window.document.exitFullscreen():c.window.document.webkitCancelFullScreen&&c.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends c.Evented{constructor(l){super(),this.options=c.extend(Object.create(Ll),l),c.bindAll(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(l&&l.className?l.className.trim().split(/\s+/):[])}addTo(l){return this._map&&this.remove(),this._map=l,this.options.closeOnClick&&l.on("preclick",this._onClose),this.options.closeOnMove&&l.on("move",this._onClose),l.on("remove",this.remove),this._update(),l._addPopup(this),this._focusFirstElement(),this._trackPointer?(l.on("mousemove",this._onMouseEvent),l.on("mouseup",this._onMouseEvent),l._canvasContainer.classList.add("mapboxgl-track-pointer")):l.on("move",this._update),this.fire(new c.Event("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const l=this._map;return l&&(l.off("move",this._update),l.off("move",this._onClose),l.off("preclick",this._onClose),l.off("click",this._onClose),l.off("remove",this.remove),l.off("mousemove",this._onMouseEvent),l.off("mouseup",this._onMouseEvent),l.off("drag",this._onMouseEvent),l._canvasContainer&&l._canvasContainer.classList.remove("mapboxgl-track-pointer"),l._removePopup(this),this._map=void 0),this.fire(new c.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(l){this._lngLat=c.LngLat.convert(l),this._pos=null,this._trackPointer=!1,this._update();const t=this._map;return t&&(t.on("move",this._update),t.off("mousemove",this._onMouseEvent),t._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const l=this._map;return l&&(l.off("move",this._update),l.on("mousemove",this._onMouseEvent),l.on("drag",this._onMouseEvent),l._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(l){return this.setDOMContent(c.window.document.createTextNode(l))}setHTML(l){const t=c.window.document.createDocumentFragment(),s=c.window.document.createElement("body");let p;for(s.innerHTML=l;p=s.firstChild,p;)t.appendChild(p);return this.setDOMContent(t)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(l){return this.options.maxWidth=l,this._update(),this}setDOMContent(l){let t=this._content;if(t)for(;t.hasChildNodes();)t.firstChild&&t.removeChild(t.firstChild);else t=this._content=Ie("div","mapboxgl-popup-content",this._container||void 0);if(t.appendChild(l),this.options.closeButton){const s=this._closeButton=Ie("button","mapboxgl-popup-close-button",t);s.type="button",s.setAttribute("aria-label","Close popup"),s.setAttribute("aria-hidden","true"),s.innerHTML="&#215;",s.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(l){return this._classList.add(l),this._updateClassList(),this}removeClassName(l){return this._classList.delete(l),this._updateClassList(),this}setOffset(l){return this.options.offset=l,this._update(),this}toggleClassName(l){let t;return this._classList.delete(l)?t=!1:(this._classList.add(l),t=!0),this._updateClassList(),t}_onMouseEvent(l){this._update(l.point)}_getAnchor(l){if(this.options.anchor)return this.options.anchor;const t=this._map,s=this._container,p=this._pos;if(!t||!s||!p)return"bottom";const v=s.offsetWidth,b=s.offsetHeight,D=p.x<v/2,O=p.x>t.transform.width-v/2;if(p.y+l<b)return D?"top-left":O?"top-right":"top";if(p.y>t.transform.height-b){if(D)return"bottom-left";if(O)return"bottom-right"}return D?"left":O?"right":"bottom"}_updateClassList(){const l=this._container;if(!l)return;const t=[...this._classList];t.push("mapboxgl-popup"),this._anchor&&t.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&t.push("mapboxgl-popup-track-pointer"),l.className=t.join(" ")}_update(l){const t=this._map,s=this._content;if(!t||!this._lngLat&&!this._trackPointer||!s)return;let p=this._container;if(p||(p=this._container=Ie("div","mapboxgl-popup",t.getContainer()),this._tip=Ie("div","mapboxgl-popup-tip",p),p.appendChild(s)),this.options.maxWidth&&p.style.maxWidth!==this.options.maxWidth&&(p.style.maxWidth=this.options.maxWidth),t.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Ha(this._lngLat,this._pos,t.transform)),!this._trackPointer||l){const v=this._pos=this._trackPointer&&l?l:t.project(this._lngLat),b=Iu(this.options.offset),D=this._anchor=this._getAnchor(b.y),O=Iu(this.options.offset,D),k=v.add(O).round();t._requestDomTask(()=>{this._container&&D&&(this._container.style.transform=`${Du[D]} translate(${k.x}px,${k.y}px)`)})}if(!this._marker&&t._showingGlobe()){const v=c.isLngLatBehindGlobe(t.transform,this._lngLat)?0:1;this._setOpacity(v)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const l=this._container.querySelector(hd);l&&l.focus()}_onClose(){this.remove()}_setOpacity(l){this._container&&(this._container.style.opacity=`${l}`),this._content&&(this._content.style.pointerEvents=l?"auto":"none")}},Marker:Rc,Style:Ao,LngLat:c.LngLat,LngLatBounds:c.LngLatBounds,Point:c.pointGeometry,MercatorCoordinate:c.MercatorCoordinate,FreeCameraOptions:dr,Evented:c.Evented,config:c.config,prewarm:function(){Yn().acquire(zt)},clearPrewarmedResources:function(){const l=Mn;l&&(l.isPreloaded()&&1===l.numActive()?(l.release(zt),Mn=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return c.config.ACCESS_TOKEN},set accessToken(l){c.config.ACCESS_TOKEN=l},get baseApiUrl(){return c.config.API_URL},set baseApiUrl(l){c.config.API_URL=l},get workerCount(){return _n.workerCount},set workerCount(l){_n.workerCount=l},get maxParallelImageRequests(){return c.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(l){c.config.MAX_PARALLEL_IMAGE_REQUESTS=l},clearStorage(l){c.clearTileCache(l)},workerUrl:"",workerClass:null,setNow:c.exported.setNow,restoreNow:c.exported.restoreNow};return S}),h}()},1135:(Rn,Dt,B)=>{"use strict";B.d(Dt,{X:()=>g});var h=B(7579);class g extends h.x{constructor(c){super(),this._value=c}get value(){return this.getValue()}_subscribe(c){const Y=super._subscribe(c);return!Y.closed&&c.next(this._value),Y}getValue(){const{hasError:c,thrownError:Y,_value:se}=this;if(c)throw Y;return this._throwIfClosed(),se}next(c){super.next(this._value=c)}}},9751:(Rn,Dt,B)=>{"use strict";B.d(Dt,{y:()=>fe});var h=B(2961),g=B(727),ie=B(8822),c=B(9635),Y=B(2416),se=B(576),y=B(2806);let fe=(()=>{class be{constructor(Ze){Ze&&(this._subscribe=Ze)}lift(Ze){const he=new be;return he.source=this,he.operator=Ze,he}subscribe(Ze,he,Ke){const Ae=function Q(be){return be&&be instanceof h.Lv||function Ge(be){return be&&(0,se.m)(be.next)&&(0,se.m)(be.error)&&(0,se.m)(be.complete)}(be)&&(0,g.Nn)(be)}(Ze)?Ze:new h.Hp(Ze,he,Ke);return(0,y.x)(()=>{const{operator:te,source:Qe}=this;Ae.add(te?te.call(Ae,Qe):Qe?this._subscribe(Ae):this._trySubscribe(Ae))}),Ae}_trySubscribe(Ze){try{return this._subscribe(Ze)}catch(he){Ze.error(he)}}forEach(Ze,he){return new(he=Ie(he))((Ke,Ae)=>{const te=new h.Hp({next:Qe=>{try{Ze(Qe)}catch(Ot){Ae(Ot),te.unsubscribe()}},error:Ae,complete:Ke});this.subscribe(te)})}_subscribe(Ze){var he;return null===(he=this.source)||void 0===he?void 0:he.subscribe(Ze)}[ie.L](){return this}pipe(...Ze){return(0,c.U)(Ze)(this)}toPromise(Ze){return new(Ze=Ie(Ze))((he,Ke)=>{let Ae;this.subscribe(te=>Ae=te,te=>Ke(te),()=>he(Ae))})}}return be.create=me=>new be(me),be})();function Ie(be){var me;return null!==(me=be??Y.v.Promise)&&void 0!==me?me:Promise}},7579:(Rn,Dt,B)=>{"use strict";B.d(Dt,{x:()=>y});var h=B(9751),g=B(727);const c=(0,B(3888).d)(Ie=>function(){Ie(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var Y=B(8737),se=B(2806);let y=(()=>{class Ie extends h.y{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(Q){const be=new fe(this,this);return be.operator=Q,be}_throwIfClosed(){if(this.closed)throw new c}next(Q){(0,se.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const be of this.currentObservers)be.next(Q)}})}error(Q){(0,se.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=Q;const{observers:be}=this;for(;be.length;)be.shift().error(Q)}})}complete(){(0,se.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:Q}=this;for(;Q.length;)Q.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var Q;return(null===(Q=this.observers)||void 0===Q?void 0:Q.length)>0}_trySubscribe(Q){return this._throwIfClosed(),super._trySubscribe(Q)}_subscribe(Q){return this._throwIfClosed(),this._checkFinalizedStatuses(Q),this._innerSubscribe(Q)}_innerSubscribe(Q){const{hasError:be,isStopped:me,observers:Ze}=this;return be||me?g.Lc:(this.currentObservers=null,Ze.push(Q),new g.w0(()=>{this.currentObservers=null,(0,Y.P)(Ze,Q)}))}_checkFinalizedStatuses(Q){const{hasError:be,thrownError:me,isStopped:Ze}=this;be?Q.error(me):Ze&&Q.complete()}asObservable(){const Q=new h.y;return Q.source=this,Q}}return Ie.create=(Ge,Q)=>new fe(Ge,Q),Ie})();class fe extends y{constructor(Ge,Q){super(),this.destination=Ge,this.source=Q}next(Ge){var Q,be;null===(be=null===(Q=this.destination)||void 0===Q?void 0:Q.next)||void 0===be||be.call(Q,Ge)}error(Ge){var Q,be;null===(be=null===(Q=this.destination)||void 0===Q?void 0:Q.error)||void 0===be||be.call(Q,Ge)}complete(){var Ge,Q;null===(Q=null===(Ge=this.destination)||void 0===Ge?void 0:Ge.complete)||void 0===Q||Q.call(Ge)}_subscribe(Ge){var Q,be;return null!==(be=null===(Q=this.source)||void 0===Q?void 0:Q.subscribe(Ge))&&void 0!==be?be:g.Lc}}},2961:(Rn,Dt,B)=>{"use strict";B.d(Dt,{Hp:()=>Ke,Lv:()=>be});var h=B(576),g=B(727),ie=B(2416),c=B(7849);function Y(){}const se=Ie("C",void 0,void 0);function Ie(dt,ye,Fe){return{kind:dt,value:ye,error:Fe}}var Ge=B(3410),Q=B(2806);class be extends g.w0{constructor(ye){super(),this.isStopped=!1,ye?(this.destination=ye,(0,g.Nn)(ye)&&ye.add(this)):this.destination=Ot}static create(ye,Fe,Ne){return new Ke(ye,Fe,Ne)}next(ye){this.isStopped?Qe(function fe(dt){return Ie("N",dt,void 0)}(ye),this):this._next(ye)}error(ye){this.isStopped?Qe(function y(dt){return Ie("E",void 0,dt)}(ye),this):(this.isStopped=!0,this._error(ye))}complete(){this.isStopped?Qe(se,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(ye){this.destination.next(ye)}_error(ye){try{this.destination.error(ye)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const me=Function.prototype.bind;function Ze(dt,ye){return me.call(dt,ye)}class he{constructor(ye){this.partialObserver=ye}next(ye){const{partialObserver:Fe}=this;if(Fe.next)try{Fe.next(ye)}catch(Ne){Ae(Ne)}}error(ye){const{partialObserver:Fe}=this;if(Fe.error)try{Fe.error(ye)}catch(Ne){Ae(Ne)}else Ae(ye)}complete(){const{partialObserver:ye}=this;if(ye.complete)try{ye.complete()}catch(Fe){Ae(Fe)}}}class Ke extends be{constructor(ye,Fe,Ne){let we;if(super(),(0,h.m)(ye)||!ye)we={next:ye??void 0,error:Fe??void 0,complete:Ne??void 0};else{let et;this&&ie.v.useDeprecatedNextContext?(et=Object.create(ye),et.unsubscribe=()=>this.unsubscribe(),we={next:ye.next&&Ze(ye.next,et),error:ye.error&&Ze(ye.error,et),complete:ye.complete&&Ze(ye.complete,et)}):we=ye}this.destination=new he(we)}}function Ae(dt){ie.v.useDeprecatedSynchronousErrorHandling?(0,Q.O)(dt):(0,c.h)(dt)}function Qe(dt,ye){const{onStoppedNotification:Fe}=ie.v;Fe&&Ge.z.setTimeout(()=>Fe(dt,ye))}const Ot={closed:!0,next:Y,error:function te(dt){throw dt},complete:Y}},727:(Rn,Dt,B)=>{"use strict";B.d(Dt,{Lc:()=>se,w0:()=>Y,Nn:()=>y});var h=B(576);const ie=(0,B(3888).d)(Ie=>function(Q){Ie(this),this.message=Q?`${Q.length} errors occurred during unsubscription:\n${Q.map((be,me)=>`${me+1}) ${be.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=Q});var c=B(8737);class Y{constructor(Ge){this.initialTeardown=Ge,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let Ge;if(!this.closed){this.closed=!0;const{_parentage:Q}=this;if(Q)if(this._parentage=null,Array.isArray(Q))for(const Ze of Q)Ze.remove(this);else Q.remove(this);const{initialTeardown:be}=this;if((0,h.m)(be))try{be()}catch(Ze){Ge=Ze instanceof ie?Ze.errors:[Ze]}const{_finalizers:me}=this;if(me){this._finalizers=null;for(const Ze of me)try{fe(Ze)}catch(he){Ge=Ge??[],he instanceof ie?Ge=[...Ge,...he.errors]:Ge.push(he)}}if(Ge)throw new ie(Ge)}}add(Ge){var Q;if(Ge&&Ge!==this)if(this.closed)fe(Ge);else{if(Ge instanceof Y){if(Ge.closed||Ge._hasParent(this))return;Ge._addParent(this)}(this._finalizers=null!==(Q=this._finalizers)&&void 0!==Q?Q:[]).push(Ge)}}_hasParent(Ge){const{_parentage:Q}=this;return Q===Ge||Array.isArray(Q)&&Q.includes(Ge)}_addParent(Ge){const{_parentage:Q}=this;this._parentage=Array.isArray(Q)?(Q.push(Ge),Q):Q?[Q,Ge]:Ge}_removeParent(Ge){const{_parentage:Q}=this;Q===Ge?this._parentage=null:Array.isArray(Q)&&(0,c.P)(Q,Ge)}remove(Ge){const{_finalizers:Q}=this;Q&&(0,c.P)(Q,Ge),Ge instanceof Y&&Ge._removeParent(this)}}Y.EMPTY=(()=>{const Ie=new Y;return Ie.closed=!0,Ie})();const se=Y.EMPTY;function y(Ie){return Ie instanceof Y||Ie&&"closed"in Ie&&(0,h.m)(Ie.remove)&&(0,h.m)(Ie.add)&&(0,h.m)(Ie.unsubscribe)}function fe(Ie){(0,h.m)(Ie)?Ie():Ie.unsubscribe()}},2416:(Rn,Dt,B)=>{"use strict";B.d(Dt,{v:()=>h});const h={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1}},7272:(Rn,Dt,B)=>{"use strict";B.d(Dt,{z:()=>Y});var h=B(8189),ie=B(7669),c=B(2076);function Y(...se){return function g(){return(0,h.J)(1)}()((0,c.D)(se,(0,ie.yG)(se)))}},9770:(Rn,Dt,B)=>{"use strict";B.d(Dt,{P:()=>ie});var h=B(9751),g=B(8421);function ie(c){return new h.y(Y=>{(0,g.Xf)(c()).subscribe(Y)})}},515:(Rn,Dt,B)=>{"use strict";B.d(Dt,{E:()=>g});const g=new(B(9751).y)(Y=>Y.complete())},4128:(Rn,Dt,B)=>{"use strict";B.d(Dt,{D:()=>fe});var h=B(9751),g=B(4742),ie=B(8421),c=B(7669),Y=B(5403),se=B(3268),y=B(1810);function fe(...Ie){const Ge=(0,c.jO)(Ie),{args:Q,keys:be}=(0,g.D)(Ie),me=new h.y(Ze=>{const{length:he}=Q;if(!he)return void Ze.complete();const Ke=new Array(he);let Ae=he,te=he;for(let Qe=0;Qe<he;Qe++){let Ot=!1;(0,ie.Xf)(Q[Qe]).subscribe((0,Y.x)(Ze,dt=>{Ot||(Ot=!0,te--),Ke[Qe]=dt},()=>Ae--,void 0,()=>{(!Ae||!Ot)&&(te||Ze.next(be?(0,y.n)(be,Ke):Ke),Ze.complete())}))}});return Ge?me.pipe((0,se.Z)(Ge)):me}},2076:(Rn,Dt,B)=>{"use strict";B.d(Dt,{D:()=>Ne});var h=B(8421),g=B(9672),ie=B(4482),c=B(5403);function Y(we,et=0){return(0,ie.e)((Je,_e)=>{Je.subscribe((0,c.x)(_e,pe=>(0,g.f)(_e,we,()=>_e.next(pe),et),()=>(0,g.f)(_e,we,()=>_e.complete(),et),pe=>(0,g.f)(_e,we,()=>_e.error(pe),et)))})}function se(we,et=0){return(0,ie.e)((Je,_e)=>{_e.add(we.schedule(()=>Je.subscribe(_e),et))})}var Ie=B(9751),Q=B(2202),be=B(576);function Ze(we,et){if(!we)throw new Error("Iterable cannot be null");return new Ie.y(Je=>{(0,g.f)(Je,et,()=>{const _e=we[Symbol.asyncIterator]();(0,g.f)(Je,et,()=>{_e.next().then(pe=>{pe.done?Je.complete():Je.next(pe.value)})},0,!0)})})}var he=B(3670),Ke=B(8239),Ae=B(1144),te=B(6495),Qe=B(2206),Ot=B(4532),dt=B(3260);function Ne(we,et){return et?function Fe(we,et){if(null!=we){if((0,he.c)(we))return function y(we,et){return(0,h.Xf)(we).pipe(se(et),Y(et))}(we,et);if((0,Ae.z)(we))return function Ge(we,et){return new Ie.y(Je=>{let _e=0;return et.schedule(function(){_e===we.length?Je.complete():(Je.next(we[_e++]),Je.closed||this.schedule())})})}(we,et);if((0,Ke.t)(we))return function fe(we,et){return(0,h.Xf)(we).pipe(se(et),Y(et))}(we,et);if((0,Qe.D)(we))return Ze(we,et);if((0,te.T)(we))return function me(we,et){return new Ie.y(Je=>{let _e;return(0,g.f)(Je,et,()=>{_e=we[Q.h](),(0,g.f)(Je,et,()=>{let pe,ae;try{({value:pe,done:ae}=_e.next())}catch(Ee){return void Je.error(Ee)}ae?Je.complete():Je.next(pe)},0,!0)}),()=>(0,be.m)(_e?.return)&&_e.return()})}(we,et);if((0,dt.L)(we))return function ye(we,et){return Ze((0,dt.Q)(we),et)}(we,et)}throw(0,Ot.z)(we)}(we,et):(0,h.Xf)(we)}},4968:(Rn,Dt,B)=>{"use strict";B.d(Dt,{R:()=>Ge});var h=B(8421),g=B(9751),ie=B(5577),c=B(1144),Y=B(576),se=B(3268);const y=["addListener","removeListener"],fe=["addEventListener","removeEventListener"],Ie=["on","off"];function Ge(he,Ke,Ae,te){if((0,Y.m)(Ae)&&(te=Ae,Ae=void 0),te)return Ge(he,Ke,Ae).pipe((0,se.Z)(te));const[Qe,Ot]=function Ze(he){return(0,Y.m)(he.addEventListener)&&(0,Y.m)(he.removeEventListener)}(he)?fe.map(dt=>ye=>he[dt](Ke,ye,Ae)):function be(he){return(0,Y.m)(he.addListener)&&(0,Y.m)(he.removeListener)}(he)?y.map(Q(he,Ke)):function me(he){return(0,Y.m)(he.on)&&(0,Y.m)(he.off)}(he)?Ie.map(Q(he,Ke)):[];if(!Qe&&(0,c.z)(he))return(0,ie.z)(dt=>Ge(dt,Ke,Ae))((0,h.Xf)(he));if(!Qe)throw new TypeError("Invalid event target");return new g.y(dt=>{const ye=(...Fe)=>dt.next(1<Fe.length?Fe:Fe[0]);return Qe(ye),()=>Ot(ye)})}function Q(he,Ke){return Ae=>te=>he[Ae](Ke,te)}},8421:(Rn,Dt,B)=>{"use strict";B.d(Dt,{Xf:()=>me});var h=B(5987),g=B(1144),ie=B(8239),c=B(9751),Y=B(3670),se=B(2206),y=B(4532),fe=B(6495),Ie=B(3260),Ge=B(576),Q=B(7849),be=B(8822);function me(dt){if(dt instanceof c.y)return dt;if(null!=dt){if((0,Y.c)(dt))return function Ze(dt){return new c.y(ye=>{const Fe=dt[be.L]();if((0,Ge.m)(Fe.subscribe))return Fe.subscribe(ye);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(dt);if((0,g.z)(dt))return function he(dt){return new c.y(ye=>{for(let Fe=0;Fe<dt.length&&!ye.closed;Fe++)ye.next(dt[Fe]);ye.complete()})}(dt);if((0,ie.t)(dt))return function Ke(dt){return new c.y(ye=>{dt.then(Fe=>{ye.closed||(ye.next(Fe),ye.complete())},Fe=>ye.error(Fe)).then(null,Q.h)})}(dt);if((0,se.D)(dt))return te(dt);if((0,fe.T)(dt))return function Ae(dt){return new c.y(ye=>{for(const Fe of dt)if(ye.next(Fe),ye.closed)return;ye.complete()})}(dt);if((0,Ie.L)(dt))return function Qe(dt){return te((0,Ie.Q)(dt))}(dt)}throw(0,y.z)(dt)}function te(dt){return new c.y(ye=>{(function Ot(dt,ye){var Fe,Ne,we,et;return(0,h.mG)(this,void 0,void 0,function*(){try{for(Fe=(0,h.KL)(dt);!(Ne=yield Fe.next()).done;)if(ye.next(Ne.value),ye.closed)return}catch(Je){we={error:Je}}finally{try{Ne&&!Ne.done&&(et=Fe.return)&&(yield et.call(Fe))}finally{if(we)throw we.error}}ye.complete()})})(dt,ye).catch(Fe=>ye.error(Fe))})}},9646:(Rn,Dt,B)=>{"use strict";B.d(Dt,{of:()=>ie});var h=B(7669),g=B(2076);function ie(...c){const Y=(0,h.yG)(c);return(0,g.D)(c,Y)}},5403:(Rn,Dt,B)=>{"use strict";B.d(Dt,{x:()=>g});var h=B(2961);function g(c,Y,se,y,fe){return new ie(c,Y,se,y,fe)}class ie extends h.Lv{constructor(Y,se,y,fe,Ie,Ge){super(Y),this.onFinalize=Ie,this.shouldUnsubscribe=Ge,this._next=se?function(Q){try{se(Q)}catch(be){Y.error(be)}}:super._next,this._error=fe?function(Q){try{fe(Q)}catch(be){Y.error(be)}finally{this.unsubscribe()}}:super._error,this._complete=y?function(){try{y()}catch(Q){Y.error(Q)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var Y;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:se}=this;super.unsubscribe(),!se&&(null===(Y=this.onFinalize)||void 0===Y||Y.call(this))}}}},4351:(Rn,Dt,B)=>{"use strict";B.d(Dt,{b:()=>ie});var h=B(5577),g=B(576);function ie(c,Y){return(0,g.m)(Y)?(0,h.z)(c,Y,1):(0,h.z)(c,1)}},9300:(Rn,Dt,B)=>{"use strict";B.d(Dt,{h:()=>ie});var h=B(4482),g=B(5403);function ie(c,Y){return(0,h.e)((se,y)=>{let fe=0;se.subscribe((0,g.x)(y,Ie=>c.call(Y,Ie,fe++)&&y.next(Ie)))})}},4004:(Rn,Dt,B)=>{"use strict";B.d(Dt,{U:()=>ie});var h=B(4482),g=B(5403);function ie(c,Y){return(0,h.e)((se,y)=>{let fe=0;se.subscribe((0,g.x)(y,Ie=>{y.next(c.call(Y,Ie,fe++))}))})}},8189:(Rn,Dt,B)=>{"use strict";B.d(Dt,{J:()=>ie});var h=B(5577),g=B(4671);function ie(c=1/0){return(0,h.z)(g.y,c)}},5577:(Rn,Dt,B)=>{"use strict";B.d(Dt,{z:()=>fe});var h=B(4004),g=B(8421),ie=B(4482),c=B(9672),Y=B(5403),y=B(576);function fe(Ie,Ge,Q=1/0){return(0,y.m)(Ge)?fe((be,me)=>(0,h.U)((Ze,he)=>Ge(be,Ze,me,he))((0,g.Xf)(Ie(be,me))),Q):("number"==typeof Ge&&(Q=Ge),(0,ie.e)((be,me)=>function se(Ie,Ge,Q,be,me,Ze,he,Ke){const Ae=[];let te=0,Qe=0,Ot=!1;const dt=()=>{Ot&&!Ae.length&&!te&&Ge.complete()},ye=Ne=>te<be?Fe(Ne):Ae.push(Ne),Fe=Ne=>{Ze&&Ge.next(Ne),te++;let we=!1;(0,g.Xf)(Q(Ne,Qe++)).subscribe((0,Y.x)(Ge,et=>{me?.(et),Ze?ye(et):Ge.next(et)},()=>{we=!0},void 0,()=>{if(we)try{for(te--;Ae.length&&te<be;){const et=Ae.shift();he?(0,c.f)(Ge,he,()=>Fe(et)):Fe(et)}dt()}catch(et){Ge.error(et)}}))};return Ie.subscribe((0,Y.x)(Ge,ye,()=>{Ot=!0,dt()})),()=>{Ke?.()}}(be,me,Ie,Q)))}},3099:(Rn,Dt,B)=>{"use strict";B.d(Dt,{B:()=>Y});var h=B(8421),g=B(7579),ie=B(2961),c=B(4482);function Y(y={}){const{connector:fe=(()=>new g.x),resetOnError:Ie=!0,resetOnComplete:Ge=!0,resetOnRefCountZero:Q=!0}=y;return be=>{let me,Ze,he,Ke=0,Ae=!1,te=!1;const Qe=()=>{Ze?.unsubscribe(),Ze=void 0},Ot=()=>{Qe(),me=he=void 0,Ae=te=!1},dt=()=>{const ye=me;Ot(),ye?.unsubscribe()};return(0,c.e)((ye,Fe)=>{Ke++,!te&&!Ae&&Qe();const Ne=he=he??fe();Fe.add(()=>{Ke--,0===Ke&&!te&&!Ae&&(Ze=se(dt,Q))}),Ne.subscribe(Fe),!me&&Ke>0&&(me=new ie.Hp({next:we=>Ne.next(we),error:we=>{te=!0,Qe(),Ze=se(Ot,Ie,we),Ne.error(we)},complete:()=>{Ae=!0,Qe(),Ze=se(Ot,Ge),Ne.complete()}}),(0,h.Xf)(ye).subscribe(me))})(be)}}function se(y,fe,...Ie){if(!0===fe)return void y();if(!1===fe)return;const Ge=new ie.Hp({next:()=>{Ge.unsubscribe(),y()}});return(0,h.Xf)(fe(...Ie)).subscribe(Ge)}},3900:(Rn,Dt,B)=>{"use strict";B.d(Dt,{w:()=>c});var h=B(8421),g=B(4482),ie=B(5403);function c(Y,se){return(0,g.e)((y,fe)=>{let Ie=null,Ge=0,Q=!1;const be=()=>Q&&!Ie&&fe.complete();y.subscribe((0,ie.x)(fe,me=>{Ie?.unsubscribe();let Ze=0;const he=Ge++;(0,h.Xf)(Y(me,he)).subscribe(Ie=(0,ie.x)(fe,Ke=>fe.next(se?se(me,Ke,he,Ze++):Ke),()=>{Ie=null,be()}))},()=>{Q=!0,be()}))})}},5698:(Rn,Dt,B)=>{"use strict";B.d(Dt,{q:()=>c});var h=B(515),g=B(4482),ie=B(5403);function c(Y){return Y<=0?()=>h.E:(0,g.e)((se,y)=>{let fe=0;se.subscribe((0,ie.x)(y,Ie=>{++fe<=Y&&(y.next(Ie),Y<=fe&&y.complete())}))})}},6063:(Rn,Dt,B)=>{"use strict";B.d(Dt,{l:()=>h});const h={now:()=>(h.delegate||Date).now(),delegate:void 0}},3410:(Rn,Dt,B)=>{"use strict";B.d(Dt,{z:()=>h});const h={setTimeout(g,ie,...c){const{delegate:Y}=h;return Y?.setTimeout?Y.setTimeout(g,ie,...c):setTimeout(g,ie,...c)},clearTimeout(g){const{delegate:ie}=h;return(ie?.clearTimeout||clearTimeout)(g)},delegate:void 0}},2202:(Rn,Dt,B)=>{"use strict";B.d(Dt,{h:()=>g});const g=function h(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}()},8822:(Rn,Dt,B)=>{"use strict";B.d(Dt,{L:()=>h});const h="function"==typeof Symbol&&Symbol.observable||"@@observable"},7669:(Rn,Dt,B)=>{"use strict";B.d(Dt,{_6:()=>se,jO:()=>c,yG:()=>Y});var h=B(576);function ie(y){return y[y.length-1]}function c(y){return(0,h.m)(ie(y))?y.pop():void 0}function Y(y){return function g(y){return y&&(0,h.m)(y.schedule)}(ie(y))?y.pop():void 0}function se(y,fe){return"number"==typeof ie(y)?y.pop():fe}},4742:(Rn,Dt,B)=>{"use strict";B.d(Dt,{D:()=>Y});const{isArray:h}=Array,{getPrototypeOf:g,prototype:ie,keys:c}=Object;function Y(y){if(1===y.length){const fe=y[0];if(h(fe))return{args:fe,keys:null};if(function se(y){return y&&"object"==typeof y&&g(y)===ie}(fe)){const Ie=c(fe);return{args:Ie.map(Ge=>fe[Ge]),keys:Ie}}}return{args:y,keys:null}}},8737:(Rn,Dt,B)=>{"use strict";function h(g,ie){if(g){const c=g.indexOf(ie);0<=c&&g.splice(c,1)}}B.d(Dt,{P:()=>h})},3888:(Rn,Dt,B)=>{"use strict";function h(g){const c=g(Y=>{Error.call(Y),Y.stack=(new Error).stack});return c.prototype=Object.create(Error.prototype),c.prototype.constructor=c,c}B.d(Dt,{d:()=>h})},1810:(Rn,Dt,B)=>{"use strict";function h(g,ie){return g.reduce((c,Y,se)=>(c[Y]=ie[se],c),{})}B.d(Dt,{n:()=>h})},2806:(Rn,Dt,B)=>{"use strict";B.d(Dt,{O:()=>c,x:()=>ie});var h=B(2416);let g=null;function ie(Y){if(h.v.useDeprecatedSynchronousErrorHandling){const se=!g;if(se&&(g={errorThrown:!1,error:null}),Y(),se){const{errorThrown:y,error:fe}=g;if(g=null,y)throw fe}}else Y()}function c(Y){h.v.useDeprecatedSynchronousErrorHandling&&g&&(g.errorThrown=!0,g.error=Y)}},9672:(Rn,Dt,B)=>{"use strict";function h(g,ie,c,Y=0,se=!1){const y=ie.schedule(function(){c(),se?g.add(this.schedule(null,Y)):this.unsubscribe()},Y);if(g.add(y),!se)return y}B.d(Dt,{f:()=>h})},4671:(Rn,Dt,B)=>{"use strict";function h(g){return g}B.d(Dt,{y:()=>h})},1144:(Rn,Dt,B)=>{"use strict";B.d(Dt,{z:()=>h});const h=g=>g&&"number"==typeof g.length&&"function"!=typeof g},2206:(Rn,Dt,B)=>{"use strict";B.d(Dt,{D:()=>g});var h=B(576);function g(ie){return Symbol.asyncIterator&&(0,h.m)(ie?.[Symbol.asyncIterator])}},576:(Rn,Dt,B)=>{"use strict";function h(g){return"function"==typeof g}B.d(Dt,{m:()=>h})},3670:(Rn,Dt,B)=>{"use strict";B.d(Dt,{c:()=>ie});var h=B(8822),g=B(576);function ie(c){return(0,g.m)(c[h.L])}},6495:(Rn,Dt,B)=>{"use strict";B.d(Dt,{T:()=>ie});var h=B(2202),g=B(576);function ie(c){return(0,g.m)(c?.[h.h])}},8239:(Rn,Dt,B)=>{"use strict";B.d(Dt,{t:()=>g});var h=B(576);function g(ie){return(0,h.m)(ie?.then)}},3260:(Rn,Dt,B)=>{"use strict";B.d(Dt,{L:()=>c,Q:()=>ie});var h=B(5987),g=B(576);function ie(Y){return(0,h.FC)(this,arguments,function*(){const y=Y.getReader();try{for(;;){const{value:fe,done:Ie}=yield(0,h.qq)(y.read());if(Ie)return yield(0,h.qq)(void 0);yield yield(0,h.qq)(fe)}}finally{y.releaseLock()}})}function c(Y){return(0,g.m)(Y?.getReader)}},4482:(Rn,Dt,B)=>{"use strict";B.d(Dt,{A:()=>g,e:()=>ie});var h=B(576);function g(c){return(0,h.m)(c?.lift)}function ie(c){return Y=>{if(g(Y))return Y.lift(function(se){try{return c(se,this)}catch(y){this.error(y)}});throw new TypeError("Unable to lift unknown Observable type")}}},3268:(Rn,Dt,B)=>{"use strict";B.d(Dt,{Z:()=>c});var h=B(4004);const{isArray:g}=Array;function c(Y){return(0,h.U)(se=>function ie(Y,se){return g(se)?Y(...se):Y(se)}(Y,se))}},9635:(Rn,Dt,B)=>{"use strict";B.d(Dt,{U:()=>ie,z:()=>g});var h=B(4671);function g(...c){return ie(c)}function ie(c){return 0===c.length?h.y:1===c.length?c[0]:function(se){return c.reduce((y,fe)=>fe(y),se)}}},7849:(Rn,Dt,B)=>{"use strict";B.d(Dt,{h:()=>ie});var h=B(2416),g=B(3410);function ie(c){g.z.setTimeout(()=>{const{onUnhandledError:Y}=h.v;if(!Y)throw c;Y(c)})}},4532:(Rn,Dt,B)=>{"use strict";function h(g){return new TypeError(`You provided ${null!==g&&"object"==typeof g?"an invalid object":`'${g}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}B.d(Dt,{z:()=>h})},863:(Rn,Dt,B)=>{var h={"./ion-accordion_2.entry.js":[9654,8592,9654],"./ion-action-sheet.entry.js":[3648,8592,3648],"./ion-alert.entry.js":[1118,8592,1118],"./ion-app_8.entry.js":[53,8592,3236],"./ion-avatar_3.entry.js":[4753,4753],"./ion-back-button.entry.js":[2073,8592,2073],"./ion-backdrop.entry.js":[8939,8939],"./ion-breadcrumb_2.entry.js":[7544,8592,7544],"./ion-button_2.entry.js":[5652,5652],"./ion-card_5.entry.js":[5929,388],"./ion-checkbox.entry.js":[9922,9922],"./ion-chip.entry.js":[657,657],"./ion-col_3.entry.js":[9824,9824],"./ion-datetime-button.entry.js":[9230,1435,9230],"./ion-datetime_3.entry.js":[4959,1435,8592,4959],"./ion-fab_3.entry.js":[5836,8592,5836],"./ion-img.entry.js":[1033,1033],"./ion-infinite-scroll_2.entry.js":[8034,8592,5817],"./ion-input.entry.js":[1217,8592,1217],"./ion-item-option_3.entry.js":[2933,8592,4651],"./ion-item_8.entry.js":[4711,8592,4711],"./ion-loading.entry.js":[9434,8592,9434],"./ion-menu_3.entry.js":[8136,8592,8136],"./ion-modal.entry.js":[2349,8592,2349],"./ion-nav_2.entry.js":[5349,8592,5349],"./ion-picker-column-internal.entry.js":[7602,8592,7602],"./ion-picker-internal.entry.js":[9016,9016],"./ion-popover.entry.js":[3804,8592,3804],"./ion-progress-bar.entry.js":[4174,4174],"./ion-radio_2.entry.js":[4432,4432],"./ion-range.entry.js":[1709,8592,1709],"./ion-refresher_2.entry.js":[3326,8592,2175],"./ion-reorder_2.entry.js":[3583,8592,1186],"./ion-ripple-effect.entry.js":[9958,9958],"./ion-route_4.entry.js":[4330,4330],"./ion-searchbar.entry.js":[8628,8592,8628],"./ion-segment_2.entry.js":[9325,8592,9325],"./ion-select_3.entry.js":[2773,2773],"./ion-slide_2.entry.js":[1650,1650],"./ion-spinner.entry.js":[4908,8592,4908],"./ion-split-pane.entry.js":[9536,9536],"./ion-tab-bar_2.entry.js":[438,8592,438],"./ion-tab_2.entry.js":[1536,8592,1536],"./ion-text.entry.js":[4376,4376],"./ion-textarea.entry.js":[6560,6560],"./ion-toast.entry.js":[6120,8592,6120],"./ion-toggle.entry.js":[5168,8592,5168],"./ion-virtual-scroll.entry.js":[2289,2289]};function g(ie){if(!B.o(h,ie))return Promise.resolve().then(()=>{var se=new Error("Cannot find module '"+ie+"'");throw se.code="MODULE_NOT_FOUND",se});var c=h[ie],Y=c[0];return Promise.all(c.slice(1).map(B.e)).then(()=>B(Y))}g.keys=()=>Object.keys(h),g.id=863,Rn.exports=g},5987:(Rn,Dt,B)=>{"use strict";function fe(_e,pe,ae,Ee){return new(ae||(ae=Promise))(function(Et,qt){function Ft(bt){try{Pt(Ee.next(bt))}catch(ct){qt(ct)}}function xt(bt){try{Pt(Ee.throw(bt))}catch(ct){qt(ct)}}function Pt(bt){bt.done?Et(bt.value):function vt(Et){return Et instanceof ae?Et:new ae(function(qt){qt(Et)})}(bt.value).then(Ft,xt)}Pt((Ee=Ee.apply(_e,pe||[])).next())})}function Ae(_e){return this instanceof Ae?(this.v=_e,this):new Ae(_e)}function te(_e,pe,ae){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var vt,Ee=ae.apply(_e,pe||[]),Et=[];return vt={},qt("next"),qt("throw"),qt("return"),vt[Symbol.asyncIterator]=function(){return this},vt;function qt(ht){Ee[ht]&&(vt[ht]=function(Ce){return new Promise(function(Ct,Ut){Et.push([ht,Ce,Ct,Ut])>1||Ft(ht,Ce)})})}function Ft(ht,Ce){try{!function xt(ht){ht.value instanceof Ae?Promise.resolve(ht.value.v).then(Pt,bt):ct(Et[0][2],ht)}(Ee[ht](Ce))}catch(Ct){ct(Et[0][3],Ct)}}function Pt(ht){Ft("next",ht)}function bt(ht){Ft("throw",ht)}function ct(ht,Ce){ht(Ce),Et.shift(),Et.length&&Ft(Et[0][0],Et[0][1])}}function Ot(_e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var ae,pe=_e[Symbol.asyncIterator];return pe?pe.call(_e):(_e=function be(_e){var pe="function"==typeof Symbol&&Symbol.iterator,ae=pe&&_e[pe],Ee=0;if(ae)return ae.call(_e);if(_e&&"number"==typeof _e.length)return{next:function(){return _e&&Ee>=_e.length&&(_e=void 0),{value:_e&&_e[Ee++],done:!_e}}};throw new TypeError(pe?"Object is not iterable.":"Symbol.iterator is not defined.")}(_e),ae={},Ee("next"),Ee("throw"),Ee("return"),ae[Symbol.asyncIterator]=function(){return this},ae);function Ee(Et){ae[Et]=_e[Et]&&function(qt){return new Promise(function(Ft,xt){!function vt(Et,qt,Ft,xt){Promise.resolve(xt).then(function(Pt){Et({value:Pt,done:Ft})},qt)}(Ft,xt,(qt=_e[Et](qt)).done,qt.value)})}}}B.d(Dt,{FC:()=>te,KL:()=>Ot,mG:()=>fe,qq:()=>Ae})},6895:(Rn,Dt,B)=>{"use strict";B.d(Dt,{Do:()=>Qe,EM:()=>bs,HT:()=>c,JF:()=>ws,JJ:()=>Ho,K0:()=>se,Mx:()=>Br,O5:()=>Oe,S$:()=>Ke,V_:()=>Ie,Ye:()=>Ot,b0:()=>te,bD:()=>go,ez:()=>Ys,q:()=>ie,sg:()=>ri,tP:()=>Ci,uU:()=>Zr,w_:()=>Y});var h=B(8274);let g=null;function ie(){return g}function c(U){g||(g=U)}class Y{}const se=new h.OlP("DocumentToken");let y=(()=>{class U{historyGo(W){throw new Error("Not implemented")}}return U.\u0275fac=function(W){return new(W||U)},U.\u0275prov=h.Yz7({token:U,factory:function(){return function fe(){return(0,h.LFG)(Ge)}()},providedIn:"platform"}),U})();const Ie=new h.OlP("Location Initialized");let Ge=(()=>{class U extends y{constructor(W){super(),this._doc=W,this._init()}_init(){this.location=window.location,this._history=window.history}getBaseHrefFromDOM(){return ie().getBaseHref(this._doc)}onPopState(W){const Me=ie().getGlobalEventTarget(this._doc,"window");return Me.addEventListener("popstate",W,!1),()=>Me.removeEventListener("popstate",W)}onHashChange(W){const Me=ie().getGlobalEventTarget(this._doc,"window");return Me.addEventListener("hashchange",W,!1),()=>Me.removeEventListener("hashchange",W)}get href(){return this.location.href}get protocol(){return this.location.protocol}get hostname(){return this.location.hostname}get port(){return this.location.port}get pathname(){return this.location.pathname}get search(){return this.location.search}get hash(){return this.location.hash}set pathname(W){this.location.pathname=W}pushState(W,Me,Tt){Q()?this._history.pushState(W,Me,Tt):this.location.hash=Tt}replaceState(W,Me,Tt){Q()?this._history.replaceState(W,Me,Tt):this.location.hash=Tt}forward(){this._history.forward()}back(){this._history.back()}historyGo(W=0){this._history.go(W)}getState(){return this._history.state}}return U.\u0275fac=function(W){return new(W||U)(h.LFG(se))},U.\u0275prov=h.Yz7({token:U,factory:function(){return function be(){return new Ge((0,h.LFG)(se))}()},providedIn:"platform"}),U})();function Q(){return!!window.history.pushState}function me(U,ce){if(0==U.length)return ce;if(0==ce.length)return U;let W=0;return U.endsWith("/")&&W++,ce.startsWith("/")&&W++,2==W?U+ce.substring(1):1==W?U+ce:U+"/"+ce}function Ze(U){const ce=U.match(/#|\?|$/),W=ce&&ce.index||U.length;return U.slice(0,W-("/"===U[W-1]?1:0))+U.slice(W)}function he(U){return U&&"?"!==U[0]?"?"+U:U}let Ke=(()=>{class U{historyGo(W){throw new Error("Not implemented")}}return U.\u0275fac=function(W){return new(W||U)},U.\u0275prov=h.Yz7({token:U,factory:function(){return(0,h.f3M)(te)},providedIn:"root"}),U})();const Ae=new h.OlP("appBaseHref");let te=(()=>{class U extends Ke{constructor(W,Me){super(),this._platformLocation=W,this._removeListenerFns=[],this._baseHref=Me??this._platformLocation.getBaseHrefFromDOM()??(0,h.f3M)(se).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(W){this._removeListenerFns.push(this._platformLocation.onPopState(W),this._platformLocation.onHashChange(W))}getBaseHref(){return this._baseHref}prepareExternalUrl(W){return me(this._baseHref,W)}path(W=!1){const Me=this._platformLocation.pathname+he(this._platformLocation.search),Tt=this._platformLocation.hash;return Tt&&W?`${Me}${Tt}`:Me}pushState(W,Me,Tt,fn){const Tn=this.prepareExternalUrl(Tt+he(fn));this._platformLocation.pushState(W,Me,Tn)}replaceState(W,Me,Tt,fn){const Tn=this.prepareExternalUrl(Tt+he(fn));this._platformLocation.replaceState(W,Me,Tn)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(W=0){this._platformLocation.historyGo?.(W)}}return U.\u0275fac=function(W){return new(W||U)(h.LFG(y),h.LFG(Ae,8))},U.\u0275prov=h.Yz7({token:U,factory:U.\u0275fac,providedIn:"root"}),U})(),Qe=(()=>{class U extends Ke{constructor(W,Me){super(),this._platformLocation=W,this._baseHref="",this._removeListenerFns=[],null!=Me&&(this._baseHref=Me)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(W){this._removeListenerFns.push(this._platformLocation.onPopState(W),this._platformLocation.onHashChange(W))}getBaseHref(){return this._baseHref}path(W=!1){let Me=this._platformLocation.hash;return null==Me&&(Me="#"),Me.length>0?Me.substring(1):Me}prepareExternalUrl(W){const Me=me(this._baseHref,W);return Me.length>0?"#"+Me:Me}pushState(W,Me,Tt,fn){let Tn=this.prepareExternalUrl(Tt+he(fn));0==Tn.length&&(Tn=this._platformLocation.pathname),this._platformLocation.pushState(W,Me,Tn)}replaceState(W,Me,Tt,fn){let Tn=this.prepareExternalUrl(Tt+he(fn));0==Tn.length&&(Tn=this._platformLocation.pathname),this._platformLocation.replaceState(W,Me,Tn)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(W=0){this._platformLocation.historyGo?.(W)}}return U.\u0275fac=function(W){return new(W||U)(h.LFG(y),h.LFG(Ae,8))},U.\u0275prov=h.Yz7({token:U,factory:U.\u0275fac}),U})(),Ot=(()=>{class U{constructor(W){this._subject=new h.vpe,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=W;const Me=this._locationStrategy.getBaseHref();this._basePath=function Ne(U){if(new RegExp("^(https?:)?//").test(U)){const[,W]=U.split(/\/\/[^\/]+/);return W}return U}(Ze(Fe(Me))),this._locationStrategy.onPopState(Tt=>{this._subject.emit({url:this.path(!0),pop:!0,state:Tt.state,type:Tt.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(W=!1){return this.normalize(this._locationStrategy.path(W))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(W,Me=""){return this.path()==this.normalize(W+he(Me))}normalize(W){return U.stripTrailingSlash(function ye(U,ce){return U&&ce.startsWith(U)?ce.substring(U.length):ce}(this._basePath,Fe(W)))}prepareExternalUrl(W){return W&&"/"!==W[0]&&(W="/"+W),this._locationStrategy.prepareExternalUrl(W)}go(W,Me="",Tt=null){this._locationStrategy.pushState(Tt,"",W,Me),this._notifyUrlChangeListeners(this.prepareExternalUrl(W+he(Me)),Tt)}replaceState(W,Me="",Tt=null){this._locationStrategy.replaceState(Tt,"",W,Me),this._notifyUrlChangeListeners(this.prepareExternalUrl(W+he(Me)),Tt)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(W=0){this._locationStrategy.historyGo?.(W)}onUrlChange(W){return this._urlChangeListeners.push(W),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(Me=>{this._notifyUrlChangeListeners(Me.url,Me.state)})),()=>{const Me=this._urlChangeListeners.indexOf(W);this._urlChangeListeners.splice(Me,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(W="",Me){this._urlChangeListeners.forEach(Tt=>Tt(W,Me))}subscribe(W,Me,Tt){return this._subject.subscribe({next:W,error:Me,complete:Tt})}}return U.normalizeQueryParams=he,U.joinWithSlash=me,U.stripTrailingSlash=Ze,U.\u0275fac=function(W){return new(W||U)(h.LFG(Ke))},U.\u0275prov=h.Yz7({token:U,factory:function(){return function dt(){return new Ot((0,h.LFG)(Ke))}()},providedIn:"root"}),U})();function Fe(U){return U.replace(/\/index.html$/,"")}var et=(()=>((et=et||{})[et.Decimal=0]="Decimal",et[et.Percent=1]="Percent",et[et.Currency=2]="Currency",et[et.Scientific=3]="Scientific",et))(),_e=(()=>((_e=_e||{})[_e.Format=0]="Format",_e[_e.Standalone=1]="Standalone",_e))(),pe=(()=>((pe=pe||{})[pe.Narrow=0]="Narrow",pe[pe.Abbreviated=1]="Abbreviated",pe[pe.Wide=2]="Wide",pe[pe.Short=3]="Short",pe))(),ae=(()=>((ae=ae||{})[ae.Short=0]="Short",ae[ae.Medium=1]="Medium",ae[ae.Long=2]="Long",ae[ae.Full=3]="Full",ae))(),Ee=(()=>((Ee=Ee||{})[Ee.Decimal=0]="Decimal",Ee[Ee.Group=1]="Group",Ee[Ee.List=2]="List",Ee[Ee.PercentSign=3]="PercentSign",Ee[Ee.PlusSign=4]="PlusSign",Ee[Ee.MinusSign=5]="MinusSign",Ee[Ee.Exponential=6]="Exponential",Ee[Ee.SuperscriptingExponent=7]="SuperscriptingExponent",Ee[Ee.PerMille=8]="PerMille",Ee[Ee.Infinity=9]="Infinity",Ee[Ee.NaN=10]="NaN",Ee[Ee.TimeSeparator=11]="TimeSeparator",Ee[Ee.CurrencyDecimal=12]="CurrencyDecimal",Ee[Ee.CurrencyGroup=13]="CurrencyGroup",Ee))();function ht(U,ce){return _i((0,h.cg1)(U)[h.wAp.DateFormat],ce)}function Ce(U,ce){return _i((0,h.cg1)(U)[h.wAp.TimeFormat],ce)}function Ct(U,ce){return _i((0,h.cg1)(U)[h.wAp.DateTimeFormat],ce)}function Ut(U,ce){const W=(0,h.cg1)(U),Me=W[h.wAp.NumberSymbols][ce];if(typeof Me>"u"){if(ce===Ee.CurrencyDecimal)return W[h.wAp.NumberSymbols][Ee.Decimal];if(ce===Ee.CurrencyGroup)return W[h.wAp.NumberSymbols][Ee.Group]}return Me}function En(U){if(!U[h.wAp.ExtraData])throw new Error(`Missing extra locale data for the locale "${U[h.wAp.LocaleId]}". Use "registerLocaleData" to load new data. See the "I18n guide" on angular.io to know more.`)}function _i(U,ce){for(let W=ce;W>-1;W--)if(typeof U[W]<"u")return U[W];throw new Error("Locale data API: locale data undefined")}function wi(U){const[ce,W]=U.split(":");return{hours:+ce,minutes:+W}}const Ui=/^(\d{4,})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,Yi={},Ht=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/;var Mt=(()=>((Mt=Mt||{})[Mt.Short=0]="Short",Mt[Mt.ShortGMT=1]="ShortGMT",Mt[Mt.Long=2]="Long",Mt[Mt.Extended=3]="Extended",Mt))(),qe=(()=>((qe=qe||{})[qe.FullYear=0]="FullYear",qe[qe.Month=1]="Month",qe[qe.Date=2]="Date",qe[qe.Hours=3]="Hours",qe[qe.Minutes=4]="Minutes",qe[qe.Seconds=5]="Seconds",qe[qe.FractionalSeconds=6]="FractionalSeconds",qe[qe.Day=7]="Day",qe))(),re=(()=>((re=re||{})[re.DayPeriods=0]="DayPeriods",re[re.Days=1]="Days",re[re.Months=2]="Months",re[re.Eras=3]="Eras",re))();function tt(U,ce,W,Me){let Tt=function Le(U){if(Bt(U))return U;if("number"==typeof U&&!isNaN(U))return new Date(U);if("string"==typeof U){if(U=U.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(U)){const[Tt,fn=1,Tn=1]=U.split("-").map(li=>+li);return Wt(Tt,fn-1,Tn)}const W=parseFloat(U);if(!isNaN(U-W))return new Date(W);let Me;if(Me=U.match(Ui))return function st(U){const ce=new Date(0);let W=0,Me=0;const Tt=U[8]?ce.setUTCFullYear:ce.setFullYear,fn=U[8]?ce.setUTCHours:ce.setHours;U[9]&&(W=Number(U[9]+U[10]),Me=Number(U[9]+U[11])),Tt.call(ce,Number(U[1]),Number(U[2])-1,Number(U[3]));const Tn=Number(U[4]||0)-W,li=Number(U[5]||0)-Me,sr=Number(U[6]||0),nr=Math.floor(1e3*parseFloat("0."+(U[7]||0)));return fn.call(ce,Tn,li,sr,nr),ce}(Me)}const ce=new Date(U);if(!Bt(ce))throw new Error(`Unable to convert "${U}" into a date`);return ce}(U);ce=Qt(W,ce)||ce;let li,Tn=[];for(;ce;){if(li=Ht.exec(ce),!li){Tn.push(ce);break}{Tn=Tn.concat(li.slice(1));const dr=Tn.pop();if(!dr)break;ce=dr}}let sr=Tt.getTimezoneOffset();Me&&(sr=R(Me,sr),Tt=function de(U,ce,W){const Me=W?-1:1,Tt=U.getTimezoneOffset();return function j(U,ce){return(U=new Date(U.getTime())).setMinutes(U.getMinutes()+ce),U}(U,Me*(R(ce,Tt)-Tt))}(Tt,Me,!0));let nr="";return Tn.forEach(dr=>{const Wi=function le(U){if(Ve[U])return Ve[U];let ce;switch(U){case"G":case"GG":case"GGG":ce=Pi(re.Eras,pe.Abbreviated);break;case"GGGG":ce=Pi(re.Eras,pe.Wide);break;case"GGGGG":ce=Pi(re.Eras,pe.Narrow);break;case"y":ce=mi(qe.FullYear,1,0,!1,!0);break;case"yy":ce=mi(qe.FullYear,2,0,!0,!0);break;case"yyy":ce=mi(qe.FullYear,3,0,!1,!0);break;case"yyyy":ce=mi(qe.FullYear,4,0,!1,!0);break;case"Y":ce=gn(1);break;case"YY":ce=gn(2,!0);break;case"YYY":ce=gn(3);break;case"YYYY":ce=gn(4);break;case"M":case"L":ce=mi(qe.Month,1,1);break;case"MM":case"LL":ce=mi(qe.Month,2,1);break;case"MMM":ce=Pi(re.Months,pe.Abbreviated);break;case"MMMM":ce=Pi(re.Months,pe.Wide);break;case"MMMMM":ce=Pi(re.Months,pe.Narrow);break;case"LLL":ce=Pi(re.Months,pe.Abbreviated,_e.Standalone);break;case"LLLL":ce=Pi(re.Months,pe.Wide,_e.Standalone);break;case"LLLLL":ce=Pi(re.Months,pe.Narrow,_e.Standalone);break;case"w":ce=kt(1);break;case"ww":ce=kt(2);break;case"W":ce=kt(1,!0);break;case"d":ce=mi(qe.Date,1);break;case"dd":ce=mi(qe.Date,2);break;case"c":case"cc":ce=mi(qe.Day,1);break;case"ccc":ce=Pi(re.Days,pe.Abbreviated,_e.Standalone);break;case"cccc":ce=Pi(re.Days,pe.Wide,_e.Standalone);break;case"ccccc":ce=Pi(re.Days,pe.Narrow,_e.Standalone);break;case"cccccc":ce=Pi(re.Days,pe.Short,_e.Standalone);break;case"E":case"EE":case"EEE":ce=Pi(re.Days,pe.Abbreviated);break;case"EEEE":ce=Pi(re.Days,pe.Wide);break;case"EEEEE":ce=Pi(re.Days,pe.Narrow);break;case"EEEEEE":ce=Pi(re.Days,pe.Short);break;case"a":case"aa":case"aaa":ce=Pi(re.DayPeriods,pe.Abbreviated);break;case"aaaa":ce=Pi(re.DayPeriods,pe.Wide);break;case"aaaaa":ce=Pi(re.DayPeriods,pe.Narrow);break;case"b":case"bb":case"bbb":ce=Pi(re.DayPeriods,pe.Abbreviated,_e.Standalone,!0);break;case"bbbb":ce=Pi(re.DayPeriods,pe.Wide,_e.Standalone,!0);break;case"bbbbb":ce=Pi(re.DayPeriods,pe.Narrow,_e.Standalone,!0);break;case"B":case"BB":case"BBB":ce=Pi(re.DayPeriods,pe.Abbreviated,_e.Format,!0);break;case"BBBB":ce=Pi(re.DayPeriods,pe.Wide,_e.Format,!0);break;case"BBBBB":ce=Pi(re.DayPeriods,pe.Narrow,_e.Format,!0);break;case"h":ce=mi(qe.Hours,1,-12);break;case"hh":ce=mi(qe.Hours,2,-12);break;case"H":ce=mi(qe.Hours,1);break;case"HH":ce=mi(qe.Hours,2);break;case"m":ce=mi(qe.Minutes,1);break;case"mm":ce=mi(qe.Minutes,2);break;case"s":ce=mi(qe.Seconds,1);break;case"ss":ce=mi(qe.Seconds,2);break;case"S":ce=mi(qe.FractionalSeconds,1);break;case"SS":ce=mi(qe.FractionalSeconds,2);break;case"SSS":ce=mi(qe.FractionalSeconds,3);break;case"Z":case"ZZ":case"ZZZ":ce=wr(Mt.Short);break;case"ZZZZZ":ce=wr(Mt.Extended);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":ce=wr(Mt.ShortGMT);break;case"OOOO":case"ZZZZ":case"zzzz":ce=wr(Mt.Long);break;default:return null}return Ve[U]=ce,ce}(dr);nr+=Wi?Wi(Tt,W,sr):"''"===dr?"'":dr.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),nr}function Wt(U,ce,W){const Me=new Date(0);return Me.setFullYear(U,ce,W),Me.setHours(0,0,0),Me}function Qt(U,ce){const W=function Et(U){return(0,h.cg1)(U)[h.wAp.LocaleId]}(U);if(Yi[W]=Yi[W]||{},Yi[W][ce])return Yi[W][ce];let Me="";switch(ce){case"shortDate":Me=ht(U,ae.Short);break;case"mediumDate":Me=ht(U,ae.Medium);break;case"longDate":Me=ht(U,ae.Long);break;case"fullDate":Me=ht(U,ae.Full);break;case"shortTime":Me=Ce(U,ae.Short);break;case"mediumTime":Me=Ce(U,ae.Medium);break;case"longTime":Me=Ce(U,ae.Long);break;case"fullTime":Me=Ce(U,ae.Full);break;case"short":const Tt=Qt(U,"shortTime"),fn=Qt(U,"shortDate");Me=fi(Ct(U,ae.Short),[Tt,fn]);break;case"medium":const Tn=Qt(U,"mediumTime"),li=Qt(U,"mediumDate");Me=fi(Ct(U,ae.Medium),[Tn,li]);break;case"long":const sr=Qt(U,"longTime"),nr=Qt(U,"longDate");Me=fi(Ct(U,ae.Long),[sr,nr]);break;case"full":const dr=Qt(U,"fullTime"),Wi=Qt(U,"fullDate");Me=fi(Ct(U,ae.Full),[dr,Wi])}return Me&&(Yi[W][ce]=Me),Me}function fi(U,ce){return ce&&(U=U.replace(/\{([^}]+)}/g,function(W,Me){return null!=ce&&Me in ce?ce[Me]:W})),U}function Ai(U,ce,W="-",Me,Tt){let fn="";(U<0||Tt&&U<=0)&&(Tt?U=1-U:(U=-U,fn=W));let Tn=String(U);for(;Tn.length<ce;)Tn="0"+Tn;return Me&&(Tn=Tn.slice(Tn.length-ce)),fn+Tn}function mi(U,ce,W=0,Me=!1,Tt=!1){return function(fn,Tn){let li=function xr(U,ce){switch(U){case qe.FullYear:return ce.getFullYear();case qe.Month:return ce.getMonth();case qe.Date:return ce.getDate();case qe.Hours:return ce.getHours();case qe.Minutes:return ce.getMinutes();case qe.Seconds:return ce.getSeconds();case qe.FractionalSeconds:return ce.getMilliseconds();case qe.Day:return ce.getDay();default:throw new Error(`Unknown DateType value "${U}".`)}}(U,fn);if((W>0||li>-W)&&(li+=W),U===qe.Hours)0===li&&-12===W&&(li=12);else if(U===qe.FractionalSeconds)return function er(U,ce){return Ai(U,3).substring(0,ce)}(li,ce);const sr=Ut(Tn,Ee.MinusSign);return Ai(li,ce,sr,Me,Tt)}}function Pi(U,ce,W=_e.Format,Me=!1){return function(Tt,fn){return function br(U,ce,W,Me,Tt,fn){switch(W){case re.Months:return function xt(U,ce,W){const Me=(0,h.cg1)(U),fn=_i([Me[h.wAp.MonthsFormat],Me[h.wAp.MonthsStandalone]],ce);return _i(fn,W)}(ce,Tt,Me)[U.getMonth()];case re.Days:return function Ft(U,ce,W){const Me=(0,h.cg1)(U),fn=_i([Me[h.wAp.DaysFormat],Me[h.wAp.DaysStandalone]],ce);return _i(fn,W)}(ce,Tt,Me)[U.getDay()];case re.DayPeriods:const Tn=U.getHours(),li=U.getMinutes();if(fn){const nr=function ni(U){const ce=(0,h.cg1)(U);return En(ce),(ce[h.wAp.ExtraData][2]||[]).map(Me=>"string"==typeof Me?wi(Me):[wi(Me[0]),wi(Me[1])])}(ce),dr=function ci(U,ce,W){const Me=(0,h.cg1)(U);En(Me);const fn=_i([Me[h.wAp.ExtraData][0],Me[h.wAp.ExtraData][1]],ce)||[];return _i(fn,W)||[]}(ce,Tt,Me),Wi=nr.findIndex(Sr=>{if(Array.isArray(Sr)){const[gr,to]=Sr,jo=Tn>=gr.hours&&li>=gr.minutes,Oo=Tn<to.hours||Tn===to.hours&&li<to.minutes;if(gr.hours<to.hours){if(jo&&Oo)return!0}else if(jo||Oo)return!0}else if(Sr.hours===Tn&&Sr.minutes===li)return!0;return!1});if(-1!==Wi)return dr[Wi]}return function qt(U,ce,W){const Me=(0,h.cg1)(U),fn=_i([Me[h.wAp.DayPeriodsFormat],Me[h.wAp.DayPeriodsStandalone]],ce);return _i(fn,W)}(ce,Tt,Me)[Tn<12?0:1];case re.Eras:return function Pt(U,ce){return _i((0,h.cg1)(U)[h.wAp.Eras],ce)}(ce,Me)[U.getFullYear()<=0?0:1];default:throw new Error(`unexpected translation type ${W}`)}}(Tt,fn,U,ce,W,Me)}}function wr(U){return function(ce,W,Me){const Tt=-1*Me,fn=Ut(W,Ee.MinusSign),Tn=Tt>0?Math.floor(Tt/60):Math.ceil(Tt/60);switch(U){case Mt.Short:return(Tt>=0?"+":"")+Ai(Tn,2,fn)+Ai(Math.abs(Tt%60),2,fn);case Mt.ShortGMT:return"GMT"+(Tt>=0?"+":"")+Ai(Tn,1,fn);case Mt.Long:return"GMT"+(Tt>=0?"+":"")+Ai(Tn,2,fn)+":"+Ai(Math.abs(Tt%60),2,fn);case Mt.Extended:return 0===Me?"Z":(Tt>=0?"+":"")+Ai(Tn,2,fn)+":"+Ai(Math.abs(Tt%60),2,fn);default:throw new Error(`Unknown zone width "${U}"`)}}}function _t(U){return Wt(U.getFullYear(),U.getMonth(),U.getDate()+(4-U.getDay()))}function kt(U,ce=!1){return function(W,Me){let Tt;if(ce){const fn=new Date(W.getFullYear(),W.getMonth(),1).getDay()-1,Tn=W.getDate();Tt=1+Math.floor((Tn+fn)/7)}else{const fn=_t(W),Tn=function pn(U){const ce=Wt(U,0,1).getDay();return Wt(U,0,1+(ce<=4?4:11)-ce)}(fn.getFullYear()),li=fn.getTime()-Tn.getTime();Tt=1+Math.round(li/6048e5)}return Ai(Tt,U,Ut(Me,Ee.MinusSign))}}function gn(U,ce=!1){return function(W,Me){return Ai(_t(W).getFullYear(),U,Ut(Me,Ee.MinusSign),ce)}}const Ve={};function R(U,ce){U=U.replace(/:/g,"");const W=Date.parse("Jan 01, 1970 00:00:00 "+U)/6e4;return isNaN(W)?ce:W}function Bt(U){return U instanceof Date&&!isNaN(U.valueOf())}const Rt=/^(\d+)?\.((\d+)(-(\d+))?)?$/;function on(U){const ce=parseInt(U);if(isNaN(ce))throw new Error("Invalid integer literal when parsing "+U);return ce}function Br(U,ce){ce=encodeURIComponent(ce);for(const W of U.split(";")){const Me=W.indexOf("="),[Tt,fn]=-1==Me?[W,""]:[W.slice(0,Me),W.slice(Me+1)];if(Tt.trim()===ce)return decodeURIComponent(fn)}return null}class hi{constructor(ce,W,Me,Tt){this.$implicit=ce,this.ngForOf=W,this.index=Me,this.count=Tt}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let ri=(()=>{class U{constructor(W,Me,Tt){this._viewContainer=W,this._template=Me,this._differs=Tt,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForOf(W){this._ngForOf=W,this._ngForOfDirty=!0}set ngForTrackBy(W){this._trackByFn=W}get ngForTrackBy(){return this._trackByFn}set ngForTemplate(W){W&&(this._template=W)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const W=this._ngForOf;!this._differ&&W&&(this._differ=this._differs.find(W).create(this.ngForTrackBy))}if(this._differ){const W=this._differ.diff(this._ngForOf);W&&this._applyChanges(W)}}_applyChanges(W){const Me=this._viewContainer;W.forEachOperation((Tt,fn,Tn)=>{if(null==Tt.previousIndex)Me.createEmbeddedView(this._template,new hi(Tt.item,this._ngForOf,-1,-1),null===Tn?void 0:Tn);else if(null==Tn)Me.remove(null===fn?void 0:fn);else if(null!==fn){const li=Me.get(fn);Me.move(li,Tn),Wn(li,Tt)}});for(let Tt=0,fn=Me.length;Tt<fn;Tt++){const li=Me.get(Tt).context;li.index=Tt,li.count=fn,li.ngForOf=this._ngForOf}W.forEachIdentityChange(Tt=>{Wn(Me.get(Tt.currentIndex),Tt)})}static ngTemplateContextGuard(W,Me){return!0}}return U.\u0275fac=function(W){return new(W||U)(h.Y36(h.s_b),h.Y36(h.Rgc),h.Y36(h.ZZ4))},U.\u0275dir=h.lG2({type:U,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0}),U})();function Wn(U,ce){U.context.$implicit=ce.item}let Oe=(()=>{class U{constructor(W,Me){this._viewContainer=W,this._context=new Lt,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=Me}set ngIf(W){this._context.$implicit=this._context.ngIf=W,this._updateView()}set ngIfThen(W){$t("ngIfThen",W),this._thenTemplateRef=W,this._thenViewRef=null,this._updateView()}set ngIfElse(W){$t("ngIfElse",W),this._elseTemplateRef=W,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(W,Me){return!0}}return U.\u0275fac=function(W){return new(W||U)(h.Y36(h.s_b),h.Y36(h.Rgc))},U.\u0275dir=h.lG2({type:U,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0}),U})();class Lt{constructor(){this.$implicit=null,this.ngIf=null}}function $t(U,ce){if(ce&&!ce.createEmbeddedView)throw new Error(`${U} must be a TemplateRef, but received '${(0,h.AaK)(ce)}'.`)}let Ci=(()=>{class U{constructor(W){this._viewContainerRef=W,this._viewRef=null,this.ngTemplateOutletContext=null,this.ngTemplateOutlet=null,this.ngTemplateOutletInjector=null}ngOnChanges(W){if(W.ngTemplateOutlet||W.ngTemplateOutletInjector){const Me=this._viewContainerRef;if(this._viewRef&&Me.remove(Me.indexOf(this._viewRef)),this.ngTemplateOutlet){const{ngTemplateOutlet:Tt,ngTemplateOutletContext:fn,ngTemplateOutletInjector:Tn}=this;this._viewRef=Me.createEmbeddedView(Tt,fn,Tn?{injector:Tn}:void 0)}else this._viewRef=null}else this._viewRef&&W.ngTemplateOutletContext&&this.ngTemplateOutletContext&&(this._viewRef.context=this.ngTemplateOutletContext)}}return U.\u0275fac=function(W){return new(W||U)(h.Y36(h.s_b))},U.\u0275dir=h.lG2({type:U,selectors:[["","ngTemplateOutlet",""]],inputs:{ngTemplateOutletContext:"ngTemplateOutletContext",ngTemplateOutlet:"ngTemplateOutlet",ngTemplateOutletInjector:"ngTemplateOutletInjector"},standalone:!0,features:[h.TTD]}),U})();function ki(U,ce){return new h.vHH(2100,!1)}const Dr=new h.OlP("DATE_PIPE_DEFAULT_TIMEZONE"),Mo=new h.OlP("DATE_PIPE_DEFAULT_OPTIONS");let Zr=(()=>{class U{constructor(W,Me,Tt){this.locale=W,this.defaultTimezone=Me,this.defaultOptions=Tt}transform(W,Me,Tt,fn){if(null==W||""===W||W!=W)return null;try{return tt(W,Me??this.defaultOptions?.dateFormat??"mediumDate",fn||this.locale,Tt??this.defaultOptions?.timezone??this.defaultTimezone??void 0)}catch(Tn){throw ki()}}}return U.\u0275fac=function(W){return new(W||U)(h.Y36(h.soG,16),h.Y36(Dr,24),h.Y36(Mo,24))},U.\u0275pipe=h.Yjl({name:"date",type:U,pure:!0,standalone:!0}),U})(),Ho=(()=>{class U{constructor(W){this._locale=W}transform(W,Me,Tt){if(!function Bs(U){return!(null==U||""===U||U!=U)}(W))return null;Tt=Tt||this._locale;try{return function Kn(U,ce,W){return function Yn(U,ce,W,Me,Tt,fn,Tn=!1){let li="",sr=!1;if(isFinite(U)){let nr=function Qr(U){let Me,Tt,fn,Tn,li,ce=Math.abs(U)+"",W=0;for((Tt=ce.indexOf("."))>-1&&(ce=ce.replace(".","")),(fn=ce.search(/e/i))>0?(Tt<0&&(Tt=fn),Tt+=+ce.slice(fn+1),ce=ce.substring(0,fn)):Tt<0&&(Tt=ce.length),fn=0;"0"===ce.charAt(fn);fn++);if(fn===(li=ce.length))Me=[0],Tt=1;else{for(li--;"0"===ce.charAt(li);)li--;for(Tt-=fn,Me=[],Tn=0;fn<=li;fn++,Tn++)Me[Tn]=Number(ce.charAt(fn))}return Tt>22&&(Me=Me.splice(0,21),W=Tt-1,Tt=1),{digits:Me,exponent:W,integerLen:Tt}}(U);Tn&&(nr=function Bi(U){if(0===U.digits[0])return U;const ce=U.digits.length-U.integerLen;return U.exponent?U.exponent+=2:(0===ce?U.digits.push(0,0):1===ce&&U.digits.push(0),U.integerLen+=2),U}(nr));let dr=ce.minInt,Wi=ce.minFrac,Sr=ce.maxFrac;if(fn){const ho=fn.match(Rt);if(null===ho)throw new Error(`${fn} is not a valid digit info`);const Na=ho[1],Wl=ho[3],ql=ho[5];null!=Na&&(dr=on(Na)),null!=Wl&&(Wi=on(Wl)),null!=ql?Sr=on(ql):null!=Wl&&Wi>Sr&&(Sr=Wi)}!function Cr(U,ce,W){if(ce>W)throw new Error(`The minimum number of digits after fraction (${ce}) is higher than the maximum (${W}).`);let Me=U.digits,Tt=Me.length-U.integerLen;const fn=Math.min(Math.max(ce,Tt),W);let Tn=fn+U.integerLen,li=Me[Tn];if(Tn>0){Me.splice(Math.max(U.integerLen,Tn));for(let Wi=Tn;Wi<Me.length;Wi++)Me[Wi]=0}else{Tt=Math.max(0,Tt),U.integerLen=1,Me.length=Math.max(1,Tn=fn+1),Me[0]=0;for(let Wi=1;Wi<Tn;Wi++)Me[Wi]=0}if(li>=5)if(Tn-1<0){for(let Wi=0;Wi>Tn;Wi--)Me.unshift(0),U.integerLen++;Me.unshift(1),U.integerLen++}else Me[Tn-1]++;for(;Tt<Math.max(0,fn);Tt++)Me.push(0);let sr=0!==fn;const nr=ce+U.integerLen,dr=Me.reduceRight(function(Wi,Sr,gr,to){return to[gr]=(Sr+=Wi)<10?Sr:Sr-10,sr&&(0===to[gr]&&gr>=nr?to.pop():sr=!1),Sr>=10?1:0},0);dr&&(Me.unshift(dr),U.integerLen++)}(nr,Wi,Sr);let gr=nr.digits,to=nr.integerLen;const jo=nr.exponent;let Oo=[];for(sr=gr.every(ho=>!ho);to<dr;to++)gr.unshift(0);for(;to<0;to++)gr.unshift(0);to>0?Oo=gr.splice(to,gr.length):(Oo=gr,gr=[0]);const Gn=[];for(gr.length>=ce.lgSize&&Gn.unshift(gr.splice(-ce.lgSize,gr.length).join(""));gr.length>ce.gSize;)Gn.unshift(gr.splice(-ce.gSize,gr.length).join(""));gr.length&&Gn.unshift(gr.join("")),li=Gn.join(Ut(W,Me)),Oo.length&&(li+=Ut(W,Tt)+Oo.join("")),jo&&(li+=Ut(W,Ee.Exponential)+"+"+jo)}else li=Ut(W,Ee.Infinity);return li=U<0&&!sr?ce.negPre+li+ce.negSuf:ce.posPre+li+ce.posSuf,li}(U,function Vi(U,ce="-"){const W={minInt:1,minFrac:0,maxFrac:0,posPre:"",posSuf:"",negPre:"",negSuf:"",gSize:0,lgSize:0},Me=U.split(";"),Tt=Me[0],fn=Me[1],Tn=-1!==Tt.indexOf(".")?Tt.split("."):[Tt.substring(0,Tt.lastIndexOf("0")+1),Tt.substring(Tt.lastIndexOf("0")+1)],li=Tn[0],sr=Tn[1]||"";W.posPre=li.substring(0,li.indexOf("#"));for(let dr=0;dr<sr.length;dr++){const Wi=sr.charAt(dr);"0"===Wi?W.minFrac=W.maxFrac=dr+1:"#"===Wi?W.maxFrac=dr+1:W.posSuf+=Wi}const nr=li.split(",");if(W.gSize=nr[1]?nr[1].length:0,W.lgSize=nr[2]||nr[1]?(nr[2]||nr[1]).length:0,fn){const dr=Tt.length-W.posPre.length-W.posSuf.length,Wi=fn.indexOf("#");W.negPre=fn.substring(0,Wi).replace(/'/g,""),W.negSuf=fn.slice(Wi+dr).replace(/'/g,"")}else W.negPre=ce+W.posPre,W.negSuf=W.posSuf;return W}(function Gt(U,ce){return(0,h.cg1)(U)[h.wAp.NumberFormats][ce]}(ce,et.Decimal),Ut(ce,Ee.MinusSign)),ce,Ee.Group,Ee.Decimal,W)}(function oa(U){if("string"==typeof U&&!isNaN(Number(U)-parseFloat(U)))return Number(U);if("number"!=typeof U)throw new Error(`${U} is not a number`);return U}(W),Tt,Me)}catch(fn){throw ki()}}}return U.\u0275fac=function(W){return new(W||U)(h.Y36(h.soG,16))},U.\u0275pipe=h.Yjl({name:"number",type:U,pure:!0,standalone:!0}),U})();let Ys=(()=>{class U{}return U.\u0275fac=function(W){return new(W||U)},U.\u0275mod=h.oAB({type:U}),U.\u0275inj=h.cJS({}),U})();const go="browser";let bs=(()=>{class U{}return U.\u0275prov=(0,h.Yz7)({token:U,providedIn:"root",factory:()=>new aa((0,h.LFG)(se),window)}),U})();class aa{constructor(ce,W){this.document=ce,this.window=W,this.offset=()=>[0,0]}setOffset(ce){this.offset=Array.isArray(ce)?()=>ce:ce}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(ce){this.supportsScrolling()&&this.window.scrollTo(ce[0],ce[1])}scrollToAnchor(ce){if(!this.supportsScrolling())return;const W=function Js(U,ce){const W=U.getElementById(ce)||U.getElementsByName(ce)[0];if(W)return W;if("function"==typeof U.createTreeWalker&&U.body&&(U.body.createShadowRoot||U.body.attachShadow)){const Me=U.createTreeWalker(U.body,NodeFilter.SHOW_ELEMENT);let Tt=Me.currentNode;for(;Tt;){const fn=Tt.shadowRoot;if(fn){const Tn=fn.getElementById(ce)||fn.querySelector(`[name="${ce}"]`);if(Tn)return Tn}Tt=Me.nextNode()}}return null}(this.document,ce);W&&(this.scrollToElement(W),W.focus())}setHistoryScrollRestoration(ce){if(this.supportScrollRestoration()){const W=this.window.history;W&&W.scrollRestoration&&(W.scrollRestoration=ce)}}scrollToElement(ce){const W=ce.getBoundingClientRect(),Me=W.left+this.window.pageXOffset,Tt=W.top+this.window.pageYOffset,fn=this.offset();this.window.scrollTo(Me-fn[0],Tt-fn[1])}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const ce=Wo(this.window.history)||Wo(Object.getPrototypeOf(this.window.history));return!(!ce||!ce.writable&&!ce.set)}catch{return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch{return!1}}}function Wo(U){return Object.getOwnPropertyDescriptor(U,"scrollRestoration")}class ws{}},529:(Rn,Dt,B)=>{"use strict";B.d(Dt,{JF:()=>wr,TP:()=>Pt,WM:()=>Ge,eN:()=>Et});var h=B(6895),g=B(8274),ie=B(9646),c=B(9751),Y=B(4351),se=B(9300),y=B(4004);class fe{}class Ie{}class Ge{constructor(_t){this.normalizedNames=new Map,this.lazyUpdate=null,_t?this.lazyInit="string"==typeof _t?()=>{this.headers=new Map,_t.split("\n").forEach(kt=>{const gn=kt.indexOf(":");if(gn>0){const Ve=kt.slice(0,gn),le=Ve.toLowerCase(),R=kt.slice(gn+1).trim();this.maybeSetNormalizedName(Ve,le),this.headers.has(le)?this.headers.get(le).push(R):this.headers.set(le,[R])}})}:()=>{this.headers=new Map,Object.keys(_t).forEach(kt=>{let gn=_t[kt];const Ve=kt.toLowerCase();"string"==typeof gn&&(gn=[gn]),gn.length>0&&(this.headers.set(Ve,gn),this.maybeSetNormalizedName(kt,Ve))})}:this.headers=new Map}has(_t){return this.init(),this.headers.has(_t.toLowerCase())}get(_t){this.init();const kt=this.headers.get(_t.toLowerCase());return kt&&kt.length>0?kt[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(_t){return this.init(),this.headers.get(_t.toLowerCase())||null}append(_t,kt){return this.clone({name:_t,value:kt,op:"a"})}set(_t,kt){return this.clone({name:_t,value:kt,op:"s"})}delete(_t,kt){return this.clone({name:_t,value:kt,op:"d"})}maybeSetNormalizedName(_t,kt){this.normalizedNames.has(kt)||this.normalizedNames.set(kt,_t)}init(){this.lazyInit&&(this.lazyInit instanceof Ge?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(_t=>this.applyUpdate(_t)),this.lazyUpdate=null))}copyFrom(_t){_t.init(),Array.from(_t.headers.keys()).forEach(kt=>{this.headers.set(kt,_t.headers.get(kt)),this.normalizedNames.set(kt,_t.normalizedNames.get(kt))})}clone(_t){const kt=new Ge;return kt.lazyInit=this.lazyInit&&this.lazyInit instanceof Ge?this.lazyInit:this,kt.lazyUpdate=(this.lazyUpdate||[]).concat([_t]),kt}applyUpdate(_t){const kt=_t.name.toLowerCase();switch(_t.op){case"a":case"s":let gn=_t.value;if("string"==typeof gn&&(gn=[gn]),0===gn.length)return;this.maybeSetNormalizedName(_t.name,kt);const Ve=("a"===_t.op?this.headers.get(kt):void 0)||[];Ve.push(...gn),this.headers.set(kt,Ve);break;case"d":const le=_t.value;if(le){let R=this.headers.get(kt);if(!R)return;R=R.filter(j=>-1===le.indexOf(j)),0===R.length?(this.headers.delete(kt),this.normalizedNames.delete(kt)):this.headers.set(kt,R)}else this.headers.delete(kt),this.normalizedNames.delete(kt)}}forEach(_t){this.init(),Array.from(this.normalizedNames.keys()).forEach(kt=>_t(this.normalizedNames.get(kt),this.headers.get(kt)))}}class be{encodeKey(_t){return Ke(_t)}encodeValue(_t){return Ke(_t)}decodeKey(_t){return decodeURIComponent(_t)}decodeValue(_t){return decodeURIComponent(_t)}}const Ze=/%(\d[a-f0-9])/gi,he={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function Ke(pn){return encodeURIComponent(pn).replace(Ze,(_t,kt)=>he[kt]??_t)}function Ae(pn){return`${pn}`}class te{constructor(_t={}){if(this.updates=null,this.cloneFrom=null,this.encoder=_t.encoder||new be,_t.fromString){if(_t.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function me(pn,_t){const kt=new Map;return pn.length>0&&pn.replace(/^\?/,"").split("&").forEach(Ve=>{const le=Ve.indexOf("="),[R,j]=-1==le?[_t.decodeKey(Ve),""]:[_t.decodeKey(Ve.slice(0,le)),_t.decodeValue(Ve.slice(le+1))],de=kt.get(R)||[];de.push(j),kt.set(R,de)}),kt}(_t.fromString,this.encoder)}else _t.fromObject?(this.map=new Map,Object.keys(_t.fromObject).forEach(kt=>{const gn=_t.fromObject[kt],Ve=Array.isArray(gn)?gn.map(Ae):[Ae(gn)];this.map.set(kt,Ve)})):this.map=null}has(_t){return this.init(),this.map.has(_t)}get(_t){this.init();const kt=this.map.get(_t);return kt?kt[0]:null}getAll(_t){return this.init(),this.map.get(_t)||null}keys(){return this.init(),Array.from(this.map.keys())}append(_t,kt){return this.clone({param:_t,value:kt,op:"a"})}appendAll(_t){const kt=[];return Object.keys(_t).forEach(gn=>{const Ve=_t[gn];Array.isArray(Ve)?Ve.forEach(le=>{kt.push({param:gn,value:le,op:"a"})}):kt.push({param:gn,value:Ve,op:"a"})}),this.clone(kt)}set(_t,kt){return this.clone({param:_t,value:kt,op:"s"})}delete(_t,kt){return this.clone({param:_t,value:kt,op:"d"})}toString(){return this.init(),this.keys().map(_t=>{const kt=this.encoder.encodeKey(_t);return this.map.get(_t).map(gn=>kt+"="+this.encoder.encodeValue(gn)).join("&")}).filter(_t=>""!==_t).join("&")}clone(_t){const kt=new te({encoder:this.encoder});return kt.cloneFrom=this.cloneFrom||this,kt.updates=(this.updates||[]).concat(_t),kt}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(_t=>this.map.set(_t,this.cloneFrom.map.get(_t))),this.updates.forEach(_t=>{switch(_t.op){case"a":case"s":const kt=("a"===_t.op?this.map.get(_t.param):void 0)||[];kt.push(Ae(_t.value)),this.map.set(_t.param,kt);break;case"d":if(void 0===_t.value){this.map.delete(_t.param);break}{let gn=this.map.get(_t.param)||[];const Ve=gn.indexOf(Ae(_t.value));-1!==Ve&&gn.splice(Ve,1),gn.length>0?this.map.set(_t.param,gn):this.map.delete(_t.param)}}}),this.cloneFrom=this.updates=null)}}class Ot{constructor(){this.map=new Map}set(_t,kt){return this.map.set(_t,kt),this}get(_t){return this.map.has(_t)||this.map.set(_t,_t.defaultValue()),this.map.get(_t)}delete(_t){return this.map.delete(_t),this}has(_t){return this.map.has(_t)}keys(){return this.map.keys()}}function ye(pn){return typeof ArrayBuffer<"u"&&pn instanceof ArrayBuffer}function Fe(pn){return typeof Blob<"u"&&pn instanceof Blob}function Ne(pn){return typeof FormData<"u"&&pn instanceof FormData}class et{constructor(_t,kt,gn,Ve){let le;if(this.url=kt,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=_t.toUpperCase(),function dt(pn){switch(pn){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||Ve?(this.body=void 0!==gn?gn:null,le=Ve):le=gn,le&&(this.reportProgress=!!le.reportProgress,this.withCredentials=!!le.withCredentials,le.responseType&&(this.responseType=le.responseType),le.headers&&(this.headers=le.headers),le.context&&(this.context=le.context),le.params&&(this.params=le.params)),this.headers||(this.headers=new Ge),this.context||(this.context=new Ot),this.params){const R=this.params.toString();if(0===R.length)this.urlWithParams=kt;else{const j=kt.indexOf("?");this.urlWithParams=kt+(-1===j?"?":j<kt.length-1?"&":"")+R}}else this.params=new te,this.urlWithParams=kt}serializeBody(){return null===this.body?null:ye(this.body)||Fe(this.body)||Ne(this.body)||function we(pn){return typeof URLSearchParams<"u"&&pn instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof te?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||Ne(this.body)?null:Fe(this.body)?this.body.type||null:ye(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof te?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(_t={}){const kt=_t.method||this.method,gn=_t.url||this.url,Ve=_t.responseType||this.responseType,le=void 0!==_t.body?_t.body:this.body,R=void 0!==_t.withCredentials?_t.withCredentials:this.withCredentials,j=void 0!==_t.reportProgress?_t.reportProgress:this.reportProgress;let de=_t.headers||this.headers,Le=_t.params||this.params;const st=_t.context??this.context;return void 0!==_t.setHeaders&&(de=Object.keys(_t.setHeaders).reduce((Bt,Rt)=>Bt.set(Rt,_t.setHeaders[Rt]),de)),_t.setParams&&(Le=Object.keys(_t.setParams).reduce((Bt,Rt)=>Bt.set(Rt,_t.setParams[Rt]),Le)),new et(kt,gn,le,{params:Le,headers:de,context:st,reportProgress:j,responseType:Ve,withCredentials:R})}}var Je=(()=>((Je=Je||{})[Je.Sent=0]="Sent",Je[Je.UploadProgress=1]="UploadProgress",Je[Je.ResponseHeader=2]="ResponseHeader",Je[Je.DownloadProgress=3]="DownloadProgress",Je[Je.Response=4]="Response",Je[Je.User=5]="User",Je))();class _e{constructor(_t,kt=200,gn="OK"){this.headers=_t.headers||new Ge,this.status=void 0!==_t.status?_t.status:kt,this.statusText=_t.statusText||gn,this.url=_t.url||null,this.ok=this.status>=200&&this.status<300}}class pe extends _e{constructor(_t={}){super(_t),this.type=Je.ResponseHeader}clone(_t={}){return new pe({headers:_t.headers||this.headers,status:void 0!==_t.status?_t.status:this.status,statusText:_t.statusText||this.statusText,url:_t.url||this.url||void 0})}}class ae extends _e{constructor(_t={}){super(_t),this.type=Je.Response,this.body=void 0!==_t.body?_t.body:null}clone(_t={}){return new ae({body:void 0!==_t.body?_t.body:this.body,headers:_t.headers||this.headers,status:void 0!==_t.status?_t.status:this.status,statusText:_t.statusText||this.statusText,url:_t.url||this.url||void 0})}}class Ee extends _e{constructor(_t){super(_t,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${_t.url||"(unknown url)"}`:`Http failure response for ${_t.url||"(unknown url)"}: ${_t.status} ${_t.statusText}`,this.error=_t.error||null}}function vt(pn,_t){return{body:_t,headers:pn.headers,context:pn.context,observe:pn.observe,params:pn.params,reportProgress:pn.reportProgress,responseType:pn.responseType,withCredentials:pn.withCredentials}}let Et=(()=>{class pn{constructor(kt){this.handler=kt}request(kt,gn,Ve={}){let le;if(kt instanceof et)le=kt;else{let de,Le;de=Ve.headers instanceof Ge?Ve.headers:new Ge(Ve.headers),Ve.params&&(Le=Ve.params instanceof te?Ve.params:new te({fromObject:Ve.params})),le=new et(kt,gn,void 0!==Ve.body?Ve.body:null,{headers:de,context:Ve.context,params:Le,reportProgress:Ve.reportProgress,responseType:Ve.responseType||"json",withCredentials:Ve.withCredentials})}const R=(0,ie.of)(le).pipe((0,Y.b)(de=>this.handler.handle(de)));if(kt instanceof et||"events"===Ve.observe)return R;const j=R.pipe((0,se.h)(de=>de instanceof ae));switch(Ve.observe||"body"){case"body":switch(le.responseType){case"arraybuffer":return j.pipe((0,y.U)(de=>{if(null!==de.body&&!(de.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return de.body}));case"blob":return j.pipe((0,y.U)(de=>{if(null!==de.body&&!(de.body instanceof Blob))throw new Error("Response is not a Blob.");return de.body}));case"text":return j.pipe((0,y.U)(de=>{if(null!==de.body&&"string"!=typeof de.body)throw new Error("Response is not a string.");return de.body}));default:return j.pipe((0,y.U)(de=>de.body))}case"response":return j;default:throw new Error(`Unreachable: unhandled observe type ${Ve.observe}}`)}}delete(kt,gn={}){return this.request("DELETE",kt,gn)}get(kt,gn={}){return this.request("GET",kt,gn)}head(kt,gn={}){return this.request("HEAD",kt,gn)}jsonp(kt,gn){return this.request("JSONP",kt,{params:(new te).append(gn,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(kt,gn={}){return this.request("OPTIONS",kt,gn)}patch(kt,gn,Ve={}){return this.request("PATCH",kt,vt(Ve,gn))}post(kt,gn,Ve={}){return this.request("POST",kt,vt(Ve,gn))}put(kt,gn,Ve={}){return this.request("PUT",kt,vt(Ve,gn))}}return pn.\u0275fac=function(kt){return new(kt||pn)(g.LFG(fe))},pn.\u0275prov=g.Yz7({token:pn,factory:pn.\u0275fac}),pn})();function qt(pn,_t){return _t(pn)}function Ft(pn,_t){return(kt,gn)=>_t.intercept(kt,{handle:Ve=>pn(Ve,gn)})}const Pt=new g.OlP("HTTP_INTERCEPTORS"),bt=new g.OlP("HTTP_INTERCEPTOR_FNS");function ct(){let pn=null;return(_t,kt)=>(null===pn&&(pn=((0,g.f3M)(Pt,{optional:!0})??[]).reduceRight(Ft,qt)),pn(_t,kt))}let ht=(()=>{class pn extends fe{constructor(kt,gn){super(),this.backend=kt,this.injector=gn,this.chain=null}handle(kt){if(null===this.chain){const gn=Array.from(new Set(this.injector.get(bt)));this.chain=gn.reduceRight((Ve,le)=>function xt(pn,_t,kt){return(gn,Ve)=>kt.runInContext(()=>_t(gn,le=>pn(le,Ve)))}(Ve,le,this.injector),qt)}return this.chain(kt,gn=>this.backend.handle(gn))}}return pn.\u0275fac=function(kt){return new(kt||pn)(g.LFG(Ie),g.LFG(g.lqb))},pn.\u0275prov=g.Yz7({token:pn,factory:pn.\u0275fac}),pn})();const ci=/^\)\]\}',?\n/;let _i=(()=>{class pn{constructor(kt){this.xhrFactory=kt}handle(kt){if("JSONP"===kt.method)throw new Error("Attempted to construct Jsonp request without HttpClientJsonpModule installed.");return new c.y(gn=>{const Ve=this.xhrFactory.build();if(Ve.open(kt.method,kt.urlWithParams),kt.withCredentials&&(Ve.withCredentials=!0),kt.headers.forEach((at,Pe)=>Ve.setRequestHeader(at,Pe.join(","))),kt.headers.has("Accept")||Ve.setRequestHeader("Accept","application/json, text/plain, */*"),!kt.headers.has("Content-Type")){const at=kt.detectContentTypeHeader();null!==at&&Ve.setRequestHeader("Content-Type",at)}if(kt.responseType){const at=kt.responseType.toLowerCase();Ve.responseType="json"!==at?at:"text"}const le=kt.serializeBody();let R=null;const j=()=>{if(null!==R)return R;const at=Ve.statusText||"OK",Pe=new Ge(Ve.getAllResponseHeaders()),Ue=function Un(pn){return"responseURL"in pn&&pn.responseURL?pn.responseURL:/^X-Request-URL:/m.test(pn.getAllResponseHeaders())?pn.getResponseHeader("X-Request-URL"):null}(Ve)||kt.url;return R=new pe({headers:Pe,status:Ve.status,statusText:at,url:Ue}),R},de=()=>{let{headers:at,status:Pe,statusText:Ue,url:Re}=j(),nt=null;204!==Pe&&(nt=typeof Ve.response>"u"?Ve.responseText:Ve.response),0===Pe&&(Pe=nt?200:0);let zt=Pe>=200&&Pe<300;if("json"===kt.responseType&&"string"==typeof nt){const _n=nt;nt=nt.replace(ci,"");try{nt=""!==nt?JSON.parse(nt):null}catch(Mn){nt=_n,zt&&(zt=!1,nt={error:Mn,text:nt})}}zt?(gn.next(new ae({body:nt,headers:at,status:Pe,statusText:Ue,url:Re||void 0})),gn.complete()):gn.error(new Ee({error:nt,headers:at,status:Pe,statusText:Ue,url:Re||void 0}))},Le=at=>{const{url:Pe}=j(),Ue=new Ee({error:at,status:Ve.status||0,statusText:Ve.statusText||"Unknown Error",url:Pe||void 0});gn.error(Ue)};let st=!1;const Bt=at=>{st||(gn.next(j()),st=!0);let Pe={type:Je.DownloadProgress,loaded:at.loaded};at.lengthComputable&&(Pe.total=at.total),"text"===kt.responseType&&!!Ve.responseText&&(Pe.partialText=Ve.responseText),gn.next(Pe)},Rt=at=>{let Pe={type:Je.UploadProgress,loaded:at.loaded};at.lengthComputable&&(Pe.total=at.total),gn.next(Pe)};return Ve.addEventListener("load",de),Ve.addEventListener("error",Le),Ve.addEventListener("timeout",Le),Ve.addEventListener("abort",Le),kt.reportProgress&&(Ve.addEventListener("progress",Bt),null!==le&&Ve.upload&&Ve.upload.addEventListener("progress",Rt)),Ve.send(le),gn.next({type:Je.Sent}),()=>{Ve.removeEventListener("error",Le),Ve.removeEventListener("abort",Le),Ve.removeEventListener("load",de),Ve.removeEventListener("timeout",Le),kt.reportProgress&&(Ve.removeEventListener("progress",Bt),null!==le&&Ve.upload&&Ve.upload.removeEventListener("progress",Rt)),Ve.readyState!==Ve.DONE&&Ve.abort()}})}}return pn.\u0275fac=function(kt){return new(kt||pn)(g.LFG(h.JF))},pn.\u0275prov=g.Yz7({token:pn,factory:pn.\u0275fac}),pn})();const wi=new g.OlP("XSRF_ENABLED"),xi="XSRF-TOKEN",Ni=new g.OlP("XSRF_COOKIE_NAME",{providedIn:"root",factory:()=>xi}),Ii="X-XSRF-TOKEN",Ui=new g.OlP("XSRF_HEADER_NAME",{providedIn:"root",factory:()=>Ii});class Yi{}let Ht=(()=>{class pn{constructor(kt,gn,Ve){this.doc=kt,this.platform=gn,this.cookieName=Ve,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const kt=this.doc.cookie||"";return kt!==this.lastCookieString&&(this.parseCount++,this.lastToken=(0,h.Mx)(kt,this.cookieName),this.lastCookieString=kt),this.lastToken}}return pn.\u0275fac=function(kt){return new(kt||pn)(g.LFG(h.K0),g.LFG(g.Lbi),g.LFG(Ni))},pn.\u0275prov=g.Yz7({token:pn,factory:pn.\u0275fac}),pn})();function Mt(pn,_t){const kt=pn.url.toLowerCase();if(!(0,g.f3M)(wi)||"GET"===pn.method||"HEAD"===pn.method||kt.startsWith("http://")||kt.startsWith("https://"))return _t(pn);const gn=(0,g.f3M)(Yi).getToken(),Ve=(0,g.f3M)(Ui);return null!=gn&&!pn.headers.has(Ve)&&(pn=pn.clone({headers:pn.headers.set(Ve,gn)})),_t(pn)}var re=(()=>((re=re||{})[re.Interceptors=0]="Interceptors",re[re.LegacyInterceptors=1]="LegacyInterceptors",re[re.CustomXsrfConfiguration=2]="CustomXsrfConfiguration",re[re.NoXsrfProtection=3]="NoXsrfProtection",re[re.JsonpSupport=4]="JsonpSupport",re[re.RequestsMadeViaParent=5]="RequestsMadeViaParent",re))();function tt(pn,_t){return{\u0275kind:pn,\u0275providers:_t}}function Wt(...pn){const _t=[Et,_i,ht,{provide:fe,useExisting:ht},{provide:Ie,useExisting:_i},{provide:bt,useValue:Mt,multi:!0},{provide:wi,useValue:!0},{provide:Yi,useClass:Ht}];for(const kt of pn)_t.push(...kt.\u0275providers);return(0,g.MR2)(_t)}const fi=new g.OlP("LEGACY_INTERCEPTOR_FN");function er({cookieName:pn,headerName:_t}){const kt=[];return void 0!==pn&&kt.push({provide:Ni,useValue:pn}),void 0!==_t&&kt.push({provide:Ui,useValue:_t}),tt(re.CustomXsrfConfiguration,kt)}let wr=(()=>{class pn{}return pn.\u0275fac=function(kt){return new(kt||pn)},pn.\u0275mod=g.oAB({type:pn}),pn.\u0275inj=g.cJS({providers:[Wt(tt(re.LegacyInterceptors,[{provide:fi,useFactory:ct},{provide:bt,useExisting:fi,multi:!0}]),er({cookieName:xi,headerName:Ii}))]}),pn})()},8274:(Rn,Dt,B)=>{"use strict";B.d(Dt,{tb:()=>m0,AFp:()=>h0,ip1:()=>d0,CZH:()=>Zg,hGG:()=>Db,z2F:()=>Hg,sBO:()=>ub,Sil:()=>G1,_Vd:()=>hc,EJc:()=>$1,Xts:()=>jp,SBq:()=>Td,lqb:()=>au,qLn:()=>Ed,vpe:()=>Kc,XFs:()=>Ht,OlP:()=>Ur,zs3:()=>cu,ZZ4:()=>Fy,aQg:()=>ky,soG:()=>Gg,YKP:()=>gv,h0i:()=>up,PXZ:()=>rb,R0b:()=>Gl,FiY:()=>$e,Lbi:()=>U1,g9A:()=>f0,Qsj:()=>f_,FYo:()=>Uu,JOm:()=>Os,tp0:()=>Xe,Rgc:()=>tm,dDg:()=>eb,eoX:()=>w0,GfV:()=>Fh,s_b:()=>Vg,ifc:()=>Re,MMx:()=>uy,Lck:()=>Bx,eFA:()=>E0,G48:()=>cb,Gpc:()=>Ke,f3M:()=>le,MR2:()=>Em,_c5:()=>Eb,c2e:()=>V1,zSh:()=>Ph,wAp:()=>Mi,vHH:()=>ye,lri:()=>x0,rWj:()=>b0,D6c:()=>Ib,cg1:()=>nl,kL8:()=>Xc,dqk:()=>Qt,Z0I:()=>ci,sIi:()=>Hd,CqO:()=>Sg,QGY:()=>Pf,QP$:()=>Ln,F4k:()=>Of,RDi:()=>r_,AaK:()=>me,qOj:()=>el,TTD:()=>Ns,_Bn:()=>mv,jDz:()=>yv,xp6:()=>rf,uIk:()=>Xu,ekj:()=>w,Suo:()=>Vv,Xpm:()=>Bi,lG2:()=>zo,Yz7:()=>ut,cJS:()=>En,oAB:()=>ar,Yjl:()=>Br,Y36:()=>yl,_UZ:()=>Af,GkF:()=>vu,BQk:()=>op,ynx:()=>nd,qZA:()=>rp,TgZ:()=>ip,EpF:()=>Mg,n5z:()=>rc,LFG:()=>gn,$8M:()=>Jn,$Z:()=>hf,NdJ:()=>sp,CRH:()=>jv,oxw:()=>Kd,ALo:()=>Pv,lcZ:()=>Ov,xi3:()=>Rv,Hsn:()=>Lf,F$t:()=>Rf,Q6J:()=>Xd,s9C:()=>Qd,DdM:()=>Ev,iGM:()=>Nv,MAs:()=>Ig,KtG:()=>Ml,CHM:()=>Il,LSH:()=>Ih,P3R:()=>Mh,Udp:()=>_,YNc:()=>ep,_uU:()=>Sn,Oqu:()=>On,hij:()=>ln,AsE:()=>$n,lnq:()=>vi,HOy:()=>Xn,Gf:()=>Uv});var h=B(7579),g=B(727),ie=B(9751),c=B(8189),Y=B(8421),se=B(515),y=B(7669),fe=B(2076),Ge=B(3099);function Q(r){for(let o in r)if(r[o]===Q)return o;throw Error("Could not find renamed property on target object.")}function be(r,o){for(const u in o)o.hasOwnProperty(u)&&!r.hasOwnProperty(u)&&(r[u]=o[u])}function me(r){if("string"==typeof r)return r;if(Array.isArray(r))return"["+r.map(me).join(", ")+"]";if(null==r)return""+r;if(r.overriddenName)return`${r.overriddenName}`;if(r.name)return`${r.name}`;const o=r.toString();if(null==o)return""+o;const u=o.indexOf("\n");return-1===u?o:o.substring(0,u)}function Ze(r,o){return null==r||""===r?null===o?"":o:null==o||""===o?r:r+" "+o}const he=Q({__forward_ref__:Q});function Ke(r){return r.__forward_ref__=Ke,r.toString=function(){return me(this())},r}function Ae(r){return te(r)?r():r}function te(r){return"function"==typeof r&&r.hasOwnProperty(he)&&r.__forward_ref__===Ke}function Qe(r){return r&&!!r.\u0275providers}const dt="https://g.co/ng/security#xss";class ye extends Error{constructor(o,u){super(function Fe(r,o){return`NG0${Math.abs(r)}${o?": "+o.trim():""}`}(o,u)),this.code=o}}function Ne(r){return"string"==typeof r?r:null==r?"":String(r)}function pe(r,o){throw new ye(-201,!1)}function Ut(r,o){null==r&&function Gt(r,o,u,f){throw new Error(`ASSERTION ERROR: ${r}`+(null==f?"":` [Expected=> ${u} ${f} ${o} <=Actual]`))}(o,r,null,"!=")}function ut(r){return{token:r.token,providedIn:r.providedIn||null,factory:r.factory,value:void 0}}function En(r){return{providers:r.providers||[],imports:r.imports||[]}}function ni(r){return Un(r,Ni)||Un(r,Ui)}function ci(r){return null!==ni(r)}function Un(r,o){return r.hasOwnProperty(o)?r[o]:null}function xi(r){return r&&(r.hasOwnProperty(Ii)||r.hasOwnProperty(Yi))?r[Ii]:null}const Ni=Q({\u0275prov:Q}),Ii=Q({\u0275inj:Q}),Ui=Q({ngInjectableDef:Q}),Yi=Q({ngInjectorDef:Q});var Ht=(()=>((Ht=Ht||{})[Ht.Default=0]="Default",Ht[Ht.Host=1]="Host",Ht[Ht.Self=2]="Self",Ht[Ht.SkipSelf=4]="SkipSelf",Ht[Ht.Optional=8]="Optional",Ht))();let Mt;function re(r){const o=Mt;return Mt=r,o}function tt(r,o,u){const f=ni(r);return f&&"root"==f.providedIn?void 0===f.value?f.value=f.factory():f.value:u&Ht.Optional?null:void 0!==o?o:void pe(me(r))}const Qt=(()=>typeof globalThis<"u"&&globalThis||typeof global<"u"&&global||typeof window<"u"&&window||typeof self<"u"&&typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&self)(),mi={},xr="__NG_DI_FLAG__",Pi="ngTempTokenPath",wr=/\n/gm,ui="__source";let pn;function _t(r){const o=pn;return pn=r,o}function kt(r,o=Ht.Default){if(void 0===pn)throw new ye(-203,!1);return null===pn?tt(r,void 0,o):pn.get(r,o&Ht.Optional?null:void 0,o)}function gn(r,o=Ht.Default){return(function qe(){return Mt}()||kt)(Ae(r),o)}function le(r,o=Ht.Default){return gn(r,R(o))}function R(r){return typeof r>"u"||"number"==typeof r?r:0|(r.optional&&8)|(r.host&&1)|(r.self&&2)|(r.skipSelf&&4)}function j(r){const o=[];for(let u=0;u<r.length;u++){const f=Ae(r[u]);if(Array.isArray(f)){if(0===f.length)throw new ye(900,!1);let x,C=Ht.Default;for(let A=0;A<f.length;A++){const N=f[A],G=Le(N);"number"==typeof G?-1===G?x=N.token:C|=G:x=N}o.push(gn(x,C))}else o.push(gn(f))}return o}function de(r,o){return r[xr]=o,r.prototype[xr]=o,r}function Le(r){return r[xr]}function Rt(r){return{toString:r}.toString()}var at=(()=>((at=at||{})[at.OnPush=0]="OnPush",at[at.Default=1]="Default",at))(),Re=(()=>{return(r=Re||(Re={}))[r.Emulated=0]="Emulated",r[r.None=2]="None",r[r.ShadowDom=3]="ShadowDom",Re;var r})();const nt={},zt=[],_n=Q({\u0275cmp:Q}),Mn=Q({\u0275dir:Q}),Yn=Q({\u0275pipe:Q}),di=Q({\u0275mod:Q}),gi=Q({\u0275fac:Q}),Kn=Q({__NG_ELEMENT_ID__:Q});let Vi=0;function Bi(r){return Rt(()=>{const u=!0===r.standalone,f={},x={type:r.type,providersResolver:null,decls:r.decls,vars:r.vars,factory:null,template:r.template||null,consts:r.consts||null,ngContentSelectors:r.ngContentSelectors,hostBindings:r.hostBindings||null,hostVars:r.hostVars||0,hostAttrs:r.hostAttrs||null,contentQueries:r.contentQueries||null,declaredInputs:f,inputs:null,outputs:null,exportAs:r.exportAs||null,onPush:r.changeDetection===at.OnPush,directiveDefs:null,pipeDefs:null,standalone:u,dependencies:u&&r.dependencies||null,getStandaloneInjector:null,selectors:r.selectors||zt,viewQuery:r.viewQuery||null,features:r.features||null,data:r.data||{},encapsulation:r.encapsulation||Re.Emulated,id:"c"+Vi++,styles:r.styles||zt,_:null,setInput:null,schemas:r.schemas||null,tView:null,findHostDirectiveDefs:null,hostDirectives:null},C=r.dependencies,A=r.features;return x.inputs=xo(r.inputs,f),x.outputs=xo(r.outputs),A&&A.forEach(N=>N(x)),x.directiveDefs=C?()=>("function"==typeof C?C():C).map(Cr).filter(on):null,x.pipeDefs=C?()=>("function"==typeof C?C():C).map(cr).filter(on):null,x})}function Cr(r){return Oi(r)||lr(r)}function on(r){return null!==r}function ar(r){return Rt(()=>({type:r.type,bootstrap:r.bootstrap||zt,declarations:r.declarations||zt,imports:r.imports||zt,exports:r.exports||zt,transitiveCompileScopes:null,schemas:r.schemas||null,id:r.id||null}))}function xo(r,o){if(null==r)return nt;const u={};for(const f in r)if(r.hasOwnProperty(f)){let x=r[f],C=x;Array.isArray(x)&&(C=x[1],x=x[0]),u[x]=f,o&&(o[x]=C)}return u}const zo=Bi;function Br(r){return{type:r.type,name:r.name,factory:null,pure:!1!==r.pure,standalone:!0===r.standalone,onDestroy:r.type.prototype.ngOnDestroy||null}}function Oi(r){return r[_n]||null}function lr(r){return r[Mn]||null}function cr(r){return r[Yn]||null}function Ln(r){const o=Oi(r)||lr(r)||cr(r);return null!==o&&o.standalone}function hi(r,o){const u=r[di]||null;if(!u&&!0===o)throw new Error(`Type ${me(r)} does not have '\u0275mod' property.`);return u}function rr(r){return Array.isArray(r)&&"object"==typeof r[1]}function So(r){return Array.isArray(r)&&!0===r[1]}function xs(r){return 0!=(4&r.flags)}function so(r){return r.componentOffset>-1}function ao(r){return 1==(1&r.flags)}function Wr(r){return null!==r.template}function Ho(r){return 0!=(256&r[2])}function ts(r,o){return r.hasOwnProperty(gi)?r[gi]:null}class ws{constructor(o,u,f){this.previousValue=o,this.currentValue=u,this.firstChange=f}isFirstChange(){return this.firstChange}}function Ns(){return qr}function qr(r){return r.type.prototype.ngOnChanges&&(r.setInput=Us),Hi}function Hi(){const r=Vs(this),o=r?.current;if(o){const u=r.previous;if(u===nt)r.previous=o;else for(let f in o)u[f]=o[f];r.current=null,this.ngOnChanges(o)}}function Us(r,o,u,f){const x=this.declaredInputs[u],C=Vs(r)||function ns(r,o){return r[Cs]=o}(r,{previous:nt,current:null}),A=C.current||(C.current={}),N=C.previous,G=N[x];A[x]=new ws(G&&G.currentValue,o,N===nt),r[f]=o}Ns.ngInherit=!0;const Cs="__ngSimpleChanges__";function Vs(r){return r[Cs]||null}function Tr(r){for(;Array.isArray(r);)r=r[0];return r}function ji(r,o){return Tr(o[r])}function zr(r,o){return Tr(o[r.index])}function Co(r,o){return r.data[o]}function ms(r,o){return r[o]}function Yr(r,o){const u=o[r];return rr(u)?u:u[0]}function Ca(r){return 64==(64&r[2])}function ee(r,o){return null==o?null:r[o]}function X(r){r[18]=0}function q(r,o){r[5]+=o;let u=r,f=r[3];for(;null!==f&&(1===o&&1===u[5]||-1===o&&0===u[5]);)f[5]+=o,u=f,f=f[3]}const Te={lFrame:Ba(null),bindingsEnabled:!0};function la(){return Te.bindingsEnabled}function Dn(){return Te.lFrame.lView}function Ji(){return Te.lFrame.tView}function Il(r){return Te.lFrame.contextLView=r,r[8]}function Ml(r){return Te.lFrame.contextLView=null,r}function ro(){let r=ca();for(;null!==r&&64===r.type;)r=r.parent;return r}function ca(){return Te.lFrame.currentTNode}function co(r,o){const u=Te.lFrame;u.currentTNode=r,u.isParent=o}function Xs(){return Te.lFrame.isParent}function ua(){Te.lFrame.isParent=!1}function E(){const r=Te.lFrame;let o=r.bindingRootIndex;return-1===o&&(o=r.bindingRootIndex=r.tView.bindingStartIndex),o}function Z(){return Te.lFrame.bindingIndex}function $(){return Te.lFrame.bindingIndex++}function ve(r){const o=Te.lFrame,u=o.bindingIndex;return o.bindingIndex=o.bindingIndex+r,u}function Zn(r,o){const u=Te.lFrame;u.bindingIndex=u.bindingRootIndex=r,ii(o)}function ii(r){Te.lFrame.currentDirectiveIndex=r}function ur(){return Te.lFrame.currentQueryIndex}function or(r){Te.lFrame.currentQueryIndex=r}function uo(r){const o=r[1];return 2===o.type?o.declTNode:1===o.type?r[6]:null}function eo(r,o,u){if(u&Ht.SkipSelf){let x=o,C=r;for(;!(x=x.parent,null!==x||u&Ht.Host||(x=uo(C),null===x||(C=C[15],10&x.type))););if(null===x)return!1;o=x,r=C}const f=Te.lFrame=Is();return f.currentTNode=o,f.lView=r,!0}function Ds(r){const o=Is(),u=r[1];Te.lFrame=o,o.currentTNode=u.firstChild,o.lView=r,o.tView=u,o.contextLView=r,o.bindingIndex=u.bindingStartIndex,o.inI18n=!1}function Is(){const r=Te.lFrame,o=null===r?null:r.child;return null===o?Ba(r):o}function Ba(r){const o={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:r,child:null,inI18n:!1};return null!==r&&(r.child=o),o}function za(){const r=Te.lFrame;return Te.lFrame=r.parent,r.currentTNode=null,r.lView=null,r}const da=za;function Ms(){const r=za();r.isParent=!0,r.tView=null,r.selectedIndex=-1,r.contextLView=null,r.elementDepthCount=0,r.currentDirectiveIndex=-1,r.currentNamespace=null,r.bindingRootIndex=-1,r.bindingIndex=-1,r.currentQueryIndex=0}function _o(){return Te.lFrame.selectedIndex}function Ea(r){Te.lFrame.selectedIndex=r}function vr(){const r=Te.lFrame;return Co(r.tView,r.selectedIndex)}function Tn(r,o){for(let u=o.directiveStart,f=o.directiveEnd;u<f;u++){const C=r.data[u].type.prototype,{ngAfterContentInit:A,ngAfterContentChecked:N,ngAfterViewInit:G,ngAfterViewChecked:oe,ngOnDestroy:Se}=C;A&&(r.contentHooks||(r.contentHooks=[])).push(-u,A),N&&((r.contentHooks||(r.contentHooks=[])).push(u,N),(r.contentCheckHooks||(r.contentCheckHooks=[])).push(u,N)),G&&(r.viewHooks||(r.viewHooks=[])).push(-u,G),oe&&((r.viewHooks||(r.viewHooks=[])).push(u,oe),(r.viewCheckHooks||(r.viewCheckHooks=[])).push(u,oe)),null!=Se&&(r.destroyHooks||(r.destroyHooks=[])).push(u,Se)}}function li(r,o,u){dr(r,o,3,u)}function sr(r,o,u,f){(3&r[2])===u&&dr(r,o,u,f)}function nr(r,o){let u=r[2];(3&u)===o&&(u&=2047,u+=1,r[2]=u)}function dr(r,o,u,f){const C=f??-1,A=o.length-1;let N=0;for(let G=void 0!==f?65535&r[18]:0;G<A;G++)if("number"==typeof o[G+1]){if(N=o[G],null!=f&&N>=f)break}else o[G]<0&&(r[18]+=65536),(N<C||-1==C)&&(Wi(r,u,o,G),r[18]=(4294901760&r[18])+G+2),G++}function Wi(r,o,u,f){const x=u[f]<0,C=u[f+1],N=r[x?-u[f]:u[f]];if(x){if(r[2]>>11<r[18]>>16&&(3&r[2])===o){r[2]+=2048;try{C.call(N)}finally{}}}else try{C.call(N)}finally{}}class gr{constructor(o,u,f){this.factory=o,this.resolving=!1,this.canSeeViewProviders=u,this.injectImpl=f}}function $s(r,o,u){let f=0;for(;f<u.length;){const x=u[f];if("number"==typeof x){if(0!==x)break;f++;const C=u[f++],A=u[f++],N=u[f++];r.setAttribute(o,A,N,C)}else{const C=x,A=u[++f];Jl(C)?r.setProperty(o,C,A):r.setAttribute(o,C,A),f++}}return f}function Yl(r){return 3===r||4===r||6===r}function Jl(r){return 64===r.charCodeAt(0)}function Ua(r,o){if(null!==o&&0!==o.length)if(null===r||0===r.length)r=o.slice();else{let u=-1;for(let f=0;f<o.length;f++){const x=o[f];"number"==typeof x?u=x:0===u||pa(r,u,x,null,-1===u||2===u?o[++f]:null)}}return r}function pa(r,o,u,f,x){let C=0,A=r.length;if(-1===o)A=-1;else for(;C<r.length;){const N=r[C++];if("number"==typeof N){if(N===o){A=-1;break}if(N>o){A=C-1;break}}}for(;C<r.length;){const N=r[C];if("number"==typeof N)break;if(N===u){if(null===f)return void(null!==x&&(r[C+1]=x));if(f===r[C+1])return void(r[C+2]=x)}C++,null!==f&&C++,null!==x&&C++}-1!==A&&(r.splice(A,0,o),C=A+1),r.splice(C++,0,u),null!==f&&r.splice(C++,0,f),null!==x&&r.splice(C++,0,x)}function Xl(r){return-1!==r}function Va(r){return 32767&r}function $o(r,o){let u=function fa(r){return r>>16}(r),f=o;for(;u>0;)f=f[15],u--;return f}let ja=!0;function Sl(r){const o=ja;return ja=r,o}let Mc=0;const Ss={};function $a(r,o){const u=Ql(r,o);if(-1!==u)return u;const f=o[1];f.firstCreatePass&&(r.injectorIndex=o.length,Sc(f.data,r),Sc(o,null),Sc(f.blueprint,null));const x=ec(r,o),C=r.injectorIndex;if(Xl(x)){const A=Va(x),N=$o(x,o),G=N[1].data;for(let oe=0;oe<8;oe++)o[C+oe]=N[A+oe]|G[A+oe]}return o[C+8]=x,C}function Sc(r,o){r.push(0,0,0,0,0,0,0,0,o)}function Ql(r,o){return-1===r.injectorIndex||r.parent&&r.parent.injectorIndex===r.injectorIndex||null===o[r.injectorIndex+8]?-1:r.injectorIndex}function ec(r,o){if(r.parent&&-1!==r.parent.injectorIndex)return r.parent.injectorIndex;let u=0,f=null,x=o;for(;null!==x;){if(f=Ol(x),null===f)return-1;if(u++,x=x[15],-1!==f.injectorIndex)return f.injectorIndex|u<<16}return-1}function tc(r,o,u){!function Kl(r,o,u){let f;"string"==typeof u?f=u.charCodeAt(0)||0:u.hasOwnProperty(Kn)&&(f=u[Kn]),null==f&&(f=u[Kn]=Mc++);const x=255&f;o.data[r+(x>>5)]|=1<<x}(r,o,u)}function Qc(r,o,u){if(u&Ht.Optional||void 0!==r)return r;pe()}function nc(r,o,u,f){if(u&Ht.Optional&&void 0===f&&(f=null),0==(u&(Ht.Self|Ht.Host))){const x=r[9],C=re(void 0);try{return x?x.get(o,f,u&Ht.Optional):tt(o,f,u&Ht.Optional)}finally{re(C)}}return Qc(f,0,u)}function To(r,o,u,f=Ht.Default,x){if(null!==r){if(1024&o[2]){const A=function Da(r,o,u,f,x){let C=r,A=o;for(;null!==C&&null!==A&&1024&A[2]&&!(256&A[2]);){const N=Ac(C,A,u,f|Ht.Self,Ss);if(N!==Ss)return N;let G=C.parent;if(!G){const oe=A[21];if(oe){const Se=oe.get(u,Ss,f);if(Se!==Ss)return Se}G=Ol(A),A=A[15]}C=G}return x}(r,o,u,f,Ss);if(A!==Ss)return A}const C=Ac(r,o,u,f,Ss);if(C!==Ss)return C}return nc(o,u,f,x)}function Ac(r,o,u,f,x){const C=function Pc(r){if("string"==typeof r)return r.charCodeAt(0)||0;const o=r.hasOwnProperty(Kn)?r[Kn]:void 0;return"number"==typeof o?o>=0?255&o:Ks:o}(u);if("function"==typeof C){if(!eo(o,r,f))return f&Ht.Host?Qc(x,0,f):nc(o,u,f,x);try{const A=C(f);if(null!=A||f&Ht.Optional)return A;pe()}finally{da()}}else if("number"==typeof C){let A=null,N=Ql(r,o),G=-1,oe=f&Ht.Host?o[16][6]:null;for((-1===N||f&Ht.SkipSelf)&&(G=-1===N?ec(r,o):o[N+8],-1!==G&&ud(f,!1)?(A=o[1],N=Va(G),o=$o(G,o)):N=-1);-1!==N;){const Se=o[1];if(Cu(C,N,Se.data)){const lt=ic(N,o,u,A,f,oe);if(lt!==Ss)return lt}G=o[N+8],-1!==G&&ud(f,o[1].data[N+8]===oe)&&Cu(C,N,o)?(A=Se,N=Va(G),o=$o(G,o)):N=-1}}return x}function ic(r,o,u,f,x,C){const A=o[1],N=A.data[r+8],Se=Al(N,A,u,null==f?so(N)&&ja:f!=A&&0!=(3&N.type),x&Ht.Host&&C===N);return null!==Se?po(o,A,Se,N):Ss}function Al(r,o,u,f,x){const C=r.providerIndexes,A=o.data,N=1048575&C,G=r.directiveStart,Se=C>>20,Vt=x?N+Se:r.directiveEnd;for(let an=f?N:N+Se;an<Vt;an++){const In=A[an];if(an<G&&u===In||an>=G&&In.type===u)return an}if(x){const an=A[G];if(an&&Wr(an)&&an.type===u)return G}return null}function po(r,o,u,f){let x=r[u];const C=o.data;if(function to(r){return r instanceof gr}(x)){const A=x;A.resolving&&function et(r,o){const u=o?`. Dependency path: ${o.join(" > ")} > ${r}`:"";throw new ye(-200,`Circular dependency in DI detected for ${r}${u}`)}(function we(r){return"function"==typeof r?r.name||r.toString():"object"==typeof r&&null!=r&&"function"==typeof r.type?r.type.name||r.type.toString():Ne(r)}(C[u]));const N=Sl(A.canSeeViewProviders);A.resolving=!0;const G=A.injectImpl?re(A.injectImpl):null;eo(r,f,Ht.Default);try{x=r[u]=A.factory(void 0,C,r,f),o.firstCreatePass&&u>=f.directiveStart&&function fn(r,o,u){const{ngOnChanges:f,ngOnInit:x,ngDoCheck:C}=o.type.prototype;if(f){const A=qr(o);(u.preOrderHooks||(u.preOrderHooks=[])).push(r,A),(u.preOrderCheckHooks||(u.preOrderCheckHooks=[])).push(r,A)}x&&(u.preOrderHooks||(u.preOrderHooks=[])).push(0-r,x),C&&((u.preOrderHooks||(u.preOrderHooks=[])).push(r,C),(u.preOrderCheckHooks||(u.preOrderCheckHooks=[])).push(r,C))}(u,C[u],o)}finally{null!==G&&re(G),Sl(N),A.resolving=!1,da()}}return x}function Cu(r,o,u){return!!(u[o+(r>>5)]&1<<r)}function ud(r,o){return!(r&Ht.Self||r&Ht.Host&&o)}class Pl{constructor(o,u){this._tNode=o,this._lView=u}get(o,u,f){return To(this._tNode,this._lView,o,R(f),u)}}function Ks(){return new Pl(ro(),Dn())}function rc(r){return Rt(()=>{const o=r.prototype.constructor,u=o[gi]||As(o),f=Object.prototype;let x=Object.getPrototypeOf(r.prototype).constructor;for(;x&&x!==f;){const C=x[gi]||As(x);if(C&&C!==u)return C;x=Object.getPrototypeOf(x)}return C=>new C})}function As(r){return te(r)?()=>{const o=As(Ae(r));return o&&o()}:ts(r)}function Ol(r){const o=r[1],u=o.type;return 2===u?o.declTNode:1===u?r[6]:null}function Jn(r){return function sl(r,o){if("class"===o)return r.classes;if("style"===o)return r.styles;const u=r.attrs;if(u){const f=u.length;let x=0;for(;x<f;){const C=u[x];if(Yl(C))break;if(0===C)x+=2;else if("number"==typeof C)for(x++;x<f&&"string"==typeof u[x];)x++;else{if(C===o)return u[x+1];x+=2}}}return null}(ro(),r)}const al="__parameters__";function Ga(r,o,u){return Rt(()=>{const f=function oc(r){return function(...u){if(r){const f=r(...u);for(const x in f)this[x]=f[x]}}}(o);function x(...C){if(this instanceof x)return f.apply(this,C),this;const A=new x(...C);return N.annotation=A,N;function N(G,oe,Se){const lt=G.hasOwnProperty(al)?G[al]:Object.defineProperty(G,al,{value:[]})[al];for(;lt.length<=Se;)lt.push(null);return(lt[Se]=lt[Se]||[]).push(A),G}}return u&&(x.prototype=Object.create(u.prototype)),x.prototype.ngMetadataName=r,x.annotationCls=x,x})}class Ur{constructor(o,u){this._desc=o,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof u?this.__NG_ELEMENT_ID__=u:void 0!==u&&(this.\u0275prov=ut({token:this,providedIn:u.providedIn||"root",factory:u.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}function Sa(r,o){r.forEach(u=>Array.isArray(u)?Sa(u,o):o(u))}function tu(r,o,u){o>=r.length?r.push(u):r.splice(o,0,u)}function sc(r,o){return o>=r.length-1?r.pop():r.splice(o,1)[0]}function P(r,o){const u=[];for(let f=0;f<r;f++)u.push(o);return u}function s(r,o,u){let f=v(r,o);return f>=0?r[1|f]=u:(f=~f,function l(r,o,u,f){let x=r.length;if(x==o)r.push(u,f);else if(1===x)r.push(f,r[0]),r[0]=u;else{for(x--,r.push(r[x-1],r[x]);x>o;)r[x]=r[x-2],x--;r[o]=u,r[o+1]=f}}(r,f,o,u)),f}function p(r,o){const u=v(r,o);if(u>=0)return r[1|u]}function v(r,o){return function D(r,o,u){let f=0,x=r.length>>u;for(;x!==f;){const C=f+(x-f>>1),A=r[C<<u];if(o===A)return C<<u;A>o?x=C:f=C+1}return~(x<<u)}(r,o,1)}const $e=de(Ga("Optional"),8),Xe=de(Ga("SkipSelf"),4);var Os=(()=>((Os=Os||{})[Os.Important=1]="Important",Os[Os.DashCase=2]="DashCase",Os))();const Qs=new Map;let pd=0;const lh="__ngContext__";function Rs(r,o){rr(o)?(r[lh]=o[20],function im(r){Qs.set(r[20],r)}(o)):r[lh]=o}function uh(r,o){return undefined(r,o)}function kc(r){const o=r[3];return So(o)?o[3]:o}function Au(r){return fd(r[13])}function dl(r){return fd(r[4])}function fd(r){for(;null!==r&&!So(r);)r=r[4];return r}function nu(r,o,u,f,x){if(null!=f){let C,A=!1;So(f)?C=f:rr(f)&&(A=!0,f=f[0]);const N=Tr(f);0===r&&null!==u?null==x?hm(o,u,N):Ls(o,u,N,x||null,!0):1===r&&null!==u?Ls(o,u,N,x||null,!0):2===r?function Ya(r,o,u){const f=pl(r,o);f&&function Lo(r,o,u,f){r.removeChild(o,u,f)}(r,f,o,u)}(o,N,A):3===r&&o.destroyNode(N),null!=C&&function Mp(r,o,u,f,x){const C=u[7];C!==Tr(u)&&nu(o,r,f,C,x);for(let N=10;N<u.length;N++){const G=u[N];Bl(G[1],G,r,o,f,C)}}(o,r,C,u,x)}}function bp(r,o,u){return r.createElement(o,u)}function lc(r,o){const u=r[9],f=u.indexOf(o),x=o[3];512&o[2]&&(o[2]&=-513,q(x,-1)),u.splice(f,1)}function cc(r,o){if(r.length<=10)return;const u=10+o,f=r[u];if(f){const x=f[17];null!==x&&x!==r&&lc(x,f),o>0&&(r[u-1][4]=f[4]);const C=sc(r,10+o);!function wp(r,o){Bl(r,o,o[11],2,null,null),o[0]=null,o[6]=null}(f[1],f);const A=C[19];null!==A&&A.detachView(C[1]),f[3]=null,f[4]=null,f[2]&=-65}return f}function dm(r,o){if(!(128&o[2])){const u=o[11];u.destroyNode&&Bl(r,o,u,3,null,null),function ac(r){let o=r[13];if(!o)return Cp(r[1],r);for(;o;){let u=null;if(rr(o))u=o[13];else{const f=o[10];f&&(u=f)}if(!u){for(;o&&!o[4]&&o!==r;)rr(o)&&Cp(o[1],o),o=o[3];null===o&&(o=r),rr(o)&&Cp(o[1],o),u=o&&o[4]}o=u}}(o)}}function Cp(r,o){if(!(128&o[2])){o[2]&=-65,o[2]|=128,function e_(r,o){let u;if(null!=r&&null!=(u=r.destroyHooks))for(let f=0;f<u.length;f+=2){const x=o[u[f]];if(!(x instanceof gr)){const C=u[f+1];if(Array.isArray(C))for(let A=0;A<C.length;A+=2){const N=x[C[A]],G=C[A+1];try{G.call(N)}finally{}}else try{C.call(x)}finally{}}}}(r,o),function Qg(r,o){const u=r.cleanup,f=o[7];let x=-1;if(null!==u)for(let C=0;C<u.length-1;C+=2)if("string"==typeof u[C]){const A=u[C+3];A>=0?f[x=A]():f[x=-A].unsubscribe(),C+=2}else{const A=f[x=u[C+1]];u[C].call(A)}if(null!==f){for(let C=x+1;C<f.length;C++)(0,f[C])();o[7]=null}}(r,o),1===o[1].type&&o[11].destroy();const u=o[17];if(null!==u&&So(o[3])){u!==o[3]&&lc(u,o);const f=o[19];null!==f&&f.detachView(r)}!function rm(r){Qs.delete(r[20])}(o)}}function Tp(r,o,u){return function gd(r,o,u){let f=o;for(;null!==f&&40&f.type;)f=(o=f).parent;if(null===f)return u[0];{const{componentOffset:x}=f;if(x>-1){const{encapsulation:C}=r.data[f.directiveStart+x];if(C===Re.None||C===Re.Emulated)return null}return zr(f,u)}}(r,o.parent,u)}function Ls(r,o,u,f,x){r.insertBefore(o,u,f,x)}function hm(r,o,u){r.appendChild(o,u)}function pm(r,o,u,f,x){null!==f?Ls(r,o,u,f,x):hm(r,o,u)}function pl(r,o){return r.parentNode(o)}function _r(r,o,u){return ph(r,o,u)}let _h,vh,ph=function Ep(r,o,u){return 40&r.type?zr(r,u):null};function ta(r,o,u,f){const x=Tp(r,f,o),C=o[11],N=_r(f.parent||o[6],f,o);if(null!=x)if(Array.isArray(u))for(let G=0;G<u.length;G++)pm(C,x,u[G],N,!1);else pm(C,x,u,N,!1)}function Zs(r,o){if(null!==o){const u=o.type;if(3&u)return zr(o,r);if(4&u)return fh(-1,r[o.index]);if(8&u){const f=o.child;if(null!==f)return Zs(r,f);{const x=r[o.index];return So(x)?fh(-1,x):Tr(x)}}if(32&u)return uh(o,r)()||Tr(r[o.index]);{const f=os(r,o);return null!==f?Array.isArray(f)?f[0]:Zs(kc(r[16]),f):Zs(r,o.next)}}return null}function os(r,o){return null!==o?r[16][6].projection[o.projection]:null}function fh(r,o){const u=10+r+1;if(u<o.length){const f=o[u],x=f[1].firstChild;if(null!==x)return Zs(f,x)}return o[7]}function mh(r,o,u,f,x,C,A){for(;null!=u;){const N=f[u.index],G=u.type;if(A&&0===o&&(N&&Rs(Tr(N),f),u.flags|=2),32!=(32&u.flags))if(8&G)mh(r,o,u.child,f,x,C,!1),nu(o,r,x,N,C);else if(32&G){const oe=uh(u,f);let Se;for(;Se=oe();)nu(o,r,x,Se,C);nu(o,r,x,N,C)}else 16&G?Ip(r,o,f,u,x,C):nu(o,r,x,N,C);u=A?u.projectionNext:u.next}}function Bl(r,o,u,f,x,C){mh(u,f,r.firstChild,o,x,C,!1)}function Ip(r,o,u,f,x,C){const A=u[16],G=A[6].projection[f.projection];if(Array.isArray(G))for(let oe=0;oe<G.length;oe++)nu(o,r,x,G[oe],C);else mh(r,o,G,A[3],x,C,!0)}function Ap(r,o,u){""===u?r.removeAttribute(o,"class"):r.setAttribute(o,"class",u)}function fm(r,o,u){const{mergedAttrs:f,classes:x,styles:C}=u;null!==f&&$s(r,o,f),null!==x&&Ap(r,o,x),null!==C&&function Sp(r,o,u){r.setAttribute(o,"style",u)}(r,o,C)}function r_(r){_h=r}function zc(r){return function _d(){if(void 0===vh&&(vh=null,Qt.trustedTypes))try{vh=Qt.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:r=>r,createScript:r=>r,createScriptURL:r=>r})}catch{}return vh}()?.createScriptURL(r)||r}class Lp{constructor(o){this.changingThisBreaksApplicationSecurity=o}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${dt})`}}function Nc(r){return r instanceof Lp?r.changingThisBreaksApplicationSecurity:r}function yd(r,o){const u=function bh(r){return r instanceof Lp&&r.getTypeName()||null}(r);if(null!=u&&u!==o){if("ResourceURL"===u&&"URL"===o)return!0;throw new Error(`Required a safe ${o}, got a ${u} (see ${dt})`)}return u===o}const wh=/^(?:(?:https?|mailto|data|ftp|tel|file|sms):|[^&:/?#]*(?:[/?#]|$))/gi;var Zo=(()=>((Zo=Zo||{})[Zo.NONE=0]="NONE",Zo[Zo.HTML=1]="HTML",Zo[Zo.STYLE=2]="STYLE",Zo[Zo.SCRIPT=3]="SCRIPT",Zo[Zo.URL=4]="URL",Zo[Zo.RESOURCE_URL=5]="RESOURCE_URL",Zo))();function Ih(r){const o=Fu();return o?o.sanitize(Zo.URL,r)||"":yd(r,"URL")?Nc(r):function Ch(r){return(r=String(r)).match(wh)?r:"unsafe:"+r}(Ne(r))}function Up(r){const o=Fu();if(o)return zc(o.sanitize(Zo.RESOURCE_URL,r)||"");if(yd(r,"ResourceURL"))return zc(Nc(r));throw new ye(904,!1)}function Mh(r,o,u){return function Vp(r,o){return"src"===o&&("embed"===r||"frame"===r||"iframe"===r||"media"===r||"script"===r)||"href"===o&&("base"===r||"link"===r)?Up:Ih}(o,u)(r)}function Fu(){const r=Dn();return r&&r[12]}const jp=new Ur("ENVIRONMENT_INITIALIZER"),$p=new Ur("INJECTOR",-1),Cm=new Ur("INJECTOR_DEF_TYPES");class Tm{get(o,u=mi){if(u===mi){const f=new Error(`NullInjectorError: No provider for ${me(o)}!`);throw f.name="NullInjectorError",f}return u}}function Em(r){return{\u0275providers:r}}function Dm(...r){return{\u0275providers:Zp(0,r),\u0275fromNgModule:!0}}function Zp(r,...o){const u=[],f=new Set;let x;return Sa(o,C=>{const A=C;gl(A,u,[],f)&&(x||(x=[]),x.push(A))}),void 0!==x&&Sh(x,u),u}function Sh(r,o){for(let u=0;u<r.length;u++){const{providers:x}=r[u];Gp(x,C=>{o.push(C)})}}function gl(r,o,u,f){if(!(r=Ae(r)))return!1;let x=null,C=xi(r);const A=!C&&Oi(r);if(C||A){if(A&&!A.standalone)return!1;x=r}else{const G=r.ngModule;if(C=xi(G),!C)return!1;x=G}const N=f.has(x);if(A){if(N)return!1;if(f.add(x),A.dependencies){const G="function"==typeof A.dependencies?A.dependencies():A.dependencies;for(const oe of G)gl(oe,o,u,f)}}else{if(!C)return!1;{if(null!=C.imports&&!N){let oe;f.add(x);try{Sa(C.imports,Se=>{gl(Se,o,u,f)&&(oe||(oe=[]),oe.push(Se))})}finally{}void 0!==oe&&Sh(oe,o)}if(!N){const oe=ts(x)||(()=>new x);o.push({provide:x,useFactory:oe,deps:zt},{provide:Cm,useValue:x,multi:!0},{provide:jp,useValue:()=>gn(x),multi:!0})}const G=C.providers;null==G||N||Gp(G,Se=>{o.push(Se)})}}return x!==r&&void 0!==r.providers}function Gp(r,o){for(let u of r)Qe(u)&&(u=u.\u0275providers),Array.isArray(u)?Gp(u,o):o(u)}const Hp=Q({provide:String,useValue:Q});function Wp(r){return null!==r&&"object"==typeof r&&Hp in r}function _l(r){return"function"==typeof r}const Ph=new Ur("Set Injector scope."),Ul={},wd={};let qp;function Oh(){return void 0===qp&&(qp=new Tm),qp}class au{}class Sm extends au{constructor(o,u,f,x){super(),this.parent=u,this.source=f,this.scopes=x,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,zu(o,A=>this.processProvider(A)),this.records.set($p,ku(void 0,this)),x.has("environment")&&this.records.set(au,ku(void 0,this));const C=this.records.get(Ph);null!=C&&"string"==typeof C.value&&this.scopes.add(C.value),this.injectorDefTypes=new Set(this.get(Cm.multi,zt,Ht.Self))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const o of this._ngOnDestroyHooks)o.ngOnDestroy();for(const o of this._onDestroyHooks)o()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),this._onDestroyHooks.length=0}}onDestroy(o){this._onDestroyHooks.push(o)}runInContext(o){this.assertNotDestroyed();const u=_t(this),f=re(void 0);try{return o()}finally{_t(u),re(f)}}get(o,u=mi,f=Ht.Default){this.assertNotDestroyed(),f=R(f);const x=_t(this),C=re(void 0);try{if(!(f&Ht.SkipSelf)){let N=this.records.get(o);if(void 0===N){const G=function Eo(r){return"function"==typeof r||"object"==typeof r&&r instanceof Ur}(o)&&ni(o);N=G&&this.injectableDefInScope(G)?ku(Yp(o),Ul):null,this.records.set(o,N)}if(null!=N)return this.hydrate(o,N)}return(f&Ht.Self?Oh():this.parent).get(o,u=f&Ht.Optional&&u===mi?null:u)}catch(A){if("NullInjectorError"===A.name){if((A[Pi]=A[Pi]||[]).unshift(me(o)),x)throw A;return function st(r,o,u,f){const x=r[Pi];throw o[ui]&&x.unshift(o[ui]),r.message=function Bt(r,o,u,f=null){r=r&&"\n"===r.charAt(0)&&"\u0275"==r.charAt(1)?r.slice(2):r;let x=me(o);if(Array.isArray(o))x=o.map(me).join(" -> ");else if("object"==typeof o){let C=[];for(let A in o)if(o.hasOwnProperty(A)){let N=o[A];C.push(A+":"+("string"==typeof N?JSON.stringify(N):me(N)))}x=`{${C.join(", ")}}`}return`${u}${f?"("+f+")":""}[${x}]: ${r.replace(wr,"\n  ")}`}("\n"+r.message,x,u,f),r.ngTokenPath=x,r[Pi]=null,r}(A,o,"R3InjectorError",this.source)}throw A}finally{re(C),_t(x)}}resolveInjectorInitializers(){const o=_t(this),u=re(void 0);try{const f=this.get(jp.multi,zt,Ht.Self);for(const x of f)x()}finally{_t(o),re(u)}}toString(){const o=[],u=this.records;for(const f of u.keys())o.push(me(f));return`R3Injector[${o.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new ye(205,!1)}processProvider(o){let u=_l(o=Ae(o))?o:Ae(o&&o.provide);const f=function d_(r){return Wp(r)?ku(void 0,r.useValue):ku(Rh(r),Ul)}(o);if(_l(o)||!0!==o.multi)this.records.get(u);else{let x=this.records.get(u);x||(x=ku(void 0,Ul,!0),x.factory=()=>j(x.multi),this.records.set(u,x)),u=o,x.multi.push(o)}this.records.set(u,f)}hydrate(o,u){return u.value===Ul&&(u.value=wd,u.value=u.factory()),"object"==typeof u.value&&u.value&&function h_(r){return null!==r&&"object"==typeof r&&"function"==typeof r.ngOnDestroy}(u.value)&&this._ngOnDestroyHooks.add(u.value),u.value}injectableDefInScope(o){if(!o.providedIn)return!1;const u=Ae(o.providedIn);return"string"==typeof u?"any"===u||this.scopes.has(u):this.injectorDefTypes.has(u)}}function Yp(r){const o=ni(r),u=null!==o?o.factory:ts(r);if(null!==u)return u;if(r instanceof Ur)throw new ye(204,!1);if(r instanceof Function)return function u_(r){const o=r.length;if(o>0)throw P(o,"?"),new ye(204,!1);const u=function _i(r){const o=r&&(r[Ni]||r[Ui]);if(o){const u=function wi(r){if(r.hasOwnProperty("name"))return r.name;const o=(""+r).match(/^function\s*([^\s(]+)/);return null===o?"":o[1]}(r);return console.warn(`DEPRECATED: DI is instantiating a token "${u}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${u}" class.`),o}return null}(r);return null!==u?()=>u.factory(r):()=>new r}(r);throw new ye(204,!1)}function Rh(r,o,u){let f;if(_l(r)){const x=Ae(r);return ts(x)||Yp(x)}if(Wp(r))f=()=>Ae(r.useValue);else if(function Mm(r){return!(!r||!r.useFactory)}(r))f=()=>r.useFactory(...j(r.deps||[]));else if(function Im(r){return!(!r||!r.useExisting)}(r))f=()=>gn(Ae(r.useExisting));else{const x=Ae(r&&(r.useClass||r.provide));if(!function Bu(r){return!!r.deps}(r))return ts(x)||Yp(x);f=()=>new x(...j(r.deps))}return f}function ku(r,o,u=!1){return{factory:r,value:o,multi:u?[]:void 0}}function zu(r,o){for(const u of r)Array.isArray(u)?zu(u,o):u&&Qe(u)?zu(u.\u0275providers,o):o(u)}class Am{}class Cd{}class Pm{resolveComponentFactory(o){throw function Lh(r){const o=Error(`No component factory found for ${me(r)}. Did you add it to @NgModule.entryComponents?`);return o.ngComponent=r,o}(o)}}let hc=(()=>{class r{}return r.NULL=new Pm,r})();function Jp(){return jc(ro(),Dn())}function jc(r,o){return new Td(zr(r,o))}let Td=(()=>{class r{constructor(u){this.nativeElement=u}}return r.__NG_ELEMENT_ID__=Jp,r})();function Om(r){return r instanceof Td?r.nativeElement:r}class Uu{}let f_=(()=>{class r{}return r.__NG_ELEMENT_ID__=()=>function Xp(){const r=Dn(),u=Yr(ro().index,r);return(rr(u)?u:r)[11]}(),r})(),m_=(()=>{class r{}return r.\u0275prov=ut({token:r,providedIn:"root",factory:()=>null}),r})();class Fh{constructor(o){this.full=o,this.major=o.split(".")[0],this.minor=o.split(".")[1],this.patch=o.split(".").slice(2).join(".")}}const Kp=new Fh("15.0.4"),Vu={};function ef(r){return r.ngOriginalError}class Ed{constructor(){this._console=console}handleError(o){const u=this._findOriginalError(o);this._console.error("ERROR",o),u&&this._console.error("ORIGINAL ERROR",u)}_findOriginalError(o){let u=o&&ef(o);for(;u&&ef(u);)u=ef(u);return u||null}}function pc(r){return r instanceof Function?r():r}function Dd(r,o,u){let f=r.length;for(;;){const x=r.indexOf(o,u);if(-1===x)return x;if(0===x||r.charCodeAt(x-1)<=32){const C=o.length;if(x+C===f||r.charCodeAt(x+C)<=32)return x}u=x+1}}const Id="ng-template";function b_(r,o,u){let f=0;for(;f<r.length;){let x=r[f++];if(u&&"class"===x){if(x=r[f],-1!==Dd(x.toLowerCase(),o,0))return!0}else if(1===x){for(;f<r.length&&"string"==typeof(x=r[f++]);)if(x.toLowerCase()===o)return!0;return!1}}return!1}function zm(r){return 4===r.type&&r.value!==Id}function Md(r,o,u){return o===(4!==r.type||u?r.value:Id)}function Sd(r,o,u){let f=4;const x=r.attrs||[],C=function Nm(r){for(let o=0;o<r.length;o++)if(Yl(r[o]))return o;return r.length}(x);let A=!1;for(let N=0;N<o.length;N++){const G=o[N];if("number"!=typeof G){if(!A)if(4&f){if(f=2|1&f,""!==G&&!Md(r,G,u)||""===G&&1===o.length){if(Qa(f))return!1;A=!0}}else{const oe=8&f?G:o[++N];if(8&f&&null!==r.attrs){if(!b_(r.attrs,oe,u)){if(Qa(f))return!1;A=!0}continue}const lt=Ad(8&f?"class":G,x,zm(r),u);if(-1===lt){if(Qa(f))return!1;A=!0;continue}if(""!==oe){let Vt;Vt=lt>C?"":x[lt+1].toLowerCase();const an=8&f?Vt:null;if(an&&-1!==Dd(an,oe,0)||2&f&&oe!==Vt){if(Qa(f))return!1;A=!0}}}}else{if(!A&&!Qa(f)&&!Qa(G))return!1;if(A&&Qa(G))continue;A=!1,f=G|1&f}}return Qa(f)||A}function Qa(r){return 0==(1&r)}function Ad(r,o,u,f){if(null===o)return-1;let x=0;if(f||!u){let C=!1;for(;x<o.length;){const A=o[x];if(A===r)return x;if(3===A||6===A)C=!0;else{if(1===A||2===A){let N=o[++x];for(;"string"==typeof N;)N=o[++x];continue}if(4===A)break;if(0===A){x+=4;continue}}x+=C?1:2}return-1}return function Um(r,o){let u=r.indexOf(4);if(u>-1)for(u++;u<r.length;){const f=r[u];if("number"==typeof f)return-1;if(f===o)return u;u++}return-1}(o,r)}function tf(r,o,u=!1){for(let f=0;f<o.length;f++)if(Sd(r,o[f],u))return!0;return!1}function Vm(r,o){e:for(let u=0;u<o.length;u++){const f=o[u];if(r.length===f.length){for(let x=0;x<r.length;x++)if(r[x]!==f[x])continue e;return!0}}return!1}function nf(r,o){return r?":not("+o.trim()+")":o}function jm(r){let o=r[0],u=1,f=2,x="",C=!1;for(;u<r.length;){let A=r[u];if("string"==typeof A)if(2&f){const N=r[++u];x+="["+A+(N.length>0?'="'+N+'"':"")+"]"}else 8&f?x+="."+A:4&f&&(x+=" "+A);else""!==x&&!Qa(A)&&(o+=nf(C,x),x=""),f=A,C=C||!Qa(f);u++}return""!==x&&(o+=nf(C,x)),o}const Ki={};function rf(r){Pd(Ji(),Dn(),_o()+r,!1)}function Pd(r,o,u,f){if(!f)if(3==(3&o[2])){const C=r.preOrderCheckHooks;null!==C&&li(o,C,u)}else{const C=r.preOrderHooks;null!==C&&sr(o,C,0,u)}Ea(u)}function Gm(r,o=null,u=null,f){const x=Hm(r,o,u,f);return x.resolveInjectorInitializers(),x}function Hm(r,o=null,u=null,f,x=new Set){const C=[u||zt,Dm(r)];return f=f||("object"==typeof r?void 0:me(r)),new Sm(C,o||Oh(),f||null,x)}let cu=(()=>{class r{static create(u,f){if(Array.isArray(u))return Gm({name:""},f,u,"");{const x=u.name??"";return Gm({name:x},u.parent,u.providers,x)}}}return r.THROW_IF_NOT_FOUND=mi,r.NULL=new Tm,r.\u0275prov=ut({token:r,providedIn:"any",factory:()=>gn($p)}),r.__NG_ELEMENT_ID__=-1,r})();function yl(r,o=Ht.Default){const u=Dn();return null===u?gn(r,o):To(ro(),u,Ae(r),o)}function hf(){throw new Error("invalid")}function Km(r,o){const u=r.contentQueries;if(null!==u)for(let f=0;f<u.length;f+=2){const x=u[f],C=u[f+1];if(-1!==C){const A=r.data[C];or(x),A.contentQueries(2,o[C],C)}}}function zh(r,o,u,f,x,C,A,N,G,oe,Se){const lt=o.blueprint.slice();return lt[0]=x,lt[2]=76|f,(null!==Se||r&&1024&r[2])&&(lt[2]|=1024),X(lt),lt[3]=lt[15]=r,lt[8]=u,lt[10]=A||r&&r[10],lt[11]=N||r&&r[11],lt[12]=G||r&&r[12]||null,lt[9]=oe||r&&r[9]||null,lt[6]=C,lt[20]=function sh(){return pd++}(),lt[21]=Se,lt[16]=2==o.type?r[16]:lt,lt}function Hu(r,o,u,f,x){let C=r.data[o];if(null===C)C=function pf(r,o,u,f,x){const C=ca(),A=Xs(),G=r.data[o]=function Nd(r,o,u,f,x,C){return{type:u,index:f,insertBeforeIndex:null,injectorIndex:o?o.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:0,providerIndexes:0,value:x,attrs:C,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:o,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,A?C:C&&C.parent,u,o,f,x);return null===r.firstChild&&(r.firstChild=G),null!==C&&(A?null==C.child&&null!==G.parent&&(C.child=G):null===C.next&&(C.next=G)),G}(r,o,u,f,x),function St(){return Te.lFrame.inI18n}()&&(C.flags|=32);else if(64&C.type){C.type=u,C.value=f,C.attrs=x;const A=function js(){const r=Te.lFrame,o=r.currentTNode;return r.isParent?o:o.parent}();C.injectorIndex=null===A?-1:A.injectorIndex}return co(C,!0),C}function Bd(r,o,u,f){if(0===u)return-1;const x=o.length;for(let C=0;C<u;C++)o.push(f),r.blueprint.push(f),r.data.push(null);return x}function ff(r,o,u){Ds(o);try{const f=r.viewQuery;null!==f&&Zc(1,f,u);const x=r.template;null!==x&&hu(r,o,x,1,u),r.firstCreatePass&&(r.firstCreatePass=!1),r.staticContentQueries&&Km(r,o),r.staticViewQueries&&Zc(2,r.viewQuery,u);const C=r.components;null!==C&&function k_(r,o){for(let u=0;u<o.length;u++)Wh(r,o[u])}(o,C)}catch(f){throw r.firstCreatePass&&(r.incompleteFirstPass=!0,r.firstCreatePass=!1),f}finally{o[2]&=-5,Ms()}}function du(r,o,u,f){const x=o[2];if(128!=(128&x)){Ds(o);try{X(o),function I(r){return Te.lFrame.bindingIndex=r}(r.bindingStartIndex),null!==u&&hu(r,o,u,2,f);const A=3==(3&x);if(A){const oe=r.preOrderCheckHooks;null!==oe&&li(o,oe,null)}else{const oe=r.preOrderHooks;null!==oe&&sr(o,oe,0,null),nr(o,0)}if(function Hh(r){for(let o=Au(r);null!==o;o=dl(o)){if(!o[2])continue;const u=o[9];for(let f=0;f<u.length;f++){const x=u[f],C=x[3];0==(512&x[2])&&q(C,1),x[2]|=512}}}(o),function cg(r){for(let o=Au(r);null!==o;o=dl(o))for(let u=10;u<o.length;u++){const f=o[u],x=f[1];Ca(f)&&du(x,f,x.template,f[8])}}(o),null!==r.contentQueries&&Km(r,o),A){const oe=r.contentCheckHooks;null!==oe&&li(o,oe)}else{const oe=r.contentHooks;null!==oe&&sr(o,oe,1),nr(o,1)}!function L_(r,o){const u=r.hostBindingOpCodes;if(null!==u)try{for(let f=0;f<u.length;f++){const x=u[f];if(x<0)Ea(~x);else{const C=x,A=u[++f],N=u[++f];Zn(A,C),N(2,o[C])}}}finally{Ea(-1)}}(r,o);const N=r.components;null!==N&&function F_(r,o){for(let u=0;u<o.length;u++)ug(r,o[u])}(o,N);const G=r.viewQuery;if(null!==G&&Zc(2,G,f),A){const oe=r.viewCheckHooks;null!==oe&&li(o,oe)}else{const oe=r.viewHooks;null!==oe&&sr(o,oe,2),nr(o,2)}!0===r.firstUpdatePass&&(r.firstUpdatePass=!1),o[2]&=-41,512&o[2]&&(o[2]&=-513,q(o[3],-1))}finally{Ms()}}}function hu(r,o,u,f,x){const C=_o(),A=2&f;try{Ea(-1),A&&o.length>22&&Pd(r,o,22,!1),u(f,x)}finally{Ea(C)}}function Nh(r,o,u){if(xs(o)){const x=o.directiveEnd;for(let C=o.directiveStart;C<x;C++){const A=r.data[C];A.contentQueries&&A.contentQueries(1,u[C],C)}}}function mf(r,o,u){!la()||(function ng(r,o,u,f){const x=u.directiveStart,C=u.directiveEnd;so(u)&&function ag(r,o,u){const f=zr(o,r),x=Qm(u),C=r[10],A=qh(r,zh(r,x,null,u.onPush?32:16,f,o,C,C.createRenderer(f,u),null,null,null));r[o.index]=A}(o,u,r.data[x+u.componentOffset]),r.firstCreatePass||$a(u,o),Rs(f,o);const A=u.initialInputs;for(let N=x;N<C;N++){const G=r.data[N],oe=po(o,r,N,u);Rs(oe,o),null!==A&&lg(0,N-x,oe,G,0,A),Wr(G)&&(Yr(u.index,o)[8]=po(o,r,N,u))}}(r,o,u,zr(u,o)),64==(64&u.flags)&&Vl(r,o,u))}function gf(r,o,u=zr){const f=o.localNames;if(null!==f){let x=o.index+1;for(let C=0;C<f.length;C+=2){const A=f[C+1],N=-1===A?u(o,r):r[A];r[x++]=N}}}function Qm(r){const o=r.tView;return null===o||o.incompleteFirstPass?r.tView=zd(1,null,r.template,r.decls,r.vars,r.directiveDefs,r.pipeDefs,r.viewQuery,r.schemas,r.consts):o}function zd(r,o,u,f,x,C,A,N,G,oe){const Se=22+f,lt=Se+x,Vt=function _f(r,o){const u=[];for(let f=0;f<o;f++)u.push(f<r?null:Ki);return u}(Se,lt),an="function"==typeof oe?oe():oe;return Vt[1]={type:r,blueprint:Vt,template:u,queries:null,viewQuery:N,declTNode:o,data:Vt.slice().fill(null,Se),bindingStartIndex:Se,expandoStartIndex:lt,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof C?C():C,pipeRegistry:"function"==typeof A?A():A,firstChild:null,schemas:G,consts:an,incompleteFirstPass:!1}}function ga(r,o,u,f){const x=hg(o);null===u?x.push(f):(x.push(u),r.firstCreatePass&&bf(r).push(f,x.length-1))}function pu(r,o,u,f){for(let x in r)if(r.hasOwnProperty(x)){u=null===u?{}:u;const C=r[x];null===f?Uh(u,o,x,C):f.hasOwnProperty(x)&&Uh(u,o,f[x],C)}return u}function Uh(r,o,u,f){r.hasOwnProperty(u)?r[u].push(o,f):r[u]=[o,f]}function _a(r,o,u,f,x,C,A,N){const G=zr(o,u);let Se,oe=o.inputs;!N&&null!=oe&&(Se=oe[f])?(wf(r,u,Se,f,x),so(o)&&yf(u,o.index)):3&o.type&&(f=function B_(r){return"class"===r?"className":"for"===r?"htmlFor":"formaction"===r?"formAction":"innerHtml"===r?"innerHTML":"readonly"===r?"readOnly":"tabindex"===r?"tabIndex":r}(f),x=null!=A?A(x,o.value||"",f):x,C.setProperty(G,f,x))}function yf(r,o){const u=Yr(o,r);16&u[2]||(u[2]|=32)}function jh(r,o,u,f){let x=!1;if(la()){const C=null===f?null:{"":-1},A=function rg(r,o){const u=r.directiveRegistry;let f=null,x=null;if(u)for(let C=0;C<u.length;C++){const A=u[C];if(tf(o,A.selectors,!1))if(f||(f=[]),Wr(A))if(null!==A.findHostDirectiveDefs){const N=[];x=x||new Map,A.findHostDirectiveDefs(A,N,x),f.unshift(...N,A),Zh(r,o,N.length)}else f.unshift(A),Zh(r,o,0);else x=x||new Map,A.findHostDirectiveDefs?.(A,f,x),f.push(A)}return null===f?null:[f,x]}(r,u);let N,G;null===A?N=G=null:[N,G]=A,null!==N&&(x=!0,$h(r,o,u,N,C,G)),C&&function og(r,o,u){if(o){const f=r.localNames=[];for(let x=0;x<o.length;x+=2){const C=u[o[x+1]];if(null==C)throw new ye(-301,!1);f.push(o[x],C)}}}(u,f,C)}return u.mergedAttrs=Ua(u.mergedAttrs,u.attrs),x}function $h(r,o,u,f,x,C){for(let oe=0;oe<f.length;oe++)tc($a(u,o),r,f[oe].type);!function j_(r,o,u){r.flags|=1,r.directiveStart=o,r.directiveEnd=o+u,r.providerIndexes=o}(u,r.data.length,f.length);for(let oe=0;oe<f.length;oe++){const Se=f[oe];Se.providersResolver&&Se.providersResolver(Se)}let A=!1,N=!1,G=Bd(r,o,f.length,null);for(let oe=0;oe<f.length;oe++){const Se=f[oe];u.mergedAttrs=Ua(u.mergedAttrs,Se.hostAttrs),sg(r,u,o,G,Se),V_(G,Se,x),null!==Se.contentQueries&&(u.flags|=4),(null!==Se.hostBindings||null!==Se.hostAttrs||0!==Se.hostVars)&&(u.flags|=64);const lt=Se.type.prototype;!A&&(lt.ngOnChanges||lt.ngOnInit||lt.ngDoCheck)&&((r.preOrderHooks||(r.preOrderHooks=[])).push(u.index),A=!0),!N&&(lt.ngOnChanges||lt.ngDoCheck)&&((r.preOrderCheckHooks||(r.preOrderCheckHooks=[])).push(u.index),N=!0),G++}!function Vh(r,o,u){const x=o.directiveEnd,C=r.data,A=o.attrs,N=[];let G=null,oe=null;for(let Se=o.directiveStart;Se<x;Se++){const lt=C[Se],Vt=u?u.get(lt):null,In=Vt?Vt.outputs:null;G=pu(lt.inputs,Se,G,Vt?Vt.inputs:null),oe=pu(lt.outputs,Se,oe,In);const Qn=null===G||null===A||zm(o)?null:vf(G,Se,A);N.push(Qn)}null!==G&&(G.hasOwnProperty("class")&&(o.flags|=8),G.hasOwnProperty("style")&&(o.flags|=16)),o.initialInputs=N,o.inputs=G,o.outputs=oe}(r,u,C)}function Vl(r,o,u){const f=u.directiveStart,x=u.directiveEnd,C=u.index,A=function Ei(){return Te.lFrame.currentDirectiveIndex}();try{Ea(C);for(let N=f;N<x;N++){const G=r.data[N],oe=o[N];ii(N),(null!==G.hostBindings||0!==G.hostVars||null!==G.hostAttrs)&&ig(G,oe)}}finally{Ea(-1),ii(A)}}function ig(r,o){null!==r.hostBindings&&r.hostBindings(1,o)}function Zh(r,o,u){o.componentOffset=u,(r.components||(r.components=[])).push(o.index)}function V_(r,o,u){if(u){if(o.exportAs)for(let f=0;f<o.exportAs.length;f++)u[o.exportAs[f]]=r;Wr(o)&&(u[""]=r)}}function sg(r,o,u,f,x){r.data[f]=x;const C=x.factory||(x.factory=ts(x.type)),A=new gr(C,Wr(x),yl);r.blueprint[f]=A,u[f]=A,function tg(r,o,u,f,x){const C=x.hostBindings;if(C){let A=r.hostBindingOpCodes;null===A&&(A=r.hostBindingOpCodes=[]);const N=~o.index;(function U_(r){let o=r.length;for(;o>0;){const u=r[--o];if("number"==typeof u&&u<0)return u}return 0})(A)!=N&&A.push(N),A.push(u,f,C)}}(r,o,f,Bd(r,u,x.hostVars,Ki),x)}function ya(r,o,u,f,x,C){const A=zr(r,o);!function Gh(r,o,u,f,x,C,A){if(null==C)r.removeAttribute(o,x,u);else{const N=null==A?Ne(C):A(C,f||"",x);r.setAttribute(o,x,N,u)}}(o[11],A,C,r.value,u,f,x)}function lg(r,o,u,f,x,C){const A=C[o];if(null!==A){const N=f.setInput;for(let G=0;G<A.length;){const oe=A[G++],Se=A[G++],lt=A[G++];null!==N?f.setInput(u,lt,oe,Se):u[Se]=lt}}}function vf(r,o,u){let f=null,x=0;for(;x<u.length;){const C=u[x];if(0!==C)if(5!==C){if("number"==typeof C)break;if(r.hasOwnProperty(C)){null===f&&(f=[]);const A=r[C];for(let N=0;N<A.length;N+=2)if(A[N]===o){f.push(C,A[N+1],u[x+1]);break}}x+=2}else x+=2;else x+=4}return f}function fu(r,o,u,f){return[r,!0,!1,o,null,0,f,u,null,null]}function ug(r,o){const u=Yr(o,r);if(Ca(u)){const f=u[1];48&u[2]?du(f,u,f.template,u[8]):u[5]>0&&Wu(u)}}function Wu(r){for(let f=Au(r);null!==f;f=dl(f))for(let x=10;x<f.length;x++){const C=f[x];if(Ca(C))if(512&C[2]){const A=C[1];du(A,C,A.template,C[8])}else C[5]>0&&Wu(C)}const u=r[1].components;if(null!==u)for(let f=0;f<u.length;f++){const x=Yr(u[f],r);Ca(x)&&x[5]>0&&Wu(x)}}function Wh(r,o){const u=Yr(o,r),f=u[1];(function $_(r,o){for(let u=o.length;u<r.blueprint.length;u++)o.push(r.blueprint[u])})(f,u),ff(f,u,u[8])}function qh(r,o){return r[13]?r[14][4]=o:r[13]=o,r[14]=o,o}function xf(r){for(;r;){r[2]|=32;const o=kc(r);if(Ho(r)&&!o)return r;r=o}return null}function Yh(r,o,u,f=!0){const x=o[10];x.begin&&x.begin();try{du(r,o,r.template,u)}catch(A){throw f&&Jh(o,A),A}finally{x.end&&x.end()}}function Zc(r,o,u){or(0),o(r,u)}function hg(r){return r[7]||(r[7]=[])}function bf(r){return r.cleanup||(r.cleanup=[])}function Jh(r,o){const u=r[9],f=u?u.get(Ed,null):null;f&&f.handleError(o)}function wf(r,o,u,f,x){for(let C=0;C<u.length;){const A=u[C++],N=u[C++],G=o[A],oe=r.data[A];null!==oe.setInput?oe.setInput(G,x,f,N):G[N]=x}}function Ws(r,o,u){const f=ji(o,r);!function um(r,o,u){r.setValue(o,u)}(r[11],f,u)}function Ud(r,o,u){let f=u?r.styles:null,x=u?r.classes:null,C=0;if(null!==o)for(let A=0;A<o.length;A++){const N=o[A];"number"==typeof N?C=N:1==C?x=Ze(x,N):2==C&&(f=Ze(f,N+": "+o[++A]+";"))}u?r.styles=f:r.stylesWithoutHost=f,u?r.classes=x:r.classesWithoutHost=x}function Vd(r,o,u,f,x=!1){for(;null!==u;){const C=o[u.index];if(null!==C&&f.push(Tr(C)),So(C))for(let N=10;N<C.length;N++){const G=C[N],oe=G[1].firstChild;null!==oe&&Vd(G[1],G,oe,f)}const A=u.type;if(8&A)Vd(r,o,u.child,f);else if(32&A){const N=uh(u,o);let G;for(;G=N();)f.push(G)}else if(16&A){const N=os(o,u);if(Array.isArray(N))f.push(...N);else{const G=kc(o[16]);Vd(G[1],G,N,f,!0)}}u=x?u.projectionNext:u.next}return f}class Gc{constructor(o,u){this._lView=o,this._cdRefInjectingView=u,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const o=this._lView,u=o[1];return Vd(u,o,u.firstChild,[])}get context(){return this._lView[8]}set context(o){this._lView[8]=o}get destroyed(){return 128==(128&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const o=this._lView[3];if(So(o)){const u=o[8],f=u?u.indexOf(this):-1;f>-1&&(cc(o,f),sc(u,f))}this._attachedToViewContainer=!1}dm(this._lView[1],this._lView)}onDestroy(o){ga(this._lView[1],this._lView,null,o)}markForCheck(){xf(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-65}reattach(){this._lView[2]|=64}detectChanges(){Yh(this._lView[1],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new ye(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function Pu(r,o){Bl(r,o,o[11],2,null,null)}(this._lView[1],this._lView)}attachToAppRef(o){if(this._attachedToViewContainer)throw new ye(902,!1);this._appRef=o}}class Cf extends Gc{constructor(o){super(o),this._view=o}detectChanges(){const o=this._view;Yh(o[1],o,o[8],!1)}checkNoChanges(){}get context(){return null}}class fg extends hc{constructor(o){super(),this.ngModule=o}resolveComponentFactory(o){const u=Oi(o);return new fc(u,this.ngModule)}}function mg(r){const o=[];for(let u in r)r.hasOwnProperty(u)&&o.push({propName:r[u],templateName:u});return o}class _g{constructor(o,u){this.injector=o,this.parentInjector=u}get(o,u,f){f=R(f);const x=this.injector.get(o,Vu,f);return x!==Vu||u===Vu?x:this.parentInjector.get(o,u,f)}}class fc extends Cd{constructor(o,u){super(),this.componentDef=o,this.ngModule=u,this.componentType=o.type,this.selector=function $m(r){return r.map(jm).join(",")}(o.selectors),this.ngContentSelectors=o.ngContentSelectors?o.ngContentSelectors:[],this.isBoundToModule=!!u}get inputs(){return mg(this.componentDef.inputs)}get outputs(){return mg(this.componentDef.outputs)}create(o,u,f,x){let C=(x=x||this.ngModule)instanceof au?x:x?.injector;C&&null!==this.componentDef.getStandaloneInjector&&(C=this.componentDef.getStandaloneInjector(C)||C);const A=C?new _g(o,C):o,N=A.get(Uu,null);if(null===N)throw new ye(407,!1);const G=A.get(m_,null),oe=N.createRenderer(null,this.componentDef),Se=this.componentDef.selectors[0][0]||"div",lt=f?function eg(r,o,u){return r.selectRootElement(o,u===Re.ShadowDom)}(oe,f,this.componentDef.encapsulation):bp(oe,Se,function gg(r){const o=r.toLowerCase();return"svg"===o?"svg":"math"===o?"math":null}(Se)),Vt=this.componentDef.onPush?288:272,an=zd(0,null,null,1,0,null,null,null,null,null),In=zh(null,an,null,Vt,null,null,N,oe,G,A,null);let Qn,ai;Ds(In);try{const bi=this.componentDef;let Gi,Vn=null;bi.findHostDirectiveDefs?(Gi=[],Vn=new Map,bi.findHostDirectiveDefs(bi,Gi,Vn),Gi.push(bi)):Gi=[bi];const ir=function qu(r,o){const u=r[1];return r[22]=o,Hu(u,22,2,"#host",null)}(In,lt),Bo=function Yu(r,o,u,f,x,C,A,N){const G=x[1];!function vl(r,o,u,f){for(const x of r)o.mergedAttrs=Ua(o.mergedAttrs,x.hostAttrs);null!==o.mergedAttrs&&(Ud(o,o.mergedAttrs,!0),null!==u&&fm(f,u,o))}(f,r,o,A);const oe=C.createRenderer(o,u),Se=zh(x,Qm(u),null,u.onPush?32:16,x[r.index],r,C,oe,N||null,null,null);return G.firstCreatePass&&Zh(G,r,f.length-1),qh(x,Se),x[r.index]=Se}(ir,lt,bi,Gi,In,N,oe);ai=Co(an,22),lt&&function Z_(r,o,u,f){if(f)$s(r,u,["ng-version",Kp.full]);else{const{attrs:x,classes:C}=function C_(r){const o=[],u=[];let f=1,x=2;for(;f<r.length;){let C=r[f];if("string"==typeof C)2===x?""!==C&&o.push(C,r[++f]):8===x&&u.push(C);else{if(!Qa(x))break;x=C}f++}return{attrs:o,classes:u}}(o.selectors[0]);x&&$s(r,u,x),C&&C.length>0&&Ap(r,u,C.join(" "))}}(oe,bi,lt,f),void 0!==u&&function vg(r,o,u){const f=r.projection=[];for(let x=0;x<o.length;x++){const C=u[x];f.push(null!=C?Array.from(C):null)}}(ai,this.ngContentSelectors,u),Qn=function xl(r,o,u,f,x,C){const A=ro(),N=x[1],G=zr(A,x);$h(N,x,A,u,null,f);for(let Se=0;Se<u.length;Se++)Rs(po(x,N,A.directiveStart+Se,A),x);Vl(N,x,A),G&&Rs(G,x);const oe=po(x,N,A.directiveStart+A.componentOffset,A);if(r[8]=x[8]=oe,null!==C)for(const Se of C)Se(oe,o);return Nh(N,A,r),oe}(Bo,bi,Gi,Vn,In,[G_]),ff(an,In,null)}finally{Ms()}return new mc(this.componentType,Qn,jc(ai,In),In,ai)}}class mc extends Am{constructor(o,u,f,x,C){super(),this.location=f,this._rootLView=x,this._tNode=C,this.instance=u,this.hostView=this.changeDetectorRef=new Cf(x),this.componentType=o}setInput(o,u){const f=this._tNode.inputs;let x;if(null!==f&&(x=f[o])){const C=this._rootLView;wf(C[1],C,x,o,u),yf(C,this._tNode.index)}}get injector(){return new Pl(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(o){this.hostView.onDestroy(o)}}function G_(){const r=ro();Tn(Dn()[1],r)}function el(r){let o=function Xh(r){return Object.getPrototypeOf(r.prototype).constructor}(r.type),u=!0;const f=[r];for(;o;){let x;if(Wr(r))x=o.\u0275cmp||o.\u0275dir;else{if(o.\u0275cmp)throw new ye(903,!1);x=o.\u0275dir}if(x){if(u){f.push(x);const A=r;A.inputs=Kh(r.inputs),A.declaredInputs=Kh(r.declaredInputs),A.outputs=Kh(r.outputs);const N=x.hostBindings;N&&Qh(r,N);const G=x.viewQuery,oe=x.contentQueries;if(G&&xg(r,G),oe&&H_(r,oe),be(r.inputs,x.inputs),be(r.declaredInputs,x.declaredInputs),be(r.outputs,x.outputs),Wr(x)&&x.data.animation){const Se=r.data;Se.animation=(Se.animation||[]).concat(x.data.animation)}}const C=x.features;if(C)for(let A=0;A<C.length;A++){const N=C[A];N&&N.ngInherit&&N(r),N===el&&(u=!1)}}o=Object.getPrototypeOf(o)}!function mu(r){let o=0,u=null;for(let f=r.length-1;f>=0;f--){const x=r[f];x.hostVars=o+=x.hostVars,x.hostAttrs=Ua(x.hostAttrs,u=Ua(u,x.hostAttrs))}}(f)}function Kh(r){return r===nt?{}:r===zt?[]:r}function xg(r,o){const u=r.viewQuery;r.viewQuery=u?(f,x)=>{o(f,x),u(f,x)}:o}function H_(r,o){const u=r.contentQueries;r.contentQueries=u?(f,x,C)=>{o(f,x,C),u(f,x,C)}:o}function Qh(r,o){const u=r.hostBindings;r.hostBindings=u?(f,x)=>{o(f,x),u(f,x)}:o}let gc=null;function Hc(){if(!gc){const r=Qt.Symbol;if(r&&r.iterator)gc=r.iterator;else{const o=Object.getOwnPropertyNames(Map.prototype);for(let u=0;u<o.length;++u){const f=o[u];"entries"!==f&&"size"!==f&&Map.prototype[f]===Map.prototype.entries&&(gc=f)}}}return gc}function Hd(r){return!!_c(r)&&(Array.isArray(r)||!(r instanceof Map)&&Hc()in r)}function _c(r){return null!==r&&("function"==typeof r||"object"==typeof r)}function Fs(r,o,u){return r[o]=u}function Yo(r,o,u){return!Object.is(r[o],u)&&(r[o]=u,!0)}function bl(r,o,u,f){const x=Yo(r,o,u);return Yo(r,o+1,f)||x}function Xu(r,o,u,f){const x=Dn();return Yo(x,$(),o)&&(Ji(),ya(vr(),x,r,o,u,f)),Xu}function Qu(r,o,u,f){return Yo(r,$(),u)?o+Ne(u)+f:Ki}function yc(r,o,u,f,x,C,A,N){const oe=function Wc(r,o,u,f,x){const C=bl(r,o,u,f);return Yo(r,o+2,x)||C}(r,Z(),u,x,A);return ve(3),oe?o+Ne(u)+f+Ne(x)+C+Ne(A)+N:Ki}function ed(r,o,u,f,x,C,A,N,G,oe){const lt=function qs(r,o,u,f,x,C){const A=bl(r,o,u,f);return bl(r,o+2,x,C)||A}(r,Z(),u,x,A,G);return ve(4),lt?o+Ne(u)+f+Ne(x)+C+Ne(A)+N+Ne(G)+oe:Ki}function ep(r,o,u,f,x,C,A,N){const G=Dn(),oe=Ji(),Se=r+22,lt=oe.firstCreatePass?function Sf(r,o,u,f,x,C,A,N,G){const oe=o.consts,Se=Hu(o,r,4,A||null,ee(oe,N));jh(o,u,Se,ee(oe,G)),Tn(o,Se);const lt=Se.tViews=zd(2,Se,f,x,C,o.directiveRegistry,o.pipeRegistry,null,o.schemas,oe);return null!==o.queries&&(o.queries.template(o,Se),lt.queries=o.queries.embeddedTView(Se)),Se}(Se,oe,G,o,u,f,x,C,A):oe.data[Se];co(lt,!1);const Vt=G[11].createComment("");ta(oe,G,Vt,lt),Rs(Vt,G),qh(G,G[Se]=fu(Vt,G,Vt,lt)),ao(lt)&&mf(oe,G,lt),null!=A&&gf(G,lt,N)}function Ig(r){return ms(function Tc(){return Te.lFrame.contextLView}(),22+r)}function Xd(r,o,u){const f=Dn();return Yo(f,$(),o)&&_a(Ji(),vr(),f,r,o,f[11],u,!1),Xd}function tp(r,o,u,f,x){const A=x?"class":"style";wf(r,u,o.inputs[A],A,f)}function ip(r,o,u,f){const x=Dn(),C=Ji(),A=22+r,N=x[11],G=x[A]=bp(N,o,function Tt(){return Te.lFrame.currentNamespace}()),oe=C.firstCreatePass?function np(r,o,u,f,x,C,A){const N=o.consts,oe=Hu(o,r,2,x,ee(N,C));return jh(o,u,oe,ee(N,A)),null!==oe.attrs&&Ud(oe,oe.attrs,!1),null!==oe.mergedAttrs&&Ud(oe,oe.mergedAttrs,!0),null!==o.queries&&o.queries.elementStart(o,oe),oe}(A,C,x,0,o,u,f):C.data[A];return co(oe,!0),fm(N,G,oe),32!=(32&oe.flags)&&ta(C,x,G,oe),0===function Nr(){return Te.lFrame.elementDepthCount}()&&Rs(G,x),function lo(){Te.lFrame.elementDepthCount++}(),ao(oe)&&(mf(C,x,oe),Nh(C,oe,x)),null!==f&&gf(x,oe),ip}function rp(){let r=ro();Xs()?ua():(r=r.parent,co(r,!1));const o=r;!function Vo(){Te.lFrame.elementDepthCount--}();const u=Ji();return u.firstCreatePass&&(Tn(u,r),xs(r)&&u.queries.elementEnd(r)),null!=o.classesWithoutHost&&function ho(r){return 0!=(8&r.flags)}(o)&&tp(u,o,Dn(),o.classesWithoutHost,!0),null!=o.stylesWithoutHost&&function Na(r){return 0!=(16&r.flags)}(o)&&tp(u,o,Dn(),o.stylesWithoutHost,!1),rp}function Af(r,o,u,f){return ip(r,o,u,f),rp(),Af}function nd(r,o,u){const f=Dn(),x=Ji(),C=r+22,A=x.firstCreatePass?function X_(r,o,u,f,x){const C=o.consts,A=ee(C,f),N=Hu(o,r,8,"ng-container",A);return null!==A&&Ud(N,A,!0),jh(o,u,N,ee(C,x)),null!==o.queries&&o.queries.elementStart(o,N),N}(C,x,f,o,u):x.data[C];co(A,!0);const N=f[C]=f[11].createComment("");return ta(x,f,N,A),Rs(N,f),ao(A)&&(mf(x,f,A),Nh(x,A,f)),null!=u&&gf(f,A),nd}function op(){let r=ro();const o=Ji();return Xs()?ua():(r=r.parent,co(r,!1)),o.firstCreatePass&&(Tn(o,r),xs(r)&&o.queries.elementEnd(r)),op}function vu(r,o,u){return nd(r,o,u),op(),vu}function Mg(){return Dn()}function Pf(r){return!!r&&"function"==typeof r.then}function Of(r){return!!r&&"function"==typeof r.subscribe}const Sg=Of;function sp(r,o,u,f){const x=Dn(),C=Ji(),A=ro();return function vc(r,o,u,f,x,C,A){const N=ao(f),oe=r.firstCreatePass&&bf(r),Se=o[8],lt=hg(o);let Vt=!0;if(3&f.type||A){const Qn=zr(f,o),ai=A?A(Qn):Qn,bi=lt.length,Gi=A?ir=>A(Tr(ir[f.index])):f.index;let Vn=null;if(!A&&N&&(Vn=function jl(r,o,u,f){const x=r.cleanup;if(null!=x)for(let C=0;C<x.length-1;C+=2){const A=x[C];if(A===u&&x[C+1]===f){const N=o[7],G=x[C+2];return N.length>G?N[G]:null}"string"==typeof A&&(C+=2)}return null}(r,o,x,f.index)),null!==Vn)(Vn.__ngLastListenerFn__||Vn).__ngNextListenerFn__=C,Vn.__ngLastListenerFn__=C,Vt=!1;else{C=xc(f,o,Se,C,!1);const ir=u.listen(ai,x,C);lt.push(C,ir),oe&&oe.push(x,Gi,bi,bi+1)}}else C=xc(f,o,Se,C,!1);const an=f.outputs;let In;if(Vt&&null!==an&&(In=an[x])){const Qn=In.length;if(Qn)for(let ai=0;ai<Qn;ai+=2){const Bo=o[In[ai]][In[ai+1]].subscribe(C),cs=lt.length;lt.push(C,Bo),oe&&oe.push(x,f.index,cs,-(cs+1))}}}(C,x,x[11],A,r,o,f),sp}function Cl(r,o,u,f){try{return!1!==u(f)}catch(x){return Jh(r,x),!1}}function xc(r,o,u,f,x){return function C(A){if(A===Function)return f;xf(r.componentOffset>-1?Yr(r.index,o):o);let G=Cl(o,0,f,A),oe=C.__ngNextListenerFn__;for(;oe;)G=Cl(o,0,oe,A)&&G,oe=oe.__ngNextListenerFn__;return x&&!1===G&&(A.preventDefault(),A.returnValue=!1),G}}function Kd(r=1){return function Hl(r){return(Te.lFrame.contextLView=function ha(r,o){for(;r>0;)o=o[15],r--;return o}(r,Te.lFrame.contextLView))[8]}(r)}function Ag(r,o){let u=null;const f=function w_(r){const o=r.attrs;if(null!=o){const u=o.indexOf(5);if(0==(1&u))return o[u+1]}return null}(r);for(let x=0;x<o.length;x++){const C=o[x];if("*"!==C){if(null===f?tf(r,C,!0):Vm(f,C))return x}else u=x}return u}function Rf(r){const o=Dn()[16][6];if(!o.projection){const f=o.projection=P(r?r.length:1,null),x=f.slice();let C=o.child;for(;null!==C;){const A=r?Ag(C,r):0;null!==A&&(x[A]?x[A].projectionNext=C:f[A]=C,x[A]=C),C=C.next}}}function Lf(r,o=0,u){const f=Dn(),x=Ji(),C=Hu(x,22+r,16,null,u||null);null===C.projection&&(C.projection=o),ua(),32!=(32&C.flags)&&function Dp(r,o,u){Ip(o[11],0,o,u,Tp(r,u,o),_r(u.parent||o[6],u,o))}(x,f,C)}function Qd(r,o,u){return Ff(r,"",o,"",u),Qd}function Ff(r,o,u,f,x){const C=Dn(),A=Qu(C,o,u,f);return A!==Ki&&_a(Ji(),vr(),C,r,A,C[11],x,!1),Ff}function eh(r,o){return r<<17|o<<2}function Tl(r){return r>>17&32767}function th(r){return 2|r}function wc(r){return(131068&r)>>2}function tl(r,o){return-131069&r|o<<2}function nh(r){return 1|r}function od(r,o,u,f,x){const C=r[u+1],A=null===o;let N=f?Tl(C):wc(C),G=!1;for(;0!==N&&(!1===G||A);){const Se=r[N+1];ap(r[N],o)&&(G=!0,r[N+1]=f?nh(Se):th(Se)),N=f?Tl(Se):wc(Se)}G&&(r[u+1]=f?th(C):nh(C))}function ap(r,o){return null===r||null==o||(Array.isArray(r)?r[1]:r)===o||!(!Array.isArray(r)||"string"!=typeof o)&&v(r,o)>=0}function _(r,o,u){return V(r,o,u,!1),_}function w(r,o){return V(r,o,null,!0),w}function V(r,o,u,f){const x=Dn(),C=Ji(),A=ve(2);C.firstUpdatePass&&function ge(r,o,u,f){const x=r.data;if(null===x[u+1]){const C=x[_o()],A=function ne(r,o){return o>=r.expandoStartIndex}(r,u);(function xn(r,o){return 0!=(r.flags&(o?8:16))})(C,f)&&null===o&&!A&&(o=!1),o=function ze(r,o,u,f){const x=function Xi(r){const o=Te.lFrame.currentDirectiveIndex;return-1===o?null:r[o]}(r);let C=f?o.residualClasses:o.residualStyles;if(null===x)0===(f?o.classBindings:o.styleBindings)&&(u=At(u=ft(null,r,o,u,f),o.attrs,f),C=null);else{const A=o.directiveStylingLast;if(-1===A||r[A]!==x)if(u=ft(x,r,o,u,f),null===C){let G=function rt(r,o,u){const f=u?o.classBindings:o.styleBindings;if(0!==wc(f))return r[Tl(f)]}(r,o,f);void 0!==G&&Array.isArray(G)&&(G=ft(null,r,o,G[1],f),G=At(G,o.attrs,f),function wt(r,o,u,f){r[Tl(u?o.classBindings:o.styleBindings)]=f}(r,o,f,G))}else C=function it(r,o,u){let f;const x=o.directiveEnd;for(let C=1+o.directiveStylingLast;C<x;C++)f=At(f,r[C].hostAttrs,u);return At(f,o.attrs,u)}(r,o,f)}return void 0!==C&&(f?o.residualClasses=C:o.residualStyles=C),u}(x,C,o,f),function Pg(r,o,u,f,x,C){let A=C?o.classBindings:o.styleBindings,N=Tl(A),G=wc(A);r[f]=u;let Se,oe=!1;if(Array.isArray(u)){const lt=u;Se=lt[1],(null===Se||v(lt,Se)>0)&&(oe=!0)}else Se=u;if(x)if(0!==G){const Vt=Tl(r[N+1]);r[f+1]=eh(Vt,N),0!==Vt&&(r[Vt+1]=tl(r[Vt+1],f)),r[N+1]=function id(r,o){return 131071&r|o<<17}(r[N+1],f)}else r[f+1]=eh(N,0),0!==N&&(r[N+1]=tl(r[N+1],f)),N=f;else r[f+1]=eh(G,0),0===N?N=f:r[G+1]=tl(r[G+1],f),G=f;oe&&(r[f+1]=th(r[f+1])),od(r,Se,f,!0),od(r,Se,f,!1),function Og(r,o,u,f,x){const C=x?r.residualClasses:r.residualStyles;null!=C&&"string"==typeof o&&v(C,o)>=0&&(u[f+1]=nh(u[f+1]))}(o,Se,r,f,C),A=eh(N,G),C?o.classBindings=A:o.styleBindings=A}(x,C,o,u,A,f)}}(C,r,A,f),o!==Ki&&Yo(x,A,o)&&function mn(r,o,u,f,x,C,A,N){if(!(3&o.type))return;const G=r.data,oe=G[N+1],Se=function $f(r){return 1==(1&r)}(oe)?Pn(G,o,u,x,wc(oe),A):void 0;sn(Se)||(sn(C)||function K_(r){return 2==(2&r)}(oe)&&(C=Pn(G,null,u,x,N,A)),function t_(r,o,u,f,x){if(o)x?r.addClass(u,f):r.removeClass(u,f);else{let C=-1===f.indexOf("-")?void 0:Os.DashCase;null==x?r.removeStyle(u,f,C):("string"==typeof x&&x.endsWith("!important")&&(x=x.slice(0,-10),C|=Os.Important),r.setStyle(u,f,x,C))}}(f,A,ji(_o(),u),x,C))}(C,C.data[_o()],x,x[11],r,x[A+1]=function vn(r,o){return null==r||("string"==typeof o?r+=o:"object"==typeof r&&(r=me(Nc(r)))),r}(o,u),f,A)}function ft(r,o,u,f,x){let C=null;const A=u.directiveEnd;let N=u.directiveStylingLast;for(-1===N?N=u.directiveStart:N++;N<A&&(C=o[N],f=At(f,C.hostAttrs,x),C!==r);)N++;return null!==r&&(u.directiveStylingLast=N),f}function At(r,o,u){const f=u?1:2;let x=-1;if(null!==o)for(let C=0;C<o.length;C++){const A=o[C];"number"==typeof A?x=A:x===f&&(Array.isArray(r)||(r=void 0===r?[]:["",r]),s(r,A,!!u||o[++C]))}return void 0===r?null:r}function Pn(r,o,u,f,x,C){const A=null===o;let N;for(;x>0;){const G=r[x],oe=Array.isArray(G),Se=oe?G[1]:G,lt=null===Se;let Vt=u[x+1];Vt===Ki&&(Vt=lt?zt:void 0);let an=lt?p(Vt,f):Se===f?Vt:void 0;if(oe&&!sn(an)&&(an=p(G,f)),sn(an)&&(N=an,A))return N;const In=r[x+1];x=A?Tl(In):wc(In)}if(null!==o){let G=C?o.residualClasses:o.residualStyles;null!=G&&(N=p(G,f))}return N}function sn(r){return void 0!==r}function Sn(r,o=""){const u=Dn(),f=Ji(),x=r+22,C=f.firstCreatePass?Hu(f,x,1,o,null):f.data[x],A=u[x]=function dh(r,o){return r.createText(o)}(u[11],o);ta(f,u,A,C),co(C,!1)}function On(r){return ln("",r,""),On}function ln(r,o,u){const f=Dn(),x=Qu(f,r,o,u);return x!==Ki&&Ws(f,_o(),x),ln}function $n(r,o,u,f,x){const C=Dn(),A=function wl(r,o,u,f,x,C){const N=bl(r,Z(),u,x);return ve(2),N?o+Ne(u)+f+Ne(x)+C:Ki}(C,r,o,u,f,x);return A!==Ki&&Ws(C,_o(),A),$n}function vi(r,o,u,f,x,C,A){const N=Dn(),G=yc(N,r,o,u,f,x,C,A);return G!==Ki&&Ws(N,_o(),G),vi}function Xn(r,o,u,f,x,C,A,N,G){const oe=Dn(),Se=ed(oe,r,o,u,f,x,C,A,N,G);return Se!==Ki&&Ws(oe,_o(),Se),Xn}const Yc=void 0;var Fg=["en",[["a","p"],["AM","PM"],Yc],[["AM","PM"],Yc,Yc],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],Yc,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],Yc,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",Yc,"{1} 'at' {0}",Yc],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function Lg(r){const u=Math.floor(Math.abs(r)),f=r.toString().replace(/^[^.]*\.?/,"").length;return 1===u&&0===f?1:5}];let Jc={};function nl(r){const o=function Wf(r){return r.toLowerCase().replace(/_/g,"-")}(r);let u=cp(o);if(u)return u;const f=o.split("-")[0];if(u=cp(f),u)return u;if("en"===f)return Fg;throw new ye(701,!1)}function Xc(r){return nl(r)[Mi.PluralCase]}function cp(r){return r in Jc||(Jc[r]=Qt.ng&&Qt.ng.common&&Qt.ng.common.locales&&Qt.ng.common.locales[r]),Jc[r]}var Mi=(()=>((Mi=Mi||{})[Mi.LocaleId=0]="LocaleId",Mi[Mi.DayPeriodsFormat=1]="DayPeriodsFormat",Mi[Mi.DayPeriodsStandalone=2]="DayPeriodsStandalone",Mi[Mi.DaysFormat=3]="DaysFormat",Mi[Mi.DaysStandalone=4]="DaysStandalone",Mi[Mi.MonthsFormat=5]="MonthsFormat",Mi[Mi.MonthsStandalone=6]="MonthsStandalone",Mi[Mi.Eras=7]="Eras",Mi[Mi.FirstDayOfWeek=8]="FirstDayOfWeek",Mi[Mi.WeekendRange=9]="WeekendRange",Mi[Mi.DateFormat=10]="DateFormat",Mi[Mi.TimeFormat=11]="TimeFormat",Mi[Mi.DateTimeFormat=12]="DateTimeFormat",Mi[Mi.NumberSymbols=13]="NumberSymbols",Mi[Mi.NumberFormats=14]="NumberFormats",Mi[Mi.CurrencyCode=15]="CurrencyCode",Mi[Mi.CurrencySymbol=16]="CurrencySymbol",Mi[Mi.CurrencyName=17]="CurrencyName",Mi[Mi.Currencies=18]="Currencies",Mi[Mi.Directionality=19]="Directionality",Mi[Mi.PluralCase=20]="PluralCase",Mi[Mi.ExtraData=21]="ExtraData",Mi))();const ls="en-US";let $y=ls;function oy(r,o,u,f,x){if(r=Ae(r),Array.isArray(r))for(let C=0;C<r.length;C++)oy(r[C],o,u,f,x);else{const C=Ji(),A=Dn();let N=_l(r)?r:Ae(r.provide),G=Rh(r);const oe=ro(),Se=1048575&oe.providerIndexes,lt=oe.directiveStart,Vt=oe.providerIndexes>>20;if(_l(r)||!r.multi){const an=new gr(G,x,yl),In=ay(N,o,x?Se:Se+Vt,lt);-1===In?(tc($a(oe,A),C,N),sy(C,r,o.length),o.push(N),oe.directiveStart++,oe.directiveEnd++,x&&(oe.providerIndexes+=1048576),u.push(an),A.push(an)):(u[In]=an,A[In]=an)}else{const an=ay(N,o,Se+Vt,lt),In=ay(N,o,Se,Se+Vt),Qn=an>=0&&u[an],ai=In>=0&&u[In];if(x&&!ai||!x&&!Qn){tc($a(oe,A),C,N);const bi=function kx(r,o,u,f,x){const C=new gr(r,u,yl);return C.multi=[],C.index=o,C.componentProviders=0,fv(C,x,f&&!u),C}(x?Fx:Lx,u.length,x,f,G);!x&&ai&&(u[In].providerFactory=bi),sy(C,r,o.length,0),o.push(N),oe.directiveStart++,oe.directiveEnd++,x&&(oe.providerIndexes+=1048576),u.push(bi),A.push(bi)}else sy(C,r,an>-1?an:In,fv(u[x?In:an],G,!x&&f));!x&&f&&ai&&u[In].componentProviders++}}}function sy(r,o,u,f){const x=_l(o),C=function Ah(r){return!!r.useClass}(o);if(x||C){const G=(C?Ae(o.useClass):o).prototype.ngOnDestroy;if(G){const oe=r.destroyHooks||(r.destroyHooks=[]);if(!x&&o.multi){const Se=oe.indexOf(u);-1===Se?oe.push(u,[f,G]):oe[Se+1].push(f,G)}else oe.push(u,G)}}}function fv(r,o,u){return u&&r.componentProviders++,r.multi.push(o)-1}function ay(r,o,u,f){for(let x=u;x<f;x++)if(o[x]===r)return x;return-1}function Lx(r,o,u,f){return ly(this.multi,[])}function Fx(r,o,u,f){const x=this.multi;let C;if(this.providerFactory){const A=this.providerFactory.componentProviders,N=po(u,u[1],this.providerFactory.index,f);C=N.slice(0,A),ly(x,C);for(let G=A;G<N.length;G++)C.push(N[G])}else C=[],ly(x,C);return C}function ly(r,o){for(let u=0;u<r.length;u++)o.push((0,r[u])());return o}function mv(r,o=[]){return u=>{u.providersResolver=(f,x)=>function Rx(r,o,u){const f=Ji();if(f.firstCreatePass){const x=Wr(r);oy(u,f.data,f.blueprint,x,!0),oy(o,f.data,f.blueprint,x,!1)}}(f,x?x(r):r,o)}}class up{}class gv{}function Bx(r,o){return new _v(r,o??null)}class _v extends up{constructor(o,u){super(),this._parent=u,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new fg(this);const f=hi(o);this._bootstrapComponents=pc(f.bootstrap),this._r3Injector=Hm(o,u,[{provide:up,useValue:this},{provide:hc,useValue:this.componentFactoryResolver}],me(o),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(o)}get injector(){return this._r3Injector}destroy(){const o=this._r3Injector;!o.destroyed&&o.destroy(),this.destroyCbs.forEach(u=>u()),this.destroyCbs=null}onDestroy(o){this.destroyCbs.push(o)}}class cy extends gv{constructor(o){super(),this.moduleType=o}create(o){return new _v(this.moduleType,o)}}class zx extends up{constructor(o,u,f){super(),this.componentFactoryResolver=new fg(this),this.instance=null;const x=new Sm([...o,{provide:up,useValue:this},{provide:hc,useValue:this.componentFactoryResolver}],u||Oh(),f,new Set(["environment"]));this.injector=x,x.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(o){this.injector.onDestroy(o)}}function uy(r,o,u=null){return new zx(r,o,u).injector}let Nx=(()=>{class r{constructor(u){this._injector=u,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(u){if(!u.standalone)return null;if(!this.cachedInjectors.has(u.id)){const f=Zp(0,u.type),x=f.length>0?uy([f],this._injector,`Standalone[${u.type.name}]`):null;this.cachedInjectors.set(u.id,x)}return this.cachedInjectors.get(u.id)}ngOnDestroy(){try{for(const u of this.cachedInjectors.values())null!==u&&u.destroy()}finally{this.cachedInjectors.clear()}}}return r.\u0275prov=ut({token:r,providedIn:"environment",factory:()=>new r(gn(au))}),r})();function yv(r){r.getStandaloneInjector=o=>o.get(Nx).getOrCreateStandaloneInjector(r)}function Ev(r,o,u){const f=E()+r,x=Dn();return x[f]===Ki?Fs(x,f,u?o.call(u):o()):function Wd(r,o){return r[o]}(x,f)}function Qf(r,o){const u=r[o];return u===Ki?void 0:u}function Pv(r,o){const u=Ji();let f;const x=r+22;u.firstCreatePass?(f=function i1(r,o){if(o)for(let u=o.length-1;u>=0;u--){const f=o[u];if(r===f.name)return f}}(o,u.pipeRegistry),u.data[x]=f,f.onDestroy&&(u.destroyHooks||(u.destroyHooks=[])).push(x,f.onDestroy)):f=u.data[x];const C=f.factory||(f.factory=ts(f.type)),A=re(yl);try{const N=Sl(!1),G=C();return Sl(N),function qc(r,o,u,f){u>=r.data.length&&(r.data[u]=null,r.blueprint[u]=null),o[u]=f}(u,Dn(),x,G),G}finally{re(A)}}function Ov(r,o,u){const f=r+22,x=Dn(),C=ms(x,f);return em(x,f)?function Dv(r,o,u,f,x,C){const A=o+u;return Yo(r,A,x)?Fs(r,A+1,C?f.call(C,x):f(x)):Qf(r,A+1)}(x,E(),o,C.transform,u,C):C.transform(u)}function Rv(r,o,u,f){const x=r+22,C=Dn(),A=ms(C,x);return em(C,x)?function Iv(r,o,u,f,x,C,A){const N=o+u;return bl(r,N,x,C)?Fs(r,N+2,A?f.call(A,x,C):f(x,C)):Qf(r,N+2)}(C,E(),o,A.transform,u,f,A):A.transform(u,f)}function em(r,o){return r[1].data[o].pure}function hy(r){return o=>{setTimeout(r,void 0,o)}}const Kc=class a1 extends h.x{constructor(o=!1){super(),this.__isAsync=o}emit(o){super.next(o)}subscribe(o,u,f){let x=o,C=u||(()=>null),A=f;if(o&&"object"==typeof o){const G=o;x=G.next?.bind(G),C=G.error?.bind(G),A=G.complete?.bind(G)}this.__isAsync&&(C=hy(C),x&&(x=hy(x)),A&&(A=hy(A)));const N=super.subscribe({next:x,error:C,complete:A});return o instanceof g.w0&&o.add(N),N}};function l1(){return this._results[Hc()]()}class py{constructor(o=!1){this._emitDistinctChangesOnly=o,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const u=Hc(),f=py.prototype;f[u]||(f[u]=l1)}get changes(){return this._changes||(this._changes=new Kc)}get(o){return this._results[o]}map(o){return this._results.map(o)}filter(o){return this._results.filter(o)}find(o){return this._results.find(o)}reduce(o,u){return this._results.reduce(o,u)}forEach(o){this._results.forEach(o)}some(o){return this._results.some(o)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(o,u){const f=this;f.dirty=!1;const x=function Ps(r){return r.flat(Number.POSITIVE_INFINITY)}(o);(this._changesDetected=!function Fc(r,o,u){if(r.length!==o.length)return!1;for(let f=0;f<r.length;f++){let x=r[f],C=o[f];if(u&&(x=u(x),C=u(C)),C!==x)return!1}return!0}(f._results,x,u))&&(f._results=x,f.length=x.length,f.last=x[this.length-1],f.first=x[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}let tm=(()=>{class r{}return r.__NG_ELEMENT_ID__=d1,r})();const c1=tm,u1=class extends c1{constructor(o,u,f){super(),this._declarationLView=o,this._declarationTContainer=u,this.elementRef=f}createEmbeddedView(o,u){const f=this._declarationTContainer.tViews,x=zh(this._declarationLView,f,o,16,null,f.declTNode,null,null,null,null,u||null);x[17]=this._declarationLView[this._declarationTContainer.index];const A=this._declarationLView[19];return null!==A&&(x[19]=A.createEmbeddedView(f)),ff(f,x,o),new Gc(x)}};function d1(){return Ug(ro(),Dn())}function Ug(r,o){return 4&r.type?new u1(o,r,jc(r,o)):null}let Vg=(()=>{class r{}return r.__NG_ELEMENT_ID__=h1,r})();function h1(){return kv(ro(),Dn())}const p1=Vg,Lv=class extends p1{constructor(o,u,f){super(),this._lContainer=o,this._hostTNode=u,this._hostLView=f}get element(){return jc(this._hostTNode,this._hostLView)}get injector(){return new Pl(this._hostTNode,this._hostLView)}get parentInjector(){const o=ec(this._hostTNode,this._hostLView);if(Xl(o)){const u=$o(o,this._hostLView),f=Va(o);return new Pl(u[1].data[f+8],u)}return new Pl(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(o){const u=Fv(this._lContainer);return null!==u&&u[o]||null}get length(){return this._lContainer.length-10}createEmbeddedView(o,u,f){let x,C;"number"==typeof f?x=f:null!=f&&(x=f.index,C=f.injector);const A=o.createEmbeddedView(u||{},C);return this.insert(A,x),A}createComponent(o,u,f,x,C){const A=o&&!function ll(r){return"function"==typeof r}(o);let N;if(A)N=u;else{const lt=u||{};N=lt.index,f=lt.injector,x=lt.projectableNodes,C=lt.environmentInjector||lt.ngModuleRef}const G=A?o:new fc(Oi(o)),oe=f||this.parentInjector;if(!C&&null==G.ngModule){const Vt=(A?oe:this.parentInjector).get(au,null);Vt&&(C=Vt)}const Se=G.create(oe,x,void 0,C);return this.insert(Se.hostView,N),Se}insert(o,u){const f=o._lView,x=f[1];if(function Ta(r){return So(r[3])}(f)){const Se=this.indexOf(o);if(-1!==Se)this.detach(Se);else{const lt=f[3],Vt=new Lv(lt,lt[6],lt[3]);Vt.detach(Vt.indexOf(o))}}const C=this._adjustIndex(u),A=this._lContainer;!function hl(r,o,u,f){const x=10+f,C=u.length;f>0&&(u[x-1][4]=o),f<C-10?(o[4]=u[x],tu(u,10+f,o)):(u.push(o),o[4]=null),o[3]=u;const A=o[17];null!==A&&u!==A&&function Bc(r,o){const u=r[9];o[16]!==o[3][3][16]&&(r[2]=!0),null===u?r[9]=[o]:u.push(o)}(A,o);const N=o[19];null!==N&&N.insertView(r),o[2]|=64}(x,f,A,C);const N=fh(C,A),G=f[11],oe=pl(G,A[7]);return null!==oe&&function md(r,o,u,f,x,C){f[0]=x,f[6]=o,Bl(r,f,u,1,x,C)}(x,A[6],G,f,oe,N),o.attachToViewContainerRef(),tu(fy(A),C,o),o}move(o,u){return this.insert(o,u)}indexOf(o){const u=Fv(this._lContainer);return null!==u?u.indexOf(o):-1}remove(o){const u=this._adjustIndex(o,-1),f=cc(this._lContainer,u);f&&(sc(fy(this._lContainer),u),dm(f[1],f))}detach(o){const u=this._adjustIndex(o,-1),f=cc(this._lContainer,u);return f&&null!=sc(fy(this._lContainer),u)?new Gc(f):null}_adjustIndex(o,u=0){return o??this.length+u}};function Fv(r){return r[8]}function fy(r){return r[8]||(r[8]=[])}function kv(r,o){let u;const f=o[r.index];if(So(f))u=f;else{let x;if(8&r.type)x=Tr(f);else{const C=o[11];x=C.createComment("");const A=zr(r,o);Ls(C,pl(C,A),x,function hh(r,o){return r.nextSibling(o)}(C,A),!1)}o[r.index]=u=fu(f,o,x,r),qh(o,u)}return new Lv(u,r,o)}class my{constructor(o){this.queryList=o,this.matches=null}clone(){return new my(this.queryList)}setDirty(){this.queryList.setDirty()}}class gy{constructor(o=[]){this.queries=o}createEmbeddedView(o){const u=o.queries;if(null!==u){const f=null!==o.contentQueries?o.contentQueries[0]:u.length,x=[];for(let C=0;C<f;C++){const A=u.getByIndex(C);x.push(this.queries[A.indexInDeclarationView].clone())}return new gy(x)}return null}insertView(o){this.dirtyQueriesWithMatches(o)}detachView(o){this.dirtyQueriesWithMatches(o)}dirtyQueriesWithMatches(o){for(let u=0;u<this.queries.length;u++)null!==Gv(o,u).matches&&this.queries[u].setDirty()}}class Bv{constructor(o,u,f=null){this.predicate=o,this.flags=u,this.read=f}}class _y{constructor(o=[]){this.queries=o}elementStart(o,u){for(let f=0;f<this.queries.length;f++)this.queries[f].elementStart(o,u)}elementEnd(o){for(let u=0;u<this.queries.length;u++)this.queries[u].elementEnd(o)}embeddedTView(o){let u=null;for(let f=0;f<this.length;f++){const x=null!==u?u.length:0,C=this.getByIndex(f).embeddedTView(o,x);C&&(C.indexInDeclarationView=f,null!==u?u.push(C):u=[C])}return null!==u?new _y(u):null}template(o,u){for(let f=0;f<this.queries.length;f++)this.queries[f].template(o,u)}getByIndex(o){return this.queries[o]}get length(){return this.queries.length}track(o){this.queries.push(o)}}class yy{constructor(o,u=-1){this.metadata=o,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=u}elementStart(o,u){this.isApplyingToNode(u)&&this.matchTNode(o,u)}elementEnd(o){this._declarationNodeIndex===o.index&&(this._appliesToNextNode=!1)}template(o,u){this.elementStart(o,u)}embeddedTView(o,u){return this.isApplyingToNode(o)?(this.crossesNgTemplate=!0,this.addMatch(-o.index,u),new yy(this.metadata)):null}isApplyingToNode(o){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const u=this._declarationNodeIndex;let f=o.parent;for(;null!==f&&8&f.type&&f.index!==u;)f=f.parent;return u===(null!==f?f.index:-1)}return this._appliesToNextNode}matchTNode(o,u){const f=this.metadata.predicate;if(Array.isArray(f))for(let x=0;x<f.length;x++){const C=f[x];this.matchTNodeWithReadOption(o,u,f1(u,C)),this.matchTNodeWithReadOption(o,u,Al(u,o,C,!1,!1))}else f===tm?4&u.type&&this.matchTNodeWithReadOption(o,u,-1):this.matchTNodeWithReadOption(o,u,Al(u,o,f,!1,!1))}matchTNodeWithReadOption(o,u,f){if(null!==f){const x=this.metadata.read;if(null!==x)if(x===Td||x===Vg||x===tm&&4&u.type)this.addMatch(u.index,-2);else{const C=Al(u,o,x,!1,!1);null!==C&&this.addMatch(u.index,C)}else this.addMatch(u.index,f)}}addMatch(o,u){null===this.matches?this.matches=[o,u]:this.matches.push(o,u)}}function f1(r,o){const u=r.localNames;if(null!==u)for(let f=0;f<u.length;f+=2)if(u[f]===o)return u[f+1];return null}function g1(r,o,u,f){return-1===u?function m1(r,o){return 11&r.type?jc(r,o):4&r.type?Ug(r,o):null}(o,r):-2===u?function _1(r,o,u){return u===Td?jc(o,r):u===tm?Ug(o,r):u===Vg?kv(o,r):void 0}(r,o,f):po(r,r[1],u,o)}function zv(r,o,u,f){const x=o[19].queries[f];if(null===x.matches){const C=r.data,A=u.matches,N=[];for(let G=0;G<A.length;G+=2){const oe=A[G];N.push(oe<0?null:g1(o,C[oe],A[G+1],u.metadata.read))}x.matches=N}return x.matches}function vy(r,o,u,f){const x=r.queries.getByIndex(u),C=x.matches;if(null!==C){const A=zv(r,o,x,u);for(let N=0;N<C.length;N+=2){const G=C[N];if(G>0)f.push(A[N/2]);else{const oe=C[N+1],Se=o[-G];for(let lt=10;lt<Se.length;lt++){const Vt=Se[lt];Vt[17]===Vt[3]&&vy(Vt[1],Vt,oe,f)}if(null!==Se[9]){const lt=Se[9];for(let Vt=0;Vt<lt.length;Vt++){const an=lt[Vt];vy(an[1],an,oe,f)}}}}}return f}function Nv(r){const o=Dn(),u=Ji(),f=ur();or(f+1);const x=Gv(u,f);if(r.dirty&&function ka(r){return 4==(4&r[2])}(o)===(2==(2&x.metadata.flags))){if(null===x.matches)r.reset([]);else{const C=x.crossesNgTemplate?vy(u,o,f,[]):zv(u,o,x,f);r.reset(C,Om),r.notifyOnChanges()}return!0}return!1}function Uv(r,o,u){const f=Ji();f.firstCreatePass&&(Zv(f,new Bv(r,o,u),-1),2==(2&o)&&(f.staticViewQueries=!0)),$v(f,Dn(),o)}function Vv(r,o,u,f){const x=Ji();if(x.firstCreatePass){const C=ro();Zv(x,new Bv(o,u,f),C.index),function v1(r,o){const u=r.contentQueries||(r.contentQueries=[]);o!==(u.length?u[u.length-1]:-1)&&u.push(r.queries.length-1,o)}(x,r),2==(2&u)&&(x.staticContentQueries=!0)}$v(x,Dn(),u)}function jv(){return function y1(r,o){return r[19].queries[o].queryList}(Dn(),ur())}function $v(r,o,u){const f=new py(4==(4&u));ga(r,o,f,f.destroy),null===o[19]&&(o[19]=new gy),o[19].queries.push(new my(f))}function Zv(r,o,u){null===r.queries&&(r.queries=new _y),r.queries.track(new yy(o,u))}function Gv(r,o){return r.queries.getByIndex(o)}function $g(...r){}const d0=new Ur("Application Initializer");let Zg=(()=>{class r{constructor(u){this.appInits=u,this.resolve=$g,this.reject=$g,this.initialized=!1,this.done=!1,this.donePromise=new Promise((f,x)=>{this.resolve=f,this.reject=x})}runInitializers(){if(this.initialized)return;const u=[],f=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let x=0;x<this.appInits.length;x++){const C=this.appInits[x]();if(Pf(C))u.push(C);else if(Sg(C)){const A=new Promise((N,G)=>{C.subscribe({complete:N,error:G})});u.push(A)}}Promise.all(u).then(()=>{f()}).catch(x=>{this.reject(x)}),0===u.length&&f(),this.initialized=!0}}return r.\u0275fac=function(u){return new(u||r)(gn(d0,8))},r.\u0275prov=ut({token:r,factory:r.\u0275fac,providedIn:"root"}),r})();const h0=new Ur("AppId",{providedIn:"root",factory:function p0(){return`${Ty()}${Ty()}${Ty()}`}});function Ty(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const f0=new Ur("Platform Initializer"),U1=new Ur("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),m0=new Ur("appBootstrapListener");let V1=(()=>{class r{log(u){console.log(u)}warn(u){console.warn(u)}}return r.\u0275fac=function(u){return new(u||r)},r.\u0275prov=ut({token:r,factory:r.\u0275fac,providedIn:"platform"}),r})();const Gg=new Ur("LocaleId",{providedIn:"root",factory:()=>le(Gg,Ht.Optional|Ht.SkipSelf)||function j1(){return typeof $localize<"u"&&$localize.locale||ls}()}),$1=new Ur("DefaultCurrencyCode",{providedIn:"root",factory:()=>"USD"});class Z1{constructor(o,u){this.ngModuleFactory=o,this.componentFactories=u}}let G1=(()=>{class r{compileModuleSync(u){return new cy(u)}compileModuleAsync(u){return Promise.resolve(this.compileModuleSync(u))}compileModuleAndAllComponentsSync(u){const f=this.compileModuleSync(u),C=pc(hi(u).declarations).reduce((A,N)=>{const G=Oi(N);return G&&A.push(new fc(G)),A},[]);return new Z1(f,C)}compileModuleAndAllComponentsAsync(u){return Promise.resolve(this.compileModuleAndAllComponentsSync(u))}clearCache(){}clearCacheFor(u){}getModuleId(u){}}return r.\u0275fac=function(u){return new(u||r)},r.\u0275prov=ut({token:r,factory:r.\u0275fac,providedIn:"root"}),r})();const q1=(()=>Promise.resolve(0))();function Ey(r){typeof Zone>"u"?q1.then(()=>{r&&r.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",r)}class Gl{constructor({enableLongStackTrace:o=!1,shouldCoalesceEventChangeDetection:u=!1,shouldCoalesceRunChangeDetection:f=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Kc(!1),this.onMicrotaskEmpty=new Kc(!1),this.onStable=new Kc(!1),this.onError=new Kc(!1),typeof Zone>"u")throw new ye(908,!1);Zone.assertZonePatched();const x=this;x._nesting=0,x._outer=x._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(x._inner=x._inner.fork(new Zone.TaskTrackingZoneSpec)),o&&Zone.longStackTraceZoneSpec&&(x._inner=x._inner.fork(Zone.longStackTraceZoneSpec)),x.shouldCoalesceEventChangeDetection=!f&&u,x.shouldCoalesceRunChangeDetection=f,x.lastRequestAnimationFrameId=-1,x.nativeRequestAnimationFrame=function Y1(){let r=Qt.requestAnimationFrame,o=Qt.cancelAnimationFrame;if(typeof Zone<"u"&&r&&o){const u=r[Zone.__symbol__("OriginalDelegate")];u&&(r=u);const f=o[Zone.__symbol__("OriginalDelegate")];f&&(o=f)}return{nativeRequestAnimationFrame:r,nativeCancelAnimationFrame:o}}().nativeRequestAnimationFrame,function K1(r){const o=()=>{!function X1(r){r.isCheckStableRunning||-1!==r.lastRequestAnimationFrameId||(r.lastRequestAnimationFrameId=r.nativeRequestAnimationFrame.call(Qt,()=>{r.fakeTopEventTask||(r.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{r.lastRequestAnimationFrameId=-1,Iy(r),r.isCheckStableRunning=!0,Dy(r),r.isCheckStableRunning=!1},void 0,()=>{},()=>{})),r.fakeTopEventTask.invoke()}),Iy(r))}(r)};r._inner=r._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(u,f,x,C,A,N)=>{try{return y0(r),u.invokeTask(x,C,A,N)}finally{(r.shouldCoalesceEventChangeDetection&&"eventTask"===C.type||r.shouldCoalesceRunChangeDetection)&&o(),v0(r)}},onInvoke:(u,f,x,C,A,N,G)=>{try{return y0(r),u.invoke(x,C,A,N,G)}finally{r.shouldCoalesceRunChangeDetection&&o(),v0(r)}},onHasTask:(u,f,x,C)=>{u.hasTask(x,C),f===x&&("microTask"==C.change?(r._hasPendingMicrotasks=C.microTask,Iy(r),Dy(r)):"macroTask"==C.change&&(r.hasPendingMacrotasks=C.macroTask))},onHandleError:(u,f,x,C)=>(u.handleError(x,C),r.runOutsideAngular(()=>r.onError.emit(C)),!1)})}(x)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!Gl.isInAngularZone())throw new ye(909,!1)}static assertNotInAngularZone(){if(Gl.isInAngularZone())throw new ye(909,!1)}run(o,u,f){return this._inner.run(o,u,f)}runTask(o,u,f,x){const C=this._inner,A=C.scheduleEventTask("NgZoneEvent: "+x,o,J1,$g,$g);try{return C.runTask(A,u,f)}finally{C.cancelTask(A)}}runGuarded(o,u,f){return this._inner.runGuarded(o,u,f)}runOutsideAngular(o){return this._outer.run(o)}}const J1={};function Dy(r){if(0==r._nesting&&!r.hasPendingMicrotasks&&!r.isStable)try{r._nesting++,r.onMicrotaskEmpty.emit(null)}finally{if(r._nesting--,!r.hasPendingMicrotasks)try{r.runOutsideAngular(()=>r.onStable.emit(null))}finally{r.isStable=!0}}}function Iy(r){r.hasPendingMicrotasks=!!(r._hasPendingMicrotasks||(r.shouldCoalesceEventChangeDetection||r.shouldCoalesceRunChangeDetection)&&-1!==r.lastRequestAnimationFrameId)}function y0(r){r._nesting++,r.isStable&&(r.isStable=!1,r.onUnstable.emit(null))}function v0(r){r._nesting--,Dy(r)}class Q1{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Kc,this.onMicrotaskEmpty=new Kc,this.onStable=new Kc,this.onError=new Kc}run(o,u,f){return o.apply(u,f)}runGuarded(o,u,f){return o.apply(u,f)}runOutsideAngular(o){return o()}runTask(o,u,f,x){return o.apply(u,f)}}const x0=new Ur(""),b0=new Ur("");let My,eb=(()=>{class r{constructor(u,f,x){this._ngZone=u,this.registry=f,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,My||(function tb(r){My=r}(x),x.addToWindow(f)),this._watchAngularEvents(),u.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{Gl.assertNotInAngularZone(),Ey(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())Ey(()=>{for(;0!==this._callbacks.length;){let u=this._callbacks.pop();clearTimeout(u.timeoutId),u.doneCb(this._didWork)}this._didWork=!1});else{let u=this.getPendingTasks();this._callbacks=this._callbacks.filter(f=>!f.updateCb||!f.updateCb(u)||(clearTimeout(f.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(u=>({source:u.source,creationLocation:u.creationLocation,data:u.data})):[]}addCallback(u,f,x){let C=-1;f&&f>0&&(C=setTimeout(()=>{this._callbacks=this._callbacks.filter(A=>A.timeoutId!==C),u(this._didWork,this.getPendingTasks())},f)),this._callbacks.push({doneCb:u,timeoutId:C,updateCb:x})}whenStable(u,f,x){if(x&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(u,f,x),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(u){this.registry.registerApplication(u,this)}unregisterApplication(u){this.registry.unregisterApplication(u)}findProviders(u,f,x){return[]}}return r.\u0275fac=function(u){return new(u||r)(gn(Gl),gn(w0),gn(b0))},r.\u0275prov=ut({token:r,factory:r.\u0275fac}),r})(),w0=(()=>{class r{constructor(){this._applications=new Map}registerApplication(u,f){this._applications.set(u,f)}unregisterApplication(u){this._applications.delete(u)}unregisterAllApplications(){this._applications.clear()}getTestability(u){return this._applications.get(u)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(u,f=!0){return My?.findTestabilityInTree(this,u,f)??null}}return r.\u0275fac=function(u){return new(u||r)},r.\u0275prov=ut({token:r,factory:r.\u0275fac,providedIn:"platform"}),r})(),cd=null;const C0=new Ur("AllowMultipleToken"),Sy=new Ur("PlatformDestroyListeners");class rb{constructor(o,u){this.name=o,this.token=u}}function E0(r,o,u=[]){const f=`Platform: ${o}`,x=new Ur(f);return(C=[])=>{let A=Ay();if(!A||A.injector.get(C0,!1)){const N=[...u,...C,{provide:x,useValue:!0}];r?r(N):function ob(r){if(cd&&!cd.get(C0,!1))throw new ye(400,!1);cd=r;const o=r.get(I0);(function T0(r){const o=r.get(f0,null);o&&o.forEach(u=>u())})(r)}(function D0(r=[],o){return cu.create({name:o,providers:[{provide:Ph,useValue:"platform"},{provide:Sy,useValue:new Set([()=>cd=null])},...r]})}(N,f))}return function ab(r){const o=Ay();if(!o)throw new ye(401,!1);return o}()}}function Ay(){return cd?.get(I0)??null}let I0=(()=>{class r{constructor(u){this._injector=u,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(u,f){const x=function S0(r,o){let u;return u="noop"===r?new Q1:("zone.js"===r?void 0:r)||new Gl(o),u}(f?.ngZone,function M0(r){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:!(!r||!r.ngZoneEventCoalescing)||!1,shouldCoalesceRunChangeDetection:!(!r||!r.ngZoneRunCoalescing)||!1}}(f)),C=[{provide:Gl,useValue:x}];return x.run(()=>{const A=cu.create({providers:C,parent:this.injector,name:u.moduleType.name}),N=u.create(A),G=N.injector.get(Ed,null);if(!G)throw new ye(402,!1);return x.runOutsideAngular(()=>{const oe=x.onError.subscribe({next:Se=>{G.handleError(Se)}});N.onDestroy(()=>{Wg(this._modules,N),oe.unsubscribe()})}),function A0(r,o,u){try{const f=u();return Pf(f)?f.catch(x=>{throw o.runOutsideAngular(()=>r.handleError(x)),x}):f}catch(f){throw o.runOutsideAngular(()=>r.handleError(f)),f}}(G,x,()=>{const oe=N.injector.get(Zg);return oe.runInitializers(),oe.donePromise.then(()=>(function Zy(r){Ut(r,"Expected localeId to be defined"),"string"==typeof r&&($y=r.toLowerCase().replace(/_/g,"-"))}(N.injector.get(Gg,ls)||ls),this._moduleDoBootstrap(N),N))})})}bootstrapModule(u,f=[]){const x=P0({},f);return function nb(r,o,u){const f=new cy(u);return Promise.resolve(f)}(0,0,u).then(C=>this.bootstrapModuleFactory(C,x))}_moduleDoBootstrap(u){const f=u.injector.get(Hg);if(u._bootstrapComponents.length>0)u._bootstrapComponents.forEach(x=>f.bootstrap(x));else{if(!u.instance.ngDoBootstrap)throw new ye(403,!1);u.instance.ngDoBootstrap(f)}this._modules.push(u)}onDestroy(u){this._destroyListeners.push(u)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new ye(404,!1);this._modules.slice().forEach(f=>f.destroy()),this._destroyListeners.forEach(f=>f());const u=this._injector.get(Sy,null);u&&(u.forEach(f=>f()),u.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}}return r.\u0275fac=function(u){return new(u||r)(gn(cu))},r.\u0275prov=ut({token:r,factory:r.\u0275fac,providedIn:"platform"}),r})();function P0(r,o){return Array.isArray(o)?o.reduce(P0,r):{...r,...o}}let Hg=(()=>{class r{constructor(u,f,x){this._zone=u,this._injector=f,this._exceptionHandler=x,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this._destroyed=!1,this._destroyListeners=[],this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const C=new ie.y(N=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{N.next(this._stable),N.complete()})}),A=new ie.y(N=>{let G;this._zone.runOutsideAngular(()=>{G=this._zone.onStable.subscribe(()=>{Gl.assertNotInAngularZone(),Ey(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,N.next(!0))})})});const oe=this._zone.onUnstable.subscribe(()=>{Gl.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{N.next(!1)}))});return()=>{G.unsubscribe(),oe.unsubscribe()}});this.isStable=function Ie(...r){const o=(0,y.yG)(r),u=(0,y._6)(r,1/0),f=r;return f.length?1===f.length?(0,Y.Xf)(f[0]):(0,c.J)(u)((0,fe.D)(f,o)):se.E}(C,A.pipe((0,Ge.B)()))}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(u,f){const x=u instanceof Cd;if(!this._injector.get(Zg).done)throw!x&&Ln(u),new ye(405,false);let A;A=x?u:this._injector.get(hc).resolveComponentFactory(u),this.componentTypes.push(A.componentType);const N=function ib(r){return r.isBoundToModule}(A)?void 0:this._injector.get(up),oe=A.create(cu.NULL,[],f||A.selector,N),Se=oe.location.nativeElement,lt=oe.injector.get(x0,null);return lt?.registerApplication(Se),oe.onDestroy(()=>{this.detachView(oe.hostView),Wg(this.components,oe),lt?.unregisterApplication(Se)}),this._loadComponent(oe),oe}tick(){if(this._runningTick)throw new ye(101,!1);try{this._runningTick=!0;for(let u of this._views)u.detectChanges()}catch(u){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(u))}finally{this._runningTick=!1}}attachView(u){const f=u;this._views.push(f),f.attachToAppRef(this)}detachView(u){const f=u;Wg(this._views,f),f.detachFromAppRef()}_loadComponent(u){this.attachView(u.hostView),this.tick(),this.components.push(u);const f=this._injector.get(m0,[]);f.push(...this._bootstrapListeners),f.forEach(x=>x(u))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(u=>u()),this._views.slice().forEach(u=>u.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(u){return this._destroyListeners.push(u),()=>Wg(this._destroyListeners,u)}destroy(){if(this._destroyed)throw new ye(406,!1);const u=this._injector;u.destroy&&!u.destroyed&&u.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}}return r.\u0275fac=function(u){return new(u||r)(gn(Gl),gn(au),gn(Ed))},r.\u0275prov=ut({token:r,factory:r.\u0275fac,providedIn:"root"}),r})();function Wg(r,o){const u=r.indexOf(o);u>-1&&r.splice(u,1)}function cb(){}let ub=(()=>{class r{}return r.__NG_ELEMENT_ID__=db,r})();function db(r){return function hb(r,o,u){if(so(r)&&!u){const f=Yr(r.index,o);return new Gc(f,f)}return 47&r.type?new Gc(o[16],o):null}(ro(),Dn(),16==(16&r))}class k0{constructor(){}supports(o){return Hd(o)}create(o){return new yb(o)}}const _b=(r,o)=>o;class yb{constructor(o){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=o||_b}forEachItem(o){let u;for(u=this._itHead;null!==u;u=u._next)o(u)}forEachOperation(o){let u=this._itHead,f=this._removalsHead,x=0,C=null;for(;u||f;){const A=!f||u&&u.currentIndex<z0(f,x,C)?u:f,N=z0(A,x,C),G=A.currentIndex;if(A===f)x--,f=f._nextRemoved;else if(u=u._next,null==A.previousIndex)x++;else{C||(C=[]);const oe=N-x,Se=G-x;if(oe!=Se){for(let Vt=0;Vt<oe;Vt++){const an=Vt<C.length?C[Vt]:C[Vt]=0,In=an+Vt;Se<=In&&In<oe&&(C[Vt]=an+1)}C[A.previousIndex]=Se-oe}}N!==G&&o(A,N,G)}}forEachPreviousItem(o){let u;for(u=this._previousItHead;null!==u;u=u._nextPrevious)o(u)}forEachAddedItem(o){let u;for(u=this._additionsHead;null!==u;u=u._nextAdded)o(u)}forEachMovedItem(o){let u;for(u=this._movesHead;null!==u;u=u._nextMoved)o(u)}forEachRemovedItem(o){let u;for(u=this._removalsHead;null!==u;u=u._nextRemoved)o(u)}forEachIdentityChange(o){let u;for(u=this._identityChangesHead;null!==u;u=u._nextIdentityChange)o(u)}diff(o){if(null==o&&(o=[]),!Hd(o))throw new ye(900,!1);return this.check(o)?this:null}onDestroy(){}check(o){this._reset();let x,C,A,u=this._itHead,f=!1;if(Array.isArray(o)){this.length=o.length;for(let N=0;N<this.length;N++)C=o[N],A=this._trackByFn(N,C),null!==u&&Object.is(u.trackById,A)?(f&&(u=this._verifyReinsertion(u,C,A,N)),Object.is(u.item,C)||this._addIdentityChange(u,C)):(u=this._mismatch(u,C,A,N),f=!0),u=u._next}else x=0,function wg(r,o){if(Array.isArray(r))for(let u=0;u<r.length;u++)o(r[u]);else{const u=r[Hc()]();let f;for(;!(f=u.next()).done;)o(f.value)}}(o,N=>{A=this._trackByFn(x,N),null!==u&&Object.is(u.trackById,A)?(f&&(u=this._verifyReinsertion(u,N,A,x)),Object.is(u.item,N)||this._addIdentityChange(u,N)):(u=this._mismatch(u,N,A,x),f=!0),u=u._next,x++}),this.length=x;return this._truncate(u),this.collection=o,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let o;for(o=this._previousItHead=this._itHead;null!==o;o=o._next)o._nextPrevious=o._next;for(o=this._additionsHead;null!==o;o=o._nextAdded)o.previousIndex=o.currentIndex;for(this._additionsHead=this._additionsTail=null,o=this._movesHead;null!==o;o=o._nextMoved)o.previousIndex=o.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(o,u,f,x){let C;return null===o?C=this._itTail:(C=o._prev,this._remove(o)),null!==(o=null===this._unlinkedRecords?null:this._unlinkedRecords.get(f,null))?(Object.is(o.item,u)||this._addIdentityChange(o,u),this._reinsertAfter(o,C,x)):null!==(o=null===this._linkedRecords?null:this._linkedRecords.get(f,x))?(Object.is(o.item,u)||this._addIdentityChange(o,u),this._moveAfter(o,C,x)):o=this._addAfter(new vb(u,f),C,x),o}_verifyReinsertion(o,u,f,x){let C=null===this._unlinkedRecords?null:this._unlinkedRecords.get(f,null);return null!==C?o=this._reinsertAfter(C,o._prev,x):o.currentIndex!=x&&(o.currentIndex=x,this._addToMoves(o,x)),o}_truncate(o){for(;null!==o;){const u=o._next;this._addToRemovals(this._unlink(o)),o=u}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(o,u,f){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(o);const x=o._prevRemoved,C=o._nextRemoved;return null===x?this._removalsHead=C:x._nextRemoved=C,null===C?this._removalsTail=x:C._prevRemoved=x,this._insertAfter(o,u,f),this._addToMoves(o,f),o}_moveAfter(o,u,f){return this._unlink(o),this._insertAfter(o,u,f),this._addToMoves(o,f),o}_addAfter(o,u,f){return this._insertAfter(o,u,f),this._additionsTail=null===this._additionsTail?this._additionsHead=o:this._additionsTail._nextAdded=o,o}_insertAfter(o,u,f){const x=null===u?this._itHead:u._next;return o._next=x,o._prev=u,null===x?this._itTail=o:x._prev=o,null===u?this._itHead=o:u._next=o,null===this._linkedRecords&&(this._linkedRecords=new B0),this._linkedRecords.put(o),o.currentIndex=f,o}_remove(o){return this._addToRemovals(this._unlink(o))}_unlink(o){null!==this._linkedRecords&&this._linkedRecords.remove(o);const u=o._prev,f=o._next;return null===u?this._itHead=f:u._next=f,null===f?this._itTail=u:f._prev=u,o}_addToMoves(o,u){return o.previousIndex===u||(this._movesTail=null===this._movesTail?this._movesHead=o:this._movesTail._nextMoved=o),o}_addToRemovals(o){return null===this._unlinkedRecords&&(this._unlinkedRecords=new B0),this._unlinkedRecords.put(o),o.currentIndex=null,o._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=o,o._prevRemoved=null):(o._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=o),o}_addIdentityChange(o,u){return o.item=u,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=o:this._identityChangesTail._nextIdentityChange=o,o}}class vb{constructor(o,u){this.item=o,this.trackById=u,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class xb{constructor(){this._head=null,this._tail=null}add(o){null===this._head?(this._head=this._tail=o,o._nextDup=null,o._prevDup=null):(this._tail._nextDup=o,o._prevDup=this._tail,o._nextDup=null,this._tail=o)}get(o,u){let f;for(f=this._head;null!==f;f=f._nextDup)if((null===u||u<=f.currentIndex)&&Object.is(f.trackById,o))return f;return null}remove(o){const u=o._prevDup,f=o._nextDup;return null===u?this._head=f:u._nextDup=f,null===f?this._tail=u:f._prevDup=u,null===this._head}}class B0{constructor(){this.map=new Map}put(o){const u=o.trackById;let f=this.map.get(u);f||(f=new xb,this.map.set(u,f)),f.add(o)}get(o,u){const x=this.map.get(o);return x?x.get(o,u):null}remove(o){const u=o.trackById;return this.map.get(u).remove(o)&&this.map.delete(u),o}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function z0(r,o,u){const f=r.previousIndex;if(null===f)return f;let x=0;return u&&f<u.length&&(x=u[f]),f+o+x}class N0{constructor(){}supports(o){return o instanceof Map||_c(o)}create(){return new bb}}class bb{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(o){let u;for(u=this._mapHead;null!==u;u=u._next)o(u)}forEachPreviousItem(o){let u;for(u=this._previousMapHead;null!==u;u=u._nextPrevious)o(u)}forEachChangedItem(o){let u;for(u=this._changesHead;null!==u;u=u._nextChanged)o(u)}forEachAddedItem(o){let u;for(u=this._additionsHead;null!==u;u=u._nextAdded)o(u)}forEachRemovedItem(o){let u;for(u=this._removalsHead;null!==u;u=u._nextRemoved)o(u)}diff(o){if(o){if(!(o instanceof Map||_c(o)))throw new ye(900,!1)}else o=new Map;return this.check(o)?this:null}onDestroy(){}check(o){this._reset();let u=this._mapHead;if(this._appendAfter=null,this._forEach(o,(f,x)=>{if(u&&u.key===x)this._maybeAddToChanges(u,f),this._appendAfter=u,u=u._next;else{const C=this._getOrCreateRecordForKey(x,f);u=this._insertBeforeOrAppend(u,C)}}),u){u._prev&&(u._prev._next=null),this._removalsHead=u;for(let f=u;null!==f;f=f._nextRemoved)f===this._mapHead&&(this._mapHead=null),this._records.delete(f.key),f._nextRemoved=f._next,f.previousValue=f.currentValue,f.currentValue=null,f._prev=null,f._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(o,u){if(o){const f=o._prev;return u._next=o,u._prev=f,o._prev=u,f&&(f._next=u),o===this._mapHead&&(this._mapHead=u),this._appendAfter=o,o}return this._appendAfter?(this._appendAfter._next=u,u._prev=this._appendAfter):this._mapHead=u,this._appendAfter=u,null}_getOrCreateRecordForKey(o,u){if(this._records.has(o)){const x=this._records.get(o);this._maybeAddToChanges(x,u);const C=x._prev,A=x._next;return C&&(C._next=A),A&&(A._prev=C),x._next=null,x._prev=null,x}const f=new wb(o);return this._records.set(o,f),f.currentValue=u,this._addToAdditions(f),f}_reset(){if(this.isDirty){let o;for(this._previousMapHead=this._mapHead,o=this._previousMapHead;null!==o;o=o._next)o._nextPrevious=o._next;for(o=this._changesHead;null!==o;o=o._nextChanged)o.previousValue=o.currentValue;for(o=this._additionsHead;null!=o;o=o._nextAdded)o.previousValue=o.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(o,u){Object.is(u,o.currentValue)||(o.previousValue=o.currentValue,o.currentValue=u,this._addToChanges(o))}_addToAdditions(o){null===this._additionsHead?this._additionsHead=this._additionsTail=o:(this._additionsTail._nextAdded=o,this._additionsTail=o)}_addToChanges(o){null===this._changesHead?this._changesHead=this._changesTail=o:(this._changesTail._nextChanged=o,this._changesTail=o)}_forEach(o,u){o instanceof Map?o.forEach(u):Object.keys(o).forEach(f=>u(o[f],f))}}class wb{constructor(o){this.key=o,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function U0(){return new Fy([new k0])}let Fy=(()=>{class r{constructor(u){this.factories=u}static create(u,f){if(null!=f){const x=f.factories.slice();u=u.concat(x)}return new r(u)}static extend(u){return{provide:r,useFactory:f=>r.create(u,f||U0()),deps:[[r,new Xe,new $e]]}}find(u){const f=this.factories.find(x=>x.supports(u));if(null!=f)return f;throw new ye(901,!1)}}return r.\u0275prov=ut({token:r,providedIn:"root",factory:U0}),r})();function V0(){return new ky([new N0])}let ky=(()=>{class r{constructor(u){this.factories=u}static create(u,f){if(f){const x=f.factories.slice();u=u.concat(x)}return new r(u)}static extend(u){return{provide:r,useFactory:f=>r.create(u,f||V0()),deps:[[r,new Xe,new $e]]}}find(u){const f=this.factories.find(x=>x.supports(u));if(f)return f;throw new ye(901,!1)}}return r.\u0275prov=ut({token:r,providedIn:"root",factory:V0}),r})();const Eb=E0(null,"core",[]);let Db=(()=>{class r{constructor(u){}}return r.\u0275fac=function(u){return new(u||r)(gn(Hg))},r.\u0275mod=ar({type:r}),r.\u0275inj=En({}),r})();function Ib(r){return"boolean"==typeof r?r:null!=r&&"false"!==r}},4006:(Rn,Dt,B)=>{"use strict";B.d(Dt,{Fd:()=>bs,Fj:()=>Ze,JJ:()=>_i,JU:()=>fe,On:()=>ki,a5:()=>En,qQ:()=>Wo,u5:()=>Es,wV:()=>tr});var h=B(8274),g=B(6895),ie=B(2076),c=B(4128),Y=B(4004);let se=(()=>{class ee{constructor(q,Te){this._renderer=q,this._elementRef=Te,this.onChange=dn=>{},this.onTouched=()=>{}}setProperty(q,Te){this._renderer.setProperty(this._elementRef.nativeElement,q,Te)}registerOnTouched(q){this.onTouched=q}registerOnChange(q){this.onChange=q}setDisabledState(q){this.setProperty("disabled",q)}}return ee.\u0275fac=function(q){return new(q||ee)(h.Y36(h.Qsj),h.Y36(h.SBq))},ee.\u0275dir=h.lG2({type:ee}),ee})(),y=(()=>{class ee extends se{}return ee.\u0275fac=function(){let X;return function(Te){return(X||(X=h.n5z(ee)))(Te||ee)}}(),ee.\u0275dir=h.lG2({type:ee,features:[h.qOj]}),ee})();const fe=new h.OlP("NgValueAccessor"),Q={provide:fe,useExisting:(0,h.Gpc)(()=>Ze),multi:!0},me=new h.OlP("CompositionEventMode");let Ze=(()=>{class ee extends se{constructor(q,Te,dn){super(q,Te),this._compositionMode=dn,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function be(){const ee=(0,g.q)()?(0,g.q)().getUserAgent():"";return/android (\d+)/.test(ee.toLowerCase())}())}writeValue(q){this.setProperty("value",q??"")}_handleInput(q){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(q)}_compositionStart(){this._composing=!0}_compositionEnd(q){this._composing=!1,this._compositionMode&&this.onChange(q)}}return ee.\u0275fac=function(q){return new(q||ee)(h.Y36(h.Qsj),h.Y36(h.SBq),h.Y36(me,8))},ee.\u0275dir=h.lG2({type:ee,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(q,Te){1&q&&h.NdJ("input",function(ti){return Te._handleInput(ti.target.value)})("blur",function(){return Te.onTouched()})("compositionstart",function(){return Te._compositionStart()})("compositionend",function(ti){return Te._compositionEnd(ti.target.value)})},features:[h._Bn([Q]),h.qOj]}),ee})();function Ke(ee){return null==ee||("string"==typeof ee||Array.isArray(ee))&&0===ee.length}const te=new h.OlP("NgValidators"),Qe=new h.OlP("NgAsyncValidators");function ae(ee){return null}function Ee(ee){return null!=ee}function vt(ee){return(0,h.QGY)(ee)?(0,ie.D)(ee):ee}function Et(ee){let X={};return ee.forEach(q=>{X=null!=q?{...X,...q}:X}),0===Object.keys(X).length?null:X}function qt(ee,X){return X.map(q=>q(ee))}function xt(ee){return ee.map(X=>function Ft(ee){return!ee.validate}(X)?X:q=>X.validate(q))}function bt(ee){return null!=ee?function Pt(ee){if(!ee)return null;const X=ee.filter(Ee);return 0==X.length?null:function(q){return Et(qt(q,X))}}(xt(ee)):null}function ht(ee){return null!=ee?function ct(ee){if(!ee)return null;const X=ee.filter(Ee);return 0==X.length?null:function(q){const Te=qt(q,X).map(vt);return(0,c.D)(Te).pipe((0,Y.U)(Et))}}(xt(ee)):null}function Ce(ee,X){return null===ee?[X]:Array.isArray(ee)?[...ee,X]:[ee,X]}function Gt(ee){return ee?Array.isArray(ee)?ee:[ee]:[]}function wn(ee,X){return Array.isArray(ee)?ee.includes(X):ee===X}function Fn(ee,X){const q=Gt(X);return Gt(ee).forEach(dn=>{wn(q,dn)||q.push(dn)}),q}function un(ee,X){return Gt(X).filter(q=>!wn(ee,q))}class ut{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(X){this._rawValidators=X||[],this._composedValidatorFn=bt(this._rawValidators)}_setAsyncValidators(X){this._rawAsyncValidators=X||[],this._composedAsyncValidatorFn=ht(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(X){this._onDestroyCallbacks.push(X)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(X=>X()),this._onDestroyCallbacks=[]}reset(X){this.control&&this.control.reset(X)}hasError(X,q){return!!this.control&&this.control.hasError(X,q)}getError(X,q){return this.control?this.control.getError(X,q):null}}class jt extends ut{get formDirective(){return null}get path(){return null}}class En extends ut{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class ni{constructor(X){this._cd=X}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}}let _i=(()=>{class ee extends ni{constructor(q){super(q)}}return ee.\u0275fac=function(q){return new(q||ee)(h.Y36(En,2))},ee.\u0275dir=h.lG2({type:ee,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(q,Te){2&q&&h.ekj("ng-untouched",Te.isUntouched)("ng-touched",Te.isTouched)("ng-pristine",Te.isPristine)("ng-dirty",Te.isDirty)("ng-valid",Te.isValid)("ng-invalid",Te.isInvalid)("ng-pending",Te.isPending)},features:[h.qOj]}),ee})();const br="VALID",wr="INVALID",Er="PENDING",ui="DISABLED";function Ve(ee){return null!=ee&&!Array.isArray(ee)&&"object"==typeof ee}class j{constructor(X,q){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(X),this._assignAsyncValidators(q)}get validator(){return this._composedValidatorFn}set validator(X){this._rawValidators=this._composedValidatorFn=X}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(X){this._rawAsyncValidators=this._composedAsyncValidatorFn=X}get parent(){return this._parent}get valid(){return this.status===br}get invalid(){return this.status===wr}get pending(){return this.status==Er}get disabled(){return this.status===ui}get enabled(){return this.status!==ui}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(X){this._assignValidators(X)}setAsyncValidators(X){this._assignAsyncValidators(X)}addValidators(X){this.setValidators(Fn(X,this._rawValidators))}addAsyncValidators(X){this.setAsyncValidators(Fn(X,this._rawAsyncValidators))}removeValidators(X){this.setValidators(un(X,this._rawValidators))}removeAsyncValidators(X){this.setAsyncValidators(un(X,this._rawAsyncValidators))}hasValidator(X){return wn(this._rawValidators,X)}hasAsyncValidator(X){return wn(this._rawAsyncValidators,X)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(X={}){this.touched=!0,this._parent&&!X.onlySelf&&this._parent.markAsTouched(X)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(X=>X.markAllAsTouched())}markAsUntouched(X={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(q=>{q.markAsUntouched({onlySelf:!0})}),this._parent&&!X.onlySelf&&this._parent._updateTouched(X)}markAsDirty(X={}){this.pristine=!1,this._parent&&!X.onlySelf&&this._parent.markAsDirty(X)}markAsPristine(X={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(q=>{q.markAsPristine({onlySelf:!0})}),this._parent&&!X.onlySelf&&this._parent._updatePristine(X)}markAsPending(X={}){this.status=Er,!1!==X.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!X.onlySelf&&this._parent.markAsPending(X)}disable(X={}){const q=this._parentMarkedDirty(X.onlySelf);this.status=ui,this.errors=null,this._forEachChild(Te=>{Te.disable({...X,onlySelf:!0})}),this._updateValue(),!1!==X.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors({...X,skipPristineCheck:q}),this._onDisabledChange.forEach(Te=>Te(!0))}enable(X={}){const q=this._parentMarkedDirty(X.onlySelf);this.status=br,this._forEachChild(Te=>{Te.enable({...X,onlySelf:!0})}),this.updateValueAndValidity({onlySelf:!0,emitEvent:X.emitEvent}),this._updateAncestors({...X,skipPristineCheck:q}),this._onDisabledChange.forEach(Te=>Te(!1))}_updateAncestors(X){this._parent&&!X.onlySelf&&(this._parent.updateValueAndValidity(X),X.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(X){this._parent=X}getRawValue(){return this.value}updateValueAndValidity(X={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===br||this.status===Er)&&this._runAsyncValidator(X.emitEvent)),!1!==X.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!X.onlySelf&&this._parent.updateValueAndValidity(X)}_updateTreeValidity(X={emitEvent:!0}){this._forEachChild(q=>q._updateTreeValidity(X)),this.updateValueAndValidity({onlySelf:!0,emitEvent:X.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?ui:br}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(X){if(this.asyncValidator){this.status=Er,this._hasOwnPendingAsyncValidator=!0;const q=vt(this.asyncValidator(this));this._asyncValidationSubscription=q.subscribe(Te=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(Te,{emitEvent:X})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(X,q={}){this.errors=X,this._updateControlsErrors(!1!==q.emitEvent)}get(X){let q=X;return null==q||(Array.isArray(q)||(q=q.split(".")),0===q.length)?null:q.reduce((Te,dn)=>Te&&Te._find(dn),this)}getError(X,q){const Te=q?this.get(q):this;return Te&&Te.errors?Te.errors[X]:null}hasError(X,q){return!!this.getError(X,q)}get root(){let X=this;for(;X._parent;)X=X._parent;return X}_updateControlsErrors(X){this.status=this._calculateStatus(),X&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(X)}_initObservables(){this.valueChanges=new h.vpe,this.statusChanges=new h.vpe}_calculateStatus(){return this._allControlsDisabled()?ui:this.errors?wr:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(Er)?Er:this._anyControlsHaveStatus(wr)?wr:br}_anyControlsHaveStatus(X){return this._anyControls(q=>q.status===X)}_anyControlsDirty(){return this._anyControls(X=>X.dirty)}_anyControlsTouched(){return this._anyControls(X=>X.touched)}_updatePristine(X={}){this.pristine=!this._anyControlsDirty(),this._parent&&!X.onlySelf&&this._parent._updatePristine(X)}_updateTouched(X={}){this.touched=this._anyControlsTouched(),this._parent&&!X.onlySelf&&this._parent._updateTouched(X)}_registerOnCollectionChange(X){this._onCollectionChange=X}_setUpdateStrategy(X){Ve(X)&&null!=X.updateOn&&(this._updateOn=X.updateOn)}_parentMarkedDirty(X){return!X&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}_find(X){return null}_assignValidators(X){this._rawValidators=Array.isArray(X)?X.slice():X,this._composedValidatorFn=function _t(ee){return Array.isArray(ee)?bt(ee):ee||null}(this._rawValidators)}_assignAsyncValidators(X){this._rawAsyncValidators=Array.isArray(X)?X.slice():X,this._composedAsyncValidatorFn=function gn(ee){return Array.isArray(ee)?ht(ee):ee||null}(this._rawAsyncValidators)}}const at=new h.OlP("CallSetDisabledState",{providedIn:"root",factory:()=>Pe}),Pe="always";function Re(ee,X,q=Pe){(function Mn(ee,X){const q=function Ct(ee){return ee._rawValidators}(ee);null!==X.validator?ee.setValidators(Ce(q,X.validator)):"function"==typeof q&&ee.setValidators([q]);const Te=function Ut(ee){return ee._rawAsyncValidators}(ee);null!==X.asyncValidator?ee.setAsyncValidators(Ce(Te,X.asyncValidator)):"function"==typeof Te&&ee.setAsyncValidators([Te]);const dn=()=>ee.updateValueAndValidity();zt(X._rawValidators,dn),zt(X._rawAsyncValidators,dn)})(ee,X),X.valueAccessor.writeValue(ee.value),(ee.disabled||"always"===q)&&X.valueAccessor.setDisabledState?.(ee.disabled),function di(ee,X){X.valueAccessor.registerOnChange(q=>{ee._pendingValue=q,ee._pendingChange=!0,ee._pendingDirty=!0,"change"===ee.updateOn&&Kn(ee,X)})}(ee,X),function Vi(ee,X){const q=(Te,dn)=>{X.valueAccessor.writeValue(Te),dn&&X.viewToModelUpdate(Te)};ee.registerOnChange(q),X._registerOnDestroy(()=>{ee._unregisterOnChange(q)})}(ee,X),function gi(ee,X){X.valueAccessor.registerOnTouched(()=>{ee._pendingTouched=!0,"blur"===ee.updateOn&&ee._pendingChange&&Kn(ee,X),"submit"!==ee.updateOn&&ee.markAsTouched()})}(ee,X),function _n(ee,X){if(X.valueAccessor.setDisabledState){const q=Te=>{X.valueAccessor.setDisabledState(Te)};ee.registerOnDisabledChange(q),X._registerOnDestroy(()=>{ee._unregisterOnDisabledChange(q)})}}(ee,X)}function zt(ee,X){ee.forEach(q=>{q.registerOnValidatorChange&&q.registerOnValidatorChange(X)})}function Kn(ee,X){ee._pendingDirty&&ee.markAsDirty(),ee.setValue(ee._pendingValue,{emitModelToViewChange:!1}),X.viewToModelUpdate(ee._pendingValue),ee._pendingChange=!1}function xe(ee,X){const q=ee.indexOf(X);q>-1&&ee.splice(q,1)}function Oe(ee){return"object"==typeof ee&&null!==ee&&2===Object.keys(ee).length&&"value"in ee&&"disabled"in ee}const Lt=class extends j{constructor(X=null,q,Te){super(function pn(ee){return(Ve(ee)?ee.validators:ee)||null}(q),function kt(ee,X){return(Ve(X)?X.asyncValidators:ee)||null}(Te,q)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(X),this._setUpdateStrategy(q),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),Ve(q)&&(q.nonNullable||q.initialValueIsDefault)&&(this.defaultValue=Oe(X)?X.value:X)}setValue(X,q={}){this.value=this._pendingValue=X,this._onChange.length&&!1!==q.emitModelToViewChange&&this._onChange.forEach(Te=>Te(this.value,!1!==q.emitViewToModelChange)),this.updateValueAndValidity(q)}patchValue(X,q={}){this.setValue(X,q)}reset(X=this.defaultValue,q={}){this._applyFormState(X),this.markAsPristine(q),this.markAsUntouched(q),this.setValue(this.value,q),this._pendingChange=!1}_updateValue(){}_anyControls(X){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(X){this._onChange.push(X)}_unregisterOnChange(X){xe(this._onChange,X)}registerOnDisabledChange(X){this._onDisabledChange.push(X)}_unregisterOnDisabledChange(X){xe(this._onDisabledChange,X)}_forEachChild(X){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(X){Oe(X)?(this.value=this._pendingValue=X.value,X.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=X}},Ci={provide:En,useExisting:(0,h.Gpc)(()=>ki)},qi=(()=>Promise.resolve())();let ki=(()=>{class ee extends En{constructor(q,Te,dn,ti,Nr,lo){super(),this._changeDetectorRef=Nr,this.callSetDisabledState=lo,this.control=new Lt,this._registered=!1,this.update=new h.vpe,this._parent=q,this._setValidators(Te),this._setAsyncValidators(dn),this.valueAccessor=function lr(ee,X){if(!X)return null;let q,Te,dn;return Array.isArray(X),X.forEach(ti=>{ti.constructor===Ze?q=ti:function Br(ee){return Object.getPrototypeOf(ee.constructor)===y}(ti)?Te=ti:dn=ti}),dn||Te||q||null}(0,ti)}ngOnChanges(q){if(this._checkForErrors(),!this._registered||"name"in q){if(this._registered&&(this._checkName(),this.formDirective)){const Te=q.name.previousValue;this.formDirective.removeControl({name:Te,path:this._getPath(Te)})}this._setUpControl()}"isDisabled"in q&&this._updateDisabled(q),function zo(ee,X){if(!ee.hasOwnProperty("model"))return!1;const q=ee.model;return!!q.isFirstChange()||!Object.is(X,q.currentValue)}(q,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(q){this.viewModel=q,this.update.emit(q)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){Re(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(q){qi.then(()=>{this.control.setValue(q,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(q){const Te=q.isDisabled.currentValue,dn=0!==Te&&(0,h.D6c)(Te);qi.then(()=>{dn&&!this.control.disabled?this.control.disable():!dn&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(q){return this._parent?function Ue(ee,X){return[...X.path,ee]}(q,this._parent):[q]}}return ee.\u0275fac=function(q){return new(q||ee)(h.Y36(jt,9),h.Y36(te,10),h.Y36(Qe,10),h.Y36(fe,10),h.Y36(h.sBO,8),h.Y36(at,8))},ee.\u0275dir=h.lG2({type:ee,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[h._Bn([Ci]),h.qOj,h.TTD]}),ee})();const Rr={provide:fe,useExisting:(0,h.Gpc)(()=>tr),multi:!0};let tr=(()=>{class ee extends y{writeValue(q){this.setProperty("value",q??"")}registerOnChange(q){this.onChange=Te=>{q(""==Te?null:parseFloat(Te))}}}return ee.\u0275fac=function(){let X;return function(Te){return(X||(X=h.n5z(ee)))(Te||ee)}}(),ee.\u0275dir=h.lG2({type:ee,selectors:[["input","type","number","formControlName",""],["input","type","number","formControl",""],["input","type","number","ngModel",""]],hostBindings:function(q,Te){1&q&&h.NdJ("input",function(ti){return Te.onChange(ti.target.value)})("blur",function(){return Te.onTouched()})},features:[h._Bn([Rr]),h.qOj]}),ee})(),mr=(()=>{class ee{}return ee.\u0275fac=function(q){return new(q||ee)},ee.\u0275mod=h.oAB({type:ee}),ee.\u0275inj=h.cJS({}),ee})();function il(ee){return"number"==typeof ee?ee:parseFloat(ee)}let Uo=(()=>{class ee{constructor(){this._validator=ae}ngOnChanges(q){if(this.inputName in q){const Te=this.normalizeInput(q[this.inputName].currentValue);this._enabled=this.enabled(Te),this._validator=this._enabled?this.createValidator(Te):ae,this._onChange&&this._onChange()}}validate(q){return this._validator(q)}registerOnValidatorChange(q){this._onChange=q}enabled(q){return null!=q}}return ee.\u0275fac=function(q){return new(q||ee)},ee.\u0275dir=h.lG2({type:ee,features:[h.TTD]}),ee})();const Fa={provide:te,useExisting:(0,h.Gpc)(()=>bs),multi:!0};let bs=(()=>{class ee extends Uo{constructor(){super(...arguments),this.inputName="max",this.normalizeInput=q=>il(q),this.createValidator=q=>function Fe(ee){return X=>{if(Ke(X.value)||Ke(ee))return null;const q=parseFloat(X.value);return!isNaN(q)&&q>ee?{max:{max:ee,actual:X.value}}:null}}(q)}}return ee.\u0275fac=function(){let X;return function(Te){return(X||(X=h.n5z(ee)))(Te||ee)}}(),ee.\u0275dir=h.lG2({type:ee,selectors:[["input","type","number","max","","formControlName",""],["input","type","number","max","","formControl",""],["input","type","number","max","","ngModel",""]],hostVars:1,hostBindings:function(q,Te){2&q&&h.uIk("max",Te._enabled?Te.max:null)},inputs:{max:"max"},features:[h._Bn([Fa]),h.qOj]}),ee})();const aa={provide:te,useExisting:(0,h.Gpc)(()=>Wo),multi:!0};let Wo=(()=>{class ee extends Uo{constructor(){super(...arguments),this.inputName="min",this.normalizeInput=q=>il(q),this.createValidator=q=>function ye(ee){return X=>{if(Ke(X.value)||Ke(ee))return null;const q=parseFloat(X.value);return!isNaN(q)&&q<ee?{min:{min:ee,actual:X.value}}:null}}(q)}}return ee.\u0275fac=function(){let X;return function(Te){return(X||(X=h.n5z(ee)))(Te||ee)}}(),ee.\u0275dir=h.lG2({type:ee,selectors:[["input","type","number","min","","formControlName",""],["input","type","number","min","","formControl",""],["input","type","number","min","","ngModel",""]],hostVars:1,hostBindings:function(q,Te){2&q&&h.uIk("min",Te._enabled?Te.min:null)},inputs:{min:"min"},features:[h._Bn([aa]),h.qOj]}),ee})(),Tr=(()=>{class ee{}return ee.\u0275fac=function(q){return new(q||ee)},ee.\u0275mod=h.oAB({type:ee}),ee.\u0275inj=h.cJS({imports:[mr]}),ee})(),Es=(()=>{class ee{static withConfig(q){return{ngModule:ee,providers:[{provide:at,useValue:q.callSetDisabledState??Pe}]}}}return ee.\u0275fac=function(q){return new(q||ee)},ee.\u0275mod=h.oAB({type:ee}),ee.\u0275inj=h.cJS({imports:[Tr]}),ee})()},1481:(Rn,Dt,B)=>{"use strict";B.d(Dt,{Dx:()=>Ht,b2:()=>xi,q6:()=>ci});var h=B(6895),g=B(8274);class ie extends h.w_{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class c extends ie{static makeCurrent(){(0,h.HT)(new c)}onAndCancel(Ue,Re,nt){return Ue.addEventListener(Re,nt,!1),()=>{Ue.removeEventListener(Re,nt,!1)}}dispatchEvent(Ue,Re){Ue.dispatchEvent(Re)}remove(Ue){Ue.parentNode&&Ue.parentNode.removeChild(Ue)}createElement(Ue,Re){return(Re=Re||this.getDefaultDocument()).createElement(Ue)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(Ue){return Ue.nodeType===Node.ELEMENT_NODE}isShadowRoot(Ue){return Ue instanceof DocumentFragment}getGlobalEventTarget(Ue,Re){return"window"===Re?window:"document"===Re?Ue:"body"===Re?Ue.body:null}getBaseHref(Ue){const Re=function se(){return Y=Y||document.querySelector("base"),Y?Y.getAttribute("href"):null}();return null==Re?null:function fe(Pe){y=y||document.createElement("a"),y.setAttribute("href",Pe);const Ue=y.pathname;return"/"===Ue.charAt(0)?Ue:`/${Ue}`}(Re)}resetBaseElement(){Y=null}getUserAgent(){return window.navigator.userAgent}getCookie(Ue){return(0,h.Mx)(document.cookie,Ue)}}let y,Y=null;const Ie=new g.OlP("TRANSITION_ID"),Q=[{provide:g.ip1,useFactory:function Ge(Pe,Ue,Re){return()=>{Re.get(g.CZH).donePromise.then(()=>{const nt=(0,h.q)(),zt=Ue.querySelectorAll(`style[ng-transition="${Pe}"]`);for(let _n=0;_n<zt.length;_n++)nt.remove(zt[_n])})}},deps:[Ie,h.K0,g.zs3],multi:!0}];let me=(()=>{class Pe{build(){return new XMLHttpRequest}}return Pe.\u0275fac=function(Re){return new(Re||Pe)},Pe.\u0275prov=g.Yz7({token:Pe,factory:Pe.\u0275fac}),Pe})();const Ze=new g.OlP("EventManagerPlugins");let he=(()=>{class Pe{constructor(Re,nt){this._zone=nt,this._eventNameToPlugin=new Map,Re.forEach(zt=>zt.manager=this),this._plugins=Re.slice().reverse()}addEventListener(Re,nt,zt){return this._findPluginFor(nt).addEventListener(Re,nt,zt)}addGlobalEventListener(Re,nt,zt){return this._findPluginFor(nt).addGlobalEventListener(Re,nt,zt)}getZone(){return this._zone}_findPluginFor(Re){const nt=this._eventNameToPlugin.get(Re);if(nt)return nt;const zt=this._plugins;for(let _n=0;_n<zt.length;_n++){const Mn=zt[_n];if(Mn.supports(Re))return this._eventNameToPlugin.set(Re,Mn),Mn}throw new Error(`No event manager plugin found for event ${Re}`)}}return Pe.\u0275fac=function(Re){return new(Re||Pe)(g.LFG(Ze),g.LFG(g.R0b))},Pe.\u0275prov=g.Yz7({token:Pe,factory:Pe.\u0275fac}),Pe})();class Ke{constructor(Ue){this._doc=Ue}addGlobalEventListener(Ue,Re,nt){const zt=(0,h.q)().getGlobalEventTarget(this._doc,Ue);if(!zt)throw new Error(`Unsupported event target ${zt} for event ${Re}`);return this.addEventListener(zt,Re,nt)}}let Ae=(()=>{class Pe{constructor(){this._stylesSet=new Set}addStyles(Re){const nt=new Set;Re.forEach(zt=>{this._stylesSet.has(zt)||(this._stylesSet.add(zt),nt.add(zt))}),this.onStylesAdded(nt)}onStylesAdded(Re){}getAllStyles(){return Array.from(this._stylesSet)}}return Pe.\u0275fac=function(Re){return new(Re||Pe)},Pe.\u0275prov=g.Yz7({token:Pe,factory:Pe.\u0275fac}),Pe})(),te=(()=>{class Pe extends Ae{constructor(Re){super(),this._doc=Re,this._hostNodes=new Map,this._hostNodes.set(Re.head,[])}_addStylesToHost(Re,nt,zt){Re.forEach(_n=>{const Mn=this._doc.createElement("style");Mn.textContent=_n,zt.push(nt.appendChild(Mn))})}addHost(Re){const nt=[];this._addStylesToHost(this._stylesSet,Re,nt),this._hostNodes.set(Re,nt)}removeHost(Re){const nt=this._hostNodes.get(Re);nt&&nt.forEach(Qe),this._hostNodes.delete(Re)}onStylesAdded(Re){this._hostNodes.forEach((nt,zt)=>{this._addStylesToHost(Re,zt,nt)})}ngOnDestroy(){this._hostNodes.forEach(Re=>Re.forEach(Qe))}}return Pe.\u0275fac=function(Re){return new(Re||Pe)(g.LFG(h.K0))},Pe.\u0275prov=g.Yz7({token:Pe,factory:Pe.\u0275fac}),Pe})();function Qe(Pe){(0,h.q)().remove(Pe)}const Ot={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},dt=/%COMP%/g;function _e(Pe,Ue){return Ue.flat(100).map(Re=>Re.replace(dt,Pe))}function pe(Pe){return Ue=>{if("__ngUnwrap__"===Ue)return Pe;!1===Pe(Ue)&&(Ue.preventDefault(),Ue.returnValue=!1)}}let Ee=(()=>{class Pe{constructor(Re,nt,zt){this.eventManager=Re,this.sharedStylesHost=nt,this.appId=zt,this.rendererByCompId=new Map,this.defaultRenderer=new vt(Re)}createRenderer(Re,nt){if(!Re||!nt)return this.defaultRenderer;switch(nt.encapsulation){case g.ifc.Emulated:{let zt=this.rendererByCompId.get(nt.id);return zt||(zt=new xt(this.eventManager,this.sharedStylesHost,nt,this.appId),this.rendererByCompId.set(nt.id,zt)),zt.applyToHost(Re),zt}case 1:case g.ifc.ShadowDom:return new Pt(this.eventManager,this.sharedStylesHost,Re,nt);default:if(!this.rendererByCompId.has(nt.id)){const zt=_e(nt.id,nt.styles);this.sharedStylesHost.addStyles(zt),this.rendererByCompId.set(nt.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return Pe.\u0275fac=function(Re){return new(Re||Pe)(g.LFG(he),g.LFG(te),g.LFG(g.AFp))},Pe.\u0275prov=g.Yz7({token:Pe,factory:Pe.\u0275fac}),Pe})();class vt{constructor(Ue){this.eventManager=Ue,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(Ue,Re){return Re?document.createElementNS(Ot[Re]||Re,Ue):document.createElement(Ue)}createComment(Ue){return document.createComment(Ue)}createText(Ue){return document.createTextNode(Ue)}appendChild(Ue,Re){(Ft(Ue)?Ue.content:Ue).appendChild(Re)}insertBefore(Ue,Re,nt){Ue&&(Ft(Ue)?Ue.content:Ue).insertBefore(Re,nt)}removeChild(Ue,Re){Ue&&Ue.removeChild(Re)}selectRootElement(Ue,Re){let nt="string"==typeof Ue?document.querySelector(Ue):Ue;if(!nt)throw new Error(`The selector "${Ue}" did not match any elements`);return Re||(nt.textContent=""),nt}parentNode(Ue){return Ue.parentNode}nextSibling(Ue){return Ue.nextSibling}setAttribute(Ue,Re,nt,zt){if(zt){Re=zt+":"+Re;const _n=Ot[zt];_n?Ue.setAttributeNS(_n,Re,nt):Ue.setAttribute(Re,nt)}else Ue.setAttribute(Re,nt)}removeAttribute(Ue,Re,nt){if(nt){const zt=Ot[nt];zt?Ue.removeAttributeNS(zt,Re):Ue.removeAttribute(`${nt}:${Re}`)}else Ue.removeAttribute(Re)}addClass(Ue,Re){Ue.classList.add(Re)}removeClass(Ue,Re){Ue.classList.remove(Re)}setStyle(Ue,Re,nt,zt){zt&(g.JOm.DashCase|g.JOm.Important)?Ue.style.setProperty(Re,nt,zt&g.JOm.Important?"important":""):Ue.style[Re]=nt}removeStyle(Ue,Re,nt){nt&g.JOm.DashCase?Ue.style.removeProperty(Re):Ue.style[Re]=""}setProperty(Ue,Re,nt){Ue[Re]=nt}setValue(Ue,Re){Ue.nodeValue=Re}listen(Ue,Re,nt){return"string"==typeof Ue?this.eventManager.addGlobalEventListener(Ue,Re,pe(nt)):this.eventManager.addEventListener(Ue,Re,pe(nt))}}function Ft(Pe){return"TEMPLATE"===Pe.tagName&&void 0!==Pe.content}class xt extends vt{constructor(Ue,Re,nt,zt){super(Ue),this.component=nt;const _n=_e(zt+"-"+nt.id,nt.styles);Re.addStyles(_n),this.contentAttr=function et(Pe){return"_ngcontent-%COMP%".replace(dt,Pe)}(zt+"-"+nt.id),this.hostAttr=function Je(Pe){return"_nghost-%COMP%".replace(dt,Pe)}(zt+"-"+nt.id)}applyToHost(Ue){super.setAttribute(Ue,this.hostAttr,"")}createElement(Ue,Re){const nt=super.createElement(Ue,Re);return super.setAttribute(nt,this.contentAttr,""),nt}}class Pt extends vt{constructor(Ue,Re,nt,zt){super(Ue),this.sharedStylesHost=Re,this.hostEl=nt,this.shadowRoot=nt.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const _n=_e(zt.id,zt.styles);for(let Mn=0;Mn<_n.length;Mn++){const Yn=document.createElement("style");Yn.textContent=_n[Mn],this.shadowRoot.appendChild(Yn)}}nodeOrShadowRoot(Ue){return Ue===this.hostEl?this.shadowRoot:Ue}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(Ue,Re){return super.appendChild(this.nodeOrShadowRoot(Ue),Re)}insertBefore(Ue,Re,nt){return super.insertBefore(this.nodeOrShadowRoot(Ue),Re,nt)}removeChild(Ue,Re){return super.removeChild(this.nodeOrShadowRoot(Ue),Re)}parentNode(Ue){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(Ue)))}}let bt=(()=>{class Pe extends Ke{constructor(Re){super(Re)}supports(Re){return!0}addEventListener(Re,nt,zt){return Re.addEventListener(nt,zt,!1),()=>this.removeEventListener(Re,nt,zt)}removeEventListener(Re,nt,zt){return Re.removeEventListener(nt,zt)}}return Pe.\u0275fac=function(Re){return new(Re||Pe)(g.LFG(h.K0))},Pe.\u0275prov=g.Yz7({token:Pe,factory:Pe.\u0275fac}),Pe})();const ct=["alt","control","meta","shift"],ht={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},Ce={alt:Pe=>Pe.altKey,control:Pe=>Pe.ctrlKey,meta:Pe=>Pe.metaKey,shift:Pe=>Pe.shiftKey};let Ct=(()=>{class Pe extends Ke{constructor(Re){super(Re)}supports(Re){return null!=Pe.parseEventName(Re)}addEventListener(Re,nt,zt){const _n=Pe.parseEventName(nt),Mn=Pe.eventCallback(_n.fullKey,zt,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>(0,h.q)().onAndCancel(Re,_n.domEventName,Mn))}static parseEventName(Re){const nt=Re.toLowerCase().split("."),zt=nt.shift();if(0===nt.length||"keydown"!==zt&&"keyup"!==zt)return null;const _n=Pe._normalizeKey(nt.pop());let Mn="",Yn=nt.indexOf("code");if(Yn>-1&&(nt.splice(Yn,1),Mn="code."),ct.forEach(gi=>{const Kn=nt.indexOf(gi);Kn>-1&&(nt.splice(Kn,1),Mn+=gi+".")}),Mn+=_n,0!=nt.length||0===_n.length)return null;const di={};return di.domEventName=zt,di.fullKey=Mn,di}static matchEventFullKeyCode(Re,nt){let zt=ht[Re.key]||Re.key,_n="";return nt.indexOf("code.")>-1&&(zt=Re.code,_n="code."),!(null==zt||!zt)&&(zt=zt.toLowerCase()," "===zt?zt="space":"."===zt&&(zt="dot"),ct.forEach(Mn=>{Mn!==zt&&(0,Ce[Mn])(Re)&&(_n+=Mn+".")}),_n+=zt,_n===nt)}static eventCallback(Re,nt,zt){return _n=>{Pe.matchEventFullKeyCode(_n,Re)&&zt.runGuarded(()=>nt(_n))}}static _normalizeKey(Re){return"esc"===Re?"escape":Re}}return Pe.\u0275fac=function(Re){return new(Re||Pe)(g.LFG(h.K0))},Pe.\u0275prov=g.Yz7({token:Pe,factory:Pe.\u0275fac}),Pe})();const ci=(0,g.eFA)(g._c5,"browser",[{provide:g.Lbi,useValue:h.bD},{provide:g.g9A,useValue:function ut(){c.makeCurrent()},multi:!0},{provide:h.K0,useFactory:function En(){return(0,g.RDi)(document),document},deps:[]}]),Un=new g.OlP(""),_i=[{provide:g.rWj,useClass:class be{addToWindow(Ue){g.dqk.getAngularTestability=(nt,zt=!0)=>{const _n=Ue.findTestabilityInTree(nt,zt);if(null==_n)throw new Error("Could not find testability for element.");return _n},g.dqk.getAllAngularTestabilities=()=>Ue.getAllTestabilities(),g.dqk.getAllAngularRootElements=()=>Ue.getAllRootElements(),g.dqk.frameworkStabilizers||(g.dqk.frameworkStabilizers=[]),g.dqk.frameworkStabilizers.push(nt=>{const zt=g.dqk.getAllAngularTestabilities();let _n=zt.length,Mn=!1;const Yn=function(di){Mn=Mn||di,_n--,0==_n&&nt(Mn)};zt.forEach(function(di){di.whenStable(Yn)})})}findTestabilityInTree(Ue,Re,nt){return null==Re?null:Ue.getTestability(Re)??(nt?(0,h.q)().isShadowRoot(Re)?this.findTestabilityInTree(Ue,Re.host,!0):this.findTestabilityInTree(Ue,Re.parentElement,!0):null)}},deps:[]},{provide:g.lri,useClass:g.dDg,deps:[g.R0b,g.eoX,g.rWj]},{provide:g.dDg,useClass:g.dDg,deps:[g.R0b,g.eoX,g.rWj]}],wi=[{provide:g.zSh,useValue:"root"},{provide:g.qLn,useFactory:function jt(){return new g.qLn},deps:[]},{provide:Ze,useClass:bt,multi:!0,deps:[h.K0,g.R0b,g.Lbi]},{provide:Ze,useClass:Ct,multi:!0,deps:[h.K0]},{provide:Ee,useClass:Ee,deps:[he,te,g.AFp]},{provide:g.FYo,useExisting:Ee},{provide:Ae,useExisting:te},{provide:te,useClass:te,deps:[h.K0]},{provide:he,useClass:he,deps:[Ze,g.R0b]},{provide:h.JF,useClass:me,deps:[]},[]];let xi=(()=>{class Pe{constructor(Re){}static withServerTransition(Re){return{ngModule:Pe,providers:[{provide:g.AFp,useValue:Re.appId},{provide:Ie,useExisting:g.AFp},Q]}}}return Pe.\u0275fac=function(Re){return new(Re||Pe)(g.LFG(Un,12))},Pe.\u0275mod=g.oAB({type:Pe}),Pe.\u0275inj=g.cJS({providers:[...wi,..._i],imports:[h.ez,g.hGG]}),Pe})(),Ht=(()=>{class Pe{constructor(Re){this._doc=Re}getTitle(){return this._doc.title}setTitle(Re){this._doc.title=Re||""}}return Pe.\u0275fac=function(Re){return new(Re||Pe)(g.LFG(h.K0))},Pe.\u0275prov=g.Yz7({token:Pe,factory:function(Re){let nt=null;return nt=Re?new Re:function Yi(){return new Ht((0,g.LFG)(h.K0))}(),nt},providedIn:"root"}),Pe})();typeof window<"u"&&window},4228:(Rn,Dt,B)=>{"use strict";B.d(Dt,{gz:()=>mo,y6:()=>qr,OD:()=>ei,eC:()=>Un,wN:()=>Ic,F0:()=>To,rH:()=>ic,Bz:()=>Iu,Hx:()=>Ve});var h=B(8274),g=B(2076),ie=B(9646),c=B(1135);const se=(0,B(3888).d)(P=>function(){P(this),this.name="EmptyError",this.message="no elements in sequence"});var y=B(9751),fe=B(4742),Ie=B(4671),Ge=B(3268),Q=B(7669),be=B(1810),me=B(5403),Ze=B(9672);function he(...P){const F=(0,Q.yG)(P),S=(0,Q.jO)(P),{args:l,keys:t}=(0,fe.D)(P);if(0===l.length)return(0,g.D)([],F);const s=new y.y(function Ke(P,F,S=Ie.y){return l=>{Ae(F,()=>{const{length:t}=P,s=new Array(t);let p=t,v=t;for(let b=0;b<t;b++)Ae(F,()=>{const D=(0,g.D)(P[b],F);let O=!1;D.subscribe((0,me.x)(l,k=>{s[b]=k,O||(O=!0,v--),v||l.next(S(s.slice()))},()=>{--p||l.complete()}))},l)},l)}}(l,F,t?p=>(0,be.n)(t,p):Ie.y));return S?s.pipe((0,Ge.Z)(S)):s}function Ae(P,F,S){P?(0,Ze.f)(S,P,F):F()}var te=B(7272),Qe=B(9770),Ot=B(9635),dt=B(576);function ye(P,F){const S=(0,dt.m)(P)?P:()=>P,l=t=>t.error(S());return new y.y(F?t=>F.schedule(l,0,t):l)}var Fe=B(515),Ne=B(727),we=B(4482);function et(){return(0,we.e)((P,F)=>{let S=null;P._refCount++;const l=(0,me.x)(F,void 0,void 0,void 0,()=>{if(!P||P._refCount<=0||0<--P._refCount)return void(S=null);const t=P._connection,s=S;S=null,t&&(!s||t===s)&&t.unsubscribe(),F.unsubscribe()});P.subscribe(l),l.closed||(S=P.connect())})}class Je extends y.y{constructor(F,S){super(),this.source=F,this.subjectFactory=S,this._subject=null,this._refCount=0,this._connection=null,(0,we.A)(F)&&(this.lift=F.lift)}_subscribe(F){return this.getSubject().subscribe(F)}getSubject(){const F=this._subject;return(!F||F.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:F}=this;this._subject=this._connection=null,F?.unsubscribe()}connect(){let F=this._connection;if(!F){F=this._connection=new Ne.w0;const S=this.getSubject();F.add(this.source.subscribe((0,me.x)(S,void 0,()=>{this._teardown(),S.complete()},l=>{this._teardown(),S.error(l)},()=>this._teardown()))),F.closed&&(this._connection=null,F=Ne.w0.EMPTY)}return F}refCount(){return et()(this)}}var _e=B(7579),pe=B(6895),ae=B(4004),Ee=B(3900),vt=B(5698),qt=B(9300),Ft=B(5577);function xt(P){return(0,we.e)((F,S)=>{let l=!1;F.subscribe((0,me.x)(S,t=>{l=!0,S.next(t)},()=>{l||S.next(P),S.complete()}))})}function Pt(P=bt){return(0,we.e)((F,S)=>{let l=!1;F.subscribe((0,me.x)(S,t=>{l=!0,S.next(t)},()=>l?S.complete():S.error(P())))})}function bt(){return new se}function ct(P,F){const S=arguments.length>=2;return l=>l.pipe(P?(0,qt.h)((t,s)=>P(t,s,l)):Ie.y,(0,vt.q)(1),S?xt(F):Pt(()=>new se))}var ht=B(4351);function Ce(P,F,S){const l=(0,dt.m)(P)||F||S?{next:P,error:F,complete:S}:P;return l?(0,we.e)((t,s)=>{var p;null===(p=l.subscribe)||void 0===p||p.call(l);let v=!0;t.subscribe((0,me.x)(s,b=>{var D;null===(D=l.next)||void 0===D||D.call(l,b),s.next(b)},()=>{var b;v=!1,null===(b=l.complete)||void 0===b||b.call(l),s.complete()},b=>{var D;v=!1,null===(D=l.error)||void 0===D||D.call(l,b),s.error(b)},()=>{var b,D;v&&(null===(b=l.unsubscribe)||void 0===b||b.call(l)),null===(D=l.finalize)||void 0===D||D.call(l)}))}):Ie.y}var Ct=B(8421);function Ut(P){return(0,we.e)((F,S)=>{let s,l=null,t=!1;l=F.subscribe((0,me.x)(S,void 0,void 0,p=>{s=(0,Ct.Xf)(P(p,Ut(P)(F))),l?(l.unsubscribe(),l=null,s.subscribe(S)):t=!0})),t&&(l.unsubscribe(),l=null,s.subscribe(S))})}function Gt(P,F,S,l,t){return(s,p)=>{let v=S,b=F,D=0;s.subscribe((0,me.x)(p,O=>{const k=D++;b=v?P(b,O,k):(v=!0,O),l&&p.next(b)},t&&(()=>{v&&p.next(b),p.complete()})))}}function wn(P,F){return(0,we.e)(Gt(P,F,arguments.length>=2,!0))}function Fn(P){return P<=0?()=>Fe.E:(0,we.e)((F,S)=>{let l=[];F.subscribe((0,me.x)(S,t=>{l.push(t),P<l.length&&l.shift()},()=>{for(const t of l)S.next(t);S.complete()},void 0,()=>{l=null}))})}function un(P,F){const S=arguments.length>=2;return l=>l.pipe(P?(0,qt.h)((t,s)=>P(t,s,l)):Ie.y,Fn(1),S?xt(F):Pt(()=>new se))}function En(P){return(0,we.e)((F,S)=>{try{F.subscribe(S)}finally{S.add(P)}})}var ni=B(8189),ci=B(1481);const Un="primary",_i=Symbol("RouteTitle");class wi{constructor(F){this.params=F||{}}has(F){return Object.prototype.hasOwnProperty.call(this.params,F)}get(F){if(this.has(F)){const S=this.params[F];return Array.isArray(S)?S[0]:S}return null}getAll(F){if(this.has(F)){const S=this.params[F];return Array.isArray(S)?S:[S]}return[]}get keys(){return Object.keys(this.params)}}function xi(P){return new wi(P)}function Ni(P,F,S){const l=S.path.split("/");if(l.length>P.length||"full"===S.pathMatch&&(F.hasChildren()||l.length<P.length))return null;const t={};for(let s=0;s<l.length;s++){const p=l[s],v=P[s];if(p.startsWith(":"))t[p.substring(1)]=v;else if(p!==v.path)return null}return{consumed:P.slice(0,l.length),posParams:t}}function Ui(P,F){const S=P?Object.keys(P):void 0,l=F?Object.keys(F):void 0;if(!S||!l||S.length!=l.length)return!1;let t;for(let s=0;s<S.length;s++)if(t=S[s],!Yi(P[t],F[t]))return!1;return!0}function Yi(P,F){if(Array.isArray(P)&&Array.isArray(F)){if(P.length!==F.length)return!1;const S=[...P].sort(),l=[...F].sort();return S.every((t,s)=>l[s]===t)}return P===F}function Ht(P){return Array.prototype.concat.apply([],P)}function Mt(P){return P.length>0?P[P.length-1]:null}function re(P,F){for(const S in P)P.hasOwnProperty(S)&&F(P[S],S)}function tt(P){return(0,h.CqO)(P)?P:(0,h.QGY)(P)?(0,g.D)(Promise.resolve(P)):(0,ie.of)(P)}const Wt=!1,Qt={exact:function mi(P,F,S){if(!kt(P.segments,F.segments)||!wr(P.segments,F.segments,S)||P.numberOfChildren!==F.numberOfChildren)return!1;for(const l in F.children)if(!P.children[l]||!mi(P.children[l],F.children[l],S))return!1;return!0},subset:Pi},fi={exact:function er(P,F){return Ui(P,F)},subset:function xr(P,F){return Object.keys(F).length<=Object.keys(P).length&&Object.keys(F).every(S=>Yi(P[S],F[S]))},ignored:()=>!0};function Ai(P,F,S){return Qt[S.paths](P.root,F.root,S.matrixParams)&&fi[S.queryParams](P.queryParams,F.queryParams)&&!("exact"===S.fragment&&P.fragment!==F.fragment)}function Pi(P,F,S){return br(P,F,F.segments,S)}function br(P,F,S,l){if(P.segments.length>S.length){const t=P.segments.slice(0,S.length);return!(!kt(t,S)||F.hasChildren()||!wr(t,S,l))}if(P.segments.length===S.length){if(!kt(P.segments,S)||!wr(P.segments,S,l))return!1;for(const t in F.children)if(!P.children[t]||!Pi(P.children[t],F.children[t],l))return!1;return!0}{const t=S.slice(0,P.segments.length),s=S.slice(P.segments.length);return!!(kt(P.segments,t)&&wr(P.segments,t,l)&&P.children[Un])&&br(P.children[Un],F,s,l)}}function wr(P,F,S){return F.every((l,t)=>fi[S](P[t].parameters,l.parameters))}class Er{constructor(F=new ui([],{}),S={},l=null){this.root=F,this.queryParams=S,this.fragment=l}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=xi(this.queryParams)),this._queryParamMap}toString(){return R.serialize(this)}}class ui{constructor(F,S){this.segments=F,this.children=S,this.parent=null,re(S,(l,t)=>l.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return j(this)}}class pn{constructor(F,S){this.path=F,this.parameters=S}get parameterMap(){return this._parameterMap||(this._parameterMap=xi(this.parameters)),this._parameterMap}toString(){return Ue(this)}}function kt(P,F){return P.length===F.length&&P.every((S,l)=>S.path===F[l].path)}let Ve=(()=>{class P{}return P.\u0275fac=function(S){return new(S||P)},P.\u0275prov=h.Yz7({token:P,factory:function(){return new le},providedIn:"root"}),P})();class le{parse(F){const S=new Kn(F);return new Er(S.parseRootSegment(),S.parseQueryParams(),S.parseFragment())}serialize(F){const S=`/${de(F.root,!0)}`,l=function nt(P){const F=Object.keys(P).map(S=>{const l=P[S];return Array.isArray(l)?l.map(t=>`${st(S)}=${st(t)}`).join("&"):`${st(S)}=${st(l)}`}).filter(S=>!!S);return F.length?`?${F.join("&")}`:""}(F.queryParams);return`${S}${l}${"string"==typeof F.fragment?`#${function Bt(P){return encodeURI(P)}(F.fragment)}`:""}`}}const R=new le;function j(P){return P.segments.map(F=>Ue(F)).join("/")}function de(P,F){if(!P.hasChildren())return j(P);if(F){const S=P.children[Un]?de(P.children[Un],!1):"",l=[];return re(P.children,(t,s)=>{s!==Un&&l.push(`${s}:${de(t,!1)}`)}),l.length>0?`${S}(${l.join("//")})`:S}{const S=function gn(P,F){let S=[];return re(P.children,(l,t)=>{t===Un&&(S=S.concat(F(l,t)))}),re(P.children,(l,t)=>{t!==Un&&(S=S.concat(F(l,t)))}),S}(P,(l,t)=>t===Un?[de(P.children[Un],!1)]:[`${t}:${de(l,!1)}`]);return 1===Object.keys(P.children).length&&null!=P.children[Un]?`${j(P)}/${S[0]}`:`${j(P)}/(${S.join("//")})`}}function Le(P){return encodeURIComponent(P).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function st(P){return Le(P).replace(/%3B/gi,";")}function Rt(P){return Le(P).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function at(P){return decodeURIComponent(P)}function Pe(P){return at(P.replace(/\+/g,"%20"))}function Ue(P){return`${Rt(P.path)}${function Re(P){return Object.keys(P).map(F=>`;${Rt(F)}=${Rt(P[F])}`).join("")}(P.parameters)}`}const zt=/^[^\/()?;=#]+/;function _n(P){const F=P.match(zt);return F?F[0]:""}const Mn=/^[^=?&#]+/,di=/^[^&#]+/;class Kn{constructor(F){this.url=F,this.remaining=F}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new ui([],{}):new ui([],this.parseChildren())}parseQueryParams(){const F={};if(this.consumeOptional("?"))do{this.parseQueryParam(F)}while(this.consumeOptional("&"));return F}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const F=[];for(this.peekStartsWith("(")||F.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),F.push(this.parseSegment());let S={};this.peekStartsWith("/(")&&(this.capture("/"),S=this.parseParens(!0));let l={};return this.peekStartsWith("(")&&(l=this.parseParens(!1)),(F.length>0||Object.keys(S).length>0)&&(l[Un]=new ui(F,S)),l}parseSegment(){const F=_n(this.remaining);if(""===F&&this.peekStartsWith(";"))throw new h.vHH(4009,Wt);return this.capture(F),new pn(at(F),this.parseMatrixParams())}parseMatrixParams(){const F={};for(;this.consumeOptional(";");)this.parseParam(F);return F}parseParam(F){const S=_n(this.remaining);if(!S)return;this.capture(S);let l="";if(this.consumeOptional("=")){const t=_n(this.remaining);t&&(l=t,this.capture(l))}F[at(S)]=at(l)}parseQueryParam(F){const S=function Yn(P){const F=P.match(Mn);return F?F[0]:""}(this.remaining);if(!S)return;this.capture(S);let l="";if(this.consumeOptional("=")){const p=function gi(P){const F=P.match(di);return F?F[0]:""}(this.remaining);p&&(l=p,this.capture(l))}const t=Pe(S),s=Pe(l);if(F.hasOwnProperty(t)){let p=F[t];Array.isArray(p)||(p=[p],F[t]=p),p.push(s)}else F[t]=s}parseParens(F){const S={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const l=_n(this.remaining),t=this.remaining[l.length];if("/"!==t&&")"!==t&&";"!==t)throw new h.vHH(4010,Wt);let s;l.indexOf(":")>-1?(s=l.slice(0,l.indexOf(":")),this.capture(s),this.capture(":")):F&&(s=Un);const p=this.parseChildren();S[s]=1===Object.keys(p).length?p[Un]:new ui([],p),this.consumeOptional("//")}return S}peekStartsWith(F){return this.remaining.startsWith(F)}consumeOptional(F){return!!this.peekStartsWith(F)&&(this.remaining=this.remaining.substring(F.length),!0)}capture(F){if(!this.consumeOptional(F))throw new h.vHH(4011,Wt)}}function Vi(P){return P.segments.length>0?new ui([],{[Un]:P}):P}function Bi(P){const F={};for(const l of Object.keys(P.children)){const s=Bi(P.children[l]);(s.segments.length>0||s.hasChildren())&&(F[l]=s)}return function Qr(P){if(1===P.numberOfChildren&&P.children[Un]){const F=P.children[Un];return new ui(P.segments.concat(F.segments),F.children)}return P}(new ui(P.segments,F))}function Cr(P){return P instanceof Er}function zo(P,F,S,l,t){if(0===S.length)return lr(F.root,F.root,F.root,l,t);const s=function hi(P){if("string"==typeof P[0]&&1===P.length&&"/"===P[0])return new Ln(!0,0,P);let F=0,S=!1;const l=P.reduce((t,s,p)=>{if("object"==typeof s&&null!=s){if(s.outlets){const v={};return re(s.outlets,(b,D)=>{v[D]="string"==typeof b?b.split("/"):b}),[...t,{outlets:v}]}if(s.segmentPath)return[...t,s.segmentPath]}return"string"!=typeof s?[...t,s]:0===p?(s.split("/").forEach((v,b)=>{0==b&&"."===v||(0==b&&""===v?S=!0:".."===v?F++:""!=v&&t.push(v))}),t):[...t,s]},[]);return new Ln(S,F,l)}(S);return s.toRoot()?lr(F.root,F.root,new ui([],{}),l,t):function p(b){const D=function xe(P,F,S,l){if(P.isAbsolute)return new ri(F.root,!0,0);if(-1===l)return new ri(S,S===F.root,0);return function Oe(P,F,S){let l=P,t=F,s=S;for(;s>t;){if(s-=t,l=l.parent,!l)throw new h.vHH(4005,!1);t=l.segments.length}return new ri(l,!1,t-s)}(S,l+(Br(P.commands[0])?0:1),P.numberOfDoubleDots)}(s,F,P.snapshot?._urlSegment,b),O=D.processChildren?tn(D.segmentGroup,D.index,s.commands):$t(D.segmentGroup,D.index,s.commands);return lr(F.root,D.segmentGroup,O,l,t)}(P.snapshot?._lastPathIndex)}function Br(P){return"object"==typeof P&&null!=P&&!P.outlets&&!P.segmentPath}function Oi(P){return"object"==typeof P&&null!=P&&P.outlets}function lr(P,F,S,l,t){let p,s={};l&&re(l,(b,D)=>{s[D]=Array.isArray(b)?b.map(O=>`${O}`):`${b}`}),p=P===F?S:cr(P,F,S);const v=Vi(Bi(p));return new Er(v,s,t)}function cr(P,F,S){const l={};return re(P.children,(t,s)=>{l[s]=t===F?S:cr(t,F,S)}),new ui(P.segments,l)}class Ln{constructor(F,S,l){if(this.isAbsolute=F,this.numberOfDoubleDots=S,this.commands=l,F&&l.length>0&&Br(l[0]))throw new h.vHH(4003,!1);const t=l.find(Oi);if(t&&t!==Mt(l))throw new h.vHH(4004,!1)}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class ri{constructor(F,S,l){this.segmentGroup=F,this.processChildren=S,this.index=l}}function $t(P,F,S){if(P||(P=new ui([],{})),0===P.segments.length&&P.hasChildren())return tn(P,F,S);const l=function He(P,F,S){let l=0,t=F;const s={match:!1,pathIndex:0,commandIndex:0};for(;t<P.segments.length;){if(l>=S.length)return s;const p=P.segments[t],v=S[l];if(Oi(v))break;const b=`${v}`,D=l<S.length-1?S[l+1]:null;if(t>0&&void 0===b)break;if(b&&D&&"object"==typeof D&&void 0===D.outlets){if(!nn(b,D,p))return s;l+=2}else{if(!nn(b,{},p))return s;l++}t++}return{match:!0,pathIndex:t,commandIndex:l}}(P,F,S),t=S.slice(l.commandIndex);if(l.match&&l.pathIndex<P.segments.length){const s=new ui(P.segments.slice(0,l.pathIndex),{});return s.children[Un]=new ui(P.segments.slice(l.pathIndex),P.children),tn(s,0,t)}return l.match&&0===t.length?new ui(P.segments,{}):l.match&&!P.hasChildren()?pt(P,F,S):l.match?tn(P,0,t):pt(P,F,S)}function tn(P,F,S){if(0===S.length)return new ui(P.segments,{});{const l=function Lt(P){return Oi(P[0])?P[0].outlets:{[Un]:P}}(S),t={};return re(l,(s,p)=>{"string"==typeof s&&(s=[s]),null!==s&&(t[p]=$t(P.children[p],F,s))}),re(P.children,(s,p)=>{void 0===l[p]&&(t[p]=s)}),new ui(P.segments,t)}}function pt(P,F,S){const l=P.segments.slice(0,F);let t=0;for(;t<S.length;){const s=S[t];if(Oi(s)){const b=Yt(s.outlets);return new ui(l,b)}if(0===t&&Br(S[0])){l.push(new pn(P.segments[F].path,hn(S[0]))),t++;continue}const p=Oi(s)?s.outlets[Un]:`${s}`,v=t<S.length-1?S[t+1]:null;p&&v&&Br(v)?(l.push(new pn(p,hn(v))),t+=2):(l.push(new pn(p,{})),t++)}return new ui(l,{})}function Yt(P){const F={};return re(P,(S,l)=>{"string"==typeof S&&(S=[S]),null!==S&&(F[l]=pt(new ui([],{}),0,S))}),F}function hn(P){const F={};return re(P,(S,l)=>F[l]=`${S}`),F}function nn(P,F,S){return P==S.path&&Ui(F,S.parameters)}class kn{constructor(F,S){this.id=F,this.url=S}}class ei extends kn{constructor(F,S,l="imperative",t=null){super(F,S),this.type=0,this.navigationTrigger=l,this.restoredState=t}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class Ci extends kn{constructor(F,S,l){super(F,S),this.urlAfterRedirects=l,this.type=1}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class qi extends kn{constructor(F,S,l,t){super(F,S),this.reason=l,this.code=t,this.type=2}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class ki extends kn{constructor(F,S,l,t){super(F,S),this.error=l,this.target=t,this.type=3}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class jr extends kn{constructor(F,S,l,t){super(F,S),this.urlAfterRedirects=l,this.state=t,this.type=4}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Rr extends kn{constructor(F,S,l,t){super(F,S),this.urlAfterRedirects=l,this.state=t,this.type=7}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class tr extends kn{constructor(F,S,l,t,s){super(F,S),this.urlAfterRedirects=l,this.state=t,this.shouldActivate=s,this.type=8}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class fr extends kn{constructor(F,S,l,t){super(F,S),this.urlAfterRedirects=l,this.state=t,this.type=5}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class es extends kn{constructor(F,S,l,t){super(F,S),this.urlAfterRedirects=l,this.state=t,this.type=6}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class mr{constructor(F){this.route=F,this.type=9}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class bo{constructor(F){this.route=F,this.type=10}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class io{constructor(F){this.snapshot=F,this.type=11}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class ia{constructor(F){this.snapshot=F,this.type=12}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Io{constructor(F){this.snapshot=F,this.type=13}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Dr{constructor(F){this.snapshot=F,this.type=14}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Mo{constructor(F,S,l){this.routerEvent=F,this.position=S,this.anchor=l,this.type=15}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}let rr=(()=>{class P{createUrlTree(S,l,t,s,p,v){return zo(S||l.root,t,s,p,v)}}return P.\u0275fac=function(S){return new(S||P)},P.\u0275prov=h.Yz7({token:P,factory:P.\u0275fac}),P})(),xs=(()=>{class P{}return P.\u0275fac=function(S){return new(S||P)},P.\u0275prov=h.Yz7({token:P,factory:function(F){return rr.\u0275fac(F)},providedIn:"root"}),P})();class so{constructor(F){this._root=F}get root(){return this._root.value}parent(F){const S=this.pathFromRoot(F);return S.length>1?S[S.length-2]:null}children(F){const S=ao(F,this._root);return S?S.children.map(l=>l.value):[]}firstChild(F){const S=ao(F,this._root);return S&&S.children.length>0?S.children[0].value:null}siblings(F){const S=Wr(F,this._root);return S.length<2?[]:S[S.length-2].children.map(t=>t.value).filter(t=>t!==F)}pathFromRoot(F){return Wr(F,this._root).map(S=>S.value)}}function ao(P,F){if(P===F.value)return F;for(const S of F.children){const l=ao(P,S);if(l)return l}return null}function Wr(P,F){if(P===F.value)return[F];for(const S of F.children){const l=Wr(P,S);if(l.length)return l.unshift(F),l}return[]}class Ho{constructor(F,S){this.value=F,this.children=S}toString(){return`TreeNode(${this.value})`}}function us(P){const F={};return P&&P.children.forEach(S=>F[S.value.outlet]=S),F}class ds extends so{constructor(F,S){super(F),this.snapshot=S,sa(this,F)}toString(){return this.snapshot.toString()}}function Bs(P,F){const S=function oa(P,F){const p=new go([],{},{},"",{},Un,F,null,P.root,-1,{});return new xa("",new Ho(p,[]))}(P,F),l=new c.X([new pn("",{})]),t=new c.X({}),s=new c.X({}),p=new c.X({}),v=new c.X(""),b=new mo(l,t,p,v,s,Un,F,S.root);return b.snapshot=S.root,new ds(new Ho(b,[]),S)}class mo{constructor(F,S,l,t,s,p,v,b){this.url=F,this.params=S,this.queryParams=l,this.fragment=t,this.data=s,this.outlet=p,this.component=v,this.title=this.data?.pipe((0,ae.U)(D=>D[_i]))??(0,ie.of)(void 0),this._futureSnapshot=b}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe((0,ae.U)(F=>xi(F)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe((0,ae.U)(F=>xi(F)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function No(P,F="emptyOnly"){const S=P.pathFromRoot;let l=0;if("always"!==F)for(l=S.length-1;l>=1;){const t=S[l],s=S[l-1];if(t.routeConfig&&""===t.routeConfig.path)l--;else{if(s.component)break;l--}}return function Ys(P){return P.reduce((F,S)=>({params:{...F.params,...S.params},data:{...F.data,...S.data},resolve:{...S.data,...F.resolve,...S.routeConfig?.data,...S._resolvedData}}),{params:{},data:{},resolve:{}})}(S.slice(l))}class go{constructor(F,S,l,t,s,p,v,b,D,O,k){this.url=F,this.params=S,this.queryParams=l,this.fragment=t,this.data=s,this.outlet=p,this.component=v,this.routeConfig=b,this._urlSegment=D,this._lastPathIndex=O,this._resolve=k}get title(){return this.data?.[_i]}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=xi(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=xi(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(l=>l.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class xa extends so{constructor(F,S){super(S),this.url=F,sa(this,S)}toString(){return Ao(this._root)}}function sa(P,F){F.value._routerState=P,F.children.forEach(S=>sa(P,S))}function Ao(P){const F=P.children.length>0?` { ${P.children.map(Ao).join(", ")} } `:"";return`${P.value}${F}`}function ba(P){if(P.snapshot){const F=P.snapshot,S=P._futureSnapshot;P.snapshot=S,Ui(F.queryParams,S.queryParams)||P.queryParams.next(S.queryParams),F.fragment!==S.fragment&&P.fragment.next(S.fragment),Ui(F.params,S.params)||P.params.next(S.params),function Ii(P,F){if(P.length!==F.length)return!1;for(let S=0;S<P.length;++S)if(!Ui(P[S],F[S]))return!1;return!0}(F.url,S.url)||P.url.next(S.url),Ui(F.data,S.data)||P.data.next(S.data)}else P.snapshot=P._futureSnapshot,P.data.next(P._futureSnapshot.data)}function zs(P,F){const S=Ui(P.params,F.params)&&function _t(P,F){return kt(P,F)&&P.every((S,l)=>Ui(S.parameters,F[l].parameters))}(P.url,F.url);return S&&!(!P.parent!=!F.parent)&&(!P.parent||zs(P.parent,F.parent))}function Uo(P,F,S){if(S&&P.shouldReuseRoute(F.value,S.value.snapshot)){const l=S.value;l._futureSnapshot=F.value;const t=function Fa(P,F,S){return F.children.map(l=>{for(const t of S.children)if(P.shouldReuseRoute(l.value,t.value.snapshot))return Uo(P,l,t);return Uo(P,l)})}(P,F,S);return new Ho(l,t)}{if(P.shouldAttach(F.value)){const s=P.retrieve(F.value);if(null!==s){const p=s.route;return p.value._futureSnapshot=F.value,p.children=F.children.map(v=>Uo(P,v)),p}}const l=function bs(P){return new mo(new c.X(P.url),new c.X(P.params),new c.X(P.queryParams),new c.X(P.fragment),new c.X(P.data),P.outlet,P.component,P)}(F.value),t=F.children.map(s=>Uo(P,s));return new Ho(l,t)}}const aa="ngNavigationCancelingError";function Wo(P,F){const{redirectTo:S,navigationBehaviorOptions:l}=Cr(F)?{redirectTo:F,navigationBehaviorOptions:void 0}:F,t=Js(!1,0,F);return t.url=S,t.navigationBehaviorOptions=l,t}function Js(P,F,S){const l=new Error("NavigationCancelingError: "+(P||""));return l[aa]=!0,l.cancellationCode=F,S&&(l.url=S),l}function ts(P){return ws(P)&&Cr(P.url)}function ws(P){return P&&P[aa]}class Ns{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.injector=null,this.children=new qr,this.attachRef=null}}let qr=(()=>{class P{constructor(){this.contexts=new Map}onChildOutletCreated(S,l){const t=this.getOrCreateContext(S);t.outlet=l,this.contexts.set(S,t)}onChildOutletDestroyed(S){const l=this.getContext(S);l&&(l.outlet=null,l.attachRef=null)}onOutletDeactivated(){const S=this.contexts;return this.contexts=new Map,S}onOutletReAttached(S){this.contexts=S}getOrCreateContext(S){let l=this.getContext(S);return l||(l=new Ns,this.contexts.set(S,l)),l}getContext(S){return this.contexts.get(S)||null}}return P.\u0275fac=function(S){return new(S||P)},P.\u0275prov=h.Yz7({token:P,factory:P.\u0275fac,providedIn:"root"}),P})();const Hi=!1;let Us=(()=>{class P{constructor(){this.activated=null,this._activatedRoute=null,this.name=Un,this.activateEvents=new h.vpe,this.deactivateEvents=new h.vpe,this.attachEvents=new h.vpe,this.detachEvents=new h.vpe,this.parentContexts=(0,h.f3M)(qr),this.location=(0,h.f3M)(h.s_b),this.changeDetector=(0,h.f3M)(h.sBO),this.environmentInjector=(0,h.f3M)(h.lqb)}ngOnChanges(S){if(S.name){const{firstChange:l,previousValue:t}=S.name;if(l)return;this.isTrackedInParentContexts(t)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(t)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name)}isTrackedInParentContexts(S){return this.parentContexts.getContext(S)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;const S=this.parentContexts.getContext(this.name);S?.route&&(S.attachRef?this.attach(S.attachRef,S.route):this.activateWith(S.route,S.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new h.vHH(4012,Hi);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new h.vHH(4012,Hi);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new h.vHH(4012,Hi);this.location.detach();const S=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(S.instance),S}attach(S,l){this.activated=S,this._activatedRoute=l,this.location.insert(S.hostView),this.attachEvents.emit(S.instance)}deactivate(){if(this.activated){const S=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(S)}}activateWith(S,l){if(this.isActivated)throw new h.vHH(4013,Hi);this._activatedRoute=S;const t=this.location,p=S.snapshot.component,v=this.parentContexts.getOrCreateContext(this.name).children,b=new Cs(S,v,t.injector);if(l&&function Vs(P){return!!P.resolveComponentFactory}(l)){const D=l.resolveComponentFactory(p);this.activated=t.createComponent(D,t.length,b)}else this.activated=t.createComponent(p,{index:t.length,injector:b,environmentInjector:l??this.environmentInjector});this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return P.\u0275fac=function(S){return new(S||P)},P.\u0275dir=h.lG2({type:P,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[h.TTD]}),P})();class Cs{constructor(F,S,l){this.route=F,this.childContexts=S,this.parent=l}get(F,S){return F===mo?this.route:F===qr?this.childContexts:this.parent.get(F,S)}}let ns=(()=>{class P{}return P.\u0275fac=function(S){return new(S||P)},P.\u0275cmp=h.Xpm({type:P,selectors:[["ng-component"]],standalone:!0,features:[h.jDz],decls:1,vars:0,template:function(S,l){1&S&&h._UZ(0,"router-outlet")},dependencies:[Us],encapsulation:2}),P})();function Ts(P,F){return P.providers&&!P._injector&&(P._injector=(0,h.MMx)(P.providers,F,`Route: ${P.path}`)),P._injector??F}function wa(P){const F=P.children&&P.children.map(wa),S=F?{...P,children:F}:{...P};return!S.component&&!S.loadComponent&&(F||S.loadChildren)&&S.outlet&&S.outlet!==Un&&(S.component=ns),S}function Co(P){return P.outlet||Un}function ms(P,F){const S=P.filter(l=>Co(l)===F);return S.push(...P.filter(l=>Co(l)!==F)),S}function Yr(P){if(!P)return null;if(P.routeConfig?._injector)return P.routeConfig._injector;for(let F=P.parent;F;F=F.parent){const S=F.routeConfig;if(S?._loadedInjector)return S._loadedInjector;if(S?._injector)return S._injector}return null}class Ca{constructor(F,S,l,t){this.routeReuseStrategy=F,this.futureState=S,this.currState=l,this.forwardEvent=t}activate(F){const S=this.futureState._root,l=this.currState?this.currState._root:null;this.deactivateChildRoutes(S,l,F),ba(this.futureState.root),this.activateChildRoutes(S,l,F)}deactivateChildRoutes(F,S,l){const t=us(S);F.children.forEach(s=>{const p=s.value.outlet;this.deactivateRoutes(s,t[p],l),delete t[p]}),re(t,(s,p)=>{this.deactivateRouteAndItsChildren(s,l)})}deactivateRoutes(F,S,l){const t=F.value,s=S?S.value:null;if(t===s)if(t.component){const p=l.getContext(t.outlet);p&&this.deactivateChildRoutes(F,S,p.children)}else this.deactivateChildRoutes(F,S,l);else s&&this.deactivateRouteAndItsChildren(S,l)}deactivateRouteAndItsChildren(F,S){F.value.component&&this.routeReuseStrategy.shouldDetach(F.value.snapshot)?this.detachAndStoreRouteSubtree(F,S):this.deactivateRouteAndOutlet(F,S)}detachAndStoreRouteSubtree(F,S){const l=S.getContext(F.value.outlet),t=l&&F.value.component?l.children:S,s=us(F);for(const p of Object.keys(s))this.deactivateRouteAndItsChildren(s[p],t);if(l&&l.outlet){const p=l.outlet.detach(),v=l.children.onOutletDeactivated();this.routeReuseStrategy.store(F.value.snapshot,{componentRef:p,route:F,contexts:v})}}deactivateRouteAndOutlet(F,S){const l=S.getContext(F.value.outlet),t=l&&F.value.component?l.children:S,s=us(F);for(const p of Object.keys(s))this.deactivateRouteAndItsChildren(s[p],t);l&&l.outlet&&(l.outlet.deactivate(),l.children.onOutletDeactivated(),l.attachRef=null,l.resolver=null,l.route=null)}activateChildRoutes(F,S,l){const t=us(S);F.children.forEach(s=>{this.activateRoutes(s,t[s.value.outlet],l),this.forwardEvent(new Dr(s.value.snapshot))}),F.children.length&&this.forwardEvent(new ia(F.value.snapshot))}activateRoutes(F,S,l){const t=F.value,s=S?S.value:null;if(ba(t),t===s)if(t.component){const p=l.getOrCreateContext(t.outlet);this.activateChildRoutes(F,S,p.children)}else this.activateChildRoutes(F,S,l);else if(t.component){const p=l.getOrCreateContext(t.outlet);if(this.routeReuseStrategy.shouldAttach(t.snapshot)){const v=this.routeReuseStrategy.retrieve(t.snapshot);this.routeReuseStrategy.store(t.snapshot,null),p.children.onOutletReAttached(v.contexts),p.attachRef=v.componentRef,p.route=v.route.value,p.outlet&&p.outlet.attach(v.componentRef,v.route.value),ba(v.route.value),this.activateChildRoutes(F,null,p.children)}else{const v=Yr(t.snapshot),b=v?.get(h._Vd)??null;p.attachRef=null,p.route=t,p.resolver=b,p.injector=v,p.outlet&&p.outlet.activateWith(t,p.injector),this.activateChildRoutes(F,null,p.children)}}else this.activateChildRoutes(F,null,l)}}class Ta{constructor(F){this.path=F,this.route=this.path[this.path.length-1]}}class ee{constructor(F,S){this.component=F,this.route=S}}function X(P,F,S){const l=P._root;return dn(l,F?F._root:null,S,[l.value])}function Te(P,F){const S=Symbol(),l=F.get(P,S);return l===S?"function"!=typeof P||(0,h.Z0I)(P)?F.get(P):P:l}function dn(P,F,S,l,t={canDeactivateChecks:[],canActivateChecks:[]}){const s=us(F);return P.children.forEach(p=>{(function ti(P,F,S,l,t={canDeactivateChecks:[],canActivateChecks:[]}){const s=P.value,p=F?F.value:null,v=S?S.getContext(P.value.outlet):null;if(p&&s.routeConfig===p.routeConfig){const b=function Nr(P,F,S){if("function"==typeof S)return S(P,F);switch(S){case"pathParamsChange":return!kt(P.url,F.url);case"pathParamsOrQueryParamsChange":return!kt(P.url,F.url)||!Ui(P.queryParams,F.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!zs(P,F)||!Ui(P.queryParams,F.queryParams);default:return!zs(P,F)}}(p,s,s.routeConfig.runGuardsAndResolvers);b?t.canActivateChecks.push(new Ta(l)):(s.data=p.data,s._resolvedData=p._resolvedData),dn(P,F,s.component?v?v.children:null:S,l,t),b&&v&&v.outlet&&v.outlet.isActivated&&t.canDeactivateChecks.push(new ee(v.outlet.component,p))}else p&&lo(F,v,t),t.canActivateChecks.push(new Ta(l)),dn(P,null,s.component?v?v.children:null:S,l,t)})(p,s[p.value.outlet],S,l.concat([p.value]),t),delete s[p.value.outlet]}),re(s,(p,v)=>lo(p,S.getContext(v),t)),t}function lo(P,F,S){const l=us(P),t=P.value;re(l,(s,p)=>{lo(s,t.component?F?F.children.getContext(p):null:F,S)}),S.canDeactivateChecks.push(new ee(t.component&&F&&F.outlet&&F.outlet.isActivated?F.outlet.component:null,t))}function Vo(P){return"function"==typeof P}function ca(P){return P instanceof se||"EmptyError"===P?.name}const js=Symbol("INITIAL_VALUE");function co(){return(0,Ee.w)(P=>he(P.map(F=>F.pipe((0,vt.q)(1),function Et(...P){const F=(0,Q.yG)(P);return(0,we.e)((S,l)=>{(F?(0,te.z)(P,S,F):(0,te.z)(P,S)).subscribe(l)})}(js)))).pipe((0,ae.U)(F=>{for(const S of F)if(!0!==S){if(S===js)return js;if(!1===S||S instanceof Er)return S}return!0}),(0,qt.h)(F=>F!==js),(0,vt.q)(1)))}function ve(P){return(0,Ot.z)(Ce(F=>{if(Cr(F))throw Wo(0,F)}),(0,ae.U)(F=>!0===F))}const Cn={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function Zn(P,F,S,l,t){const s=Ei(P,F,S);return s.matched?function St(P,F,S,l){const t=F.canMatch;if(!t||0===t.length)return(0,ie.of)(!0);const s=t.map(p=>{const v=Te(p,P);return tt(function Il(P){return P&&Vo(P.canMatch)}(v)?v.canMatch(F,S):P.runInContext(()=>v(F,S)))});return(0,ie.of)(s).pipe(co(),ve())}(l=Ts(F,l),F,S).pipe((0,ae.U)(p=>!0===p?s:{...Cn})):(0,ie.of)(s)}function Ei(P,F,S){if(""===F.path)return"full"===F.pathMatch&&(P.hasChildren()||S.length>0)?{...Cn}:{matched:!0,consumedSegments:[],remainingSegments:S,parameters:{},positionalParamSegments:{}};const t=(F.matcher||Ni)(S,P,F);if(!t)return{...Cn};const s={};re(t.posParams,(v,b)=>{s[b]=v.path});const p=t.consumed.length>0?{...s,...t.consumed[t.consumed.length-1].parameters}:s;return{matched:!0,consumedSegments:t.consumed,remainingSegments:S.slice(t.consumed.length),parameters:p,positionalParamSegments:t.posParams??{}}}function ii(P,F,S,l){if(S.length>0&&function or(P,F,S){return S.some(l=>eo(P,F,l)&&Co(l)!==Un)}(P,S,l)){const s=new ui(F,function ur(P,F,S,l){const t={};t[Un]=l,l._sourceSegment=P,l._segmentIndexShift=F.length;for(const s of S)if(""===s.path&&Co(s)!==Un){const p=new ui([],{});p._sourceSegment=P,p._segmentIndexShift=F.length,t[Co(s)]=p}return t}(P,F,l,new ui(S,P.children)));return s._sourceSegment=P,s._segmentIndexShift=F.length,{segmentGroup:s,slicedSegments:[]}}if(0===S.length&&function uo(P,F,S){return S.some(l=>eo(P,F,l))}(P,S,l)){const s=new ui(P.segments,function Xi(P,F,S,l,t){const s={};for(const p of l)if(eo(P,S,p)&&!t[Co(p)]){const v=new ui([],{});v._sourceSegment=P,v._segmentIndexShift=F.length,s[Co(p)]=v}return{...t,...s}}(P,F,S,l,P.children));return s._sourceSegment=P,s._segmentIndexShift=F.length,{segmentGroup:s,slicedSegments:S}}const t=new ui(P.segments,P.children);return t._sourceSegment=P,t._segmentIndexShift=F.length,{segmentGroup:t,slicedSegments:S}}function eo(P,F,S){return(!(P.hasChildren()||F.length>0)||"full"!==S.pathMatch)&&""===S.path}function Ds(P,F,S,l){return!!(Co(P)===l||l!==Un&&eo(F,S,P))&&("**"===P.path||Ei(F,P,S).matched)}function Is(P,F,S){return 0===F.length&&!P.children[S]}const Ba=!1;class za{constructor(F){this.segmentGroup=F||null}}class da{constructor(F){this.urlTree=F}}function Ms(P){return ye(new za(P))}function Hl(P){return ye(new da(P))}class vr{constructor(F,S,l,t,s){this.injector=F,this.configLoader=S,this.urlSerializer=l,this.urlTree=t,this.config=s,this.allowRedirects=!0}apply(){const F=ii(this.urlTree.root,[],[],this.config).segmentGroup,S=new ui(F.segments,F.children);return this.expandSegmentGroup(this.injector,this.config,S,Un).pipe((0,ae.U)(s=>this.createUrlTree(Bi(s),this.urlTree.queryParams,this.urlTree.fragment))).pipe(Ut(s=>{if(s instanceof da)return this.allowRedirects=!1,this.match(s.urlTree);throw s instanceof za?this.noMatchError(s):s}))}match(F){return this.expandSegmentGroup(this.injector,this.config,F.root,Un).pipe((0,ae.U)(t=>this.createUrlTree(Bi(t),F.queryParams,F.fragment))).pipe(Ut(t=>{throw t instanceof za?this.noMatchError(t):t}))}noMatchError(F){return new h.vHH(4002,Ba)}createUrlTree(F,S,l){const t=Vi(F);return new Er(t,S,l)}expandSegmentGroup(F,S,l,t){return 0===l.segments.length&&l.hasChildren()?this.expandChildren(F,S,l).pipe((0,ae.U)(s=>new ui([],s))):this.expandSegment(F,l,S,l.segments,t,!0)}expandChildren(F,S,l){const t=[];for(const s of Object.keys(l.children))"primary"===s?t.unshift(s):t.push(s);return(0,g.D)(t).pipe((0,ht.b)(s=>{const p=l.children[s],v=ms(S,s);return this.expandSegmentGroup(F,v,p,s).pipe((0,ae.U)(b=>({segment:b,outlet:s})))}),wn((s,p)=>(s[p.outlet]=p.segment,s),{}),un())}expandSegment(F,S,l,t,s,p){return(0,g.D)(l).pipe((0,ht.b)(v=>this.expandSegmentAgainstRoute(F,S,l,v,t,s,p).pipe(Ut(D=>{if(D instanceof za)return(0,ie.of)(null);throw D}))),ct(v=>!!v),Ut((v,b)=>{if(ca(v))return Is(S,t,s)?(0,ie.of)(new ui([],{})):Ms(S);throw v}))}expandSegmentAgainstRoute(F,S,l,t,s,p,v){return Ds(t,S,s,p)?void 0===t.redirectTo?this.matchSegmentAgainstRoute(F,S,t,s,p):v&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(F,S,l,t,s,p):Ms(S):Ms(S)}expandSegmentAgainstRouteUsingRedirect(F,S,l,t,s,p){return"**"===t.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(F,l,t,p):this.expandRegularSegmentAgainstRouteUsingRedirect(F,S,l,t,s,p)}expandWildCardWithParamsAgainstRouteUsingRedirect(F,S,l,t){const s=this.applyRedirectCommands([],l.redirectTo,{});return l.redirectTo.startsWith("/")?Hl(s):this.lineralizeSegments(l,s).pipe((0,Ft.z)(p=>{const v=new ui(p,{});return this.expandSegment(F,v,S,p,t,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(F,S,l,t,s,p){const{matched:v,consumedSegments:b,remainingSegments:D,positionalParamSegments:O}=Ei(S,t,s);if(!v)return Ms(S);const k=this.applyRedirectCommands(b,t.redirectTo,O);return t.redirectTo.startsWith("/")?Hl(k):this.lineralizeSegments(t,k).pipe((0,Ft.z)(H=>this.expandSegment(F,S,l,H.concat(D),p,!1)))}matchSegmentAgainstRoute(F,S,l,t,s){return"**"===l.path?(F=Ts(l,F),l.loadChildren?(l._loadedRoutes?(0,ie.of)({routes:l._loadedRoutes,injector:l._loadedInjector}):this.configLoader.loadChildren(F,l)).pipe((0,ae.U)(v=>(l._loadedRoutes=v.routes,l._loadedInjector=v.injector,new ui(t,{})))):(0,ie.of)(new ui(t,{}))):Zn(S,l,t,F).pipe((0,Ee.w)(({matched:p,consumedSegments:v,remainingSegments:b})=>p?this.getChildConfig(F=l._injector??F,l,t).pipe((0,Ft.z)(O=>{const k=O.injector??F,H=O.routes,{segmentGroup:J,slicedSegments:ue}=ii(S,v,b,H),De=new ui(J.segments,J.children);if(0===ue.length&&De.hasChildren())return this.expandChildren(k,H,De).pipe((0,ae.U)($e=>new ui(v,$e)));if(0===H.length&&0===ue.length)return(0,ie.of)(new ui(v,{}));const je=Co(l)===s;return this.expandSegment(k,De,H,ue,je?Un:s,!0).pipe((0,ae.U)(Ye=>new ui(v.concat(Ye.segments),Ye.children)))})):Ms(S)))}getChildConfig(F,S,l){return S.children?(0,ie.of)({routes:S.children,injector:F}):S.loadChildren?void 0!==S._loadedRoutes?(0,ie.of)({routes:S._loadedRoutes,injector:S._loadedInjector}):function $(P,F,S,l){const t=F.canLoad;if(void 0===t||0===t.length)return(0,ie.of)(!0);const s=t.map(p=>{const v=Te(p,P);return tt(function El(P){return P&&Vo(P.canLoad)}(v)?v.canLoad(F,S):P.runInContext(()=>v(F,S)))});return(0,ie.of)(s).pipe(co(),ve())}(F,S,l).pipe((0,Ft.z)(t=>t?this.configLoader.loadChildren(F,S).pipe(Ce(s=>{S._loadedRoutes=s.routes,S._loadedInjector=s.injector})):function _o(P){return ye(Js(Ba,3))}())):(0,ie.of)({routes:[],injector:F})}lineralizeSegments(F,S){let l=[],t=S.root;for(;;){if(l=l.concat(t.segments),0===t.numberOfChildren)return(0,ie.of)(l);if(t.numberOfChildren>1||!t.children[Un])return ye(new h.vHH(4e3,Ba));t=t.children[Un]}}applyRedirectCommands(F,S,l){return this.applyRedirectCreateUrlTree(S,this.urlSerializer.parse(S),F,l)}applyRedirectCreateUrlTree(F,S,l,t){const s=this.createSegmentGroup(F,S.root,l,t);return new Er(s,this.createQueryParams(S.queryParams,this.urlTree.queryParams),S.fragment)}createQueryParams(F,S){const l={};return re(F,(t,s)=>{if("string"==typeof t&&t.startsWith(":")){const v=t.substring(1);l[s]=S[v]}else l[s]=t}),l}createSegmentGroup(F,S,l,t){const s=this.createSegments(F,S.segments,l,t);let p={};return re(S.children,(v,b)=>{p[b]=this.createSegmentGroup(F,v,l,t)}),new ui(s,p)}createSegments(F,S,l,t){return S.map(s=>s.path.startsWith(":")?this.findPosParam(F,s,t):this.findOrReturn(s,l))}findPosParam(F,S,l){const t=l[S.path.substring(1)];if(!t)throw new h.vHH(4001,Ba);return t}findOrReturn(F,S){let l=0;for(const t of S){if(t.path===F.path)return S.splice(l),t;l++}return F}}class W{}class fn{constructor(F,S,l,t,s,p,v){this.injector=F,this.rootComponentType=S,this.config=l,this.urlTree=t,this.url=s,this.paramsInheritanceStrategy=p,this.urlSerializer=v}recognize(){const F=ii(this.urlTree.root,[],[],this.config.filter(S=>void 0===S.redirectTo)).segmentGroup;return this.processSegmentGroup(this.injector,this.config,F,Un).pipe((0,ae.U)(S=>{if(null===S)return null;const l=new go([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},Un,this.rootComponentType,null,this.urlTree.root,-1,{}),t=new Ho(l,S),s=new xa(this.url,t);return this.inheritParamsAndData(s._root),s}))}inheritParamsAndData(F){const S=F.value,l=No(S,this.paramsInheritanceStrategy);S.params=Object.freeze(l.params),S.data=Object.freeze(l.data),F.children.forEach(t=>this.inheritParamsAndData(t))}processSegmentGroup(F,S,l,t){return 0===l.segments.length&&l.hasChildren()?this.processChildren(F,S,l):this.processSegment(F,S,l,l.segments,t)}processChildren(F,S,l){return(0,g.D)(Object.keys(l.children)).pipe((0,ht.b)(t=>{const s=l.children[t],p=ms(S,t);return this.processSegmentGroup(F,p,s,t)}),wn((t,s)=>t&&s?(t.push(...s),t):null),function ut(P,F=!1){return(0,we.e)((S,l)=>{let t=0;S.subscribe((0,me.x)(l,s=>{const p=P(s,t++);(p||F)&&l.next(s),!p&&l.complete()}))})}(t=>null!==t),xt(null),un(),(0,ae.U)(t=>{if(null===t)return null;const s=nr(t);return function Tn(P){P.sort((F,S)=>F.value.outlet===Un?-1:S.value.outlet===Un?1:F.value.outlet.localeCompare(S.value.outlet))}(s),s}))}processSegment(F,S,l,t,s){return(0,g.D)(S).pipe((0,ht.b)(p=>this.processSegmentAgainstRoute(p._injector??F,p,l,t,s)),ct(p=>!!p),Ut(p=>{if(ca(p))return Is(l,t,s)?(0,ie.of)([]):(0,ie.of)(null);throw p}))}processSegmentAgainstRoute(F,S,l,t,s){if(S.redirectTo||!Ds(S,l,t,s))return(0,ie.of)(null);let p;if("**"===S.path){const v=t.length>0?Mt(t).parameters:{},b=Sr(l)+t.length,D=new go(t,v,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,to(S),Co(S),S.component??S._loadedComponent??null,S,Wi(l),b,jo(S));p=(0,ie.of)({snapshot:D,consumedSegments:[],remainingSegments:[]})}else p=Zn(l,S,t,F).pipe((0,ae.U)(({matched:v,consumedSegments:b,remainingSegments:D,parameters:O})=>{if(!v)return null;const k=Sr(l)+b.length;return{snapshot:new go(b,O,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,to(S),Co(S),S.component??S._loadedComponent??null,S,Wi(l),k,jo(S)),consumedSegments:b,remainingSegments:D}}));return p.pipe((0,Ee.w)(v=>{if(null===v)return(0,ie.of)(null);const{snapshot:b,consumedSegments:D,remainingSegments:O}=v;F=S._injector??F;const k=S._loadedInjector??F,H=function li(P){return P.children?P.children:P.loadChildren?P._loadedRoutes:[]}(S),{segmentGroup:J,slicedSegments:ue}=ii(l,D,O,H.filter(je=>void 0===je.redirectTo));if(0===ue.length&&J.hasChildren())return this.processChildren(k,H,J).pipe((0,ae.U)(je=>null===je?null:[new Ho(b,je)]));if(0===H.length&&0===ue.length)return(0,ie.of)([new Ho(b,[])]);const De=Co(S)===s;return this.processSegment(k,H,J,ue,De?Un:s).pipe((0,ae.U)(je=>null===je?null:[new Ho(b,je)]))}))}}function sr(P){const F=P.value.routeConfig;return F&&""===F.path&&void 0===F.redirectTo}function nr(P){const F=[],S=new Set;for(const l of P){if(!sr(l)){F.push(l);continue}const t=F.find(s=>l.value.routeConfig===s.value.routeConfig);void 0!==t?(t.children.push(...l.children),S.add(t)):F.push(l)}for(const l of S){const t=nr(l.children);F.push(new Ho(l.value,t))}return F.filter(l=>!S.has(l))}function Wi(P){let F=P;for(;F._sourceSegment;)F=F._sourceSegment;return F}function Sr(P){let F=P,S=F._segmentIndexShift??0;for(;F._sourceSegment;)F=F._sourceSegment,S+=F._segmentIndexShift??0;return S-1}function to(P){return P.data||{}}function jo(P){return P.resolve||{}}function $s(P){return"string"==typeof P.title||null===P.title}function Yl(P){return(0,Ee.w)(F=>{const S=P(F);return S?(0,g.D)(S).pipe((0,ae.U)(()=>F)):(0,ie.of)(F)})}const pa=new h.OlP("ROUTES");let Xl=(()=>{class P{constructor(S,l){this.injector=S,this.compiler=l,this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap}loadComponent(S){if(this.componentLoaders.get(S))return this.componentLoaders.get(S);if(S._loadedComponent)return(0,ie.of)(S._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(S);const l=tt(S.loadComponent()).pipe((0,ae.U)(fa),Ce(s=>{this.onLoadEndListener&&this.onLoadEndListener(S),S._loadedComponent=s}),En(()=>{this.componentLoaders.delete(S)})),t=new Je(l,()=>new _e.x).pipe(et());return this.componentLoaders.set(S,t),t}loadChildren(S,l){if(this.childrenLoaders.get(l))return this.childrenLoaders.get(l);if(l._loadedRoutes)return(0,ie.of)({routes:l._loadedRoutes,injector:l._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(l);const s=this.loadModuleFactoryOrRoutes(l.loadChildren).pipe((0,ae.U)(v=>{this.onLoadEndListener&&this.onLoadEndListener(l);let b,D,O=!1;Array.isArray(v)?D=v:(b=v.create(S).injector,D=Ht(b.get(pa,[],h.XFs.Self|h.XFs.Optional)));return{routes:D.map(wa),injector:b}}),En(()=>{this.childrenLoaders.delete(l)})),p=new Je(s,()=>new _e.x).pipe(et());return this.childrenLoaders.set(l,p),p}loadModuleFactoryOrRoutes(S){return tt(S()).pipe((0,ae.U)(fa),(0,Ft.z)(t=>t instanceof h.YKP||Array.isArray(t)?(0,ie.of)(t):(0,g.D)(this.compiler.compileModuleAsync(t))))}}return P.\u0275fac=function(S){return new(S||P)(h.LFG(h.zs3),h.LFG(h.Sil))},P.\u0275prov=h.Yz7({token:P,factory:P.\u0275fac,providedIn:"root"}),P})();function fa(P){return function Va(P){return P&&"object"==typeof P&&"default"in P}(P)?P.default:P}let ja=(()=>{class P{constructor(){this.currentNavigation=null,this.lastSuccessfulNavigation=null,this.events=new _e.x,this.configLoader=(0,h.f3M)(Xl),this.environmentInjector=(0,h.f3M)(h.lqb),this.urlSerializer=(0,h.f3M)(Ve),this.rootContexts=(0,h.f3M)(qr),this.navigationId=0,this.configLoader.onLoadEndListener=t=>this.events.next(new bo(t)),this.configLoader.onLoadStartListener=t=>this.events.next(new mr(t))}get hasRequestedNavigation(){return 0!==this.navigationId}complete(){this.transitions?.complete()}handleNavigationRequest(S){const l=++this.navigationId;this.transitions?.next({...this.transitions.value,...S,id:l})}setupNavigations(S){return this.transitions=new c.X({id:0,targetPageId:0,currentUrlTree:S.currentUrlTree,currentRawUrl:S.currentUrlTree,extractedUrl:S.urlHandlingStrategy.extract(S.currentUrlTree),urlAfterRedirects:S.urlHandlingStrategy.extract(S.currentUrlTree),rawUrl:S.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:S.routerState.snapshot,targetSnapshot:null,currentRouterState:S.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe((0,qt.h)(l=>0!==l.id),(0,ae.U)(l=>({...l,extractedUrl:S.urlHandlingStrategy.extract(l.rawUrl)})),(0,Ee.w)(l=>{let t=!1,s=!1;return(0,ie.of)(l).pipe(Ce(p=>{this.currentNavigation={id:p.id,initialUrl:p.rawUrl,extractedUrl:p.extractedUrl,trigger:p.source,extras:p.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null}}),(0,Ee.w)(p=>{const v=S.browserUrlTree.toString(),b=!S.navigated||p.extractedUrl.toString()!==v||v!==S.currentUrlTree.toString();if(("reload"===S.onSameUrlNavigation||b)&&S.urlHandlingStrategy.shouldProcessUrl(p.rawUrl))return Sl(p.source)&&(S.browserUrlTree=p.extractedUrl),(0,ie.of)(p).pipe((0,Ee.w)(O=>{const k=this.transitions?.getValue();return this.events.next(new ei(O.id,this.urlSerializer.serialize(O.extractedUrl),O.source,O.restoredState)),k!==this.transitions?.getValue()?Fe.E:Promise.resolve(O)}),function U(P,F,S,l){return(0,Ee.w)(t=>function Ea(P,F,S,l,t){return new vr(P,F,S,l,t).apply()}(P,F,S,t.extractedUrl,l).pipe((0,ae.U)(s=>({...t,urlAfterRedirects:s}))))}(this.environmentInjector,this.configLoader,this.urlSerializer,S.config),Ce(O=>{this.currentNavigation={...this.currentNavigation,finalUrl:O.urlAfterRedirects},l.urlAfterRedirects=O.urlAfterRedirects}),function Oo(P,F,S,l,t){return(0,Ft.z)(s=>function Tt(P,F,S,l,t,s,p="emptyOnly"){return new fn(P,F,S,l,t,p,s).recognize().pipe((0,Ee.w)(v=>null===v?function Me(P){return new y.y(F=>F.error(P))}(new W):(0,ie.of)(v)))}(P,F,S,s.urlAfterRedirects,l.serialize(s.urlAfterRedirects),l,t).pipe((0,ae.U)(p=>({...s,targetSnapshot:p}))))}(this.environmentInjector,S.rootComponentType,S.config,this.urlSerializer,S.paramsInheritanceStrategy),Ce(O=>{if(l.targetSnapshot=O.targetSnapshot,"eager"===S.urlUpdateStrategy){if(!O.extras.skipLocationChange){const H=S.urlHandlingStrategy.merge(O.urlAfterRedirects,O.rawUrl);S.setBrowserUrl(H,O)}S.browserUrlTree=O.urlAfterRedirects}const k=new jr(O.id,this.urlSerializer.serialize(O.extractedUrl),this.urlSerializer.serialize(O.urlAfterRedirects),O.targetSnapshot);this.events.next(k)}));if(b&&S.rawUrlTree&&S.urlHandlingStrategy.shouldProcessUrl(S.rawUrlTree)){const{id:k,extractedUrl:H,source:J,restoredState:ue,extras:De}=p,je=new ei(k,this.urlSerializer.serialize(H),J,ue);this.events.next(je);const ke=Bs(H,S.rootComponentType).snapshot;return l={...p,targetSnapshot:ke,urlAfterRedirects:H,extras:{...De,skipLocationChange:!1,replaceUrl:!1}},(0,ie.of)(l)}return S.rawUrlTree=p.rawUrl,p.resolve(null),Fe.E}),Ce(p=>{const v=new Rr(p.id,this.urlSerializer.serialize(p.extractedUrl),this.urlSerializer.serialize(p.urlAfterRedirects),p.targetSnapshot);this.events.next(v)}),(0,ae.U)(p=>l={...p,guards:X(p.targetSnapshot,p.currentSnapshot,this.rootContexts)}),function Xs(P,F){return(0,Ft.z)(S=>{const{targetSnapshot:l,currentSnapshot:t,guards:{canActivateChecks:s,canDeactivateChecks:p}}=S;return 0===p.length&&0===s.length?(0,ie.of)({...S,guardsResult:!0}):function ua(P,F,S,l){return(0,g.D)(P).pipe((0,Ft.z)(t=>function I(P,F,S,l,t){const s=F&&F.routeConfig?F.routeConfig.canDeactivate:null;if(!s||0===s.length)return(0,ie.of)(!0);const p=s.map(v=>{const b=Yr(F)??t,D=Te(v,b);return tt(function Ji(P){return P&&Vo(P.canDeactivate)}(D)?D.canDeactivate(P,F,S,l):b.runInContext(()=>D(P,F,S,l))).pipe(ct())});return(0,ie.of)(p).pipe(co())}(t.component,t.route,S,F,l)),ct(t=>!0!==t,!0))}(p,l,t,P).pipe((0,Ft.z)(v=>v&&function la(P){return"boolean"==typeof P}(v)?function Tc(P,F,S,l){return(0,g.D)(F).pipe((0,ht.b)(t=>(0,te.z)(function ol(P,F){return null!==P&&F&&F(new io(P)),(0,ie.of)(!0)}(t.route.parent,l),function rl(P,F){return null!==P&&F&&F(new Io(P)),(0,ie.of)(!0)}(t.route,l),function Z(P,F,S){const l=F[F.length-1],s=F.slice(0,F.length-1).reverse().map(p=>function q(P){const F=P.routeConfig?P.routeConfig.canActivateChild:null;return F&&0!==F.length?{node:P,guards:F}:null}(p)).filter(p=>null!==p).map(p=>(0,Qe.P)(()=>{const v=p.guards.map(b=>{const D=Yr(p.node)??S,O=Te(b,D);return tt(function Dn(P){return P&&Vo(P.canActivateChild)}(O)?O.canActivateChild(l,P):D.runInContext(()=>O(l,P))).pipe(ct())});return(0,ie.of)(v).pipe(co())}));return(0,ie.of)(s).pipe(co())}(P,t.path,S),function E(P,F,S){const l=F.routeConfig?F.routeConfig.canActivate:null;if(!l||0===l.length)return(0,ie.of)(!0);const t=l.map(s=>(0,Qe.P)(()=>{const p=Yr(F)??S,v=Te(s,p);return tt(function Dl(P){return P&&Vo(P.canActivate)}(v)?v.canActivate(F,P):p.runInContext(()=>v(F,P))).pipe(ct())}));return(0,ie.of)(t).pipe(co())}(P,t.route,S))),ct(t=>!0!==t,!0))}(l,s,P,F):(0,ie.of)(v)),(0,ae.U)(v=>({...S,guardsResult:v})))})}(this.environmentInjector,p=>this.events.next(p)),Ce(p=>{if(l.guardsResult=p.guardsResult,Cr(p.guardsResult))throw Wo(0,p.guardsResult);const v=new tr(p.id,this.urlSerializer.serialize(p.extractedUrl),this.urlSerializer.serialize(p.urlAfterRedirects),p.targetSnapshot,!!p.guardsResult);this.events.next(v)}),(0,qt.h)(p=>!!p.guardsResult||(S.restoreHistory(p),this.cancelNavigationTransition(p,"",3,S),!1)),Yl(p=>{if(p.guards.canActivateChecks.length)return(0,ie.of)(p).pipe(Ce(v=>{const b=new fr(v.id,this.urlSerializer.serialize(v.extractedUrl),this.urlSerializer.serialize(v.urlAfterRedirects),v.targetSnapshot);this.events.next(b)}),(0,Ee.w)(v=>{let b=!1;return(0,ie.of)(v).pipe(function Gn(P,F){return(0,Ft.z)(S=>{const{targetSnapshot:l,guards:{canActivateChecks:t}}=S;if(!t.length)return(0,ie.of)(S);let s=0;return(0,g.D)(t).pipe((0,ht.b)(p=>function ho(P,F,S,l){const t=P.routeConfig,s=P._resolve;return void 0!==t?.title&&!$s(t)&&(s[_i]=t.title),function Na(P,F,S,l){const t=function Wl(P){return[...Object.keys(P),...Object.getOwnPropertySymbols(P)]}(P);if(0===t.length)return(0,ie.of)({});const s={};return(0,g.D)(t).pipe((0,Ft.z)(p=>function ql(P,F,S,l){const t=Yr(F)??l,s=Te(P,t);return tt(s.resolve?s.resolve(F,S):t.runInContext(()=>s(F,S)))}(P[p],F,S,l).pipe(ct(),Ce(v=>{s[p]=v}))),Fn(1),function jt(P){return(0,ae.U)(()=>P)}(s),Ut(p=>ca(p)?Fe.E:ye(p)))}(s,P,F,l).pipe((0,ae.U)(p=>(P._resolvedData=p,P.data=No(P,S).resolve,t&&$s(t)&&(P.data[_i]=t.title),null)))}(p.route,l,P,F)),Ce(()=>s++),Fn(1),(0,Ft.z)(p=>s===t.length?(0,ie.of)(S):Fe.E))})}(S.paramsInheritanceStrategy,this.environmentInjector),Ce({next:()=>b=!0,complete:()=>{b||(S.restoreHistory(v),this.cancelNavigationTransition(v,"",2,S))}}))}),Ce(v=>{const b=new es(v.id,this.urlSerializer.serialize(v.extractedUrl),this.urlSerializer.serialize(v.urlAfterRedirects),v.targetSnapshot);this.events.next(b)}))}),Yl(p=>{const v=b=>{const D=[];b.routeConfig?.loadComponent&&!b.routeConfig._loadedComponent&&D.push(this.configLoader.loadComponent(b.routeConfig).pipe(Ce(O=>{b.component=O}),(0,ae.U)(()=>{})));for(const O of b.children)D.push(...v(O));return D};return he(v(p.targetSnapshot.root)).pipe(xt(),(0,vt.q)(1))}),Yl(()=>S.afterPreactivation()),(0,ae.U)(p=>{const v=function il(P,F,S){const l=Uo(P,F._root,S?S._root:void 0);return new ds(l,F)}(S.routeReuseStrategy,p.targetSnapshot,p.currentRouterState);return l={...p,targetRouterState:v}}),Ce(p=>{S.currentUrlTree=p.urlAfterRedirects,S.rawUrlTree=S.urlHandlingStrategy.merge(p.urlAfterRedirects,p.rawUrl),S.routerState=p.targetRouterState,"deferred"===S.urlUpdateStrategy&&(p.extras.skipLocationChange||S.setBrowserUrl(S.rawUrlTree,p),S.browserUrlTree=p.urlAfterRedirects)}),((P,F,S)=>(0,ae.U)(l=>(new Ca(F,l.targetRouterState,l.currentRouterState,S).activate(P),l)))(this.rootContexts,S.routeReuseStrategy,p=>this.events.next(p)),Ce({next:p=>{t=!0,this.lastSuccessfulNavigation=this.currentNavigation,S.navigated=!0,this.events.next(new Ci(p.id,this.urlSerializer.serialize(p.extractedUrl),this.urlSerializer.serialize(S.currentUrlTree))),S.titleStrategy?.updateTitle(p.targetRouterState.snapshot),p.resolve(!0)},complete:()=>{t=!0}}),En(()=>{t||s||this.cancelNavigationTransition(l,"",1,S),this.currentNavigation?.id===l.id&&(this.currentNavigation=null)}),Ut(p=>{if(s=!0,ws(p)){ts(p)||(S.navigated=!0,S.restoreHistory(l,!0));const v=new qi(l.id,this.urlSerializer.serialize(l.extractedUrl),p.message,p.cancellationCode);if(this.events.next(v),ts(p)){const b=S.urlHandlingStrategy.merge(p.url,S.rawUrlTree),D={skipLocationChange:l.extras.skipLocationChange,replaceUrl:"eager"===S.urlUpdateStrategy||Sl(l.source)};S.scheduleNavigation(b,"imperative",null,D,{resolve:l.resolve,reject:l.reject,promise:l.promise})}else l.resolve(!1)}else{S.restoreHistory(l,!0);const v=new ki(l.id,this.urlSerializer.serialize(l.extractedUrl),p,l.targetSnapshot??void 0);this.events.next(v);try{l.resolve(S.errorHandler(p))}catch(b){l.reject(b)}}return Fe.E}))}))}cancelNavigationTransition(S,l,t,s){const p=new qi(S.id,this.urlSerializer.serialize(S.extractedUrl),l,t);this.events.next(p),S.resolve(!1)}}return P.\u0275fac=function(S){return new(S||P)},P.\u0275prov=h.Yz7({token:P,factory:P.\u0275fac,providedIn:"root"}),P})();function Sl(P){return"imperative"!==P}let Ec=(()=>{class P{buildTitle(S){let l,t=S.root;for(;void 0!==t;)l=this.getResolvedTitleForRoute(t)??l,t=t.children.find(s=>s.outlet===Un);return l}getResolvedTitleForRoute(S){return S.data[_i]}}return P.\u0275fac=function(S){return new(S||P)},P.\u0275prov=h.Yz7({token:P,factory:function(){return(0,h.f3M)(Dc)},providedIn:"root"}),P})(),Dc=(()=>{class P extends Ec{constructor(S){super(),this.title=S}updateTitle(S){const l=this.buildTitle(S);void 0!==l&&this.title.setTitle(l)}}return P.\u0275fac=function(S){return new(S||P)(h.LFG(ci.Dx))},P.\u0275prov=h.Yz7({token:P,factory:P.\u0275fac,providedIn:"root"}),P})(),Ic=(()=>{class P{}return P.\u0275fac=function(S){return new(S||P)},P.\u0275prov=h.Yz7({token:P,factory:function(){return(0,h.f3M)(Ss)},providedIn:"root"}),P})();class Mc{shouldDetach(F){return!1}store(F,S){}shouldAttach(F){return!1}retrieve(F){return null}shouldReuseRoute(F,S){return F.routeConfig===S.routeConfig}}let Ss=(()=>{class P extends Mc{}return P.\u0275fac=function(){let F;return function(l){return(F||(F=h.n5z(P)))(l||P)}}(),P.\u0275prov=h.Yz7({token:P,factory:P.\u0275fac,providedIn:"root"}),P})();const $a=new h.OlP("",{providedIn:"root",factory:()=>({})});let Sc=(()=>{class P{}return P.\u0275fac=function(S){return new(S||P)},P.\u0275prov=h.Yz7({token:P,factory:function(){return(0,h.f3M)(Ql)},providedIn:"root"}),P})(),Ql=(()=>{class P{shouldProcessUrl(S){return!0}extract(S){return S}merge(S,l){return S}}return P.\u0275fac=function(S){return new(S||P)},P.\u0275prov=h.Yz7({token:P,factory:P.\u0275fac,providedIn:"root"}),P})();function tc(P){throw P}function sl(P,F,S){return F.parse("/")}const Qc={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},nc={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let To=(()=>{class P{constructor(){this.disposed=!1,this.currentPageId=0,this.console=(0,h.f3M)(h.c2e),this.isNgZoneEnabled=!1,this.options=(0,h.f3M)($a,{optional:!0})||{},this.errorHandler=this.options.errorHandler||tc,this.malformedUriErrorHandler=this.options.malformedUriErrorHandler||sl,this.navigated=!1,this.lastSuccessfulId=-1,this.afterPreactivation=()=>(0,ie.of)(void 0),this.urlHandlingStrategy=(0,h.f3M)(Sc),this.routeReuseStrategy=(0,h.f3M)(Ic),this.urlCreationStrategy=(0,h.f3M)(xs),this.titleStrategy=(0,h.f3M)(Ec),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.config=Ht((0,h.f3M)(pa,{optional:!0})??[]),this.navigationTransitions=(0,h.f3M)(ja),this.urlSerializer=(0,h.f3M)(Ve),this.location=(0,h.f3M)(pe.Ye),this.rootComponentType=null,this.isNgZoneEnabled=(0,h.f3M)(h.R0b)instanceof h.R0b&&h.R0b.isInAngularZone(),this.resetConfig(this.config),this.currentUrlTree=new Er,this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.routerState=Bs(this.currentUrlTree,this.rootComponentType),this.navigationTransitions.setupNavigations(this).subscribe(S=>{this.lastSuccessfulId=S.id,this.currentPageId=S.targetPageId},S=>{this.console.warn(`Unhandled Navigation Error: ${S}`)})}get navigationId(){return this.navigationTransitions.navigationId}get browserPageId(){return this.location.getState()?.\u0275routerPageId}get events(){return this.navigationTransitions.events}resetRootComponentType(S){this.rootComponentType=S,this.routerState.root.component=this.rootComponentType}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(S=>{const l="popstate"===S.type?"popstate":"hashchange";"popstate"===l&&setTimeout(()=>{const t={replaceUrl:!0},s=S.state?.navigationId?S.state:null;if(S.state){const v={...S.state};delete v.navigationId,delete v.\u0275routerPageId,0!==Object.keys(v).length&&(t.state=v)}const p=this.parseUrl(S.url);this.scheduleNavigation(p,l,s,t)},0)}))}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}resetConfig(S){this.config=S.map(wa),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(S,l={}){const{relativeTo:t,queryParams:s,fragment:p,queryParamsHandling:v,preserveFragment:b}=l,D=b?this.currentUrlTree.fragment:p;let O=null;switch(v){case"merge":O={...this.currentUrlTree.queryParams,...s};break;case"preserve":O=this.currentUrlTree.queryParams;break;default:O=s||null}return null!==O&&(O=this.removeEmptyProps(O)),this.urlCreationStrategy.createUrlTree(t,this.routerState,this.currentUrlTree,S,O,D??null)}navigateByUrl(S,l={skipLocationChange:!1}){const t=Cr(S)?S:this.parseUrl(S),s=this.urlHandlingStrategy.merge(t,this.rawUrlTree);return this.scheduleNavigation(s,"imperative",null,l)}navigate(S,l={skipLocationChange:!1}){return function Ac(P){for(let F=0;F<P.length;F++){if(null==P[F])throw new h.vHH(4008,!1)}}(S),this.navigateByUrl(this.createUrlTree(S,l),l)}serializeUrl(S){return this.urlSerializer.serialize(S)}parseUrl(S){let l;try{l=this.urlSerializer.parse(S)}catch(t){l=this.malformedUriErrorHandler(t,this.urlSerializer,S)}return l}isActive(S,l){let t;if(t=!0===l?{...Qc}:!1===l?{...nc}:l,Cr(S))return Ai(this.currentUrlTree,S,t);const s=this.parseUrl(S);return Ai(this.currentUrlTree,s,t)}removeEmptyProps(S){return Object.keys(S).reduce((l,t)=>{const s=S[t];return null!=s&&(l[t]=s),l},{})}scheduleNavigation(S,l,t,s,p){if(this.disposed)return Promise.resolve(!1);let v,b,D,O;return p?(v=p.resolve,b=p.reject,D=p.promise):D=new Promise((k,H)=>{v=k,b=H}),"computed"===this.canceledNavigationResolution?(0===this.currentPageId&&(t=this.location.getState()),O=t&&t.\u0275routerPageId?t.\u0275routerPageId:s.replaceUrl||s.skipLocationChange?this.browserPageId??0:(this.browserPageId??0)+1):O=0,this.navigationTransitions.handleNavigationRequest({targetPageId:O,source:l,restoredState:t,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:S,extras:s,resolve:v,reject:b,promise:D,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),D.catch(k=>Promise.reject(k))}setBrowserUrl(S,l){const t=this.urlSerializer.serialize(S),s={...l.extras.state,...this.generateNgRouterState(l.id,l.targetPageId)};this.location.isCurrentPathEqualTo(t)||l.extras.replaceUrl?this.location.replaceState(t,"",s):this.location.go(t,"",s)}restoreHistory(S,l=!1){if("computed"===this.canceledNavigationResolution){const t=this.currentPageId-S.targetPageId;"popstate"!==S.source&&"eager"!==this.urlUpdateStrategy&&this.currentUrlTree!==this.getCurrentNavigation()?.finalUrl||0===t?this.currentUrlTree===this.getCurrentNavigation()?.finalUrl&&0===t&&(this.resetState(S),this.browserUrlTree=S.currentUrlTree,this.resetUrlToCurrentUrlTree()):this.location.historyGo(t)}else"replace"===this.canceledNavigationResolution&&(l&&this.resetState(S),this.resetUrlToCurrentUrlTree())}resetState(S){this.routerState=S.currentRouterState,this.currentUrlTree=S.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,S.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(S,l){return"computed"===this.canceledNavigationResolution?{navigationId:S,\u0275routerPageId:l}:{navigationId:S}}}return P.\u0275fac=function(S){return new(S||P)},P.\u0275prov=h.Yz7({token:P,factory:P.\u0275fac,providedIn:"root"}),P})(),ic=(()=>{class P{constructor(S,l,t,s,p,v){this.router=S,this.route=l,this.tabIndexAttribute=t,this.renderer=s,this.el=p,this.locationStrategy=v,this._preserveFragment=!1,this._skipLocationChange=!1,this._replaceUrl=!1,this.href=null,this.commands=null,this.onChanges=new _e.x;const b=p.nativeElement.tagName;this.isAnchorElement="A"===b||"AREA"===b,this.isAnchorElement?this.subscription=S.events.subscribe(D=>{D instanceof Ci&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}set preserveFragment(S){this._preserveFragment=(0,h.D6c)(S)}get preserveFragment(){return this._preserveFragment}set skipLocationChange(S){this._skipLocationChange=(0,h.D6c)(S)}get skipLocationChange(){return this._skipLocationChange}set replaceUrl(S){this._replaceUrl=(0,h.D6c)(S)}get replaceUrl(){return this._replaceUrl}setTabIndexIfNotOnNativeEl(S){null!=this.tabIndexAttribute||this.isAnchorElement||this.applyAttributeValue("tabindex",S)}ngOnChanges(S){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}set routerLink(S){null!=S?(this.commands=Array.isArray(S)?S:[S],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(S,l,t,s,p){return!!(null===this.urlTree||this.isAnchorElement&&(0!==S||l||t||s||p||"string"==typeof this.target&&"_self"!=this.target))||(this.router.navigateByUrl(this.urlTree,{skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state}),!this.isAnchorElement)}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){this.href=null!==this.urlTree&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(this.urlTree)):null;const S=null===this.href?null:(0,h.P3R)(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",S)}applyAttributeValue(S,l){const t=this.renderer,s=this.el.nativeElement;null!==l?t.setAttribute(s,S,l):t.removeAttribute(s,S)}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}}return P.\u0275fac=function(S){return new(S||P)(h.Y36(To),h.Y36(mo),h.$8M("tabindex"),h.Y36(h.Qsj),h.Y36(h.SBq),h.Y36(pe.S$))},P.\u0275dir=h.lG2({type:P,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(S,l){1&S&&h.NdJ("click",function(s){return l.onClick(s.button,s.ctrlKey,s.shiftKey,s.altKey,s.metaKey)}),2&S&&h.uIk("target",l.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",relativeTo:"relativeTo",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",routerLink:"routerLink"},standalone:!0,features:[h.TTD]}),P})();class Pc{}let Pl=(()=>{class P{constructor(S,l,t,s,p){this.router=S,this.injector=t,this.preloadingStrategy=s,this.loader=p}setUpPreloading(){this.subscription=this.router.events.pipe((0,qt.h)(S=>S instanceof Ci),(0,ht.b)(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(S,l){const t=[];for(const s of l){s.providers&&!s._injector&&(s._injector=(0,h.MMx)(s.providers,S,`Route: ${s.path}`));const p=s._injector??S,v=s._loadedInjector??p;s.loadChildren&&!s._loadedRoutes&&void 0===s.canLoad||s.loadComponent&&!s._loadedComponent?t.push(this.preloadConfig(p,s)):(s.children||s._loadedRoutes)&&t.push(this.processRoutes(v,s.children??s._loadedRoutes))}return(0,g.D)(t).pipe((0,ni.J)())}preloadConfig(S,l){return this.preloadingStrategy.preload(l,()=>{let t;t=l.loadChildren&&void 0===l.canLoad?this.loader.loadChildren(S,l):(0,ie.of)(null);const s=t.pipe((0,Ft.z)(p=>null===p?(0,ie.of)(void 0):(l._loadedRoutes=p.routes,l._loadedInjector=p.injector,this.processRoutes(p.injector??S,p.routes))));if(l.loadComponent&&!l._loadedComponent){const p=this.loader.loadComponent(l);return(0,g.D)([s,p]).pipe((0,ni.J)())}return s})}}return P.\u0275fac=function(S){return new(S||P)(h.LFG(To),h.LFG(h.Sil),h.LFG(h.lqb),h.LFG(Pc),h.LFG(Xl))},P.\u0275prov=h.Yz7({token:P,factory:P.\u0275fac,providedIn:"root"}),P})();const Ks=new h.OlP("");let rc=(()=>{class P{constructor(S,l,t,s,p={}){this.urlSerializer=S,this.transitions=l,this.viewportScroller=t,this.zone=s,this.options=p,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},p.scrollPositionRestoration=p.scrollPositionRestoration||"disabled",p.anchorScrolling=p.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(S=>{S instanceof ei?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=S.navigationTrigger,this.restoredId=S.restoredState?S.restoredState.navigationId:0):S instanceof Ci&&(this.lastId=S.id,this.scheduleScrollEvent(S,this.urlSerializer.parse(S.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(S=>{S instanceof Mo&&(S.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(S.position):S.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(S.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(S,l){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new Mo(S,"popstate"===this.lastSource?this.store[this.restoredId]:null,l))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}}return P.\u0275fac=function(S){h.$Z()},P.\u0275prov=h.Yz7({token:P,factory:P.\u0275fac}),P})();function Jn(P,F){return{\u0275kind:P,\u0275providers:F}}function oc(){const P=(0,h.f3M)(h.zs3);return F=>{const S=P.get(h.z2F);if(F!==S.components[0])return;const l=P.get(To),t=P.get(Ga);1===P.get(Rl)&&l.initialNavigation(),P.get(eu,null,h.XFs.Optional)?.setUpPreloading(),P.get(Ks,null,h.XFs.Optional)?.init(),l.resetRootComponentType(S.componentTypes[0]),t.closed||(t.next(),t.unsubscribe())}}const Ga=new h.OlP("",{factory:()=>new _e.x}),Rl=new h.OlP("",{providedIn:"root",factory:()=>1});const eu=new h.OlP("");function Oc(P){return Jn(0,[{provide:eu,useExisting:Pl},{provide:Pc,useExisting:P}])}const Rc=new h.OlP("ROUTER_FORROOT_GUARD"),Ll=[pe.Ye,{provide:Ve,useClass:le},To,qr,{provide:mo,useFactory:function Ol(P){return P.routerState.root},deps:[To]},Xl,[]];function hd(){return new h.PXZ("Router",To)}let Iu=(()=>{class P{constructor(S){}static forRoot(S,l){return{ngModule:P,providers:[Ll,[],{provide:pa,multi:!0,useValue:S},{provide:Rc,useFactory:Fc,deps:[[To,new h.FiY,new h.tp0]]},{provide:$a,useValue:l||{}},l?.useHash?{provide:pe.S$,useClass:pe.Do}:{provide:pe.S$,useClass:pe.b0},{provide:Ks,useFactory:()=>{const P=(0,h.f3M)(pe.EM),F=(0,h.f3M)(h.R0b),S=(0,h.f3M)($a),l=(0,h.f3M)(ja),t=(0,h.f3M)(Ve);return S.scrollOffset&&P.setOffset(S.scrollOffset),new rc(t,l,P,F,S)}},l?.preloadingStrategy?Oc(l.preloadingStrategy).\u0275providers:[],{provide:h.PXZ,multi:!0,useFactory:hd},l?.initialNavigation?Ps(l):[],[{provide:Sa,useFactory:oc},{provide:h.tb,multi:!0,useExisting:Sa}]]}}static forChild(S){return{ngModule:P,providers:[{provide:pa,multi:!0,useValue:S}]}}}return P.\u0275fac=function(S){return new(S||P)(h.LFG(Rc,8))},P.\u0275mod=h.oAB({type:P}),P.\u0275inj=h.cJS({imports:[ns]}),P})();function Fc(P){return"guarded"}function Ps(P){return["disabled"===P.initialNavigation?Jn(3,[{provide:h.ip1,multi:!0,useFactory:()=>{const F=(0,h.f3M)(To);return()=>{F.setUpLocationChangeListener()}}},{provide:Rl,useValue:2}]).\u0275providers:[],"enabledBlocking"===P.initialNavigation?Jn(2,[{provide:Rl,useValue:0},{provide:h.ip1,multi:!0,deps:[h.zs3],useFactory:F=>{const S=F.get(pe.V_,Promise.resolve());return()=>S.then(()=>new Promise(t=>{const s=F.get(To),p=F.get(Ga);(function l(t){F.get(To).events.pipe((0,qt.h)(p=>p instanceof Ci||p instanceof qi||p instanceof ki),(0,ae.U)(p=>p instanceof Ci||p instanceof qi&&(0===p.code||1===p.code)&&null),(0,qt.h)(p=>null!==p),(0,vt.q)(1)).subscribe(()=>{t()})})(()=>{t(!0)}),s.afterPreactivation=()=>(t(!0),p.closed?(0,ie.of)(void 0):p),s.initialNavigation()}))}}]).\u0275providers:[]]}const Sa=new h.OlP("")},4463:(Rn,Dt,B)=>{"use strict";B.d(Dt,{Zw:()=>te,aw:()=>bt,X$:()=>Pt,sK:()=>Ft});var h=B(8274),g=B(9646),ie=B(9751),c=B(576);function Y(ct){return!!ct&&(ct instanceof ie.y||(0,c.m)(ct.lift)&&(0,c.m)(ct.subscribe))}var se=B(4128),y=B(7272),fe=B(9770),Ie=B(5698),Ge=B(7579),Q=B(6063);class be extends Ge.x{constructor(ht=1/0,Ce=1/0,Ct=Q.l){super(),this._bufferSize=ht,this._windowTime=Ce,this._timestampProvider=Ct,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=Ce===1/0,this._bufferSize=Math.max(1,ht),this._windowTime=Math.max(1,Ce)}next(ht){const{isStopped:Ce,_buffer:Ct,_infiniteTimeWindow:Ut,_timestampProvider:Gt,_windowTime:wn}=this;Ce||(Ct.push(ht),!Ut&&Ct.push(Gt.now()+wn)),this._trimBuffer(),super.next(ht)}_subscribe(ht){this._throwIfClosed(),this._trimBuffer();const Ce=this._innerSubscribe(ht),{_infiniteTimeWindow:Ct,_buffer:Ut}=this,Gt=Ut.slice();for(let wn=0;wn<Gt.length&&!ht.closed;wn+=Ct?1:2)ht.next(Gt[wn]);return this._checkFinalizedStatuses(ht),Ce}_trimBuffer(){const{_bufferSize:ht,_timestampProvider:Ce,_buffer:Ct,_infiniteTimeWindow:Ut}=this,Gt=(Ut?1:2)*ht;if(ht<1/0&&Gt<Ct.length&&Ct.splice(0,Ct.length-Gt),!Ut){const wn=Ce.now();let Fn=0;for(let un=1;un<Ct.length&&Ct[un]<=wn;un+=2)Fn=un;Fn&&Ct.splice(0,Fn+1)}}}var me=B(3099);function Ze(ct,ht,Ce){let Ct,Ut=!1;return ct&&"object"==typeof ct?({bufferSize:Ct=1/0,windowTime:ht=1/0,refCount:Ut=!1,scheduler:Ce}=ct):Ct=ct??1/0,(0,me.B)({connector:()=>new be(Ct,ht,Ce),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:Ut})}var he=B(4004),Ke=B(4351),Ae=B(3900);class te{}let Qe=(()=>{class ct extends te{getTranslation(Ce){return(0,g.of)({})}}return ct.\u0275fac=function(){let ht;return function(Ct){return(ht||(ht=h.n5z(ct)))(Ct||ct)}}(),ct.\u0275prov=h.Yz7({token:ct,factory:ct.\u0275fac}),ct})();class Ot{}let dt=(()=>{class ct{handle(Ce){return Ce.key}}return ct.\u0275fac=function(Ce){return new(Ce||ct)},ct.\u0275prov=h.Yz7({token:ct,factory:ct.\u0275fac}),ct})();function ye(ct,ht){if(ct===ht)return!0;if(null===ct||null===ht)return!1;if(ct!=ct&&ht!=ht)return!0;let Ut,Gt,wn,Ce=typeof ct;if(Ce==typeof ht&&"object"==Ce){if(!Array.isArray(ct)){if(Array.isArray(ht))return!1;for(Gt in wn=Object.create(null),ct){if(!ye(ct[Gt],ht[Gt]))return!1;wn[Gt]=!0}for(Gt in ht)if(!(Gt in wn)&&typeof ht[Gt]<"u")return!1;return!0}if(!Array.isArray(ht))return!1;if((Ut=ct.length)==ht.length){for(Gt=0;Gt<Ut;Gt++)if(!ye(ct[Gt],ht[Gt]))return!1;return!0}}return!1}function Fe(ct){return typeof ct<"u"&&null!==ct}function Ne(ct){return ct&&"object"==typeof ct&&!Array.isArray(ct)}function we(ct,ht){let Ce=Object.assign({},ct);return Ne(ct)&&Ne(ht)&&Object.keys(ht).forEach(Ct=>{Ne(ht[Ct])?Ct in ct?Ce[Ct]=we(ct[Ct],ht[Ct]):Object.assign(Ce,{[Ct]:ht[Ct]}):Object.assign(Ce,{[Ct]:ht[Ct]})}),Ce}class et{}let Je=(()=>{class ct extends et{constructor(){super(...arguments),this.templateMatcher=/{{\s?([^{}\s]*)\s?}}/g}interpolate(Ce,Ct){let Ut;return Ut="string"==typeof Ce?this.interpolateString(Ce,Ct):"function"==typeof Ce?this.interpolateFunction(Ce,Ct):Ce,Ut}getValue(Ce,Ct){let Ut="string"==typeof Ct?Ct.split("."):[Ct];Ct="";do{Ct+=Ut.shift(),!Fe(Ce)||!Fe(Ce[Ct])||"object"!=typeof Ce[Ct]&&Ut.length?Ut.length?Ct+=".":Ce=void 0:(Ce=Ce[Ct],Ct="")}while(Ut.length);return Ce}interpolateFunction(Ce,Ct){return Ce(Ct)}interpolateString(Ce,Ct){return Ct?Ce.replace(this.templateMatcher,(Ut,Gt)=>{let wn=this.getValue(Ct,Gt);return Fe(wn)?wn:Ut}):Ce}}return ct.\u0275fac=function(){let ht;return function(Ct){return(ht||(ht=h.n5z(ct)))(Ct||ct)}}(),ct.\u0275prov=h.Yz7({token:ct,factory:ct.\u0275fac}),ct})();class _e{}let pe=(()=>{class ct extends _e{compile(Ce,Ct){return Ce}compileTranslations(Ce,Ct){return Ce}}return ct.\u0275fac=function(){let ht;return function(Ct){return(ht||(ht=h.n5z(ct)))(Ct||ct)}}(),ct.\u0275prov=h.Yz7({token:ct,factory:ct.\u0275fac}),ct})();class ae{constructor(){this.currentLang=this.defaultLang,this.translations={},this.langs=[],this.onTranslationChange=new h.vpe,this.onLangChange=new h.vpe,this.onDefaultLangChange=new h.vpe}}const Ee=new h.OlP("USE_STORE"),vt=new h.OlP("USE_DEFAULT_LANG"),Et=new h.OlP("DEFAULT_LANGUAGE"),qt=new h.OlP("USE_EXTEND");let Ft=(()=>{class ct{constructor(Ce,Ct,Ut,Gt,wn,Fn=!0,un=!1,ut=!1,jt){this.store=Ce,this.currentLoader=Ct,this.compiler=Ut,this.parser=Gt,this.missingTranslationHandler=wn,this.useDefaultLang=Fn,this.isolate=un,this.extend=ut,this.pending=!1,this._onTranslationChange=new h.vpe,this._onLangChange=new h.vpe,this._onDefaultLangChange=new h.vpe,this._langs=[],this._translations={},this._translationRequests={},jt&&this.setDefaultLang(jt)}get onTranslationChange(){return this.isolate?this._onTranslationChange:this.store.onTranslationChange}get onLangChange(){return this.isolate?this._onLangChange:this.store.onLangChange}get onDefaultLangChange(){return this.isolate?this._onDefaultLangChange:this.store.onDefaultLangChange}get defaultLang(){return this.isolate?this._defaultLang:this.store.defaultLang}set defaultLang(Ce){this.isolate?this._defaultLang=Ce:this.store.defaultLang=Ce}get currentLang(){return this.isolate?this._currentLang:this.store.currentLang}set currentLang(Ce){this.isolate?this._currentLang=Ce:this.store.currentLang=Ce}get langs(){return this.isolate?this._langs:this.store.langs}set langs(Ce){this.isolate?this._langs=Ce:this.store.langs=Ce}get translations(){return this.isolate?this._translations:this.store.translations}set translations(Ce){this.isolate?this._translations=Ce:this.store.translations=Ce}setDefaultLang(Ce){if(Ce===this.defaultLang)return;let Ct=this.retrieveTranslations(Ce);typeof Ct<"u"?(null==this.defaultLang&&(this.defaultLang=Ce),Ct.pipe((0,Ie.q)(1)).subscribe(Ut=>{this.changeDefaultLang(Ce)})):this.changeDefaultLang(Ce)}getDefaultLang(){return this.defaultLang}use(Ce){if(Ce===this.currentLang)return(0,g.of)(this.translations[Ce]);let Ct=this.retrieveTranslations(Ce);return typeof Ct<"u"?(this.currentLang||(this.currentLang=Ce),Ct.pipe((0,Ie.q)(1)).subscribe(Ut=>{this.changeLang(Ce)}),Ct):(this.changeLang(Ce),(0,g.of)(this.translations[Ce]))}retrieveTranslations(Ce){let Ct;return(typeof this.translations[Ce]>"u"||this.extend)&&(this._translationRequests[Ce]=this._translationRequests[Ce]||this.getTranslation(Ce),Ct=this._translationRequests[Ce]),Ct}getTranslation(Ce){this.pending=!0;const Ct=this.currentLoader.getTranslation(Ce).pipe(Ze(1),(0,Ie.q)(1));return this.loadingTranslations=Ct.pipe((0,he.U)(Ut=>this.compiler.compileTranslations(Ut,Ce)),Ze(1),(0,Ie.q)(1)),this.loadingTranslations.subscribe({next:Ut=>{this.translations[Ce]=this.extend&&this.translations[Ce]?{...Ut,...this.translations[Ce]}:Ut,this.updateLangs(),this.pending=!1},error:Ut=>{this.pending=!1}}),Ct}setTranslation(Ce,Ct,Ut=!1){Ct=this.compiler.compileTranslations(Ct,Ce),this.translations[Ce]=(Ut||this.extend)&&this.translations[Ce]?we(this.translations[Ce],Ct):Ct,this.updateLangs(),this.onTranslationChange.emit({lang:Ce,translations:this.translations[Ce]})}getLangs(){return this.langs}addLangs(Ce){Ce.forEach(Ct=>{-1===this.langs.indexOf(Ct)&&this.langs.push(Ct)})}updateLangs(){this.addLangs(Object.keys(this.translations))}getParsedResult(Ce,Ct,Ut){let Gt;if(Ct instanceof Array){let wn={},Fn=!1;for(let un of Ct)wn[un]=this.getParsedResult(Ce,un,Ut),Y(wn[un])&&(Fn=!0);if(Fn){const un=Ct.map(ut=>Y(wn[ut])?wn[ut]:(0,g.of)(wn[ut]));return(0,se.D)(un).pipe((0,he.U)(ut=>{let jt={};return ut.forEach((En,ni)=>{jt[Ct[ni]]=En}),jt}))}return wn}if(Ce&&(Gt=this.parser.interpolate(this.parser.getValue(Ce,Ct),Ut)),typeof Gt>"u"&&null!=this.defaultLang&&this.defaultLang!==this.currentLang&&this.useDefaultLang&&(Gt=this.parser.interpolate(this.parser.getValue(this.translations[this.defaultLang],Ct),Ut)),typeof Gt>"u"){let wn={key:Ct,translateService:this};typeof Ut<"u"&&(wn.interpolateParams=Ut),Gt=this.missingTranslationHandler.handle(wn)}return typeof Gt<"u"?Gt:Ct}get(Ce,Ct){if(!Fe(Ce)||!Ce.length)throw new Error('Parameter "key" required');if(this.pending)return this.loadingTranslations.pipe((0,Ke.b)(Ut=>Y(Ut=this.getParsedResult(Ut,Ce,Ct))?Ut:(0,g.of)(Ut)));{let Ut=this.getParsedResult(this.translations[this.currentLang],Ce,Ct);return Y(Ut)?Ut:(0,g.of)(Ut)}}getStreamOnTranslationChange(Ce,Ct){if(!Fe(Ce)||!Ce.length)throw new Error('Parameter "key" required');return(0,y.z)((0,fe.P)(()=>this.get(Ce,Ct)),this.onTranslationChange.pipe((0,Ae.w)(Ut=>{const Gt=this.getParsedResult(Ut.translations,Ce,Ct);return"function"==typeof Gt.subscribe?Gt:(0,g.of)(Gt)})))}stream(Ce,Ct){if(!Fe(Ce)||!Ce.length)throw new Error('Parameter "key" required');return(0,y.z)((0,fe.P)(()=>this.get(Ce,Ct)),this.onLangChange.pipe((0,Ae.w)(Ut=>{const Gt=this.getParsedResult(Ut.translations,Ce,Ct);return Y(Gt)?Gt:(0,g.of)(Gt)})))}instant(Ce,Ct){if(!Fe(Ce)||!Ce.length)throw new Error('Parameter "key" required');let Ut=this.getParsedResult(this.translations[this.currentLang],Ce,Ct);if(Y(Ut)){if(Ce instanceof Array){let Gt={};return Ce.forEach((wn,Fn)=>{Gt[Ce[Fn]]=Ce[Fn]}),Gt}return Ce}return Ut}set(Ce,Ct,Ut=this.currentLang){this.translations[Ut][Ce]=this.compiler.compile(Ct,Ut),this.updateLangs(),this.onTranslationChange.emit({lang:Ut,translations:this.translations[Ut]})}changeLang(Ce){this.currentLang=Ce,this.onLangChange.emit({lang:Ce,translations:this.translations[Ce]}),null==this.defaultLang&&this.changeDefaultLang(Ce)}changeDefaultLang(Ce){this.defaultLang=Ce,this.onDefaultLangChange.emit({lang:Ce,translations:this.translations[Ce]})}reloadLang(Ce){return this.resetLang(Ce),this.getTranslation(Ce)}resetLang(Ce){this._translationRequests[Ce]=void 0,this.translations[Ce]=void 0}getBrowserLang(){if(typeof window>"u"||typeof window.navigator>"u")return;let Ce=window.navigator.languages?window.navigator.languages[0]:null;return Ce=Ce||window.navigator.language||window.navigator.browserLanguage||window.navigator.userLanguage,typeof Ce>"u"?void 0:(-1!==Ce.indexOf("-")&&(Ce=Ce.split("-")[0]),-1!==Ce.indexOf("_")&&(Ce=Ce.split("_")[0]),Ce)}getBrowserCultureLang(){if(typeof window>"u"||typeof window.navigator>"u")return;let Ce=window.navigator.languages?window.navigator.languages[0]:null;return Ce=Ce||window.navigator.language||window.navigator.browserLanguage||window.navigator.userLanguage,Ce}}return ct.\u0275fac=function(Ce){return new(Ce||ct)(h.LFG(ae),h.LFG(te),h.LFG(_e),h.LFG(et),h.LFG(Ot),h.LFG(vt),h.LFG(Ee),h.LFG(qt),h.LFG(Et))},ct.\u0275prov=h.Yz7({token:ct,factory:ct.\u0275fac}),ct})(),Pt=(()=>{class ct{constructor(Ce,Ct){this.translate=Ce,this._ref=Ct,this.value="",this.lastKey=null,this.lastParams=[]}updateValue(Ce,Ct,Ut){let Gt=wn=>{this.value=void 0!==wn?wn:Ce,this.lastKey=Ce,this._ref.markForCheck()};if(Ut){let wn=this.translate.getParsedResult(Ut,Ce,Ct);Y(wn.subscribe)?wn.subscribe(Gt):Gt(wn)}this.translate.get(Ce,Ct).subscribe(Gt)}transform(Ce,...Ct){if(!Ce||!Ce.length)return Ce;if(ye(Ce,this.lastKey)&&ye(Ct,this.lastParams))return this.value;let Ut;if(Fe(Ct[0])&&Ct.length)if("string"==typeof Ct[0]&&Ct[0].length){let Gt=Ct[0].replace(/(\')?([a-zA-Z0-9_]+)(\')?(\s)?:/g,'"$2":').replace(/:(\s)?(\')(.*?)(\')/g,':"$3"');try{Ut=JSON.parse(Gt)}catch{throw new SyntaxError(`Wrong parameter in TranslatePipe. Expected a valid Object, received: ${Ct[0]}`)}}else"object"==typeof Ct[0]&&!Array.isArray(Ct[0])&&(Ut=Ct[0]);return this.lastKey=Ce,this.lastParams=Ct,this.updateValue(Ce,Ut),this._dispose(),this.onTranslationChange||(this.onTranslationChange=this.translate.onTranslationChange.subscribe(Gt=>{this.lastKey&&Gt.lang===this.translate.currentLang&&(this.lastKey=null,this.updateValue(Ce,Ut,Gt.translations))})),this.onLangChange||(this.onLangChange=this.translate.onLangChange.subscribe(Gt=>{this.lastKey&&(this.lastKey=null,this.updateValue(Ce,Ut,Gt.translations))})),this.onDefaultLangChange||(this.onDefaultLangChange=this.translate.onDefaultLangChange.subscribe(()=>{this.lastKey&&(this.lastKey=null,this.updateValue(Ce,Ut))})),this.value}_dispose(){typeof this.onTranslationChange<"u"&&(this.onTranslationChange.unsubscribe(),this.onTranslationChange=void 0),typeof this.onLangChange<"u"&&(this.onLangChange.unsubscribe(),this.onLangChange=void 0),typeof this.onDefaultLangChange<"u"&&(this.onDefaultLangChange.unsubscribe(),this.onDefaultLangChange=void 0)}ngOnDestroy(){this._dispose()}}return ct.\u0275fac=function(Ce){return new(Ce||ct)(h.Y36(Ft,16),h.Y36(h.sBO,16))},ct.\u0275pipe=h.Yjl({name:"translate",type:ct,pure:!1}),ct.\u0275prov=h.Yz7({token:ct,factory:ct.\u0275fac}),ct})(),bt=(()=>{class ct{static forRoot(Ce={}){return{ngModule:ct,providers:[Ce.loader||{provide:te,useClass:Qe},Ce.compiler||{provide:_e,useClass:pe},Ce.parser||{provide:et,useClass:Je},Ce.missingTranslationHandler||{provide:Ot,useClass:dt},ae,{provide:Ee,useValue:Ce.isolate},{provide:vt,useValue:Ce.useDefaultLang},{provide:qt,useValue:Ce.extend},{provide:Et,useValue:Ce.defaultLanguage},Ft]}}static forChild(Ce={}){return{ngModule:ct,providers:[Ce.loader||{provide:te,useClass:Qe},Ce.compiler||{provide:_e,useClass:pe},Ce.parser||{provide:et,useClass:Je},Ce.missingTranslationHandler||{provide:Ot,useClass:dt},{provide:Ee,useValue:Ce.isolate},{provide:vt,useValue:Ce.useDefaultLang},{provide:qt,useValue:Ce.extend},{provide:Et,useValue:Ce.defaultLanguage},Ft]}}}return ct.\u0275fac=function(Ce){return new(Ce||ct)},ct.\u0275mod=h.oAB({type:ct}),ct.\u0275inj=h.cJS({}),ct})()},5861:(Rn,Dt,B)=>{"use strict";function h(ie,c,Y,se,y,fe,Ie){try{var Ge=ie[fe](Ie),Q=Ge.value}catch(be){return void Y(be)}Ge.done?c(Q):Promise.resolve(Q).then(se,y)}function g(ie){return function(){var c=this,Y=arguments;return new Promise(function(se,y){var fe=ie.apply(c,Y);function Ie(Q){h(fe,se,y,Ie,Ge,"next",Q)}function Ge(Q){h(fe,se,y,Ie,Ge,"throw",Q)}Ie(void 0)})}}B.d(Dt,{Z:()=>g})}},Rn=>{Rn(Rn.s=659)}]);