(self.webpackChunkapp=self.webpackChunkapp||[]).push([[179],{6091:(zn,Dt,R)=>{"use strict";R.d(Dt,{Ar:()=>X,N0:()=>fe});var x=R(2029),d=R(6814),v=R(7398),s=R(1631),Q=R(4911),ie=R(2096),q=R(9862);const y=new x.OlP("JWT_OPTIONS");let fe=(()=>{class se{constructor(_e=null){this.tokenGetter=_e&&_e.tokenGetter||function(){}}urlBase64Decode(_e){let be=_e.replace(/-/g,"+").replace(/_/g,"/");switch(be.length%4){case 0:break;case 2:be+="==";break;case 3:be+="=";break;default:throw new Error("Illegal base64url string!")}return this.b64DecodeUnicode(be)}b64decode(_e){let Re="";if((_e=String(_e).replace(/=+$/,"")).length%4==1)throw new Error("'atob' failed: The string to be decoded is not correctly encoded.");for(let qe,_t,Ne=0,Je=0;_t=_e.charAt(Je++);~_t&&(qe=Ne%4?64*qe+_t:_t,Ne++%4)?Re+=String.fromCharCode(255&qe>>(-2*Ne&6)):0)_t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(_t);return Re}b64DecodeUnicode(_e){return decodeURIComponent(Array.prototype.map.call(this.b64decode(_e),be=>"%"+("00"+be.charCodeAt(0).toString(16)).slice(-2)).join(""))}decodeToken(_e=this.tokenGetter()){return _e instanceof Promise?_e.then(be=>this._decodeToken(be)):this._decodeToken(_e)}_decodeToken(_e){if(!_e||""===_e)return null;const be=_e.split(".");if(3!==be.length)throw new Error("The inspected token doesn't appear to be a JWT. Check to make sure it has three parts and see https://jwt.io for more.");const Re=this.urlBase64Decode(be[1]);if(!Re)throw new Error("Cannot decode the token.");return JSON.parse(Re)}getTokenExpirationDate(_e=this.tokenGetter()){return _e instanceof Promise?_e.then(be=>this._getTokenExpirationDate(be)):this._getTokenExpirationDate(_e)}_getTokenExpirationDate(_e){let be;if(be=this.decodeToken(_e),!be||!be.hasOwnProperty("exp"))return null;const Re=new Date(0);return Re.setUTCSeconds(be.exp),Re}isTokenExpired(_e=this.tokenGetter(),be){return _e instanceof Promise?_e.then(Re=>this._isTokenExpired(Re,be)):this._isTokenExpired(_e,be)}_isTokenExpired(_e,be){if(!_e||""===_e)return!0;const Re=this.getTokenExpirationDate(_e);return be=be||0,null!==Re&&!(Re.valueOf()>(new Date).valueOf()+1e3*be)}getAuthScheme(_e,be){return"function"==typeof _e?_e(be):_e}}return se.\u0275fac=function(_e){return new(_e||se)(x.LFG(y))},se.\u0275prov=x.Yz7({token:se,factory:se.\u0275fac}),se})();const Se=se=>se instanceof Promise?(0,Q.P)(()=>se):(0,ie.of)(se);let De=(()=>{class se{constructor(_e,be,Re){this.jwtHelper=be,this.document=Re,this.standardPorts=["80","443"],this.tokenGetter=_e.tokenGetter,this.headerName=_e.headerName||"Authorization",this.authScheme=_e.authScheme||""===_e.authScheme?_e.authScheme:"Bearer ",this.allowedDomains=_e.allowedDomains||[],this.disallowedRoutes=_e.disallowedRoutes||[],this.throwNoTokenError=_e.throwNoTokenError||!1,this.skipWhenExpired=_e.skipWhenExpired}isAllowedDomain(_e){const be=new URL(_e.url,this.document.location.origin);if(be.host===this.document.location.host)return!0;const Re=`${be.hostname}${be.port&&!this.standardPorts.includes(be.port)?":"+be.port:""}`;return this.allowedDomains.findIndex(Ne=>"string"==typeof Ne?Ne===Re:Ne instanceof RegExp&&Ne.test(Re))>-1}isDisallowedRoute(_e){const be=new URL(_e.url,this.document.location.origin);return this.disallowedRoutes.findIndex(Re=>{if("string"==typeof Re){const Ne=new URL(Re,this.document.location.origin);return Ne.hostname===be.hostname&&Ne.pathname===be.pathname}return Re instanceof RegExp&&Re.test(_e.url)})>-1}handleInterception(_e,be,Re){const Ne=this.jwtHelper.getAuthScheme(this.authScheme,be);if(!_e&&this.throwNoTokenError)throw new Error("Could not get token from tokenGetter function.");let qe=(0,ie.of)(!1);return this.skipWhenExpired&&(qe=_e?Se(this.jwtHelper.isTokenExpired(_e)):(0,ie.of)(!0)),_e?qe.pipe((0,v.U)(_t=>_t&&this.skipWhenExpired?be.clone():be.clone({setHeaders:{[this.headerName]:`${Ne}${_e}`}})),(0,s.z)(_t=>Re.handle(_t))):Re.handle(be)}intercept(_e,be){if(!this.isAllowedDomain(_e)||this.isDisallowedRoute(_e))return be.handle(_e);const Re=this.tokenGetter(_e);return Se(Re).pipe((0,s.z)(Ne=>this.handleInterception(Ne,_e,be)))}}return se.\u0275fac=function(_e){return new(_e||se)(x.LFG(y),x.LFG(fe),x.LFG(d.K0))},se.\u0275prov=x.Yz7({token:se,factory:se.\u0275fac}),se})(),X=(()=>{class se{constructor(_e){if(_e)throw new Error("JwtModule is already loaded. It should only be imported in your application's main module.")}static forRoot(_e){return{ngModule:se,providers:[{provide:q.TP,useClass:De,multi:!0},_e.jwtOptionsProvider||{provide:y,useValue:_e.config},fe]}}}return se.\u0275fac=function(_e){return new(_e||se)(x.LFG(se,12))},se.\u0275mod=x.oAB({type:se}),se.\u0275inj=x.cJS({}),se})()},2726:(zn,Dt,R)=>{"use strict";R.d(Dt,{Uw:()=>Re,fo:()=>Ee});var x=R(5861);typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"&&global;var y=(()=>((y=y||{}).Unimplemented="UNIMPLEMENTED",y.Unavailable="UNAVAILABLE",y))();class fe extends Error{constructor(Ae,ve,en){super(Ae),this.message=Ae,this.code=ve,this.data=en}}const De=Ze=>{var Ae,ve,en,dt,mt;const lt=Ze.CapacitorCustomPlatform||null,ze=Ze.Capacitor||{},xt=ze.Plugins=ze.Plugins||{},Ve=Ze.CapacitorPlatforms,Be=(null===(Ae=Ve?.currentPlatform)||void 0===Ae?void 0:Ae.getPlatform)||(()=>null!==lt?lt.name:(Ze=>{var Ae,ve;return Ze?.androidBridge?"android":null!==(ve=null===(Ae=Ze?.webkit)||void 0===Ae?void 0:Ae.messageHandlers)&&void 0!==ve&&ve.bridge?"ios":"web"})(Ze)),Wt=(null===(ve=Ve?.currentPlatform)||void 0===ve?void 0:ve.isNativePlatform)||(()=>"web"!==Be()),Xt=(null===(en=Ve?.currentPlatform)||void 0===en?void 0:en.isPluginAvailable)||(Sn=>{const zt=st.get(Sn);return!(!zt?.platforms.has(Be())&&!an(Sn))}),an=(null===(dt=Ve?.currentPlatform)||void 0===dt?void 0:dt.getPluginHeader)||(Sn=>{var zt;return null===(zt=ze.PluginHeaders)||void 0===zt?void 0:zt.find(gi=>gi.name===Sn)}),st=new Map,dn=(null===(mt=Ve?.currentPlatform)||void 0===mt?void 0:mt.registerPlugin)||((Sn,zt={})=>{const gi=st.get(Sn);if(gi)return console.warn(`Capacitor plugin "${Sn}" already registered. Cannot register plugins twice.`),gi.proxy;const $i=Be(),Ci=an(Sn);let Ji;const Hi=function(){var ge=(0,x.Z)(function*(){return!Ji&&$i in zt?Ji=Ji="function"==typeof zt[$i]?yield zt[$i]():zt[$i]:null!==lt&&!Ji&&"web"in zt&&(Ji=Ji="function"==typeof zt.web?yield zt.web():zt.web),Ji});return function(){return ge.apply(this,arguments)}}(),ii=ge=>{let ct;const Gt=(...pn)=>{const Gi=Hi().then(ri=>{const Vo=((ge,ct)=>{var Gt,pn;if(!Ci){if(ge)return null===(pn=ge[ct])||void 0===pn?void 0:pn.bind(ge);throw new fe(`"${Sn}" plugin is not implemented on ${$i}`,y.Unimplemented)}{const Gi=Ci?.methods.find(ri=>ct===ri.name);if(Gi)return"promise"===Gi.rtype?ri=>ze.nativePromise(Sn,ct.toString(),ri):(ri,Vo)=>ze.nativeCallback(Sn,ct.toString(),ri,Vo);if(ge)return null===(Gt=ge[ct])||void 0===Gt?void 0:Gt.bind(ge)}})(ri,ge);if(Vo){const ut=Vo(...pn);return ct=ut?.remove,ut}throw new fe(`"${Sn}.${ge}()" is not implemented on ${$i}`,y.Unimplemented)});return"addListener"===ge&&(Gi.remove=(0,x.Z)(function*(){return ct()})),Gi};return Gt.toString=()=>`${ge.toString()}() { [capacitor code] }`,Object.defineProperty(Gt,"name",{value:ge,writable:!1,configurable:!1}),Gt},mi=ii("addListener"),xn=ii("removeListener"),Qt=(ge,ct)=>{const Gt=mi({eventName:ge},ct),pn=function(){var ri=(0,x.Z)(function*(){const Vo=yield Gt;xn({eventName:ge,callbackId:Vo},ct)});return function(){return ri.apply(this,arguments)}}(),Gi=new Promise(ri=>Gt.then(()=>ri({remove:pn})));return Gi.remove=(0,x.Z)(function*(){console.warn("Using addListener() without 'await' is deprecated."),yield pn()}),Gi},Mt=new Proxy({},{get(ge,ct){switch(ct){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return Ci?Qt:mi;case"removeListener":return xn;default:return ii(ct)}}});return xt[Sn]=Mt,st.set(Sn,{name:Sn,proxy:Mt,platforms:new Set([...Object.keys(zt),...Ci?[$i]:[]])}),Mt});return ze.convertFileSrc||(ze.convertFileSrc=Sn=>Sn),ze.getPlatform=Be,ze.handleError=Sn=>Ze.console.error(Sn),ze.isNativePlatform=Wt,ze.isPluginAvailable=Xt,ze.pluginMethodNoop=(Sn,zt,gi)=>Promise.reject(`${gi} does not have an implementation of "${zt}".`),ze.registerPlugin=dn,ze.Exception=fe,ze.DEBUG=!!ze.DEBUG,ze.isLoggingEnabled=!!ze.isLoggingEnabled,ze.platform=ze.getPlatform(),ze.isNative=ze.isNativePlatform(),ze},se=(Ze=>Ze.Capacitor=De(Ze))(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),Ee=se.registerPlugin;class Re{constructor(Ae){this.listeners={},this.windowListeners={},Ae&&(console.warn(`Capacitor WebPlugin "${Ae.name}" config object was deprecated in v3 and will be removed in v4.`),this.config=Ae)}addListener(Ae,ve){var en=this;this.listeners[Ae]||(this.listeners[Ae]=[]),this.listeners[Ae].push(ve);const mt=this.windowListeners[Ae];mt&&!mt.registered&&this.addWindowListener(mt);const lt=function(){var xt=(0,x.Z)(function*(){return en.removeListener(Ae,ve)});return function(){return xt.apply(this,arguments)}}(),ze=Promise.resolve({remove:lt});return Object.defineProperty(ze,"remove",{value:(xt=(0,x.Z)(function*(){console.warn("Using addListener() without 'await' is deprecated."),yield lt()}),function(){return xt.apply(this,arguments)})}),ze;var xt}removeAllListeners(){var Ae=this;return(0,x.Z)(function*(){Ae.listeners={};for(const ve in Ae.windowListeners)Ae.removeWindowListener(Ae.windowListeners[ve]);Ae.windowListeners={}})()}notifyListeners(Ae,ve){const en=this.listeners[Ae];en&&en.forEach(dt=>dt(ve))}hasListeners(Ae){return!!this.listeners[Ae].length}registerWindowListener(Ae,ve){this.windowListeners[ve]={registered:!1,windowEventName:Ae,pluginEventName:ve,handler:en=>{this.notifyListeners(ve,en)}}}unimplemented(Ae="not implemented"){return new se.Exception(Ae,y.Unimplemented)}unavailable(Ae="not available"){return new se.Exception(Ae,y.Unavailable)}removeListener(Ae,ve){var en=this;return(0,x.Z)(function*(){const dt=en.listeners[Ae];if(!dt)return;const mt=dt.indexOf(ve);en.listeners[Ae].splice(mt,1),en.listeners[Ae].length||en.removeWindowListener(en.windowListeners[Ae])})()}addWindowListener(Ae){window.addEventListener(Ae.windowEventName,Ae.handler),Ae.registered=!0}removeWindowListener(Ae){Ae&&(window.removeEventListener(Ae.windowEventName,Ae.handler),Ae.registered=!1)}}const qe=Ze=>encodeURIComponent(Ze).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),_t=Ze=>Ze.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);class Je extends Re{getCookies(){return(0,x.Z)(function*(){const Ae=document.cookie,ve={};return Ae.split(";").forEach(en=>{if(en.length<=0)return;let[dt,mt]=en.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");dt=_t(dt).trim(),mt=_t(mt).trim(),ve[dt]=mt}),ve})()}setCookie(Ae){return(0,x.Z)(function*(){try{const ve=qe(Ae.key),en=qe(Ae.value),dt=`; expires=${(Ae.expires||"").replace("expires=","")}`,mt=(Ae.path||"/").replace("path=",""),lt=null!=Ae.url&&Ae.url.length>0?`domain=${Ae.url}`:"";document.cookie=`${ve}=${en||""}${dt}; path=${mt}; ${lt};`}catch(ve){return Promise.reject(ve)}})()}deleteCookie(Ae){return(0,x.Z)(function*(){try{document.cookie=`${Ae.key}=; Max-Age=0`}catch(ve){return Promise.reject(ve)}})()}clearCookies(){return(0,x.Z)(function*(){try{const Ae=document.cookie.split(";")||[];for(const ve of Ae)document.cookie=ve.replace(/^ +/,"").replace(/=.*/,`=;expires=${(new Date).toUTCString()};path=/`)}catch(Ae){return Promise.reject(Ae)}})()}clearAllCookies(){var Ae=this;return(0,x.Z)(function*(){try{yield Ae.clearCookies()}catch(ve){return Promise.reject(ve)}})()}}Ee("CapacitorCookies",{web:()=>new Je});const it=function(){var Ze=(0,x.Z)(function*(Ae){return new Promise((ve,en)=>{const dt=new FileReader;dt.onload=()=>{const mt=dt.result;ve(mt.indexOf(",")>=0?mt.split(",")[1]:mt)},dt.onerror=mt=>en(mt),dt.readAsDataURL(Ae)})});return function(ve){return Ze.apply(this,arguments)}}();class yt extends Re{request(Ae){return(0,x.Z)(function*(){const ve=((Ze,Ae={})=>{const ve=Object.assign({method:Ze.method||"GET",headers:Ze.headers},Ae),dt=((Ze={})=>{const Ae=Object.keys(Ze);return Object.keys(Ze).map(dt=>dt.toLocaleLowerCase()).reduce((dt,mt,lt)=>(dt[mt]=Ze[Ae[lt]],dt),{})})(Ze.headers)["content-type"]||"";if("string"==typeof Ze.data)ve.body=Ze.data;else if(dt.includes("application/x-www-form-urlencoded")){const mt=new URLSearchParams;for(const[lt,ze]of Object.entries(Ze.data||{}))mt.set(lt,ze);ve.body=mt.toString()}else if(dt.includes("multipart/form-data")){const mt=new FormData;if(Ze.data instanceof FormData)Ze.data.forEach((ze,xt)=>{mt.append(xt,ze)});else for(const ze of Object.keys(Ze.data))mt.append(ze,Ze.data[ze]);ve.body=mt;const lt=new Headers(ve.headers);lt.delete("content-type"),ve.headers=lt}else(dt.includes("application/json")||"object"==typeof Ze.data)&&(ve.body=JSON.stringify(Ze.data));return ve})(Ae,Ae.webFetchExtra),en=((Ze,Ae=!0)=>Ze?Object.entries(Ze).reduce((en,dt)=>{const[mt,lt]=dt;let ze,xt;return Array.isArray(lt)?(xt="",lt.forEach(Ve=>{ze=Ae?encodeURIComponent(Ve):Ve,xt+=`${mt}=${ze}&`}),xt.slice(0,-1)):(ze=Ae?encodeURIComponent(lt):lt,xt=`${mt}=${ze}`),`${en}&${xt}`},"").substr(1):null)(Ae.params,Ae.shouldEncodeUrlParams),dt=en?`${Ae.url}?${en}`:Ae.url,mt=yield fetch(dt,ve),lt=mt.headers.get("content-type")||"";let xt,Ve,{responseType:ze="text"}=mt.ok?Ae:{};switch(lt.includes("application/json")&&(ze="json"),ze){case"arraybuffer":case"blob":Ve=yield mt.blob(),xt=yield it(Ve);break;case"json":xt=yield mt.json();break;default:xt=yield mt.text()}const gt={};return mt.headers.forEach((Be,Bt)=>{gt[Bt]=Be}),{data:xt,headers:gt,status:mt.status,url:mt.url}})()}get(Ae){var ve=this;return(0,x.Z)(function*(){return ve.request(Object.assign(Object.assign({},Ae),{method:"GET"}))})()}post(Ae){var ve=this;return(0,x.Z)(function*(){return ve.request(Object.assign(Object.assign({},Ae),{method:"POST"}))})()}put(Ae){var ve=this;return(0,x.Z)(function*(){return ve.request(Object.assign(Object.assign({},Ae),{method:"PUT"}))})()}patch(Ae){var ve=this;return(0,x.Z)(function*(){return ve.request(Object.assign(Object.assign({},Ae),{method:"PATCH"}))})()}delete(Ae){var ve=this;return(0,x.Z)(function*(){return ve.request(Object.assign(Object.assign({},Ae),{method:"DELETE"}))})()}}Ee("CapacitorHttp",{web:()=>new yt})},6506:(zn,Dt,R)=>{"use strict";R.d(Dt,{c:()=>be});var x=R(7643),d=R(544);let v;const Q=Re=>Re.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),ie=Re=>(void 0===v&&(v=void 0===Re.style.animationName&&void 0!==Re.style.webkitAnimationName?"-webkit-":""),v),q=(Re,Ne,qe)=>{const _t=Ne.startsWith("animation")?ie(Re):"";Re.style.setProperty(_t+Ne,qe)},y=(Re,Ne)=>{const qe=Ne.startsWith("animation")?ie(Re):"";Re.style.removeProperty(qe+Ne)},De=[],_e=(Re=[],Ne)=>{if(void 0!==Ne){const qe=Array.isArray(Ne)?Ne:[Ne];return[...Re,...qe]}return Re},be=Re=>{let Ne,qe,_t,Je,Me,it,we,ze,xt,Ve,gt,wn,Xt,Xe=[],Te=[],ae=[],yt=!1,Ze={},Ae=[],ve=[],en={},dt=0,mt=!1,lt=!1,Be=!0,Bt=!1,Wt=!0,mn=!1;const an=Re,Vt=[],St=[],st=[],qt=[],dn=[],Sn=[],zt=[],gi=[],$i=[],Ci=[],Ji="function"==typeof AnimationEffect||void 0!==x.w&&"function"==typeof x.w.AnimationEffect,Hi="function"==typeof Element&&"function"==typeof Element.prototype.animate&&Ji,ii=()=>Ci,ge=(Le,tt)=>((tt?.oneTimeCallback?St:Vt).push({c:Le,o:tt}),Xt),Gt=()=>{if(Hi)Ci.forEach(Le=>{Le.cancel()}),Ci.length=0;else{const Le=st.slice();(0,d.r)(()=>{Le.forEach(tt=>{y(tt,"animation-name"),y(tt,"animation-duration"),y(tt,"animation-timing-function"),y(tt,"animation-iteration-count"),y(tt,"animation-delay"),y(tt,"animation-play-state"),y(tt,"animation-fill-mode"),y(tt,"animation-direction")})})}},pn=()=>{dn.forEach(Le=>{Le?.parentNode&&Le.parentNode.removeChild(Le)}),dn.length=0},Kt=()=>void 0!==Me?Me:we?we.getFill():"both",In=()=>void 0!==xt?xt:void 0!==it?it:we?we.getDirection():"normal",et=()=>mt?"linear":void 0!==_t?_t:we?we.getEasing():"linear",Ue=()=>lt?0:void 0!==Ve?Ve:void 0!==qe?qe:we?we.getDuration():0,Y=()=>void 0!==Je?Je:we?we.getIterations():1,me=()=>void 0!==gt?gt:void 0!==Ne?Ne:we?we.getDelay():0,oi=()=>{0!==dt&&(dt--,0===dt&&((()=>{Ki(),gi.forEach(_n=>_n()),$i.forEach(_n=>_n());const Le=Be?1:0,tt=Ae,Nt=ve,Ut=en;st.forEach(_n=>{const Cn=_n.classList;tt.forEach(vn=>Cn.add(vn)),Nt.forEach(vn=>Cn.remove(vn));for(const vn in Ut)Ut.hasOwnProperty(vn)&&q(_n,vn,Ut[vn])}),Vt.forEach(_n=>_n.c(Le,Xt)),St.forEach(_n=>_n.c(Le,Xt)),St.length=0,Wt=!0,Be&&(Bt=!0),Be=!0})(),we&&we.animationFinish()))},ti=(Le=!0)=>{pn();const tt=(Re=>(Re.forEach(Ne=>{for(const qe in Ne)if(Ne.hasOwnProperty(qe)){const _t=Ne[qe];if("easing"===qe)Ne["animation-timing-function"]=_t,delete Ne[qe];else{const Je=Q(qe);Je!==qe&&(Ne[Je]=_t,delete Ne[qe])}}}),Re))(Xe);st.forEach(Nt=>{if(tt.length>0){const Ut=((Re=[])=>Re.map(Ne=>{const qe=Ne.offset,_t=[];for(const Je in Ne)Ne.hasOwnProperty(Je)&&"offset"!==Je&&_t.push(`${Je}: ${Ne[Je]};`);return`${100*qe}% { ${_t.join(" ")} }`}).join(" "))(tt);wn=void 0!==Re?Re:(Re=>{let Ne=De.indexOf(Re);return Ne<0&&(Ne=De.push(Re)-1),`ion-animation-${Ne}`})(Ut);const _n=((Re,Ne,qe)=>{var _t;const Je=(Re=>{const Ne=void 0!==Re.getRootNode?Re.getRootNode():Re;return Ne.head||Ne})(qe),Me=ie(qe),it=Je.querySelector("#"+Re);if(it)return it;const Xe=(null!==(_t=qe.ownerDocument)&&void 0!==_t?_t:document).createElement("style");return Xe.id=Re,Xe.textContent=`@${Me}keyframes ${Re} { ${Ne} } @${Me}keyframes ${Re}-alt { ${Ne} }`,Je.appendChild(Xe),Xe})(wn,Ut,Nt);dn.push(_n),q(Nt,"animation-duration",`${Ue()}ms`),q(Nt,"animation-timing-function",et()),q(Nt,"animation-delay",`${me()}ms`),q(Nt,"animation-fill-mode",Kt()),q(Nt,"animation-direction",In());const Cn=Y()===1/0?"infinite":Y().toString();q(Nt,"animation-iteration-count",Cn),q(Nt,"animation-play-state","paused"),Le&&q(Nt,"animation-name",`${_n.id}-alt`),(0,d.r)(()=>{q(Nt,"animation-name",_n.id||null)})}})},xi=(Le=!0)=>{(()=>{Sn.forEach(Ut=>Ut()),zt.forEach(Ut=>Ut());const Le=Te,tt=ae,Nt=Ze;st.forEach(Ut=>{const _n=Ut.classList;Le.forEach(Cn=>_n.add(Cn)),tt.forEach(Cn=>_n.remove(Cn));for(const Cn in Nt)Nt.hasOwnProperty(Cn)&&q(Ut,Cn,Nt[Cn])})})(),Xe.length>0&&(Hi?(st.forEach(Le=>{const tt=Le.animate(Xe,{id:an,delay:me(),duration:Ue(),easing:et(),iterations:Y(),fill:Kt(),direction:In()});tt.pause(),Ci.push(tt)}),Ci.length>0&&(Ci[0].onfinish=()=>{oi()})):ti(Le)),yt=!0},go=Le=>{if(Le=Math.min(Math.max(Le,0),.9999),Hi)Ci.forEach(tt=>{tt.currentTime=tt.effect.getComputedTiming().delay+Ue()*Le,tt.pause()});else{const tt=`-${Ue()*Le}ms`;st.forEach(Nt=>{Xe.length>0&&(q(Nt,"animation-delay",tt),q(Nt,"animation-play-state","paused"))})}},So=Le=>{Ci.forEach(tt=>{tt.effect.updateTiming({delay:me(),duration:Ue(),easing:et(),iterations:Y(),fill:Kt(),direction:In()})}),void 0!==Le&&go(Le)},Go=(Le=!0,tt)=>{(0,d.r)(()=>{st.forEach(Nt=>{q(Nt,"animation-name",wn||null),q(Nt,"animation-duration",`${Ue()}ms`),q(Nt,"animation-timing-function",et()),q(Nt,"animation-delay",void 0!==tt?`-${tt*Ue()}ms`:`${me()}ms`),q(Nt,"animation-fill-mode",Kt()||null),q(Nt,"animation-direction",In()||null);const Ut=Y()===1/0?"infinite":Y().toString();q(Nt,"animation-iteration-count",Ut),Le&&q(Nt,"animation-name",`${wn}-alt`),(0,d.r)(()=>{q(Nt,"animation-name",wn||null)})})})},uo=(Le=!1,tt=!0,Nt)=>(Le&&qt.forEach(Ut=>{Ut.update(Le,tt,Nt)}),Hi?So(Nt):Go(tt,Nt),Xt),tn=()=>{yt&&(Hi?Ci.forEach(Le=>{Le.pause()}):st.forEach(Le=>{q(Le,"animation-play-state","paused")}),mn=!0)},xo=()=>{ze=void 0,oi()},Ki=()=>{ze&&clearTimeout(ze)},kr=Le=>new Promise(tt=>{Le?.sync&&(lt=!0,ge(()=>lt=!1,{oneTimeCallback:!0})),yt||xi(),Bt&&(Hi?(go(0),So()):Go(),Bt=!1),Wt&&(dt=qt.length+1,Wt=!1),ge(()=>tt(),{oneTimeCallback:!0}),qt.forEach(Nt=>{Nt.play()}),Hi?(Ci.forEach(Le=>{Le.play()}),(0===Xe.length||0===st.length)&&oi()):(()=>{if(Ki(),(0,d.r)(()=>{st.forEach(Le=>{Xe.length>0&&q(Le,"animation-play-state","running")})}),0===Xe.length||0===st.length)oi();else{const Le=me()||0,tt=Ue()||0,Nt=Y()||1;isFinite(Nt)&&(ze=setTimeout(xo,Le+tt*Nt+100)),((Re,Ne)=>{let qe;const _t={passive:!0},Me=it=>{Re===it.target&&(qe&&qe(),Ki(),(0,d.r)(()=>{st.forEach(Le=>{y(Le,"animation-duration"),y(Le,"animation-delay"),y(Le,"animation-play-state")}),(0,d.r)(oi)}))};Re&&(Re.addEventListener("webkitAnimationEnd",Me,_t),Re.addEventListener("animationend",Me,_t),qe=()=>{Re.removeEventListener("webkitAnimationEnd",Me,_t),Re.removeEventListener("animationend",Me,_t)})})(st[0])}})(),mn=!1}),Ui=(Le,tt)=>{const Nt=Xe[0];return void 0===Nt||void 0!==Nt.offset&&0!==Nt.offset?Xe=[{offset:0,[Le]:tt},...Xe]:Nt[Le]=tt,Xt};return Xt={parentAnimation:we,elements:st,childAnimations:qt,id:an,animationFinish:oi,from:Ui,to:(Le,tt)=>{const Nt=Xe[Xe.length-1];return void 0===Nt||void 0!==Nt.offset&&1!==Nt.offset?Xe=[...Xe,{offset:1,[Le]:tt}]:Nt[Le]=tt,Xt},fromTo:(Le,tt,Nt)=>Ui(Le,tt).to(Le,Nt),parent:Le=>(we=Le,Xt),play:kr,pause:()=>(qt.forEach(Le=>{Le.pause()}),tn(),Xt),stop:()=>{qt.forEach(Le=>{Le.stop()}),yt&&(Gt(),yt=!1),mt=!1,lt=!1,Wt=!0,xt=void 0,Ve=void 0,gt=void 0,dt=0,Bt=!1,Be=!0,mn=!1},destroy:Le=>(qt.forEach(tt=>{tt.destroy(Le)}),(Le=>{Gt(),Le&&pn()})(Le),st.length=0,qt.length=0,Xe.length=0,Vt.length=0,St.length=0,yt=!1,Wt=!0,Xt),keyframes:Le=>{const tt=Xe!==Le;return Xe=Le,tt&&(Le=>{Hi?ii().forEach(tt=>{if(tt.effect.setKeyframes)tt.effect.setKeyframes(Le);else{const Nt=new KeyframeEffect(tt.effect.target,Le,tt.effect.getTiming());tt.effect=Nt}}):ti()})(Xe),Xt},addAnimation:Le=>{if(null!=Le)if(Array.isArray(Le))for(const tt of Le)tt.parent(Xt),qt.push(tt);else Le.parent(Xt),qt.push(Le);return Xt},addElement:Le=>{if(null!=Le)if(1===Le.nodeType)st.push(Le);else if(Le.length>=0)for(let tt=0;tt<Le.length;tt++)st.push(Le[tt]);else console.error("Invalid addElement value");return Xt},update:uo,fill:Le=>(Me=Le,uo(!0),Xt),direction:Le=>(it=Le,uo(!0),Xt),iterations:Le=>(Je=Le,uo(!0),Xt),duration:Le=>(!Hi&&0===Le&&(Le=1),qe=Le,uo(!0),Xt),easing:Le=>(_t=Le,uo(!0),Xt),delay:Le=>(Ne=Le,uo(!0),Xt),getWebAnimations:ii,getKeyframes:()=>Xe,getFill:Kt,getDirection:In,getDelay:me,getIterations:Y,getEasing:et,getDuration:Ue,afterAddRead:Le=>(gi.push(Le),Xt),afterAddWrite:Le=>($i.push(Le),Xt),afterClearStyles:(Le=[])=>{for(const tt of Le)en[tt]="";return Xt},afterStyles:(Le={})=>(en=Le,Xt),afterRemoveClass:Le=>(ve=_e(ve,Le),Xt),afterAddClass:Le=>(Ae=_e(Ae,Le),Xt),beforeAddRead:Le=>(Sn.push(Le),Xt),beforeAddWrite:Le=>(zt.push(Le),Xt),beforeClearStyles:(Le=[])=>{for(const tt of Le)Ze[tt]="";return Xt},beforeStyles:(Le={})=>(Ze=Le,Xt),beforeRemoveClass:Le=>(ae=_e(ae,Le),Xt),beforeAddClass:Le=>(Te=_e(Te,Le),Xt),onFinish:ge,isRunning:()=>0!==dt&&!mn,progressStart:(Le=!1,tt)=>(qt.forEach(Nt=>{Nt.progressStart(Le,tt)}),tn(),mt=Le,yt||xi(),uo(!1,!0,tt),Xt),progressStep:Le=>(qt.forEach(tt=>{tt.progressStep(Le)}),go(Le),Xt),progressEnd:(Le,tt,Nt)=>(mt=!1,qt.forEach(Ut=>{Ut.progressEnd(Le,tt,Nt)}),void 0!==Nt&&(Ve=Nt),Bt=!1,Be=!0,0===Le?(xt="reverse"===In()?"normal":"reverse","reverse"===xt&&(Be=!1),Hi?(uo(),go(1-tt)):(gt=(1-tt)*Ue()*-1,uo(!1,!1))):1===Le&&(Hi?(uo(),go(tt)):(gt=tt*Ue()*-1,uo(!1,!1))),void 0!==Le&&(ge(()=>{Ve=void 0,xt=void 0,gt=void 0},{oneTimeCallback:!0}),we||kr()),Xt)}}},1273:(zn,Dt,R)=>{"use strict";R.d(Dt,{E:()=>Se,a:()=>x,s:()=>y});const x=De=>{try{if(De instanceof q)return De.value;if(!s()||"string"!=typeof De||""===De)return De;if(De.includes("onload="))return"";const X=document.createDocumentFragment(),se=document.createElement("div");X.appendChild(se),se.innerHTML=De,ie.forEach(Re=>{const Ne=X.querySelectorAll(Re);for(let qe=Ne.length-1;qe>=0;qe--){const _t=Ne[qe];_t.parentNode?_t.parentNode.removeChild(_t):X.removeChild(_t);const Je=v(_t);for(let Me=0;Me<Je.length;Me++)d(Je[Me])}});const Ee=v(X);for(let Re=0;Re<Ee.length;Re++)d(Ee[Re]);const _e=document.createElement("div");_e.appendChild(X);const be=_e.querySelector("div");return null!==be?be.innerHTML:_e.innerHTML}catch(X){return console.error(X),""}},d=De=>{if(De.nodeType&&1!==De.nodeType)return;if(typeof NamedNodeMap<"u"&&!(De.attributes instanceof NamedNodeMap))return void De.remove();for(let se=De.attributes.length-1;se>=0;se--){const Ee=De.attributes.item(se),_e=Ee.name;if(!Q.includes(_e.toLowerCase())){De.removeAttribute(_e);continue}const be=Ee.value,Re=De[_e];(null!=be&&be.toLowerCase().includes("javascript:")||null!=Re&&Re.toLowerCase().includes("javascript:"))&&De.removeAttribute(_e)}const X=v(De);for(let se=0;se<X.length;se++)d(X[se])},v=De=>null!=De.children?De.children:De.childNodes,s=()=>{var De;const X=window,se=null===(De=X?.Ionic)||void 0===De?void 0:De.config;return!se||(se.get?se.get("sanitizerEnabled",!0):!0===se.sanitizerEnabled||void 0===se.sanitizerEnabled)},Q=["class","id","href","src","name","slot"],ie=["script","style","iframe","meta","link","object","embed"];class q{constructor(X){this.value=X}}const y=De=>{const X=window,se=X.Ionic;if(!se||!se.config||"Object"===se.config.constructor.name)return X.Ionic=X.Ionic||{},X.Ionic.config=Object.assign(Object.assign({},X.Ionic.config),De),X.Ionic.config},Se=!1},9439:(zn,Dt,R)=>{"use strict";R.d(Dt,{C:()=>Q,a:()=>v,d:()=>s});var x=R(5861),d=R(544);const v=function(){var ie=(0,x.Z)(function*(q,y,fe,Se,De,X){var se;if(q)return q.attachViewToDom(y,fe,De,Se);if(!(X||"string"==typeof fe||fe instanceof HTMLElement))throw new Error("framework delegate is missing");const Ee="string"==typeof fe?null===(se=y.ownerDocument)||void 0===se?void 0:se.createElement(fe):fe;return Se&&Se.forEach(_e=>Ee.classList.add(_e)),De&&Object.assign(Ee,De),y.appendChild(Ee),yield new Promise(_e=>(0,d.c)(Ee,_e)),Ee});return function(y,fe,Se,De,X,se){return ie.apply(this,arguments)}}(),s=(ie,q)=>{if(q){if(ie)return ie.removeViewFromDom(q.parentElement,q);q.remove()}return Promise.resolve()},Q=()=>{let ie,q;return{attachViewToDom:function(){var Se=(0,x.Z)(function*(De,X,se={},Ee=[]){var _e,be;if(ie=De,X){const Ne="string"==typeof X?null===(_e=ie.ownerDocument)||void 0===_e?void 0:_e.createElement(X):X;Ee.forEach(qe=>Ne.classList.add(qe)),Object.assign(Ne,se),ie.appendChild(Ne),yield new Promise(qe=>(0,d.c)(Ne,qe))}else if(ie.children.length>0&&("ION-MODAL"===ie.tagName||"ION-POPOVER"===ie.tagName)&&!ie.children[0].classList.contains("ion-delegate-host")){const qe=null===(be=ie.ownerDocument)||void 0===be?void 0:be.createElement("div");qe.classList.add("ion-delegate-host"),Ee.forEach(_t=>qe.classList.add(_t)),qe.append(...ie.children),ie.appendChild(qe)}const Re=document.querySelector("ion-app")||document.body;return q=document.createComment("ionic teleport"),ie.parentNode.insertBefore(q,ie),Re.appendChild(ie),ie});return function(X,se){return Se.apply(this,arguments)}}(),removeViewFromDom:()=>(ie&&q&&(q.parentNode.insertBefore(ie,q),q.remove()),Promise.resolve())}}},4587:(zn,Dt,R)=>{"use strict";R.d(Dt,{G:()=>Q});class d{constructor(q,y,fe,Se,De){this.id=y,this.name=fe,this.disableScroll=De,this.priority=1e6*Se+y,this.ctrl=q}canStart(){return!!this.ctrl&&this.ctrl.canStart(this.name)}start(){return!!this.ctrl&&this.ctrl.start(this.name,this.id,this.priority)}capture(){if(!this.ctrl)return!1;const q=this.ctrl.capture(this.name,this.id,this.priority);return q&&this.disableScroll&&this.ctrl.disableScroll(this.id),q}release(){this.ctrl&&(this.ctrl.release(this.id),this.disableScroll&&this.ctrl.enableScroll(this.id))}destroy(){this.release(),this.ctrl=void 0}}class v{constructor(q,y,fe,Se){this.id=y,this.disable=fe,this.disableScroll=Se,this.ctrl=q}block(){if(this.ctrl){if(this.disable)for(const q of this.disable)this.ctrl.disableGesture(q,this.id);this.disableScroll&&this.ctrl.disableScroll(this.id)}}unblock(){if(this.ctrl){if(this.disable)for(const q of this.disable)this.ctrl.enableGesture(q,this.id);this.disableScroll&&this.ctrl.enableScroll(this.id)}}destroy(){this.unblock(),this.ctrl=void 0}}const s="backdrop-no-scroll",Q=new class x{constructor(){this.gestureId=0,this.requestedStart=new Map,this.disabledGestures=new Map,this.disabledScroll=new Set}createGesture(q){var y;return new d(this,this.newID(),q.name,null!==(y=q.priority)&&void 0!==y?y:0,!!q.disableScroll)}createBlocker(q={}){return new v(this,this.newID(),q.disable,!!q.disableScroll)}start(q,y,fe){return this.canStart(q)?(this.requestedStart.set(y,fe),!0):(this.requestedStart.delete(y),!1)}capture(q,y,fe){if(!this.start(q,y,fe))return!1;const Se=this.requestedStart;let De=-1e4;if(Se.forEach(X=>{De=Math.max(De,X)}),De===fe){this.capturedId=y,Se.clear();const X=new CustomEvent("ionGestureCaptured",{detail:{gestureName:q}});return document.dispatchEvent(X),!0}return Se.delete(y),!1}release(q){this.requestedStart.delete(q),this.capturedId===q&&(this.capturedId=void 0)}disableGesture(q,y){let fe=this.disabledGestures.get(q);void 0===fe&&(fe=new Set,this.disabledGestures.set(q,fe)),fe.add(y)}enableGesture(q,y){const fe=this.disabledGestures.get(q);void 0!==fe&&fe.delete(y)}disableScroll(q){this.disabledScroll.add(q),1===this.disabledScroll.size&&document.body.classList.add(s)}enableScroll(q){this.disabledScroll.delete(q),0===this.disabledScroll.size&&document.body.classList.remove(s)}canStart(q){return!(void 0!==this.capturedId||this.isDisabled(q))}isCaptured(){return void 0!==this.capturedId}isScrollDisabled(){return this.disabledScroll.size>0}isDisabled(q){const y=this.disabledGestures.get(q);return!!(y&&y.size>0)}newID(){return this.gestureId++,this.gestureId}}},5421:(zn,Dt,R)=>{"use strict";R.r(Dt),R.d(Dt,{MENU_BACK_BUTTON_PRIORITY:()=>Q,OVERLAY_BACK_BUTTON_PRIORITY:()=>s,blockHardwareBackButton:()=>d,startHardwareBackButton:()=>v});var x=R(5861);const d=()=>{document.addEventListener("backbutton",()=>{})},v=()=>{const ie=document;let q=!1;ie.addEventListener("backbutton",()=>{if(q)return;let y=0,fe=[];const Se=new CustomEvent("ionBackButton",{bubbles:!1,detail:{register(se,Ee){fe.push({priority:se,handler:Ee,id:y++})}}});ie.dispatchEvent(Se);const De=function(){var se=(0,x.Z)(function*(Ee){try{if(Ee?.handler){const _e=Ee.handler(X);null!=_e&&(yield _e)}}catch(_e){console.error(_e)}});return function(_e){return se.apply(this,arguments)}}(),X=()=>{if(fe.length>0){let se={priority:Number.MIN_SAFE_INTEGER,handler:()=>{},id:-1};fe.forEach(Ee=>{Ee.priority>=se.priority&&(se=Ee)}),q=!0,fe=fe.filter(Ee=>Ee.id!==se.id),De(se).then(()=>q=!1)}};X()})},s=100,Q=99},544:(zn,Dt,R)=>{"use strict";R.d(Dt,{a:()=>y,b:()=>fe,c:()=>v,d:()=>be,e:()=>_e,f:()=>Ee,g:()=>Se,h:()=>se,i:()=>q,j:()=>Me,k:()=>Q,l:()=>Re,m:()=>s,n:()=>X,o:()=>Ne,p:()=>Je,q:()=>it,r:()=>De,s:()=>Xe,t:()=>x,u:()=>qe,v:()=>_t});const x=(Te,ae=0)=>new Promise(yt=>{d(Te,ae,yt)}),d=(Te,ae=0,yt)=>{let we,Ze;const Ae={passive:!0},en=()=>{we&&we()},dt=mt=>{(void 0===mt||Te===mt.target)&&(en(),yt(mt))};return Te&&(Te.addEventListener("webkitTransitionEnd",dt,Ae),Te.addEventListener("transitionend",dt,Ae),Ze=setTimeout(dt,ae+500),we=()=>{Ze&&(clearTimeout(Ze),Ze=void 0),Te.removeEventListener("webkitTransitionEnd",dt,Ae),Te.removeEventListener("transitionend",dt,Ae)}),en},v=(Te,ae)=>{Te.componentOnReady?Te.componentOnReady().then(yt=>ae(yt)):De(()=>ae(Te))},s=Te=>void 0!==Te.componentOnReady,Q=(Te,ae=[])=>{const yt={};return ae.forEach(we=>{Te.hasAttribute(we)&&(null!==Te.getAttribute(we)&&(yt[we]=Te.getAttribute(we)),Te.removeAttribute(we))}),yt},ie=["role","aria-activedescendant","aria-atomic","aria-autocomplete","aria-braillelabel","aria-brailleroledescription","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colindextext","aria-colspan","aria-controls","aria-current","aria-describedby","aria-description","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowindextext","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext"],q=(Te,ae)=>{let yt=ie;return ae&&ae.length>0&&(yt=yt.filter(we=>!ae.includes(we))),Q(Te,yt)},y=(Te,ae,yt,we)=>{var Ze;if(typeof window<"u"){const Ae=window,ve=null===(Ze=Ae?.Ionic)||void 0===Ze?void 0:Ze.config;if(ve){const en=ve.get("_ael");if(en)return en(Te,ae,yt,we);if(ve._ael)return ve._ael(Te,ae,yt,we)}}return Te.addEventListener(ae,yt,we)},fe=(Te,ae,yt,we)=>{var Ze;if(typeof window<"u"){const Ae=window,ve=null===(Ze=Ae?.Ionic)||void 0===Ze?void 0:Ze.config;if(ve){const en=ve.get("_rel");if(en)return en(Te,ae,yt,we);if(ve._rel)return ve._rel(Te,ae,yt,we)}}return Te.removeEventListener(ae,yt,we)},Se=(Te,ae=Te)=>Te.shadowRoot||ae,De=Te=>"function"==typeof __zone_symbol__requestAnimationFrame?__zone_symbol__requestAnimationFrame(Te):"function"==typeof requestAnimationFrame?requestAnimationFrame(Te):setTimeout(Te),X=Te=>!!Te.shadowRoot&&!!Te.attachShadow,se=Te=>{const ae=Te.closest("ion-item");return ae?ae.querySelector("ion-label"):null},Ee=Te=>{if(Te.focus(),Te.classList.contains("ion-focusable")){const ae=Te.closest("ion-app");ae&&ae.setFocus([Te])}},_e=(Te,ae)=>{let yt;const we=Te.getAttribute("aria-labelledby"),Ze=Te.id;let Ae=null!==we&&""!==we.trim()?we:ae+"-lbl",ve=null!==we&&""!==we.trim()?document.getElementById(we):se(Te);return ve?(null===we&&(ve.id=Ae),yt=ve.textContent,ve.setAttribute("aria-hidden","true")):""!==Ze.trim()&&(ve=document.querySelector(`label[for="${Ze}"]`),ve&&(""!==ve.id?Ae=ve.id:ve.id=Ae=`${Ze}-lbl`,yt=ve.textContent)),{label:ve,labelId:Ae,labelText:yt}},be=(Te,ae,yt,we,Ze)=>{if(Te||X(ae)){let Ae=ae.querySelector("input.aux-input");Ae||(Ae=ae.ownerDocument.createElement("input"),Ae.type="hidden",Ae.classList.add("aux-input"),ae.appendChild(Ae)),Ae.disabled=Ze,Ae.name=yt,Ae.value=we||""}},Re=(Te,ae,yt)=>Math.max(Te,Math.min(ae,yt)),Ne=(Te,ae)=>{if(!Te){const yt="ASSERT: "+ae;throw console.error(yt),new Error(yt)}},qe=Te=>Te.timeStamp||Date.now(),_t=Te=>{if(Te){const ae=Te.changedTouches;if(ae&&ae.length>0){const yt=ae[0];return{x:yt.clientX,y:yt.clientY}}if(void 0!==Te.pageX)return{x:Te.pageX,y:Te.pageY}}return{x:0,y:0}},Je=Te=>{const ae="rtl"===document.dir;switch(Te){case"start":return ae;case"end":return!ae;default:throw new Error(`"${Te}" is not a valid value for [side]. Use "start" or "end" instead.`)}},Me=(Te,ae)=>{const yt=Te._original||Te;return{_original:Te,emit:it(yt.emit.bind(yt),ae)}},it=(Te,ae=0)=>{let yt;return(...we)=>{clearTimeout(yt),yt=setTimeout(Te,ae,...we)}},Xe=(Te,ae)=>{if(Te??(Te={}),ae??(ae={}),Te===ae)return!0;const yt=Object.keys(Te);if(yt.length!==Object.keys(ae).length)return!1;for(const we of yt)if(!(we in ae)||Te[we]!==ae[we])return!1;return!0}},6953:(zn,Dt,R)=>{"use strict";R.d(Dt,{B:()=>De,H:()=>en,a:()=>ho,b:()=>Ii,c:()=>Bt,d:()=>mn,e:()=>Qn,f:()=>Xt,g:()=>Wt,h:()=>Ae,i:()=>Pt,j:()=>X,p:()=>Qo,r:()=>Pn,w:()=>Ui});var x=R(5861);let v,s,Q,ie=!1,q=!1,y=!1,fe=!1,Se=!1;const De={isDev:!1,isBrowser:!0,isServer:!1,isTesting:!1},X=ye=>{const rt=new URL(ye,Ai.$resourcesUrl$);return rt.origin!==uo.location.origin?rt.href:rt.pathname},qe="s-id",_t="sty-id",it="http://www.w3.org/1999/xlink",Xe={},we=ye=>"object"==(ye=typeof ye)||"function"===ye;function Ze(ye){var rt,Le,tt;return null!==(tt=null===(Le=null===(rt=ye.head)||void 0===rt?void 0:rt.querySelector('meta[name="csp-nonce"]'))||void 0===Le?void 0:Le.getAttribute("content"))&&void 0!==tt?tt:void 0}const Ae=(ye,rt,...Le)=>{let tt=null,Nt=null,Ut=null,_n=!1,Cn=!1;const vn=[],On=Di=>{for(let Bi=0;Bi<Di.length;Bi++)tt=Di[Bi],Array.isArray(tt)?On(tt):null!=tt&&"boolean"!=typeof tt&&((_n="function"!=typeof ye&&!we(tt))&&(tt=String(tt)),_n&&Cn?vn[vn.length-1].$text$+=tt:vn.push(_n?ve(null,tt):tt),Cn=_n)};if(On(Le),rt){rt.key&&(Nt=rt.key),rt.name&&(Ut=rt.name);{const Di=rt.className||rt.class;Di&&(rt.class="object"!=typeof Di?Di:Object.keys(Di).filter(Bi=>Di[Bi]).join(" "))}}if("function"==typeof ye)return ye(null===rt?{}:rt,vn,mt);const di=ve(ye,null);return di.$attrs$=rt,vn.length>0&&(di.$children$=vn),di.$key$=Nt,di.$name$=Ut,di},ve=(ye,rt)=>({$flags$:0,$tag$:ye,$text$:rt,$elm$:null,$children$:null,$attrs$:null,$key$:null,$name$:null}),en={},mt={forEach:(ye,rt)=>ye.map(lt).forEach(rt),map:(ye,rt)=>ye.map(lt).map(rt).map(ze)},lt=ye=>({vattrs:ye.$attrs$,vchildren:ye.$children$,vkey:ye.$key$,vname:ye.$name$,vtag:ye.$tag$,vtext:ye.$text$}),ze=ye=>{if("function"==typeof ye.vtag){const Le=Object.assign({},ye.vattrs);return ye.vkey&&(Le.key=ye.vkey),ye.vname&&(Le.name=ye.vname),Ae(ye.vtag,Le,...ye.vchildren||[])}const rt=ve(ye.vtag,ye.vtext);return rt.$attrs$=ye.vattrs,rt.$children$=ye.vchildren,rt.$key$=ye.vkey,rt.$name$=ye.vname,rt},Ve=(ye,rt,Le,tt,Nt,Ut,_n)=>{let Cn,vn,On,di;if(1===Ut.nodeType){for(Cn=Ut.getAttribute("c-id"),Cn&&(vn=Cn.split("."),(vn[0]===_n||"0"===vn[0])&&(On={$flags$:0,$hostId$:vn[0],$nodeId$:vn[1],$depth$:vn[2],$index$:vn[3],$tag$:Ut.tagName.toLowerCase(),$elm$:Ut,$attrs$:null,$children$:null,$key$:null,$name$:null,$text$:null},rt.push(On),Ut.removeAttribute("c-id"),ye.$children$||(ye.$children$=[]),ye.$children$[On.$index$]=On,ye=On,tt&&"0"===On.$depth$&&(tt[On.$index$]=On.$elm$))),di=Ut.childNodes.length-1;di>=0;di--)Ve(ye,rt,Le,tt,Nt,Ut.childNodes[di],_n);if(Ut.shadowRoot)for(di=Ut.shadowRoot.childNodes.length-1;di>=0;di--)Ve(ye,rt,Le,tt,Nt,Ut.shadowRoot.childNodes[di],_n)}else if(8===Ut.nodeType)vn=Ut.nodeValue.split("."),(vn[1]===_n||"0"===vn[1])&&(Cn=vn[0],On={$flags$:0,$hostId$:vn[1],$nodeId$:vn[2],$depth$:vn[3],$index$:vn[4],$elm$:Ut,$attrs$:null,$children$:null,$key$:null,$name$:null,$tag$:null,$text$:null},"t"===Cn?(On.$elm$=Ut.nextSibling,On.$elm$&&3===On.$elm$.nodeType&&(On.$text$=On.$elm$.textContent,rt.push(On),Ut.remove(),ye.$children$||(ye.$children$=[]),ye.$children$[On.$index$]=On,tt&&"0"===On.$depth$&&(tt[On.$index$]=On.$elm$))):On.$hostId$===_n&&("s"===Cn?(On.$tag$="slot",Ut["s-sn"]=vn[5]?On.$name$=vn[5]:"",Ut["s-sr"]=!0,tt&&(On.$elm$=oo.createElement(On.$tag$),On.$name$&&On.$elm$.setAttribute("name",On.$name$),Ut.parentNode.insertBefore(On.$elm$,Ut),Ut.remove(),"0"===On.$depth$&&(tt[On.$index$]=On.$elm$)),Le.push(On),ye.$children$||(ye.$children$=[]),ye.$children$[On.$index$]=On):"r"===Cn&&(tt?Ut.remove():(Nt["s-cr"]=Ut,Ut["s-cn"]=!0))));else if(ye&&"style"===ye.$tag$){const Di=ve(null,Ut.textContent);Di.$elm$=Ut,Di.$index$="0",ye.$children$=[Di]}},gt=(ye,rt)=>{if(1===ye.nodeType){let Le=0;for(;Le<ye.childNodes.length;Le++)gt(ye.childNodes[Le],rt);if(ye.shadowRoot)for(Le=0;Le<ye.shadowRoot.childNodes.length;Le++)gt(ye.shadowRoot.childNodes[Le],rt)}else if(8===ye.nodeType){const Le=ye.nodeValue.split(".");"o"===Le[0]&&(rt.set(Le[1]+"."+Le[2],ye),ye.nodeValue="",ye["s-en"]=Le[3])}},Bt=ye=>Go.push(ye),Wt=ye=>Nn(ye).$modeName$,Xt=ye=>Nn(ye).$hostElement$,mn=(ye,rt,Le)=>{const tt=Xt(ye);return{emit:Nt=>an(tt,rt,{bubbles:!!(4&Le),composed:!!(2&Le),cancelable:!!(1&Le),detail:Nt})}},an=(ye,rt,Le)=>{const tt=Ai.ce(rt,Le);return ye.dispatchEvent(tt),tt},Vt=new WeakMap,St=(ye,rt,Le)=>{let tt=So.get(ye);xo&&Le?(tt=tt||new CSSStyleSheet,"string"==typeof tt?tt=rt:tt.replaceSync(rt)):tt=rt,So.set(ye,tt)},st=(ye,rt,Le,tt)=>{var Nt;let Ut=dn(rt,Le);const _n=So.get(Ut);if(ye=11===ye.nodeType?ye:oo,_n)if("string"==typeof _n){let vn,Cn=Vt.get(ye=ye.head||ye);if(Cn||Vt.set(ye,Cn=new Set),!Cn.has(Ut)){if(ye.host&&(vn=ye.querySelector(`[${_t}="${Ut}"]`)))vn.innerHTML=_n;else{vn=oo.createElement("style"),vn.innerHTML=_n;const On=null!==(Nt=Ai.$nonce$)&&void 0!==Nt?Nt:Ze(oo);null!=On&&vn.setAttribute("nonce",On),ye.insertBefore(vn,ye.querySelector("link"))}Cn&&Cn.add(Ut)}}else ye.adoptedStyleSheets.includes(_n)||(ye.adoptedStyleSheets=[...ye.adoptedStyleSheets,_n]);return Ut},dn=(ye,rt)=>"sc-"+(rt&&32&ye.$flags$?ye.$tagName$+"-"+rt:ye.$tagName$),Sn=ye=>ye.replace(/\/\*!@([^\/]+)\*\/[^\{]+\{/g,"$1{"),zt=(ye,rt,Le,tt,Nt,Ut)=>{if(Le!==tt){let _n=ti(ye,rt),Cn=rt.toLowerCase();if("class"===rt){const vn=ye.classList,On=$i(Le),di=$i(tt);vn.remove(...On.filter(Di=>Di&&!di.includes(Di))),vn.add(...di.filter(Di=>Di&&!On.includes(Di)))}else if("style"===rt){for(const vn in Le)(!tt||null==tt[vn])&&(vn.includes("-")?ye.style.removeProperty(vn):ye.style[vn]="");for(const vn in tt)(!Le||tt[vn]!==Le[vn])&&(vn.includes("-")?ye.style.setProperty(vn,tt[vn]):ye.style[vn]=tt[vn])}else if("key"!==rt)if("ref"===rt)tt&&tt(ye);else if(_n||"o"!==rt[0]||"n"!==rt[1]){const vn=we(tt);if((_n||vn&&null!==tt)&&!Nt)try{if(ye.tagName.includes("-"))ye[rt]=tt;else{const di=tt??"";"list"===rt?_n=!1:(null==Le||ye[rt]!=di)&&(ye[rt]=di)}}catch{}let On=!1;Cn!==(Cn=Cn.replace(/^xlink\:?/,""))&&(rt=Cn,On=!0),null==tt||!1===tt?(!1!==tt||""===ye.getAttribute(rt))&&(On?ye.removeAttributeNS(it,rt):ye.removeAttribute(rt)):(!_n||4&Ut||Nt)&&!vn&&(tt=!0===tt?"":tt,On?ye.setAttributeNS(it,rt,tt):ye.setAttribute(rt,tt))}else rt="-"===rt[2]?rt.slice(3):ti(uo,Cn)?Cn.slice(2):Cn[2]+rt.slice(3),Le&&Ai.rel(ye,rt,Le,!1),tt&&Ai.ael(ye,rt,tt,!1)}},gi=/\s/,$i=ye=>ye?ye.split(gi):[],Ci=(ye,rt,Le,tt)=>{const Nt=11===rt.$elm$.nodeType&&rt.$elm$.host?rt.$elm$.host:rt.$elm$,Ut=ye&&ye.$attrs$||Xe,_n=rt.$attrs$||Xe;for(tt in Ut)tt in _n||zt(Nt,tt,Ut[tt],void 0,Le,rt.$flags$);for(tt in _n)zt(Nt,tt,Ut[tt],_n[tt],Le,rt.$flags$)},Ji=(ye,rt,Le,tt)=>{const Nt=rt.$children$[Le];let _n,Cn,vn,Ut=0;if(ie||(y=!0,"slot"===Nt.$tag$&&(v&&tt.classList.add(v+"-s"),Nt.$flags$|=Nt.$children$?2:1)),null!==Nt.$text$)_n=Nt.$elm$=oo.createTextNode(Nt.$text$);else if(1&Nt.$flags$)_n=Nt.$elm$=oo.createTextNode("");else{if(fe||(fe="svg"===Nt.$tag$),_n=Nt.$elm$=oo.createElementNS(fe?"http://www.w3.org/2000/svg":"http://www.w3.org/1999/xhtml",2&Nt.$flags$?"slot-fb":Nt.$tag$),fe&&"foreignObject"===Nt.$tag$&&(fe=!1),Ci(null,Nt,fe),(ye=>null!=ye)(v)&&_n["s-si"]!==v&&_n.classList.add(_n["s-si"]=v),Nt.$children$)for(Ut=0;Ut<Nt.$children$.length;++Ut)Cn=Ji(ye,Nt,Ut,_n),Cn&&_n.appendChild(Cn);"svg"===Nt.$tag$?fe=!1:"foreignObject"===_n.tagName&&(fe=!0)}return _n["s-hn"]=Q,3&Nt.$flags$&&(_n["s-sr"]=!0,_n["s-cr"]=s,_n["s-sn"]=Nt.$name$||"",vn=ye&&ye.$children$&&ye.$children$[Le],vn&&vn.$tag$===Nt.$tag$&&ye.$elm$&&Hi(ye.$elm$,!1)),_n},Hi=(ye,rt)=>{Ai.$flags$|=1;const Le=ye.childNodes;for(let tt=Le.length-1;tt>=0;tt--){const Nt=Le[tt];Nt["s-hn"]!==Q&&Nt["s-ol"]&&(Mt(Nt).insertBefore(Nt,Qt(Nt)),Nt["s-ol"].remove(),Nt["s-ol"]=void 0,y=!0),rt&&Hi(Nt,rt)}Ai.$flags$&=-2},Fi=(ye,rt,Le,tt,Nt,Ut)=>{let Cn,_n=ye["s-cr"]&&ye["s-cr"].parentNode||ye;for(_n.shadowRoot&&_n.tagName===Q&&(_n=_n.shadowRoot);Nt<=Ut;++Nt)tt[Nt]&&(Cn=Ji(null,Le,Nt,ye),Cn&&(tt[Nt].$elm$=Cn,_n.insertBefore(Cn,Qt(rt))))},ii=(ye,rt,Le)=>{for(let tt=rt;tt<=Le;++tt){const Nt=ye[tt];if(Nt){const Ut=Nt.$elm$;ri(Nt),Ut&&(q=!0,Ut["s-ol"]?Ut["s-ol"].remove():Hi(Ut,!0),Ut.remove())}}},xn=(ye,rt)=>ye.$tag$===rt.$tag$&&("slot"===ye.$tag$?ye.$name$===rt.$name$:ye.$key$===rt.$key$),Qt=ye=>ye&&ye["s-ol"]||ye,Mt=ye=>(ye["s-ol"]?ye["s-ol"]:ye).parentNode,ge=(ye,rt)=>{const Le=rt.$elm$=ye.$elm$,tt=ye.$children$,Nt=rt.$children$,Ut=rt.$tag$,_n=rt.$text$;let Cn;null===_n?(fe="svg"===Ut||"foreignObject"!==Ut&&fe,"slot"===Ut||Ci(ye,rt,fe),null!==tt&&null!==Nt?((ye,rt,Le,tt)=>{let Qi,ao,Nt=0,Ut=0,_n=0,Cn=0,vn=rt.length-1,On=rt[0],di=rt[vn],Di=tt.length-1,Bi=tt[0],Lo=tt[Di];for(;Nt<=vn&&Ut<=Di;)if(null==On)On=rt[++Nt];else if(null==di)di=rt[--vn];else if(null==Bi)Bi=tt[++Ut];else if(null==Lo)Lo=tt[--Di];else if(xn(On,Bi))ge(On,Bi),On=rt[++Nt],Bi=tt[++Ut];else if(xn(di,Lo))ge(di,Lo),di=rt[--vn],Lo=tt[--Di];else if(xn(On,Lo))("slot"===On.$tag$||"slot"===Lo.$tag$)&&Hi(On.$elm$.parentNode,!1),ge(On,Lo),ye.insertBefore(On.$elm$,di.$elm$.nextSibling),On=rt[++Nt],Lo=tt[--Di];else if(xn(di,Bi))("slot"===On.$tag$||"slot"===Lo.$tag$)&&Hi(di.$elm$.parentNode,!1),ge(di,Bi),ye.insertBefore(di.$elm$,On.$elm$),di=rt[--vn],Bi=tt[++Ut];else{for(_n=-1,Cn=Nt;Cn<=vn;++Cn)if(rt[Cn]&&null!==rt[Cn].$key$&&rt[Cn].$key$===Bi.$key$){_n=Cn;break}_n>=0?(ao=rt[_n],ao.$tag$!==Bi.$tag$?Qi=Ji(rt&&rt[Ut],Le,_n,ye):(ge(ao,Bi),rt[_n]=void 0,Qi=ao.$elm$),Bi=tt[++Ut]):(Qi=Ji(rt&&rt[Ut],Le,Ut,ye),Bi=tt[++Ut]),Qi&&Mt(On.$elm$).insertBefore(Qi,Qt(On.$elm$))}Nt>vn?Fi(ye,null==tt[Di+1]?null:tt[Di+1].$elm$,Le,tt,Ut,Di):Ut>Di&&ii(rt,Nt,vn)})(Le,tt,rt,Nt):null!==Nt?(null!==ye.$text$&&(Le.textContent=""),Fi(Le,null,rt,Nt,0,Nt.length-1)):null!==tt&&ii(tt,0,tt.length-1),fe&&"svg"===Ut&&(fe=!1)):(Cn=Le["s-cr"])?Cn.parentNode.textContent=_n:ye.$text$!==_n&&(Le.data=_n)},ct=ye=>{const rt=ye.childNodes;let Le,tt,Nt,Ut,_n,Cn;for(tt=0,Nt=rt.length;tt<Nt;tt++)if(Le=rt[tt],1===Le.nodeType){if(Le["s-sr"])for(_n=Le["s-sn"],Le.hidden=!1,Ut=0;Ut<Nt;Ut++)if(Cn=rt[Ut].nodeType,rt[Ut]["s-hn"]!==Le["s-hn"]||""!==_n){if(1===Cn&&_n===rt[Ut].getAttribute("slot")){Le.hidden=!0;break}}else if(1===Cn||3===Cn&&""!==rt[Ut].textContent.trim()){Le.hidden=!0;break}ct(Le)}},Gt=[],pn=ye=>{let rt,Le,tt,Nt,Ut,_n,Cn=0;const vn=ye.childNodes,On=vn.length;for(;Cn<On;Cn++){if(rt=vn[Cn],rt["s-sr"]&&(Le=rt["s-cr"])&&Le.parentNode)for(tt=Le.parentNode.childNodes,Nt=rt["s-sn"],_n=tt.length-1;_n>=0;_n--)Le=tt[_n],!Le["s-cn"]&&!Le["s-nr"]&&Le["s-hn"]!==rt["s-hn"]&&(Gi(Le,Nt)?(Ut=Gt.find(di=>di.$nodeToRelocate$===Le),q=!0,Le["s-sn"]=Le["s-sn"]||Nt,Ut?Ut.$slotRefNode$=rt:Gt.push({$slotRefNode$:rt,$nodeToRelocate$:Le}),Le["s-sr"]&&Gt.map(di=>{Gi(di.$nodeToRelocate$,Le["s-sn"])&&(Ut=Gt.find(Di=>Di.$nodeToRelocate$===Le),Ut&&!di.$slotRefNode$&&(di.$slotRefNode$=Ut.$slotRefNode$))})):Gt.some(di=>di.$nodeToRelocate$===Le)||Gt.push({$nodeToRelocate$:Le}));1===rt.nodeType&&pn(rt)}},Gi=(ye,rt)=>1===ye.nodeType?null===ye.getAttribute("slot")&&""===rt||ye.getAttribute("slot")===rt:ye["s-sn"]===rt||""===rt,ri=ye=>{ye.$attrs$&&ye.$attrs$.ref&&ye.$attrs$.ref(null),ye.$children$&&ye.$children$.map(ri)},ut=(ye,rt)=>{rt&&!ye.$onRenderResolve$&&rt["s-p"]&&rt["s-p"].push(new Promise(Le=>ye.$onRenderResolve$=Le))},pe=(ye,rt)=>{if(ye.$flags$|=16,!(4&ye.$flags$))return ut(ye,ye.$ancestorComponent$),Ui(()=>xe(ye,rt));ye.$flags$|=512},xe=(ye,rt)=>{const tt=ye.$lazyInstance$;let Nt;return rt&&(ye.$flags$|=256,ye.$queuedListeners$&&(ye.$queuedListeners$.map(([Ut,_n])=>In(tt,Ut,_n)),ye.$queuedListeners$=void 0),Nt=In(tt,"componentWillLoad")),Nt=Qe(Nt,()=>In(tt,"componentWillRender")),Qe(Nt,()=>Lt(ye,tt,rt))},Qe=(ye,rt)=>vt(ye)?ye.then(rt):rt(),vt=ye=>ye instanceof Promise||ye&&ye.then&&"function"==typeof ye.then,Lt=function(){var ye=(0,x.Z)(function*(rt,Le,tt){var Nt;const Ut=rt.$hostElement$,Cn=Ut["s-rc"];tt&&(ye=>{const rt=ye.$cmpMeta$,Le=ye.$hostElement$,tt=rt.$flags$,Ut=st(Le.shadowRoot?Le.shadowRoot:Le.getRootNode(),rt,ye.$modeName$);10&tt&&(Le["s-sc"]=Ut,Le.classList.add(Ut+"-h"),2&tt&&Le.classList.add(Ut+"-s"))})(rt);Zt(rt,Le),Cn&&(Cn.map(On=>On()),Ut["s-rc"]=void 0);{const On=null!==(Nt=Ut["s-p"])&&void 0!==Nt?Nt:[],di=()=>jt(rt);0===On.length?di():(Promise.all(On).then(di),rt.$flags$|=4,On.length=0)}});return function(Le,tt,Nt){return ye.apply(this,arguments)}}(),Zt=(ye,rt,Le)=>{try{rt=rt.render&&rt.render(),ye.$flags$&=-17,ye.$flags$|=2,((ye,rt)=>{const Le=ye.$hostElement$,tt=ye.$cmpMeta$,Nt=ye.$vnode$||ve(null,null),Ut=(ye=>ye&&ye.$tag$===en)(rt)?rt:Ae(null,null,rt);if(Q=Le.tagName,tt.$attrsToReflect$&&(Ut.$attrs$=Ut.$attrs$||{},tt.$attrsToReflect$.map(([_n,Cn])=>Ut.$attrs$[Cn]=Le[_n])),Ut.$tag$=null,Ut.$flags$|=4,ye.$vnode$=Ut,Ut.$elm$=Nt.$elm$=Le.shadowRoot||Le,v=Le["s-sc"],s=Le["s-cr"],ie=0!=(1&tt.$flags$),q=!1,ge(Nt,Ut),Ai.$flags$|=1,y){pn(Ut.$elm$);let _n,Cn,vn,On,di,Di,Bi=0;for(;Bi<Gt.length;Bi++)_n=Gt[Bi],Cn=_n.$nodeToRelocate$,Cn["s-ol"]||(vn=oo.createTextNode(""),vn["s-nr"]=Cn,Cn.parentNode.insertBefore(Cn["s-ol"]=vn,Cn));for(Bi=0;Bi<Gt.length;Bi++)if(_n=Gt[Bi],Cn=_n.$nodeToRelocate$,_n.$slotRefNode$){for(On=_n.$slotRefNode$.parentNode,di=_n.$slotRefNode$.nextSibling,vn=Cn["s-ol"];vn=vn.previousSibling;)if(Di=vn["s-nr"],Di&&Di["s-sn"]===Cn["s-sn"]&&On===Di.parentNode&&(Di=Di.nextSibling,!Di||!Di["s-nr"])){di=Di;break}(!di&&On!==Cn.parentNode||Cn.nextSibling!==di)&&Cn!==di&&(!Cn["s-hn"]&&Cn["s-ol"]&&(Cn["s-hn"]=Cn["s-ol"].parentNode.nodeName),On.insertBefore(Cn,di))}else 1===Cn.nodeType&&(Cn.hidden=!0)}q&&ct(Ut.$elm$),Ai.$flags$&=-2,Gt.length=0})(ye,rt)}catch(tt){qi(tt,ye.$hostElement$)}return null},jt=ye=>{const Le=ye.$hostElement$,Nt=ye.$lazyInstance$,Ut=ye.$ancestorComponent$;In(Nt,"componentDidRender"),64&ye.$flags$?In(Nt,"componentDidUpdate"):(ye.$flags$|=64,et(Le),In(Nt,"componentDidLoad"),ye.$onReadyResolve$(Le),Ut||Kt()),ye.$onInstanceResolve$(Le),ye.$onRenderResolve$&&(ye.$onRenderResolve$(),ye.$onRenderResolve$=void 0),512&ye.$flags$&&kr(()=>pe(ye,!1)),ye.$flags$&=-517},Pt=ye=>{{const rt=Nn(ye),Le=rt.$hostElement$.isConnected;return Le&&2==(18&rt.$flags$)&&pe(rt,!1),Le}},Kt=ye=>{et(oo.documentElement),kr(()=>an(uo,"appload",{detail:{namespace:"ionic"}}))},In=(ye,rt,Le)=>{if(ye&&ye[rt])try{return ye[rt](Le)}catch(tt){qi(tt)}},et=ye=>ye.classList.add("hydrated"),me=(ye,rt,Le)=>{if(rt.$members$){ye.watchers&&(rt.$watchers$=ye.watchers);const tt=Object.entries(rt.$members$),Nt=ye.prototype;if(tt.map(([Ut,[_n]])=>{31&_n||2&Le&&32&_n?Object.defineProperty(Nt,Ut,{get(){return((ye,rt)=>Nn(this).$instanceValues$.get(rt))(0,Ut)},set(Cn){((ye,rt,Le,tt)=>{const Nt=Nn(ye),Ut=Nt.$hostElement$,_n=Nt.$instanceValues$.get(rt),Cn=Nt.$flags$,vn=Nt.$lazyInstance$;Le=((ye,rt)=>null==ye||we(ye)?ye:4&rt?"false"!==ye&&(""===ye||!!ye):2&rt?parseFloat(ye):1&rt?String(ye):ye)(Le,tt.$members$[rt][0]);const On=Number.isNaN(_n)&&Number.isNaN(Le);if((!(8&Cn)||void 0===_n)&&Le!==_n&&!On&&(Nt.$instanceValues$.set(rt,Le),vn)){if(tt.$watchers$&&128&Cn){const Di=tt.$watchers$[rt];Di&&Di.map(Bi=>{try{vn[Bi](Le,_n,rt)}catch(Lo){qi(Lo,Ut)}})}2==(18&Cn)&&pe(Nt,!1)}})(this,Ut,Cn,rt)},configurable:!0,enumerable:!0}):1&Le&&64&_n&&Object.defineProperty(Nt,Ut,{value(...Cn){const vn=Nn(this);return vn.$onInstancePromise$.then(()=>vn.$lazyInstance$[Ut](...Cn))}})}),1&Le){const Ut=new Map;Nt.attributeChangedCallback=function(_n,Cn,vn){Ai.jmp(()=>{const On=Ut.get(_n);if(this.hasOwnProperty(On))vn=this[On],delete this[On];else if(Nt.hasOwnProperty(On)&&"number"==typeof this[On]&&this[On]==vn)return;this[On]=(null!==vn||"boolean"!=typeof this[On])&&vn})},ye.observedAttributes=tt.filter(([_n,Cn])=>15&Cn[0]).map(([_n,Cn])=>{const vn=Cn[1]||_n;return Ut.set(vn,_n),512&Cn[0]&&rt.$attrsToReflect$.push([_n,vn]),vn})}}return ye},Ge=function(){var ye=(0,x.Z)(function*(rt,Le,tt,Nt,Ut){if(!(32&Le.$flags$)){Le.$flags$|=32;{if((Ut=go(tt)).then){const On=()=>{};Ut=yield Ut,On()}Ut.isProxied||(tt.$watchers$=Ut.watchers,me(Ut,tt,2),Ut.isProxied=!0);const vn=()=>{};Le.$flags$|=8;try{new Ut(Le)}catch(On){qi(On)}Le.$flags$&=-9,Le.$flags$|=128,vn(),Ft(Le.$lazyInstance$)}if(Ut.style){let vn=Ut.style;"string"!=typeof vn&&(vn=vn[Le.$modeName$=(ye=>Go.map(rt=>rt(ye)).find(rt=>!!rt))(rt)]);const On=dn(tt,Le.$modeName$);if(!So.has(On)){const di=()=>{};St(On,vn,!!(1&tt.$flags$)),di()}}}const _n=Le.$ancestorComponent$,Cn=()=>pe(Le,!0);_n&&_n["s-rc"]?_n["s-rc"].push(Cn):Cn()});return function(Le,tt,Nt,Ut,_n){return ye.apply(this,arguments)}}(),Ft=ye=>{In(ye,"connectedCallback")},ei=ye=>{const rt=ye["s-cr"]=oo.createComment("");rt["s-cn"]=!0,ye.insertBefore(rt,ye.firstChild)},Ii=(ye,rt={})=>{var Le;const Nt=[],Ut=rt.exclude||[],_n=uo.customElements,Cn=oo.head,vn=Cn.querySelector("meta[charset]"),On=oo.createElement("style"),di=[],Di=oo.querySelectorAll(`[${_t}]`);let Bi,Lo=!0,Qi=0;for(Object.assign(Ai,rt),Ai.$resourcesUrl$=new URL(rt.resourcesUrl||"./",oo.baseURI).href,Ai.$flags$|=2;Qi<Di.length;Qi++)St(Di[Qi].getAttribute(_t),Sn(Di[Qi].innerHTML),!0);ye.map(ao=>{ao[1].map(To=>{const or={$flags$:To[0],$tagName$:To[1],$members$:To[2],$listeners$:To[3]};or.$members$=To[2],or.$listeners$=To[3],or.$attrsToReflect$=[],or.$watchers$={};const Wo=or.$tagName$,dr=class extends HTMLElement{constructor(Co){super(Co),oi(Co=this,or),1&or.$flags$&&Co.attachShadow({mode:"open",delegatesFocus:!!(16&or.$flags$)})}connectedCallback(){Bi&&(clearTimeout(Bi),Bi=null),Lo?di.push(this):Ai.jmp(()=>(ye=>{if(!(1&Ai.$flags$)){const rt=Nn(ye),Le=rt.$cmpMeta$,tt=()=>{};if(1&rt.$flags$)Zi(ye,rt,Le.$listeners$),Ft(rt.$lazyInstance$);else{let Nt;if(rt.$flags$|=1,Nt=ye.getAttribute(qe),Nt){if(1&Le.$flags$){const Ut=st(ye.shadowRoot,Le,ye.getAttribute("s-mode"));ye.classList.remove(Ut+"-h",Ut+"-s")}((ye,rt,Le,tt)=>{const Ut=ye.shadowRoot,_n=[],vn=Ut?[]:null,On=tt.$vnode$=ve(rt,null);Ai.$orgLocNodes$||gt(oo.body,Ai.$orgLocNodes$=new Map),ye[qe]=Le,ye.removeAttribute(qe),Ve(On,_n,[],vn,ye,ye,Le),_n.map(di=>{const Di=di.$hostId$+"."+di.$nodeId$,Bi=Ai.$orgLocNodes$.get(Di),Lo=di.$elm$;Bi&&tn&&""===Bi["s-en"]&&Bi.parentNode.insertBefore(Lo,Bi.nextSibling),Ut||(Lo["s-hn"]=rt,Bi&&(Lo["s-ol"]=Bi,Lo["s-ol"]["s-nr"]=Lo)),Ai.$orgLocNodes$.delete(Di)}),Ut&&vn.map(di=>{di&&Ut.appendChild(di)})})(ye,Le.$tagName$,Nt,rt)}Nt||12&Le.$flags$&&ei(ye);{let Ut=ye;for(;Ut=Ut.parentNode||Ut.host;)if(1===Ut.nodeType&&Ut.hasAttribute("s-id")&&Ut["s-p"]||Ut["s-p"]){ut(rt,rt.$ancestorComponent$=Ut);break}}Le.$members$&&Object.entries(Le.$members$).map(([Ut,[_n]])=>{if(31&_n&&ye.hasOwnProperty(Ut)){const Cn=ye[Ut];delete ye[Ut],ye[Ut]=Cn}}),Ge(ye,rt,Le)}tt()}})(this))}disconnectedCallback(){Ai.jmp(()=>(ye=>{if(!(1&Ai.$flags$)){const rt=Nn(this),Le=rt.$lazyInstance$;rt.$rmListeners$&&(rt.$rmListeners$.map(tt=>tt()),rt.$rmListeners$=void 0),In(Le,"disconnectedCallback")}})())}componentOnReady(){return Nn(this).$onReadyPromise$}};or.$lazyBundleId$=ao[0],!Ut.includes(Wo)&&!_n.get(Wo)&&(Nt.push(Wo),_n.define(Wo,me(dr,or,1)))})});{On.innerHTML=Nt+"{visibility:hidden}.hydrated{visibility:inherit}",On.setAttribute("data-styles","");const ao=null!==(Le=Ai.$nonce$)&&void 0!==Le?Le:Ze(oo);null!=ao&&On.setAttribute("nonce",ao),Cn.insertBefore(On,vn?vn.nextSibling:Cn.firstChild)}Lo=!1,di.length?di.map(ao=>ao.connectedCallback()):Ai.jmp(()=>Bi=setTimeout(Kt,30))},Zi=(ye,rt,Le,tt)=>{Le&&Le.map(([Nt,Ut,_n])=>{const Cn=to(ye,Nt),vn=fo(rt,_n),On=nn(Nt);Ai.ael(Cn,Ut,vn,On),(rt.$rmListeners$=rt.$rmListeners$||[]).push(()=>Ai.rel(Cn,Ut,vn,On))})},fo=(ye,rt)=>Le=>{try{256&ye.$flags$?ye.$lazyInstance$[rt](Le):(ye.$queuedListeners$=ye.$queuedListeners$||[]).push([rt,Le])}catch(tt){qi(tt)}},to=(ye,rt)=>4&rt?oo:8&rt?uo:16&rt?oo.body:ye,nn=ye=>0!=(2&ye),Et=new WeakMap,Nn=ye=>Et.get(ye),Pn=(ye,rt)=>Et.set(rt.$lazyInstance$=ye,rt),oi=(ye,rt)=>{const Le={$flags$:0,$hostElement$:ye,$cmpMeta$:rt,$instanceValues$:new Map};return Le.$onInstancePromise$=new Promise(tt=>Le.$onInstanceResolve$=tt),Le.$onReadyPromise$=new Promise(tt=>Le.$onReadyResolve$=tt),ye["s-p"]=[],ye["s-rc"]=[],Zi(ye,Le,rt.$listeners$),Et.set(ye,Le)},ti=(ye,rt)=>rt in ye,qi=(ye,rt)=>(0,console.error)(ye,rt),xi=new Map,go=(ye,rt,Le)=>{const tt=ye.$tagName$.replace(/-/g,"_"),Nt=ye.$lazyBundleId$,Ut=xi.get(Nt);return Ut?Ut[tt]:R(863)(`./${Nt}.entry.js`).then(_n=>(xi.set(Nt,_n),_n[tt]),qi)},So=new Map,Go=[],uo=typeof window<"u"?window:{},oo=uo.document||{head:{}},Ai={$flags$:0,$resourcesUrl$:"",jmp:ye=>ye(),raf:ye=>requestAnimationFrame(ye),ael:(ye,rt,Le,tt)=>ye.addEventListener(rt,Le,tt),rel:(ye,rt,Le,tt)=>ye.removeEventListener(rt,Le,tt),ce:(ye,rt)=>new CustomEvent(ye,rt)},ho=ye=>{Object.assign(Ai,ye)},tn=!0,Qo=ye=>Promise.resolve(ye),xo=(()=>{try{return new CSSStyleSheet,"function"==typeof(new CSSStyleSheet).replaceSync}catch{}return!1})(),Ki=[],gr=[],bo=(ye,rt)=>Le=>{ye.push(Le),Se||(Se=!0,rt&&4&Ai.$flags$?kr(Mr):Ai.raf(Mr))},Zr=ye=>{for(let rt=0;rt<ye.length;rt++)try{ye[rt](performance.now())}catch(Le){qi(Le)}ye.length=0},Mr=()=>{Zr(Ki),Zr(gr),(Se=Ki.length>0)&&Ai.raf(Mr)},kr=ye=>Qo().then(ye),Qn=bo(Ki,!1),Ui=bo(gr,!0)},8077:(zn,Dt,R)=>{"use strict";R.r(Dt),R.d(Dt,{GESTURE_CONTROLLER:()=>x.G,createGesture:()=>fe});var x=R(4587);const d=(se,Ee,_e,be)=>{const Re=v(se)?{capture:!!be.capture,passive:!!be.passive}:!!be.capture;let Ne,qe;return se.__zone_symbol__addEventListener?(Ne="__zone_symbol__addEventListener",qe="__zone_symbol__removeEventListener"):(Ne="addEventListener",qe="removeEventListener"),se[Ne](Ee,_e,Re),()=>{se[qe](Ee,_e,Re)}},v=se=>{if(void 0===s)try{const Ee=Object.defineProperty({},"passive",{get:()=>{s=!0}});se.addEventListener("optsTest",()=>{},Ee)}catch{s=!1}return!!s};let s;const q=se=>se instanceof Document?se:se.ownerDocument,fe=se=>{let Ee=!1,_e=!1,be=!0,Re=!1;const Ne=Object.assign({disableScroll:!1,direction:"x",gesturePriority:0,passive:!0,maxAngle:40,threshold:10},se),qe=Ne.canStart,_t=Ne.onWillStart,Je=Ne.onStart,Me=Ne.onEnd,it=Ne.notCaptured,Xe=Ne.onMove,Te=Ne.threshold,ae=Ne.passive,yt=Ne.blurOnStart,we={type:"pan",startX:0,startY:0,startTime:0,currentX:0,currentY:0,velocityX:0,velocityY:0,deltaX:0,deltaY:0,currentTime:0,event:void 0,data:void 0},Ze=((se,Ee,_e)=>{const be=_e*(Math.PI/180),Re="x"===se,Ne=Math.cos(be),qe=Ee*Ee;let _t=0,Je=0,Me=!1,it=0;return{start(Xe,Te){_t=Xe,Je=Te,it=0,Me=!0},detect(Xe,Te){if(!Me)return!1;const ae=Xe-_t,yt=Te-Je,we=ae*ae+yt*yt;if(we<qe)return!1;const Ze=Math.sqrt(we),Ae=(Re?ae:yt)/Ze;return it=Ae>Ne?1:Ae<-Ne?-1:0,Me=!1,!0},isGesture:()=>0!==it,getDirection:()=>it}})(Ne.direction,Ne.threshold,Ne.maxAngle),Ae=x.G.createGesture({name:se.gestureName,priority:se.gesturePriority,disableScroll:se.disableScroll}),dt=()=>{Ee&&(Re=!1,Xe&&Xe(we))},mt=()=>!!Ae.capture()&&(Ee=!0,be=!1,we.startX=we.currentX,we.startY=we.currentY,we.startTime=we.currentTime,_t?_t(we).then(ze):ze(),!0),ze=()=>{yt&&(()=>{if(typeof document<"u"){const Bt=document.activeElement;Bt?.blur&&Bt.blur()}})(),Je&&Je(we),be=!0},xt=()=>{Ee=!1,_e=!1,Re=!1,be=!0,Ae.release()},Ve=Bt=>{const Wt=Ee,wn=be;if(xt(),wn){if(Se(we,Bt),Wt)return void(Me&&Me(we));it&&it(we)}},gt=((se,Ee,_e,be,Re)=>{let Ne,qe,_t,Je,Me,it,Xe,Te=0;const ae=lt=>{Te=Date.now()+2e3,Ee(lt)&&(!qe&&_e&&(qe=d(se,"touchmove",_e,Re)),_t||(_t=d(lt.target,"touchend",we,Re)),Je||(Je=d(lt.target,"touchcancel",we,Re)))},yt=lt=>{Te>Date.now()||Ee(lt)&&(!it&&_e&&(it=d(q(se),"mousemove",_e,Re)),Xe||(Xe=d(q(se),"mouseup",Ze,Re)))},we=lt=>{Ae(),be&&be(lt)},Ze=lt=>{ve(),be&&be(lt)},Ae=()=>{qe&&qe(),_t&&_t(),Je&&Je(),qe=_t=Je=void 0},ve=()=>{it&&it(),Xe&&Xe(),it=Xe=void 0},en=()=>{Ae(),ve()},dt=(lt=!0)=>{lt?(Ne||(Ne=d(se,"touchstart",ae,Re)),Me||(Me=d(se,"mousedown",yt,Re))):(Ne&&Ne(),Me&&Me(),Ne=Me=void 0,en())};return{enable:dt,stop:en,destroy:()=>{dt(!1),be=_e=Ee=void 0}}})(Ne.el,Bt=>{const Wt=X(Bt);return!(_e||!be||(De(Bt,we),we.startX=we.currentX,we.startY=we.currentY,we.startTime=we.currentTime=Wt,we.velocityX=we.velocityY=we.deltaX=we.deltaY=0,we.event=Bt,qe&&!1===qe(we))||(Ae.release(),!Ae.start()))&&(_e=!0,0===Te?mt():(Ze.start(we.startX,we.startY),!0))},Bt=>{Ee?!Re&&be&&(Re=!0,Se(we,Bt),requestAnimationFrame(dt)):(Se(we,Bt),Ze.detect(we.currentX,we.currentY)&&(!Ze.isGesture()||!mt())&&Be())},Ve,{capture:!1,passive:ae}),Be=()=>{xt(),gt.stop(),it&&it(we)};return{enable(Bt=!0){Bt||(Ee&&Ve(void 0),xt()),gt.enable(Bt)},destroy(){Ae.destroy(),gt.destroy()}}},Se=(se,Ee)=>{if(!Ee)return;const _e=se.currentX,be=se.currentY,Re=se.currentTime;De(Ee,se);const Ne=se.currentX,qe=se.currentY,Je=(se.currentTime=X(Ee))-Re;if(Je>0&&Je<100){const it=(qe-be)/Je;se.velocityX=(Ne-_e)/Je*.7+.3*se.velocityX,se.velocityY=.7*it+.3*se.velocityY}se.deltaX=Ne-se.startX,se.deltaY=qe-se.startY,se.event=Ee},De=(se,Ee)=>{let _e=0,be=0;if(se){const Re=se.changedTouches;if(Re&&Re.length>0){const Ne=Re[0];_e=Ne.clientX,be=Ne.clientY}else void 0!==se.pageX&&(_e=se.pageX,be=se.pageY)}Ee.currentX=_e,Ee.currentY=be},X=se=>se.timeStamp||Date.now()},1767:(zn,Dt,R)=>{"use strict";R.d(Dt,{m:()=>De});var x=R(5861),d=R(5421),v=R(544),s=R(7876),Q=R(6506);const ie=X=>(0,Q.c)().duration(X?400:300),q=X=>{let se,Ee;const _e=X.width+8,be=(0,Q.c)(),Re=(0,Q.c)();X.isEndSide?(se=_e+"px",Ee="0px"):(se=-_e+"px",Ee="0px"),be.addElement(X.menuInnerEl).fromTo("transform",`translateX(${se})`,`translateX(${Ee})`);const qe="ios"===(0,s.b)(X),_t=qe?.2:.25;return Re.addElement(X.backdropEl).fromTo("opacity",.01,_t),ie(qe).addAnimation([be,Re])},y=X=>{let se,Ee;const _e=(0,s.b)(X),be=X.width;X.isEndSide?(se=-be+"px",Ee=be+"px"):(se=be+"px",Ee=-be+"px");const Re=(0,Q.c)().addElement(X.menuInnerEl).fromTo("transform",`translateX(${Ee})`,"translateX(0px)"),Ne=(0,Q.c)().addElement(X.contentEl).fromTo("transform","translateX(0px)",`translateX(${se})`),qe=(0,Q.c)().addElement(X.backdropEl).fromTo("opacity",.01,.32);return ie("ios"===_e).addAnimation([Re,Ne,qe])},fe=X=>{const se=(0,s.b)(X),Ee=X.width*(X.isEndSide?-1:1)+"px",_e=(0,Q.c)().addElement(X.contentEl).fromTo("transform","translateX(0px)",`translateX(${Ee})`);return ie("ios"===se).addAnimation(_e)},De=(()=>{const X=new Map,se=[],Ee=function(){var ze=(0,x.Z)(function*(xt){const Ve=yield Je(xt);return!!Ve&&Ve.open()});return function(Ve){return ze.apply(this,arguments)}}(),_e=function(){var ze=(0,x.Z)(function*(xt){const Ve=yield void 0!==xt?Je(xt):Me();return void 0!==Ve&&Ve.close()});return function(Ve){return ze.apply(this,arguments)}}(),be=function(){var ze=(0,x.Z)(function*(xt){const Ve=yield Je(xt);return!!Ve&&Ve.toggle()});return function(Ve){return ze.apply(this,arguments)}}(),Re=function(){var ze=(0,x.Z)(function*(xt,Ve){const gt=yield Je(Ve);return gt&&(gt.disabled=!xt),gt});return function(Ve,gt){return ze.apply(this,arguments)}}(),Ne=function(){var ze=(0,x.Z)(function*(xt,Ve){const gt=yield Je(Ve);return gt&&(gt.swipeGesture=xt),gt});return function(Ve,gt){return ze.apply(this,arguments)}}(),qe=function(){var ze=(0,x.Z)(function*(xt){if(null!=xt){const Ve=yield Je(xt);return void 0!==Ve&&Ve.isOpen()}return void 0!==(yield Me())});return function(Ve){return ze.apply(this,arguments)}}(),_t=function(){var ze=(0,x.Z)(function*(xt){const Ve=yield Je(xt);return!!Ve&&!Ve.disabled});return function(Ve){return ze.apply(this,arguments)}}(),Je=function(){var ze=(0,x.Z)(function*(xt){return yield lt(),"start"===xt||"end"===xt?mt(Be=>Be.side===xt&&!Be.disabled)||mt(Be=>Be.side===xt):null!=xt?mt(gt=>gt.menuId===xt):mt(gt=>!gt.disabled)||(se.length>0?se[0].el:void 0)});return function(Ve){return ze.apply(this,arguments)}}(),Me=function(){var ze=(0,x.Z)(function*(){return yield lt(),ve()});return function(){return ze.apply(this,arguments)}}(),it=function(){var ze=(0,x.Z)(function*(){return yield lt(),en()});return function(){return ze.apply(this,arguments)}}(),Xe=function(){var ze=(0,x.Z)(function*(){return yield lt(),dt()});return function(){return ze.apply(this,arguments)}}(),Te=(ze,xt)=>{X.set(ze,xt)},we=ze=>{const xt=ze.side;se.filter(Ve=>Ve.side===xt&&Ve!==ze).forEach(Ve=>Ve.disabled=!0)},Ze=function(){var ze=(0,x.Z)(function*(xt,Ve,gt){if(dt())return!1;if(Ve){const Be=yield Me();Be&&xt.el!==Be&&(yield Be.setOpen(!1,!1))}return xt._setOpen(Ve,gt)});return function(Ve,gt,Be){return ze.apply(this,arguments)}}(),ve=()=>mt(ze=>ze._isOpen),en=()=>se.map(ze=>ze.el),dt=()=>se.some(ze=>ze.isAnimating),mt=ze=>{const xt=se.find(ze);if(void 0!==xt)return xt.el},lt=()=>Promise.all(Array.from(document.querySelectorAll("ion-menu")).map(ze=>new Promise(xt=>(0,v.c)(ze,xt))));return Te("reveal",fe),Te("push",y),Te("overlay",q),typeof document<"u"&&document.addEventListener("ionBackButton",ze=>{const xt=ve();xt&&ze.detail.register(d.MENU_BACK_BUTTON_PRIORITY,()=>xt.close())}),{registerAnimation:Te,get:Je,getMenus:it,getOpen:Me,isEnabled:_t,swipeGesture:Ne,isAnimating:Xe,isOpen:qe,enable:Re,toggle:be,close:_e,open:Ee,_getOpenSync:ve,_createAnimation:(ze,xt)=>{const Ve=X.get(ze);if(!Ve)throw new Error("animation not registered");return Ve(xt)},_register:ze=>{se.indexOf(ze)<0&&(ze.disabled||we(ze),se.push(ze))},_unregister:ze=>{const xt=se.indexOf(ze);xt>-1&&se.splice(xt,1)},_setOpen:Ze,_setActiveMenu:we}})()},8354:(zn,Dt,R)=>{"use strict";R.d(Dt,{L:()=>s,a:()=>Q,b:()=>ie,c:()=>q,d:()=>y,e:()=>Te,g:()=>we,l:()=>it,s:()=>ae,t:()=>De,w:()=>Xe});var x=R(5861),d=R(6953),v=R(544);const s="ionViewWillEnter",Q="ionViewDidEnter",ie="ionViewWillLeave",q="ionViewDidLeave",y="ionViewWillUnload",De=Ze=>new Promise((Ae,ve)=>{(0,d.w)(()=>{X(Ze),se(Ze).then(en=>{en.animation&&en.animation.destroy(),Ee(Ze),Ae(en)},en=>{Ee(Ze),ve(en)})})}),X=Ze=>{const Ae=Ze.enteringEl,ve=Ze.leavingEl;yt(Ae,ve,Ze.direction),Ze.showGoBack?Ae.classList.add("can-go-back"):Ae.classList.remove("can-go-back"),ae(Ae,!1),Ae.style.setProperty("pointer-events","none"),ve&&(ae(ve,!1),ve.style.setProperty("pointer-events","none"))},se=function(){var Ze=(0,x.Z)(function*(Ae){const ve=yield _e(Ae);return ve&&d.B.isBrowser?be(ve,Ae):Re(Ae)});return function(ve){return Ze.apply(this,arguments)}}(),Ee=Ze=>{const Ae=Ze.enteringEl,ve=Ze.leavingEl;Ae.classList.remove("ion-page-invisible"),Ae.style.removeProperty("pointer-events"),void 0!==ve&&(ve.classList.remove("ion-page-invisible"),ve.style.removeProperty("pointer-events"))},_e=function(){var Ze=(0,x.Z)(function*(Ae){return Ae.leavingEl&&Ae.animated&&0!==Ae.duration?Ae.animationBuilder?Ae.animationBuilder:"ios"===Ae.mode?(yield Promise.resolve().then(R.bind(R,8899))).iosTransitionAnimation:(yield Promise.resolve().then(R.bind(R,5298))).mdTransitionAnimation:void 0});return function(ve){return Ze.apply(this,arguments)}}(),be=function(){var Ze=(0,x.Z)(function*(Ae,ve){yield Ne(ve,!0);const en=Ae(ve.baseEl,ve);Je(ve.enteringEl,ve.leavingEl);const dt=yield _t(en,ve);return ve.progressCallback&&ve.progressCallback(void 0),dt&&Me(ve.enteringEl,ve.leavingEl),{hasCompleted:dt,animation:en}});return function(ve,en){return Ze.apply(this,arguments)}}(),Re=function(){var Ze=(0,x.Z)(function*(Ae){const ve=Ae.enteringEl,en=Ae.leavingEl;return yield Ne(Ae,!1),Je(ve,en),Me(ve,en),{hasCompleted:!0}});return function(ve){return Ze.apply(this,arguments)}}(),Ne=function(){var Ze=(0,x.Z)(function*(Ae,ve){(void 0!==Ae.deepWait?Ae.deepWait:ve)&&(yield Promise.all([Te(Ae.enteringEl),Te(Ae.leavingEl)])),yield qe(Ae.viewIsReady,Ae.enteringEl)});return function(ve,en){return Ze.apply(this,arguments)}}(),qe=function(){var Ze=(0,x.Z)(function*(Ae,ve){Ae&&(yield Ae(ve))});return function(ve,en){return Ze.apply(this,arguments)}}(),_t=(Ze,Ae)=>{const ve=Ae.progressCallback,en=new Promise(dt=>{Ze.onFinish(mt=>dt(1===mt))});return ve?(Ze.progressStart(!0),ve(Ze)):Ze.play(),en},Je=(Ze,Ae)=>{it(Ae,ie),it(Ze,s)},Me=(Ze,Ae)=>{it(Ze,Q),it(Ae,q)},it=(Ze,Ae)=>{if(Ze){const ve=new CustomEvent(Ae,{bubbles:!1,cancelable:!1});Ze.dispatchEvent(ve)}},Xe=()=>new Promise(Ze=>(0,v.r)(()=>(0,v.r)(()=>Ze()))),Te=function(){var Ze=(0,x.Z)(function*(Ae){const ve=Ae;if(ve){if(null!=ve.componentOnReady){if(null!=(yield ve.componentOnReady()))return}else if(null!=ve.__registerHost)return void(yield new Promise(dt=>(0,v.r)(dt)));yield Promise.all(Array.from(ve.children).map(Te))}});return function(ve){return Ze.apply(this,arguments)}}(),ae=(Ze,Ae)=>{Ae?(Ze.setAttribute("aria-hidden","true"),Ze.classList.add("ion-page-hidden")):(Ze.hidden=!1,Ze.removeAttribute("aria-hidden"),Ze.classList.remove("ion-page-hidden"))},yt=(Ze,Ae,ve)=>{void 0!==Ze&&(Ze.style.zIndex="back"===ve?"99":"101"),void 0!==Ae&&(Ae.style.zIndex="100")},we=Ze=>Ze.classList.contains("ion-page")?Ze:Ze.querySelector(":scope > .ion-page, :scope > ion-nav, :scope > ion-tabs")||Ze},7643:(zn,Dt,R)=>{"use strict";R.d(Dt,{d:()=>d,w:()=>x});const x=typeof window<"u"?window:void 0,d=typeof document<"u"?document:void 0},7690:(zn,Dt,R)=>{"use strict";R.d(Dt,{a:()=>d,b:()=>v,p:()=>x});const x=(s,...Q)=>console.warn(`[Ionic Warning]: ${s}`,...Q),d=(s,...Q)=>console.error(`[Ionic Error]: ${s}`,...Q),v=(s,...Q)=>console.error(`<${s.tagName.toLowerCase()}> must be used inside ${Q.join(" or ")}.`)},7876:(zn,Dt,R)=>{"use strict";R.d(Dt,{a:()=>De,b:()=>dt,c:()=>v,g:()=>Se,i:()=>mt});var x=R(6953);class d{constructor(){this.m=new Map}reset(ze){this.m=new Map(Object.entries(ze))}get(ze,xt){const Ve=this.m.get(ze);return void 0!==Ve?Ve:xt}getBoolean(ze,xt=!1){const Ve=this.m.get(ze);return void 0===Ve?xt:"string"==typeof Ve?"true"===Ve:!!Ve}getNumber(ze,xt){const Ve=parseFloat(this.m.get(ze));return isNaN(Ve)?void 0!==xt?xt:NaN:Ve}set(ze,xt){this.m.set(ze,xt)}}const v=new d,y="ionic:",fe="ionic-persist-config",Se=lt=>X(lt),De=(lt,ze)=>("string"==typeof lt&&(ze=lt,lt=void 0),Se(lt).includes(ze)),X=(lt=window)=>{if(typeof lt>"u")return[];lt.Ionic=lt.Ionic||{};let ze=lt.Ionic.platforms;return null==ze&&(ze=lt.Ionic.platforms=se(lt),ze.forEach(xt=>lt.document.documentElement.classList.add(`plt-${xt}`))),ze},se=lt=>{const ze=v.get("platform");return Object.keys(ve).filter(xt=>{const Ve=ze?.[xt];return"function"==typeof Ve?Ve(lt):ve[xt](lt)})},_e=lt=>!!(Ze(lt,/iPad/i)||Ze(lt,/Macintosh/i)&&Me(lt)),Ne=lt=>Ze(lt,/android|sink/i),Me=lt=>Ae(lt,"(any-pointer:coarse)"),Xe=lt=>Te(lt)||ae(lt),Te=lt=>!!(lt.cordova||lt.phonegap||lt.PhoneGap),ae=lt=>{const ze=lt.Capacitor;return!!ze?.isNative},Ze=(lt,ze)=>ze.test(lt.navigator.userAgent),Ae=(lt,ze)=>{var xt;return null===(xt=lt.matchMedia)||void 0===xt?void 0:xt.call(lt,ze).matches},ve={ipad:_e,iphone:lt=>Ze(lt,/iPhone/i),ios:lt=>Ze(lt,/iPhone|iPod/i)||_e(lt),android:Ne,phablet:lt=>{const ze=lt.innerWidth,xt=lt.innerHeight,Ve=Math.min(ze,xt),gt=Math.max(ze,xt);return Ve>390&&Ve<520&&gt>620&&gt<800},tablet:lt=>{const ze=lt.innerWidth,xt=lt.innerHeight,Ve=Math.min(ze,xt),gt=Math.max(ze,xt);return _e(lt)||(lt=>Ne(lt)&&!Ze(lt,/mobile/i))(lt)||Ve>460&&Ve<820&&gt>780&&gt<1400},cordova:Te,capacitor:ae,electron:lt=>Ze(lt,/electron/i),pwa:lt=>{var ze;return!!(null!==(ze=lt.matchMedia)&&void 0!==ze&&ze.call(lt,"(display-mode: standalone)").matches||lt.navigator.standalone)},mobile:Me,mobileweb:lt=>Me(lt)&&!Xe(lt),desktop:lt=>!Me(lt),hybrid:Xe};let en;const dt=lt=>lt&&(0,x.g)(lt)||en,mt=(lt={})=>{if(typeof window>"u")return;const ze=window.document,xt=window,Ve=xt.Ionic=xt.Ionic||{},gt={};lt._ael&&(gt.ael=lt._ael),lt._rel&&(gt.rel=lt._rel),lt._ce&&(gt.ce=lt._ce),(0,x.a)(gt);const Be=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},(lt=>{try{const ze=lt.sessionStorage.getItem(fe);return null!==ze?JSON.parse(ze):{}}catch{return{}}})(xt)),{persistConfig:!1}),Ve.config),(lt=>{const ze={};return lt.location.search.slice(1).split("&").map(xt=>xt.split("=")).map(([xt,Ve])=>[decodeURIComponent(xt),decodeURIComponent(Ve)]).filter(([xt])=>((lt,ze)=>lt.substr(0,ze.length)===ze)(xt,y)).map(([xt,Ve])=>[xt.slice(6),Ve]).forEach(([xt,Ve])=>{ze[xt]=Ve}),ze})(xt)),lt);v.reset(Be),v.getBoolean("persistConfig")&&((lt,ze)=>{try{lt.sessionStorage.setItem(fe,JSON.stringify(ze))}catch{return}})(xt,Be),X(xt),Ve.config=v,Ve.mode=en=v.get("mode",ze.documentElement.getAttribute("mode")||(De(xt,"ios")?"ios":"md")),v.set("mode",en),ze.documentElement.setAttribute("mode",en),ze.documentElement.classList.add(en),v.getBoolean("_testing")&&v.set("animated",!1);const Bt=wn=>{var Xt;return null===(Xt=wn.tagName)||void 0===Xt?void 0:Xt.startsWith("ION-")},Wt=wn=>["ios","md"].includes(wn);(0,x.c)(wn=>{for(;wn;){const Xt=wn.mode||wn.getAttribute("mode");if(Xt){if(Wt(Xt))return Xt;Bt(wn)&&console.warn('Invalid ionic mode: "'+Xt+'", expected: "ios" or "md"')}wn=wn.parentElement}return en})}},8899:(zn,Dt,R)=>{"use strict";R.r(Dt),R.d(Dt,{iosTransitionAnimation:()=>se,shadow:()=>q});var x=R(6506),d=R(8354);R(7643),R(6953);const ie=Ee=>document.querySelector(`${Ee}.ion-cloned-element`),q=Ee=>Ee.shadowRoot||Ee,y=Ee=>{const _e="ION-TABS"===Ee.tagName?Ee:Ee.querySelector("ion-tabs"),be="ion-content ion-header:not(.header-collapse-condense-inactive) ion-title.title-large";if(null!=_e){const Re=_e.querySelector("ion-tab:not(.tab-hidden), .ion-page:not(.ion-page-hidden)");return null!=Re?Re.querySelector(be):null}return Ee.querySelector(be)},fe=(Ee,_e)=>{const be="ION-TABS"===Ee.tagName?Ee:Ee.querySelector("ion-tabs");let Re=[];if(null!=be){const Ne=be.querySelector("ion-tab:not(.tab-hidden), .ion-page:not(.ion-page-hidden)");null!=Ne&&(Re=Ne.querySelectorAll("ion-buttons"))}else Re=Ee.querySelectorAll("ion-buttons");for(const Ne of Re){const qe=Ne.closest("ion-header"),_t=qe&&!qe.classList.contains("header-collapse-condense-inactive"),Je=Ne.querySelector("ion-back-button"),Me=Ne.classList.contains("buttons-collapse");if(null!==Je&&("start"===Ne.slot||""===Ne.slot)&&(Me&&_t&&_e||!Me))return Je}return null},De=(Ee,_e,be,Re,Ne,qe)=>{const _t=_e?`calc(100% - ${qe.right+4}px)`:qe.left-4+"px",Je=_e?"7px":"-7px",Me=_e?"-4px":"4px",it=_e?"-4px":"4px",Xe=_e?"right":"left",Te=_e?"left":"right",we=be?[{offset:0,opacity:1,transform:`translate3d(${Me}, ${qe.top-46}px, 0) scale(1)`},{offset:.6,opacity:0},{offset:1,opacity:0,transform:`translate3d(${Je}, ${Ne.top-40}px, 0) scale(2.1)`}]:[{offset:0,opacity:0,transform:`translate3d(${Je}, ${Ne.top-40}px, 0) scale(2.1)`},{offset:1,opacity:1,transform:`translate3d(${Me}, ${qe.top-46}px, 0) scale(1)`}],ve=be?[{offset:0,opacity:1,transform:`translate3d(${it}, ${qe.top-46}px, 0) scale(1)`},{offset:.2,opacity:0,transform:`translate3d(${it}, ${qe.top-41}px, 0) scale(0.6)`},{offset:1,opacity:0,transform:`translate3d(${it}, ${qe.top-41}px, 0) scale(0.6)`}]:[{offset:0,opacity:0,transform:`translate3d(${it}, ${qe.top-41}px, 0) scale(0.6)`},{offset:1,opacity:1,transform:`translate3d(${it}, ${qe.top-46}px, 0) scale(1)`}],en=(0,x.c)(),dt=(0,x.c)(),mt=ie("ion-back-button"),lt=q(mt).querySelector(".button-text"),ze=q(mt).querySelector("ion-icon");mt.text=Re.text,mt.mode=Re.mode,mt.icon=Re.icon,mt.color=Re.color,mt.disabled=Re.disabled,mt.style.setProperty("display","block"),mt.style.setProperty("position","fixed"),dt.addElement(ze),en.addElement(lt),en.beforeStyles({"transform-origin":`${Xe} center`}).beforeAddWrite(()=>{Re.style.setProperty("display","none"),mt.style.setProperty(Xe,_t)}).afterAddWrite(()=>{Re.style.setProperty("display",""),mt.style.setProperty("display","none"),mt.style.removeProperty(Xe)}).keyframes(we),dt.beforeStyles({"transform-origin":`${Te} center`}).keyframes(ve),Ee.addAnimation([en,dt])},X=(Ee,_e,be,Re,Ne,qe)=>{const _t=_e?`calc(100% - ${Ne.right}px)`:`${Ne.left}px`,Je=_e?"-18px":"18px",Me=_e?"right":"left",Te=be?[{offset:0,opacity:0,transform:`translate3d(${Je}, ${qe.top-4}px, 0) scale(0.49)`},{offset:.1,opacity:0},{offset:1,opacity:1,transform:`translate3d(0, ${Ne.top-2}px, 0) scale(1)`}]:[{offset:0,opacity:.99,transform:`translate3d(0, ${Ne.top-2}px, 0) scale(1)`},{offset:.6,opacity:0},{offset:1,opacity:0,transform:`translate3d(${Je}, ${qe.top-4}px, 0) scale(0.5)`}],ae=ie("ion-title"),yt=(0,x.c)();ae.innerText=Re.innerText,ae.size=Re.size,ae.color=Re.color,yt.addElement(ae),yt.beforeStyles({"transform-origin":`${Me} center`,height:"46px",display:"",position:"relative",[Me]:_t}).beforeAddWrite(()=>{Re.style.setProperty("display","none")}).afterAddWrite(()=>{Re.style.setProperty("display",""),ae.style.setProperty("display","none")}).keyframes(Te),Ee.addAnimation(yt)},se=(Ee,_e)=>{var be;try{const Re="cubic-bezier(0.32,0.72,0,1)",Ne="opacity",qe="transform",_t="0%",Me="rtl"===Ee.ownerDocument.dir,it=Me?"-99.5%":"99.5%",Xe=Me?"33%":"-33%",Te=_e.enteringEl,ae=_e.leavingEl,yt="back"===_e.direction,we=Te.querySelector(":scope > ion-content"),Ze=Te.querySelectorAll(":scope > ion-header > *:not(ion-toolbar), :scope > ion-footer > *"),Ae=Te.querySelectorAll(":scope > ion-header > ion-toolbar"),ve=(0,x.c)(),en=(0,x.c)();if(ve.addElement(Te).duration((null!==(be=_e.duration)&&void 0!==be?be:0)||540).easing(_e.easing||Re).fill("both").beforeRemoveClass("ion-page-invisible"),ae&&null!=Ee){const ze=(0,x.c)();ze.addElement(Ee),ve.addAnimation(ze)}if(we||0!==Ae.length||0!==Ze.length?(en.addElement(we),en.addElement(Ze)):en.addElement(Te.querySelector(":scope > .ion-page, :scope > ion-nav, :scope > ion-tabs")),ve.addAnimation(en),yt?en.beforeClearStyles([Ne]).fromTo("transform",`translateX(${Xe})`,`translateX(${_t})`).fromTo(Ne,.8,1):en.beforeClearStyles([Ne]).fromTo("transform",`translateX(${it})`,`translateX(${_t})`),we){const ze=q(we).querySelector(".transition-effect");if(ze){const xt=ze.querySelector(".transition-cover"),Ve=ze.querySelector(".transition-shadow"),gt=(0,x.c)(),Be=(0,x.c)(),Bt=(0,x.c)();gt.addElement(ze).beforeStyles({opacity:"1",display:"block"}).afterStyles({opacity:"",display:""}),Be.addElement(xt).beforeClearStyles([Ne]).fromTo(Ne,0,.1),Bt.addElement(Ve).beforeClearStyles([Ne]).fromTo(Ne,.03,.7),gt.addAnimation([Be,Bt]),en.addAnimation([gt])}}const dt=Te.querySelector("ion-header.header-collapse-condense"),{forward:mt,backward:lt}=((Ee,_e,be,Re,Ne)=>{const qe=fe(Re,be),_t=y(Ne),Je=y(Re),Me=fe(Ne,be),it=null!==qe&&null!==_t&&!be,Xe=null!==Je&&null!==Me&&be;if(it){const Te=_t.getBoundingClientRect(),ae=qe.getBoundingClientRect();X(Ee,_e,be,_t,Te,ae),De(Ee,_e,be,qe,Te,ae)}else if(Xe){const Te=Je.getBoundingClientRect(),ae=Me.getBoundingClientRect();X(Ee,_e,be,Je,Te,ae),De(Ee,_e,be,Me,Te,ae)}return{forward:it,backward:Xe}})(ve,Me,yt,Te,ae);if(Ae.forEach(ze=>{const xt=(0,x.c)();xt.addElement(ze),ve.addAnimation(xt);const Ve=(0,x.c)();Ve.addElement(ze.querySelector("ion-title"));const gt=(0,x.c)(),Be=Array.from(ze.querySelectorAll("ion-buttons,[menuToggle]")),Bt=ze.closest("ion-header"),Wt=Bt?.classList.contains("header-collapse-condense-inactive");let wn;wn=Be.filter(yt?St=>{const st=St.classList.contains("buttons-collapse");return st&&!Wt||!st}:St=>!St.classList.contains("buttons-collapse")),gt.addElement(wn);const Xt=(0,x.c)();Xt.addElement(ze.querySelectorAll(":scope > *:not(ion-title):not(ion-buttons):not([menuToggle])"));const mn=(0,x.c)();mn.addElement(q(ze).querySelector(".toolbar-background"));const an=(0,x.c)(),Vt=ze.querySelector("ion-back-button");if(Vt&&an.addElement(Vt),xt.addAnimation([Ve,gt,Xt,mn,an]),gt.fromTo(Ne,.01,1),Xt.fromTo(Ne,.01,1),yt)Wt||Ve.fromTo("transform",`translateX(${Xe})`,`translateX(${_t})`).fromTo(Ne,.01,1),Xt.fromTo("transform",`translateX(${Xe})`,`translateX(${_t})`),an.fromTo(Ne,.01,1);else if(dt||Ve.fromTo("transform",`translateX(${it})`,`translateX(${_t})`).fromTo(Ne,.01,1),Xt.fromTo("transform",`translateX(${it})`,`translateX(${_t})`),mn.beforeClearStyles([Ne,"transform"]),Bt?.translucent?mn.fromTo("transform",Me?"translateX(-100%)":"translateX(100%)","translateX(0px)"):mn.fromTo(Ne,.01,"var(--opacity)"),mt||an.fromTo(Ne,.01,1),Vt&&!mt){const st=(0,x.c)();st.addElement(q(Vt).querySelector(".button-text")).fromTo("transform",Me?"translateX(-100px)":"translateX(100px)","translateX(0px)"),xt.addAnimation(st)}}),ae){const ze=(0,x.c)(),xt=ae.querySelector(":scope > ion-content"),Ve=ae.querySelectorAll(":scope > ion-header > ion-toolbar"),gt=ae.querySelectorAll(":scope > ion-header > *:not(ion-toolbar), :scope > ion-footer > *");if(xt||0!==Ve.length||0!==gt.length?(ze.addElement(xt),ze.addElement(gt)):ze.addElement(ae.querySelector(":scope > .ion-page, :scope > ion-nav, :scope > ion-tabs")),ve.addAnimation(ze),yt){ze.beforeClearStyles([Ne]).fromTo("transform",`translateX(${_t})`,Me?"translateX(-100%)":"translateX(100%)");const Be=(0,d.g)(ae);ve.afterAddWrite(()=>{"normal"===ve.getDirection()&&Be.style.setProperty("display","none")})}else ze.fromTo("transform",`translateX(${_t})`,`translateX(${Xe})`).fromTo(Ne,1,.8);if(xt){const Be=q(xt).querySelector(".transition-effect");if(Be){const Bt=Be.querySelector(".transition-cover"),Wt=Be.querySelector(".transition-shadow"),wn=(0,x.c)(),Xt=(0,x.c)(),mn=(0,x.c)();wn.addElement(Be).beforeStyles({opacity:"1",display:"block"}).afterStyles({opacity:"",display:""}),Xt.addElement(Bt).beforeClearStyles([Ne]).fromTo(Ne,.1,0),mn.addElement(Wt).beforeClearStyles([Ne]).fromTo(Ne,.7,.03),wn.addAnimation([Xt,mn]),ze.addAnimation([wn])}}Ve.forEach(Be=>{const Bt=(0,x.c)();Bt.addElement(Be);const Wt=(0,x.c)();Wt.addElement(Be.querySelector("ion-title"));const wn=(0,x.c)(),Xt=Be.querySelectorAll("ion-buttons,[menuToggle]"),mn=Be.closest("ion-header"),an=mn?.classList.contains("header-collapse-condense-inactive"),Vt=Array.from(Xt).filter(zt=>{const gi=zt.classList.contains("buttons-collapse");return gi&&!an||!gi});wn.addElement(Vt);const St=(0,x.c)(),st=Be.querySelectorAll(":scope > *:not(ion-title):not(ion-buttons):not([menuToggle])");st.length>0&&St.addElement(st);const qt=(0,x.c)();qt.addElement(q(Be).querySelector(".toolbar-background"));const dn=(0,x.c)(),Sn=Be.querySelector("ion-back-button");if(Sn&&dn.addElement(Sn),Bt.addAnimation([Wt,wn,St,dn,qt]),ve.addAnimation(Bt),dn.fromTo(Ne,.99,0),wn.fromTo(Ne,.99,0),St.fromTo(Ne,.99,0),yt){if(an||Wt.fromTo("transform",`translateX(${_t})`,Me?"translateX(-100%)":"translateX(100%)").fromTo(Ne,.99,0),St.fromTo("transform",`translateX(${_t})`,Me?"translateX(-100%)":"translateX(100%)"),qt.beforeClearStyles([Ne,"transform"]),mn?.translucent?qt.fromTo("transform","translateX(0px)",Me?"translateX(-100%)":"translateX(100%)"):qt.fromTo(Ne,"var(--opacity)",0),Sn&&!lt){const gi=(0,x.c)();gi.addElement(q(Sn).querySelector(".button-text")).fromTo("transform",`translateX(${_t})`,`translateX(${(Me?-124:124)+"px"})`),Bt.addAnimation(gi)}}else an||Wt.fromTo("transform",`translateX(${_t})`,`translateX(${Xe})`).fromTo(Ne,.99,0).afterClearStyles([qe,Ne]),St.fromTo("transform",`translateX(${_t})`,`translateX(${Xe})`).afterClearStyles([qe,Ne]),dn.afterClearStyles([Ne]),Wt.afterClearStyles([Ne]),wn.afterClearStyles([Ne])})}return ve}catch(Re){throw Re}}},5298:(zn,Dt,R)=>{"use strict";R.r(Dt),R.d(Dt,{mdTransitionAnimation:()=>Q});var x=R(6506),d=R(8354);R(7643),R(6953);const Q=(ie,q)=>{var y,fe,Se;const se="back"===q.direction,_e=q.leavingEl,be=(0,d.g)(q.enteringEl),Re=be.querySelector("ion-toolbar"),Ne=(0,x.c)();if(Ne.addElement(be).fill("both").beforeRemoveClass("ion-page-invisible"),se?Ne.duration((null!==(y=q.duration)&&void 0!==y?y:0)||200).easing("cubic-bezier(0.47,0,0.745,0.715)"):Ne.duration((null!==(fe=q.duration)&&void 0!==fe?fe:0)||280).easing("cubic-bezier(0.36,0.66,0.04,1)").fromTo("transform","translateY(40px)","translateY(0px)").fromTo("opacity",.01,1),Re){const qe=(0,x.c)();qe.addElement(Re),Ne.addAnimation(qe)}if(_e&&se){Ne.duration((null!==(Se=q.duration)&&void 0!==Se?Se:0)||200).easing("cubic-bezier(0.47,0,0.745,0.715)");const qe=(0,x.c)();qe.addElement((0,d.g)(_e)).onFinish(_t=>{1===_t&&qe.elements.length>0&&qe.elements[0].style.setProperty("display","none")}).fromTo("transform","translateY(0px)","translateY(40px)").fromTo("opacity",1,0),Ne.addAnimation(qe)}return Ne}},645:(zn,Dt,R)=>{"use strict";R.d(Dt,{B:()=>Bt,G:()=>Wt,a:()=>De,b:()=>X,c:()=>be,d:()=>wn,e:()=>Xt,f:()=>ve,g:()=>dt,h:()=>ze,i:()=>Ve,j:()=>Ne,k:()=>qe,l:()=>se,m:()=>Ee,n:()=>fe,o:()=>Me,q:()=>Ze,s:()=>Be,t:()=>Re});var x=R(5861),d=R(7876),v=R(9439),s=R(5421),Q=R(544),ie=R(7690);let q=0,y=0;const fe=new WeakMap,Se=mn=>({create:an=>_t(mn,an),dismiss:(an,Vt,St)=>yt(document,an,Vt,mn,St),getTop:()=>(0,x.Z)(function*(){return Ze(document,mn)})()}),De=Se("ion-alert"),X=Se("ion-action-sheet"),se=Se("ion-loading"),Ee=Se("ion-modal"),be=Se("ion-popover"),Re=Se("ion-toast"),Ne=mn=>{typeof document<"u"&&ae(document);const an=q++;mn.overlayIndex=an},qe=mn=>(mn.hasAttribute("id")||(mn.id="ion-overlay-"+ ++y),mn.id),_t=(mn,an)=>typeof window<"u"&&typeof window.customElements<"u"?window.customElements.whenDefined(mn).then(()=>{const Vt=document.createElement(mn);return Vt.classList.add("overlay-hidden"),Object.assign(Vt,Object.assign(Object.assign({},an),{hasController:!0})),mt(document).appendChild(Vt),new Promise(St=>(0,Q.c)(Vt,St))}):Promise.resolve(),Je='[tabindex]:not([tabindex^="-"]):not([hidden]):not([disabled]), input:not([type=hidden]):not([tabindex^="-"]):not([hidden]):not([disabled]), textarea:not([tabindex^="-"]):not([hidden]):not([disabled]), button:not([tabindex^="-"]):not([hidden]):not([disabled]), select:not([tabindex^="-"]):not([hidden]):not([disabled]), .ion-focusable:not([tabindex^="-"]):not([hidden]):not([disabled]), .ion-focusable[disabled="false"]:not([tabindex^="-"]):not([hidden])',Me=(mn,an)=>{let Vt=mn.querySelector(Je);const St=Vt?.shadowRoot;St&&(Vt=St.querySelector(Je)||Vt),Vt?(0,Q.f)(Vt):an.focus()},Xe=(mn,an)=>{const Vt=Array.from(mn.querySelectorAll(Je));let St=Vt.length>0?Vt[Vt.length-1]:null;const st=St?.shadowRoot;st&&(St=st.querySelector(Je)||St),St?St.focus():an.focus()},ae=mn=>{0===q&&(q=1,mn.addEventListener("focus",an=>{((mn,an)=>{const Vt=Ze(an,"ion-alert,ion-action-sheet,ion-loading,ion-modal,ion-picker,ion-popover"),St=mn.target;Vt&&St&&!Vt.classList.contains("ion-disable-focus-trap")&&(Vt.shadowRoot?(()=>{if(Vt.contains(St))Vt.lastFocus=St;else{const dn=Vt.lastFocus;Me(Vt,Vt),dn===an.activeElement&&Xe(Vt,Vt),Vt.lastFocus=an.activeElement}})():(()=>{if(Vt===St)Vt.lastFocus=void 0;else{const dn=(0,Q.g)(Vt);if(!dn.contains(St))return;const Sn=dn.querySelector(".ion-overlay-wrapper");if(!Sn)return;if(Sn.contains(St))Vt.lastFocus=St;else{const zt=Vt.lastFocus;Me(Sn,Vt),zt===an.activeElement&&Xe(Sn,Vt),Vt.lastFocus=an.activeElement}}})())})(an,mn)},!0),mn.addEventListener("ionBackButton",an=>{const Vt=Ze(mn);Vt?.backdropDismiss&&an.detail.register(s.OVERLAY_BACK_BUTTON_PRIORITY,()=>Vt.dismiss(void 0,Bt))}),mn.addEventListener("keydown",an=>{if("Escape"===an.key){const Vt=Ze(mn);Vt?.backdropDismiss&&Vt.dismiss(void 0,Bt)}}))},yt=(mn,an,Vt,St,st)=>{const qt=Ze(mn,St,st);return qt?qt.dismiss(an,Vt):Promise.reject("overlay does not exist")},Ze=(mn,an,Vt)=>{const St=((mn,an)=>(void 0===an&&(an="ion-alert,ion-action-sheet,ion-loading,ion-modal,ion-picker,ion-popover,ion-toast"),Array.from(mn.querySelectorAll(an)).filter(Vt=>Vt.overlayIndex>0)))(mn,an).filter(st=>!(mn=>mn.classList.contains("overlay-hidden"))(st));return void 0===Vt?St[St.length-1]:St.find(st=>st.id===Vt)},Ae=(mn=!1)=>{const Vt=mt(document).querySelector("ion-router-outlet, ion-nav, #ion-view-container-root");Vt&&(mn?Vt.setAttribute("aria-hidden","true"):Vt.removeAttribute("aria-hidden"))},ve=function(){var mn=(0,x.Z)(function*(an,Vt,St,st,qt){var dn,Sn;if(an.presented)return;Ae(!0),an.presented=!0,an.willPresent.emit(),null===(dn=an.willPresentShorthand)||void 0===dn||dn.emit();const zt=(0,d.b)(an),gi=an.enterAnimation?an.enterAnimation:d.c.get(Vt,"ios"===zt?St:st);(yield lt(an,gi,an.el,qt))&&(an.didPresent.emit(),null===(Sn=an.didPresentShorthand)||void 0===Sn||Sn.emit()),"ION-TOAST"!==an.el.tagName&&en(an.el),an.keyboardClose&&(null===document.activeElement||!an.el.contains(document.activeElement))&&an.el.focus()});return function(Vt,St,st,qt,dn){return mn.apply(this,arguments)}}(),en=function(){var mn=(0,x.Z)(function*(an){let Vt=document.activeElement;if(!Vt)return;const St=Vt?.shadowRoot;St&&(Vt=St.querySelector(Je)||Vt),yield an.onDidDismiss(),Vt.focus()});return function(Vt){return mn.apply(this,arguments)}}(),dt=function(){var mn=(0,x.Z)(function*(an,Vt,St,st,qt,dn,Sn){var zt,gi;if(!an.presented)return!1;Ae(!1),an.presented=!1;try{an.el.style.setProperty("pointer-events","none"),an.willDismiss.emit({data:Vt,role:St}),null===(zt=an.willDismissShorthand)||void 0===zt||zt.emit({data:Vt,role:St});const $i=(0,d.b)(an),Ci=an.leaveAnimation?an.leaveAnimation:d.c.get(st,"ios"===$i?qt:dn);St!==Wt&&(yield lt(an,Ci,an.el,Sn)),an.didDismiss.emit({data:Vt,role:St}),null===(gi=an.didDismissShorthand)||void 0===gi||gi.emit({data:Vt,role:St}),fe.delete(an),an.el.classList.add("overlay-hidden"),an.el.style.removeProperty("pointer-events"),void 0!==an.el.lastFocus&&(an.el.lastFocus=void 0)}catch($i){console.error($i)}return an.el.remove(),!0});return function(Vt,St,st,qt,dn,Sn,zt){return mn.apply(this,arguments)}}(),mt=mn=>mn.querySelector("ion-app")||mn.body,lt=function(){var mn=(0,x.Z)(function*(an,Vt,St,st){St.classList.remove("overlay-hidden");const dn=Vt(an.el,st);(!an.animated||!d.c.getBoolean("animated",!0))&&dn.duration(0),an.keyboardClose&&dn.beforeAddWrite(()=>{const zt=St.ownerDocument.activeElement;zt?.matches("input,ion-input, ion-textarea")&&zt.blur()});const Sn=fe.get(an)||[];return fe.set(an,[...Sn,dn]),yield dn.play(),!0});return function(Vt,St,st,qt){return mn.apply(this,arguments)}}(),ze=(mn,an)=>{let Vt;const St=new Promise(st=>Vt=st);return xt(mn,an,st=>{Vt(st.detail)}),St},xt=(mn,an,Vt)=>{const St=st=>{(0,Q.b)(mn,an,St),Vt(st)};(0,Q.a)(mn,an,St)},Ve=mn=>"cancel"===mn||mn===Bt,gt=mn=>mn(),Be=(mn,an)=>{if("function"==typeof mn)return d.c.get("_zoneGate",gt)(()=>{try{return mn(an)}catch(St){throw St}})},Bt="backdrop",Wt="gesture",wn=mn=>{let Vt,an=!1;const St=(0,v.C)(),st=(Sn=!1)=>{if(Vt&&!Sn)return{delegate:Vt,inline:an};const{el:zt,hasController:gi,delegate:$i}=mn;return an=null!==zt.parentNode&&!gi,Vt=an?$i||St:$i,{inline:an,delegate:Vt}};return{attachViewToDom:function(){var Sn=(0,x.Z)(function*(zt){const{delegate:gi}=st(!0);if(gi)return yield gi.attachViewToDom(mn.el,zt);const{hasController:$i}=mn;if($i&&void 0!==zt)throw new Error("framework delegate is missing");return null});return function(gi){return Sn.apply(this,arguments)}}(),removeViewFromDom:()=>{const{delegate:Sn}=st();Sn&&void 0!==mn.el&&Sn.removeViewFromDom(mn.el.parentElement,mn.el)}}},Xt=()=>{let mn;const an=()=>{mn&&(mn(),mn=void 0)};return{addClickListener:(St,st)=>{an();const qt=void 0!==st?document.getElementById(st):null;qt?mn=((Sn,zt)=>{const gi=()=>{zt.present()};return Sn.addEventListener("click",gi),()=>{Sn.removeEventListener("click",gi)}})(qt,St):(0,ie.p)(`A trigger element with the ID "${st}" was not found in the DOM. The trigger element must be in the DOM when the "trigger" property is set on an overlay component.`,St)},removeClickListener:an}}},1163:(zn,Dt,R)=>{"use strict";R.d(Dt,{B:()=>se});var x=R(1180),d=R(2029),v=R(866),s=R(6814),Q=R(7852);function ie(Ee,_e){if(1&Ee&&(d.TgZ(0,"ion-badge",7),d._uU(1),d.qZA()),2&Ee){const be=d.oxw().$implicit;d.xp6(1),d.hij("",be.Quantity," x")}}function q(Ee,_e){if(1&Ee&&(d.TgZ(0,"strong"),d._uU(1),d.qZA()),2&Ee){const be=d.oxw().$implicit;d.xp6(1),d.hij("",be.PowerKW," kW ")}}function y(Ee,_e){if(1&Ee&&(d.TgZ(0,"div"),d._uU(1),d.qZA()),2&Ee){const be=d.oxw().$implicit;d.xp6(1),d.hij("",null==be.CurrentType?null:be.CurrentType.Title," ")}}function fe(Ee,_e){if(1&Ee&&(d.TgZ(0,"span"),d._uU(1),d.qZA()),2&Ee){const be=d.oxw().$implicit;d.xp6(1),d.hij("",be.Amps,"A ")}}function Se(Ee,_e){if(1&Ee&&(d.TgZ(0,"span"),d._uU(1),d.qZA()),2&Ee){const be=d.oxw().$implicit;d.xp6(1),d.hij("",be.Voltage,"V ")}}function De(Ee,_e){if(1&Ee){const be=d.EpF();d.TgZ(0,"ion-col")(1,"ion-button",8),d.NdJ("click",function(){d.CHM(be);const Ne=d.oxw().$implicit,qe=d.oxw();return d.KtG(qe.editConnection(Ne))}),d._UZ(2,"ion-icon",9),d.qZA(),d._UZ(3,"br"),d.TgZ(4,"ion-button",10),d.NdJ("click",function(){d.CHM(be);const Ne=d.oxw().$implicit,qe=d.oxw();return d.KtG(qe.deleteConnection(Ne))}),d._UZ(5,"ion-icon",11),d.qZA()()}}function X(Ee,_e){if(1&Ee&&(d.TgZ(0,"ion-row")(1,"ion-col")(2,"ion-row")(3,"ion-col",1),d._UZ(4,"img",2),d.YNc(5,ie,2,1,"ion-badge",3),d.TgZ(6,"div",4),d._uU(7),d.qZA()(),d.TgZ(8,"ion-col")(9,"ion-row")(10,"ion-col")(11,"ion-note")(12,"div")(13,"strong",5),d._uU(14),d.qZA()(),d.YNc(15,q,2,1,"strong",6),d.YNc(16,y,2,1,"div",6),d.qZA(),d.TgZ(17,"ion-note"),d.YNc(18,fe,2,1,"span",6),d.YNc(19,Se,2,1,"span",6),d.qZA()()(),d.TgZ(20,"ion-row")(21,"ion-col",4),d._uU(22),d.qZA(),d.TgZ(23,"ion-col",4),d._uU(24),d.qZA()()(),d.YNc(25,De,6,0,"ion-col",6),d.qZA()()()),2&Ee){const be=_e.$implicit,Re=d.oxw();d.xp6(4),d.Q6J("src",Re.getConnectorTypeIcon(be.ConnectionTypeID),d.LSH),d.xp6(1),d.Q6J("ngIf",be.Quantity),d.xp6(2),d.Oqu(null==be.StatusType?null:be.StatusType.Title),d.xp6(6),d.s9C("title",null==be.ConnectionType?null:be.ConnectionType.FormalName),d.xp6(1),d.hij("",null==be.ConnectionType?null:be.ConnectionType.Title," "),d.xp6(1),d.Q6J("ngIf",be.PowerKW),d.xp6(1),d.Q6J("ngIf",be.CurrentTypeID),d.xp6(2),d.Q6J("ngIf",be.Amps),d.xp6(1),d.Q6J("ngIf",be.Voltage),d.xp6(3),d.Oqu(be.Reference),d.xp6(2),d.Oqu(be.Comments),d.xp6(1),d.Q6J("ngIf",Re.enableEdit)}}let se=(()=>{class Ee{constructor(){(0,x.Z)(this,"item",void 0),(0,x.Z)(this,"enableEdit",!1),(0,x.Z)(this,"onEdit",new d.vpe),(0,x.Z)(this,"onDelete",new d.vpe)}ngOnInit(){}editConnection(be){this.onEdit.emit(be)}deleteConnection(be){this.onDelete.emit(be)}getConnectorTypeIcon(be){return v.c.getIconForConnector(be)}}return(0,x.Z)(Ee,"\u0275fac",function(be){return new(be||Ee)}),(0,x.Z)(Ee,"\u0275cmp",d.Xpm({type:Ee,selectors:[["app-equipment-details"]],inputs:{item:"item",enableEdit:"enableEdit"},outputs:{onEdit:"onEdit",onDelete:"onDelete"},decls:2,vars:1,consts:[[4,"ngFor","ngForOf"],["size","3"],[2,"max-width","64px",3,"src"],["color","primary",4,"ngIf"],[1,"info"],[3,"title"],[4,"ngIf"],["color","primary"],["size","small","color","secondary",3,"click"],["name","create","slot","icon-only"],["size","small","color","danger",3,"click"],["name","trash","slot","icon-only"]],template:function(be,Re){1&be&&(d.TgZ(0,"ion-grid"),d.YNc(1,X,26,12,"ion-row",0),d.qZA()),2&be&&(d.xp6(1),d.Q6J("ngForOf",Re.item.Connections))},dependencies:[s.sg,s.O5,Q.yp,Q.YG,Q.wI,Q.jY,Q.gu,Q.uN,Q.Nd]})),Ee})()},5460:(zn,Dt,R)=>{"use strict";R.d(Dt,{v:()=>se});var x=R(5861),d=R(1180),v=R(9127),s=R(2029),Q=R(9903),ie=R(7852),q=R(9862),y=R(5957),fe=R(6814);function Se(Ee,_e){1&Ee&&(s.TgZ(0,"div"),s._UZ(1,"ion-spinner"),s.qZA())}function De(Ee,_e){if(1&Ee){const be=s.EpF();s.TgZ(0,"ion-item",5),s.NdJ("click",function(){const qe=s.CHM(be).$implicit,_t=s.oxw(2);return s.KtG(_t.placeSelected(qe))}),s.TgZ(1,"ion-avatar",6),s._UZ(2,"ion-icon",7),s.qZA(),s.TgZ(3,"ion-label")(4,"p"),s._uU(5),s.qZA()()()}if(2&Ee){const be=_e.$implicit;s.xp6(5),s.Oqu(be.Address)}}function X(Ee,_e){if(1&Ee&&(s.TgZ(0,"div",1),s.YNc(1,Se,2,0,"div",2),s.TgZ(2,"ion-list"),s.YNc(3,De,6,1,"ion-item",3),s.TgZ(4,"ion-item")(5,"p",4),s._uU(6),s.qZA()()()()),2&Ee){const be=s.oxw();s.xp6(1),s.Q6J("ngIf",be.searchInProgress),s.xp6(2),s.Q6J("ngForOf",be.placeList),s.xp6(3),s.hij(" ",be.placeAttribution," ")}}let se=(()=>{class Ee{constructor(be,Re,Ne,qe,_t){(0,d.Z)(this,"logging",void 0),(0,d.Z)(this,"changeDetector",void 0),(0,d.Z)(this,"platform",void 0),(0,d.Z)(this,"http",void 0),(0,d.Z)(this,"events",void 0),(0,d.Z)(this,"placeSearchType",void 0),(0,d.Z)(this,"placeList",void 0),(0,d.Z)(this,"searchInProgress",!1),(0,d.Z)(this,"searchKeyword",void 0),(0,d.Z)(this,"placeSearchFocused",void 0),(0,d.Z)(this,"placeSearchActive",!1),(0,d.Z)(this,"placeAttribution",""),(0,d.Z)(this,"selectedPlace",void 0),(0,d.Z)(this,"placeChanged",new s.vpe),(0,d.Z)(this,"mapService",void 0),this.logging=be,this.changeDetector=Re,this.platform=Ne,this.http=qe,this.events=_t,this.searchKeyword="",this.searchInProgress=!1,this.mapService=new Q.k(_t,be,qe)}ngOnInit(){var be=this;return(0,x.Z)(function*(){yield be.platform.ready(),be.mapService.initAPI()})()}onSearchFocus(){this.placeSearchFocused=!0}onSearchBlur(){this.placeSearchFocused=!1}onSearchCancel(){}getPlacesAutoComplete(be,Re){var Ne=this;return(0,x.Z)(function*(){Ne.placeSearchType=Re;let qe=be.target.value;if(qe&&qe.length>3){Ne.logging.log("Starting place lookup for:"+qe),Ne.placeSearchActive=!0,Ne.searchInProgress=!0,Ne.searchInProgress=!1,Ne.placeSearchActive=!0;try{Ne.placeList=yield Ne.mapService.placeSearch(qe),Ne.placeList&&Ne.placeList.length>0&&(Ne.placeAttribution=Ne.placeList[0].Attribution)}catch{}Ne.searchInProgress=!1,Ne.placeSearchActive=!0}else Ne.searchInProgress=!1,Ne.placeSearchActive=!1})()}placeSelected(be){this.logging.log("Looking up place details:"+be.Title+"::"+be.ReferenceID),this.selectedPlace=be,this.placeChanged.emit(be),this.placeSearchActive=!1}}return(0,d.Z)(Ee,"\u0275fac",function(be){return new(be||Ee)(s.Y36(v.z),s.Y36(s.sBO),s.Y36(ie.t4),s.Y36(q.eN),s.Y36(y.z))}),(0,d.Z)(Ee,"\u0275cmp",s.Xpm({type:Ee,selectors:[["place-search"]],inputs:{searchKeyword:"searchKeyword"},outputs:{selectedPlace:"selectedPlace",placeChanged:"placeChanged"},decls:1,vars:1,consts:[["class","place-search",4,"ngIf"],[1,"place-search"],[4,"ngIf"],[3,"click",4,"ngFor","ngForOf"],[1,"place-attribution"],[3,"click"],["item-left",""],["name","locate"]],template:function(be,Re){1&be&&s.YNc(0,X,7,3,"div",0),2&be&&s.Q6J("ngIf",Re.placeSearchActive)},dependencies:[fe.sg,fe.O5,ie.BJ,ie.gu,ie.Ie,ie.Q$,ie.q_,ie.PQ],styles:[".place-search[_ngcontent-%COMP%]{position:absolute;z-index:1000}.place-attribution[_ngcontent-%COMP%]{font-size:9px;color:#dcdcdc;max-width:100%}"]})),Ee})()},8696:(zn,Dt,R)=>{"use strict";R.d(Dt,{o:()=>fe});var x=R(1180),d=R(2029),v=R(866),s=R(6814),Q=R(7852);function ie(Se,De){if(1&Se){const X=d.EpF();d.TgZ(0,"ion-button",5),d.NdJ("click",function(){d.CHM(X);const Ee=d.oxw().$implicit,_e=d.oxw();return d.KtG(_e.onCopyCommand(Ee))}),d._uU(1,"Copy"),d.qZA()}}function q(Se,De){if(1&Se){const X=d.EpF();d.TgZ(0,"ion-button",5),d.NdJ("click",function(){d.CHM(X);const Ee=d.oxw().$implicit,_e=d.oxw();return d.KtG(_e.onEditCommand(Ee))}),d._uU(1,"Edit"),d.qZA()}}function y(Se,De){if(1&Se&&(d.TgZ(0,"ion-item",1)(1,"ion-grid")(2,"ion-row")(3,"ion-col"),d._uU(4),d.qZA()(),d.TgZ(5,"ion-row")(6,"ion-col",2)(7,"p"),d._UZ(8,"img",3),d.qZA(),d.TgZ(9,"ion-note"),d._uU(10),d.qZA(),d.YNc(11,ie,2,0,"ion-button",4),d.YNc(12,q,2,0,"ion-button",4),d.qZA(),d.TgZ(13,"ion-col")(14,"ion-row")(15,"ion-col")(16,"p"),d._uU(17),d.qZA(),d.TgZ(18,"ion-note"),d._uU(19),d.qZA()()(),d.TgZ(20,"ion-row")(21,"ion-col"),d._uU(22),d.qZA(),d.TgZ(23,"ion-col"),d._uU(24),d.qZA()()()()()()),2&Se){const X=De.$implicit,se=d.oxw();d.xp6(4),d.hij(" ",X.AddressInfo.Title," "),d.xp6(4),d.Q6J("src",se.getIconForPOI(X),d.LSH),d.xp6(2),d.hij(" ",se.getFormattedDistance(X)," "),d.xp6(1),d.Q6J("ngIf",se.enableCopyOption),d.xp6(1),d.Q6J("ngIf",se.enableEditOption),d.xp6(5),d.hij(" ",se.getFormattedAddress(X)," "),d.xp6(2),d.hij(" ",se.getFormattedConnectorList(X)," "),d.xp6(3),d.hij(" ",null==X.UsageType?null:X.UsageType.Title," "),d.xp6(2),d.hij(" ",null==X.OperatorInfo?null:X.OperatorInfo.Title," ")}}let fe=(()=>{class Se{constructor(){(0,x.Z)(this,"enableCopyOption",!1),(0,x.Z)(this,"enableEditOption",!1),(0,x.Z)(this,"poiList",[]),(0,x.Z)(this,"onCopy",new d.vpe),(0,x.Z)(this,"onEdit",new d.vpe)}ngOnInit(){}onCopyCommand(X){this.onCopy.emit(X)}onEditCommand(X){this.onEdit.emit(X)}getFormattedAddress(X){let se="";return se+=X.AddressInfo.Title!=X.AddressInfo.AddressLine1?X.AddressInfo.Title:X.AddressInfo.Town,se}getFormattedConnectorList(X){if(!X.Connections)return;let se=[];for(let Ee of X.Connections)null!=Ee.ConnectionType&&(se.find(_e=>_e==Ee.ConnectionType.Title)||se.push(Ee.ConnectionType.Title));return se.join(", ")}getIconForPOI(X){return v.c.getIconForPOI(X)}getFormattedDistance(X){return v.c.getFormattedDistance(X)}}return(0,x.Z)(Se,"\u0275fac",function(X){return new(X||Se)}),(0,x.Z)(Se,"\u0275cmp",d.Xpm({type:Se,selectors:[["app-poi-list"]],inputs:{enableCopyOption:"enableCopyOption",enableEditOption:"enableEditOption",poiList:"poiList"},outputs:{onCopy:"onCopy",onEdit:"onEdit"},decls:2,vars:1,consts:[["style","max-width:400px;",4,"ngFor","ngForOf"],[2,"max-width","400px"],["size","3"],[2,"width","24px",3,"src"],["size","small",3,"click",4,"ngIf"],["size","small",3,"click"]],template:function(X,se){1&X&&(d.TgZ(0,"ion-list"),d.YNc(1,y,25,9,"ion-item",0),d.qZA()),2&X&&(d.xp6(1),d.Q6J("ngForOf",se.poiList))},dependencies:[s.sg,s.O5,Q.YG,Q.wI,Q.jY,Q.Ie,Q.q_,Q.uN,Q.Nd]})),Se})()},5086:(zn,Dt,R)=>{"use strict";R.d(Dt,{e:()=>q});var x=R(1180),d=R(6814),v=R(7852),s=R(6223),Q=R(3999),ie=R(2029);let q=(()=>{class y{}return(0,x.Z)(y,"\u0275fac",function(Se){return new(Se||y)}),(0,x.Z)(y,"\u0275mod",ie.oAB({type:y})),(0,x.Z)(y,"\u0275inj",ie.cJS({providers:[d.JJ],imports:[d.ez,v.Pc,s.u5,Q.aw]})),y})()},7777:(zn,Dt,R)=>{"use strict";R.d(Dt,{X:()=>v});var x=R(1180),d=R(553);class v{constructor(){(0,x.Z)(this,"baseURL",void 0),(0,x.Z)(this,"loginProviderRedirectBaseURL",void 0),(0,x.Z)(this,"loginProviderRedirectURL",void 0),(0,x.Z)(this,"enableLiveMapQuerying",void 0),(0,x.Z)(this,"googleMapsAPIKey",void 0),(0,x.Z)(this,"enableStaticMaps",void 0),this.baseURL="https://map.openchargemap.io",this.loginProviderRedirectBaseURL="https://openchargemap.org/site/loginprovider/?_mode=silent&_forceLogin=true&_redirectURL=",this.loginProviderRedirectURL=this.loginProviderRedirectBaseURL+this.baseURL,this.enableLiveMapQuerying=!0,this.googleMapsAPIKey=d.N.googleMapsKey,this.enableStaticMaps=d.N.enableStaticMaps}}},866:(zn,Dt,R)=>{"use strict";R.d(Dt,{c:()=>v});var x=R(1180),d=R(553);let v=(()=>{class s{static isFeatureEnabled(ie){return!!d.N.enabledFeatures.find(q=>q===ie)}static getClientHeight(){const ie=document.body,q=document.documentElement;return Math.max(ie.scrollHeight,ie.offsetHeight,q.clientHeight,q.scrollHeight,q.offsetHeight)}static getClientWidth(){const ie=document.body,q=document.documentElement;return Math.max(ie.scrollWidth,ie.offsetWidth,q.clientWidth,q.scrollWidth,q.offsetWidth)}static getMaxLevelOfPOI(ie){let q=0;if(null!=ie.Connections)for(let y=0;y<ie.Connections.length;y++)null!=ie.Connections[y].Level&&ie.Connections[y].Level.ID>q&&(q=ie.Connections[y].Level.ID);return 4===q&&(q=2),q>4&&(q=3),q}static getIconForPOI(ie){let y="assets/images/icons/map/level"+s.getMaxLevelOfPOI(ie);return null!=ie.UsageType&&ie.UsageType.Title.indexOf("Private")>-1?y+="_private":y+=null!=ie.StatusType&&!0!==ie.StatusType.IsOperational?"_nonoperational":"_operational",y+="_icon.png",y}static getColorForPOI(ie){const q=s.getMaxLevelOfPOI(ie);let y="#c0c0c0";return null!=ie.UsageType&&ie.UsageType.Title.indexOf("Private")>-1?y="#FF0000":null!=ie.StatusType&&!0!==ie.StatusType.IsOperational?y="#a0a0a0":2==q?y="#72EB0D":3==q&&(y="#EB800D"),y}static getIconForConnector(ie){let q="assets/images/icons/connectors/";return q+=1===ie?"Type1_J1772.svg":2===ie?"Chademo_type4.svg":25===ie?"Type2_socket.svg":32===ie?"Type1_CCS.svg":33===ie?"Type2_CCS.svg":1036===ie?"Type2_tethered.svg":26===ie?"Type3c.svg":28===ie?"schuko.svg":"Unknown.svg",q}static getFormattedDistance(ie){return ie&&ie.AddressInfo&&ie.AddressInfo.Distance?ie.AddressInfo.Distance.toFixed(1)+" "+(1===ie.AddressInfo.DistanceUnit?"km":"miles"):""}static fixJSONDate(ie){if(null==ie)return null;if(0==ie.indexOf("/")){let y=/Date\(([^)]+)\)/.exec(ie);ie=new Date(parseFloat(y[1]))}else ie=new Date(ie);return ie}static formatMapLinkFromPosition(ie,q,y,fe,Se){return'<a href="https://maps.google.com/maps?saddr='+q+","+y+"&daddr="+ie.AddressInfo.Latitude+","+ie.AddressInfo.Longitude+'">Map ('+Math.ceil(fe)+" "+Se+")</a>"}static formatSystemWebLink(ie,q){return"<a href='#' onclick=\"window.open('"+ie+"', '_system');return false;\">"+q+"</a>"}static formatMapLink(ie,q,y){return y?device&&"WinCE"==device.platform?this.formatSystemWebLink("maps:"+ie.AddressInfo.Latitude+","+ie.AddressInfo.Longitude,q):device&&"iOS"===device.platform?this.formatSystemWebLink("https://maps.apple.com/?q="+ie.AddressInfo.Latitude+","+ie.AddressInfo.Longitude,q):this.formatSystemWebLink("https://maps.google.com/maps?q="+ie.AddressInfo.Latitude+","+ie.AddressInfo.Longitude,q):'<a target="_blank"  href="https://maps.google.com/maps?q='+ie.AddressInfo.Latitude+","+ie.AddressInfo.Longitude+'">'+q+"</a>"}static formatURL(ie,q=null){return null==ie||""==ie?"":(-1==ie.indexOf("http")&&(ie="https://"+ie),'<a target="_blank" href="'+ie+'">'+(q??ie)+"</a>")}static formatString(ie){return null==ie?"":ie.toString()}static formatTextField(ie,q=null,y=!1,fe=!1,Se=null){if(null==ie||""==ie||null==ie)return"";let De=(null!=q?"<strong class='ocm-label' "+(null!=Se?"data-localize='"+Se+"' ":"")+">"+q+"</strong>: ":"")+(y?"<br/>":"")+ie.toString().replace("\n","<br/>")+"<br/>";return 1==fe&&(De="<p>"+De+"</p>"),De}static formatEmailAddress(ie){return null!=ie&&null!=ie&&""!=ie?"<i class='fa fa-envelope fa-fw'></i> <a href=\"mailto:"+ie+'">'+ie+"</a><br/>":""}static formatPhone(ie,q=null){return null!=ie&&null!=ie&&""!=ie?(null==q?q="<i class='fa fa-phone fa-fw '></i> ":q+=": ",q+'<a href="tel:'+ie+'">'+ie+"</a><br/>"):""}static formatPOIDetails(ie,q){let fe=new Date;null==q&&(q=!1);let Se=this.formatPOIAddress(ie,!1),De="";De+=this.formatPhone(ie.AddressInfo.ContactTelephone1),De+=this.formatPhone(ie.AddressInfo.ContactTelephone2),De+=this.formatEmailAddress(ie.AddressInfo.ContactEmail);let X="";if(null!=ie.AddressInfo.Distance){let Ne="https://maps.google.com/maps?saddr=&daddr="+ie.AddressInfo.Latitude+","+ie.AddressInfo.Longitude;X+="<strong id='addr_distance'><span data-localize='details.approxDistance'>Distance</span>: "+ie.AddressInfo.Distance.toFixed(1)+" "+(2==ie.AddressInfo.DistanceUnit?"Miles":"KM")+"</strong>",X+="<p>"+this.formatSystemWebLink(Ne,"Get Directions")+"</p>"}if(null!=ie.AddressInfo.RelatedURL&&""!=ie.AddressInfo.RelatedURL){let Ne=ie.AddressInfo.RelatedURL;Ne=Ne.replace(/.*?:\/\//g,""),Ne.length>40&&(Ne=Ne.substr(0,40)+".."),De+="<i class='fa fa-fw fa-external-link'></i>  "+this.formatSystemWebLink(ie.AddressInfo.RelatedURL,"<span data-localize='details.addressRelatedURL'>"+Ne+"</span>")}De+="</p>";const se=this.formatTextField(ie.GeneralComments,null,!1,!0)+this.formatTextField(ie.AddressInfo.AccessComments,"Access",!0,!0,"details.accessComments");let Ee="";null!=ie.NumberOfPoints&&(Ee+=this.formatTextField(ie.NumberOfPoints,"Bays",!1,!0,"details.numberOfPoints")),null!=ie.UsageType&&(Ee+=this.formatTextField(ie.UsageType.Title,"Usage",!1,!0,"details.usageType")),null!=ie.UsageCost&&(Ee+=this.formatTextField(ie.UsageCost,"Usage Cost",!1,!0,"details.usageCost")),null!=ie.OperatorInfo&&1!=ie.OperatorInfo.ID&&(Ee+=this.formatTextField(ie.OperatorInfo.Title,"Operator",!1,!0,"details.operatorTitle"),null!=ie.OperatorInfo.WebsiteURL&&(Ee+=this.formatTextField(this.formatURL(ie.OperatorInfo.WebsiteURL),"Operator Website",!0,!0,"details.operatorWebsite")));let _e="";if(null!=ie.StatusType&&(_e+=this.formatTextField(ie.StatusType.Title,"Status",!1,!0,"details.operationalStatus"),null!=ie.DateLastStatusUpdate&&(_e+=this.formatTextField(Math.round((fe-this.fixJSONDate(ie.DateLastStatusUpdate))/864e5)+" days ago","Last Updated",!1,!0,"details.lastUpdated"))),null!=ie.Connections&&ie.Connections.length>0){_e+="<table class='table table-striped'>",_e+="<tr><th data-localize='details.equipment.connectionType'>Connection</th><th data-localize='details.equipment.powerLevel'>Power Level</th><th data-localize='details.operationalStatus'>Status</th></tr>";for(let Ne=0;Ne<ie.Connections.length;Ne++){let qe=ie.Connections[Ne];""==qe.Amps&&(qe.Amps=null),""==qe.Voltage&&(qe.Voltage=null),""==qe.Quantity&&(qe.Quantity=null),""==qe.PowerKW&&(qe.PowerKW=null),_e+="<tr><td>"+(null!=qe.ConnectionType?qe.ConnectionType.Title:"")+"</td><td>"+(null!=qe.Level?"<strong>"+qe.Level.Title+"</strong><br/>":"")+(null!=qe.Amps?this.formatString(qe.Amps)+"A/ ":"")+(null!=qe.Voltage?this.formatString(qe.Voltage)+"V/ ":"")+(null!=qe.PowerKW?this.formatString(qe.PowerKW)+"kW <br/>":"")+(null!=qe.CurrentType?qe.CurrentType.Title:"")+"<br/>"+(null!=qe.Quantity?this.formatString(qe.Quantity):"1")+" Present</td><td>"+(null!=qe.StatusType?qe.StatusType.Title:"-")+"</td></tr>"}_e+="</table>"}let be="";return be+=this.formatTextField("<a target='_blank' href='https://openchargemap.org/site/poi/details/"+ie.ID+"'>OCM-"+ie.ID+"</a>","OpenChargeMap Ref",!1,!0,"details.refNumber"),null!=ie.DataProvider&&(be+=this.formatTextField(ie.DataProvider.Title,"Data Provider",!1,!0,"details.dataProviderTitle"),null!=ie.DataProvider.WebsiteURL&&(be+=this.formatTextField(this.formatURL(ie.DataProvider.WebsiteURL),"Website",!1,!0,"details.dataProviderWebsite")),be+=this.formatTextField(ie.AddressInfo.Latitude,"Latitude",!1,!0,null),be+=this.formatTextField(ie.AddressInfo.Longitude,"Longitude",!1,!0,null)),{address:Se,drivingInfo:X,contactInfo:De,additionalInfo:se+Ee+_e,advancedInfo:be}}static debounce(ie,q,y){let fe;return function(){let Se=this,De=arguments,se=y&&!fe;clearTimeout(fe),fe=setTimeout(function(){fe=null,y||ie.apply(Se,De)},q),se&&ie.apply(Se,De)}}static getRandomInt(ie){return Math.floor(Math.random()*Math.floor(ie))}}return(0,x.Z)(s,"formatPOIAddress",function(Q,ie=!0){let q="";return q=ie?""+this.formatTextField(Q.AddressInfo.AddressLine1)+this.formatTextField(Q.AddressInfo.AddressLine2)+this.formatTextField(Q.AddressInfo.Town)+this.formatTextField(Q.AddressInfo.StateOrProvince)+this.formatTextField(Q.AddressInfo.Postcode)+(null!=Q.AddressInfo.Country?this.formatTextField(Q.AddressInfo.Country.Title):""):this.formatStringArray([Q.AddressInfo.AddressLine1,Q.AddressInfo.AddressLine2,Q.AddressInfo.Town,Q.AddressInfo.StateOrProvince,Q.AddressInfo.Postcode,null!=Q.AddressInfo.Country?Q.AddressInfo.Country.Title:""]),q}),(0,x.Z)(s,"formatStringArray",function(Q,ie=", "){if(null==Q)return"";let q="";for(let y=0;y<Q.length;y++)null!=Q[y]&&""!=Q[y].trim()&&(q+=y==Q.length-1?Q[y]:Q[y]+ie);return q}),s})()},3052:(zn,Dt,R)=>{"use strict";R.d(Dt,{LL:()=>s,jR:()=>v,wC:()=>d});var x=R(1180);class d{constructor(ie=null,q=null){(0,x.Z)(this,"altitudeAccuracy",void 0),(0,x.Z)(this,"longitude",void 0),(0,x.Z)(this,"latitude",void 0),(0,x.Z)(this,"speed",void 0),(0,x.Z)(this,"heading",void 0),(0,x.Z)(this,"altitude",void 0),(0,x.Z)(this,"accuracy",void 0),this.latitude=ie,this.longitude=q}}class v{constructor(ie=null,q=null){(0,x.Z)(this,"coords",void 0),(0,x.Z)(this,"timestamp",void 0),(0,x.Z)(this,"attribution",void 0),this.coords=new d,this.coords.latitude=ie,this.coords.longitude=q}static fromPosition(ie){return new v(ie.coords.latitude,ie.coords.longitude)}}class s{constructor(ie,q){(0,x.Z)(this,"northEast",void 0),(0,x.Z)(this,"southWest",void 0),this.northEast=ie,this.southWest=q}}},7430:(zn,Dt,R)=>{"use strict";R.d(Dt,{Qp:()=>s,fw:()=>q,JJ:()=>fe,eN:()=>y,vw:()=>ie,kA:()=>Q});var x=R(1180);class d{constructor(De,X){(0,x.Z)(this,"itemType",void 0),(0,x.Z)(this,"itemId",void 0),(0,x.Z)(this,"version",void 0),(0,x.Z)(this,"schemaVersion",void 0),(0,x.Z)(this,"syncTimeStamp",void 0),this.itemType=De,this.itemId=d.getNewItemId(),this.version=1,this.schemaVersion=X,this.syncTimeStamp=d.getNewSyncTimeStamp()}static getNewSyncTimeStamp(){return Date.now().toString()}static getNewItemId(){return"_syncitem_"+Date.now().toString()}}class v{constructor(De,X){(0,x.Z)(this,"Title",void 0),(0,x.Z)(this,"Notes",void 0),(0,x.Z)(this,"_sync",void 0),this._sync=new d(De,X)}}class s extends v{constructor(...De){super(...De),(0,x.Z)(this,"PoiID",void 0),(0,x.Z)(this,"Type",void 0),(0,x.Z)(this,"Poi",void 0),(0,x.Z)(this,"Photos",void 0)}}class Q extends v{constructor(){super("waypoint",1),(0,x.Z)(this,"Stage",void 0),(0,x.Z)(this,"Position",void 0),(0,x.Z)(this,"PoiIDs",void 0),(0,x.Z)(this,"PoiList",void 0)}}class ie extends v{constructor(){super("journey_stage",1),(0,x.Z)(this,"WayPoints",void 0),this.WayPoints=[]}}class q extends v{constructor(){super("journey",1),(0,x.Z)(this,"ID",void 0),(0,x.Z)(this,"Stages",void 0),this.ID=""+Date.now(),this.Stages=[]}}class y{constructor(){(0,x.Z)(this,"Title",void 0),(0,x.Z)(this,"DistanceKM",void 0),(0,x.Z)(this,"DurationMinutes",void 0),(0,x.Z)(this,"StartElevation",void 0),(0,x.Z)(this,"EndElevation",void 0),(0,x.Z)(this,"EnergyConsumptionkWh",void 0)}}class fe{constructor(){(0,x.Z)(this,"Title",void 0),(0,x.Z)(this,"JourneyRouteLegs",void 0),(0,x.Z)(this,"TotalDistanceKM",void 0),(0,x.Z)(this,"TotalDurationMinutes",void 0),(0,x.Z)(this,"TotalEnergykWh",void 0)}}},4677:(zn,Dt,R)=>{"use strict";R.d(Dt,{b:()=>d});var x=R(1180);class d{constructor(){(0,x.Z)(this,"poiIdList",null),(0,x.Z)(this,"countryCode",null),(0,x.Z)(this,"latitude",null),(0,x.Z)(this,"longitude",null),(0,x.Z)(this,"locationTitle",null),(0,x.Z)(this,"distance",null),(0,x.Z)(this,"distanceUnit",null),(0,x.Z)(this,"connectionTypeIdList",null),(0,x.Z)(this,"operatorIdList",null),(0,x.Z)(this,"levelIdList",null),(0,x.Z)(this,"countryIdList",null),(0,x.Z)(this,"usageTypeIdList",null),(0,x.Z)(this,"statusTypeIdList",null),(0,x.Z)(this,"minPowerKW",null),(0,x.Z)(this,"maxPowerKW",null),(0,x.Z)(this,"submissionStatusTypeIdList",null),(0,x.Z)(this,"maxResults",500),(0,x.Z)(this,"additionalParams",null),(0,x.Z)(this,"includeComments",!1),(0,x.Z)(this,"compact",!0),(0,x.Z)(this,"enableCaching",!0),(0,x.Z)(this,"levelOfDetail",1),(0,x.Z)(this,"polyline",null),(0,x.Z)(this,"boundingbox",null)}}},2117:(zn,Dt,R)=>{"use strict";R.d(Dt,{n:()=>d});var x=R(1180);class d{constructor(){(0,x.Z)(this,"Location",void 0),(0,x.Z)(this,"Title",void 0),(0,x.Z)(this,"Address",void 0),(0,x.Z)(this,"Type",void 0),(0,x.Z)(this,"ReferenceID",void 0),(0,x.Z)(this,"Attribution",void 0),(0,x.Z)(this,"AddressInfo",void 0)}}},4783:(zn,Dt,R)=>{"use strict";R.d(Dt,{N:()=>v,U:()=>d});var x=R(1180);const d=650;class v{constructor(){(0,x.Z)(this,"OperatorList",void 0),(0,x.Z)(this,"ConnectionTypeList",void 0),(0,x.Z)(this,"CountryList",void 0),(0,x.Z)(this,"UsageTypeList",void 0),(0,x.Z)(this,"StatusTypeList",void 0),(0,x.Z)(this,"MinPowerKW",void 0),(0,x.Z)(this,"MaxPowerKW",void 0),(0,x.Z)(this,"UseDistanceInKM",void 0),(0,x.Z)(this,"HasActiveFilters",void 0),(0,x.Z)(this,"LastSearchPosition",void 0),(0,x.Z)(this,"StartSearchPosition",void 0),(0,x.Z)(this,"StartViewPoiId",void 0),(0,x.Z)(this,"Language",void 0),(0,x.Z)(this,"FilterOptionsByCountryId",void 0),(0,x.Z)(this,"MapType",void 0),(0,x.Z)(this,"EnableAdvancedEditorFeatures",void 0),(0,x.Z)(this,"MaxResults",void 0),this.OperatorList=[],this.ConnectionTypeList=[],this.CountryList=[],this.UsageTypeList=[],this.StatusTypeList=[],this.MaxPowerKW=null,this.MinPowerKW=null,this.HasActiveFilters=!1,this.FilterOptionsByCountryId=null,this.UseDistanceInKM=!0,this.MapType="ROADMAP",this.EnableAdvancedEditorFeatures=!1,this.MaxResults=500}LoadSettings(){}SaveSettings(){}ClearActiveFilters(){this.OperatorList=[],this.ConnectionTypeList=[],this.CountryList=[],this.UsageTypeList=[],this.StatusTypeList=[],this.MinPowerKW=null,this.MaxPowerKW=null}CheckForActiveFilters(){return this.HasActiveFilters=this.OperatorList.length>0||this.ConnectionTypeList.length>0||this.CountryList.length>0||this.UsageTypeList.length>0||this.StatusTypeList.length>0||this.MinPowerKW>0||this.MaxPowerKW>0||null!=this.MaxPowerKW&&this.MaxPowerKW<d,this.HasActiveFilters}}},2339:(zn,Dt,R)=>{"use strict";R.d(Dt,{q:()=>x});var x=(()=>((x=x||{})[x.POI=0]="POI",x[x.Comment=1]="Comment",x[x.Media=2]="Media",x))()},7425:(zn,Dt,R)=>{"use strict";R.r(Dt),R.d(Dt,{AboutPageModule:()=>De});var x=R(1180),d=R(6814),v=R(6223),s=R(7852),Q=R(2125),ie=R(9236),q=R(2029);const y=[{path:"",component:ie.t}];let fe=(()=>{class X{}return(0,x.Z)(X,"\u0275fac",function(Ee){return new(Ee||X)}),(0,x.Z)(X,"\u0275mod",q.oAB({type:X})),(0,x.Z)(X,"\u0275inj",q.cJS({imports:[Q.Bz.forChild(y),Q.Bz]})),X})();var Se=R(3999);let De=(()=>{class X{}return(0,x.Z)(X,"\u0275fac",function(Ee){return new(Ee||X)}),(0,x.Z)(X,"\u0275mod",q.oAB({type:X})),(0,x.Z)(X,"\u0275inj",q.cJS({imports:[d.ez,v.u5,s.Pc,Se.aw,fe]})),X})()},9236:(zn,Dt,R)=>{"use strict";R.d(Dt,{t:()=>ie});var x=R(1180),d=R(553),v=R(2029),s=R(7852),Q=R(3999);let ie=(()=>{class q{constructor(fe){(0,x.Z)(this,"modalController",void 0),this.modalController=fe}get appVersion(){return d.N.version}get apiUrl(){return d.N.apiBase}ngOnInit(){}close(){this.modalController.dismiss()}}return(0,x.Z)(q,"\u0275fac",function(fe){return new(fe||q)(v.Y36(s.IN))}),(0,x.Z)(q,"\u0275cmp",v.Xpm({type:q,selectors:[["app-about"]],decls:41,vars:5,consts:[[1,"ion-padding"],["size","2"],["src","assets/images/icons/branding/AppIcon_128x128.png",2,"padding-top","2em"],["href","https://openchargemap.org"],["href","https://community.openchargemap.org"],["href","https://webprofusion.com"],["slot","end"],[3,"click"],["name","close","slot","start"]],template:function(fe,Se){1&fe&&(v.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),v._uU(3),v.ALo(4,"translate"),v.qZA()()(),v.TgZ(5,"ion-content",0)(6,"ion-grid")(7,"ion-row")(8,"ion-col",1),v._UZ(9,"img",2),v.qZA(),v.TgZ(10,"ion-col")(11,"h1"),v._uU(12,"Open Charge Map"),v.qZA(),v.TgZ(13,"h2"),v._uU(14,"The global public registry of Electric Vehicle charging locations"),v.qZA(),v.TgZ(15,"p"),v._uU(16,"Web: "),v.TgZ(17,"a",3),v._uU(18,"https://openchargemap.org"),v.qZA()()()()(),v.TgZ(19,"p"),v._uU(20,"Community Discussions: "),v.TgZ(21,"a",4),v._uU(22,"https://community.openchargemap.org"),v.qZA()(),v.TgZ(23,"p"),v._uU(24,"App development by Webprofusion Pty Ltd ("),v.TgZ(25,"a",5),v._uU(26,"https://webprofusion.com"),v.qZA(),v._uU(27,")"),v.qZA(),v.TgZ(28,"p"),v._uU(29,"Our software is developed and hosted by volunteers, our data is largely crowdsourced by you."),v.qZA(),v.TgZ(30,"ion-note")(31,"p"),v._uU(32),v.qZA(),v.TgZ(33,"p"),v._uU(34),v.qZA()()(),v.TgZ(35,"ion-footer")(36,"ion-toolbar")(37,"ion-buttons",6)(38,"ion-button",7),v.NdJ("click",function(){return Se.close()}),v._UZ(39,"ion-icon",8),v._uU(40," Close "),v.qZA()()()()),2&fe&&(v.xp6(3),v.Oqu(v.lcZ(4,3,"ocm.general.about")),v.xp6(29),v.hij("App Version: ",Se.appVersion,""),v.xp6(2),v.hij("API: ",Se.apiUrl,""))},dependencies:[s.YG,s.Sm,s.wI,s.W2,s.fr,s.jY,s.Gu,s.gu,s.uN,s.Nd,s.wd,s.sr,Q.X$]})),q})()},9192:(zn,Dt,R)=>{"use strict";R.r(Dt),R.d(Dt,{JourneysModule:()=>Se});var x=R(1180),d=R(4292),v=R(5086),s=R(3999),Q=R(6814),ie=R(6223),q=R(7852),y=R(2125),fe=R(2029);let Se=(()=>{class De{}return(0,x.Z)(De,"\u0275fac",function(se){return new(se||De)}),(0,x.Z)(De,"\u0275mod",fe.oAB({type:De})),(0,x.Z)(De,"\u0275inj",fe.cJS({imports:[Q.ez,ie.u5,q.Pc,s.aw,v.e,y.Bz.forChild([{path:"",component:d.g}])]})),De})()},4292:(zn,Dt,R)=>{"use strict";R.d(Dt,{g:()=>Je});var x=R(1180),d=R(989),v=R(439),s=R(1618),Q=R(3052),ie=R(9723),q=R(2029),y=R(7852),fe=R(6814);function Se(Me,it){1&Me&&(q.TgZ(0,"p"),q._uU(1," You have no journeys yet. Start by browsing to a charging location, then add it as Favourite to start a new Journey. "),q.qZA())}function De(Me,it){if(1&Me&&(q.TgZ(0,"p"),q._uU(1),q.qZA()),2&Me){const Xe=q.oxw(2).$implicit;q.xp6(1),q.hij(" ",Xe.Poi.AddressInfo.AddressLine1,"")}}function X(Me,it){if(1&Me&&(q.TgZ(0,"p"),q._uU(1),q.qZA()),2&Me){const Xe=q.oxw(2).$implicit;q.xp6(1),q.hij(" ",Xe.Poi.AddressInfo.AddressLine2,"")}}function se(Me,it){if(1&Me&&(q.TgZ(0,"p"),q._uU(1),q.qZA()),2&Me){const Xe=q.oxw(2).$implicit;q.xp6(1),q.hij(" ",Xe.Poi.AddressInfo.Town,"")}}function Ee(Me,it){if(1&Me&&(q.TgZ(0,"p"),q._uU(1),q.qZA()),2&Me){const Xe=q.oxw(2).$implicit;q.xp6(1),q.hij(" ",Xe.Poi.AddressInfo.StateOrProvince,"")}}function _e(Me,it){if(1&Me&&(q.TgZ(0,"p"),q._uU(1),q.qZA()),2&Me){const Xe=q.oxw(2).$implicit;q.xp6(1),q.hij(" ",Xe.Poi.AddressInfo.Postcode,"")}}function be(Me,it){if(1&Me){const Xe=q.EpF();q.TgZ(0,"div")(1,"div",18),q.NdJ("click",function(){q.CHM(Xe);const ae=q.oxw().$implicit,yt=q.oxw(4);return q.KtG(yt.viewPOIDetails(ae.Poi))}),q.YNc(2,De,2,1,"p",4),q.YNc(3,X,2,1,"p",4),q.YNc(4,se,2,1,"p",4),q.YNc(5,Ee,2,1,"p",4),q.YNc(6,_e,2,1,"p",4),q.qZA(),q.TgZ(7,"ion-button",19),q.NdJ("click",function(){q.CHM(Xe);const ae=q.oxw().$implicit,yt=q.oxw(4);return q.KtG(yt.launchNavigation(ae.Poi))}),q._UZ(8,"ion-icon",20),q._uU(9," Navigate "),q.qZA()()}if(2&Me){const Xe=q.oxw().$implicit;q.xp6(2),q.Q6J("ngIf",Xe.Poi.AddressInfo.AddressLine1),q.xp6(1),q.Q6J("ngIf",Xe.Poi.AddressInfo.AddressLine2),q.xp6(1),q.Q6J("ngIf",Xe.Poi.AddressInfo.Town),q.xp6(1),q.Q6J("ngIf",Xe.Poi.AddressInfo.StateOrProvince),q.xp6(1),q.Q6J("ngIf",Xe.Poi.AddressInfo.Postcode)}}function Re(Me,it){if(1&Me&&(q.TgZ(0,"div",17),q.YNc(1,be,10,5,"div",4),q.qZA()),2&Me){const Xe=it.$implicit;q.xp6(1),q.Q6J("ngIf",Xe.Poi)}}function Ne(Me,it){if(1&Me&&(q.TgZ(0,"ion-item")(1,"h2"),q._uU(2),q.qZA(),q.TgZ(3,"ion-thumbnail",0),q._UZ(4,"ion-icon",15),q.qZA(),q.TgZ(5,"p"),q._uU(6),q.qZA(),q.YNc(7,Re,2,1,"div",16),q.qZA()),2&Me){const Xe=it.$implicit;q.xp6(2),q.Oqu(Xe.Title),q.xp6(4),q.Oqu(Xe.Notes),q.xp6(1),q.Q6J("ngForOf",Xe.PoiList)}}function qe(Me,it){if(1&Me&&(q.TgZ(0,"ion-list")(1,"ion-list-header",11),q._uU(2),q._UZ(3,"ion-icon",12),q._uU(4," -- "),q._UZ(5,"ion-icon",13),q._uU(6," -- "),q._UZ(7,"ion-icon",14),q._uU(8," -- "),q.qZA(),q.YNc(9,Ne,8,3,"ion-item",5),q.qZA()),2&Me){const Xe=it.$implicit;q.xp6(2),q.hij(" ",Xe.Title," "),q.xp6(7),q.Q6J("ngForOf",Xe.WayPoints)}}function _t(Me,it){if(1&Me){const Xe=q.EpF();q.TgZ(0,"ion-card")(1,"ion-card-content")(2,"ion-toolbar",8)(3,"ion-title"),q._uU(4),q.qZA(),q.TgZ(5,"ion-buttons",9)(6,"ion-button",1),q.NdJ("click",function(){const yt=q.CHM(Xe).$implicit,we=q.oxw();return q.KtG(we.deleteJourney(yt.ID))}),q._UZ(7,"ion-icon",10),q.qZA()()(),q.TgZ(8,"p"),q._uU(9),q.qZA(),q.YNc(10,qe,10,2,"ion-list",5),q.qZA()()}if(2&Me){const Xe=it.$implicit;q.xp6(4),q.hij(" ",Xe.Title,""),q.xp6(5),q.Oqu(Xe.Notes),q.xp6(1),q.Q6J("ngForOf",Xe.Stages)}}let Je=(()=>{class Me{constructor(Xe,Te,ae,yt,we){(0,x.Z)(this,"appManager",void 0),(0,x.Z)(this,"journeyManager",void 0),(0,x.Z)(this,"api",void 0),(0,x.Z)(this,"modalController",void 0),(0,x.Z)(this,"alertController",void 0),this.appManager=Xe,this.journeyManager=Te,this.api=ae,this.modalController=yt,this.alertController=we}dismiss(){this.modalController.dismiss()}discoverImages(){this.journeyManager.journeys.forEach(Xe=>{Xe.Stages.forEach(Te=>{Te.WayPoints.forEach(ae=>{null!=ae.PoiList&&ae.PoiList.forEach(yt=>{yt.Poi&&this.api.getPanoramioLocationPhotos(new Q.wC(yt.Poi.AddressInfo.Latitude,yt.Poi.AddressInfo.Longitude)).then(we=>{yt.Photos=we})})})})})}getJson(Xe){return JSON.stringify(Xe,null,4)}viewPOIDetails(Xe){this.modalController.create({component:ie.H,componentProps:{item:Xe}}).then(Te=>Te.present())}get staticMapSize(){return"60x60"}getStaticMapURL(Xe){return"https://maps.googleapis.com/maps/api/staticmap?center="+Xe.AddressInfo.Latitude+","+Xe.AddressInfo.Longitude+"&zoom=13&scale=2&size="+this.staticMapSize+"&maptype=roadmap&format=jpg&visual_refresh=true&markers=size:small%7Ccolor:0xff0000%7Clabel:%7C"+Xe.AddressInfo.Latitude+","+Xe.AddressInfo.Longitude}deleteJourney(Xe){this.alertController.create({header:"Delete this Journey?",message:"Are you sure you want to delete this Journey?",buttons:[{text:"No",handler:()=>{}},{text:"Delete",handler:()=>{this.journeyManager.deleteJourney(Xe)}}]}).then(Te=>Te.present())}launchNavigation(Xe){let Te="https://maps.google.com/?q="+Xe.AddressInfo.Latitude+","+Xe.AddressInfo.Longitude;this.appManager.platform.is("ios")&&(Te="https://maps.apple.com?q="+Xe.AddressInfo.Latitude+","+Xe.AddressInfo.Longitude),window.open(Te,"_system")}}return(0,x.Z)(Me,"\u0275fac",function(Xe){return new(Xe||Me)(q.Y36(s.c),q.Y36(d.i),q.Y36(v.l),q.Y36(y.IN),q.Y36(y.Br))}),(0,x.Z)(Me,"\u0275cmp",q.Xpm({type:Me,selectors:[["ng-component"]],decls:18,vars:2,consts:[["slot","start"],[3,"click"],[1,"journeys-page"],[1,"ion-padding"],[4,"ngIf"],[4,"ngFor","ngForOf"],["slot","end"],["name","close","slot","start"],["primary",""],["slot","primary"],["name","close","slot","icon-only"],[2,"font-size","1.5rem"],["name","car"],["name","time"],["name","flash"],["name","caret-down",2,"font-size","4rem"],["style","text-align:right;width:100%;",4,"ngFor","ngForOf"],[2,"text-align","right","width","100%"],["tappable","",3,"click"],["clear","","item-right","",3,"click"],["name","navigate","slot","start"]],template:function(Xe,Te){1&Xe&&(q.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0)(3,"ion-back-button",1),q.NdJ("click",function(){return Te.dismiss()}),q.qZA()(),q.TgZ(4,"ion-title"),q._uU(5," Journeys "),q.qZA()()(),q.TgZ(6,"ion-content",2)(7,"div",3)(8,"p"),q._uU(9," You can create and plan journeys to group your favourite charging routes together. "),q.qZA(),q.YNc(10,Se,2,0,"p",4),q.qZA(),q.YNc(11,_t,11,3,"ion-card",5),q.qZA(),q.TgZ(12,"ion-footer")(13,"ion-toolbar")(14,"ion-buttons",6)(15,"ion-button",1),q.NdJ("click",function(){return Te.dismiss()}),q._UZ(16,"ion-icon",7),q._uU(17," Close "),q.qZA()()()()),2&Xe&&(q.xp6(10),q.Q6J("ngIf",null==Te.journeyManager.journeys||0==Te.journeyManager.journeys.length),q.xp6(1),q.Q6J("ngForOf",Te.journeyManager.journeys))},dependencies:[fe.sg,fe.O5,y.oU,y.YG,y.Sm,y.PM,y.FN,y.W2,y.fr,y.Gu,y.gu,y.Ie,y.q_,y.yh,y.Bs,y.wd,y.sr,y.cs],encapsulation:2})),Me})()},2309:(zn,Dt,R)=>{"use strict";R.r(Dt),R.d(Dt,{LayerEditorPageModule:()=>De});var x=R(1180),d=R(6814),v=R(6223),s=R(7852),Q=R(2125),ie=R(8062),q=R(2029);const y=[{path:"",component:ie.A}];let fe=(()=>{class X{}return(0,x.Z)(X,"\u0275fac",function(Ee){return new(Ee||X)}),(0,x.Z)(X,"\u0275mod",q.oAB({type:X})),(0,x.Z)(X,"\u0275inj",q.cJS({imports:[Q.Bz.forChild(y),Q.Bz]})),X})();var Se=R(5086);let De=(()=>{class X{}return(0,x.Z)(X,"\u0275fac",function(Ee){return new(Ee||X)}),(0,x.Z)(X,"\u0275mod",q.oAB({type:X})),(0,x.Z)(X,"\u0275inj",q.cJS({imports:[d.ez,v.u5,s.Pc,fe,Se.e]})),X})()},8062:(zn,Dt,R)=>{"use strict";R.d(Dt,{A:()=>fe});var x=R(5861),d=R(1180),v=R(9159),s=R(2029),Q=R(7852),ie=R(6814),q=R(8696);function y(Se,De){if(1&Se&&(s.TgZ(0,"div"),s._uU(1),s._UZ(2,"app-poi-list",10),s.qZA()),2&Se){const X=s.oxw();s.xp6(1),s.hij(" Items Parsed: ",X.fileData.length," "),s.xp6(1),s.Q6J("poiList",X.fileData)}}let fe=(()=>{class Se{constructor(X,se){(0,d.Z)(this,"modalController",void 0),(0,d.Z)(this,"refData",void 0),(0,d.Z)(this,"fileData",void 0),this.modalController=X,this.refData=se}ngOnInit(){}previewFile(){var X=this;return(0,x.Z)(function*(){yield X.loadFile(!1)})()}cancel(){var X=this;return(0,x.Z)(function*(){yield X.modalController.dismiss(X.fileData)})()}loadFile(X=!0){var se=this;return(0,x.Z)(function*(){const Ee=new FileReader;Ee.onload=()=>{let be=JSON.parse(Ee.result),Re=5e6;for(let Ne of be)(null==Ne.ID||""==Ne.ID)&&(Ne.ID=Re.toString()),Ne.ID="imp_"+Ne.ID,Re++;se.fileData=se.refData.hydrateCompactPOIList(be),X&&se.modalController.dismiss(se.fileData)},Ee.onerror=()=>{},Ee.readAsText(document.getElementById("file-upload").files[0])})()}add(){var X=this;return(0,x.Z)(function*(){X.modalController.dismiss(X.fileData)})()}}return(0,d.Z)(Se,"\u0275fac",function(X){return new(X||Se)(s.Y36(Q.IN),s.Y36(v.W))}),(0,d.Z)(Se,"\u0275cmp",s.Xpm({type:Se,selectors:[["app-layer-editor"]],decls:27,vars:1,consts:[[1,"ion-padding"],[1,"upload"],["name","file","aria-label","file","slot","start"],["type","file","required","","id","file-upload",3,"change"],[4,"ngIf"],["slot","secondary"],[3,"click"],["name","close","slot","start"],["slot","primary"],["name","checkmark-circle-outline","slot","end"],[3,"poiList"]],template:function(X,se){1&X&&(s.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),s._uU(3," Edit Layer "),s.qZA()()(),s.TgZ(4,"ion-content",0)(5,"p"),s._uU(6,"POI layers are used to preview data from other Open Data sources. "),s.qZA(),s.TgZ(7,"p"),s._uU(8,"Select a POI layer JSON file: "),s.qZA(),s.TgZ(9,"div")(10,"label",1)(11,"ion-button"),s._UZ(12,"ion-icon",2),s.TgZ(13,"ion-label"),s._uU(14,"Choose File.."),s.qZA()(),s.TgZ(15,"input",3),s.NdJ("change",function(){return se.previewFile()}),s.qZA()()(),s.YNc(16,y,3,2,"div",4),s.qZA(),s.TgZ(17,"ion-footer")(18,"ion-toolbar")(19,"ion-buttons",5)(20,"ion-button",6),s.NdJ("click",function(){return se.cancel()}),s._UZ(21,"ion-icon",7),s._uU(22," Cancel "),s.qZA()(),s.TgZ(23,"ion-buttons",8)(24,"ion-button",6),s.NdJ("click",function(){return se.add()}),s._uU(25," Add "),s._UZ(26,"ion-icon",9),s.qZA()()()()),2&X&&(s.xp6(16),s.Q6J("ngIf",se.fileData&&se.fileData.length>0))},dependencies:[ie.O5,Q.YG,Q.Sm,Q.W2,Q.fr,Q.Gu,Q.gu,Q.Q$,Q.wd,Q.sr,q.o],styles:[".upload[_ngcontent-%COMP%]   input[type=file][_ngcontent-%COMP%]{position:fixed;top:-1000px}"]})),Se})()},9723:(zn,Dt,R)=>{"use strict";R.d(Dt,{H:()=>In});var x=R(1180),d=R(1618),v=R(2029),s=R(7852),Q=R(5861),ie=R(989),q=R(7430),y=R(6814),fe=R(6223);function Se(et,Ue){if(1&et&&(v.TgZ(0,"ion-select-option",13),v._uU(1),v.qZA()),2&et){const Y=Ue.$implicit;v.Q6J("value",Y.ID),v.xp6(1),v.Oqu(Y.Title)}}function De(et,Ue){if(1&et&&(v.TgZ(0,"ion-select-option",16),v._uU(1),v.qZA()),2&et){const Y=Ue.$implicit;v.Q6J("value",Ue.index),v.xp6(1),v.Oqu(Y.Title)}}function X(et,Ue){if(1&et){const Y=v.EpF();v.TgZ(0,"ion-item")(1,"ion-label",2),v._uU(2,"Journey Stage"),v.qZA(),v.TgZ(3,"ion-select",3),v.NdJ("ngModelChange",function(Ge){v.CHM(Y);const Ft=v.oxw();return v.KtG(Ft.selectedStageIndex=Ge)}),v.TgZ(4,"ion-select-option",14),v._uU(5,"Create a Journey Stage"),v.qZA(),v.YNc(6,De,2,2,"ion-select-option",15),v.qZA()()}if(2&et){const Y=v.oxw();v.xp6(3),v.Q6J("ngModel",Y.selectedStageIndex),v.xp6(3),v.Q6J("ngForOf",Y.journeyManager.getJourneyStages(Y.selectedJourneyID))}}function se(et,Ue){if(1&et){const Y=v.EpF();v.TgZ(0,"ion-item")(1,"ion-label",2),v._uU(2,"New Journey Name"),v.qZA(),v.TgZ(3,"ion-input",7),v.NdJ("ngModelChange",function(Ge){v.CHM(Y);const Ft=v.oxw();return v.KtG(Ft.newJourneyName=Ge)}),v.qZA()()}if(2&et){const Y=v.oxw();v.xp6(3),v.Q6J("ngModel",Y.newJourneyName)}}let Ee=(()=>{class et{constructor(Y,me,Ge,Ft){(0,x.Z)(this,"appManager",void 0),(0,x.Z)(this,"navParams",void 0),(0,x.Z)(this,"journeyManager",void 0),(0,x.Z)(this,"modalController",void 0),(0,x.Z)(this,"selectedJourneyID",void 0),(0,x.Z)(this,"selectedStageIndex",void 0),(0,x.Z)(this,"newJourneyName",void 0),(0,x.Z)(this,"waypoint",void 0),(0,x.Z)(this,"poi",void 0),this.appManager=Y,this.navParams=me,this.journeyManager=Ge,this.modalController=Ft,this.poi=this.navParams.get("poi"),this.waypoint=new q.kA,this.waypoint.Title=this.poi.AddressInfo.Title,this.waypoint.PoiIDs=[this.poi.ID],this.waypoint.PoiList=[];const gn=new q.Qp("charging",1);gn.Poi=this.poi,gn.PoiID=this.poi.ID,this.waypoint.PoiList.push(gn),this.newJourneyName="Trip to "+this.poi.AddressInfo.Title}cancel(){this.modalController.dismiss()}add(){if(null!=this.selectedJourneyID&&""!==this.selectedJourneyID)this.journeyManager.addJourneyWaypoint(this.selectedJourneyID,this.selectedStageIndex,this.waypoint);else{const Y=new q.fw;Y.ID=Date.now().toString(),""===this.newJourneyName&&(this.newJourneyName="New Journey"),Y.Title=this.newJourneyName,this.journeyManager.addJourney(Y,this.waypoint)}this.journeyManager.saveJourneys(),this.modalController.dismiss()}}return(0,x.Z)(et,"\u0275fac",function(Y){return new(Y||et)(v.Y36(d.c),v.Y36(s.X1),v.Y36(ie.i),v.Y36(s.IN))}),(0,x.Z)(et,"\u0275cmp",v.Xpm({type:et,selectors:[["ng-component"]],decls:39,vars:8,consts:[[1,"journeys-page","ion-padding"],[1,"banner"],["position","stacked"],[3,"ngModel","ngModelChange"],["value","","checked",""],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],["type","text",3,"ngModel","ngModelChange"],["slot","secondary"],[3,"click"],["name","close","slot","start"],["slot","primary"],["name","add","slot","end"],[3,"value"],["value",""],["checked","",3,"value",4,"ngFor","ngForOf"],["checked","",3,"value"]],template:function(Y,me){1&Y&&(v.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),v._uU(3," Edit Favourite "),v.qZA()()(),v.TgZ(4,"ion-content",0)(5,"div",1)(6,"h1"),v._uU(7),v.qZA(),v.TgZ(8,"p"),v._uU(9),v.qZA()(),v.TgZ(10,"p"),v._uU(11," Add Charging Location as a Journey Waypoint "),v.qZA(),v.TgZ(12,"ion-item")(13,"ion-label",2),v._uU(14,"Add to a Journey"),v.qZA(),v.TgZ(15,"ion-select",3),v.NdJ("ngModelChange",function(Ft){return me.selectedJourneyID=Ft}),v.TgZ(16,"ion-select-option",4),v._uU(17,"Create a New Journey"),v.qZA(),v.YNc(18,Se,2,2,"ion-select-option",5),v.qZA()(),v.YNc(19,X,7,2,"ion-item",6),v.YNc(20,se,4,1,"ion-item",6),v.TgZ(21,"ion-item")(22,"ion-label",2),v._uU(23,"Name for this step of your journey"),v.qZA(),v.TgZ(24,"ion-input",7),v.NdJ("ngModelChange",function(Ft){return me.waypoint.Title=Ft}),v.qZA()(),v.TgZ(25,"ion-item")(26,"ion-label",2),v._uU(27,"Other Notes"),v.qZA(),v.TgZ(28,"ion-textarea",3),v.NdJ("ngModelChange",function(Ft){return me.waypoint.Notes=Ft}),v.qZA()()(),v.TgZ(29,"ion-footer")(30,"ion-toolbar")(31,"ion-buttons",8)(32,"ion-button",9),v.NdJ("click",function(){return me.cancel()}),v._UZ(33,"ion-icon",10),v._uU(34," Cancel "),v.qZA()(),v.TgZ(35,"ion-buttons",11)(36,"ion-button",9),v.NdJ("click",function(){return me.add()}),v._uU(37," Add "),v._UZ(38,"ion-icon",12),v.qZA()()()()),2&Y&&(v.xp6(7),v.Oqu(me.poi.AddressInfo.Title),v.xp6(2),v.Oqu(me.poi.AddressInfo.AddressLine1),v.xp6(6),v.Q6J("ngModel",me.selectedJourneyID),v.xp6(3),v.Q6J("ngForOf",me.journeyManager.journeys),v.xp6(1),v.Q6J("ngIf",me.selectedJourneyID),v.xp6(1),v.Q6J("ngIf",!me.selectedJourneyID),v.xp6(4),v.Q6J("ngModel",me.waypoint.Title),v.xp6(4),v.Q6J("ngModel",me.waypoint.Notes))},dependencies:[y.sg,y.O5,fe.JJ,fe.On,s.YG,s.Sm,s.W2,s.fr,s.Gu,s.gu,s.pK,s.Ie,s.Q$,s.t9,s.n0,s.g2,s.wd,s.sr,s.QI,s.j9],encapsulation:2})),et})();var _e=R(9127);function be(et,Ue){if(1&et){const Y=v.EpF();v.TgZ(0,"ion-card")(1,"ion-toolbar")(2,"ion-title",14),v._uU(3,"Preview"),v.qZA(),v.TgZ(4,"ion-buttons",15)(5,"ion-button",4),v.NdJ("click",function(){v.CHM(Y);const Ge=v.oxw();return v.KtG(Ge.rotateImage())}),v._UZ(6,"ion-icon",16),v.TgZ(7,"ion-label"),v._uU(8,"Rotate"),v.qZA()()()(),v.TgZ(9,"ion-card-content")(10,"ion-list")(11,"ion-item")(12,"ion-label",17),v._uU(13,"Comment"),v.qZA(),v.TgZ(14,"ion-input",18),v.NdJ("ngModelChange",function(Ge){v.CHM(Y);const Ft=v.oxw();return v.KtG(Ft.comment=Ge)}),v.qZA()()(),v._UZ(15,"img",19),v.qZA()()}if(2&et){const Y=v.oxw();v.xp6(14),v.Q6J("ngModel",Y.comment)}}let Re=(()=>{class et{constructor(Y,me,Ge,Ft,gn){(0,x.Z)(this,"navParams",void 0),(0,x.Z)(this,"appManager",void 0),(0,x.Z)(this,"nav",void 0),(0,x.Z)(this,"modalController",void 0),(0,x.Z)(this,"logging",void 0),(0,x.Z)(this,"mode",void 0),(0,x.Z)(this,"processingQuality",void 0),(0,x.Z)(this,"imgData",void 0),(0,x.Z)(this,"targetWidth",void 0),(0,x.Z)(this,"targetHeight",void 0),(0,x.Z)(this,"comment",void 0),(0,x.Z)(this,"chargePointId",void 0),(0,x.Z)(this,"poi",void 0),this.navParams=Y,this.appManager=me,this.nav=Ge,this.modalController=Ft,this.logging=gn,this.processingQuality=.8,this.targetWidth=1024,this.targetHeight=800,this.mode=me.platformMode,this.chargePointId=this.navParams.get("id"),this.poi=this.navParams.get("poi"),this.comment=""}processNativeImageSource(Y){let me=Y;const Ge=document.getElementById("img-upload-canvas"),Ft=Ge.getContext("2d"),gn=new Image;gn.onload=()=>{this.logging.log("img load:"+gn.width),Ge.width=gn.width,Ge.height=gn.height,Ft.fillStyle="rgb(0,0,0)",Ft.fillRect(0,0,Ge.width,Ge.height),Ft.drawImage(gn,0,0,Ge.width,Ge.height),this.imgData=Ge.toDataURL("image/png"),this.processImage()},gn.src=me}loadCameraOrLibraryImage(Y=!1){this.logging.log("PWA mode: fetching image");const me=new FileReader;me.onload=()=>{this.imgData=me.result,this.processImage()},me.onerror=()=>{},me.readAsDataURL(document.getElementById("img-upload-media").files[0])}isBrowserMode(){return this.appManager.isPlatform("desktop")||this.appManager.isPlatform("hybrid")}processImage(){if(null!=this.imgData){const me=document.getElementById("img-upload-canvas"),Ge=me.getContext("2d"),Ft=new Image;Ft.onload=()=>{me.width=Ft.width,me.height=Ft.height,Ge.fillStyle="rgb(0,0,0)",Ge.fillRect(0,0,me.width,me.height),Ge.drawImage(Ft,0,0,me.width,me.height),this.refreshImageFromCanvas()},Ft.src=this.imgData}else this.logging.log("processImage: nothing to process.")}refreshImageFromCanvas(){const Y=document.getElementById("img-upload-canvas");this.imgData=Y.toDataURL("image/jpeg",.8),document.getElementById("preview").src=this.imgData}rotateImage(){const Y=document.getElementById("img-upload-canvas");let me=new Image;me.src=Y.toDataURL(),me.onload=()=>{let Ge=Y.height,Ft=Y.width;Y.width=Ge,Y.height=Ft,Ge=Y.height,Ft=Y.width;const gn=Y.getContext("2d");gn.save(),gn.translate(Ft,Ge/Ft),gn.rotate(Math.PI/2),gn.drawImage(me,0,0),gn.restore(),me=null,this.refreshImageFromCanvas()}}performUpload(){var Y=this;return(0,Q.Z)(function*(){if(!Y.imgData)return void(yield Y.appManager.showToastNotification("Select an image to upload."));const me={chargePointID:Y.chargePointId,comment:Y.comment,imageDataBase64:Y.imgData};yield Y.appManager.showLoadingProgress("Uploading photo..");try{yield Y.appManager.submitMediaItem(me),Y.appManager.dismissLoadingProgress().then(()=>{Y.appManager.showToastNotification("Upload completed"),Y.modalController.dismiss()}),Y.appManager.analytics.appEvent("MediaUpload","Completed")}catch{yield Y.appManager.dismissLoadingProgress(),yield Y.appManager.showToastNotification("Upload failed, please try again."),Y.appManager.analytics.appEvent("MediaUpload","Failed")}})()}cancel(){var Y=this;return(0,Q.Z)(function*(){yield Y.modalController.dismiss()})()}}return(0,x.Z)(et,"\u0275fac",function(Y){return new(Y||et)(v.Y36(s.X1),v.Y36(d.c),v.Y36(s.SH),v.Y36(s.IN),v.Y36(_e.z))}),(0,x.Z)(et,"\u0275cmp",v.Xpm({type:et,selectors:[["ng-component"]],decls:32,vars:3,consts:[[1,"media-upload"],[1,"ion-padding"],[1,"banner"],[1,"upload"],[3,"click"],["name","camera","aria-label","camera","slot","start"],["type","file","required","","id","img-upload-media",3,"change"],["inputFile",""],["id","img-upload-canvas",2,"display","none","width","500","height","500","border","1px solid red"],[4,"ngIf"],["slot","secondary"],["name","close","slot","start"],["slot","primary"],["name","send","slot","end"],["slot","start"],["slot","end"],["name","refresh","slot","start"],["position","floating"],["type","text","placeholder","(optional comment)",3,"ngModel","ngModelChange"],["id","preview",2,"max-width","500px"]],template:function(Y,me){if(1&Y){const Ge=v.EpF();v.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),v._uU(3," Share Photo "),v.qZA()()(),v.TgZ(4,"ion-content",0)(5,"div",1)(6,"div",2)(7,"h1"),v._uU(8),v.qZA(),v.TgZ(9,"p"),v._uU(10),v.qZA()(),v.TgZ(11,"p"),v._uU(12,"You can upload a photo from your device or take a new photo: "),v.qZA(),v.TgZ(13,"div",3)(14,"ion-button",4),v.NdJ("click",function(){v.CHM(Ge);const gn=v.MAs(19);return v.KtG(gn.click())}),v._UZ(15,"ion-icon",5),v.TgZ(16,"ion-label"),v._uU(17,"Choose Photo.."),v.qZA()(),v.TgZ(18,"input",6,7),v.NdJ("change",function(){return me.loadCameraOrLibraryImage()}),v.qZA()(),v._UZ(20,"canvas",8),v.YNc(21,be,16,1,"ion-card",9),v.qZA()(),v.TgZ(22,"ion-footer")(23,"ion-toolbar")(24,"ion-buttons",10)(25,"ion-button",4),v.NdJ("click",function(){return me.cancel()}),v._UZ(26,"ion-icon",11),v._uU(27," Cancel "),v.qZA()(),v.TgZ(28,"ion-buttons",12)(29,"ion-button",4),v.NdJ("click",function(){return me.performUpload()}),v._uU(30," Upload "),v._UZ(31,"ion-icon",13),v.qZA()()()()}2&Y&&(v.xp6(8),v.Oqu(me.poi.AddressInfo.Title),v.xp6(2),v.Oqu(me.poi.AddressInfo.AddressLine1),v.xp6(11),v.Q6J("ngIf",null!=me.imgData))},dependencies:[y.O5,fe.JJ,fe.On,s.YG,s.Sm,s.PM,s.FN,s.W2,s.fr,s.Gu,s.gu,s.pK,s.Ie,s.Q$,s.q_,s.wd,s.sr,s.j9],styles:[".upload[_ngcontent-%COMP%]   input[type=file][_ngcontent-%COMP%]{position:fixed;top:-1000px}"]})),et})();var Ne=R(2125);function qe(et,Ue){if(1&et&&(v.TgZ(0,"ion-select-option",19),v._uU(1),v.qZA()),2&et){const Y=Ue.$implicit;v.Q6J("value",Y.ID),v.xp6(1),v.Oqu(Y.Title)}}function _t(et,Ue){if(1&et&&(v.TgZ(0,"ion-select-option",19),v._uU(1),v.qZA()),2&et){const Y=Ue.$implicit;v.Q6J("value",Y.ID),v.xp6(1),v.Oqu(Y.Title)}}let Je=(()=>{class et{constructor(Y,me,Ge,Ft,gn,ei,wi,Ii){(0,x.Z)(this,"navParams",void 0),(0,x.Z)(this,"appManager",void 0),(0,x.Z)(this,"nav",void 0),(0,x.Z)(this,"zone",void 0),(0,x.Z)(this,"loadingController",void 0),(0,x.Z)(this,"modalController",void 0),(0,x.Z)(this,"logging",void 0),(0,x.Z)(this,"router",void 0),(0,x.Z)(this,"commentModel",void 0),(0,x.Z)(this,"poi",void 0),(0,x.Z)(this,"commentTypes",void 0),(0,x.Z)(this,"checkinTypes",void 0),this.navParams=Y,this.appManager=me,this.nav=Ge,this.zone=Ft,this.loadingController=gn,this.modalController=ei,this.logging=wi,this.router=Ii,this.commentModel={ChargePointID:this.navParams.get("id"),Comment:"",CheckinStatusTypeID:10,CommentTypeID:10,Rating:null},this.poi=this.navParams.get("poi"),this.commentTypes=me.referenceDataManager.getCommentTypes(!0,!0),this.checkinTypes=me.referenceDataManager.getCheckinStatusTypes(!0,!0)}onPageWillEnter(){}cancel(){this.modalController.dismiss()}add(){var Y=this;return(0,Q.Z)(function*(){const me=yield Y.loadingController.create({message:"Sending .."});yield me.present(),(yield Y.appManager.submitComment(Y.commentModel).catch(Ft=>{Y.appManager.showToastNotification("There was a problem submitting your comment."),Y.loadingController.dismiss(),Y.appManager.analytics.appEvent("Comment","Failed")}))&&(Y.logging.log("Comment submitted"),yield me.dismiss(),yield Y.modalController.dismiss(),Y.appManager.analytics.appEvent("Comment","Submitted"))})()}}return(0,x.Z)(et,"\u0275fac",function(Y){return new(Y||et)(v.Y36(s.X1),v.Y36(d.c),v.Y36(s.SH),v.Y36(v.R0b),v.Y36(s.HT),v.Y36(s.IN),v.Y36(_e.z),v.Y36(Ne.F0))}),(0,x.Z)(et,"\u0275cmp",v.Xpm({type:et,selectors:[["ng-component"]],decls:53,vars:8,consts:[["color","primary"],[1,"comment-page","ion-padding"],[1,"banner"],[1,"ion-padding"],["position","stacked"],[3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["type","text","placeholder","(optional comment)",3,"ngModel","ngModelChange"],["value","5"],["value","4"],["value","3"],["value","2"],["value","1"],["value",""],["slot","secondary"],[3,"click"],["name","close","slot","start"],["slot","primary"],["name","send","slot","end"],[3,"value"]],template:function(Y,me){1&Y&&(v.TgZ(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-title"),v._uU(3," Add Comment "),v.qZA()()(),v.TgZ(4,"ion-content",1)(5,"div",2)(6,"h1"),v._uU(7),v.qZA(),v.TgZ(8,"p"),v._uU(9),v.qZA()(),v.TgZ(10,"p",3),v._uU(11,"Recent Check-ins are a big help to other drivers when planning their journey. Tell everyone what you thought about this charging location. "),v.qZA(),v.TgZ(12,"ion-list")(13,"ion-item")(14,"ion-label",4),v._uU(15,"Comment Type"),v.qZA(),v.TgZ(16,"ion-select",5),v.NdJ("ngModelChange",function(Ft){return me.commentModel.CommentTypeID=Ft}),v.YNc(17,qe,2,2,"ion-select-option",6),v.qZA()(),v.TgZ(18,"ion-item")(19,"ion-label",4),v._uU(20,"What Did You Think?"),v.qZA(),v.TgZ(21,"ion-input",7),v.NdJ("ngModelChange",function(Ft){return me.commentModel.Comment=Ft}),v.qZA()(),v.TgZ(22,"ion-item")(23,"ion-label",4),v._uU(24,"Did You Successfully Charge?"),v.qZA(),v.TgZ(25,"ion-select",5),v.NdJ("ngModelChange",function(Ft){return me.commentModel.CheckinStatusTypeID=Ft}),v.YNc(26,_t,2,2,"ion-select-option",6),v.qZA()(),v.TgZ(27,"ion-item")(28,"ion-label",4),v._uU(29,"Your Rating"),v.qZA(),v.TgZ(30,"ion-select",5),v.NdJ("ngModelChange",function(Ft){return me.commentModel.Rating=Ft}),v.TgZ(31,"ion-select-option",8),v._uU(32,"5 - Excellent"),v.qZA(),v.TgZ(33,"ion-select-option",9),v._uU(34,"4 - Good"),v.qZA(),v.TgZ(35,"ion-select-option",10),v._uU(36,"3 - Average"),v.qZA(),v.TgZ(37,"ion-select-option",11),v._uU(38,"2 - Not Good"),v.qZA(),v.TgZ(39,"ion-select-option",12),v._uU(40,"1 - Bad"),v.qZA(),v.TgZ(41,"ion-select-option",13),v._uU(42,"Not Rated"),v.qZA()()()()(),v.TgZ(43,"ion-footer")(44,"ion-toolbar")(45,"ion-buttons",14)(46,"ion-button",15),v.NdJ("click",function(){return me.cancel()}),v._UZ(47,"ion-icon",16),v._uU(48," Cancel "),v.qZA()(),v.TgZ(49,"ion-buttons",17)(50,"ion-button",15),v.NdJ("click",function(){return me.add()}),v._uU(51," Submit "),v._UZ(52,"ion-icon",18),v.qZA()()()()),2&Y&&(v.xp6(7),v.Oqu(me.poi.AddressInfo.Title),v.xp6(2),v.Oqu(me.poi.AddressInfo.AddressLine1),v.xp6(7),v.Q6J("ngModel",me.commentModel.CommentTypeID),v.xp6(1),v.Q6J("ngForOf",me.commentTypes),v.xp6(4),v.Q6J("ngModel",me.commentModel.Comment),v.xp6(4),v.Q6J("ngModel",me.commentModel.CheckinStatusTypeID),v.xp6(1),v.Q6J("ngForOf",me.checkinTypes),v.xp6(4),v.Q6J("ngModel",me.commentModel.Rating))},dependencies:[y.sg,fe.JJ,fe.On,s.YG,s.Sm,s.W2,s.fr,s.Gu,s.gu,s.pK,s.Ie,s.Q$,s.q_,s.t9,s.n0,s.wd,s.sr,s.QI,s.j9],encapsulation:2})),et})();var Me=R(7777),it=R(4669),Xe=R(8767),Te=R(8804),ae=R(866),yt=R(3999),we=R(1163);function Ze(et,Ue){if(1&et&&(v.TgZ(0,"div")(1,"small"),v._uU(2),v.qZA()()),2&et){const Y=v.oxw(2);v.xp6(2),v.Oqu(Y.connectionSummary)}}function Ae(et,Ue){if(1&et&&(v.TgZ(0,"div")(1,"small"),v._uU(2),v.qZA()()),2&et){const Y=v.oxw(2);v.xp6(2),v.Oqu(Y.poi.OperatorInfo.Title)}}function ve(et,Ue){if(1&et){const Y=v.EpF();v.ynx(0),v.TgZ(1,"ion-button",28),v.NdJ("click",function(){v.CHM(Y);const Ge=v.oxw(2);return v.KtG(Ge.addFavourite())}),v._UZ(2,"ion-icon",29),v.TgZ(3,"ion-label"),v._uU(4,"Favourite"),v.qZA()(),v.TgZ(5,"ion-button",13),v.NdJ("click",function(){v.CHM(Y);const Ge=v.oxw(2);return v.KtG(Ge.edit())}),v._UZ(6,"ion-icon",30),v.TgZ(7,"ion-label"),v._uU(8,"Edit"),v.qZA()(),v.BQk()}}function en(et,Ue){if(1&et){const Y=v.EpF();v.ynx(0),v.TgZ(1,"ion-button",31),v.NdJ("click",function(){v.CHM(Y);const Ge=v.oxw(2);return v.KtG(Ge.launchNavigation())}),v._UZ(2,"ion-icon",32),v.TgZ(3,"ion-label"),v._uU(4,"Navigate"),v.qZA()(),v.BQk()}}function dt(et,Ue){if(1&et){const Y=v.EpF();v.ynx(0),v.TgZ(1,"ion-button",33),v.NdJ("click",function(){v.CHM(Y);const Ge=v.oxw(2);return v.KtG(Ge.addComment())}),v._UZ(2,"ion-icon",34),v.TgZ(3,"ion-label"),v._uU(4,"Add Comment"),v.qZA()(),v.BQk()}}function mt(et,Ue){if(1&et){const Y=v.EpF();v.ynx(0),v.TgZ(1,"ion-button",35),v.NdJ("click",function(){v.CHM(Y);const Ge=v.oxw(2);return v.KtG(Ge.addMedia())}),v._UZ(2,"ion-icon",36),v.TgZ(3,"ion-label"),v._uU(4," Add Photo"),v.qZA()(),v.BQk()}}function lt(et,Ue){if(1&et&&(v.TgZ(0,"div"),v._uU(1),v.qZA()),2&et){const Y=v.oxw(4);v.xp6(1),v.hij(" ",Y.poi.AddressInfo.AddressLine1,"")}}function ze(et,Ue){if(1&et&&(v.TgZ(0,"div"),v._uU(1),v.qZA()),2&et){const Y=v.oxw(4);v.xp6(1),v.hij(" ",Y.poi.AddressInfo.AddressLine2,"")}}function xt(et,Ue){if(1&et&&(v.TgZ(0,"div"),v._uU(1),v.qZA()),2&et){const Y=v.oxw(4);v.xp6(1),v.hij(" ",Y.poi.AddressInfo.Town,"")}}function Ve(et,Ue){if(1&et&&(v.TgZ(0,"div"),v._uU(1),v.qZA()),2&et){const Y=v.oxw(4);v.xp6(1),v.hij(" ",Y.poi.AddressInfo.StateOrProvince,"")}}function gt(et,Ue){if(1&et&&(v.TgZ(0,"div"),v._uU(1),v.qZA()),2&et){const Y=v.oxw(4);v.xp6(1),v.hij(" ",Y.poi.AddressInfo.Postcode,"")}}function Be(et,Ue){if(1&et&&(v.TgZ(0,"div"),v._uU(1),v.qZA()),2&et){const Y=v.oxw(4);v.xp6(1),v.hij(" ",Y.poi.AddressInfo.Country.Title,"")}}function Bt(et,Ue){if(1&et&&(v.TgZ(0,"p"),v._uU(1),v.qZA()),2&et){const Y=v.oxw(4);v.xp6(1),v.hij(" ",Y.poi.AddressInfo.AccessComments," ")}}function Wt(et,Ue){if(1&et&&(v.TgZ(0,"p"),v._UZ(1,"ion-icon",48),v.TgZ(2,"span",45),v._uU(3),v.qZA()()),2&et){const Y=v.oxw(4);v.xp6(3),v.Oqu(Y.poi.AddressInfo.ContactTelephone1)}}function wn(et,Ue){if(1&et&&(v.TgZ(0,"p"),v._UZ(1,"ion-icon",48),v.TgZ(2,"span",45),v._uU(3),v.qZA()()),2&et){const Y=v.oxw(4);v.xp6(3),v.Oqu(Y.poi.AddressInfo.ContactTelephone2)}}function Xt(et,Ue){if(1&et&&(v.TgZ(0,"p"),v._UZ(1,"ion-icon",49),v.TgZ(2,"span",45),v._uU(3),v.qZA()()),2&et){const Y=v.oxw(4);v.xp6(3),v.Oqu(Y.poi.AddressInfo.ContactEmail)}}function mn(et,Ue){if(1&et&&(v.TgZ(0,"p"),v._UZ(1,"ion-icon",50),v.TgZ(2,"span",45)(3,"a",51),v._uU(4),v.qZA()()()),2&et){const Y=v.oxw(4);v.xp6(3),v.s9C("href",Y.poi.AddressInfo.RelatedURL,v.LSH),v.xp6(1),v.Oqu(Y.poi.AddressInfo.RelatedURL)}}function an(et,Ue){if(1&et&&(v.TgZ(0,"ion-card")(1,"ion-card-header"),v._UZ(2,"ion-icon",43),v._uU(3),v.ALo(4,"translate"),v.qZA(),v.TgZ(5,"ion-card-content")(6,"ion-grid")(7,"ion-row")(8,"ion-col")(9,"ion-label",44),v._uU(10),v.ALo(11,"translate"),v.qZA(),v.TgZ(12,"div",45),v.YNc(13,lt,2,1,"div",0),v.YNc(14,ze,2,1,"div",0),v.YNc(15,xt,2,1,"div",0),v.YNc(16,Ve,2,1,"div",0),v.YNc(17,gt,2,1,"div",0),v.YNc(18,Be,2,1,"div",0),v.qZA()(),v.TgZ(19,"ion-col"),v.YNc(20,Bt,2,1,"p",0),v.YNc(21,Wt,4,1,"p",0),v.YNc(22,wn,4,1,"p",0),v.YNc(23,Xt,4,1,"p",0),v.YNc(24,mn,5,2,"p",0),v.qZA()(),v.TgZ(25,"ion-row")(26,"ion-col"),v._UZ(27,"ion-icon",46),v.TgZ(28,"ion-label",47),v._uU(29),v.ALo(30,"number"),v.ALo(31,"number"),v.qZA()()()()()()),2&et){const Y=v.oxw(3);v.xp6(3),v.hij(" ",v.lcZ(4,15,"ocm.details.location.sectionTitle")," "),v.xp6(7),v.hij(" ",v.lcZ(11,17,"ocm.details.location.address"),""),v.xp6(3),v.Q6J("ngIf",Y.poi.AddressInfo.AddressLine1),v.xp6(1),v.Q6J("ngIf",Y.poi.AddressInfo.AddressLine2),v.xp6(1),v.Q6J("ngIf",Y.poi.AddressInfo.Town),v.xp6(1),v.Q6J("ngIf",Y.poi.AddressInfo.StateOrProvince),v.xp6(1),v.Q6J("ngIf",Y.poi.AddressInfo.Postcode),v.xp6(1),v.Q6J("ngIf",Y.poi.AddressInfo.Country),v.xp6(2),v.Q6J("ngIf",Y.poi.AddressInfo.AccessComments),v.xp6(1),v.Q6J("ngIf",Y.poi.AddressInfo.ContactTelephone1),v.xp6(1),v.Q6J("ngIf",Y.poi.AddressInfo.ContactTelephone2),v.xp6(1),v.Q6J("ngIf",Y.poi.AddressInfo.ContactEmail),v.xp6(1),v.Q6J("ngIf",Y.poi.AddressInfo.RelatedURL),v.xp6(5),v.AsE(" ",v.xi3(30,19,Y.poi.AddressInfo.Latitude,"1.1-13")," , ",v.xi3(31,22,Y.poi.AddressInfo.Longitude,"1.1-13")," ")}}function Vt(et,Ue){if(1&et&&(v.TgZ(0,"p")(1,"span",44),v._uU(2),v.ALo(3,"translate"),v.qZA(),v.TgZ(4,"span",45),v._uU(5),v.qZA()()),2&et){const Y=v.oxw(3);v.xp6(2),v.hij("",v.lcZ(3,2,"ocm.details.numberOfPoints"),":"),v.xp6(3),v.Oqu(Y.poi.NumberOfPoints)}}function St(et,Ue){if(1&et&&(v.TgZ(0,"p")(1,"span",44),v._uU(2),v.ALo(3,"translate"),v.qZA(),v.TgZ(4,"span",45),v._uU(5),v.qZA()()),2&et){const Y=v.oxw(3);v.xp6(2),v.hij("",v.lcZ(3,2,"ocm.details.operationalStatus"),":"),v.xp6(3),v.hij(" ",Y.poi.StatusType.Title," ")}}function st(et,Ue){if(1&et&&(v.TgZ(0,"p")(1,"span",44),v._uU(2),v.ALo(3,"translate"),v.qZA(),v.TgZ(4,"span",45),v._uU(5),v.qZA()()),2&et){const Y=v.oxw(3);v.xp6(2),v.hij("",v.lcZ(3,2,"ocm.details.usageType"),":"),v.xp6(3),v.Oqu(Y.poi.UsageType.Title)}}function qt(et,Ue){if(1&et&&(v.TgZ(0,"p")(1,"span",44),v._uU(2),v.ALo(3,"translate"),v.qZA(),v.TgZ(4,"span",45),v._uU(5),v.qZA()()),2&et){const Y=v.oxw(3);v.xp6(2),v.hij("",v.lcZ(3,2,"ocm.details.usageCost"),":"),v.xp6(3),v.hij(" ",Y.poi.UsageCost,"")}}function dn(et,Ue){if(1&et&&(v.TgZ(0,"p"),v._UZ(1,"br"),v._uU(2),v.ALo(3,"translate"),v._UZ(4,"br"),v.TgZ(5,"span",45),v._uU(6),v.qZA()()),2&et){const Y=v.oxw(3);v.xp6(2),v.hij("",v.lcZ(3,2,"ocm.details.generalComments"),": "),v.xp6(4),v.Oqu(Y.poi.GeneralComments)}}function Sn(et,Ue){if(1&et&&(v.TgZ(0,"p"),v._UZ(1,"ion-icon",54),v._uU(2),v.qZA()),2&et){const Y=v.oxw(4);v.xp6(2),v.hij(" ",Y.poi.OperatorInfo.WebsiteURL," ")}}function zt(et,Ue){if(1&et&&(v.TgZ(0,"p"),v._UZ(1,"ion-icon",49),v._uU(2),v.qZA()),2&et){const Y=v.oxw(4);v.xp6(2),v.hij(" ",Y.poi.OperatorInfo.ContactEmail," ")}}function gi(et,Ue){if(1&et&&(v.TgZ(0,"p"),v._UZ(1,"ion-icon",49),v._uU(2),v.qZA()),2&et){const Y=v.oxw(4);v.xp6(2),v.hij(" ",Y.poi.OperatorInfo.FaultReportEmail," ")}}function $i(et,Ue){if(1&et&&(v.TgZ(0,"ion-card")(1,"ion-card-header"),v._UZ(2,"ion-icon",52),v._uU(3),v.ALo(4,"translate"),v.qZA(),v.TgZ(5,"ion-card-content")(6,"div",45)(7,"p",53),v._uU(8),v.qZA(),v.YNc(9,Sn,3,1,"p",0),v.YNc(10,zt,3,1,"p",0),v.YNc(11,gi,3,1,"p",0),v.qZA()()()),2&et){const Y=v.oxw(3);v.xp6(3),v.hij(" ",v.lcZ(4,5,"ocm.details.operator.sectionTitle")," "),v.xp6(5),v.hij(" ",Y.poi.OperatorInfo.Title," "),v.xp6(1),v.Q6J("ngIf",Y.poi.OperatorInfo.WebsiteURL),v.xp6(1),v.Q6J("ngIf",null!=Y.poi.OperatorInfo.ContactEmail),v.xp6(1),v.Q6J("ngIf",null!=Y.poi.OperatorInfo.FaultReportEmail&&Y.poi.OperatorInfo.FaultReportEmail!=Y.poi.OperatorInfo.ContactEmail)}}function Ci(et,Ue){if(1&et){const Y=v.EpF();v.TgZ(0,"a",56),v.NdJ("click",function(){v.CHM(Y);const Ge=v.oxw(4);return v.KtG(Ge.launchURL(Ge.poi.DataProvider.WebsiteURL))}),v._uU(1),v.qZA()}if(2&et){const Y=v.oxw(4);v.xp6(1),v.Oqu(Y.poi.DataProvider.WebsiteURL)}}function Ji(et,Ue){if(1&et&&(v.TgZ(0,"div",45)(1,"h3"),v._uU(2),v.ALo(3,"translate"),v.qZA(),v.TgZ(4,"p"),v._uU(5),v.qZA(),v.YNc(6,Ci,2,1,"a",55),v.TgZ(7,"p"),v._uU(8),v.qZA()()),2&et){const Y=v.oxw(3);v.xp6(2),v.hij(" ",v.lcZ(3,4,"ocm.details.dataProvider.sectionTitle")," "),v.xp6(3),v.Oqu(null==Y.poi.DataProvider?null:Y.poi.DataProvider.Title),v.xp6(1),v.Q6J("ngIf",Y.poi.DataProvider.WebsiteURL),v.xp6(2),v.Oqu(null==Y.poi.DataProvider?null:Y.poi.DataProvider.License)}}function Hi(et,Ue){if(1&et&&(v.TgZ(0,"div",37),v.YNc(1,an,32,25,"ion-card",0),v.TgZ(2,"ion-card")(3,"ion-card-header"),v._UZ(4,"ion-icon",38),v._uU(5),v.ALo(6,"translate"),v.qZA(),v.TgZ(7,"ion-card-content"),v.YNc(8,Vt,6,4,"p",0),v._UZ(9,"app-equipment-details",39),v.qZA()(),v.TgZ(10,"ion-card")(11,"ion-card-header"),v._UZ(12,"ion-icon",40),v._uU(13," Usage Restrictions "),v.qZA(),v.TgZ(14,"ion-card-content"),v.YNc(15,St,6,4,"p",0),v.YNc(16,st,6,4,"p",0),v.YNc(17,qt,6,4,"p",0),v.YNc(18,dn,7,4,"p",0),v.qZA()(),v.YNc(19,$i,12,7,"ion-card",0),v.TgZ(20,"ion-card")(21,"ion-card-header"),v._UZ(22,"ion-icon",41),v._uU(23),v.ALo(24,"translate"),v.qZA(),v.TgZ(25,"ion-card-content"),v.YNc(26,Ji,9,6,"div",42),v.qZA()()()),2&et){const Y=v.oxw(2);v.xp6(1),v.Q6J("ngIf",Y.poi.AddressInfo),v.xp6(4),v.hij(" ",v.lcZ(6,11,"ocm.details.equipment.sectionTitle")," "),v.xp6(3),v.Q6J("ngIf",null!=Y.poi.NumberOfPoints),v.xp6(1),v.Q6J("item",Y.poi),v.xp6(6),v.Q6J("ngIf",null!=Y.poi.StatusType),v.xp6(1),v.Q6J("ngIf",null!=Y.poi.UsageType),v.xp6(1),v.Q6J("ngIf",null!=Y.poi.UsageCost),v.xp6(1),v.Q6J("ngIf",null!=Y.poi.GeneralComments),v.xp6(1),v.Q6J("ngIf",Y.poi.OperatorInfo),v.xp6(4),v.hij(" ",v.lcZ(24,13,"ocm.details.advancedDetails")," "),v.xp6(3),v.Q6J("ngIf",Y.poi.DataProvider)}}function Fi(et,Ue){if(1&et&&v._UZ(0,"img",60),2&et){const Y=v.oxw().$implicit;v.s9C("src",null==Y.User?null:Y.User.ProfileImageURL,v.LSH)}}function ii(et,Ue){if(1&et&&(v.TgZ(0,"span"),v._uU(1),v.qZA()),2&et){const Y=v.oxw().$implicit;v.xp6(1),v.Oqu(Y.User.Username)}}function mi(et,Ue){if(1&et&&(v.TgZ(0,"span"),v._uU(1),v.qZA()),2&et){const Y=v.oxw().$implicit;v.xp6(1),v.Oqu(Y.Username)}}function xn(et,Ue){if(1&et&&(v.TgZ(0,"p",45),v._uU(1),v.qZA()),2&et){const Y=v.oxw().$implicit;v.xp6(1),v.hij(" ",null==Y.CommentType?null:Y.CommentType.Title," ")}}function Qt(et,Ue){if(1&et&&(v.TgZ(0,"p")(1,"span",44),v._uU(2,"Rating:"),v.qZA(),v.TgZ(3,"span",45),v._uU(4),v.qZA()()),2&et){const Y=v.oxw().$implicit;v.xp6(4),v.hij("",Y.Rating," out of 5")}}function Mt(et,Ue){1&et&&(v.ynx(0),v._UZ(1,"ion-icon",61),v.BQk())}function ge(et,Ue){1&et&&(v.ynx(0),v._UZ(1,"ion-icon",62),v.BQk())}function ct(et,Ue){if(1&et&&(v.TgZ(0,"p"),v.YNc(1,Mt,2,0,"ng-container",0),v.YNc(2,ge,2,0,"ng-container",0),v._uU(3),v.qZA()),2&et){const Y=v.oxw().$implicit;v.xp6(1),v.Q6J("ngIf",!0===Y.CheckinStatusType.IsPositive),v.xp6(1),v.Q6J("ngIf",!1===Y.CheckinStatusType.IsPositive),v.xp6(1),v.hij(" ",Y.CheckinStatusType.Title," ")}}function Gt(et,Ue){if(1&et&&(v.TgZ(0,"ion-card")(1,"ion-item")(2,"ion-avatar",19),v.YNc(3,Fi,1,1,"img",59),v.qZA(),v.TgZ(4,"ion-label"),v.YNc(5,ii,2,1,"span",0),v.YNc(6,mi,2,1,"span",0),v.qZA(),v.TgZ(7,"ion-label",20),v._uU(8),v.ALo(9,"date"),v.qZA()(),v.TgZ(10,"ion-card-content")(11,"p"),v._uU(12),v.qZA(),v.YNc(13,xn,2,1,"p",42),v.YNc(14,Qt,5,1,"p",0),v.YNc(15,ct,4,3,"p",0),v.qZA()()),2&et){const Y=Ue.$implicit;v.xp6(3),v.Q6J("ngIf",Y.User&&Y.User.ProfileImageURL),v.xp6(2),v.Q6J("ngIf",Y.User),v.xp6(1),v.Q6J("ngIf",!Y.User),v.xp6(2),v.hij(" ",v.lcZ(9,8,Y.DateCreated)," "),v.xp6(4),v.Oqu(Y.Comment),v.xp6(1),v.Q6J("ngIf",10!=Y.CommentTypeID),v.xp6(1),v.Q6J("ngIf",Y.Rating),v.xp6(1),v.Q6J("ngIf",Y.CheckinStatusType)}}function pn(et,Ue){if(1&et&&(v.ynx(0),v.YNc(1,Gt,16,10,"ion-card",58),v.BQk()),2&et){const Y=v.oxw(3);v.xp6(1),v.Q6J("ngForOf",Y.poi.UserComments)}}function Gi(et,Ue){1&et&&(v.TgZ(0,"p",21),v._uU(1),v.ALo(2,"translate"),v.qZA()),2&et&&(v.xp6(1),v.hij(" ",v.lcZ(2,1,"ocm.details.commentsAndRatings.zeroComments")," "))}function ri(et,Ue){if(1&et&&(v.TgZ(0,"div"),v.YNc(1,pn,2,1,"ng-container",0),v.YNc(2,Gi,3,3,"p",57),v.qZA()),2&et){const Y=v.oxw(2);v.xp6(1),v.Q6J("ngIf",1==Y.poi._hasComments),v.xp6(1),v.Q6J("ngIf",0==Y.poi._hasComments)}}function Vo(et,Ue){if(1&et&&v._UZ(0,"img",60),2&et){const Y=v.oxw().$implicit;v.s9C("src",null==Y.User?null:Y.User.ProfileImageURL,v.LSH)}}function ut(et,Ue){if(1&et&&(v.TgZ(0,"span"),v._uU(1),v.qZA()),2&et){const Y=v.oxw().$implicit;v.xp6(1),v.Oqu(Y.User.Username)}}function pe(et,Ue){if(1&et&&(v.TgZ(0,"span"),v._uU(1),v.qZA()),2&et){const Y=v.oxw().$implicit;v.xp6(1),v.Oqu(Y.Username)}}function xe(et,Ue){if(1&et&&(v.TgZ(0,"ion-card"),v._UZ(1,"img",60),v.TgZ(2,"ion-item")(3,"ion-avatar",19),v.YNc(4,Vo,1,1,"img",59),v.qZA(),v.TgZ(5,"ion-label"),v.YNc(6,ut,2,1,"span",0),v.YNc(7,pe,2,1,"span",0),v.qZA(),v.TgZ(8,"ion-label",20),v._uU(9),v.ALo(10,"date"),v.qZA()(),v.TgZ(11,"ion-card-content")(12,"p"),v._uU(13),v.qZA()()()),2&et){const Y=Ue.$implicit;v.xp6(1),v.s9C("src",Y.ItemMediumURL,v.LSH),v.xp6(3),v.Q6J("ngIf",Y.User&&Y.User.ProfileImageURL),v.xp6(2),v.Q6J("ngIf",Y.User),v.xp6(1),v.Q6J("ngIf",!Y.User),v.xp6(2),v.hij(" ",v.lcZ(10,6,Y.DateCreated)," "),v.xp6(4),v.Oqu(Y.Comment)}}function Qe(et,Ue){if(1&et&&(v.TgZ(0,"div"),v.YNc(1,xe,14,8,"ion-card",58),v.qZA()),2&et){const Y=v.oxw(3);v.xp6(1),v.Q6J("ngForOf",Y.poi.MediaItems)}}function vt(et,Ue){1&et&&(v.TgZ(0,"div",21)(1,"p",63),v._uU(2),v.ALo(3,"translate"),v.qZA()()),2&et&&(v.xp6(2),v.hij(" ",v.lcZ(3,1,"ocm.details.mediaItems.addPrompt"),""))}function Lt(et,Ue){if(1&et&&(v.TgZ(0,"div"),v.YNc(1,Qe,2,1,"div",0),v.YNc(2,vt,4,3,"div",57),v.qZA()),2&et){const Y=v.oxw(2);v.xp6(1),v.Q6J("ngIf",Y.poi._hasPhotos),v.xp6(1),v.Q6J("ngIf",!Y.poi._hasPhotos)}}function Zt(et,Ue){if(1&et&&(v.TgZ(0,"p",64),v._uU(1),v.qZA()),2&et){const Y=v.oxw(2);v.xp6(1),v.hij(" ",Y.json,"")}}function jt(et,Ue){if(1&et){const Y=v.EpF();v.TgZ(0,"div")(1,"div",1)(2,"div",2)(3,"h2"),v._uU(4),v.qZA(),v.TgZ(5,"div")(6,"small"),v._uU(7),v.qZA()(),v.YNc(8,Ze,3,1,"div",0),v.YNc(9,Ae,3,1,"div",0),v.TgZ(10,"ion-badge",3),v._uU(11),v.ALo(12,"number"),v.qZA()(),v.TgZ(13,"ion-fab",4)(14,"ion-fab-button"),v._UZ(15,"ion-icon",5),v.qZA(),v.TgZ(16,"ion-fab-list",6)(17,"ion-fab-button",7),v.NdJ("click",function(){v.CHM(Y);const Ge=v.oxw();return v.KtG(Ge.addComment())}),v._UZ(18,"ion-icon",8),v.qZA(),v.TgZ(19,"ion-fab-button",9),v.NdJ("click",function(){v.CHM(Y);const Ge=v.oxw();return v.KtG(Ge.addMedia())}),v._UZ(20,"ion-icon",10),v.qZA(),v.TgZ(21,"ion-fab-button",11),v.NdJ("click",function(){v.CHM(Y);const Ge=v.oxw();return v.KtG(Ge.addFavourite())}),v._UZ(22,"ion-icon",12),v.qZA(),v.TgZ(23,"ion-fab-button",13),v.NdJ("click",function(){v.CHM(Y);const Ge=v.oxw();return v.KtG(Ge.edit())}),v._UZ(24,"ion-icon",14),v.qZA(),v.TgZ(25,"ion-fab-button",15),v.NdJ("click",function(){v.CHM(Y);const Ge=v.oxw();return v.KtG(Ge.refresh())}),v._UZ(26,"ion-icon",16),v.qZA()()()(),v.TgZ(27,"ion-refresher",17),v.NdJ("ionRefresh",function(Ge){v.CHM(Y);const Ft=v.oxw();return v.KtG(Ft.refresh(Ge))}),v._UZ(28,"ion-refresher-content",18),v.qZA(),v.TgZ(29,"ion-toolbar")(30,"ion-buttons",19),v.YNc(31,ve,9,0,"ng-container",0),v.qZA(),v.TgZ(32,"ion-buttons",20),v.YNc(33,en,5,0,"ng-container",0),v.YNc(34,dt,5,0,"ng-container",0),v.YNc(35,mt,5,0,"ng-container",0),v.qZA()(),v.TgZ(36,"div",21)(37,"ion-segment",22),v.NdJ("ngModelChange",function(Ge){v.CHM(Y);const Ft=v.oxw();return v.KtG(Ft.selectedTab=Ge)}),v.TgZ(38,"ion-segment-button",23)(39,"ion-label"),v._uU(40," Details "),v.qZA()(),v.TgZ(41,"ion-segment-button",24)(42,"ion-label"),v._uU(43),v.qZA()(),v.TgZ(44,"ion-segment-button",25)(45,"ion-label"),v._uU(46),v.qZA()()()(),v.YNc(47,Hi,27,15,"div",26),v.YNc(48,ri,3,2,"div",0),v.YNc(49,Lt,3,2,"div",0),v.YNc(50,Zt,2,1,"p",27),v.qZA()}if(2&et){const Y=v.oxw();v.xp6(1),v.Udp("background-image",Y.backdropImage?"url("+Y.backdropImage+")":""),v.xp6(3),v.hij(" ",Y.poi.AddressInfo.Title," "),v.xp6(3),v.hij("OCM-",Y.poi.ID,""),v.xp6(1),v.Q6J("ngIf",Y.connectionSummary),v.xp6(1),v.Q6J("ngIf",Y.poi.OperatorInfo),v.xp6(2),v.Oqu(v.xi3(12,18,Y.avgRating,"1.1-1")),v.xp6(20),v.Q6J("ngIf","location"==Y.selectedTab),v.xp6(2),v.Q6J("ngIf","location"==Y.selectedTab),v.xp6(1),v.Q6J("ngIf","comments"==Y.selectedTab),v.xp6(1),v.Q6J("ngIf","media"==Y.selectedTab),v.xp6(2),v.Q6J("ngModel",Y.selectedTab),v.xp6(6),v.hij("Comments (",Y.poi.UserComments?Y.poi.UserComments.length:0,")"),v.xp6(3),v.hij(" Photos (",Y.poi.MediaItems?Y.poi.MediaItems.length:0,")"),v.xp6(1),v.Q6J("ngIf","location"==Y.selectedTab),v.xp6(1),v.Q6J("ngIf","comments"==Y.selectedTab),v.xp6(1),v.Q6J("ngIf","media"==Y.selectedTab),v.xp6(1),v.Q6J("ngIf",1==Y.appManager.isDebugMode)}}function Pt(et,Ue){1&et&&(v.TgZ(0,"div")(1,"h2"),v._uU(2,"POI Not Found"),v.qZA(),v.TgZ(3,"p"),v._uU(4,"The POI details could not be loaded."),v.qZA()())}let Kt=(()=>{class et{constructor(Y,me,Ge,Ft,gn,ei,wi,Ii){(0,x.Z)(this,"appManager",void 0),(0,x.Z)(this,"nav",void 0),(0,x.Z)(this,"translate",void 0),(0,x.Z)(this,"logging",void 0),(0,x.Z)(this,"modalController",void 0),(0,x.Z)(this,"actionSheetController",void 0),(0,x.Z)(this,"poiManager",void 0),(0,x.Z)(this,"router",void 0),(0,x.Z)(this,"poi",void 0),(0,x.Z)(this,"selectedTab",void 0),(0,x.Z)(this,"json",void 0),(0,x.Z)(this,"hasNavBar",!1),(0,x.Z)(this,"backdropImage",void 0),(0,x.Z)(this,"avgRating",void 0),(0,x.Z)(this,"connectionSummary",void 0),this.appManager=Y,this.nav=me,this.translate=Ge,this.logging=Ft,this.modalController=gn,this.actionSheetController=ei,this.poiManager=wi,this.router=Ii}ngOnChanges(Y){if(this.logging.log("In ngOnChanges of POI Details"),null!=this.poi&&null!=this.poi.AddressInfo){if(this.selectedTab="location",null!=this.poi.MediaItems&&this.poi.MediaItems.length>0){this.poi._hasPhotos=!0;for(let me of this.poi.MediaItems)me.ItemMediumURL=me.ItemThumbnailURL.replace(".thmb.",".medi.");this.backdropImage=this.poi.MediaItems[this.poi.MediaItems.length-1].ItemThumbnailURL.replace(".thmb.",".medi.")}else this.poi._hasPhotos=!1,this.backdropImage=null;if(null!=this.poi.UserComments&&this.poi.UserComments.length>0){this.poi._hasComments=!0;try{let me=this.poi.UserComments.filter(Ge=>Ge.Rating>0);if(me.length>0){let Ge=0;for(let Ft of me)Ge+=Ft.Rating;this.avgRating=Ge/me.length}else this.avgRating=null}catch{}}else this.poi._hasComments=!1;if(this.poi.Connections&&this.poi.Connections.length>0){let me="";for(let Ge of this.poi.Connections)-1==me.indexOf(Ge.ConnectionType.Title)&&(me+=(""!=me?", ":"")+Ge.ConnectionType.Title);this.connectionSummary=me}}}ngOnInit(){this.logging.log("In ngInit of POI Details")}get staticMapURL(){return"https://maps.googleapis.com/maps/api/staticmap?key="+(new Me.X).googleMapsAPIKey+"&center="+this.poi.AddressInfo.Latitude+","+this.poi.AddressInfo.Longitude+"&zoom=13&scale=2&size="+this.staticMapSize+"&maptype=roadmap&format=jpg&visual_refresh=true&markers=size:small%7Ccolor:0xff0000%7Clabel:%7C"+this.poi.AddressInfo.Latitude+","+this.poi.AddressInfo.Longitude}get staticMapSize(){return 0===this.appManager.clientWidth?"240x100":this.appManager.clientWidth>=800?"640x100":this.appManager.clientWidth>=400?"400x100":"240x100"}continueAddComment(){var Y=this;return(0,Q.Z)(function*(){const me=yield Y.modalController.create({component:Je,componentProps:{id:Y.poi.ID,poi:Y.poi}});setTimeout(()=>{Y.refresh()},1e3),yield me.present()})()}addComment(){var Y=this;return(0,Q.Z)(function*(){if(Y.appManager.isUserAuthenticated(!0))yield Y.continueAddComment();else{const me=yield Y.modalController.create({component:Xe.F});me.onDidDismiss().then((0,Q.Z)(function*(){Y.appManager.isUserAuthenticated(!0)&&(yield Y.continueAddComment())})),yield me.present()}})()}continueAddMedia(){var Y=this;return(0,Q.Z)(function*(){const me=yield Y.modalController.create({component:Re,componentProps:{id:Y.poi.ID,poi:Y.poi}});me.onDidDismiss().then(()=>{setTimeout(()=>{Y.refresh()},1e3)}),yield me.present()})()}addMedia(){var Y=this;return(0,Q.Z)(function*(){if(Y.appManager.isUserAuthenticated(!0))yield Y.continueAddMedia();else{const me=yield Y.modalController.create({component:Xe.F});me.onDidDismiss().then((0,Q.Z)(function*(){Y.appManager.isUserAuthenticated(!0)&&(yield Y.continueAddMedia())})),yield me.present()}})()}addFavourite(){var Y=this;return(0,Q.Z)(function*(){yield(yield Y.actionSheetController.create({header:"Add Favourite",buttons:[{text:"Add to Journey",handler:()=>{Y.modalController.create({component:Ee,componentProps:{poi:Y.poi}}).then(Ge=>Ge.present())}},{text:"Cancel",role:"cancel",handler:()=>{}}]})).present()})()}launchNavigation(){this.appManager.isPlatform("ios")?this.appManager.launchWebPage("https://maps.apple.com/?ll="+this.poi.AddressInfo.Latitude+","+this.poi.AddressInfo.Longitude):this.appManager.launchWebPage("https://maps.google.com/?q="+this.poi.AddressInfo.Latitude+","+this.poi.AddressInfo.Longitude)}launchURL(Y){this.appManager.launchWebPage(Y)}continueEdit(){var Y=this;return(0,Q.Z)(function*(){const me=yield Y.modalController.create({component:Te.Y,componentProps:{id:Y.poi.ID}});return me.onDidDismiss().then(Ge=>{Y.refresh()}),yield me.present()})()}edit(){var Y=this;return(0,Q.Z)(function*(){if(ae.c.isFeatureEnabled("EDIT_POI"))if(Y.appManager.isUserAuthenticated(!0))yield Y.continueEdit();else{const me=yield Y.modalController.create({component:Xe.F});me.onDidDismiss().then((0,Q.Z)(function*(){Y.appManager.isUserAuthenticated(!0)&&(yield Y.continueEdit())})),yield me.present()}else Y.appManager.launchOCMWebPage("/poi/edit/"+Y.poi.ID)})()}refresh(Y=null){this.poi&&this.poiManager.getPOIById(this.poi.ID,!0,!0).then(me=>{me&&(this.poi=me,this.ngOnChanges(null)),Y&&Y.target.complete()})}}return(0,x.Z)(et,"\u0275fac",function(Y){return new(Y||et)(v.Y36(d.c),v.Y36(s.SH),v.Y36(yt.sK),v.Y36(_e.z),v.Y36(s.IN),v.Y36(s.BX),v.Y36(it.R),v.Y36(Ne.F0))}),(0,x.Z)(et,"\u0275cmp",v.Xpm({type:et,selectors:[["poi-details"]],inputs:{poi:"poi"},features:[v.TTD],decls:2,vars:2,consts:[[4,"ngIf"],[1,"banner"],[1,"banner-content"],["color","primary","title","Average User Rating"],["vertical","top","horizontal","end","slot","fixed"],["name","add"],["side","bottom"],["title","Add a comment or charging check-in",3,"click"],["name","chatbubbles"],["title","Add a Photo",3,"click"],["name","camera"],["title","Add to Favourites",3,"click"],["name","star"],["title","Submit an Edit",3,"click"],["name","create"],["title","Refresh",3,"click"],["name","refresh"],["slot","fixed",3,"ionRefresh"],["pullingIcon","caret-down","pullingText","Pull to refresh","refreshingSpinner","circles","refreshingText","Refreshing..."],["slot","start"],["slot","end"],[1,"ion-padding"],[3,"ngModel","ngModelChange"],["value","location","selected",""],["value","comments"],["value","media"],["class","address-details",4,"ngIf"],["style","white-space: pre-wrap;",4,"ngIf"],["size","small","title","Add to Favourites",3,"click"],["name","star","slot","start"],["name","create","slot","start"],[3,"click"],["name","navigate","slot","start"],["size","small","title","Add a comment or charging check-in",3,"click"],["name","chatbubbles","slot","start"],["size","small","title","Add a Photo",3,"click"],["name","camera","slot","start"],[1,"address-details"],["name","battery-charging"],[3,"item"],["name","book"],["name","information-circle"],["class","details",4,"ngIf"],["name","map"],[1,"label"],[1,"details"],["name","pin"],[1,"details-minor"],["name","call"],["name","mail"],["name","globe"],["target","_system",3,"href"],["name","help-circle"],[1,"ion-padding-left"],["name","link"],["href","javascript:void(0)",3,"click",4,"ngIf"],["href","javascript:void(0)",3,"click"],["class","ion-padding",4,"ngIf"],[4,"ngFor","ngForOf"],[3,"src",4,"ngIf"],[3,"src"],["name","checkmark-circle","color","success",2,"font-size","2em"],["name","close-circle","color","danger"],[1,"subtle"],[2,"white-space","pre-wrap"]],template:function(Y,me){1&Y&&(v.YNc(0,jt,51,21,"div",0),v.YNc(1,Pt,5,0,"div",0)),2&Y&&(v.Q6J("ngIf",null!=me.poi&&null!=me.poi.AddressInfo),v.xp6(1),v.Q6J("ngIf",null==me.poi||null==me.poi.AddressInfo))},dependencies:[y.sg,y.O5,s.BJ,s.yp,s.YG,s.Sm,s.PM,s.FN,s.Zi,s.wI,s.IJ,s.W4,s.zq,s.jY,s.gu,s.Ie,s.Q$,s.nJ,s.Wo,s.Nd,s.cJ,s.GO,s.sr,s.QI,fe.JJ,fe.On,we.B,y.JJ,y.uU,yt.X$],styles:[".banner[_ngcontent-%COMP%]{background-color:#4f712f;color:#ffffffec;padding:1em;text-shadow:#000 1px 1px 1px;min-height:180px;background-size:cover}.banner[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0}.banner-content[_ngcontent-%COMP%]{padding-right:48px}h3[_ngcontent-%COMP%]{font-weight:700}.label[_ngcontent-%COMP%]{color:#000;font-weight:700;font-size:12px}.details[_ngcontent-%COMP%]{color:#707d61;margin-left:1em;font-size:12px}.details-minor[_ngcontent-%COMP%]{color:#707d61;font-size:12px}p[_ngcontent-%COMP%]{display:block;padding:4px}ion-card-header[_ngcontent-%COMP%]{font-weight:700;padding-bottom:0}ion-card-content[_ngcontent-%COMP%]{padding-top:4px}"]})),et})(),In=(()=>{class et{constructor(Y,me,Ge){(0,x.Z)(this,"modalController",void 0),(0,x.Z)(this,"navParams",void 0),(0,x.Z)(this,"appManager",void 0),(0,x.Z)(this,"poi",void 0),(0,x.Z)(this,"hasNavbar",!1),this.modalController=Y,this.navParams=me,this.appManager=Ge,this.poi=this.navParams.get("item"),this.appManager.analytics.viewEvent("POIDetails")}close(){this.modalController.dismiss()}}return(0,x.Z)(et,"\u0275fac",function(Y){return new(Y||et)(v.Y36(s.IN),v.Y36(s.X1),v.Y36(d.c))}),(0,x.Z)(et,"\u0275cmp",v.Xpm({type:et,selectors:[["ng-component"]],decls:11,vars:3,consts:[["color","primary"],["slot","start"],[3,"click"],["name","close","slot","icon-only"],[1,"poi-details"],[3,"poi"]],template:function(Y,me){1&Y&&(v.TgZ(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-title"),v._uU(3),v.TgZ(4,"small"),v._uU(5),v.qZA()(),v.TgZ(6,"ion-buttons",1)(7,"ion-button",2),v.NdJ("click",function(){return me.close()}),v._UZ(8,"ion-icon",3),v.qZA()()()(),v.TgZ(9,"ion-content",4),v._UZ(10,"poi-details",5),v.qZA()),2&Y&&(v.xp6(3),v.hij(" ",me.poi.AddressInfo.Title," "),v.xp6(2),v.hij("OCM-",me.poi.ID,""),v.xp6(5),v.Q6J("poi",me.poi))},dependencies:[s.YG,s.Sm,s.W2,s.Gu,s.gu,s.wd,s.sr,Kt],styles:['.left-col[_ngcontent-%COMP%]{float:left;width:50%;overflow:auto}.right-col[_ngcontent-%COMP%]{float:right;width:50%;overflow:auto}.row[_ngcontent-%COMP%]:after{content:"";display:table;clear:both;overflow:auto}.row[_ngcontent-%COMP%]{margin-bottom:1em}.subtle[_ngcontent-%COMP%]{color:silver}@media screen and (max-width: 768px){.left-col[_ngcontent-%COMP%]{float:none;width:100%}.right-col[_ngcontent-%COMP%]{margin-top:1em;float:none;width:100%}}.address-details[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-height:200px;width:auto}ion-label[_ngcontent-%COMP%]{overflow:inherit}ion-title[_ngcontent-%COMP%] > small[_ngcontent-%COMP%]{color:#ffffffbf}']})),et})()},5722:(zn,Dt,R)=>{"use strict";R.r(Dt),R.d(Dt,{PoiEditorPageModule:()=>De});var x=R(1180),d=R(6814),v=R(6223),s=R(2125),Q=R(7852),ie=R(8804),q=R(3999),y=R(5086),fe=R(2029);const Se=[{path:"",component:ie.Y}];let De=(()=>{class X{}return(0,x.Z)(X,"\u0275fac",function(Ee){return new(Ee||X)}),(0,x.Z)(X,"\u0275mod",fe.oAB({type:X})),(0,x.Z)(X,"\u0275inj",fe.cJS({imports:[d.ez,v.u5,Q.Pc,q.aw,y.e,s.Bz.forChild(Se)]})),X})()},8804:(zn,Dt,R)=>{"use strict";R.d(Dt,{Y:()=>xn});var x=R(5861),d=R(1180),v=R(1618),s=R(4677),Q=R(866),ie=R(4669),q=R(1847),y=R(2029),fe=R(3052),Se=R(3955),De=R(9903),X=R(9127),se=R(5957),Ee=R(9862),_e=R(6814),be=R(7852);function Re(Qt,Mt){if(1&Qt){const ge=y.EpF();y.ynx(0),y.TgZ(1,"ion-note")(2,"p"),y._uU(3," The closest address to this position is: "),y.qZA(),y.TgZ(4,"p")(5,"strong"),y._uU(6),y.qZA(),y._UZ(7,"br"),y._uU(8),y._UZ(9,"br"),y.TgZ(10,"ion-button",3),y.NdJ("click",function(){y.CHM(ge);const Gt=y.oxw();return y.KtG(Gt.useAddressSelection())}),y._uU(11,"Use this address below "),y._UZ(12,"ion-icon",4),y.qZA()()(),y.BQk()}if(2&Qt){const ge=y.oxw();y.xp6(6),y.Oqu(ge.suggestedAddress.AddressLine1),y.xp6(2),y.HOy(" ",ge.suggestedAddress.AddressLine2," ",ge.suggestedAddress.Town," ",ge.suggestedAddress.StateOrProvince," ",ge.suggestedAddress.Postcode," ")}}let Ne=(()=>{class Qt{constructor(ge,ct,Gt,pn,Gi){(0,d.Z)(this,"mapping",void 0),(0,d.Z)(this,"events",void 0),(0,d.Z)(this,"logging",void 0),(0,d.Z)(this,"http",void 0),(0,d.Z)(this,"appManager",void 0),(0,d.Z)(this,"latitude",void 0),(0,d.Z)(this,"latitudeChange",new y.vpe),(0,d.Z)(this,"longitude",void 0),(0,d.Z)(this,"longitudeChange",new y.vpe),(0,d.Z)(this,"suggestedAddress",null),(0,d.Z)(this,"suggestedAddressChange",new y.vpe),(0,d.Z)(this,"onUseSuggestedAddress",new y.vpe),(0,d.Z)(this,"suggestedAddressAttribution",null),(0,d.Z)(this,"suggestedAddressAttributionChange",new y.vpe),(0,d.Z)(this,"originalMarkerPos",void 0),(0,d.Z)(this,"mapService",void 0),(0,d.Z)(this,"mapOptions",void 0),(0,d.Z)(this,"debouncedGecode",void 0),(0,d.Z)(this,"isMapInitialised",!1),this.mapping=ge,this.events=ct,this.logging=Gt,this.http=pn,this.appManager=Gi}ngOnInit(){this.mapService=new De.k(this.events,this.logging,this.http),this.mapService.initAPI(),this.mapOptions=new Se._,this.mapOptions.mapType=this.appManager.searchSettings.MapType,this.mapOptions.onMapMoveCompleted=()=>{let ge;ge=this.mapService.getMapCenter(),ge.subscribe(ct=>{ct&&(this.latitude=ct.coords.latitude,this.longitude=ct.coords.longitude,this.latitudeChange.emit(this.latitude),this.longitudeChange.emit(this.longitude),this.getAddressForCurrentLatLng())})}}ngAfterContentInit(){this.focusMap()}ngOnDestroy(){this.mapService.disposeMap()}focusMap(){0==this.isMapInitialised&&this.mapService&&0!=this.latitude&&0!=this.longitude&&(this.isMapInitialised=!0,this.mapService.initMap("editor-map",this.mapOptions,null),this.mapService.setMapCenter(new fe.jR(this.latitude,this.longitude)),this.originalMarkerPos=new fe.wC(this.latitude,this.longitude))}ngOnChanges(ge){this.focusMap()}getAddressForCurrentLatLng(){var ge=this;return(0,x.Z)(function*(){ge.latitude&&ge.longitude&&ge.appManager.api.fetchReverseGeocodeResult(ge.latitude,ge.longitude).then(ct=>{ct.AddressInfo&&(ge.suggestedAddress=ct.AddressInfo)})})()}useAddressSelection(){this.onUseSuggestedAddress.emit({suggestedAddress:this.suggestedAddress,attribution:this.suggestedAddressAttribution}),this.suggestedAddress=null,this.suggestedAddressAttribution=null}}return(0,d.Z)(Qt,"\u0275fac",function(ge){return new(ge||Qt)(y.Y36(q.v),y.Y36(se.z),y.Y36(X.z),y.Y36(Ee.eN),y.Y36(v.c))}),(0,d.Z)(Qt,"\u0275cmp",y.Xpm({type:Qt,selectors:[["app-poi-location-editor"]],inputs:{latitude:"latitude",longitude:"longitude"},outputs:{latitudeChange:"latitudeChange",longitudeChange:"longitudeChange",suggestedAddressChange:"suggestedAddressChange",onUseSuggestedAddress:"onUseSuggestedAddress",suggestedAddressAttributionChange:"suggestedAddressAttributionChange"},features:[y.TTD],decls:4,vars:1,consts:[[1,"instruction"],["id","editor-map"],[4,"ngIf"],["size","small",3,"click"],["slot","end","name","copy"]],template:function(ge,ct){1&ge&&(y.TgZ(0,"p",0),y._uU(1,"Drag the map to center the marker on the charging location:"),y.qZA(),y._UZ(2,"div",1),y.YNc(3,Re,13,5,"ng-container",2)),2&ge&&(y.xp6(3),y.Q6J("ngIf",ct.suggestedAddress))},dependencies:[_e.O5,be.YG,be.gu,be.uN],styles:["#editor-map[_ngcontent-%COMP%]{border:1px solid gainsboro;background-color:gray;width:100%;height:128px}"]})),Qt})();var qe=R(9159),_t=R(6223);function Je(Qt,Mt){if(1&Qt&&(y.TgZ(0,"ion-select-option",14),y._uU(1),y.qZA()),2&Qt){const ge=Mt.$implicit;y.Q6J("value",ge.ID),y.xp6(1),y.Oqu(ge.Title)}}function Me(Qt,Mt){if(1&Qt&&(y.TgZ(0,"ion-select-option",14),y._uU(1),y.qZA()),2&Qt){const ge=Mt.$implicit;y.Q6J("value",ge.ID),y.xp6(1),y.Oqu(ge.Title)}}function it(Qt,Mt){if(1&Qt&&(y.TgZ(0,"ion-select-option",14),y._uU(1),y.qZA()),2&Qt){const ge=Mt.$implicit;y.Q6J("value",ge.ID),y.xp6(1),y.Oqu(ge.Title)}}let Xe=(()=>{class Qt{constructor(ge,ct){(0,d.Z)(this,"modalController",void 0),(0,d.Z)(this,"referenceDataManager",void 0),(0,d.Z)(this,"conn",void 0),(0,d.Z)(this,"useFilteredConnectionTypes",!0),(0,d.Z)(this,"useFilteredOperators",!0),this.modalController=ge,this.referenceDataManager=ct}get isAddMode(){return!(null!=this.conn&&this.conn.ID>0)}get connectionTypes(){return this.referenceDataManager.getConnectionTypes(this.useFilteredConnectionTypes)}get currentTypes(){return this.referenceDataManager.getOutputCurrentTypes()}get statusTypes(){return this.referenceDataManager.getStatusTypes().filter(ge=>1==ge.IsUserSelectable)}ngOnInit(){}save(){var ge=!0;null!=this.conn.Quantity&&(this.conn.Quantity<0||this.conn.Quantity>100||!Number.isInteger(this.conn.Quantity))&&(alert("Quantity must be a whole number, or leave it blank."),ge=!1),ge&&this.modalController.dismiss({item:this.conn})}cancel(){this.modalController.dismiss()}}return(0,d.Z)(Qt,"\u0275fac",function(ge){return new(ge||Qt)(y.Y36(be.IN),y.Y36(qe.W))}),(0,d.Z)(Qt,"\u0275cmp",y.Xpm({type:Qt,selectors:[["app-poi-equipment-editor"]],decls:60,vars:13,consts:[[1,"ion-padding"],["position","floating"],[3,"ngModel","ngModelChange"],["value","0"],[3,"value",4,"ngFor","ngForOf"],["type","number",3,"ngModel","ngModelChange"],["type","text","placeholder","(optional) other comments",3,"ngModel","ngModelChange"],["type","text",3,"ngModel","ngModelChange"],["slot","start"],[3,"click"],["name","close","slot","start"],["slot","end"],["color","success",3,"click"],["name","send","slot","end"],[3,"value"]],template:function(ge,ct){1&ge&&(y.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),y._uU(3),y.qZA()()(),y.TgZ(4,"ion-content",0)(5,"p"),y._uU(6,"Please provide as much information as you can about the equipment. If you don't know then leave the field blank. At a minimum you should include the Connection Type and approximate Power kW (max)."),y.qZA(),y.TgZ(7,"ion-item")(8,"ion-label",1),y._uU(9,"Connection Type"),y.qZA(),y.TgZ(10,"ion-select",2),y.NdJ("ngModelChange",function(pn){return ct.conn.ConnectionTypeID=pn}),y.TgZ(11,"ion-select-option",3),y._uU(12,"Unknown"),y.qZA(),y.YNc(13,Je,2,2,"ion-select-option",4),y.qZA()(),y.TgZ(14,"ion-item")(15,"ion-label",1),y._uU(16,"Supply Type"),y.qZA(),y.TgZ(17,"ion-select",2),y.NdJ("ngModelChange",function(pn){return ct.conn.CurrentTypeID=pn}),y.TgZ(18,"ion-select-option",3),y._uU(19,"Unknown"),y.qZA(),y.YNc(20,Me,2,2,"ion-select-option",4),y.qZA()(),y.TgZ(21,"ion-item")(22,"ion-label",1),y._uU(23,"Power (kW)"),y.qZA(),y.TgZ(24,"ion-input",5),y.NdJ("ngModelChange",function(pn){return ct.conn.PowerKW=pn}),y.qZA()(),y.TgZ(25,"ion-item")(26,"ion-label",1),y._uU(27,"Amps"),y.qZA(),y.TgZ(28,"ion-input",5),y.NdJ("ngModelChange",function(pn){return ct.conn.Amps=pn}),y.qZA()(),y.TgZ(29,"ion-item")(30,"ion-label",1),y._uU(31,"Voltage"),y.qZA(),y.TgZ(32,"ion-input",5),y.NdJ("ngModelChange",function(pn){return ct.conn.Voltage=pn}),y.qZA()(),y.TgZ(33,"ion-item")(34,"ion-label",1),y._uU(35,"Status"),y.qZA(),y.TgZ(36,"ion-select",2),y.NdJ("ngModelChange",function(pn){return ct.conn.StatusTypeID=pn}),y.YNc(37,it,2,2,"ion-select-option",4),y.qZA()(),y.TgZ(38,"ion-item")(39,"ion-label",1),y._uU(40,"Quantity Available"),y.qZA(),y.TgZ(41,"ion-input",5),y.NdJ("ngModelChange",function(pn){return ct.conn.Quantity=pn}),y.qZA()(),y.TgZ(42,"ion-item")(43,"ion-label",1),y._uU(44,"Comment"),y.qZA(),y.TgZ(45,"ion-input",6),y.NdJ("ngModelChange",function(pn){return ct.conn.Comments=pn}),y.qZA()(),y.TgZ(46,"ion-item")(47,"ion-label",1),y._uU(48,"Operators Reference"),y.qZA(),y.TgZ(49,"ion-input",7),y.NdJ("ngModelChange",function(pn){return ct.conn.Reference=pn}),y.qZA()()(),y.TgZ(50,"ion-footer")(51,"ion-toolbar")(52,"ion-buttons",8)(53,"ion-button",9),y.NdJ("click",function(){return ct.cancel()}),y._UZ(54,"ion-icon",10),y._uU(55," Cancel "),y.qZA()(),y.TgZ(56,"ion-buttons",11)(57,"ion-button",12),y.NdJ("click",function(){return ct.save()}),y._uU(58," OK "),y._UZ(59,"ion-icon",13),y.qZA()()()()),2&ge&&(y.xp6(3),y.Oqu(ct.isAddMode?"Add Equipment":"Edit Equipment"),y.xp6(7),y.Q6J("ngModel",ct.conn.ConnectionTypeID),y.xp6(3),y.Q6J("ngForOf",ct.connectionTypes),y.xp6(4),y.Q6J("ngModel",ct.conn.CurrentTypeID),y.xp6(3),y.Q6J("ngForOf",ct.currentTypes),y.xp6(4),y.Q6J("ngModel",ct.conn.PowerKW),y.xp6(4),y.Q6J("ngModel",ct.conn.Amps),y.xp6(4),y.Q6J("ngModel",ct.conn.Voltage),y.xp6(4),y.Q6J("ngModel",ct.conn.StatusTypeID),y.xp6(1),y.Q6J("ngForOf",ct.statusTypes),y.xp6(4),y.Q6J("ngModel",ct.conn.Quantity),y.xp6(4),y.Q6J("ngModel",ct.conn.Comments),y.xp6(4),y.Q6J("ngModel",ct.conn.Reference))},dependencies:[_e.sg,be.YG,be.Sm,be.W2,be.fr,be.Gu,be.gu,be.pK,be.Ie,be.Q$,be.t9,be.n0,be.wd,be.sr,be.as,be.QI,be.j9,_t.JJ,_t.On]})),Qt})();var Te=(()=>((Te=Te||{})[Te.Unknown=0]="Unknown",Te[Te.CurrentlyAvailable=10]="CurrentlyAvailable",Te[Te.CurrentlyInUse=20]="CurrentlyInUse",Te[Te.TemporarilyUnavailable=30]="TemporarilyUnavailable",Te[Te.Operational=50]="Operational",Te[Te.PartlyOperational=75]="PartlyOperational",Te[Te.NotOperational=100]="NotOperational",Te[Te.PlannedForFutureDate=150]="PlannedForFutureDate",Te[Te.RemovedDecomissioned=200]="RemovedDecomissioned",Te))(),ae=(()=>((ae=ae||{})[ae.UnknownOperator=1]="UnknownOperator",ae[ae.SiteOwner=45]="SiteOwner",ae))(),Ze=R(8696),Ae=R(1163);function ve(Qt,Mt){if(1&Qt&&(y.TgZ(0,"ion-select-option",5),y._uU(1),y.qZA()),2&Qt){const ge=Mt.$implicit;y.Q6J("value",ge.ID),y.xp6(1),y.Oqu(ge.Title)}}function en(Qt,Mt){1&Qt&&(y.TgZ(0,"ion-select-option",6),y._uU(1,"Other..."),y.qZA())}function dt(Qt,Mt){if(1&Qt){const ge=y.EpF();y.TgZ(0,"ion-item")(1,"ion-label",1),y._uU(2,"Network Operator"),y.qZA(),y.TgZ(3,"ion-select",2),y.NdJ("ngModelChange",function(Gt){y.CHM(ge);const pn=y.oxw();return y.KtG(pn.operatorId=Gt)})("ionChange",function(){y.CHM(ge);const Gt=y.oxw();return y.KtG(Gt.onOperatorChange())}),y.YNc(4,ve,2,2,"ion-select-option",3),y.YNc(5,en,2,0,"ion-select-option",4),y.qZA()()}if(2&Qt){const ge=y.oxw();y.xp6(3),y.Q6J("ngModel",ge.operatorId),y.xp6(1),y.Q6J("ngForOf",ge.operators),y.xp6(1),y.Q6J("ngIf",ge.useFilteredOperators)}}function mt(Qt,Mt){if(1&Qt){const ge=y.EpF();y.TgZ(0,"ion-item")(1,"ion-label"),y._uU(2,"Network Operator"),y.qZA(),y.TgZ(3,"ion-searchbar",7),y.NdJ("ionCancel",function(){y.CHM(ge);const Gt=y.oxw();return y.KtG(Gt.cancelOperatorLookup())})("ngModelChange",function(Gt){y.CHM(ge);const pn=y.oxw();return y.KtG(pn.operatorSearchKeyword=Gt)})("ionChange",function(Gt){y.CHM(ge);const pn=y.oxw();return y.KtG(pn.searchOperators(Gt))}),y.qZA()()}if(2&Qt){const ge=y.oxw();y.xp6(3),y.Q6J("ngModel",ge.operatorSearchKeyword)}}function lt(Qt,Mt){if(1&Qt){const ge=y.EpF();y.TgZ(0,"ion-item",9),y.NdJ("click",function(){const pn=y.CHM(ge).$implicit,Gi=y.oxw(2);return y.KtG(Gi.onOperatorChange(pn))}),y.TgZ(1,"ion-avatar",10),y._UZ(2,"ion-icon",11),y.qZA(),y.TgZ(3,"ion-label")(4,"p"),y._uU(5),y.qZA(),y.TgZ(6,"p"),y._uU(7),y.qZA()()()}if(2&Qt){const ge=Mt.$implicit;y.xp6(5),y.Oqu(ge.Title),y.xp6(2),y.Oqu(ge.WebsiteURL)}}function ze(Qt,Mt){if(1&Qt&&(y.ynx(0),y.TgZ(1,"ion-list"),y.YNc(2,lt,8,2,"ion-item",8),y.qZA(),y.BQk()),2&Qt){const ge=y.oxw();y.xp6(2),y.Q6J("ngForOf",ge.operatorSearchResults)}}function xt(Qt,Mt){if(1&Qt){const ge=y.EpF();y.ynx(0),y.TgZ(1,"ion-item")(2,"ion-avatar",10),y._UZ(3,"ion-icon",12),y.qZA(),y.TgZ(4,"ion-label")(5,"p"),y._uU(6),y.qZA(),y.TgZ(7,"p"),y._uU(8),y.qZA(),y.TgZ(9,"ion-button",9),y.NdJ("click",function(){y.CHM(ge);const Gt=y.oxw();return y.KtG(Gt.selectedOperator=null)}),y._uU(10,"Change"),y.qZA()()(),y.BQk()}if(2&Qt){const ge=y.oxw();y.xp6(6),y.Oqu(ge.selectedOperator.Title),y.xp6(2),y.Oqu(ge.selectedOperator.WebsiteURL)}}let Ve=(()=>{class Qt{get operators(){return this.referenceDataManager.getNetworkOperators(this.useFilteredOperators)}constructor(ge){(0,d.Z)(this,"referenceDataManager",void 0),(0,d.Z)(this,"operatorId",null),(0,d.Z)(this,"useFilteredOperators",null),(0,d.Z)(this,"operatorChanged",new y.vpe),(0,d.Z)(this,"operatorCache",[]),(0,d.Z)(this,"operatorSearchResults",[]),(0,d.Z)(this,"operatorSearchKeyword",""),(0,d.Z)(this,"selectedOperator",null),this.referenceDataManager=ge}ngOnInit(){this.operatorCache=this.referenceDataManager.getNetworkOperators(!1),null!=this.operatorId&&(this.selectedOperator=this.operatorCache.find(ge=>ge.ID==this.operatorId))}searchOperators(){this.operatorSearchResults=[],0!=this.operatorSearchKeyword.length&&(this.operatorSearchResults=this.operatorCache?this.operatorCache.filter(ge=>ge.Title.toLowerCase().startsWith(this.operatorSearchKeyword.toLowerCase())||ge.Title.toLowerCase().startsWith("("+this.operatorSearchKeyword.toLowerCase())).slice(0,10):[])}onOperatorChange(ge=null){var ct=this;return(0,x.Z)(function*(){null==ge&&ct.operatorId&&(ge=ct.operatorCache.find(Gt=>Gt.ID==ct.operatorId)),null!=ge&&(ct.operatorSearchResults=[],ct.selectedOperator=ge,ct.operatorId=ge.ID),ct.operatorId?ct.operatorChanged.emit(ct.selectedOperator):ct.useFilteredOperators=!1})()}cancelOperatorLookup(){this.selectedOperator=null}}return(0,d.Z)(Qt,"\u0275fac",function(ge){return new(ge||Qt)(y.Y36(qe.W))}),(0,d.Z)(Qt,"\u0275cmp",y.Xpm({type:Qt,selectors:[["app-operator-lookup"]],inputs:{operatorId:"operatorId",useFilteredOperators:"useFilteredOperators"},outputs:{operatorChanged:"operatorChanged"},decls:4,vars:4,consts:[[4,"ngIf"],["position","floating"],[3,"ngModel","ngModelChange","ionChange"],[3,"value",4,"ngFor","ngForOf"],["value","",4,"ngIf"],[3,"value"],["value",""],["placeholder","Search by network name (in any country)","showCancelButton","focus","autocomplete","on",3,"ngModel","ionCancel","ngModelChange","ionChange"],[3,"click",4,"ngFor","ngForOf"],[3,"click"],["item-left",""],["name","card"],["name","locate"]],template:function(ge,ct){1&ge&&(y.YNc(0,dt,6,3,"ion-item",0),y.YNc(1,mt,4,1,"ion-item",0),y.YNc(2,ze,3,1,"ng-container",0),y.YNc(3,xt,11,2,"ng-container",0)),2&ge&&(y.Q6J("ngIf",ct.useFilteredOperators&&!ct.selectedOperator),y.xp6(1),y.Q6J("ngIf",!ct.useFilteredOperators&&!ct.selectedOperator),y.xp6(1),y.Q6J("ngIf",ct.operatorSearchResults.length>0),y.xp6(1),y.Q6J("ngIf",null!=ct.selectedOperator))},dependencies:[_e.sg,_e.O5,be.BJ,be.YG,be.gu,be.Ie,be.Q$,be.q_,be.VI,be.t9,be.n0,be.QI,be.j9,_t.JJ,_t.On]})),Qt})();function gt(Qt,Mt){1&Qt&&y._UZ(0,"ion-icon",13)}function Be(Qt,Mt){1&Qt&&y._UZ(0,"ion-icon",13)}function Bt(Qt,Mt){1&Qt&&y._UZ(0,"ion-icon",13)}function Wt(Qt,Mt){if(1&Qt&&(y.TgZ(0,"ion-select-option",27),y._uU(1),y.qZA()),2&Qt){const ge=Mt.$implicit;y.Q6J("value",ge.ID),y.xp6(1),y.Oqu(ge.Title)}}function wn(Qt,Mt){if(1&Qt){const ge=y.EpF();y.ynx(0),y.TgZ(1,"app-poi-location-editor",14,15),y.NdJ("latitudeChange",function(Gt){y.CHM(ge);const pn=y.oxw(2);return y.KtG(pn.item.AddressInfo.Latitude=Gt)})("longitudeChange",function(Gt){y.CHM(ge);const pn=y.oxw(2);return y.KtG(pn.item.AddressInfo.Longitude=Gt)})("onUseSuggestedAddress",function(Gt){y.CHM(ge);const pn=y.oxw(2);return y.KtG(pn.useSuggestedAddress(Gt))}),y.qZA(),y.TgZ(3,"ion-list")(4,"ion-item")(5,"ion-label",16),y._uU(6,"Location Name"),y.qZA(),y.TgZ(7,"ion-input",17),y.NdJ("ngModelChange",function(Gt){y.CHM(ge);const pn=y.oxw(2);return y.KtG(pn.item.AddressInfo.Title=Gt)}),y.qZA()(),y.TgZ(8,"ion-item")(9,"ion-label",16),y._uU(10,"Address Line 1"),y.qZA(),y.TgZ(11,"ion-input",18),y.NdJ("ngModelChange",function(Gt){y.CHM(ge);const pn=y.oxw(2);return y.KtG(pn.item.AddressInfo.AddressLine1=Gt)}),y.qZA()(),y.TgZ(12,"ion-item")(13,"ion-label",16),y._uU(14,"Address Line 2"),y.qZA(),y.TgZ(15,"ion-input",19),y.NdJ("ngModelChange",function(Gt){y.CHM(ge);const pn=y.oxw(2);return y.KtG(pn.item.AddressInfo.AddressLine2=Gt)}),y.qZA()(),y.TgZ(16,"ion-item")(17,"ion-label",16),y._uU(18,"Town"),y.qZA(),y.TgZ(19,"ion-input",20),y.NdJ("ngModelChange",function(Gt){y.CHM(ge);const pn=y.oxw(2);return y.KtG(pn.item.AddressInfo.Town=Gt)}),y.qZA()(),y.TgZ(20,"ion-item")(21,"ion-label",16),y._uU(22,"State or Province"),y.qZA(),y.TgZ(23,"ion-input",21),y.NdJ("ngModelChange",function(Gt){y.CHM(ge);const pn=y.oxw(2);return y.KtG(pn.item.AddressInfo.StateOrProvince=Gt)}),y.qZA()(),y.TgZ(24,"ion-item")(25,"ion-label",16),y._uU(26,"Postal Code"),y.qZA(),y.TgZ(27,"ion-input",22),y.NdJ("ngModelChange",function(Gt){y.CHM(ge);const pn=y.oxw(2);return y.KtG(pn.item.AddressInfo.Postcode=Gt)}),y.qZA()(),y.TgZ(28,"ion-item")(29,"ion-label",16),y._uU(30,"Country"),y.qZA(),y.TgZ(31,"ion-select",23),y.NdJ("ngModelChange",function(Gt){y.CHM(ge);const pn=y.oxw(2);return y.KtG(pn.item.AddressInfo.CountryID=Gt)})("ionChange",function(){y.CHM(ge);const Gt=y.oxw(2);return y.KtG(Gt.onCountryChange())}),y.YNc(32,Wt,2,2,"ion-select-option",24),y.qZA()(),y.TgZ(33,"ion-item")(34,"ion-input",25),y.NdJ("ngModelChange",function(Gt){y.CHM(ge);const pn=y.oxw(2);return y.KtG(pn.item.AddressInfo.Latitude=Gt)}),y.qZA()(),y.TgZ(35,"ion-item")(36,"ion-input",26),y.NdJ("ngModelChange",function(Gt){y.CHM(ge);const pn=y.oxw(2);return y.KtG(pn.item.AddressInfo.Longitude=Gt)}),y.qZA()()(),y.BQk()}if(2&Qt){const ge=y.oxw(2);y.xp6(1),y.Q6J("latitude",ge.item.AddressInfo.Latitude)("longitude",ge.item.AddressInfo.Longitude),y.xp6(6),y.Q6J("ngModel",ge.item.AddressInfo.Title),y.xp6(4),y.Q6J("ngModel",ge.item.AddressInfo.AddressLine1),y.xp6(4),y.Q6J("ngModel",ge.item.AddressInfo.AddressLine2),y.xp6(4),y.Q6J("ngModel",ge.item.AddressInfo.Town),y.xp6(4),y.Q6J("ngModel",ge.item.AddressInfo.StateOrProvince),y.xp6(4),y.Q6J("ngModel",ge.item.AddressInfo.Postcode),y.xp6(4),y.Q6J("ngModel",ge.item.AddressInfo.CountryID),y.xp6(1),y.Q6J("ngForOf",ge.countries),y.xp6(2),y.Q6J("ngModel",ge.item.AddressInfo.Latitude),y.xp6(2),y.Q6J("ngModel",ge.item.AddressInfo.Longitude)}}function Xt(Qt,Mt){if(1&Qt){const ge=y.EpF();y.ynx(0),y.TgZ(1,"h3"),y._uU(2,"Locations Nearby"),y.qZA(),y.TgZ(3,"p")(4,"strong"),y._uU(5,"The following locations already exist nearby."),y.qZA()(),y.TgZ(6,"div",28)(7,"p"),y._uU(8,"Ensure you are not adding a duplicate site unless it is for different equipment from another network operator."),y.qZA(),y.TgZ(9,"p"),y._uU(10,"You can edit any of these listings if required instead:"),y.qZA()(),y.TgZ(11,"app-poi-list",29),y.NdJ("onEdit",function(Gt){y.CHM(ge);const pn=y.oxw(2);return y.KtG(pn.editPOI(Gt))}),y.qZA(),y.BQk()}if(2&Qt){const ge=y.oxw(2);y.xp6(11),y.Q6J("poiList",ge.nearbySites)("enableEditOption",!0)}}function mn(Qt,Mt){if(1&Qt&&(y.ynx(0),y.YNc(1,wn,37,12,"ng-container",9),y.YNc(2,Xt,12,2,"ng-container",9),y.BQk()),2&Qt){const ge=y.oxw();y.xp6(1),y.Q6J("ngIf","location"==ge.step),y.xp6(1),y.Q6J("ngIf","poi-nearby"==ge.step)}}function an(Qt,Mt){if(1&Qt){const ge=y.EpF();y.ynx(0),y.TgZ(1,"p"),y._uU(2,"Copied the equipment configuration from:"),y.qZA(),y.TgZ(3,"ion-item")(4,"ion-label"),y._uU(5),y._UZ(6,"br"),y._uU(7),y._UZ(8,"br"),y._uU(9),y._UZ(10,"br"),y._uU(11),y._UZ(12,"br"),y._uU(13),y.qZA(),y.TgZ(14,"ion-button",31),y.NdJ("click",function(){y.CHM(ge);const Gt=y.oxw(5);return y.KtG(Gt.changeTemplatePOI())}),y._uU(15,"Change.."),y.qZA()(),y.BQk()}if(2&Qt){const ge=y.oxw(5);y.xp6(5),y.hij(" ",ge.selectedTemplatePOI.AddressInfo.Title," "),y.xp6(2),y.hij(" ",ge.selectedTemplatePOI.AddressInfo.AddressLine1," "),y.xp6(2),y.hij(" ",null==ge.selectedTemplatePOI.Connections[0].ConnectionType?null:ge.selectedTemplatePOI.Connections[0].ConnectionType.Title," "),y.xp6(2),y.hij(" ",ge.selectedTemplatePOI.Connections[0].PowerKW," "),y.xp6(2),y.hij(" ",ge.selectedTemplatePOI.DateCreated," ")}}function Vt(Qt,Mt){if(1&Qt){const ge=y.EpF();y.ynx(0),y.TgZ(1,"h4"),y._uU(2,"Similar Sites"),y.qZA(),y.TgZ(3,"app-poi-list",32),y.NdJ("onCopy",function(Gt){y.CHM(ge);const pn=y.oxw(6);return y.KtG(pn.useTemplatePOI(Gt))}),y.qZA(),y.BQk()}if(2&Qt){const ge=y.oxw(6);y.xp6(3),y.Q6J("enableCopyOption",!0)("poiList",ge.templateSites)}}function St(Qt,Mt){1&Qt&&(y.ynx(0),y.TgZ(1,"p"),y._uU(2," There are no suggested sites to copy for this network operator. "),y.qZA(),y.BQk())}function st(Qt,Mt){if(1&Qt&&(y.ynx(0),y.YNc(1,Vt,4,2,"ng-container",9),y.YNc(2,St,3,0,"ng-container",9),y.BQk()),2&Qt){const ge=y.oxw(5);y.xp6(1),y.Q6J("ngIf",ge.templateSites.length>0),y.xp6(1),y.Q6J("ngIf",0==ge.templateSites.length)}}function qt(Qt,Mt){if(1&Qt&&(y.ynx(0),y.YNc(1,an,16,5,"ng-container",9),y.YNc(2,st,3,2,"ng-container",9),y.BQk()),2&Qt){const ge=y.oxw(4);y.xp6(1),y.Q6J("ngIf",ge.selectedTemplatePOI),y.xp6(1),y.Q6J("ngIf",!ge.selectedTemplatePOI)}}function dn(Qt,Mt){if(1&Qt){const ge=y.EpF();y.ynx(0),y.TgZ(1,"p",28),y._uU(2,"You can copy the equipment settings from other sites operated by the same network operator or choose 'Next' to skip this step: "),y.qZA(),y.TgZ(3,"app-operator-lookup",30),y.NdJ("operatorChanged",function(Gt){y.CHM(ge);const pn=y.oxw(3);return y.KtG(pn.onOperatorChange(Gt))}),y.qZA(),y.YNc(4,qt,3,2,"ng-container",9),y.BQk()}if(2&Qt){const ge=y.oxw(3);y.xp6(3),y.Q6J("operatorId",ge.item.OperatorID),y.xp6(1),y.Q6J("ngIf",ge.item.AddressInfo.CountryID&&ge.item.OperatorID)}}function Sn(Qt,Mt){if(1&Qt&&(y.ynx(0),y.YNc(1,dn,5,2,"ng-container",9),y.BQk()),2&Qt){const ge=y.oxw(2);y.xp6(1),y.Q6J("ngIf",!ge.skipPOICopy)}}function zt(Qt,Mt){if(1&Qt){const ge=y.EpF();y.ynx(0),y.TgZ(1,"app-operator-lookup",33),y.NdJ("operatorChanged",function(Gt){y.CHM(ge);const pn=y.oxw(2);return y.KtG(pn.onOperatorChange(Gt))}),y.qZA(),y.TgZ(2,"ion-item")(3,"ion-input",34),y.NdJ("ngModelChange",function(Gt){y.CHM(ge);const pn=y.oxw(2);return y.KtG(pn.item.NumberOfPoints=Gt)}),y.qZA()(),y.TgZ(4,"h4"),y._uU(5,"Equipment"),y.qZA(),y.TgZ(6,"ion-button",35),y.NdJ("click",function(){y.CHM(ge);const Gt=y.oxw(2);return y.KtG(Gt.addConnection())}),y._UZ(7,"ion-icon",36),y.qZA(),y.TgZ(8,"app-equipment-details",37),y.NdJ("onEdit",function(Gt){y.CHM(ge);const pn=y.oxw(2);return y.KtG(pn.editConnection(Gt))})("onDelete",function(Gt){y.CHM(ge);const pn=y.oxw(2);return y.KtG(pn.deleteConnection(Gt))}),y.qZA(),y.BQk()}if(2&Qt){const ge=y.oxw(2);y.xp6(1),y.Q6J("operatorId",ge.item.OperatorID)("useFilteredOperators",!1),y.xp6(2),y.Q6J("ngModel",ge.item.NumberOfPoints),y.xp6(5),y.Q6J("item",ge.item)("enableEdit",!0)}}function gi(Qt,Mt){if(1&Qt&&(y.ynx(0),y.YNc(1,Sn,2,1,"ng-container",9),y.YNc(2,zt,9,5,"ng-container",9),y.BQk()),2&Qt){const ge=y.oxw();y.xp6(1),y.Q6J("ngIf","copy-equipment"==ge.step),y.xp6(1),y.Q6J("ngIf","edit-equipment"==ge.step)}}function $i(Qt,Mt){if(1&Qt&&(y.TgZ(0,"p",44)(1,"strong"),y._uU(2,"Your changes cannot be saved until the following issues are resolved:"),y.qZA(),y.TgZ(3,"ion-label",45),y._uU(4),y.qZA()()),2&Qt){const ge=y.oxw(2);y.xp6(4),y.hij(" ",ge.validationMsg,"")}}function Ci(Qt,Mt){if(1&Qt&&(y.TgZ(0,"ion-select-option",27),y._uU(1),y.qZA()),2&Qt){const ge=Mt.$implicit;y.Q6J("value",ge.ID),y.xp6(1),y.Oqu(ge.Title)}}function Ji(Qt,Mt){if(1&Qt&&(y.TgZ(0,"ion-select-option",27),y._uU(1),y.qZA()),2&Qt){const ge=Mt.$implicit;y.Q6J("value",ge.ID),y.xp6(1),y.Oqu(ge.Title)}}function Hi(Qt,Mt){if(1&Qt){const ge=y.EpF();y.ynx(0),y.YNc(1,$i,5,1,"p",38),y.TgZ(2,"p"),y._uU(3,"Please provide any other facts related to this site. Additional comments (your charging experiences etc) can be added as check-in comments once the site is listed."),y.qZA(),y.TgZ(4,"ion-item")(5,"ion-label",16),y._uU(6,"Operational Status (All Equipment))"),y.qZA(),y.TgZ(7,"ion-select",39),y.NdJ("ngModelChange",function(Gt){y.CHM(ge);const pn=y.oxw();return y.KtG(pn.item.StatusTypeID=Gt)}),y.YNc(8,Ci,2,2,"ion-select-option",24),y.qZA()(),y.TgZ(9,"ion-item")(10,"ion-label",16),y._uU(11,"Usage Type"),y.qZA(),y.TgZ(12,"ion-select",39),y.NdJ("ngModelChange",function(Gt){y.CHM(ge);const pn=y.oxw();return y.KtG(pn.item.UsageTypeID=Gt)}),y.YNc(13,Ji,2,2,"ion-select-option",24),y.qZA()(),y.TgZ(14,"ion-item")(15,"ion-label",16),y._uU(16,"Usage Cost"),y.qZA(),y.TgZ(17,"ion-input",21),y.NdJ("ngModelChange",function(Gt){y.CHM(ge);const pn=y.oxw();return y.KtG(pn.item.UsageCost=Gt)}),y.qZA()(),y.TgZ(18,"ion-item")(19,"ion-label",16),y._uU(20,"General Comments"),y.qZA(),y.TgZ(21,"ion-input",40),y.NdJ("ngModelChange",function(Gt){y.CHM(ge);const pn=y.oxw();return y.KtG(pn.item.GeneralComments=Gt)}),y.qZA()(),y.TgZ(22,"ion-item")(23,"ion-label",16),y._uU(24,"Main Telephone Number "),y.qZA(),y.TgZ(25,"ion-input",41),y.NdJ("ngModelChange",function(Gt){y.CHM(ge);const pn=y.oxw();return y.KtG(pn.item.AddressInfo.ContactTelephone1=Gt)}),y.qZA()(),y.TgZ(26,"ion-item")(27,"ion-label",16),y._uU(28,"Other Telephone Number "),y.qZA(),y.TgZ(29,"ion-input",41),y.NdJ("ngModelChange",function(Gt){y.CHM(ge);const pn=y.oxw();return y.KtG(pn.item.AddressInfo.ContactTelephone2=Gt)}),y.qZA()(),y.TgZ(30,"ion-item")(31,"ion-label",16),y._uU(32,"Access Comments"),y.qZA(),y.TgZ(33,"ion-input",42),y.NdJ("ngModelChange",function(Gt){y.CHM(ge);const pn=y.oxw();return y.KtG(pn.item.AddressInfo.AccessComments=Gt)}),y.qZA()(),y.TgZ(34,"ion-item")(35,"ion-label",16),y._uU(36,"Related Website"),y.qZA(),y.TgZ(37,"ion-input",43),y.NdJ("ngModelChange",function(Gt){y.CHM(ge);const pn=y.oxw();return y.KtG(pn.item.AddressInfo.RelatedURL=Gt)}),y.qZA()(),y.BQk()}if(2&Qt){const ge=y.oxw();y.xp6(1),y.Q6J("ngIf",ge.validationMsg),y.xp6(6),y.Q6J("ngModel",ge.item.StatusTypeID),y.xp6(1),y.Q6J("ngForOf",ge.statusTypes),y.xp6(4),y.Q6J("ngModel",ge.item.UsageTypeID),y.xp6(1),y.Q6J("ngForOf",ge.usageTypes),y.xp6(4),y.Q6J("ngModel",ge.item.UsageCost),y.xp6(4),y.Q6J("ngModel",ge.item.GeneralComments),y.xp6(4),y.Q6J("ngModel",ge.item.AddressInfo.ContactTelephone1),y.xp6(4),y.Q6J("ngModel",ge.item.AddressInfo.ContactTelephone2),y.xp6(4),y.Q6J("ngModel",ge.item.AddressInfo.AccessComments),y.xp6(4),y.Q6J("ngModel",ge.item.AddressInfo.RelatedURL)}}function Fi(Qt,Mt){if(1&Qt){const ge=y.EpF();y.TgZ(0,"ion-button",1),y.NdJ("click",function(){y.CHM(ge);const Gt=y.oxw();return y.KtG(Gt.previous())}),y._uU(1," Previous "),y._UZ(2,"ion-icon",46),y.qZA()}}function ii(Qt,Mt){if(1&Qt){const ge=y.EpF();y.TgZ(0,"ion-button",1),y.NdJ("click",function(){y.CHM(ge);const Gt=y.oxw();return y.KtG(Gt.next())}),y._uU(1," Next "),y._UZ(2,"ion-icon",47),y.qZA()}}function mi(Qt,Mt){if(1&Qt){const ge=y.EpF();y.TgZ(0,"ion-button",48),y.NdJ("click",function(){y.CHM(ge);const Gt=y.oxw();return y.KtG(Gt.save())}),y._uU(1," Submit "),y._UZ(2,"ion-icon",49),y.qZA()}}let xn=(()=>{class Qt{get countries(){return this.appManager.referenceDataManager.getCountries()}get usageTypes(){return this.appManager.referenceDataManager.getUsageTypes()}get statusTypes(){return this.appManager.referenceDataManager.getStatusTypes().filter(ge=>1==ge.IsUserSelectable)}get isAddMode(){return this.item.ID<=0}constructor(ge,ct,Gt,pn,Gi,ri){(0,d.Z)(this,"appManager",void 0),(0,d.Z)(this,"modalController",void 0),(0,d.Z)(this,"poiManager",void 0),(0,d.Z)(this,"mapping",void 0),(0,d.Z)(this,"loadingController",void 0),(0,d.Z)(this,"alertController",void 0),(0,d.Z)(this,"id",void 0),(0,d.Z)(this,"item",void 0),(0,d.Z)(this,"step",void 0),(0,d.Z)(this,"selectedTab",void 0),(0,d.Z)(this,"startPos",void 0),(0,d.Z)(this,"useFilteredConnectionTypes",!0),(0,d.Z)(this,"templateSites",[]),(0,d.Z)(this,"nearbySites",[]),(0,d.Z)(this,"selectedTemplatePOI",null),(0,d.Z)(this,"suggestedAddress",null),(0,d.Z)(this,"suggestedAddressAttribution",null),(0,d.Z)(this,"isNonDuplicateConfirmed",!1),(0,d.Z)(this,"skipPOICopy",!1),(0,d.Z)(this,"validationMsg",null),(0,d.Z)(this,"loading",void 0),(0,d.Z)(this,"editorMap",void 0),this.appManager=ge,this.modalController=ct,this.poiManager=Gt,this.mapping=pn,this.loadingController=Gi,this.alertController=ri,this.initNewItem()}initNewItem(){this.item={ID:-1,DataProviderID:1,DataProvidersReference:null,OperatorsReference:null,OperatorID:1,UsageCost:null,UsageTypeID:4,NumberOfPoints:1,GeneralComments:null,DatePlanned:null,StatusTypeID:50,SubmissionStatusTypeID:null,Connections:[],MetadataValues:[],AddressInfo:{ID:-1,CountryID:18,Title:"",AddressLine1:"",Latitude:0,Longitude:0}},this.step="location",this.selectedTab="location"}get isReadyToSubmit(){return this.validate().isValid&&"info"==this.step}ngOnInit(){}presentLoadingUI(){var ge=this;return(0,x.Z)(function*(){ge.loading=yield ge.loadingController.create({message:"Please Wait.."}),yield ge.loading.present()})()}dismissLoadingUI(){var ge=this;return(0,x.Z)(function*(){ge.loading&&(yield ge.loading.dismiss())})()}ionViewDidEnter(){if(null!=this.id)this.editExistingPOI(this.id);else{let ge=localStorage.getItem("_editor-operatorid");ge&&(this.item.OperatorID=parseInt(ge,10)),this.startPos?(this.item.AddressInfo.Latitude=this.startPos.latitude,this.item.AddressInfo.Longitude=this.startPos.longitude):this.mapping&&this.mapping.getMapCenter().subscribe(ct=>{ct&&(this.item.AddressInfo.Latitude=ct.coords.latitude,this.item.AddressInfo.Longitude=ct.coords.longitude)})}this.refreshFilteredReferenceData()}previous(){var ge=this;return(0,x.Z)(function*(){switch(ge.step){case"info":ge.step="edit-equipment";break;case"edit-equipment":ge.step=ge.isAddMode?"copy-equipment":"location";break;case"copy-equipment":case"poi-nearby":ge.step="location"}yield ge.initCurrentStep(!1)})()}next(){var ge=this;return(0,x.Z)(function*(){if("poi-nearby"==ge.step&&ge.nearbySites.length>0&&!ge.isNonDuplicateConfirmed)return void(yield ge.alertController.create({header:"Confirm",message:"Please confirm you are not adding a duplicate site.",buttons:[{text:"Cancel",role:"cancel",cssClass:"secondary",handler:pn=>{}},{text:"Confirm",handler:()=>{ge.isNonDuplicateConfirmed=!0,ge.next()}}]})).present();const ct=ge.validate(ge.step);if(ct.isValid){switch(ge.step){case"location":ge.step=ge.isAddMode?"poi-nearby":"edit-equipment";break;case"poi-nearby":ge.step=ge.isAddMode?"copy-equipment":"edit-equipment";break;case"copy-equipment":ge.step="edit-equipment";break;case"edit-equipment":ge.step="info"}yield ge.initCurrentStep(!0)}else(yield ge.alertController.create({message:ct.msg})).present()})()}initCurrentStep(ge){var ct=this;return(0,x.Z)(function*(){"poi-nearby"==ct.step?(ct.selectedTab="location",0==(yield ct.refreshNearbySites())&&(ge?yield ct.next():yield ct.previous())):"location"==ct.step?ct.selectedTab="location":"copy-equipment"==ct.step?(ct.selectedTab="equipment",yield ct.refreshTemplateSites()):"edit-equipment"==ct.step?ct.selectedTab="equipment":"info"==ct.step&&(ct.selectedTab="info")})()}onCountryChange(){var ge=this;return(0,x.Z)(function*(){ge.refreshFilteredReferenceData()})()}onOperatorChange(ge=null){var ct=this;return(0,x.Z)(function*(){null!=ge&&ct.item.OperatorID!=ge.ID&&(ct.item.OperatorID=ge.ID,localStorage.setItem("_editor-operatorid",ct.item.OperatorID.toString()),yield ct.refreshTemplateSites())})()}useSuggestedAddress(ge=null){ge&&(this.suggestedAddress=ge.suggestedAddress,this.suggestedAddressAttribution=ge.suggestedAddressAttribution),Object.assign(this.item.AddressInfo,this.suggestedAddress),this.suggestedAddressAttribution&&(this.item.MetadataValues.find(ct=>4==ct.MetadataFieldID)||this.item.MetadataValues.push({ID:-1,MetadataFieldID:4,ItemValue:this.suggestedAddressAttribution,MetadataFieldOptionID:null,MetadataFieldOption:null}))}editConnection(ge){var ct=this;return(0,x.Z)(function*(){const Gt=ct.item.Connections.find(ri=>ri.ID==ge.ID),pn=Object.assign({},Gt),Gi=yield ct.modalController.create({component:Xe,componentProps:{conn:pn}});return Gi.onWillDismiss().then(ri=>{ri&&ri.data&&ri.data.item&&ct.updateConnection(ri.data.item)}),yield Gi.present()})()}deleteConnection(ge){var ct=this;return(0,x.Z)(function*(){const Gt=ct.item.Connections.find(Gi=>Gi.ID==ge.ID);(yield ct.alertController.create({header:"Confirm Delete",message:"Are you sure you want to delete this connection information?",buttons:[{text:"No",role:"cancel",cssClass:"secondary",handler:()=>{}},{text:"Yes",handler:()=>{ct.item.Connections=ct.item.Connections.filter(Gi=>Gi.ID!=Gt.ID),ct.appManager.referenceDataManager.hydrateCompactPOI(ct.item,!0)}}]})).present()})()}addConnection(){var ge=this;return(0,x.Z)(function*(){const ct={ID:-Q.c.getRandomInt(1e4),ConnectionTypeID:null,StatusTypeID:50,PowerKW:null,Quantity:1},Gt=yield ge.modalController.create({component:Xe,componentProps:{conn:ct}});return Gt.onWillDismiss().then(pn=>{pn&&pn.data&&pn.data.item&&ge.updateConnection(pn.data.item)}),yield Gt.present()})()}refreshFilteredReferenceData(){this.appManager.referenceDataManager.refreshFilteredReferenceData(this.appManager.api,{CountryIds:[this.item.AddressInfo.CountryID]})}updateConnection(ge){if(ge){let ct=this.item.Connections.find(Gt=>Gt.ID==ge.ID);ct?Object.assign(ct,ge):this.item.Connections.push(ge)}this.appManager.referenceDataManager.hydrateCompactPOI(this.item,!0)}validate(ge="all"){let ct=null;return("all"==ge||"location"==ge)&&((!this.item.AddressInfo.Latitude||!this.item.AddressInfo.Longitude)&&(ct="Location is required"),""==this.item.AddressInfo.Title&&(ct="A location title is required"),!this.item.AddressInfo.AddressLine1&&!this.item.AddressInfo.AddressLine2&&(ct="An approximate address is required."),this.item.AddressInfo.CountryID||(ct="A country selection is required"),(!this.item.AddressInfo.Latitude||!this.item.AddressInfo.Longitude)&&(ct="A location latitude and longitude is required")),("all"==ge||"poi-nearby"==ge)&&this.nearbySites.length>0&&!this.isNonDuplicateConfirmed&&(ct="Please confirm that the site is not a duplicate"),("all"==ge||"equipment"==ge)&&(this.item.OperatorID||(ct="Please confirm the charging network or equipment operator."),0==this.item.Connections.length&&(ct="Equipment information is required")),ct?(this.validationMsg=ct,{isValid:!1,msg:ct}):(this.validationMsg=null,{isValid:!0,msg:null})}save(){var ge=this;return(0,x.Z)(function*(){let ct=ge.validate();if(ct.isValid){yield ge.presentLoadingUI();try{yield ge.appManager.submitPOI(ge.item),yield ge.dismissLoadingUI(),ge.appManager.showToastNotification("You submission will be reviewed (if required) and published shortly."),ge.modalController.dismiss()}catch(Gt){yield ge.dismissLoadingUI(),Gt.error&&alert("Sorry, your submission could not be completed at this time. Please try again later.")}}else alert(ct.msg)})()}cancel(){var ge=this;return(0,x.Z)(function*(){ge.modalController.dismiss()})()}refreshTemplateSites(){var ge=this;return(0,x.Z)(function*(){if(ge.item.AddressInfo.CountryID&&ge.item.OperatorID){yield ge.presentLoadingUI(),ge.templateSites=[];let ct=new s.b;ct.countryIdList=[ge.item.AddressInfo.CountryID],ct.minPowerKW=1,ct.operatorIdList=[ge.item.OperatorID],ct.maxResults=10;let Gt=yield ge.poiManager.fetchPOIList(ct);Gt.sort((pn,Gi)=>new Date(pn.DateCreated).getTime()-new Date(Gi.DateCreated).getTime()),ge.templateSites=Gt,ge.dismissLoadingUI()}})()}refreshNearbySites(){var ge=this;return(0,x.Z)(function*(){if(ge.item.AddressInfo.Latitude&&ge.item.AddressInfo.Longitude){yield ge.presentLoadingUI(),ge.nearbySites=[];let ct=new s.b;ct.latitude=ge.item.AddressInfo.Latitude,ct.longitude=ge.item.AddressInfo.Longitude,ct.distance=5,ct.distanceUnit="km",ct.maxResults=10;let Gt=yield ge.poiManager.fetchPOIList(ct);return Gt.sort((pn,Gi)=>pn.Distance-Gi.Distance),ge.nearbySites=Gt,ge.dismissLoadingUI(),Gt.length}return 0})()}confirmNonDuplicate(){this.isNonDuplicateConfirmed=!0,this.next()}changeTemplatePOI(){this.selectedTemplatePOI=null}editPOI(ge){this.editExistingPOI(ge.ID)}editExistingPOI(ge){var ct=this;return(0,x.Z)(function*(){ct.skipPOICopy=!0,ct.isNonDuplicateConfirmed=!0,yield ct.presentLoadingUI(),ct.poiManager.getPOIById(ge,!0,!0).then(Gt=>{ct.item=Object.assign({},Gt),null==ct.item.OperatorID&&(ct.item.OperatorID=ae.UnknownOperator),ct.refreshFilteredReferenceData(),ct.dismissLoadingUI()})})()}useTemplatePOI(ge){this.selectedTemplatePOI=ge,Object.assign(this.item.Connections,ge.Connections);for(let ct of this.item.Connections)ct.ID=-Q.c.getRandomInt(1e4),ct.Reference=null,ct.Comments=null,ct.StatusTypeID=Te.Operational;this.item.UsageCost=ge.UsageCost,this.item.UsageTypeID=ge.UsageTypeID,this.appManager.referenceDataManager.hydrateCompactPOI(this.item)}skipCopyingPOI(){this.skipPOICopy=!0}}return(0,d.Z)(Qt,"\u0275fac",function(ge){return new(ge||Qt)(y.Y36(v.c),y.Y36(be.IN),y.Y36(ie.R),y.Y36(q.v),y.Y36(be.HT),y.Y36(be.Br))}),(0,d.Z)(Qt,"\u0275cmp",y.Xpm({type:Qt,selectors:[["app-poi-editor"]],viewQuery:function(ge,ct){if(1&ge&&y.Gf(Ne,5),2&ge){let Gt;y.iGM(Gt=y.CRH())&&(ct.editorMap=Gt.first)}},decls:33,vars:14,consts:[["slot","end"],[3,"click"],["name","close","slot","start"],[1,"ion-padding"],[3,"ngModel"],["value","location","layout","icon-start",3,"disabled"],["name","caret-forward",4,"ngIf"],["value","equipment","layout","icon-start",3,"disabled"],["value","info","layout","icon-start",3,"disabled"],[4,"ngIf"],["slot","start"],[3,"click",4,"ngIf"],["color","success",3,"click",4,"ngIf"],["name","caret-forward"],[3,"latitude","longitude","latitudeChange","longitudeChange","onUseSuggestedAddress"],["editorMap",""],["position","floating"],["type","text","autocapitalize","words","placeholder","A title for this location",3,"ngModel","ngModelChange"],["type","text","autocapitalize","words","placeholder","The nearest street address",3,"ngModel","ngModelChange"],["type","text","autocapitalize","words","placeholder","Optional",3,"ngModel","ngModelChange"],["type","text","autocapitalize","words","placeholder","Town or City",3,"ngModel","ngModelChange"],["type","text",3,"ngModel","ngModelChange"],["type","text","autocapitalize","words","placeholder","Optional Postal Code",3,"ngModel","ngModelChange"],[3,"ngModel","ngModelChange","ionChange"],[3,"value",4,"ngFor","ngForOf"],["label","Latitude","labelPlacement","floating","type","number","placeholder","Latitude (if entering manually)",3,"ngModel","ngModelChange"],["label","Longitude","labelPlacement","floating","type","number","placeholder","Longitude (if entering manually)",3,"ngModel","ngModelChange"],[3,"value"],[1,"instruction"],[3,"poiList","enableEditOption","onEdit"],[3,"operatorId","operatorChanged"],["slot","start","size","small",3,"click"],[3,"enableCopyOption","poiList","onCopy"],[3,"operatorId","useFilteredOperators","operatorChanged"],["label","Number of Stations or Parking Bays","labelPlacement","floating","min","1","type","number",3,"ngModel","ngModelChange"],["size","small",3,"click"],["name","add","slot","icon-only"],[3,"item","enableEdit","onEdit","onDelete"],["color","warning",4,"ngIf"],[3,"ngModel","ngModelChange"],["type","text","autocapitalize","sentences",3,"ngModel","ngModelChange"],["type","tel","placeholder","",3,"ngModel","ngModelChange"],["type","text","autocapitalize","sentences","placeholder","Instructions for access or tips for finding charging location",3,"ngModel","ngModelChange"],["type","url","placeholder","Website related to this site",3,"ngModel","ngModelChange"],["color","warning"],["color","danger"],["name","caret-back","slot","start"],["name","caret-forward","slot","end"],["color","success",3,"click"],["name","send","slot","end"]],template:function(ge,ct){1&ge&&(y.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),y._uU(3),y.qZA(),y.TgZ(4,"ion-buttons",0)(5,"ion-button",1),y.NdJ("click",function(){return ct.cancel()}),y._UZ(6,"ion-icon",2),y._uU(7," Cancel "),y.qZA()()()(),y.TgZ(8,"ion-content",3),y.ynx(9),y.TgZ(10,"ion-segment",4)(11,"ion-segment-button",5),y.YNc(12,gt,1,0,"ion-icon",6),y.TgZ(13,"ion-label"),y._uU(14,"Location"),y.qZA()(),y.TgZ(15,"ion-segment-button",7),y.YNc(16,Be,1,0,"ion-icon",6),y.TgZ(17,"ion-label"),y._uU(18,"Equipment"),y.qZA()(),y.TgZ(19,"ion-segment-button",8),y.YNc(20,Bt,1,0,"ion-icon",6),y.TgZ(21,"ion-label"),y._uU(22,"Info"),y.qZA()()(),y.YNc(23,mn,3,2,"ng-container",9),y.YNc(24,gi,3,2,"ng-container",9),y.YNc(25,Hi,38,11,"ng-container",9),y.BQk(),y.qZA(),y.TgZ(26,"ion-footer")(27,"ion-toolbar")(28,"ion-buttons",10),y.YNc(29,Fi,3,0,"ion-button",11),y.qZA(),y.TgZ(30,"ion-buttons",0),y.YNc(31,ii,3,0,"ion-button",11),y.YNc(32,mi,3,0,"ion-button",12),y.qZA()()()),2&ge&&(y.xp6(3),y.Oqu(ct.isAddMode?"Add Location":"Edit Location"),y.xp6(7),y.Q6J("ngModel",ct.selectedTab),y.xp6(1),y.Q6J("disabled",!0),y.xp6(1),y.Q6J("ngIf","location"==ct.selectedTab),y.xp6(3),y.Q6J("disabled",!0),y.xp6(1),y.Q6J("ngIf","equipment"==ct.selectedTab),y.xp6(3),y.Q6J("disabled",!0),y.xp6(1),y.Q6J("ngIf","info"==ct.selectedTab),y.xp6(3),y.Q6J("ngIf","location"==ct.selectedTab),y.xp6(1),y.Q6J("ngIf","equipment"==ct.selectedTab),y.xp6(1),y.Q6J("ngIf","info"==ct.selectedTab),y.xp6(4),y.Q6J("ngIf","location"!=ct.step),y.xp6(2),y.Q6J("ngIf",!ct.isReadyToSubmit&&"info"!=ct.step),y.xp6(1),y.Q6J("ngIf",ct.isReadyToSubmit))},dependencies:[_e.sg,_e.O5,_t.JJ,_t.On,be.YG,be.Sm,be.W2,be.fr,be.Gu,be.gu,be.pK,be.Ie,be.Q$,be.q_,be.cJ,be.GO,be.t9,be.n0,be.wd,be.sr,be.as,be.QI,be.j9,Ze.o,Ae.B,Ne,Ve],styles:['ul.breadcrumb[_ngcontent-%COMP%]{display:inline-flex;margin:0;padding:0}ul.breadcrumb[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{display:inline-flex;margin-right:6px;color:var(--ion-color-light-shade);font-size:10px}ul.breadcrumb[_ngcontent-%COMP%]   li.active[_ngcontent-%COMP%]{color:var(--ion-color-dark-shade)}ul.breadcrumb[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:before{content:">";padding-right:4px}']})),Qt})()},3247:(zn,Dt,R)=>{"use strict";R.d(Dt,{u:()=>Te});var x=R(1180),d=R(2029),v=R(7852),s=R(3052),Q=R(989),ie=R(9127),q=R(7430),y=R(9862);let fe=(()=>{class ae{constructor(we,Ze){(0,x.Z)(this,"http",void 0),(0,x.Z)(this,"journeyManager",void 0),this.http=we,this.journeyManager=Ze}getDirections(we,Ze){return new Promise((Ae,ve)=>{(new google.maps.DirectionsService).route({origin:we,destination:Ze,travelMode:google.maps.TravelMode.DRIVING},(dt,mt)=>{mt===google.maps.DirectionsStatus.OK?Ae(dt):ve(mt)})})}analyseRoutes(we,Ze){const Ae=new Array;return we.routes.forEach(ve=>{const en=new q.JJ;en.Title=""+Ae.length+1,en.JourneyRouteLegs=new Array,en.TotalDistanceKM=0,en.TotalDurationMinutes=0,en.TotalEnergykWh=0,ve.legs.forEach(dt=>{const mt=dt.duration.value,lt=dt.distance.value/1e3,ze=this.journeyManager.calculateEnergyConsumptionkWh(lt,0,null,Ze),xt=new q.eN;xt.DistanceKM=lt,xt.DurationMinutes=mt/60,xt.EnergyConsumptionkWh=ze,en.JourneyRouteLegs.push(xt),en.TotalDistanceKM+=xt.DistanceKM,en.TotalDurationMinutes+=xt.DurationMinutes,en.TotalEnergykWh=xt.EnergyConsumptionkWh}),Ae.push(en)}),Ae}}return(0,x.Z)(ae,"\u0275fac",function(we){return new(we||ae)(d.LFG(y.eN),d.LFG(Q.i))}),(0,x.Z)(ae,"\u0275prov",d.Yz7({token:ae,factory:ae.\u0275fac,providedIn:"root"})),ae})();var Se=R(1847),De=R(6814),X=R(6223),se=R(5460);function Ee(ae,yt){if(1&ae){const we=d.EpF();d.TgZ(0,"ion-item"),d._UZ(1,"ion-icon",12),d.TgZ(2,"ion-searchbar",13),d.NdJ("ngModelChange",function(Ae){d.CHM(we);const ve=d.oxw();return d.KtG(ve.routeStart=Ae)})("ionInput",function(Ae){d.CHM(we),d.oxw();const ve=d.MAs(18);return d.KtG(ve.getPlacesAutoComplete(Ae,"routeStart"))})("ionCancel",function(Ae){d.CHM(we);const ve=d.oxw();return d.KtG(ve.onPlaceSearchCancel(Ae))}),d.qZA()()}if(2&ae){const we=d.oxw();d.xp6(2),d.Q6J("ngModel",we.routeStart)("debounce",500)}}function _e(ae,yt){if(1&ae){const we=d.EpF();d.TgZ(0,"ion-item",14),d.NdJ("click",function(){d.CHM(we);const Ae=d.oxw();return d.KtG(Ae.clearRouteStart())}),d._UZ(1,"ion-icon",12),d.TgZ(2,"h2"),d._uU(3),d.qZA()()}if(2&ae){d.oxw();const we=d.MAs(18);d.xp6(3),d.Oqu(null==we.selectedPlace?null:we.selectedPlace.name)}}function be(ae,yt){if(1&ae){const we=d.EpF();d.TgZ(0,"ion-item"),d._UZ(1,"ion-icon",15),d.TgZ(2,"ion-searchbar",16),d.NdJ("ngModelChange",function(Ae){d.CHM(we);const ve=d.oxw();return d.KtG(ve.routeDestination=Ae)})("ionInput",function(Ae){d.CHM(we),d.oxw();const ve=d.MAs(20);return d.KtG(ve.getPlacesAutoComplete(Ae,"routeDestination"))})("ionCancel",function(Ae){d.CHM(we);const ve=d.oxw();return d.KtG(ve.onPlaceSearchCancel(Ae))}),d.qZA()()}if(2&ae){const we=d.oxw();d.xp6(2),d.Q6J("ngModel",we.routeDestination)("debounce",500)}}function Re(ae,yt){if(1&ae){const we=d.EpF();d.TgZ(0,"ion-item",14),d.NdJ("click",function(){d.CHM(we);const Ae=d.oxw();return d.KtG(Ae.clearRouteDestination())}),d._UZ(1,"ion-icon",15),d.TgZ(2,"h2"),d._uU(3),d.qZA()()}if(2&ae){d.oxw();const we=d.MAs(20);d.xp6(3),d.Oqu(null==we.selectedPlace?null:we.selectedPlace.name)}}function Ne(ae,yt){if(1&ae){const we=d.EpF();d.TgZ(0,"ion-button",14),d.NdJ("click",function(){d.CHM(we);const Ae=d.oxw();return d.KtG(Ae.clearRoute())}),d._UZ(1,"ion-icon",17),d._uU(2," Clear Route "),d.qZA()}}function qe(ae,yt){if(1&ae){const we=d.EpF();d.TgZ(0,"ion-button",14),d.NdJ("click",function(){d.CHM(we);const Ae=d.oxw();return d.KtG(Ae.showSettings())}),d._uU(1," Show Settings "),d._UZ(2,"ion-icon",18),d.qZA()}}function _t(ae,yt){if(1&ae){const we=d.EpF();d.TgZ(0,"ion-button",14),d.NdJ("click",function(){d.CHM(we);const Ae=d.oxw();return d.KtG(Ae.hideSettings())}),d._uU(1," Hide Settings "),d._UZ(2,"ion-icon",18),d.qZA()}}function Je(ae,yt){1&ae&&(d.TgZ(0,"p",19),d._UZ(1,"ion-spinner",19),d._uU(2," Calculating Route.. "),d.qZA())}function Me(ae,yt){if(1&ae&&(d.TgZ(0,"ion-list")(1,"ion-list-header"),d._uU(2),d.ALo(3,"number"),d.ALo(4,"number"),d.qZA()()),2&ae){const we=d.oxw();d.xp6(2),d.lnq(" Total Distance ",d.xi3(3,3,we.selectedJourneyRoute.TotalDistanceKM,"1.0-2")," km, ",we.formatDuration(we.selectedJourneyRoute.TotalDurationMinutes),", ",d.xi3(4,6,we.selectedJourneyRoute.TotalEnergykWh,"1.0-2")," kWh ")}}function it(ae,yt){if(1&ae){const we=d.EpF();d.TgZ(0,"div")(1,"ion-list")(2,"ion-list-header"),d._UZ(3,"ion-icon",20),d._uU(4," Route Settings "),d.qZA(),d.TgZ(5,"ion-item")(6,"ion-label",21),d._uU(7),d.qZA(),d.TgZ(8,"ion-range",22),d.NdJ("ngModelChange",function(Ae){d.CHM(we);const ve=d.oxw();return d.KtG(ve.routeSearchDistance=Ae)}),d._UZ(9,"ion-icon",23)(10,"ion-icon",24),d.qZA()(),d.TgZ(11,"ion-item")(12,"ion-label",21),d._uU(13,"Energy Efficiency (kWh Per km)"),d.qZA(),d.TgZ(14,"ion-input",25),d.NdJ("ngModelChange",function(Ae){d.CHM(we);const ve=d.oxw();return d.KtG(ve.kWhPerKM=Ae)}),d.qZA()()()()}if(2&ae){const we=d.oxw();d.xp6(7),d.hij("Search Distance (",we.routeSearchDistance,")"),d.xp6(1),d.Q6J("ngModel",we.routeSearchDistance),d.xp6(6),d.Q6J("ngModel",we.kWhPerKM)}}let Xe=(()=>{class ae{constructor(we,Ze,Ae,ve,en,dt){(0,x.Z)(this,"mapping",void 0),(0,x.Z)(this,"logging",void 0),(0,x.Z)(this,"directions",void 0),(0,x.Z)(this,"journeyManager",void 0),(0,x.Z)(this,"changeDetector",void 0),(0,x.Z)(this,"numberPipe",void 0),(0,x.Z)(this,"routeSearchDistance",5),(0,x.Z)(this,"journeyRoutes",void 0),(0,x.Z)(this,"selectedJourneyRoute",void 0),(0,x.Z)(this,"routePolyline",void 0),(0,x.Z)(this,"kWhPerKM",void 0),(0,x.Z)(this,"routeStartPlace",void 0),(0,x.Z)(this,"routeDestinationPlace",void 0),(0,x.Z)(this,"routeCalcInProgress",!1),(0,x.Z)(this,"advancedSettingsMode",!1),(0,x.Z)(this,"routeStart",""),(0,x.Z)(this,"routeDestination",""),this.mapping=we,this.logging=Ze,this.directions=Ae,this.journeyManager=ve,this.changeDetector=en,this.numberPipe=dt,this.kWhPerKM=.212}get isRouteSet(){return null!=this.routeStartPlace&&null!=this.routeDestinationPlace}showSettings(){this.advancedSettingsMode=!0}hideSettings(){this.advancedSettingsMode=!1}routeStartSelected(we){this.routeStartPlace=we,this.calculateRoute(),this.changeDetector.detectChanges()}routeDestinationSelected(we){this.routeDestinationPlace=we,this.calculateRoute(),this.changeDetector.detectChanges()}clearRouteStart(){this.routeStartPlace=null,this.changeDetector.detectChanges()}clearRouteDestination(){this.routeDestinationPlace=null,this.changeDetector.detectChanges()}clearRoute(){this.routeStartPlace=null,this.routeDestinationPlace=null,this.journeyManager.setRoutePolyline(null),this.mapping.clearPolyline()}formatDuration(we){if(we<=60)return this.numberPipe.transform(we,"1.0-2")+" mins";{const Ze=Math.round(we/60),Ae=Math.floor(we-60*Ze);return Ze+" hours "+(Ae>0?Ae+" mins":"")}}calculateRoute(){null!=this.routeStartPlace&&null!=this.routeDestinationPlace&&(this.logging.log("Fetching route directions.."),this.routeCalcInProgress=!0,this.directions.getDirections(this.routeStartPlace.Location.latitude+","+this.routeStartPlace.Location.longitude,this.routeDestinationPlace.Location.latitude+","+this.routeDestinationPlace.Location.longitude).then(we=>{if(null!=we.routes&&we.routes.length>0){this.logging.log("Got route directions, analysing.."),this.routePolyline=we.routes[0].overview_polyline;const Ze=we.routes[0].bounds.getSouthWest(),Ae=we.routes[0].bounds.getNorthEast(),ve=new s.wC(Ae.lat(),Ae.lng()),en=new s.wC(Ze.lat(),Ze.lng()),dt=new s.LL(ve,en);this.journeyRoutes=this.directions.analyseRoutes(we,this.kWhPerKM),this.journeyRoutes.length>0&&(this.selectedJourneyRoute=this.journeyRoutes[0]),this.journeyManager.setRoutePolyline(this.routePolyline),this.mapping.renderPolyline(this.routePolyline),this.mapping.moveToMapBounds(dt)}else this.logging.log("No route returned..");this.routeCalcInProgress=!1}))}}return(0,x.Z)(ae,"\u0275fac",function(we){return new(we||ae)(d.Y36(Se.v),d.Y36(ie.z),d.Y36(fe),d.Y36(Q.i),d.Y36(d.sBO),d.Y36(De.JJ))}),(0,x.Z)(ae,"\u0275cmp",d.Xpm({type:ae,selectors:[["route-planner"]],decls:24,vars:10,consts:[[1,"route"],[1,"route-places"],["name","map","slot","start"],[4,"ngIf"],[3,"click",4,"ngIf"],["primary",""],["slot","secondary"],["slot","primary"],[3,"placeChanged"],["placeSearchRouteStart",""],["placeSearchRouteDestination",""],["class","ion-padding",4,"ngIf"],["name","ionic","item-left",""],["placeholder","Starting Point",3,"ngModel","debounce","ngModelChange","ionInput","ionCancel"],[3,"click"],["name","pin","item-left",""],["placeholder","Destination",3,"ngModel","debounce","ngModelChange","ionInput","ionCancel"],["name","close","slot","start"],["name","cog","slot","end"],[1,"ion-padding"],["name","cog"],["position","stacked"],["min","1","max","200","step","5","snaps","true","pin","true","light","",3,"ngModel","ngModelChange"],["slot","start","small","","name","map"],["slot","end","large","","name","map"],["type","number","min","0.1","max","1",3,"ngModel","ngModelChange"]],template:function(we,Ze){1&we&&(d.TgZ(0,"div",0)(1,"div",1)(2,"ion-list")(3,"ion-list-header"),d._UZ(4,"ion-icon",2),d.TgZ(5,"ion-label"),d._uU(6,"Plan Your Journey"),d.qZA()(),d.YNc(7,Ee,3,2,"ion-item",3),d.YNc(8,_e,4,1,"ion-item",4),d.YNc(9,be,3,2,"ion-item",3),d.YNc(10,Re,4,1,"ion-item",4),d.qZA(),d.TgZ(11,"ion-toolbar",5)(12,"ion-buttons",6),d.YNc(13,Ne,3,0,"ion-button",4),d.qZA(),d.TgZ(14,"ion-buttons",7),d.YNc(15,qe,3,0,"ion-button",4),d.YNc(16,_t,3,0,"ion-button",4),d.qZA()()(),d.TgZ(17,"place-search",8,9),d.NdJ("placeChanged",function(ve){return Ze.routeStartSelected(ve)}),d.qZA(),d.TgZ(19,"place-search",8,10),d.NdJ("placeChanged",function(ve){return Ze.routeDestinationSelected(ve)}),d.qZA(),d.YNc(21,Je,3,0,"p",11),d.YNc(22,Me,5,9,"ion-list",3),d.YNc(23,it,15,3,"div",3),d.qZA()),2&we&&(d.xp6(7),d.Q6J("ngIf",null==Ze.routeStartPlace),d.xp6(1),d.Q6J("ngIf",null!=Ze.routeStartPlace),d.xp6(1),d.Q6J("ngIf",null==Ze.routeDestinationPlace),d.xp6(1),d.Q6J("ngIf",null!=Ze.routeDestinationPlace),d.xp6(3),d.Q6J("ngIf",Ze.isRouteSet),d.xp6(2),d.Q6J("ngIf",!Ze.advancedSettingsMode),d.xp6(1),d.Q6J("ngIf",Ze.advancedSettingsMode),d.xp6(5),d.Q6J("ngIf",Ze.routeCalcInProgress),d.xp6(1),d.Q6J("ngIf",null!=Ze.selectedJourneyRoute),d.xp6(1),d.Q6J("ngIf",Ze.advancedSettingsMode))},dependencies:[De.O5,v.YG,v.Sm,v.gu,v.pK,v.Ie,v.Q$,v.q_,v.yh,v.I_,v.VI,v.PQ,v.sr,v.as,v.QI,v.j9,X.JJ,X.On,se.v,De.JJ],encapsulation:2})),ae})(),Te=(()=>{class ae{constructor(we){(0,x.Z)(this,"modalController",void 0),(0,x.Z)(this,"hasNavbar",!1),this.modalController=we}close(){this.modalController.dismiss()}}return(0,x.Z)(ae,"\u0275fac",function(we){return new(we||ae)(d.Y36(v.IN))}),(0,x.Z)(ae,"\u0275cmp",d.Xpm({type:ae,selectors:[["ng-component"]],decls:10,vars:0,consts:[["slot","end"],[3,"click"],["name","close","slot","end"],[1,"route-planner","ion-padding"]],template:function(we,Ze){1&we&&(d.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),d._uU(3," Route Planner "),d.qZA(),d.TgZ(4,"ion-buttons",0)(5,"ion-button",1),d.NdJ("click",function(){return Ze.close()}),d._UZ(6,"ion-icon",2),d._uU(7," Close "),d.qZA()()()(),d.TgZ(8,"ion-content",3),d._UZ(9,"route-planner"),d.qZA())},dependencies:[v.YG,v.Sm,v.W2,v.Gu,v.gu,v.wd,v.sr,Xe],encapsulation:2})),ae})()},4606:(zn,Dt,R)=>{"use strict";R.r(Dt),R.d(Dt,{SearchPageModule:()=>an});var x=R(1180),d=R(5086),v=R(3999),s=R(6814),Q=R(6223),ie=R(7852),q=R(2125),y=R(5861),fe=R(553),Se=R(7777),De=R(4119),X=R(3247),se=R(9723),Ee=R(3052),_e=R(4677),be=R(866),Re=R(9127),Ne=R(989),qe=R(1847),_t=R(4669),Je=R(1618),Me=R(5460),it=R(2438),Xe=R(7394);class Te extends Xe.w0{constructor(St,st){super()}schedule(St,st=0){return this}}const ae={setInterval(Vt,St,...st){const{delegate:qt}=ae;return qt?.setInterval?qt.setInterval(Vt,St,...st):setInterval(Vt,St,...st)},clearInterval(Vt){const{delegate:St}=ae;return(St?.clearInterval||clearInterval)(Vt)},delegate:void 0};var yt=R(9039),Ze=R(4552);class Ae{constructor(St,st=Ae.now){this.schedulerActionCtor=St,this.now=st}schedule(St,st=0,qt){return new this.schedulerActionCtor(this,St).schedule(qt,st)}}Ae.now=Ze.l.now;const en=new class ve extends Ae{constructor(St,st=Ae.now){super(St,st),this.actions=[],this._active=!1}flush(St){const{actions:st}=this;if(this._active)return void st.push(St);let qt;this._active=!0;do{if(qt=St.execute(St.state,St.delay))break}while(St=st.shift());if(this._active=!1,qt){for(;St=st.shift();)St.unsubscribe();throw qt}}}(class we extends Te{constructor(St,st){super(St,st),this.scheduler=St,this.work=st,this.pending=!1}schedule(St,st=0){var qt;if(this.closed)return this;this.state=St;const dn=this.id,Sn=this.scheduler;return null!=dn&&(this.id=this.recycleAsyncId(Sn,dn,st)),this.pending=!0,this.delay=st,this.id=null!==(qt=this.id)&&void 0!==qt?qt:this.requestAsyncId(Sn,this.id,st),this}requestAsyncId(St,st,qt=0){return ae.setInterval(St.flush.bind(St,this),qt)}recycleAsyncId(St,st,qt=0){if(null!=qt&&this.delay===qt&&!1===this.pending)return st;null!=st&&ae.clearInterval(st)}execute(St,st){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const qt=this._execute(St,st);if(qt)return qt;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(St,st){let dn,qt=!1;try{this.work(St)}catch(Sn){qt=!0,dn=Sn||new Error("Scheduled action threw falsy error")}if(qt)return this.unsubscribe(),dn}unsubscribe(){if(!this.closed){const{id:St,scheduler:st}=this,{actions:qt}=st;this.work=this.state=this.scheduler=null,this.pending=!1,(0,yt.P)(qt,this),null!=St&&(this.id=this.recycleAsyncId(st,St,null)),this.delay=null,super.unsubscribe()}}});var mt=R(9360),lt=R(8251);const Ve=(0,R(2726).fo)("Geolocation",{web:()=>R.e(579).then(R.bind(R,579)).then(Vt=>new Vt.GeolocationWeb)});var gt=R(2029),Be=R(5957);function Bt(Vt,St){1&Vt&&gt._UZ(0,"ion-icon",13)}function Wt(Vt,St){1&Vt&&gt._UZ(0,"ion-spinner")}function wn(Vt,St){if(1&Vt){const st=gt.EpF();gt.TgZ(0,"ion-button",3),gt.NdJ("click",function(){gt.CHM(st);const dn=gt.oxw();return gt.KtG(dn.openSideView())}),gt._UZ(1,"ion-icon",14),gt.qZA()}}function Xt(Vt,St){1&Vt&&(gt.ynx(0),gt.TgZ(1,"div",15)(2,"p"),gt._uU(3,"There was a problem communicating with Open Charge Map. Please check your data connection."),gt.qZA()(),gt.BQk())}let mn=(()=>{class Vt{constructor(st,qt,dn,Sn,zt,gi,$i,Ci,Ji,Hi,Fi,ii){(0,x.Z)(this,"appManager",void 0),(0,x.Z)(this,"nav",void 0),(0,x.Z)(this,"events",void 0),(0,x.Z)(this,"translate",void 0),(0,x.Z)(this,"platform",void 0),(0,x.Z)(this,"poiManager",void 0),(0,x.Z)(this,"mapping",void 0),(0,x.Z)(this,"journeyManager",void 0),(0,x.Z)(this,"zone",void 0),(0,x.Z)(this,"modalController",void 0),(0,x.Z)(this,"alertController",void 0),(0,x.Z)(this,"logging",void 0),(0,x.Z)(this,"mapDisplayed",!1),(0,x.Z)(this,"debouncedRefreshMapResults",void 0),(0,x.Z)(this,"mapCanvasID",void 0),(0,x.Z)(this,"initialResultsShown",!1),(0,x.Z)(this,"searchOnDemand",!1),(0,x.Z)(this,"poiViewMode","modal"),(0,x.Z)(this,"sideViewAvailable",!1),(0,x.Z)(this,"searchPolyline",void 0),(0,x.Z)(this,"routePlanningMode",!0),(0,x.Z)(this,"searchKeyword",""),(0,x.Z)(this,"selectedPOI",void 0),(0,x.Z)(this,"appConfig",new Se.X),(0,x.Z)(this,"defaultMapZoom",15),(0,x.Z)(this,"defaultStartPos",new Ee.wC(37.415328,-122.076575)),(0,x.Z)(this,"placeSearchMapPOI",void 0),(0,x.Z)(this,"_watchId",null),this.appManager=st,this.nav=qt,this.events=dn,this.translate=Sn,this.platform=zt,this.poiManager=gi,this.mapping=$i,this.journeyManager=Ci,this.zone=Ji,this.modalController=Hi,this.alertController=Fi,this.logging=ii,this.mapCanvasID="map-canvas",this.mapping.setMapType(st.searchSettings.MapType),this.mapping.setMapAPI(fe.N.defaultMapProvider),(0,it.R)(window,"resize").pipe(function ze(Vt,St=en){return(0,mt.e)((st,qt)=>{let dn=null,Sn=null,zt=null;const gi=()=>{if(dn){dn.unsubscribe(),dn=null;const Ci=Sn;Sn=null,qt.next(Ci)}};function $i(){const Ci=zt+Vt,Ji=St.now();if(Ji<Ci)return dn=this.schedule(void 0,Ci-Ji),void qt.add(dn);gi()}st.subscribe((0,lt.x)(qt,Ci=>{Sn=Ci,zt=St.now(),dn||(dn=St.schedule($i,Vt),qt.add(dn))},()=>{gi(),qt.complete()},void 0,()=>{Sn=dn=null}))})}(500)).subscribe(xn=>{let Qt={width:be.c.getClientHeight(),height:be.c.getClientWidth()};this.events.publish("ocm:window:resized",[Qt])})}ionViewDidEnter(){this.logging.log("Entered search page.",Re.i.VERBOSE),this.mapping.focusMap(),this.mapping.updateMapSize()}ionViewWillLeave(){this.logging.log("Leaving search page.",Re.i.VERBOSE),this.mapping.unfocusMap()}getPreferredMapHeight(st){return null==st&&(st=be.c.getClientHeight()),st-56}enforceMapHeight(st){this.logging.log("Would resize map:"+st.width+" "+st.height,Re.i.VERBOSE);const qt=this.getPreferredMapHeight(st[0]);document.getElementById(this.mapCanvasID).offsetHeight!==qt&&(document.getElementById(this.mapCanvasID).style.height=qt+"px"),this.mapping&&(this.logging.log("Map height:"+qt,Re.i.VERBOSE),this.mapping.updateMapSize())}initialiseMapping(){var st=this;return(0,y.Z)(function*(){yield st.platform.ready(),st.debouncedRefreshMapResults=be.c.debounce(st.refreshMapResults,1e3,!1),st.events.subscribe("ocm:mapping:ready",(0,y.Z)(function*(){if(st.logging.log("init map: mapping ready"),st.mapping&&st.mapping.updateMapSize(),!st.initialResultsShown)if(st.appManager.searchSettings.StartSearchPosition&&!st.appManager.searchSettings.StartViewPoiId)st.searchOnDemand=!0,st.mapping.updateMapCentrePos(st.appManager.searchSettings.StartSearchPosition.latitude,st.appManager.searchSettings.StartSearchPosition.longitude,!0,st.defaultMapZoom);else{let qt=localStorage.getItem("_locationEnabled");1==st.appManager.isEmbeddedMode&&"true"!=qt?yield(yield st.alertController.create({header:"Search using your location?",message:"Select OK to continue.",buttons:[{text:"Cancel",role:"cancel",cssClass:"secondary",handler:(Sn=(0,y.Z)(function*(zt){yield st.useFallbackPosition()}),function(gi){return Sn.apply(this,arguments)})},{text:"OK",handler:function(){var Sn=(0,y.Z)(function*(){yield st.locateUser()});return function(){return Sn.apply(this,arguments)}}()}]})).present():(yield st.locateUser(),st.mapping&&st.mapping.updateMapSize())}var Sn})),st.events.subscribe("ocm:mapping:zoom",()=>{st.debouncedRefreshMapResults()}),st.events.subscribe("ocm:mapping:dragend",()=>{st.debouncedRefreshMapResults()}),st.events.subscribe("ocm:poiList:updated",qt=>{st.showPOIListOnMap(qt)}),st.events.subscribe("ocm:poiList:cleared",()=>{st.mapping.clearMarkers(),setTimeout(()=>{st.debouncedRefreshMapResults()},500)}),st.events.subscribe("ocm:window:resized",qt=>{null!=qt&&qt.length>0&&st.enforceMapHeight(qt[0])}),st.events.subscribe("ocm:poi:selected",qt=>{if(qt.poi)st.viewPOIDetails(qt,qt.poi);else{let dn=st.getPOIByID(qt.poiId);st.viewPOIDetails(qt,dn)}}),st.mapping.initMap(st.mapCanvasID)})()}ngAfterViewInit(){var st=this;return(0,y.Z)(function*(){yield st.initialiseMapping()})()}ngOnInit(){var st=this;return(0,y.Z)(function*(){st.logging.log("Refreshing reference data ..",Re.i.VERBOSE),(yield st.appManager.referenceDataManager.refreshReferenceData(st.appManager.api))||(st.appManager.isOffline=!0)})()}showPOIListOnMap(st){const qt=this.getPreferredMapHeight(null);this.mapping.refreshMapView(qt,this.poiManager.poiList,null),this.mapDisplayed||(this.mapDisplayed=!0)}getIconForPOI(st){return be.c.getIconForPOI(st)}getPOIByID(st){const qt=this.poiManager.poiList;for(let dn=0;dn<qt.length;dn++)if(qt[dn].ID===st)return qt[dn];return null}refreshMapResults(){var st=this;return(0,y.Z)(function*(){if(!st.searchOnDemand)return void st.logging.log("Skipping refresh, search on demand disabled..",Re.i.VERBOSE);st.logging.log("Refreshing Results..",Re.i.VERBOSE);const qt=new _e.b;let dn=null;if(st.appManager.searchSettings.StartViewPoiId){let zt=st.appManager.searchSettings.StartViewPoiId;st.appManager.searchSettings.StartViewPoiId=null;let gi=yield st.poiManager.getPOIById(zt);gi&&(st.events.publish("ocm:poi:selected",{poiId:gi.ID,poi:gi}),st.mapping.updateMapCentrePos(gi.AddressInfo.Latitude,gi.AddressInfo.Longitude,!0,st.defaultMapZoom))}if(st.appManager.searchSettings.StartSearchPosition&&(dn=new Ee.jR(st.appManager.searchSettings.StartSearchPosition.latitude,st.appManager.searchSettings.StartSearchPosition.longitude),st.appManager.searchSettings.StartSearchPosition=null),dn&&0==dn.coords.latitude&&0==dn.coords.longitude)return void st.logging.log("Map center is zero. No query will be performed",Re.i.WARNING);if(null!=dn)qt.latitude=dn.coords.latitude,qt.longitude=dn.coords.longitude,qt.distance=25,qt.boundingbox=null,st.appManager.searchSettings.LastSearchPosition=new Ee.wC(dn.coords.latitude,dn.coords.longitude);else{qt.latitude=null,qt.longitude=null;let zt=yield st.mapping.getMapBounds().toPromise();qt.boundingbox="("+zt[0].latitude+","+zt[0].longitude+"),("+zt[1].latitude+","+zt[1].longitude+")",st.logging.log(JSON.stringify(zt),Re.i.VERBOSE)}qt.includeComments=!0,qt.enableCaching=!0,null!=st.appManager.searchSettings&&(null!=st.appManager.searchSettings.ConnectionTypeList&&(qt.connectionTypeIdList=st.appManager.searchSettings.ConnectionTypeList),null!=st.appManager.searchSettings.UsageTypeList&&(qt.usageTypeIdList=st.appManager.searchSettings.UsageTypeList),null!=st.appManager.searchSettings.StatusTypeList&&(qt.statusTypeIdList=st.appManager.searchSettings.StatusTypeList),null!=st.appManager.searchSettings.OperatorList&&(qt.operatorIdList=st.appManager.searchSettings.OperatorList),null!=st.appManager.searchSettings.MinPowerKW&&st.appManager.searchSettings.MinPowerKW>0&&(qt.minPowerKW=st.appManager.searchSettings.MinPowerKW),null!=st.appManager.searchSettings.MaxPowerKW&&st.appManager.searchSettings.MaxPowerKW>0&&(qt.maxPowerKW=st.appManager.searchSettings.MaxPowerKW),null!=st.appManager.searchSettings.MaxResults&&st.appManager.searchSettings.MaxResults>0&&st.appManager.searchSettings.MaxResults<=1e4&&(qt.maxResults=st.appManager.searchSettings.MaxResults),null!=st.journeyManager.getRoutePolyline()&&(qt.polyline=st.journeyManager.getRoutePolyline(),qt.boundingbox=null,qt.levelOfDetail=null,qt.latitude=null,qt.longitude=null)),st.appManager.isRequestInProgress=!0;let Sn=yield st.poiManager.refreshPOIList(qt);st.appManager.isRequestInProgress=!1,st.initialResultsShown=!0,Sn>=qt.maxResults&&st.appManager.showToastNotification("A maximum of "+Sn+" results are returned per search. Zoom in for details.")})()}viewPOIDetails(st,qt){this.logging.log("Viewing/fetching ["+this.poiViewMode+"] POI Details "+st.poiId),null!=qt?(this.mapping.unfocusMap(),this.modalController.create({component:se.H,componentProps:{item:qt}}).then(dn=>{dn.onDidDismiss().then(()=>{this.logging.log("Dismissing POI Details."),this.mapping.focusMap(),this.searchOnDemand=!0}),dn.present()})):this.poiManager.getPOIById(st.poiId,!0).then(dn=>{this.logging.log("Got POI Details "+dn.ID),"modal"===this.poiViewMode&&(this.searchOnDemand=!1,this.modalController.create({component:se.H,componentProps:{item:dn}}).then(Sn=>{Sn.onDidDismiss().then(()=>{this.logging.log("Dismissing POI Details."),this.mapping.focusMap(),this.searchOnDemand=!0}),Sn.present()}),this.mapping.unfocusMap()),"side"===this.poiViewMode&&(this.selectedPOI=dn)},dn=>{this.appManager.showToastNotification("POI Details not available")})}closePOIDetails(){this.selectedPOI=null}openRoutePlannerModal(){this.searchOnDemand=!1,this.mapping.unfocusMap(),this.modalController.create({component:X.u}).then(st=>{st.onDidDismiss().then(qt=>{this.logging.log("Dismissing Route Planner Details."),this.mapping.focusMap(),this.searchOnDemand=!0}),st.present()})}openSearchOptions(){this.searchOnDemand=!1,this.mapping.unfocusMap(),this.modalController.create({component:De.N}).then(st=>{st.onDidDismiss().then(qt=>{this.mapping.focusMap(),this.searchOnDemand=!0}),st.present()})}openSideView(){this.poiViewMode="side",this.mapping.updateMapSize()}closeSideView(){this.poiViewMode="modal",this.mapping.updateMapSize()}planRoute(){this.routePlanningMode=!0}search(st){this.placeSearchMapPOI.getPlacesAutoComplete(st,"poiSearch")}useFallbackPosition(){let st=this.defaultStartPos;null!=this.appManager.searchSettings.LastSearchPosition&&(st=this.appManager.searchSettings.LastSearchPosition),this.appManager.searchSettings.StartSearchPosition=st,this.appManager.searchSettings.LastSearchPosition=null,this.searchOnDemand=!0,this.mapping.updateMapCentrePos(st.latitude,st.longitude,!0,this.defaultMapZoom)}getPosition(st={}){var qt=this;return(0,y.Z)(function*(){return new Promise((dn,Sn)=>{qt._watchId=Ve.watchPosition(st,(zt,gi)=>{qt._watchId&&Ve.clearWatch({id:qt._watchId}),gi?Sn(gi):dn(zt)})})})()}locateUser(){var st=this;return(0,y.Z)(function*(){st.useFallbackPosition();try{st.logging.log("Attempting to locate user..");const qt=yield st.getPosition({timeout:1e4});if(!qt)throw"Failed to get user location.";return st.logging.log("Got user location."),st.appManager.searchSettings.StartSearchPosition=new Ee.wC(qt.coords.latitude,qt.coords.longitude),st.searchOnDemand=!0,st.mapping.updateMapCentrePos(qt.coords.latitude,qt.coords.longitude,!0,st.defaultMapZoom),localStorage.setItem("_locationEnabled","true"),!0}catch(qt){return st.logging.log("Failed to get user location. Searching using default or last position."+qt),st.appManager.showToastNotification("Your location could not be determined."),st.useFallbackPosition(),!1}})()}placeSelected(st){this.searchKeyword=st.Address,this.logging.log("Got place details:"+st.Address),this.mapping.focusMap(),this.mapping.updateMapCentrePos(st.Location.latitude,st.Location.longitude,!0),this.debouncedRefreshMapResults()}}return(0,x.Z)(Vt,"\u0275fac",function(st){return new(st||Vt)(gt.Y36(Je.c),gt.Y36(ie.SH),gt.Y36(Be.z),gt.Y36(v.sK),gt.Y36(ie.t4),gt.Y36(_t.R),gt.Y36(qe.v),gt.Y36(Ne.i),gt.Y36(gt.R0b),gt.Y36(ie.IN),gt.Y36(ie.Br),gt.Y36(Re.z))}),(0,x.Z)(Vt,"\u0275cmp",gt.Xpm({type:Vt,selectors:[["ng-component"]],viewQuery:function(st,qt){if(1&st&&gt.Gf(Me.v,7),2&st){let dn;gt.iGM(dn=gt.CRH())&&(qt.placeSearchMapPOI=dn.first)}},decls:18,vars:10,consts:[["slot","start"],["autocapitalize","on","autocomplete","on",3,"ngModel","placeholder","debounce","ngModelChange","ionInput"],["slot","end"],[3,"click"],["name","locate","slot","start",4,"ngIf"],[4,"ngIf"],[3,"color","click"],["name","options","slot","end"],[3,"click",4,"ngIf"],[1,"search-page"],[3,"placeChanged"],["placeSearchMapPOI",""],["id","map-canvas",2,"height","100%","width","100%","min-height","300px"],["name","locate","slot","start"],["name","car","title","Route","slot","end"],[2,"position","absolute"]],template:function(st,qt){1&st&&(gt.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),gt._UZ(3,"ion-menu-button"),gt.qZA(),gt.TgZ(4,"ion-searchbar",1),gt.NdJ("ngModelChange",function(Sn){return qt.searchKeyword=Sn})("ionInput",function(Sn){return qt.search(Sn)}),gt.ALo(5,"translate"),gt.qZA(),gt.TgZ(6,"ion-buttons",2)(7,"ion-button",3),gt.NdJ("click",function(){return qt.locateUser()}),gt.YNc(8,Bt,1,0,"ion-icon",4),gt.YNc(9,Wt,1,0,"ion-spinner",5),gt.qZA(),gt.TgZ(10,"ion-button",6),gt.NdJ("click",function(){return qt.openSearchOptions()}),gt._UZ(11,"ion-icon",7),gt.qZA(),gt.YNc(12,wn,2,0,"ion-button",8),gt.qZA()()(),gt.TgZ(13,"ion-content",9)(14,"place-search",10,11),gt.NdJ("placeChanged",function(Sn){return qt.placeSelected(Sn)}),gt.qZA(),gt.YNc(16,Xt,4,0,"ng-container",5),gt._UZ(17,"div",12),gt.qZA()),2&st&&(gt.xp6(4),gt.Q6J("ngModel",qt.searchKeyword)("placeholder",gt.lcZ(5,8,"ocm.search.performSearch"))("debounce",500),gt.xp6(4),gt.Q6J("ngIf",!qt.appManager.isRequestInProgress),gt.xp6(1),gt.Q6J("ngIf",qt.appManager.isRequestInProgress),gt.xp6(1),gt.Q6J("color",qt.appManager.searchSettings.HasActiveFilters?"danger":"default"),gt.xp6(2),gt.Q6J("ngIf",1==qt.sideViewAvailable&&"modal"==qt.poiViewMode),gt.xp6(4),gt.Q6J("ngIf",qt.appManager.isOffline))},dependencies:[s.O5,Q.JJ,Q.On,ie.YG,ie.Sm,ie.W2,ie.Gu,ie.gu,ie.fG,ie.VI,ie.PQ,ie.sr,ie.j9,Me.v,v.X$],styles:[".search-page[_ngcontent-%COMP%]   #map-canvas[_ngcontent-%COMP%]{width:100%;height:98%}.search-page[_ngcontent-%COMP%]   #place-search[_ngcontent-%COMP%]{min-height:300px;background-color:#f0f0f0;position:absolute;z-index:100;width:100%}.search-page[_ngcontent-%COMP%]   ion-buttons[_ngcontent-%COMP%]{flex:.4}.search-page[_ngcontent-%COMP%]   ion-grid[_ngcontent-%COMP%], .search-page[_ngcontent-%COMP%]   ion-row[_ngcontent-%COMP%], .search-page[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]{padding:0}.search-page[_ngcontent-%COMP%]   scroll-content[_ngcontent-%COMP%]{overflow-y:hidden}.search-page[_ngcontent-%COMP%]   .banner[_ngcontent-%COMP%]{padding-left:2em}.search-page[_ngcontent-%COMP%]   .sideview[_ngcontent-%COMP%]{background:rgb(238,238,238);background:linear-gradient(to bottom,rgb(238,238,238) 0%,rgb(255,255,255) 100%)}"]})),Vt})(),an=(()=>{class Vt{}return(0,x.Z)(Vt,"\u0275fac",function(st){return new(st||Vt)}),(0,x.Z)(Vt,"\u0275mod",gt.oAB({type:Vt})),(0,x.Z)(Vt,"\u0275inj",gt.cJS({imports:[s.ez,Q.u5,ie.Pc,v.aw,d.e,q.Bz.forChild([{path:"",component:mn}])]})),Vt})()},4119:(zn,Dt,R)=>{"use strict";R.d(Dt,{N:()=>it});var x=R(5861),d=R(1180),v=R(4669),s=R(1618),Q=R(4783),ie=R(866),q=R(1847),y=R(2029),fe=R(7852),Se=R(5957),De=R(6814),X=R(6223),se=R(3999);let Ee=(()=>{class Xe extends se.X${constructor(ae,yt){super(ae,yt)}transform(ae,...yt){let we=super.transform(ae,...yt);return we==ae?null!=yt&&yt[0].default?yt[0].default:yt[0].Title?yt[0].Title:we:we}}return(0,d.Z)(Xe,"\u0275fac",function(ae){return new(ae||Xe)(y.Y36(se.sK,16),y.Y36(y.sBO,16))}),(0,d.Z)(Xe,"\u0275pipe",y.Yjl({name:"nullableTranslate",type:Xe,pure:!0})),(0,d.Z)(Xe,"\u0275prov",y.Yz7({token:Xe,factory:Xe.\u0275fac})),Xe})();function _e(Xe,Te){if(1&Xe){const ae=y.EpF();y.TgZ(0,"p",22),y._UZ(1,"ion-icon",23),y._uU(2," One or more filters are currently being applied. "),y.TgZ(3,"ion-button",24),y.NdJ("click",function(){y.CHM(ae);const we=y.oxw();return y.KtG(we.clearFilters())}),y._UZ(4,"ion-icon",25),y.TgZ(5,"ion-label"),y._uU(6,"Clear"),y.qZA()()()}}function be(Xe,Te){if(1&Xe&&(y.TgZ(0,"ion-select-option",27),y._uU(1),y.qZA()),2&Xe){const ae=Te.$implicit;y.Q6J("value",ae.ID),y.xp6(1),y.Oqu(ae.Title)}}function Re(Xe,Te){if(1&Xe){const ae=y.EpF();y.TgZ(0,"ion-item")(1,"ion-label"),y._uU(2),y.ALo(3,"translate"),y.qZA(),y.TgZ(4,"ion-select",14),y.NdJ("ngModelChange",function(we){y.CHM(ae);const Ze=y.oxw();return y.KtG(Ze.searchSettings.FilterOptionsByCountryId=we)})("ionChange",function(){y.CHM(ae);const we=y.oxw();return y.KtG(we.onCountryChange())}),y.TgZ(5,"ion-select",26),y._uU(6,"(All Countries)"),y.qZA(),y.YNc(7,be,2,2,"ion-select-option",4),y.qZA()()}if(2&Xe){const ae=y.oxw();y.xp6(2),y.Oqu(y.lcZ(3,3,"ocm.search.countries")),y.xp6(2),y.Q6J("ngModel",ae.searchSettings.FilterOptionsByCountryId),y.xp6(3),y.Q6J("ngForOf",ae.countries)}}function Ne(Xe,Te){if(1&Xe&&(y.TgZ(0,"ion-select-option",27),y._uU(1),y.ALo(2,"nullableTranslate"),y.qZA()),2&Xe){const ae=Te.$implicit;y.Q6J("value",ae.ID),y.xp6(1),y.Oqu(y.xi3(2,2,"ocm.reference.operatorInfo.value_"+ae.ID,ae))}}function qe(Xe,Te){if(1&Xe&&(y.TgZ(0,"ion-select-option",27),y._uU(1),y.ALo(2,"nullableTranslate"),y.qZA()),2&Xe){const ae=Te.$implicit;y.Q6J("value",ae.ID),y.xp6(1),y.Oqu(y.xi3(2,2,"ocm.reference.usageType.value_"+ae.ID,ae))}}function _t(Xe,Te){if(1&Xe&&(y.TgZ(0,"ion-select-option",27),y._uU(1),y.ALo(2,"nullableTranslate"),y.qZA()),2&Xe){const ae=Te.$implicit;y.Q6J("value",ae.ID),y.xp6(1),y.Oqu(y.xi3(2,2,"ocm.reference.statusType.value_"+ae.ID,ae))}}function Je(Xe,Te){if(1&Xe&&(y.TgZ(0,"ion-select-option",27),y._uU(1),y.ALo(2,"nullableTranslate"),y.qZA()),2&Xe){const ae=Te.$implicit;y.Q6J("value",ae.ID),y.xp6(1),y.Oqu(y.xi3(2,2,"ocm.reference.connectionType.value_"+ae.ID,ae))}}function Me(Xe,Te){if(1&Xe&&(y.TgZ(0,"ion-select-option",27),y._uU(1),y.qZA()),2&Xe){const ae=Te.$implicit;y.Q6J("value",ae.code),y.xp6(1),y.Oqu(ae.title)}}let it=(()=>{class Xe{constructor(ae,yt,we,Ze,Ae){(0,d.Z)(this,"appManager",void 0),(0,d.Z)(this,"poiManager",void 0),(0,d.Z)(this,"mapping",void 0),(0,d.Z)(this,"modalController",void 0),(0,d.Z)(this,"events",void 0),(0,d.Z)(this,"searchSettings",void 0),(0,d.Z)(this,"maxPower",Q.U),(0,d.Z)(this,"powerRange",{lower:0,upper:this.maxPower}),(0,d.Z)(this,"_languages",[]),this.appManager=ae,this.poiManager=yt,this.mapping=we,this.modalController=Ze,this.events=Ae,this.searchSettings=ae.searchSettings}ngOnInit(){var ae=this;return(0,x.Z)(function*(){null!=ae.searchSettings.MinPowerKW&&(ae.powerRange.lower=ae.searchSettings.MinPowerKW),null!=ae.searchSettings.MaxPowerKW&&(ae.powerRange.upper=ae.searchSettings.MaxPowerKW),0==ae.powerRange.upper&&(ae.powerRange.upper=ae.maxPower),ae.appManager.analytics.viewEvent("Settings"),ae.useFilteredOptions&&(yield ae.onCountryChange())})()}get useFilteredOptions(){return this.searchSettings.FilterOptionsByCountryId>0}clearFilters(){this.searchSettings.ClearActiveFilters(),this.powerRange={lower:0,upper:this.maxPower},this.searchSettings.CheckForActiveFilters()}get operators(){return this.appManager.referenceDataManager.getNetworkOperators(this.useFilteredOptions)}get connectionTypes(){return this.appManager.referenceDataManager.getConnectionTypes(this.useFilteredOptions)}get usageTypes(){return this.appManager.referenceDataManager.getUsageTypes(this.useFilteredOptions)}get statusTypes(){return this.appManager.referenceDataManager.getStatusTypes(this.useFilteredOptions)}get countries(){return this.appManager.referenceDataManager.getCountries(this.useFilteredOptions)}get isCountryFilterFeatureEnabled(){return ie.c.isFeatureEnabled("FILTER_OPTIONS_BY_COUNTRY")}get languages(){return this._languages.length>0||(this._languages=this.appManager.getLanguages()),this._languages}ionViewWillLeave(){null!=this.searchSettings.Language&&this.appManager.setLanguage(this.searchSettings.Language),this.searchSettings.MinPowerKW=this.powerRange.lower,this.searchSettings.MaxPowerKW=this.powerRange.upper,1==this.searchSettings.MinPowerKW&&(this.searchSettings.MinPowerKW=null),this.searchSettings.MaxPowerKW==this.maxPower&&(this.searchSettings.MaxPowerKW=null),this.appManager.searchSettings=this.searchSettings,this.appManager.saveSearchSettings(),this.events.publish("ocm:poiList:cleared")}onLanguageChange(){null!=this.searchSettings.Language&&""!=this.searchSettings.Language&&this.appManager.setLanguage(this.searchSettings.Language)}onCountryChange(){var ae=this;return(0,x.Z)(function*(){ae.appManager.referenceDataManager.refreshFilteredReferenceData(ae.appManager.api,{CountryIds:[ae.searchSettings.FilterOptionsByCountryId]})})()}onMapTypeChange(){var ae=this;return(0,x.Z)(function*(){ae.mapping.setMapType(ae.searchSettings.MapType)})()}close(){this.modalController.dismiss()}}return(0,d.Z)(Xe,"\u0275fac",function(ae){return new(ae||Xe)(y.Y36(s.c),y.Y36(v.R),y.Y36(q.v),y.Y36(fe.IN),y.Y36(Se.z))}),(0,d.Z)(Xe,"\u0275cmp",y.Xpm({type:Xe,selectors:[["ng-component"]],decls:81,vars:39,consts:[[1,"settings-page","ion-padding"],["danger","",4,"ngIf"],[4,"ngIf"],["multiple","true","cancelText","Cancel","okText","OK",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["lines","none"],["dualKnobs","true","min","0","max","650","pin","true",3,"ngModel","ngModelChange"],["slot","start","size","small","name","flash"],["slot","end","name","flash"],["slot","start",2,"padding-top","0"],["type","number","min","0",2,"width","3em","border","none",3,"ngModel","max","ngModelChange"],["slot","end",2,"padding-top","0"],["type","number",2,"width","3em","border","none",3,"ngModel","max","min","ngModelChange"],["multiple","false",3,"ngModel","ngModelChange","ionChange"],["multiple","false","cancelText","Cancel","okText","OK",3,"ngModel","ngModelChange","ionChange"],["value","ROADMAP"],["value","SATELLITE"],[3,"ngModel","ngModelChange"],["type","number","placeholder","500","min","100","max","10000",3,"ngModel","ngModelChange"],["slot","end"],[3,"click"],["name","close","slot","start"],["danger",""],["name","alert"],["size","small","color","light",3,"click"],["slot","start","name","close"],["value",""],[3,"value"]],template:function(ae,yt){1&ae&&(y.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),y._uU(3),y.ALo(4,"translate"),y.qZA()()(),y.TgZ(5,"ion-content",0)(6,"h2"),y._uU(7,"Search Filters"),y.qZA(),y.TgZ(8,"p"),y._uU(9,"Note: Filters will remove usable charging locations from your search results if we do not have complete data (i.e Operator or Power Levels)."),y.qZA(),y.YNc(10,_e,7,0,"p",1),y.TgZ(11,"ion-list"),y.YNc(12,Re,8,5,"ion-item",2),y.TgZ(13,"ion-item")(14,"ion-label"),y._uU(15),y.ALo(16,"translate"),y.qZA(),y.TgZ(17,"ion-select",3),y.NdJ("ngModelChange",function(Ze){return yt.searchSettings.OperatorList=Ze}),y.YNc(18,Ne,3,5,"ion-select-option",4),y.qZA()(),y.TgZ(19,"ion-item")(20,"ion-label"),y._uU(21),y.ALo(22,"translate"),y.qZA(),y.TgZ(23,"ion-select",3),y.NdJ("ngModelChange",function(Ze){return yt.searchSettings.UsageTypeList=Ze}),y.YNc(24,qe,3,5,"ion-select-option",4),y.qZA()(),y.TgZ(25,"ion-item")(26,"ion-label"),y._uU(27),y.ALo(28,"translate"),y.qZA(),y.TgZ(29,"ion-select",3),y.NdJ("ngModelChange",function(Ze){return yt.searchSettings.StatusTypeList=Ze}),y.YNc(30,_t,3,5,"ion-select-option",4),y.qZA()(),y.TgZ(31,"ion-item")(32,"ion-label"),y._uU(33),y.ALo(34,"translate"),y.qZA(),y.TgZ(35,"ion-select",3),y.NdJ("ngModelChange",function(Ze){return yt.searchSettings.ConnectionTypeList=Ze}),y.YNc(36,Je,3,5,"ion-select-option",4),y.qZA()(),y.TgZ(37,"ion-item",5)(38,"ion-range",6),y.NdJ("ngModelChange",function(Ze){return yt.powerRange=Ze}),y.TgZ(39,"ion-icon",7),y._uU(40,"0"),y.qZA(),y._UZ(41,"ion-icon",8),y.qZA()(),y.TgZ(42,"ion-item",5)(43,"ion-note",9),y._uU(44,"Min. Power (kW)"),y._UZ(45,"br"),y.TgZ(46,"input",10),y.NdJ("ngModelChange",function(Ze){return yt.powerRange.lower=Ze}),y.qZA()(),y.TgZ(47,"ion-note",11),y._uU(48,"Max. Power (kW)"),y._UZ(49,"br"),y.TgZ(50,"input",12),y.NdJ("ngModelChange",function(Ze){return yt.powerRange.upper=Ze}),y.qZA()()()(),y.TgZ(51,"h2"),y._uU(52," General Settings "),y.qZA(),y.TgZ(53,"ion-item")(54,"ion-label"),y._uU(55,"Language"),y.qZA(),y.TgZ(56,"ion-select",13),y.NdJ("ngModelChange",function(Ze){return yt.searchSettings.Language=Ze})("ionChange",function(){return yt.onLanguageChange()}),y.YNc(57,Me,2,2,"ion-select-option",4),y.qZA()(),y.TgZ(58,"ion-item")(59,"ion-label"),y._uU(60),y.ALo(61,"translate"),y.qZA(),y.TgZ(62,"ion-select",14),y.NdJ("ngModelChange",function(Ze){return yt.searchSettings.MapType=Ze})("ionChange",function(){return yt.onMapTypeChange()}),y.TgZ(63,"ion-select-option",15),y._uU(64,"Road Map"),y.qZA(),y.TgZ(65,"ion-select-option",16),y._uU(66,"Satellite"),y.qZA()()(),y.TgZ(67,"ion-item")(68,"ion-label"),y._uU(69,"Enable Advanced Editor Options"),y.qZA(),y.TgZ(70,"ion-toggle",17),y.NdJ("ngModelChange",function(Ze){return yt.searchSettings.EnableAdvancedEditorFeatures=Ze}),y.qZA()(),y.TgZ(71,"ion-item")(72,"ion-label"),y._uU(73,"Max Results"),y.qZA(),y.TgZ(74,"ion-input",18),y.NdJ("ngModelChange",function(Ze){return yt.searchSettings.MaxResults=Ze}),y.qZA()()(),y.TgZ(75,"ion-footer")(76,"ion-toolbar")(77,"ion-buttons",19)(78,"ion-button",20),y.NdJ("click",function(){return yt.close()}),y._UZ(79,"ion-icon",21),y._uU(80," Close "),y.qZA()()()()),2&ae&&(y.xp6(3),y.hij(" ",y.lcZ(4,27,"ocm.general.settings")," "),y.xp6(7),y.Q6J("ngIf",1==yt.searchSettings.HasActiveFilters),y.xp6(2),y.Q6J("ngIf",yt.isCountryFilterFeatureEnabled),y.xp6(3),y.Oqu(y.lcZ(16,29,"ocm.search.networkOperators")),y.xp6(2),y.Q6J("ngModel",yt.searchSettings.OperatorList),y.xp6(1),y.Q6J("ngForOf",yt.operators),y.xp6(3),y.Oqu(y.lcZ(22,31,"ocm.search.usageTypes")),y.xp6(2),y.Q6J("ngModel",yt.searchSettings.UsageTypeList),y.xp6(1),y.Q6J("ngForOf",yt.usageTypes),y.xp6(3),y.Oqu(y.lcZ(28,33,"ocm.search.operationalStatusTypes")),y.xp6(2),y.Q6J("ngModel",yt.searchSettings.StatusTypeList),y.xp6(1),y.Q6J("ngForOf",yt.statusTypes),y.xp6(3),y.Oqu(y.lcZ(34,35,"ocm.search.connectionTypes")),y.xp6(2),y.Q6J("ngModel",yt.searchSettings.ConnectionTypeList),y.xp6(1),y.Q6J("ngForOf",yt.connectionTypes),y.xp6(2),y.Q6J("ngModel",yt.powerRange),y.xp6(8),y.Q6J("ngModel",yt.powerRange.lower)("max",yt.powerRange.upper),y.xp6(4),y.Q6J("ngModel",yt.powerRange.upper)("max",yt.maxPower)("min",yt.powerRange.lower),y.xp6(6),y.Q6J("ngModel",yt.searchSettings.Language),y.xp6(1),y.Q6J("ngForOf",yt.languages),y.xp6(3),y.Oqu(y.lcZ(61,37,"ocm.details.location.map")),y.xp6(2),y.Q6J("ngModel",yt.searchSettings.MapType),y.xp6(8),y.Q6J("ngModel",yt.searchSettings.EnableAdvancedEditorFeatures),y.xp6(4),y.Q6J("ngModel",yt.searchSettings.MaxResults))},dependencies:[De.sg,De.O5,X.Fj,X.wV,X.JJ,X.qQ,X.Fd,X.On,fe.YG,fe.Sm,fe.W2,fe.fr,fe.Gu,fe.gu,fe.pK,fe.Ie,fe.Q$,fe.q_,fe.uN,fe.I_,fe.t9,fe.n0,fe.wd,fe.ho,fe.sr,fe.w,fe.as,fe.QI,se.X$,Ee],encapsulation:2})),Xe})()},9472:(zn,Dt,R)=>{"use strict";R.r(Dt),R.d(Dt,{SignInModule:()=>Se});var x=R(1180),d=R(8767),v=R(5086),s=R(3999),Q=R(6814),ie=R(6223),q=R(7852),y=R(2125),fe=R(2029);let Se=(()=>{class De{}return(0,x.Z)(De,"\u0275fac",function(se){return new(se||De)}),(0,x.Z)(De,"\u0275mod",fe.oAB({type:De})),(0,x.Z)(De,"\u0275inj",fe.cJS({imports:[Q.ez,ie.u5,q.Pc,s.aw,v.e,y.Bz.forChild([{path:"",component:d.F}])]})),De})()},8767:(zn,Dt,R)=>{"use strict";R.d(Dt,{F:()=>De});var x=R(5861),d=R(1180),v=R(9127),s=R(1618),Q=R(2029),ie=R(7852),q=R(3999),y=R(2125),fe=R(6814),Se=R(6223);let De=(()=>{class X{constructor(Ee,_e,be,Re,Ne,qe,_t,Je){(0,d.Z)(this,"appManager",void 0),(0,d.Z)(this,"modalController",void 0),(0,d.Z)(this,"translate",void 0),(0,d.Z)(this,"alertController",void 0),(0,d.Z)(this,"loadingController",void 0),(0,d.Z)(this,"logging",void 0),(0,d.Z)(this,"router",void 0),(0,d.Z)(this,"location",void 0),(0,d.Z)(this,"email",void 0),(0,d.Z)(this,"password",void 0),this.appManager=Ee,this.modalController=_e,this.translate=be,this.alertController=Re,this.loadingController=Ne,this.logging=qe,this.router=_t,this.location=Je,this.email=""}cancelSignIn(){this.modalController.dismiss()}performSignIn(){var Ee=this;return(0,x.Z)(function*(){const _e=yield Ee.loadingController.create({message:"Signing In.."});yield _e.present();let be=!1;try{yield Ee.appManager.api.performSignIn(Ee.email,Ee.password),_e.dismiss(),localStorage.setItem("authResponse",JSON.stringify(Ee.appManager.api.authResponse)),Ee.appManager.isUserAuthenticated(!0),Ee.modalController.dismiss(),Ee.appManager.analytics.appEvent("Profile","SignedIn")}catch(Re){be=!0,_e.dismiss(),yield(yield Ee.alertController.create({header:"Open Charge Map",subHeader:"Email or Password not recognised",buttons:["Ok"]})).present(),Ee.logging.log("Error logging in:"+Re)}})()}}return(0,d.Z)(X,"\u0275fac",function(Ee){return new(Ee||X)(Q.Y36(s.c),Q.Y36(ie.IN),Q.Y36(q.sK),Q.Y36(ie.Br),Q.Y36(ie.HT),Q.Y36(v.z),Q.Y36(y.F0),Q.Y36(fe.Ye))}),(0,d.Z)(X,"\u0275cmp",Q.Xpm({type:X,selectors:[["ng-component"]],decls:37,vars:8,consts:[[1,"signin-page","ion-padding"],["item-left",""],["src","assets/images/icons/branding/AppIcon_128x128.png"],[1,"ion-padding"],["position","floating"],["type","text",3,"ngModel","ngModelChange"],["type","password",3,"ngModel","ngModelChange"],[3,"click"],["slot","secondary"],["name","close","slot","start"],["slot","primary"],["type","submit","color","primary",3,"click"],["name","log-in","slot","start"]],template:function(Ee,_e){1&Ee&&(Q.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),Q._uU(3),Q.ALo(4,"translate"),Q.qZA()()(),Q.TgZ(5,"ion-content",0)(6,"ion-avatar",1),Q._UZ(7,"img",2),Q.qZA(),Q.TgZ(8,"p",3),Q._uU(9," Sign in using your Open Charge Map account. "),Q.qZA(),Q.TgZ(10,"ion-list")(11,"ion-item")(12,"ion-label",4),Q._uU(13,"Email"),Q.qZA(),Q.TgZ(14,"ion-input",5),Q.NdJ("ngModelChange",function(Re){return _e.email=Re}),Q.qZA()(),Q.TgZ(15,"ion-item")(16,"ion-label",4),Q._uU(17,"Password"),Q.qZA(),Q.TgZ(18,"ion-input",6),Q.NdJ("ngModelChange",function(Re){return _e.password=Re}),Q.qZA()()(),Q.TgZ(19,"p"),Q._uU(20,"or "),Q.TgZ(21,"a",7),Q.NdJ("click",function(){return _e.appManager.launchWebPage("https://openchargemap.org/site/loginprovider/register")}),Q._uU(22,"Register as New User"),Q.qZA(),Q._uU(23," or "),Q.TgZ(24,"a",7),Q.NdJ("click",function(){return _e.appManager.launchWebPage("https://openchargemap.org/site/loginprovider/passwordreset")}),Q._uU(25,"Reset your password"),Q.qZA()()(),Q.TgZ(26,"ion-footer")(27,"ion-toolbar")(28,"ion-buttons",8)(29,"ion-button",7),Q.NdJ("click",function(){return _e.cancelSignIn()}),Q._UZ(30,"ion-icon",9),Q._uU(31," Cancel"),Q.qZA()(),Q.TgZ(32,"ion-buttons",10)(33,"ion-button",11),Q.NdJ("click",function(){return _e.performSignIn()}),Q._UZ(34,"ion-icon",12),Q._uU(35),Q.ALo(36,"translate"),Q.qZA()()()()),2&Ee&&(Q.xp6(3),Q.hij(" ",Q.lcZ(4,4,"ocm.general.signIn")," "),Q.xp6(11),Q.Q6J("ngModel",_e.email),Q.xp6(4),Q.Q6J("ngModel",_e.password),Q.xp6(17),Q.hij(" ",Q.lcZ(36,6,"ocm.general.signIn"),""))},dependencies:[Se.JJ,Se.On,ie.BJ,ie.YG,ie.Sm,ie.W2,ie.fr,ie.Gu,ie.gu,ie.pK,ie.Ie,ie.Q$,ie.q_,ie.wd,ie.sr,ie.j9,q.X$],encapsulation:2})),X})()},439:(zn,Dt,R)=>{"use strict";R.d(Dt,{l:()=>fe});var x=R(5861),d=R(1180),v=R(9127),s=R(9159),Q=R(2339),ie=R(9862),q=R(553),y=R(2029);let fe=(()=>{class Se{constructor(X,se,Ee){(0,d.Z)(this,"http",void 0),(0,d.Z)(this,"refData",void 0),(0,d.Z)(this,"logging",void 0),(0,d.Z)(this,"serviceBase","https://api.openchargemap.io"),(0,d.Z)(this,"serviceBaseURL",this.serviceBase+"/v3"),(0,d.Z)(this,"hasAuthorizationError",!1),(0,d.Z)(this,"ATTRIBUTION_METADATAFIELDID",4),(0,d.Z)(this,"authResponse",void 0),(0,d.Z)(this,"clientName","ocm.api.default"),(0,d.Z)(this,"authorizationErrorCallback",void 0),(0,d.Z)(this,"generalErrorCallback",void 0),(0,d.Z)(this,"allowMirror",!1),(0,d.Z)(this,"lastPOIApiCallURL",""),this.http=X,this.refData=se,this.logging=Ee,this.serviceBaseURL=q.N.apiBase+"/v3"}getNumberListString(X){let se="";for(let Ee=0;Ee<X.length;Ee++)se+=X[Ee],Ee<X.length&&(se+=",");return se}fetchPOIListByParam(X){var se=this;return(0,x.Z)(function*(){const Ee=se.serviceBaseURL+"/poi/?client="+se.clientName+(se.allowMirror?" &allowmirror=true":"")+"&verbose=false&output=json";X.compact=!0;let _e="";null!=X.countryCode&&(_e+="&countrycode="+X.countryCode),null!=X.latitude&&(_e+="&latitude="+X.latitude),null!=X.longitude&&(_e+="&longitude="+X.longitude),null!=X.distance&&(_e+="&distance="+X.distance),null!=X.distanceUnit&&(_e+="&distanceunit="+X.distanceUnit),null!=X.includeComments&&(_e+="&includecomments="+X.includeComments),null!=X.maxResults&&(_e+="&maxresults="+X.maxResults),null!=X.countryIdList&&(_e+="&countryid="+se.getNumberListString(X.countryIdList)),null!=X.levelIdList&&(_e+="&levelid="+se.getNumberListString(X.levelIdList)),null!=X.connectionTypeIdList&&X.connectionTypeIdList.length>0&&(_e+="&connectiontypeid="+se.getNumberListString(X.connectionTypeIdList)),null!=X.operatorIdList&&X.operatorIdList.length>0&&(_e+="&operatorid="+se.getNumberListString(X.operatorIdList)),null!=X.usageTypeIdList&&X.usageTypeIdList.length>0&&(_e+="&usagetypeid="+se.getNumberListString(X.usageTypeIdList)),null!=X.statusTypeIdList&&X.statusTypeIdList.length>0&&(_e+="&statustypeid="+se.getNumberListString(X.statusTypeIdList)),null!=X.locationTitle&&(_e+="&locationtitle="+X.locationTitle),null!=X.minPowerKW&&X.minPowerKW>0&&(_e+="&minpowerkw="+X.minPowerKW),null!=X.maxPowerKW&&X.maxPowerKW>0&&(_e+="&maxpowerkw="+X.maxPowerKW),null!=X.submissionStatusTypeIdList&&(_e+="&submissionstatustypeid="+se.getNumberListString(X.submissionStatusTypeIdList)),null!=X.poiIdList&&X.poiIdList.length>0&&(_e+="&chargepointid="+se.getNumberListString(X.poiIdList)),0==X.enableCaching&&(_e+="&enablecaching=false"),null!=X.compact&&(_e+="&compact="+X.compact),X.levelOfDetail>1&&(_e+="&levelofdetail="+X.levelOfDetail),null!=X.polyline&&(_e+="&polyline="+X.polyline),null!=X.boundingbox&&(_e+="&boundingbox="+X.boundingbox),null!=X.additionalParams&&(_e+="&"+X.additionalParams);const be=Ee+_e;if(se.lastPOIApiCallURL===be&&0!=X.enableCaching)return se.logging.log("Skipped API call due to same query being repeated."),[];se.lastPOIApiCallURL=be,se.logging.log("API Call:"+be,v.i.VERBOSE);try{let Re=yield se.http.get(be,se.getHttpRequestOptions()).toPromise();return se.refData.hydrateCompactPOIList(Re)}catch(Re){const Ne=Re.message||"Could not fetch POI list from server.";throw se.logging.log("API Client: "+JSON.stringify(Re),v.i.ERROR),Ne}})()}getHttpRequestOptions(X=!0){let se=new ie.WM;return X&&(se=se.append("Content-Type","application/json")),this.authResponse&&this.authResponse.Data&&this.authResponse.Data.access_token&&(se=se.append("Authorization","Bearer "+this.authResponse.Data.access_token)),se=se.append("X-API-Key",q.N.apiKey),{headers:se}}fetchCoreReferenceData(X){let se=this.serviceBaseURL+"/referencedata/?client="+this.clientName+"&output=json"+(this.allowMirror?"&allowmirror=true":"")+"&verbose=false&compact=true";return null!=X&&null!=X.CountryIds&&(se+="&countryid="+this.getNumberListString(X.CountryIds)),this.logging.log("API Call:"+se,v.i.VERBOSE),this.http.get(se,this.getHttpRequestOptions())}performSignIn(X,se){return this.http.post(this.serviceBaseURL+"/profile/authenticate/",JSON.stringify({emailaddress:X,password:se}),this.getHttpRequestOptions()).toPromise().then(be=>(this.authResponse=be,this.authResponse))}performSubmission(X,se){return X===Q.q.POI?this.submitPOI(se):X===Q.q.Comment?this.submitUserComment(se):X===Q.q.Media?this.submitMediaItem(se):void 0}submitUserComment(X){const se=JSON.stringify(X);return this.logging.log("[api] Submitting user comment"),this.http.post(this.serviceBaseURL+"/comment/",se,this.getHttpRequestOptions()).toPromise()}submitMediaItem(X){const se=JSON.stringify(X);return this.http.post(this.serviceBaseURL+"/mediaitem/",se,this.getHttpRequestOptions()).toPromise()}submitPOI(X){const se=JSON.stringify(X);return this.http.post(this.serviceBaseURL+"/poi/",se,this.getHttpRequestOptions()).toPromise()}getPanoramioLocationPhotos(X){return new Promise(se=>{const _e="https://www.panoramio.com/map/get_panoramas.php?set=public&from=0&to=2&minx="+(X.longitude-.001)+"&miny="+(X.latitude-.001)+"&maxx="+(X.longitude+.001)+"maxy="+(X.latitude+.001)+"&size=medium&mapfilter=true&callback=?";return console.log(_e),this.http.get(_e).toPromise()})}fetchReverseGeocodeResult(X,se){return this.http.get(this.serviceBaseURL+"/geocode/?client="+this.clientName+"&output=json&camelcase=false&latitude="+X+"&longitude="+se,this.getHttpRequestOptions()).toPromise()}isLocalStorageAvailable(){return typeof window.localStorage<"u"}setCachedDataObject(X,se){this.isLocalStorageAvailable()&&(typeof se>"u"&&(se=null),null===se?localStorage.removeItem(X):localStorage.setItem(X,JSON.stringify(se)))}getCachedDataObject(X){if(this.isLocalStorageAvailable()){const se=localStorage.getItem(X);if(null!=se&&se.length>0)return JSON.parse(se)}return null}}return(0,d.Z)(Se,"\u0275fac",function(X){return new(X||Se)(y.LFG(ie.eN),y.LFG(s.W),y.LFG(v.z))}),(0,d.Z)(Se,"\u0275prov",y.Yz7({token:Se,factory:Se.\u0275fac,providedIn:"root"})),Se})()},3294:(zn,Dt,R)=>{"use strict";R.d(Dt,{c:()=>ie});var x=R(5861),d=R(1180),v=R(9127),s=R(2029),Q=R(7852);let ie=(()=>{class q{constructor(fe,Se){(0,d.Z)(this,"logger",void 0),(0,d.Z)(this,"platform",void 0),(0,d.Z)(this,"isCordova",!1),(0,d.Z)(this,"ga",null),this.logger=fe,this.platform=Se,this.isCordova=!(!Se.is("cordova")&&!Se.is("capacitor"))}init(fe){var Se=this;return(0,x.Z)(function*(){Se.isCordova&&Se.ga?yield Se.ga.startTrackerWithId(fe):Se.logger.log("Could not initialise analytics")})()}setAppVersion(fe){var Se=this;return(0,x.Z)(function*(){if(Se.isCordova&&Se.ga)return Se.ga.setAppVersion(fe);Se.logger.log(fe)})()}appEvent(fe,Se){var De=this;return(0,x.Z)(function*(){if(De.isCordova&&De.ga)return De.ga.trackEvent(fe,Se);De.logger.log(Se)})()}viewEvent(fe){var Se=this;return(0,x.Z)(function*(){if(Se.isCordova&&Se.ga)return Se.ga.trackView(fe);Se.logger.log(fe)})()}}return(0,d.Z)(q,"\u0275fac",function(fe){return new(fe||q)(s.LFG(v.z),s.LFG(Q.t4))}),(0,d.Z)(q,"\u0275prov",s.Yz7({token:q,factory:q.\u0275fac,providedIn:"root"})),q})()},1618:(zn,Dt,R)=>{"use strict";R.d(Dt,{c:()=>_t});var x=R(5861),d=R(1180),v=R(9127),s=R(439),Q=R(4783),ie=R(3052),q=R(2339),y=R(9159),fe=R(989),Se=R(3294),De=R(553),X=R(2029),se=R(9862),Ee=R(5957);class _e{constructor(Me,it){(0,d.Z)(this,"ID",void 0),(0,d.Z)(this,"SubmissionType",void 0),(0,d.Z)(this,"Data",void 0),(0,d.Z)(this,"Attempts",void 0),(0,d.Z)(this,"DateQueued",void 0),(0,d.Z)(this,"IsSubmitted",void 0),(0,d.Z)(this,"IsInProgress",void 0),(0,d.Z)(this,"IsCancelled",void 0),(0,d.Z)(this,"IsFailure",void 0),(0,d.Z)(this,"FailureReason",void 0),this.SubmissionType=Me,this.Data=it,this.DateQueued=new Date,this.IsSubmitted=!1,this.IsInProgress=!1,this.IsCancelled=!1,this.IsFailure=!1,this.Attempts=0,this.ID=new Date+"_"+100*Math.random()}}let be=(()=>{class Je{constructor(it){(0,d.Z)(this,"events",void 0),(0,d.Z)(this,"isQueueProcessing",void 0),(0,d.Z)(this,"appManager",void 0),this.events=it,this.isQueueProcessing=!1}setAppManager(it){this.appManager=it}add(it,Xe){let Te=this.getQueueItems();Te.push(new _e(it,Xe)),this.saveQueueItems(Te)}update(it){let Xe=this.getQueueItems(),Te=new Array;return Xe.forEach(ae=>{Te.push(ae.ID==it.ID?it:ae)}),Te}processNextQueueItem(){let it=this.getNextQueueItem();null!=it&&null!=this.appManager&&this.appManager.api.performSubmission(it.SubmissionType,it.Data).then(()=>{it.IsSubmitted=!0,it.Attempts++,this.update(it),this.clear()})}getNextQueueItem(){let it=this.getQueueItems(),Xe=null;return it.forEach(Te=>{null==Xe&&!Te.IsCancelled&&!Te.IsInProgress&&!Te.IsSubmitted&&(Xe=Te)}),Xe}hasPendingItems(){let it=!1;return this.getQueueItems().forEach(Te=>{!Te.IsFailure&&!Te.IsCancelled&&!Te.IsSubmitted&&(it=!0)}),it}isCompleted(){let it=this.getQueueItems(),Xe=!0;return it.forEach(Te=>{(Te.IsInProgress||Te.IsFailure)&&(Xe=!1)}),Xe}clear(it=!1){let Xe=this.getQueueItems(),Te=new Array;it||Xe.forEach(ae=>{(ae.IsInProgress||ae.IsFailure)&&Te.push(ae)}),this.saveQueueItems(Te)}saveQueueItems(it){localStorage.setItem("submissionQueue",JSON.stringify(it))}getQueueItems(){let it=localStorage.getItem("submissionQueue");return null!=it?JSON.parse(it):new Array}}return(0,d.Z)(Je,"\u0275fac",function(it){return new(it||Je)(X.LFG(Ee.z))}),(0,d.Z)(Je,"\u0275prov",X.Yz7({token:Je,factory:Je.\u0275fac,providedIn:"root"})),Je})();var Re=R(7852),Ne=R(3999),qe=R(6091);let _t=(()=>{class Je{constructor(it,Xe,Te,ae,yt,we,Ze,Ae,ve,en,dt,mt,lt){(0,d.Z)(this,"http",void 0),(0,d.Z)(this,"events",void 0),(0,d.Z)(this,"api",void 0),(0,d.Z)(this,"submissionQueue",void 0),(0,d.Z)(this,"platform",void 0),(0,d.Z)(this,"referenceDataManager",void 0),(0,d.Z)(this,"journeyManager",void 0),(0,d.Z)(this,"translateService",void 0),(0,d.Z)(this,"toastController",void 0),(0,d.Z)(this,"loadingController",void 0),(0,d.Z)(this,"jwtHelper",void 0),(0,d.Z)(this,"logging",void 0),(0,d.Z)(this,"analytics",void 0),(0,d.Z)(this,"enableSubmissionQueue",void 0),(0,d.Z)(this,"searchSettings",void 0),(0,d.Z)(this,"platformMode",void 0),(0,d.Z)(this,"journeys",void 0),(0,d.Z)(this,"isDebugMode",void 0),(0,d.Z)(this,"clientWidth",void 0),(0,d.Z)(this,"clientHeight",void 0),(0,d.Z)(this,"isRequestInProgress",!1),(0,d.Z)(this,"title","Open Charge Map"),(0,d.Z)(this,"_isUserAuthenticated",null),(0,d.Z)(this,"isEmbeddedMode",!1),(0,d.Z)(this,"isOffline",!1),this.http=it,this.events=Xe,this.api=Te,this.submissionQueue=ae,this.platform=yt,this.referenceDataManager=we,this.journeyManager=Ze,this.translateService=Ae,this.toastController=ve,this.loadingController=en,this.jwtHelper=dt,this.logging=mt,this.analytics=lt,this.api.clientName="ocm.app.ionic."+De.N.version,this.isDebugMode=!1,this.enableSubmissionQueue=!1,this.submissionQueue.setAppManager(this),this.platformMode=yt.is("cordova")?"cordova":"web",this.initAppManager(),this.searchSettings=new Q.N,this.loadSearchSettings(),this.applyURLQueryStringOptions(),this.searchSettings.CheckForActiveFilters(),this.journeyManager.loadJourneys()}loadSearchSettings(){if(null!=localStorage.getItem("searchSettings")){this.searchSettings=new Q.N;try{let it=JSON.parse(localStorage.getItem("searchSettings"));Object.assign(this.searchSettings,it)}catch{}}}savePushRegistration(it){localStorage.setItem("_pushToken",it.toString())}getPushRegistration(){localStorage.getItem("_pushToken")}getQueryVariable(it){let Te=window.location.search.substring(1).split("&");for(let ae=0;ae<Te.length;ae++){let yt=Te[ae].split("=");if(decodeURIComponent(yt[0])==it)return yt[1].split(",").map(Ae=>decodeURIComponent(Ae))}return null}applyURLQueryStringOptions(){if(this.getQueryVariable("mode")&&"embedded"==this.getQueryVariable("mode")[0]&&(this.isEmbeddedMode=!0),this.getQueryVariable("operatorid")){let it=this.getQueryVariable("operatorid");for(let Xe of it)this.searchSettings.OperatorList.unshift(parseInt(Xe,10))}if(this.getQueryVariable("latitude")&&this.getQueryVariable("longitude")){let it=this.getQueryVariable("latitude")[0],Xe=this.getQueryVariable("longitude")[0];this.searchSettings.StartSearchPosition=new ie.wC(parseFloat(it),parseFloat(Xe))}this.getQueryVariable("title")&&(this.title=this.getQueryVariable("title")[0]),this.getQueryVariable("languagecode")&&this.setLanguage(this.getQueryVariable("languagecode")[0]),this.getQueryVariable("id")&&(this.searchSettings.StartViewPoiId=this.getQueryVariable("id")[0])}saveSearchSettings(){this.searchSettings.CheckForActiveFilters(),localStorage.setItem("searchSettings",JSON.stringify(this.searchSettings))}getLanguages(){return[{code:"ar",title:"\u0627\u0644\u0639\u0631\u0628\u064a\u0629 / Arabic"},{code:"bg",title:"Bulgarian / \u0411\u044a\u043b\u0433\u0430\u0440\u0441\u043a\u0438"},{code:"cs",title:"Czech / \u010ce\u0161tina"},{code:"de",title:"German / Deutsch"},{code:"el",title:"Greek / \u0395\u03bb\u03bb\u03b7\u03bd\u03b9\u03ba\u03ae"},{code:"en",title:"English"},{code:"es",title:"Spanish / Espa\xf1ol"},{code:"et",title:"Estonian / Eesti"},{code:"fi",title:"Finnish / Suomi"},{code:"fr",title:"French / Fran\xe7ais"},{code:"fy",title:"West Frisian / Frysk"},{code:"hu",title:"Hungarian / Magyar"},{code:"it",title:"Italian / Italiano"},{code:"ja",title:"Japanese / \u65e5\u672c\u8a9e"},{code:"lt",title:"Lithuanian / Lietuvi\u0173"},{code:"nl",title:"Dutch / Nederlands"},{code:"pt",title:"Portuguese / portugu\xeas"},{code:"ro",title:"Romanian / Rom\xe2n\u0103"},{code:"ru",title:"Russian / P\u0443\u0441\u0441\u043a\u0438\u0439"},{code:"sk",title:"Slovak / Sloven\u010dina"},{code:"tr",title:"Turkish / T\xfcrk\xe7e"},{code:"zh",title:"Chinese / \u4e2d\u56fd\u7684"}]}setLanguage(it){(null==it||""==it)&&(it="en"),this.logging.log("Changing language: "+it),this.translateService.use(it)}initAppManager(){this.initAuthFromStorage(),this.isUserAuthenticated(!0)&&this.enableSubmissionQueue&&null!=this.submissionQueue&&this.submissionQueue.hasPendingItems()&&this.submissionQueue.processNextQueueItem()}initAuthFromStorage(){let it=localStorage.getItem("authResponse");if(null!=it){let Xe=JSON.parse(it);null!=Xe.Data&&null!=Xe.Data.access_token&&(this.jwtHelper.decodeToken(Xe.Data.access_token),this.jwtHelper.isTokenExpired(Xe.Data.access_token)?localStorage.removeItem("authResponse"):(this.api.authResponse=Xe,this.logging.log("User has valid auth token in local storage",v.i.VERBOSE)))}}isUserAuthenticated(it=!1){return!1===it&&null!=this._isUserAuthenticated||(this._isUserAuthenticated=!1,null!=this.api.authResponse&&(this.jwtHelper.isTokenExpired(this.api.authResponse.Data.access_token)||(this._isUserAuthenticated=!0))),this._isUserAuthenticated}getCurrentAuthToken(){return null!=this.api.authResponse?this.api.authResponse.Data.access_token:null}getUserProfile(){return null!=this.api.authResponse?this.api.authResponse.Data.UserProfile:null}signOutCurrentUser(){localStorage.removeItem("authResponse"),this.api.authResponse=null,this._isUserAuthenticated=!1}submitComment(it){if(!this.enableSubmissionQueue)return this.api.performSubmission(q.q.Comment,it);this.submissionQueue.add(q.q.Comment,it),this.submissionQueue.processNextQueueItem()}submitMediaItem(it){if(!this.enableSubmissionQueue)return this.api.performSubmission(q.q.Media,it);this.submissionQueue.add(q.q.Media,it),this.submissionQueue.processNextQueueItem()}submitPOI(it){if(!this.enableSubmissionQueue)return this.api.performSubmission(q.q.POI,it);this.submissionQueue.add(q.q.POI,it),this.submissionQueue.processNextQueueItem()}showToastNotification(it){var Xe=this;return(0,x.Z)(function*(){yield(yield Xe.toastController.create({message:it,duration:3e3})).present()})()}showLoadingProgress(it){var Xe=this;return(0,x.Z)(function*(){yield(yield Xe.loadingController.create({message:it})).present()})()}dismissLoadingProgress(){var it=this;return(0,x.Z)(function*(){return it.loadingController.dismiss()})()}launchOCMWebPage(it){this.isUserAuthenticated(!0)&&(-1===it.indexOf("?")&&(it+="?"),it+="&auth="+this.getCurrentAuthToken()),it="https://openchargemap.org/site"+it,window.open(it,"_system")}launchWebPage(it){window.open(it,"_system")}isPlatform(it){return this.platform.is(it)}}return(0,d.Z)(Je,"\u0275fac",function(it){return new(it||Je)(X.LFG(se.eN),X.LFG(Ee.z),X.LFG(s.l),X.LFG(be),X.LFG(Re.t4),X.LFG(y.W),X.LFG(fe.i),X.LFG(Ne.sK),X.LFG(Re.yF),X.LFG(Re.HT),X.LFG(qe.N0),X.LFG(v.z),X.LFG(Se.c))}),(0,d.Z)(Je,"\u0275prov",X.Yz7({token:Je,factory:Je.\u0275fac,providedIn:"root"})),Je})()},5957:(zn,Dt,R)=>{"use strict";R.d(Dt,{z:()=>v});var x=R(1180),d=R(2029);let v=(()=>{class s{constructor(){(0,x.Z)(this,"c",new Map)}subscribe(ie,...q){let y=this.c.get(ie);y||this.c.set(ie,y=[]),y.push(...q)}unsubscribe(ie,q){if(!q)return this.c.delete(ie);const y=this.c.get(ie);if(!y)return!1;const fe=y.indexOf(q);return!(fe<0||(y.splice(fe,1),0===y.length&&this.c.delete(ie),0))}publish(ie,...q){const y=this.c.get(ie);return y?y.map(fe=>{try{return fe(...q)}catch(Se){return console.error(Se),null}}):null}}return(0,x.Z)(s,"\u0275fac",function(ie){return new(ie||s)}),(0,x.Z)(s,"\u0275prov",d.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"})),s})()},989:(zn,Dt,R)=>{"use strict";R.d(Dt,{i:()=>fe});var x=R(1180),d=R(9127),v=R(439),s=R(4669),Q=R(4677),ie=R(7430),q=R(3052),y=R(2029);let fe=(()=>{class Se{constructor(X,se,Ee){(0,x.Z)(this,"api",void 0),(0,x.Z)(this,"poiManager",void 0),(0,x.Z)(this,"logging",void 0),(0,x.Z)(this,"journeys",void 0),(0,x.Z)(this,"favourites",void 0),(0,x.Z)(this,"routePolyline",void 0),this.api=X,this.poiManager=se,this.logging=Ee,this.journeys=[],this.favourites=[]}loadJourneys(){let X=localStorage.getItem("journeys");if(null!=X&&(this.journeys=JSON.parse(X)),null!=this.journeys)for(let se of this.journeys)this.fetchAllJourneyPOIDetails(se)}fetchAllJourneyPOIDetails(X){this.logging.log("Journeys - fetching poi details for Journey "+X.Title);let se=new Q.b;se.poiIdList=[];for(let Ee of X.Stages)for(let _e of Ee.WayPoints)for(let be of _e.PoiIDs)se.poiIdList.push(be);this.api.fetchPOIListByParam(se).then(Ee=>{for(let _e of Ee)this.updateStoredPOI(_e)})}updateStoredPOI(X){if(this.journeys.forEach(se=>{se.Stages.forEach(Ee=>{Ee.WayPoints.forEach(_e=>{_e.PoiIDs.forEach(be=>{if(be==X.ID)if(null==_e.PoiList){_e.PoiList=[];let Re=new ie.Qp("charging",1);Re.Poi=X,Re.PoiID=X.ID,_e.PoiList.push(Re)}else for(let Re of _e.PoiList)Re.PoiID==X.ID&&(Re.Poi=X)})})})}),null!=this.favourites)for(let se of this.favourites)"charging"==se.Type&&se.PoiID==X.ID&&(se.Poi=X)}saveJourneys(){let X=JSON.parse(JSON.stringify(this.journeys));for(let Ee of X)for(const _e of Ee.Stages)for(let be of _e.WayPoints)for(let Re of be.PoiList)Re.Poi=null,Re.Photos=null;const se=JSON.stringify(X);localStorage.setItem("journeys",se)}addJourney(X,se){let Ee=new ie.vw;Ee.Title="Stage 1",null!=se&&Ee.WayPoints.push(se),X.Stages.push(Ee),this.journeys.push(X)}deleteJourney(X){this.journeys=this.journeys.filter(se=>se.ID!=X),this.saveJourneys()}getJourney(X){let se=this.journeys.filter(Ee=>Ee.ID==X);return se.length>0?se[0]:null}getJourneyStages(X){return this.getJourney(X).Stages}addJourneyWaypoint(X,se,Ee){let _e=this.getJourney(X);if(null==se){let be=new ie.vw;be.Title="Stage "+(_e.Stages.length+1),be.WayPoints.push(Ee),_e.Stages.push(be)}else{let be=_e.Stages[se];null==be.WayPoints&&(be.WayPoints=[]),be.WayPoints.push(Ee)}}addJourneyStage(X,se){return this.getJourney(X).Stages.push(se)-1}setupTestJourneys(){this.journeys=[];let X=new ie.fw;X.Title="New York to Brooklyn",X.Notes="A little jaunt to Brooklyn",X.Stages=[];let se=new ie.vw,Ee=new ie.kA;Ee.Notes="Starting point",Ee.Position=new q.wC(40,1.2),Ee.Title="Start",se.WayPoints.push(Ee);let _e=new ie.kA;_e.Notes="Middle point",_e.Position=new q.wC(40,1.33),_e.Title="Middle",se.WayPoints.push(_e);let be=new ie.kA;be.Notes="End point",be.Position=new q.wC(40,1.33),be.Title="End",se.WayPoints.push(be),X.Stages.push(se),this.journeys.push(X);let Re=new ie.fw;Re.Title="Aberdeen to London",Re.Notes="Roadtrip",Re.Stages=[],this.journeys.push(Re)}calculateEnergyConsumptionkWh(X,se,Ee=0,_e){return X*_e}setRoutePolyline(X){this.routePolyline=X}getRoutePolyline(){return this.routePolyline}}return(0,x.Z)(Se,"\u0275fac",function(X){return new(X||Se)(y.LFG(v.l),y.LFG(s.R),y.LFG(d.z))}),(0,x.Z)(Se,"\u0275prov",y.Yz7({token:Se,factory:Se.\u0275fac,providedIn:"root"})),Se})()},9127:(zn,Dt,R)=>{"use strict";R.d(Dt,{i:()=>s,z:()=>Q});var x=R(1180),d=R(553),v=R(2029),s=(()=>((s=s||{})[s.VERBOSE=0]="VERBOSE",s[s.INFO=1]="INFO",s[s.WARNING=2]="WARNING",s[s.ERROR=3]="ERROR",s))();let Q=(()=>{class ie{constructor(){(0,x.Z)(this,"logLevel",void 0),this.logLevel=s.VERBOSE,d.N.production&&(this.logLevel=s.INFO)}log(y,fe=s.VERBOSE){console&&console.log&&fe>=this.logLevel&&console.log("["+s[fe]+"] {"+(new Date).toLocaleTimeString()+"} "+y)}}return(0,x.Z)(ie,"\u0275fac",function(y){return new(y||ie)}),(0,x.Z)(ie,"\u0275prov",v.Yz7({token:ie,factory:ie.\u0275fac,providedIn:"root"})),ie})()},4669:(zn,Dt,R)=>{"use strict";R.d(Dt,{R:()=>y});var x=R(5861),d=R(1180),v=R(9127),s=R(439),Q=R(3294),ie=R(2029),q=R(5957);let y=(()=>{class fe{constructor(De,X,se,Ee){(0,d.Z)(this,"api",void 0),(0,d.Z)(this,"events",void 0),(0,d.Z)(this,"logging",void 0),(0,d.Z)(this,"analytics",void 0),(0,d.Z)(this,"poiList",void 0),(0,d.Z)(this,"isRequestInProgress",!1),this.api=De,this.events=X,this.logging=se,this.analytics=Ee}refreshPOIList(De){var X=this;return(0,x.Z)(function*(){try{return X.poiList=yield X.fetchPOIList(De),X.events.publish("ocm:poiList:updated"),X.analytics.appEvent("Search","Fetched Results"),X.poiList.length}catch{return 0}})()}fetchPOIList(De){var X=this;return(0,x.Z)(function*(){X.isRequestInProgress=!0;try{let se=yield X.api.fetchPOIListByParam(De);return X.isRequestInProgress=!1,se&&se.length&&X.logging.log("fetched POI list ["+se.length+"]"),se}catch{return X.isRequestInProgress=!1,[]}})()}clearResults(){this.poiList=[],this.events.publish("ocm:poiList:cleared"),this.logging.log("clearing results after settings change",v.i.VERBOSE)}getPOIById(De,X=!1,se=!1){var Ee=this;return(0,x.Z)(function*(){if(!se&&null!=Ee.poiList){const Re=Ee.poiList.find(Ne=>Ne.ID==De);if(Re)return Re}const _e={poiIdList:[De],enableCaching:!se,includeComments:!0},be=yield Ee.api.fetchPOIListByParam(_e);return be&&be.length>0?(Ee.poiList&&be[0].ID==De&&(Ee.poiList=Ee.poiList.filter(Re=>Re.ID!=De),Ee.poiList.push(be[0]),Ee.logging.log("POI refreshed in cache "+De)),be[0]):null})()}}return(0,d.Z)(fe,"\u0275fac",function(De){return new(De||fe)(ie.LFG(s.l),ie.LFG(q.z),ie.LFG(v.z),ie.LFG(Q.c))}),(0,d.Z)(fe,"\u0275prov",ie.Yz7({token:fe,factory:fe.\u0275fac,providedIn:"root"})),fe})()},9159:(zn,Dt,R)=>{"use strict";R.d(Dt,{W:()=>ie});var x=R(5861),d=R(1180),v=R(9127),s=R(2029),Q=R(9862);let ie=(()=>{class q{constructor(fe,Se){(0,d.Z)(this,"http",void 0),(0,d.Z)(this,"logging",void 0),(0,d.Z)(this,"referenceData",void 0),(0,d.Z)(this,"filteredReferenceData",void 0),this.http=fe,this.logging=Se,this.loadCachedRefData()}refreshReferenceData(fe){var Se=this;return(0,x.Z)(function*(){try{const De=yield fe.fetchCoreReferenceData(null).toPromise();return Se.setCoreReferenceData(De),Se.setFilteredReferenceData(De),Se.logging.log("Got refreshed core ref data.",v.i.VERBOSE),Se.sortCoreReferenceData(),Se.cacheCurrentRefData(),!0}catch(De){return Se.logging.log("Error fetching core ref data:"+De),!1}})()}refreshFilteredReferenceData(fe,Se){fe.fetchCoreReferenceData(Se).subscribe(De=>{this.setFilteredReferenceData(De),this.sortCoreReferenceData(),this.logging.log("Got refreshed filtered reference data.",v.i.VERBOSE)},De=>{this.logging.log("Error fetching filtered reference data:"+De)})}setCoreReferenceData(fe){this.referenceData=fe}setFilteredReferenceData(fe){this.filteredReferenceData=fe}referenceDataLoaded(){return null!=this.referenceData}getCountries(fe=!1){return 1==fe?this.filteredReferenceData.Countries:this.referenceData.Countries}getCountryByID(fe){return this.getRefDataByID(this.referenceData.Countries,fe)}getConnectionTypes(fe=!1){return 1==fe?this.filteredReferenceData.ConnectionTypes:this.referenceData.ConnectionTypes}getConnectionTypeByID(fe){return this.getRefDataByID(this.referenceData.ConnectionTypes,fe)}getUsageTypes(fe=!1){return 1==fe?this.filteredReferenceData.UsageTypes:this.referenceData.UsageTypes.filter(Se=>Se.ID>0)}getUsageTypeByID(fe){return this.getRefDataByID(this.referenceData.UsageTypes,fe)}getStatusTypes(fe=!1){return 1==fe?this.filteredReferenceData.StatusTypes:this.referenceData.StatusTypes.filter(Se=>Se.ID>0)}getStatusTypeByID(fe){return this.getRefDataByID(this.referenceData.StatusTypes,fe)}getNetworkOperators(fe=!1){return 1==fe?this.filteredReferenceData.Operators:this.referenceData.Operators}getNetworkOperatorByID(fe){return this.getRefDataByID(this.referenceData.Operators,fe)}getDataProviders(fe=!1){return 1==fe?this.filteredReferenceData.DataProviders:this.referenceData.DataProviders}getDataProviderByID(fe){return this.getRefDataByID(this.referenceData.DataProviders,fe)}getCheckinStatusTypes(fe=!1,Se=!0){let De=null;return De=1==fe?this.filteredReferenceData.CheckinStatusTypes:this.referenceData.CheckinStatusTypes,Se&&(De=De.filter(X=>!1===X.IsAutomatedCheckin)),De}getCheckinStatusTypeByID(fe){return this.getRefDataByID(this.referenceData.CheckinStatusTypes,fe)}getCommentTypes(fe=!1,Se=!0){let De;return De=1==fe?this.filteredReferenceData.UserCommentTypes:this.referenceData.UserCommentTypes,Se&&(De=De.filter(X=>100!==X.ID&&110!==X.ID)),De}getCommentTypeByID(fe){return this.getRefDataByID(this.referenceData.UserCommentTypes,fe)}getSubmissionStatusTypes(fe=!1){return 1==fe?this.filteredReferenceData.SubmissionStatusTypes:this.referenceData.SubmissionStatusTypes}getSubmissionStatusTypesByID(fe){return this.getRefDataByID(this.referenceData.SubmissionStatusTypes,fe)}getChargingLevelTypes(fe=!1){return 1==fe?this.filteredReferenceData.ChargerTypes:this.referenceData.ChargerTypes}getChargingLevelTypeByID(fe){return this.getRefDataByID(this.referenceData.ChargerTypes,fe)}getOutputCurrentTypes(fe=!1){return fe?this.referenceData.CurrentTypes:this.filteredReferenceData.CurrentTypes}getOutputCurrentTypeByID(fe){return this.getRefDataByID(this.referenceData.CurrentTypes,fe)}loadCachedRefData(){const fe=localStorage.getItem("referenceData");if(null==fe)this.http.get("./assets/data/CoreReferenceData.json").subscribe(Se=>{this.logging.log("Using bundled reference data as cached ref data."),this.setCoreReferenceData(Se),this.setFilteredReferenceData(Se)});else{let Se=JSON.parse(fe);this.setCoreReferenceData(Se)}this.setFilteredReferenceData(this.referenceData)}cacheCurrentRefData(){null!=this.referenceData&&(this.referenceData.CacheDate=new Date,localStorage.setItem("referenceData",JSON.stringify(this.referenceData)))}getRefDataByID(fe,Se){if(""!==Se&&(Se=parseInt(Se,10)),null!=fe)for(let De=0;De<fe.length;De++)if(fe[De].ID===Se)return fe[De];return null}sortCoreReferenceData(){this.sortReferenceData(this.referenceData.ConnectionTypes),this.sortReferenceData(this.referenceData.Countries),this.sortReferenceData(this.referenceData.Operators),this.sortReferenceData(this.referenceData.DataProviders),this.sortReferenceData(this.referenceData.UsageTypes),this.sortReferenceData(this.referenceData.StatusTypes),this.sortReferenceData(this.referenceData.CheckinStatusTypes),this.sortReferenceData(this.referenceData.SubmissionStatusTypes),this.filteredReferenceData&&(this.sortReferenceData(this.filteredReferenceData.ConnectionTypes),this.sortReferenceData(this.filteredReferenceData.Operators))}sortReferenceData(fe){fe.sort(this.sortListByTitle)}sortListByTitle(fe,Se){return fe.Title<Se.Title?-1:fe.Title>Se.Title?1:0}getMetadataValueByMetadataFieldID(fe,Se){if(""!==Se&&(Se=parseInt(Se,10)),null!=fe)for(let De=0;De<fe.length;De++)if(fe[De].ID===Se)return fe[De];return null}hydrateCompactPOI(fe,Se=!1){const De=this;if(null!=fe.DataProviderID&&(Se||null==fe.DataProvider)&&(fe.DataProvider=De.getDataProviderByID(fe.DataProviderID)),null!=fe.OperatorID&&(Se||null==fe.OperatorInfo)&&(fe.OperatorInfo=De.getNetworkOperatorByID(fe.OperatorID)),null!=fe.UsageTypeID&&(Se||null==fe.UsageType)&&(fe.UsageType=De.getUsageTypeByID(fe.UsageTypeID)),null!=fe.AddressInfo.CountryID&&(Se||null==fe.AddressInfo.Country)&&(fe.AddressInfo.Country=De.getCountryByID(fe.AddressInfo.CountryID)),null!=fe.StatusTypeID&&(Se||null==fe.StatusType)&&(fe.StatusType=De.getStatusTypeByID(fe.StatusTypeID)),null!=fe.SubmissionStatusTypeID&&(Se||null==fe.SubmissionStatusType)&&(fe.SubmissionStatusType=De.getSubmissionStatusTypesByID(fe.SubmissionStatusTypeID)),null!=fe.Connections)for(let X=0;X<fe.Connections.length;X++){const se=fe.Connections[X];null!=se.ConnectionTypeID&&(Se||null==se.ConnectionType)&&(se.ConnectionType=De.getConnectionTypeByID(se.ConnectionTypeID)),null!=se.LevelID&&(Se||null==se.Level)&&(se.Level=De.getChargingLevelTypeByID(se.LevelID)),null!=se.CurrentTypeID&&(Se||null==se.CurrentType)&&(se.CurrentType=De.getOutputCurrentTypeByID(se.CurrentTypeID)),null!=se.StatusTypeID&&(Se||null==se.StatusType)&&(se.StatusType=De.getStatusTypeByID(se.StatusTypeID)),fe.Connections[X]=se}if(null!=fe.UserComments)for(let X=0;X<fe.UserComments.length;X++){const se=fe.UserComments[X];null!=se.CommentTypeID&&(Se||null==se.CommentType)&&(se.CommentType=De.getCommentTypeByID(se.CommentTypeID)),null!=se.CheckinStatusTypeID&&(Se||null==se.CheckinStatusType)&&(se.CheckinStatusType=De.getCheckinStatusTypeByID(se.CheckinStatusTypeID)),fe.UserComments[X]=se}return fe}hydrateCompactPOIList(fe){for(let Se=0;Se<fe.length;Se++)fe[Se]=this.hydrateCompactPOI(fe[Se]);return fe}}return(0,d.Z)(q,"\u0275fac",function(fe){return new(fe||q)(s.LFG(Q.eN),s.LFG(v.z))}),(0,d.Z)(q,"\u0275prov",s.Yz7({token:q,factory:q.\u0275fac,providedIn:"root"})),q})()},1847:(zn,Dt,R)=>{"use strict";R.d(Dt,{v:()=>Re});var x=R(1180),d=R(9903),v=R(3955),s=R(866),Q=R(9127),ie=R(5861),q=R(5592),y=R(3052),fe=R(553),Se=R(2117);class De{constructor(qe,_t){(0,x.Z)(this,"events",void 0),(0,x.Z)(this,"logging",void 0),(0,x.Z)(this,"mapAPIType",void 0),(0,x.Z)(this,"mapReady",void 0),(0,x.Z)(this,"providerError",void 0),(0,x.Z)(this,"mapCanvasID",void 0),(0,x.Z)(this,"map",void 0),(0,x.Z)(this,"markerList",void 0),(0,x.Z)(this,"polylinePath",void 0),(0,x.Z)(this,"mapkitUtils",void 0),this.events=qe,this.logging=_t,this.events=qe,this.mapAPIType=v.b.MAPKIT_JS,this.mapReady=!1,this.markerList=new Map,this.mapkitUtils=new X}initAPI(){mapkit&&mapkit.init({authorizationCallback:function(qe){qe(fe.N.mapKitToken)}})}disposeMap(){}initMap(qe,_t,Je){this.mapCanvasID=qe;let Me=!0;if(Me=!(typeof mapkit>"u"),!Me)return this.logging.log("Call to initMap before API is ready:"+v.b[this.mapAPIType],Q.i.ERROR),this.mapReady=!1,!1;this.initAPI(),null==this.map&&(document.getElementById(qe),this.map=new mapkit.Map(qe),this.map.annotationForCluster=function(Xe){"poi"===Xe.clusteringIdentifier&&(Xe.title="Charging Location",Xe.subtitle=Xe.memberAnnotations.reduce((Te,ae)=>Te+ae.population,0))},this.mapReady=!0,mapkit.addEventListener("configuration-change",Xe=>{this.events.publish("ocm:mapping:ready")}),this.map.addEventListener("scroll-end",Xe=>{this.events.publish("ocm:mapping:dragend")}),this.map.addEventListener("zoom-end",Xe=>{this.events.publish("ocm:mapping:zoom")}))}clearMarkers(){null!=this.markerList&&this.markerList.forEach((qe,_t)=>{try{this.map.removeAnnotation(_t)}catch{}}),this.markerList=new Map}showPOIListOnMap(qe,_t){let Xe=0,ae=0==this.markerList.size;if(null!=qe){let we=[];for(let Ze=0;Ze<qe.length;Ze++)if(null!=qe[Ze].AddressInfo&&null!=qe[Ze].AddressInfo.Latitude&&null!=qe[Ze].AddressInfo.Longitude){let Ae=qe[Ze],ve=!0;if(null!=this.markerList&&this.markerList.has(Ae.ID)&&(ve=!1),ve){let en=null;en=s.c.getIconForPOI(Ae);let ze="OCM-"+Ae.ID+": "+Ae.AddressInfo.Title+":";null!=Ae.UsageType&&(ze+=" "+Ae.UsageType.Title),null!=Ae.StatusType&&(ze+=" "+Ae.StatusType.Title);const xt=new mapkit.Coordinate(Ae.AddressInfo.Latitude,Ae.AddressInfo.Longitude);let Ve=new mapkit.ImageAnnotation(xt,{title:ze,size:{width:34,height:50},url:{1:en},clusteringIdentifier:"poi"});Ve.poi=Ae,Ve.addEventListener("select",gt=>{const Be=gt.target.poi;this.events.publish("ocm:poi:selected",{poi:Be,poiId:Be.ID})}),this.markerList.set(Ae.ID,Ve),we.push(Ve),Xe++}}we.length>0&&(this.map.addAnnotations(we),ae&&this.map.showItems(we,{animate:!0,padding:new mapkit.Padding(60,25,60,25)})),this.logging.log(Xe+" new map markers added out of a total "+this.markerList.size)}}refreshMapLayout(){null!=this.map&&setTimeout(()=>{this.logging.log("MapKit: refreshMapLayout",Q.i.VERBOSE)},200)}setMapCenter(qe,_t){this.map&&(this.map.setCenterAnimated(new mapkit.Coordinate(qe.coords.latitude,qe.coords.longitude),!1),_t&&this.setMapZoom(_t))}getMapCenter(){return new q.y(_t=>{if(null!=this.map){let Je=this.map.center;null!=Je&&(_t.next(new y.jR(Je.latitude,Je.longitude)),_t.complete())}})}setMapZoom(qe){const _t=Math.min(qe,28),Je=this.mapkitUtils.deltaFromZoomLevel(this.map,this.map.center,Math.round(_t)),Me=new mapkit.CoordinateSpan(111*Je.latitudeDelta,111*Je.longitudeDelta),it=new mapkit.CoordinateRegion(this.map.center,Me);this.map.setRegionAnimated(it)}getMapZoom(){return new q.y(_t=>{this.logging.log("MapKit: getMapZoom not supported",Q.i.VERBOSE),_t.next(this.map._impl.zoomLevel),_t.complete()})}setMapType(qe){this.logging.log("MapKit: skipped setting Map Type :"+qe)}getMapBounds(){return new q.y(_t=>{let Je=new Array,Me=this.map.region.toBoundingRegion();Je.push(new y.wC(Me.southLatitude,Me.westLongitude)),Je.push(new y.wC(Me.northLatitude,Me.eastLongitude)),_t.next(Je),_t.complete()})}moveToMapBounds(qe){this.logging.log("MapKit: map bounds not implemented")}renderMap(qe,_t,Je){return document.getElementById(this.mapCanvasID).style.height=_t+"px",this.mapReady&&this.showPOIListOnMap(qe,Je),!0}renderPolyline(qe){this.clearPolyline()}clearPolyline(){null!=this.polylinePath&&this.polylinePath.setMap(null)}focusMap(){}unfocusMap(){}placeSearch(qe){return(0,ie.Z)(function*(){let _t=new mapkit.Search({getsUserLocation:!0});return new Promise(function(){var Je=(0,ie.Z)(function*(Me,it){let Xe=[];_t.search(qe,function(){var Te=(0,ie.Z)(function*(ae,yt){ae&&it(ae),Xe=[],yt.places.map(we=>{let Ze=new Se.n;Ze.Title=we.name,Ze.Address=we.formattedAddress,Ze.Type="place",Ze.Location=new y.wC(we.coordinate.latitude,we.coordinate.longitude),Xe.push(Ze)}),Me(Xe)});return function(ae,yt){return Te.apply(this,arguments)}}())});return function(Me,it){return Je.apply(this,arguments)}}())})()}addPOILayer(qe){this.logging.log("Add POI Layer not implemented in this provider.")}}class X{constructor(){(0,x.Z)(this,"mercatorRadius",85445659.44705395),(0,x.Z)(this,"mercatorOffset",268435456)}longitudeToPixelSpaceX(qe){return Math.round(this.mercatorOffset+this.mercatorRadius*qe*Math.PI/180)}latitudeToPixelSpaceY(qe){return Math.round(this.mercatorOffset-this.mercatorRadius*Math.log((1+Math.sin(qe*Math.PI/180))/(1-Math.sin(qe*Math.PI/180)))/2)}pixelSpaceXToLongitude(qe){return(Math.round(qe)-this.mercatorOffset)/this.mercatorRadius*180/Math.PI}pixelSpaceYToLatitude(qe){return 180*(Math.PI/2-2*Math.atan(Math.exp((Math.round(qe)-this.mercatorOffset)/this.mercatorRadius)))/Math.PI}deltaFromZoomLevel(qe,_t,Je){let Me=this.longitudeToPixelSpaceX(_t.longitude),it=this.latitudeToPixelSpaceY(_t.latitude),Te=Math.pow(2,20-Je),ae=qe.visibleMapRect.size,yt=ae.width*Te,we=ae.height*Te,Ze=Me-yt/2,Ae=it-we/2,ve=this.pixelSpaceXToLongitude(Ze),dt=this.pixelSpaceXToLongitude(Ze+yt)-ve,mt=this.pixelSpaceYToLatitude(Ae);return{latitudeDelta:-1*(this.pixelSpaceYToLatitude(Ae+we)-mt),longitudeDelta:dt}}}var se=R(2029),Ee=R(5957),_e=R(9862);let be=(()=>{class Ne extends d.k{constructor(_t,Je,Me){super(_t,Je,Me),this.mapAPIType=v.b.MAPTILER,this.mapTileSet="https://maps.tilehosting.com/styles/streets/style.json?key=Gs9z7krALe3CGI60d5cL"}initAPI(){}}return(0,x.Z)(Ne,"\u0275fac",function(_t){return new(_t||Ne)(se.LFG(Ee.z),se.LFG(Q.z),se.LFG(_e.eN))}),(0,x.Z)(Ne,"\u0275prov",se.Yz7({token:Ne,factory:Ne.\u0275fac})),Ne})(),Re=(()=>{class Ne{constructor(_t,Je,Me){(0,x.Z)(this,"logging",void 0),(0,x.Z)(this,"http",void 0),(0,x.Z)(this,"map",void 0),(0,x.Z)(this,"mapCentreMarker",void 0),(0,x.Z)(this,"mapsInitialised",void 0),(0,x.Z)(this,"mapAPIReady",void 0),(0,x.Z)(this,"mapOptions",void 0),(0,x.Z)(this,"searchMarker",void 0),(0,x.Z)(this,"errorMessage",void 0),(0,x.Z)(this,"parentAppContext",void 0),(0,x.Z)(this,"mapProvider",void 0),(0,x.Z)(this,"debouncedMapPositionUpdate",void 0),(0,x.Z)(this,"events",void 0),(0,x.Z)(this,"isFocused",!1),this.logging=Je,this.http=Me,this.events=_t,this.mapOptions=new v._,this.mapAPIReady=!1,this.mapsInitialised=!1,this.setMapAPI(this.mapOptions.mapAPI);let it=this;this.debouncedMapPositionUpdate=s.c.debounce(()=>{this.logging.log("signaling map position change:"),it.mapProvider.mapReady&&it.getMapCenter().subscribe(Xe=>{null!=Xe?(this.logging.log("Map centre/zoom changed, updating search position:"+Xe),this.updateMapCentrePos(Xe.coords.latitude,Xe.coords.longitude,!1)):this.logging.log("Map centre/zoom changed - map not ready to change centre pos:")})},300,!1)}setParentAppContext(_t){this.parentAppContext=_t}setMapAPI(_t){this.mapOptions.mapAPI=_t,this.mapOptions.mapAPI==v.b.MAPBOX&&(this.mapProvider=new d.k(this.events,this.logging,this.http)),this.mapOptions.mapAPI==v.b.MAPKIT_JS&&(this.mapProvider=new De(this.events,this.logging)),this.mapOptions.mapAPI==v.b.MAPTILER&&(this.mapProvider=new be(this.events,this.logging,this.http))}isMapReady(){return null!=this.mapProvider&&this.mapProvider.mapReady}externalAPILoaded(_t){this.mapAPIReady=!0,this.logging.log("Mapping API Loaded: "+v.b[_t])}initMap(_t){if(!this.isMapReady())if(null!=this.mapProvider)this.mapsInitialised&&this.logging.log("initMap: Map provider already initialised"),this.logging.log("Mapping Manager: Init "+v.b[this.mapProvider.mapAPIType]),this.mapProvider.initMap(_t,this.mapOptions,this);else{if(this.mapsInitialised)return void this.logging.log("initMap: map already initialised");this.logging.log("initMap: "+this.mapOptions.mapAPI)}}mapManipulationPerformed(_t){this.logging.log("map manipulated:"+_t),("drag"==_t||"zoom"==_t)&&this.debouncedMapPositionUpdate()}updateMapSize(){this.mapProvider&&this.mapProvider.refreshMapLayout()}updateMapCentrePos(_t,Je,Me,it){Me&&null!=this.mapProvider&&this.mapProvider.setMapCenter(new y.jR(_t,Je),it),this.mapOptions.mapCentre=new y.jR(_t,Je)}moveToMapBounds(_t){this.mapProvider.moveToMapBounds(_t)}refreshMapView(_t,Je,Me){return null!=this.mapProvider?(this.logging.log("Mapping Manager: renderMap "+v.b[this.mapProvider.mapAPIType]),this.isMapReady()?this.mapProvider.renderMap(Je,_t,this.parentAppContext):this.logging.log("refreshMapView: map provider not initialised..")):this.logging.log("Unsupported Map API: refreshMapView",Q.i.ERROR),!0}setMapType(_t){this.mapOptions.mapType!=_t&&(this.mapOptions.mapType=_t,this.isMapReady()&&null!=this.mapProvider?(this.logging.log("Changing map type:"+_t),this.mapProvider.setMapType(_t)):this.logging.log("Map type set, maps not initialised yet."))}unfocusMap(){this.logging.log("[mapping] Unfocus Map."),this.isFocused=!1,this.mapProvider.unfocusMap()}focusMap(){this.logging.log("[mapping] Focus Map."),this.isFocused=!0,this.mapProvider.focusMap()}getMapBounds(){return this.mapProvider.getMapBounds()}getMapZoom(){return this.mapProvider.getMapZoom()}setMapZoom(_t){this.mapProvider.setMapZoom(_t)}getMapCenter(){return this.mapProvider.getMapCenter()}showPOIOnStaticMap(_t,Je,Me=!1,it=!1,Xe=200,Te=200){let ae=document.getElementById(_t);if(null!=ae){let we=Je.AddressInfo.Latitude,Ze=Je.AddressInfo.Longitude;Xe>640&&(Xe=640),Te>640&&(Te=640);let Ae=Xe,ve=Te,en="https://maps.googleapis.com/maps/api/staticmap?center="+we+","+Ze+"&zoom=14&size="+Ae+"x"+ve+"&maptype=roadmap&markers=color:blue%7Clabel:A%7C"+we+","+Ze+"&sensor=false",dt="";dt+=1==Me?"<div>"+s.c.formatMapLink(Je,'<div><img width="'+Ae+'" height="'+ve+'" src="'+en+'" /></div>',it)+"</div>":'<div><img width="'+Ae+'" height="'+ve+'" src="'+en+'" /></div>',ae.innerHTML=dt}}renderPolyline(_t){this.mapProvider.renderPolyline(_t)}clearPolyline(){this.mapProvider.clearPolyline()}clearMarkers(){this.logging.log("mapping: clearing markers"),this.mapProvider.clearMarkers()}addPOILayer(_t){this.mapProvider.addPOILayer(_t)}}return(0,x.Z)(Ne,"\u0275fac",function(_t){return new(_t||Ne)(se.LFG(Ee.z),se.LFG(Q.z),se.LFG(_e.eN))}),(0,x.Z)(Ne,"\u0275prov",se.Yz7({token:Ne,factory:Ne.\u0275fac,providedIn:"root"})),Ne})()},3955:(zn,Dt,R)=>{"use strict";R.d(Dt,{_:()=>s,b:()=>v});var x=R(1180),d=R(553),v=(()=>((v=v||{})[v.GOOGLE_WEB=1]="GOOGLE_WEB",v[v.GOOGLE_NATIVE=2]="GOOGLE_NATIVE",v[v.LEAFLET=3]="LEAFLET",v[v.MAPBOX=4]="MAPBOX",v[v.MAPKIT_JS=5]="MAPKIT_JS",v[v.MAPTILER=6]="MAPTILER",v))();class s{constructor(){(0,x.Z)(this,"enableClustering",void 0),(0,x.Z)(this,"resultBatchID",void 0),(0,x.Z)(this,"useMarkerIcons",void 0),(0,x.Z)(this,"useMarkerAnimation",void 0),(0,x.Z)(this,"enableTrackingMapCentre",void 0),(0,x.Z)(this,"enableSearchByWatchingLocation",void 0),(0,x.Z)(this,"mapCentre",void 0),(0,x.Z)(this,"searchDistanceKM",void 0),(0,x.Z)(this,"iconSet",void 0),(0,x.Z)(this,"mapAPI",void 0),(0,x.Z)(this,"mapMoveQueryRefreshMS",void 0),(0,x.Z)(this,"requestSearchUpdate",void 0),(0,x.Z)(this,"enableSearchRadiusIndicator",void 0),(0,x.Z)(this,"mapType",void 0),(0,x.Z)(this,"minZoomLevel",void 0),(0,x.Z)(this,"onMapMoveCompleted",void 0),this.enableClustering=!1,this.resultBatchID=-1,this.useMarkerIcons=!0,this.useMarkerAnimation=!0,this.enableTrackingMapCentre=!1,this.enableSearchByWatchingLocation=!1,this.mapCentre=null,this.mapAPI=d.N.defaultMapProvider,this.mapType="ROADMAP",this.searchDistanceKM=1e5,this.mapMoveQueryRefreshMS=300,this.enableSearchRadiusIndicator=!1,this.minZoomLevel=2}}},9903:(zn,Dt,R)=>{"use strict";R.d(Dt,{k:()=>be});var x=R(5861),d=R(1180),v=R(866),s=R(3955),Q=R(5592),ie=R(3052),q=R(9127),y=R(2574),Se=R(553),De=R(2117),X=R(2029),se=R(5957),Ee=R(9862);let be=(()=>{class Re{constructor(qe,_t,Je){(0,d.Z)(this,"events",void 0),(0,d.Z)(this,"logging",void 0),(0,d.Z)(this,"http",void 0),(0,d.Z)(this,"mapAPIType",void 0),(0,d.Z)(this,"mapReady",void 0),(0,d.Z)(this,"providerError",void 0),(0,d.Z)(this,"mapCanvasID",void 0),(0,d.Z)(this,"map",void 0),(0,d.Z)(this,"markerList",void 0),(0,d.Z)(this,"polylinePath",void 0),(0,d.Z)(this,"_isMapAnimating",!1),(0,d.Z)(this,"searchMarker",void 0),(0,d.Z)(this,"mapTileSet",void 0),this.events=qe,this.logging=_t,this.http=Je,this.events=qe,this.mapAPIType=s.b.MAPBOX,this.mapReady=!1,this.markerList=new Map}initAPI(){y&&(y.accessToken=Se.N.mapBoxToken)}disposeMap(){this.map&&(this.logging.log("Disposing map",q.i.INFO),this.map.remove())}getCurrentMapTileSet(qe){return"SATELLITE"==qe?"mapbox://styles/mapbox/satellite-streets-v12?optimize=true":"mapbox://styles/mapbox/streets-v12?optimize=true"}flyAroundPoint(qe){if(this._isMapAnimating){this.map.rotateTo(qe/100%360,{duration:0});const _t=this;requestAnimationFrame(function(Je){_t.flyAroundPoint(Je)})}}initMap(qe,_t,Je){this.mapCanvasID=qe;let Me=!0;if(Me=!(typeof y>"u"),!Me)return this.logging.log("Call to initMap before API is ready:"+s.b[this.mapAPIType],q.i.ERROR),this.mapReady=!1,!1;if(null==this.map){let ae=function(we){return we*(2-we)};document.getElementById(qe),this.initAPI(),this.map=new y.Map({container:qe,style:this.getCurrentMapTileSet(_t.mapType),zoom:15,attributionControl:!1}),this.map.addControl(new y.AttributionControl({compact:!0,customAttribution:["Open Charge Map Contributors"]})),this.map.addControl(new y.NavigationControl),this.mapReady=!0,this.map.getCanvas().focus();let Xe=100,Te=25;this.map.getCanvas().addEventListener("keydown",we=>{we.preventDefault(),38===we.which?this.map.panBy([0,-Xe],{easing:ae}):40===we.which?this.map.panBy([0,Xe],{easing:ae}):37===we.which?this.map.easeTo({bearing:this.map.getBearing()-Te,easing:ae}):39===we.which?this.map.easeTo({bearing:this.map.getBearing()+Te,easing:ae}):32===we.which&&(this._isMapAnimating?this._isMapAnimating=!1:(this._isMapAnimating=!0,this.flyAroundPoint(0)))},!0),this.map.on("load",()=>{this.events.publish("ocm:mapping:ready")});let yt=v.c.debounce(()=>{this.getMapCenter().subscribe(we=>{this.searchMarker.setLngLat(new y.LngLat(we.coords.longitude,we.coords.latitude))})},500,!1);this.map.on("move",()=>{this.searchMarker&&yt()}),this.map.on("moveend",()=>{this.events.publish("ocm:mapping:dragend"),_t.onMapMoveCompleted&&_t.onMapMoveCompleted()}),this.map.on("zoomend",()=>{this.events.publish("ocm:mapping:zoom")})}}clearMarkers(){null!=this.markerList&&this.markerList.forEach((qe,_t)=>{qe.remove()}),this.markerList=new Map}showPOIListOnMap(qe,_t,Je=!0){let it=this.map,Xe=new y.LngLatBounds,Te=0;if(it.getZoom(),null!=qe){for(let Ae=0;Ae<qe.length;Ae++)if(null!=qe[Ae].AddressInfo&&null!=qe[Ae].AddressInfo.Latitude&&null!=qe[Ae].AddressInfo.Longitude){let ve=qe[Ae],en=!0;if(null!=this.markerList&&this.markerList.has(ve.ID)){en=!1;let dt=this.markerList.get(ve.ID);dt&&dt.poi&&dt.poi.DateLastStatusUpdate!=ve.DateLastStatusUpdate&&(dt.remove(),en=!0)}if(en){let dt=null,mt=null;Je?(dt=document.createElement("img"),dt.src=v.c.getIconForPOI(ve),dt.width=34,dt.height=50):(dt=null,mt=v.c.getColorForPOI(ve));let ze=(Je?"OCM-":"EXT-")+ve.ID+": "+ve.AddressInfo.Title+":";null!=ve.UsageType&&(ze+=" "+ve.UsageType.Title),null!=ve.StatusType&&(ze+=" "+ve.StatusType.Title);let xt=new y.Marker({element:dt,color:mt,anchor:"bottom"}).setLngLat([ve.AddressInfo.Longitude,ve.AddressInfo.Latitude]).addTo(it);xt.poi=ve;let Ve=xt.getElement();Ve.poi=ve,Ve.addEventListener("click",gt=>{const Be=gt.currentTarget.poi;this.events.publish("ocm:poi:selected",{poiId:Be.ID,poi:Be})}),Xe.extend(xt.getLngLat()),this.markerList.set(ve.ID,xt),Te++}}this.logging.log(Te+" new map markers added out of a total "+this.markerList.size)}if(null!=qe&&qe.length>0)if(null==_t||_t.appConfig.enableLiveMapQuerying)null==it.getCenter()&&it.setCenter(Xe.getCenter());else{this.logging.log("Fitting to marker bounds:"+Xe),it.setCenter(Xe.getCenter()),this.logging.log("zoom before fit bounds:"+it.getZoom()),it.fitBounds(Xe);let Ze=it.getZoom();it.setZoom(Ze<6?6:Ze)}}refreshMapLayout(){null!=this.map&&setTimeout(()=>{this.logging.log("MapBoxGL: refreshMapLayout",q.i.VERBOSE),this.map.resize()},200)}setMapCenter(qe){this.mapReady&&(this.map.setCenter(new y.LngLat(qe.coords.longitude,qe.coords.latitude)),this.searchMarker||(this.searchMarker=new y.Marker({color:"#99ccff",anchor:"bottom"}).setLngLat(new y.LngLat(qe.coords.longitude,qe.coords.latitude)).addTo(this.map),this.searchMarker.getElement().addEventListener("click",()=>{let _t=this.searchMarker.getLngLat();this.events.publish("ocm:mapping:addpoi",new ie.wC(_t.lat,_t.lng))})))}getMapCenter(){return new Q.y(_t=>{if(null!=this.map){let Je=this.map.getCenter();null!=Je&&(_t.next(new ie.jR(Je.lat,Je.lng)),_t.complete())}})}setMapZoom(qe){this.map.setZoom(qe)}getMapZoom(){return new Q.y(_t=>{let Je=this.map.getZoom();_t.next(Je),_t.complete()})}setMapType(qe){this.map.setStyle(this.getCurrentMapTileSet(qe))}getMapBounds(){return new Q.y(_t=>{let Je=new Array,Me=this.map.getBounds();Je.push(new ie.wC(Me.getSouthWest().lat,Me.getSouthWest().lng)),Je.push(new ie.wC(Me.getNorthEast().lat,Me.getNorthEast().lng)),_t.next(Je),_t.complete()})}moveToMapBounds(qe){this.map.fitBounds(new y.LngLatBounds(new y.LngLat(qe.southWest.longitude,qe.southWest.latitude),new y.LngLat(qe.northEast.longitude,qe.northEast.latitude)))}renderMap(qe,_t,Je){return document.getElementById(this.mapCanvasID).style.height=_t+"px",this.mapReady&&this.showPOIListOnMap(qe,Je),!0}renderPolyline(qe){this.clearPolyline()}clearPolyline(){null!=this.polylinePath&&this.polylinePath.setMap(null)}focusMap(){}unfocusMap(){}placeSearch(qe,_t,Je){var Me=this;return(0,x.Z)(function*(){let it=`https://api.mapbox.com/geocoding/v5/mapbox.places/${qe||Je+","+_t}.json?access_token=${Se.N.mapBoxToken}`;return new Promise(function(){var Xe=(0,x.Z)(function*(Te,ae){Me.http.get(it).toPromise().then(yt=>{let we=[];we=[],yt.features&&yt.features.map(Ze=>{let Ae=new De.n;Ae.Title=Ze.place_name,Ae.Address=Ze.place_name,Ae.Type="place",Ae.Location=new ie.wC(Ze.center[1],Ze.center[0]),Ae.Attribution=yt.attribution,we.push(Ae)}),Te(we)})});return function(Te,ae){return Xe.apply(this,arguments)}}())})()}addPOILayer(qe){this.logging.log("Add POI Layer not implemented in this provider."),this.showPOIListOnMap(qe,null,!1)}}return(0,d.Z)(Re,"\u0275fac",function(qe){return new(qe||Re)(X.LFG(se.z),X.LFG(q.z),X.LFG(Ee.eN))}),(0,d.Z)(Re,"\u0275prov",X.Yz7({token:Re,factory:Re.\u0275fac})),Re})()},553:(zn,Dt,R)=>{"use strict";R.d(Dt,{N:()=>x});const x={name:"prod",version:"8.5.5",production:!0,analyticsId:"",googleMapsKey:"",mapBoxToken:"pk.eyJ1Ijoid2VicHJvZnVzaW9uIiwiYSI6ImNrdHZlc2N5dTI5Zjcydm8zYWFwc2JnbTMifQ.M7b5SOzbPcg_8XAHCOeP0w",mapKitToken:"",enableStaticMaps:!1,defaultMapProvider:4,apiBase:"https://api.openchargemap.io",apiKey:"9bb03e5b-0fb2-4916-9b2b-26c6bd27a56a",enabledFeatures:["MAP","ADD_COMMENT","ADD_PHOTO","FAVOURITES","FILTER_OPTIONS_BY_COUNTRY","ADD_POI","EDIT_POI","LAYERS"]}},248:(zn,Dt,R)=>{"use strict";var x=R(6593),d=R(2029),v=R(1180),s=R(5086),Q=R(3999),ie=R(6814),q=R(6223),y=R(7852);let fe=(()=>{class xn{}return(0,v.Z)(xn,"\u0275fac",function(Mt){return new(Mt||xn)}),(0,v.Z)(xn,"\u0275mod",d.oAB({type:xn})),(0,v.Z)(xn,"\u0275inj",d.cJS({imports:[ie.ez,q.u5,y.Pc,Q.aw,s.e]})),xn})(),Se=(()=>{class xn{}return(0,v.Z)(xn,"\u0275fac",function(Mt){return new(Mt||xn)}),(0,v.Z)(xn,"\u0275mod",d.oAB({type:xn})),(0,v.Z)(xn,"\u0275inj",d.cJS({imports:[ie.ez,q.u5,y.Pc,Q.aw,s.e]})),xn})(),De=(()=>{class xn{}return(0,v.Z)(xn,"\u0275fac",function(Mt){return new(Mt||xn)}),(0,v.Z)(xn,"\u0275mod",d.oAB({type:xn})),(0,v.Z)(xn,"\u0275inj",d.cJS({imports:[ie.ez,q.u5,y.Pc,Q.aw,s.e]})),xn})();var X=R(4606),se=R(9862),Ee=R(2125),_e=R(6091);class be{constructor(Qt,Mt="/assets/i18n/",ge=".json"){(0,v.Z)(this,"http",void 0),(0,v.Z)(this,"prefix",void 0),(0,v.Z)(this,"suffix",void 0),this.http=Qt,this.prefix=Mt,this.suffix=ge}getTranslation(Qt){return this.http.get(`${this.prefix}${Qt}${this.suffix}`)}}var Re=R(5861),Ne=R(1847),qe=R(3247),_t=R(8767),Je=R(4292),Me=R(1618);function it(xn,Qt){if(1&xn){const Mt=d.EpF();d.TgZ(0,"div"),d._uU(1," You are not signed in. "),d.TgZ(2,"button",5),d.NdJ("click",function(){d.CHM(Mt);const ct=d.oxw();return d.KtG(ct.showSignInModal())}),d._uU(3),d.ALo(4,"translate"),d.qZA()()}2&xn&&(d.xp6(3),d.Oqu(d.lcZ(4,1,"ocm.general.signIn")))}function Xe(xn,Qt){if(1&xn&&(d.TgZ(0,"div")(1,"ion-card")(2,"ion-item")(3,"ion-avatar",6),d._UZ(4,"img",7),d.qZA(),d.TgZ(5,"h2"),d._uU(6),d.qZA()(),d.TgZ(7,"ion-card-content")(8,"p"),d._uU(9),d.qZA(),d.TgZ(10,"p"),d._uU(11),d.qZA()(),d.TgZ(12,"ion-item")(13,"ion-note",8),d._UZ(14,"ion-icon",9),d._uU(15),d.qZA()()()()),2&xn){const Mt=d.oxw();d.xp6(4),d.s9C("src",Mt.userProfile.ProfileImageURL,d.LSH),d.xp6(2),d.Oqu(Mt.userProfile.Username),d.xp6(3),d.hij(" ",Mt.userProfile.Profile,""),d.xp6(2),d.hij(" Date Joined: ",Mt.userProfile.DateCreated," "),d.xp6(4),d.hij(" ",Mt.userProfile.ReputationPoints," Contributor Points ")}}let Te=(()=>{class xn{constructor(Mt,ge,ct,Gt){(0,v.Z)(this,"appManager",void 0),(0,v.Z)(this,"nav",void 0),(0,v.Z)(this,"translate",void 0),(0,v.Z)(this,"modalController",void 0),(0,v.Z)(this,"userProfile",void 0),this.appManager=Mt,this.nav=ge,this.translate=ct,this.modalController=Gt}ionViewDidEnter(){this.userProfile=this.appManager.getUserProfile(),null!=this.userProfile&&this.appManager.isUserAuthenticated(!0)?this.refreshProfileView():this.showSignInModal(),this.appManager.analytics.viewEvent("Profile")}refreshProfileView(){this.userProfile=this.appManager.getUserProfile()}showSignInModal(){this.modalController.create({component:_t.F,componentProps:{Profile:this.userProfile}}).then(Mt=>{Mt.onDidDismiss().then(()=>{this.refreshProfileView()}),Mt.present()})}close(){this.modalController.dismiss()}}return(0,v.Z)(xn,"\u0275fac",function(Mt){return new(Mt||xn)(d.Y36(Me.c),d.Y36(y.SH),d.Y36(Q.sK),d.Y36(y.IN))}),(0,v.Z)(xn,"\u0275cmp",d.Xpm({type:xn,selectors:[["ng-component"]],decls:14,vars:5,consts:[[1,"profile-page","ion-padding"],[4,"ngIf"],["slot","end"],[3,"click"],["name","close","slot","start"],["ion-button","",3,"click"],["slot","start"],[3,"src"],["item-left",""],["name","star"]],template:function(Mt,ge){1&Mt&&(d.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),d._uU(3),d.ALo(4,"translate"),d.qZA()()(),d.TgZ(5,"ion-content",0),d.YNc(6,it,5,3,"div",1),d.YNc(7,Xe,16,5,"div",1),d.qZA(),d.TgZ(8,"ion-footer")(9,"ion-toolbar")(10,"ion-buttons",2)(11,"ion-button",3),d.NdJ("click",function(){return ge.close()}),d._UZ(12,"ion-icon",4),d._uU(13," Close "),d.qZA()()()()),2&Mt&&(d.xp6(3),d.hij(" ",d.lcZ(4,3,"ocm.navigation.profile.sectionTitle")," "),d.xp6(3),d.Q6J("ngIf",null==ge.userProfile),d.xp6(1),d.Q6J("ngIf",null!=ge.userProfile))},dependencies:[ie.O5,y.BJ,y.YG,y.Sm,y.PM,y.FN,y.W2,y.fr,y.Gu,y.gu,y.Ie,y.uN,y.wd,y.sr,Q.X$],encapsulation:2})),xn})();var ae=R(9127),yt=R(553),we=R(8804),Ze=R(3294),Ae=R(866),ve=R(9236),en=R(8062),dt=R(2726);const mt=(0,dt.fo)("PushNotifications",{}),lt=(0,dt.fo)("StatusBar"),ze=(0,dt.fo)("SplashScreen",{web:()=>R.e(4485).then(R.bind(R,4485)).then(xn=>new xn.SplashScreenWeb)}),xt=(0,dt.fo)("App",{web:()=>R.e(2912).then(R.bind(R,2912)).then(xn=>new xn.AppWeb)});var Ve=R(5957);function gt(xn,Qt){if(1&xn){const Mt=d.EpF();d.TgZ(0,"ion-item",9),d.NdJ("click",function(){d.CHM(Mt);const ct=d.oxw();return d.KtG(ct.openRoutePlannerModal())}),d._UZ(1,"ion-icon",12),d.TgZ(2,"ion-label"),d._uU(3," Route Planner "),d.qZA()()}}function Be(xn,Qt){if(1&xn){const Mt=d.EpF();d.TgZ(0,"ion-item",9),d.NdJ("click",function(){d.CHM(Mt);const ct=d.oxw();return d.KtG(ct.add())}),d._UZ(1,"ion-icon",13),d.TgZ(2,"ion-label"),d._uU(3),d.ALo(4,"translate"),d.qZA()()}2&xn&&(d.xp6(3),d.hij(" ",d.lcZ(4,1,"ocm.general.addLocation")," "))}function Bt(xn,Qt){if(1&xn){const Mt=d.EpF();d.TgZ(0,"ion-item",9),d.NdJ("click",function(){d.CHM(Mt);const ct=d.oxw();return d.KtG(ct.journeys())}),d._UZ(1,"ion-icon",12),d.TgZ(2,"ion-label"),d._uU(3," Journeys "),d.qZA()()}}function Wt(xn,Qt){if(1&xn){const Mt=d.EpF();d.TgZ(0,"ion-item",9),d.NdJ("click",function(){d.CHM(Mt);const ct=d.oxw();return d.KtG(ct.addLayer())}),d._UZ(1,"ion-icon",14),d.TgZ(2,"ion-label"),d._uU(3," Add Layer "),d.qZA()()}}function wn(xn,Qt){if(1&xn){const Mt=d.EpF();d.ynx(0),d.TgZ(1,"ion-item",9),d.NdJ("click",function(){d.CHM(Mt);const ct=d.oxw();return d.KtG(ct.signIn())}),d._UZ(2,"ion-icon",15),d.TgZ(3,"ion-label"),d._uU(4),d.ALo(5,"translate"),d.qZA()(),d.BQk()}2&xn&&(d.xp6(4),d.hij(" ",d.lcZ(5,1,"ocm.general.signIn")," "))}function Xt(xn,Qt){if(1&xn){const Mt=d.EpF();d.ynx(0),d.TgZ(1,"ion-item",9),d.NdJ("click",function(){d.CHM(Mt);const ct=d.oxw();return d.KtG(ct.profile())}),d._UZ(2,"ion-icon",15),d.TgZ(3,"ion-label"),d._uU(4),d.ALo(5,"translate"),d.qZA()(),d.TgZ(6,"ion-item",9),d.NdJ("click",function(){d.CHM(Mt);const ct=d.oxw();return d.KtG(ct.signOut())}),d._UZ(7,"ion-icon",16),d.TgZ(8,"ion-label"),d._uU(9),d.ALo(10,"translate"),d._UZ(11,"br"),d.TgZ(12,"small",17),d._uU(13),d.qZA()()(),d.BQk()}if(2&xn){const Mt=d.oxw();d.xp6(4),d.hij(" ",d.lcZ(5,3,"ocm.navigation.profile.sectionTitle")," "),d.xp6(5),d.hij(" ",d.lcZ(10,5,"ocm.general.signOut")," "),d.xp6(4),d.hij(" ",Mt.getUserName(),"")}}const mn=function(){return["/search"]};let an=(()=>{class xn{constructor(Mt,ge,ct,Gt,pn,Gi,ri,Vo){(0,v.Z)(this,"platform",void 0),(0,v.Z)(this,"translate",void 0),(0,v.Z)(this,"mapping",void 0),(0,v.Z)(this,"modalController",void 0),(0,v.Z)(this,"appManager",void 0),(0,v.Z)(this,"logger",void 0),(0,v.Z)(this,"analytics",void 0),(0,v.Z)(this,"events",void 0),(0,v.Z)(this,"enabledFeatures",void 0),this.platform=Mt,this.translate=ge,this.mapping=ct,this.modalController=Gt,this.appManager=pn,this.logger=Gi,this.analytics=ri,this.events=Vo,this.logger.log("Environment: "+yt.N.name),this.initializeApp(),this.enabledFeatures=yt.N.enabledFeatures,1!=pn.searchSettings.EnableAdvancedEditorFeatures&&(this.enabledFeatures=this.enabledFeatures.filter(ut=>"LAYERS"!=ut))}configurePushNotifications(){mt.register(),mt.addListener("registration",Mt=>{this.logger.log("Push registration success, token: "+Mt.value),this.appManager.savePushRegistration(Mt.value)}),mt.addListener("registrationError",Mt=>{this.logger.log("Error on registration: "+JSON.stringify(Mt))}),mt.addListener("pushNotificationReceived",Mt=>{this.logger.log("Push received: "+JSON.stringify(Mt),ae.i.INFO)}),mt.addListener("pushNotificationActionPerformed",Mt=>{this.logger.log("Push action performed: "+JSON.stringify(Mt))})}isUserAuthenticated(){return this.appManager.isUserAuthenticated()}getUserName(){let Mt=this.appManager.getUserProfile();return Mt?Mt.EmailAddress?Mt.EmailAddress:Mt.Username:"Not Signed In"}initializeApp(){var Mt=this;this.platform.ready().then(()=>{this.platform.is("capacitor")&&(lt.show(),ze.hide()),this.translate.addLangs(this.appManager.getLanguages().map(ge=>ge.code)),this.translate.setDefaultLang("en"),null!=this.appManager.searchSettings.Language?this.translate.use(this.appManager.searchSettings.Language):this.translate.currentLang||this.translate.use("en"),this.translate.get("ocm.search.performSearch").toPromise().then(ge=>{}),this.analytics.init(yt.N.analyticsId).then(()=>{this.analytics.setAppVersion(yt.N.version),this.analytics.appEvent("Startup","App Loaded")}).catch(ge=>this.logger.log("Error starting analytics")),this.events.subscribe("ocm:mapping:addpoi",function(){var ge=(0,Re.Z)(function*(ct){Ae.c.isFeatureEnabled("ADD_POI")&&Mt.add(ct)});return function(ct){return ge.apply(this,arguments)}}()),(this.platform.is("ios")||this.platform.is("android"))&&(this.configurePushNotifications(),this.checkForAppOpenUrl())})}checkForAppOpenUrl(){return(0,Re.Z)(function*(){xt.addListener("appUrlOpen",ge=>{alert("App (re)opened with URL: "+ge.url)});let Mt=yield xt.getLaunchUrl();Mt&&Mt.url&&alert("App opened with URL: "+Mt.url)})()}openRoutePlannerModal(){var Mt=this;return(0,Re.Z)(function*(){Mt.mapping.unfocusMap();const ge=yield Mt.modalController.create({component:qe.u});ge.onDidDismiss().then(ct=>{Mt.mapping.focusMap()}),yield ge.present()})()}continueAdd(Mt){var ge=this;return(0,Re.Z)(function*(){const ct=yield ge.modalController.create({component:we.Y,componentProps:{startPos:Mt}});ct.onDidDismiss().then(Gt=>{ge.mapping.focusMap()}),yield ct.present()})()}add(Mt){var ge=this;return(0,Re.Z)(function*(){if(ge.mapping.unfocusMap(),!ge.appManager.isUserAuthenticated(!0)){const ct=yield ge.modalController.create({component:_t.F});return ct.onDidDismiss().then(function(){var Gt=(0,Re.Z)(function*(pn){ge.mapping.focusMap(),ge.appManager.isUserAuthenticated(!0)&&(yield ge.continueAdd(Mt))});return function(pn){return Gt.apply(this,arguments)}}()),yield ct.present()}yield ge.continueAdd(Mt)})()}signIn(){var Mt=this;return(0,Re.Z)(function*(){Mt.mapping.unfocusMap();const ge=yield Mt.modalController.create({component:_t.F});return ge.onDidDismiss().then(ct=>{Mt.mapping.focusMap(),Mt.appManager.isUserAuthenticated(!0)}),yield ge.present()})()}signOut(){var Mt=this;return(0,Re.Z)(function*(){Mt.appManager.signOutCurrentUser()})()}profile(){var Mt=this;return(0,Re.Z)(function*(){Mt.mapping.unfocusMap();const ge=yield Mt.modalController.create({component:Te});ge.onDidDismiss().then(ct=>{Mt.mapping.focusMap()}),yield ge.present()})()}journeys(){var Mt=this;return(0,Re.Z)(function*(){Mt.mapping.unfocusMap();const ge=yield Mt.modalController.create({component:Je.g});ge.onDidDismiss().then(ct=>{Mt.mapping.focusMap()}),yield ge.present()})()}addLayer(){var Mt=this;return(0,Re.Z)(function*(){const ge=yield Mt.modalController.create({component:en.A});yield ge.present();const{data:ct}=yield ge.onWillDismiss();ct&&Mt.mapping.addPOILayer(ct)})()}about(){var Mt=this;return(0,Re.Z)(function*(){Mt.mapping.unfocusMap();const ge=yield Mt.modalController.create({component:ve.t});ge.onDidDismiss().then(ct=>{Mt.mapping.focusMap()}),yield ge.present()})()}}return(0,v.Z)(xn,"\u0275fac",function(Mt){return new(Mt||xn)(d.Y36(y.t4),d.Y36(Q.sK),d.Y36(Ne.v),d.Y36(y.IN),d.Y36(Me.c),d.Y36(ae.z),d.Y36(Ze.c),d.Y36(Ve.z))}),(0,v.Z)(xn,"\u0275cmp",d.Xpm({type:xn,selectors:[["app-root"]],decls:29,vars:17,consts:[["contentId","main-content",3,"disabled"],["contentId","main-content","swipeGesture","false"],["slot","start"],["src","assets/images/icons/branding/AppIcon_128x128.png"],["auto-hide","false"],[3,"routerDirection","routerLink"],["slot","start","name","home"],[3,"click",4,"ngIf"],[4,"ngIf"],[3,"click"],["slot","start","name","information-circle-outline"],["id","main-content"],["slot","start","name","map"],["slot","start","name","add-circle-outline"],["slot","start","name","albums"],["slot","start","name","person"],["slot","start","name","log-out"],[2,"color","#c0c0c0"]],template:function(Mt,ge){1&Mt&&(d.TgZ(0,"ion-app")(1,"ion-split-pane",0)(2,"ion-menu",1)(3,"ion-header")(4,"ion-toolbar")(5,"ion-thumbnail",2),d._UZ(6,"img",3),d.qZA(),d.TgZ(7,"ion-title"),d._uU(8),d.qZA()()(),d.TgZ(9,"ion-content")(10,"ion-list")(11,"ion-menu-toggle",4)(12,"ion-item",5),d._UZ(13,"ion-icon",6),d.TgZ(14,"ion-label"),d._uU(15),d.ALo(16,"translate"),d.qZA()(),d.YNc(17,gt,4,0,"ion-item",7),d.YNc(18,Be,5,3,"ion-item",7),d.YNc(19,Bt,4,0,"ion-item",7),d.YNc(20,Wt,4,0,"ion-item",7),d.YNc(21,wn,6,3,"ng-container",8),d.YNc(22,Xt,14,7,"ng-container",8),d.TgZ(23,"ion-item",9),d.NdJ("click",function(){return ge.about()}),d._UZ(24,"ion-icon",10),d.TgZ(25,"ion-label"),d._uU(26),d.ALo(27,"translate"),d.qZA()()()()()(),d._UZ(28,"ion-router-outlet",11),d.qZA()()),2&Mt&&(d.xp6(1),d.Q6J("disabled",!0),d.xp6(7),d.Oqu(ge.appManager.title),d.xp6(4),d.Q6J("routerDirection","root")("routerLink",d.DdM(16,mn)),d.xp6(3),d.hij(" ",d.lcZ(16,12,"ocm.search.sectionTitle")," "),d.xp6(2),d.Q6J("ngIf",ge.enabledFeatures.includes("ROUTE_PLANNER")),d.xp6(1),d.Q6J("ngIf",ge.enabledFeatures.includes("ADD_POI")),d.xp6(1),d.Q6J("ngIf",ge.enabledFeatures.includes("FAVOURITES")),d.xp6(1),d.Q6J("ngIf",ge.enabledFeatures.includes("LAYERS")),d.xp6(1),d.Q6J("ngIf",!ge.isUserAuthenticated()),d.xp6(1),d.Q6J("ngIf",ge.isUserAuthenticated()),d.xp6(4),d.hij(" ",d.lcZ(27,14,"ocm.general.about")," "))},dependencies:[ie.O5,y.dr,y.W2,y.Gu,y.gu,y.Ie,y.Q$,y.q_,y.z0,y.zc,y.jI,y.Bs,y.wd,y.sr,y.jP,y.YI,Ee.rH,Q.X$],encapsulation:2})),xn})();const Vt=[{path:"",redirectTo:"search",pathMatch:"full"},{path:"search",loadChildren:()=>Promise.resolve().then(R.bind(R,4606)).then(xn=>xn.SearchPageModule)},{path:"journeys",loadChildren:()=>Promise.resolve().then(R.bind(R,9192)).then(xn=>xn.JourneysModule)},{path:"signin",loadChildren:()=>Promise.resolve().then(R.bind(R,9472)).then(xn=>xn.SignInModule)},{path:"poi-editor/:id",loadChildren:()=>Promise.resolve().then(R.bind(R,5722)).then(xn=>xn.PoiEditorPageModule)},{path:"about",loadChildren:()=>Promise.resolve().then(R.bind(R,7425)).then(xn=>xn.AboutPageModule)},{path:"layer-editor",loadChildren:()=>Promise.resolve().then(R.bind(R,2309)).then(xn=>xn.LayerEditorPageModule)}];let St=(()=>{class xn{}return(0,v.Z)(xn,"\u0275fac",function(Mt){return new(Mt||xn)}),(0,v.Z)(xn,"\u0275mod",d.oAB({type:xn})),(0,v.Z)(xn,"\u0275inj",d.cJS({imports:[Ee.Bz.forRoot(Vt,{useHash:!0}),Ee.Bz]})),xn})(),st=(()=>{class xn{}return(0,v.Z)(xn,"\u0275fac",function(Mt){return new(Mt||xn)}),(0,v.Z)(xn,"\u0275mod",d.oAB({type:xn})),(0,v.Z)(xn,"\u0275inj",d.cJS({imports:[ie.ez,q.u5,y.Pc,Q.aw,s.e]})),xn})();var qt=R(9472);let dn=(()=>{class xn{}return(0,v.Z)(xn,"\u0275fac",function(Mt){return new(Mt||xn)}),(0,v.Z)(xn,"\u0275mod",d.oAB({type:xn})),(0,v.Z)(xn,"\u0275inj",d.cJS({imports:[ie.ez,q.u5,y.Pc,Q.aw,s.e,Ee.Bz.forChild([{path:"",component:Te}])]})),xn})();var Sn=R(4119);let zt=(()=>{class xn{}return(0,v.Z)(xn,"\u0275fac",function(Mt){return new(Mt||xn)}),(0,v.Z)(xn,"\u0275mod",d.oAB({type:xn})),(0,v.Z)(xn,"\u0275inj",d.cJS({imports:[ie.ez,q.u5,y.Pc,Q.aw,s.e,Ee.Bz.forChild([{path:"",component:Sn.N}])]})),xn})();var gi=R(9192),$i=R(5722),Ci=R(7425),Ji=R(2309);function Hi(){return localStorage.getItem("access_token")}function Fi(xn){return new be(xn,"/assets/i18n/",".json")}let mi=(()=>{class xn{}return(0,v.Z)(xn,"\u0275fac",function(Mt){return new(Mt||xn)}),(0,v.Z)(xn,"\u0275mod",d.oAB({type:xn,bootstrap:[an]})),(0,v.Z)(xn,"\u0275inj",d.cJS({providers:[{provide:Ee.wN,useClass:y.r4}],imports:[x.b2,se.JF,Q.aw.forRoot({loader:{provide:Q.Zw,useFactory:Fi,deps:[se.eN]}}),y.Pc.forRoot(),St,_e.Ar.forRoot({config:{tokenGetter:Hi}}),X.SearchPageModule,st,gi.JourneysModule,qt.SignInModule,De,fe,Se,$i.PoiEditorPageModule,dn,zt,Ci.AboutPageModule,Ji.LayerEditorPageModule]})),xn})();yt.N.production&&(0,d.G48)(),x.q6().bootstrapModule(mi).catch(xn=>console.log(xn))},2574:function(zn){zn.exports=function(){"use strict";var Dt,R,x;function d(s,Q){if(Dt)if(R){var ie="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+Dt+")(sharedChunk); ("+R+")(sharedChunk); self.onerror = null;",q={};Dt(q),x=Q(q),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(x.workerUrl=window.URL.createObjectURL(new Blob([ie],{type:"text/javascript"})))}else R=Q;else Dt=Q}return d(0,function(s){var Q=typeof self<"u"?self:{},ie="2.15.0";let q;const y={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(null==q){const t=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{q=null!=process.env.API_URL_REGEX?new RegExp(process.env.API_URL_REGEX):t}catch{q=t}}return q},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!y.API_URL)return null;try{const t=new URL(y.API_URL);return"api.mapbox.cn"===t.hostname?"https://events.mapbox.cn/events/v2":"api.mapbox.com"===t.hostname?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},fe={supported:!1,testSupport:function(t){!X&&De&&(se?Ee(t):Se=t)}};let Se,De,X=!1,se=!1;function Ee(t){const e=t.createTexture();t.bindTexture(t.TEXTURE_2D,e);try{if(t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,De),t.isContextLost())return;fe.supported=!0}catch{}t.deleteTexture(e),X=!0}Q.document&&(De=Q.document.createElement("img"),De.onload=function(){Se&&Ee(Se),Se=null,se=!0},De.onerror=function(){X=!0,Se=null},De.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const _e="01";function be(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Re=Ne;function Ne(t,e,i,a){this.cx=3*t,this.bx=3*(i-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(a-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=e,this.p2x=i,this.p2y=a}Ne.prototype={sampleCurveX:function(t){return((this.ax*t+this.bx)*t+this.cx)*t},sampleCurveY:function(t){return((this.ay*t+this.by)*t+this.cy)*t},sampleCurveDerivativeX:function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},solveCurveX:function(t,e){if(void 0===e&&(e=1e-6),t<0)return 0;if(t>1)return 1;for(var i=t,a=0;a<8;a++){var u=this.sampleCurveX(i)-t;if(Math.abs(u)<e)return i;var f=this.sampleCurveDerivativeX(i);if(Math.abs(f)<1e-6)break;i-=u/f}var _=0,w=1;for(i=t,a=0;a<20&&(u=this.sampleCurveX(i),!(Math.abs(u-t)<e));a++)t>u?_=i:w=i,i=.5*(w-_)+_;return i},solve:function(t,e){return this.sampleCurveY(this.solveCurveX(t,e))}};var qe=be(Re),_t=Je;function Je(t,e){this.x=t,this.y=e}Je.prototype={clone:function(){return new Je(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,e){return this.clone()._rotateAround(t,e)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var e=t.x-this.x,i=t.y-this.y;return e*e+i*i},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,e){return Math.atan2(this.x*e-this.y*t,this.x*t+this.y*e)},_matMult:function(t){var e=t[2]*this.x+t[3]*this.y;return this.x=t[0]*this.x+t[1]*this.y,this.y=e,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var e=Math.cos(t),i=Math.sin(t),a=i*this.x+e*this.y;return this.x=e*this.x-i*this.y,this.y=a,this},_rotateAround:function(t,e){var i=Math.cos(t),a=Math.sin(t),u=e.y+a*(this.x-e.x)+i*(this.y-e.y);return this.x=e.x+i*(this.x-e.x)-a*(this.y-e.y),this.y=u,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},Je.convert=function(t){return t instanceof Je?t:Array.isArray(t)?new Je(t[0],t[1]):t};var Me=be(_t);const it=Math.PI/180,Xe=180/Math.PI;function Te(t){return t*it}function ae(t){return t*Xe}const yt=[[0,0],[1,0],[1,1],[0,1]];function we(t){if(t<=0)return 0;if(t>=1)return 1;const e=t*t,i=e*t;return 4*(t<.5?i:3*(t-e)+i-.75)}function Ze(t,e,i,a){const u=new qe(t,e,i,a);return function(f){return u.solve(f)}}const Ae=Ze(.25,.1,.25,1);function ve(t,e,i){return Math.min(i,Math.max(e,t))}function en(t,e,i){return(i=ve((i-t)/(e-t),0,1))*i*(3-2*i)}function dt(t,e,i){const a=i-e,u=((t-e)%a+a)%a+e;return u===e?i:u}function mt(t,e,i){if(!t.length)return i(null,[]);let a=t.length;const u=new Array(t.length);let f=null;t.forEach((_,w)=>{e(_,(E,D)=>{E&&(f=E),u[w]=D,0==--a&&i(f,u)})})}function lt(t){const e=[];for(const i in t)e.push(t[i]);return e}function ze(t,...e){for(const i of e)for(const a in i)t[a]=i[a];return t}let xt=1;function Ve(){return xt++}function gt(){return function t(e){return e?(e^Math.random()*(16>>e/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,t)}()}function Be(t){return t<=1?1:Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))}function Bt(t){return!!t&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(t)}function Wt(t,e){t.forEach(i=>{e[i]&&(e[i]=e[i].bind(e))})}function wn(t,e){return-1!==t.indexOf(e,t.length-e.length)}function Xt(t,e,i){const a={};for(const u in t)a[u]=e.call(i||this,t[u],u,t);return a}function mn(t,e,i){const a={};for(const u in t)e.call(i||this,t[u],u,t)&&(a[u]=t[u]);return a}function an(t){return Array.isArray(t)?t.map(an):"object"==typeof t&&t?Xt(t,an):t}const Vt={};function St(t){Vt[t]||(typeof console<"u"&&console.warn(t),Vt[t]=!0)}function st(t,e,i){return(i.y-t.y)*(e.x-t.x)>(e.y-t.y)*(i.x-t.x)}function qt(t){let e=0;for(let i,a,u=0,f=t.length,_=f-1;u<f;_=u++)i=t[u],a=t[_],e+=(a.x-i.x)*(i.y+a.y);return e}function dn(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function Sn(t){const e={};if(t.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(i,a,u,f)=>{const _=u||f;return e[a]=!_||_.toLowerCase(),""}),e["max-age"]){const i=parseInt(e["max-age"],10);isNaN(i)?delete e["max-age"]:e["max-age"]=i}return e}let zt=null;function gi(t){if(null==zt){const e=t.navigator?t.navigator.userAgent:null;zt=!!t.safari||!(!e||!(/\b(iPad|iPhone|iPod)\b/.test(e)||e.match("Safari")&&!e.match("Chrome")))}return zt}function $i(t){try{const e=Q[t];return e.setItem("_mapbox_test_",1),e.removeItem("_mapbox_test_"),!0}catch{return!1}}function Ci(t,e){return[t[4*e],t[4*e+1],t[4*e+2],t[4*e+3]]}const Ji="mapbox-tiles";let ii,mi,Hi=500,Fi=50;function xn(){try{return Q.caches}catch{}}function Qt(){xn()&&!ii&&(ii=Q.caches.open(Ji))}function Mt(t){const e=t.indexOf("?");if(e<0)return t;const a=function(u){const f=u.indexOf("?");return f>0?u.slice(f+1).split("&"):[]}(t).filter(u=>{const f=u.split("=");return"language"===f[0]||"worldview"===f[0]});return a.length?`${t.slice(0,e)}?${a.join("&")}`:t.slice(0,e)}let ge=1/0;const ct={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};"function"==typeof Object.freeze&&Object.freeze(ct);class Gt extends Error{constructor(e,i,a){401===i&&Zt(a)&&(e+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(e),this.status=i,this.url=a}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const pn=dn()?()=>self.worker&&self.worker.referrer:()=>("blob:"===Q.location.protocol?Q.parent:Q).location.href,Gi=function(t,e){if(!(/^file:/.test(i=t.url)||/^file:/.test(pn())&&!/^\w+:/.test(i))){if(Q.fetch&&Q.Request&&Q.AbortController&&Q.Request.prototype.hasOwnProperty("signal"))return function(a,u){const f=new Q.AbortController,_=new Q.Request(a.url,{method:a.method||"GET",body:a.body,credentials:a.credentials,headers:a.headers,referrer:pn(),referrerPolicy:a.referrerPolicy,signal:f.signal});let w=!1,E=!1;const D=(k=_.url).indexOf("sku=")>0&&Zt(k);var k;"json"===a.type&&_.headers.set("Accept","application/json");const z=(K,te,he)=>{if(E)return;if(K&&"SecurityError"!==K.message&&St(K.toString()),te&&he)return j(te);const Oe=Date.now();Q.fetch(_).then(ot=>{if(ot.ok){const Ct=D?ot.clone():null;return j(ot,Ct,Oe)}return u(new Gt(ot.statusText,ot.status,a.url))}).catch(ot=>{"AbortError"!==ot.name&&u(new Error(`${ot.message} ${a.url}`))})},j=(K,te,he)=>{("arrayBuffer"===a.type?K.arrayBuffer():"json"===a.type?K.json():K.text()).then(Oe=>{E||(te&&he&&function(ot,Ct,at){if(Qt(),!ii)return;const wt={status:Ct.status,statusText:Ct.statusText,headers:new Q.Headers};Ct.headers.forEach((un,rn)=>wt.headers.set(rn,un));const At=Sn(Ct.headers.get("Cache-Control")||"");if(At["no-store"])return;At["max-age"]&&wt.headers.set("Expires",new Date(at+1e3*At["max-age"]).toUTCString());const It=wt.headers.get("Expires");It&&(new Date(It).getTime()-at<42e4||function(un,rn){if(void 0===mi)try{new Response(new ReadableStream),mi=!0}catch{mi=!1}mi?rn(un.body):un.blob().then(rn)}(Ct,un=>{const rn=new Q.Response(un,wt);Qt(),ii&&ii.then(En=>En.put(Mt(ot.url),rn)).catch(En=>St(En.message))}))}(_,te,he),w=!0,u(null,Oe,K.headers.get("Cache-Control"),K.headers.get("Expires")))}).catch(Oe=>{E||u(new Error(Oe.message))})};return D?function(K,te){if(Qt(),!ii)return te(null);const he=Mt(K.url);ii.then(Oe=>{Oe.match(he).then(ot=>{const Ct=function(at){if(!at)return!1;const wt=new Date(at.headers.get("Expires")||0),At=Sn(at.headers.get("Cache-Control")||"");return wt>Date.now()&&!At["no-cache"]}(ot);Oe.delete(he),Ct&&Oe.put(he,ot.clone()),te(null,ot,Ct)}).catch(te)}).catch(te)}(_,z):z(null,null),{cancel:()=>{E=!0,w||f.abort()}}}(t,e);if(dn()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",t,e,void 0,!0)}var i;return function(a,u){const f=new Q.XMLHttpRequest;f.open(a.method||"GET",a.url,!0),"arrayBuffer"===a.type&&(f.responseType="arraybuffer");for(const _ in a.headers)f.setRequestHeader(_,a.headers[_]);return"json"===a.type&&(f.responseType="text",f.setRequestHeader("Accept","application/json")),f.withCredentials="include"===a.credentials,f.onerror=()=>{u(new Error(f.statusText))},f.onload=()=>{if((f.status>=200&&f.status<300||0===f.status)&&null!==f.response){let _=f.response;if("json"===a.type)try{_=JSON.parse(f.response)}catch(w){return u(w)}u(null,_,f.getResponseHeader("Cache-Control"),f.getResponseHeader("Expires"))}else u(new Gt(f.statusText,f.status,a.url))},f.send(a.body),{cancel:()=>f.abort()}}(t,e)},ri=function(t,e){return Gi(ze(t,{type:"arrayBuffer"}),e)};function Vo(t){const e=Q.document.createElement("a");return e.href=t,e.protocol===Q.document.location.protocol&&e.host===Q.document.location.host}const ut="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let pe,xe;pe=[],xe=0;const Qe=function(t,e){if(fe.supported&&(t.headers||(t.headers={}),t.headers.accept="image/webp,*/*"),xe>=y.MAX_PARALLEL_IMAGE_REQUESTS){const f={requestParameters:t,callback:e,cancelled:!1,cancel(){this.cancelled=!0}};return pe.push(f),f}xe++;let i=!1;const a=()=>{if(!i)for(i=!0,xe--;pe.length&&xe<y.MAX_PARALLEL_IMAGE_REQUESTS;){const f=pe.shift(),{requestParameters:_,callback:w,cancelled:E}=f;E||(f.cancel=Qe(_,w).cancel)}},u=ri(t,(f,_,w,E)=>{a(),f?e(f):_&&(Q.createImageBitmap?function(D,k){const z=new Q.Blob([new Uint8Array(D)],{type:"image/png"});Q.createImageBitmap(z).then(j=>{k(null,j)}).catch(j=>{k(new Error(`Could not load image because of ${j.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(_,(D,k)=>e(D,k,w,E)):function(D,k){const z=new Q.Image,j=Q.URL;z.onload=()=>{k(null,z),j.revokeObjectURL(z.src),z.onload=null,Q.requestAnimationFrame(()=>{z.src=ut})},z.onerror=()=>k(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const K=new Q.Blob([new Uint8Array(D)],{type:"image/png"});z.src=D.byteLength?j.createObjectURL(K):ut}(_,(D,k)=>e(D,k,w,E)))});return{cancel:()=>{u.cancel(),a()}}},vt="NO_ACCESS_TOKEN";function Lt(t){return 0===t.indexOf("mapbox:")}function Zt(t){return y.API_URL_REGEX.test(t)}function jt(t){return y.API_CDN_URL_REGEX.test(t)}function Pt(t){return y.API_STYLE_REGEX.test(t)&&!Kt(t)}function Kt(t){return y.API_SPRITE_REGEX.test(t)}const In=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function et(t){const e=t.match(In);if(!e)throw new Error("Unable to parse URL object");return{protocol:e[1],authority:e[2],path:e[3]||"/",params:e[4]?e[4].split("&"):[]}}function Ue(t){const e=t.params.length?`?${t.params.join("&")}`:"";return`${t.protocol}://${t.authority}${t.path}${e}`}const Y="mapbox.eventData";function me(t){if(!t)return null;const e=t.split(".");if(!e||3!==e.length)return null;try{return JSON.parse(decodeURIComponent(Q.atob(e[1]).split("").map(i=>"%"+("00"+i.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch{return null}}class Ge{constructor(e){this.type=e,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(e){const i=me(y.ACCESS_TOKEN);let a="";return a=i&&i.u?Q.btoa(encodeURIComponent(i.u).replace(/%([0-9A-F]{2})/g,(u,f)=>String.fromCharCode(+("0x"+f)))):y.ACCESS_TOKEN||"",e?`${Y}.${e}:${a}`:`${Y}:${a}`}fetchEventData(){const e=$i("localStorage"),i=this.getStorageKey(),a=this.getStorageKey("uuid");if(e)try{const u=Q.localStorage.getItem(i);u&&(this.eventData=JSON.parse(u));const f=Q.localStorage.getItem(a);f&&(this.anonId=f)}catch{St("Unable to read from LocalStorage")}}saveEventData(){const e=$i("localStorage"),i=this.getStorageKey(),a=this.getStorageKey("uuid");if(e)try{Q.localStorage.setItem(a,this.anonId),Object.keys(this.eventData).length>=1&&Q.localStorage.setItem(i,JSON.stringify(this.eventData))}catch{St("Unable to write to LocalStorage")}}processRequests(e){}postEvent(e,i,a,u){if(!y.EVENTS_URL)return;const f=et(y.EVENTS_URL);f.params.push(`access_token=${u||y.ACCESS_TOKEN||""}`);const _={event:this.type,created:new Date(e).toISOString()},w=i?ze(_,i):_,E={url:Ue(f),headers:{"Content-Type":"text/plain"},body:JSON.stringify([w])};var k;this.pendingRequest=(k=D=>{this.pendingRequest=null,a(D),this.saveEventData(),this.processRequests(u)},Gi(ze(E,{method:"POST"}),k))}queueRequest(e,i){this.queue.push(e),this.processRequests(i)}}const Ft=new class extends Ge{constructor(t){super("appUserTurnstile"),this._customAccessToken=t}postTurnstileEvent(t,e){y.EVENTS_URL&&y.ACCESS_TOKEN&&Array.isArray(t)&&t.some(i=>Lt(i)||Zt(i))&&this.queueRequest(Date.now(),e)}processRequests(t){if(this.pendingRequest||0===this.queue.length)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const e=me(y.ACCESS_TOKEN),i=e?e.u:y.ACCESS_TOKEN;let a=i!==this.eventData.tokenU;Bt(this.anonId)||(this.anonId=gt(),a=!0);const u=this.queue.shift();if(this.eventData.lastSuccess){const f=new Date(this.eventData.lastSuccess),_=new Date(u),w=(u-this.eventData.lastSuccess)/864e5;a=a||w>=1||w<-1||f.getDate()!==_.getDate()}else a=!0;a?this.postEvent(u,{sdkIdentifier:"mapbox-gl-js",sdkVersion:ie,skuId:_e,"enabled.telemetry":!1,userId:this.anonId},f=>{f||(this.eventData.lastSuccess=u,this.eventData.tokenU=i)},t):this.processRequests()}},gn=Ft.postTurnstileEvent.bind(Ft),ei=new class extends Ge{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(t,e,i,a){this.skuToken=e,this.errorCb=a,y.EVENTS_URL&&(i||y.ACCESS_TOKEN?this.queueRequest({id:t,timestamp:Date.now()},i):this.errorCb(new Error(vt)))}processRequests(t){if(this.pendingRequest||0===this.queue.length)return;const{id:e,timestamp:i}=this.queue.shift();e&&this.success[e]||(this.anonId||this.fetchEventData(),Bt(this.anonId)||(this.anonId=gt()),this.postEvent(i,{sdkIdentifier:"mapbox-gl-js",sdkVersion:ie,skuId:_e,skuToken:this.skuToken,userId:this.anonId},a=>{a?this.errorCb(a):e&&(this.success[e]=!0)},t))}},wi=ei.postMapLoadEvent.bind(ei),Ii=new class extends Ge{constructor(){super("gljs.performance")}postPerformanceEvent(t,e){y.EVENTS_URL&&(t||y.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:e},t)}processRequests(t){if(this.pendingRequest||0===this.queue.length)return;const{timestamp:e,performanceData:i}=this.queue.shift(),a=function(u){const f=Q.performance.getEntriesByType("resource"),_=Q.performance.getEntriesByType("mark"),w=function(j){const K={};if(j)for(const te in j)if("other"!==te)for(const he of j[te]){const Oe=`${te}ResolveRangeMin`,ot=`${te}ResolveRangeMax`,Ct=`${te}RequestCount`,at=`${te}RequestCachedCount`;K[Oe]=Math.min(K[Oe]||1/0,he.startTime),K[ot]=Math.max(K[ot]||-1/0,he.responseEnd);const wt=At=>{void 0===K[At]&&(K[At]=0),++K[At]};void 0!==he.transferSize&&0===he.transferSize&&wt(at),wt(Ct)}return K}(function(j,K){const te={};if(j)for(const he of j){const Oe=K(he);void 0===te[Oe]&&(te[Oe]=[]),te[Oe].push(he)}return te}(f,Nn)),E=Q.devicePixelRatio,D=Q.navigator.connection||Q.navigator.mozConnection||Q.navigator.webkitConnection,k={counters:[],metadata:[],attributes:[]},z=(j,K,te)=>{null!=te&&j.push({name:K,value:te.toString()})};for(const j in w)z(k.counters,j,w[j]);if(u.interactionRange[0]!==1/0&&u.interactionRange[1]!==-1/0&&(z(k.counters,"interactionRangeMin",u.interactionRange[0]),z(k.counters,"interactionRangeMax",u.interactionRange[1])),_)for(const j of Object.keys(bt)){const K=bt[j],te=_.find(he=>he.name===K);te&&z(k.counters,K,te.startTime)}return z(k.counters,"visibilityHidden",u.visibilityHidden),z(k.attributes,"style",function(j){if(j)for(const K of j){const te=K.name.split("?")[0];if(Pt(te)){const he=te.split("/").slice(-2);if(2===he.length)return`mapbox://styles/${he[0]}/${he[1]}`}}}(f)),z(k.attributes,"terrainEnabled",u.terrainEnabled?"true":"false"),z(k.attributes,"fogEnabled",u.fogEnabled?"true":"false"),z(k.attributes,"projection",u.projection),z(k.attributes,"zoom",u.zoom),z(k.metadata,"devicePixelRatio",E),z(k.metadata,"connectionEffectiveType",D?D.effectiveType:void 0),z(k.metadata,"navigatorUserAgent",Q.navigator.userAgent),z(k.metadata,"screenWidth",Q.screen.width),z(k.metadata,"screenHeight",Q.screen.height),z(k.metadata,"windowWidth",Q.innerWidth),z(k.metadata,"windowHeight",Q.innerHeight),z(k.metadata,"mapWidth",u.width/E),z(k.metadata,"mapHeight",u.height/E),z(k.metadata,"webglRenderer",u.renderer),z(k.metadata,"webglVendor",u.vendor),z(k.metadata,"sdkVersion",ie),z(k.metadata,"sdkIdentifier","mapbox-gl-js"),k}(i);for(const u of a.metadata);for(const u of a.counters);for(const u of a.attributes);this.postEvent(e,a,()=>{},t)}},Zi=Ii.postPerformanceEvent.bind(Ii),fo=new class extends Ge{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(t,e,i,a){if(!y.API_URL||!y.SESSION_PATH)return;const u=et(y.API_URL+y.SESSION_PATH);u.params.push(`sku=${e||""}`),u.params.push(`access_token=${a||y.ACCESS_TOKEN||""}`);const f={url:Ue(u),headers:{"Content-Type":"text/plain"}};var w;this.pendingRequest=(w=_=>{this.pendingRequest=null,i(_),this.saveEventData(),this.processRequests(a)},Gi(ze(f,{method:"GET"}),w))}getSessionAPI(t,e,i,a){this.skuToken=e,this.errorCb=a,y.SESSION_PATH&&y.API_URL&&(i||y.ACCESS_TOKEN?this.queueRequest({id:t,timestamp:Date.now()},i):this.errorCb(new Error(vt)))}processRequests(t){if(this.pendingRequest||0===this.queue.length)return;const{id:e,timestamp:i}=this.queue.shift();e&&this.success[e]||this.getSession(i,this.skuToken,a=>{a?this.errorCb(a):e&&(this.success[e]=!0)},t)}},to=fo.getSessionAPI.bind(fo),nn=new Set,bt={create:"create",load:"load",fullLoad:"fullLoad"},Et={mark(t){Q.performance.mark(t)},measure(t,e,i){Q.performance.measure(t,e,i)}};function Nn(t){const e=t.name.split("?")[0];return jt(e)&&e.includes("mapbox-gl.js")?"javascript":jt(e)&&e.includes("mapbox-gl.css")?"css":y.API_FONTS_REGEX.test(e)?"fontRange":Kt(e)?"sprite":Pt(e)?"style":y.API_TILEJSON_REGEX.test(e)?"tilejson":"other"}const Pn=Q.performance;function oi(t){const e=t?t.url.toString():void 0;return Pn.getEntriesByName(e)}let ti,qi,xi,go;const So={now:()=>void 0!==xi?xi:Q.performance.now(),setNow(t){xi=t},restoreNow(){xi=void 0},frame(t){const e=Q.requestAnimationFrame(t);return{cancel:()=>Q.cancelAnimationFrame(e)}},getImageData(t,e=0){const{width:i,height:a}=t;go||(go=Q.document.createElement("canvas"));const u=go.getContext("2d",{willReadFrequently:!0});if(!u)throw new Error("failed to create canvas 2d context");return(i>go.width||a>go.height)&&(go.width=i,go.height=a),u.clearRect(-e,-e,i+2*e,a+2*e),u.drawImage(t,0,0,i,a),u.getImageData(-e,-e,i+2*e,a+2*e)},resolveURL:t=>(ti||(ti=Q.document.createElement("a")),ti.href=t,ti.href),get devicePixelRatio(){return Q.devicePixelRatio},get prefersReducedMotion(){return!!Q.matchMedia&&(null==qi&&(qi=Q.matchMedia("(prefers-reduced-motion: reduce)")),qi.matches)}};function Go(t,e,i){i[t]&&-1!==i[t].indexOf(e)||(i[t]=i[t]||[],i[t].push(e))}function uo(t,e,i){if(i&&i[t]){const a=i[t].indexOf(e);-1!==a&&i[t].splice(a,1)}}class oo{constructor(e,i={}){ze(this,i),this.type=e}}class Ai extends oo{constructor(e,i={}){super("error",ze({error:e},i))}}class ho{on(e,i){return this._listeners=this._listeners||{},Go(e,i,this._listeners),this}off(e,i){return uo(e,i,this._listeners),uo(e,i,this._oneTimeListeners),this}once(e,i){return i?(this._oneTimeListeners=this._oneTimeListeners||{},Go(e,i,this._oneTimeListeners),this):new Promise(a=>this.once(e,a))}fire(e,i){"string"==typeof e&&(e=new oo(e,i||{}));const a=e.type;if(this.listens(a)){e.target=this;const u=this._listeners&&this._listeners[a]?this._listeners[a].slice():[];for(const w of u)w.call(this,e);const f=this._oneTimeListeners&&this._oneTimeListeners[a]?this._oneTimeListeners[a].slice():[];for(const w of f)uo(a,w,this._oneTimeListeners),w.call(this,e);const _=this._eventedParent;_&&(ze(e,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),_.fire(e))}else e instanceof Ai&&console.error(e.error);return this}listens(e){return!!(this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e))}setEventedParent(e,i){return this._eventedParent=e,this._eventedParentData=i,this}}var tn=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360,"units":"degrees"},"pitch":{"type":"number","default":0,"units":"degrees"},"light":{"type":"light"},"terrain":{"type":"terrain"},"fog":{"type":"fog"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":{},"mapbox":{}},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":{}}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":{}}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":{}}},"url":{"required":true,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"hillshade":{},"background":{},"sky":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],"layout_background":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","private":true,"default":0,"minimum":0,"maximum":1,"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":{},"round":{},"square":{}},"default":"butt","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":{},"round":{},"miter":{}},"default":"miter","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"requires":[{"line-join":"miter"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"requires":[{"line-join":"round"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":{},"line":{},"line-center":{}},"default":"point","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"units":"pixels","requires":[{"symbol-placement":"line"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":{},"viewport-y":{},"source":{}},"default":"auto","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"units":"factor of the original icon size","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":{},"width":{},"height":{},"both":{}},"default":"none","requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"units":"pixels","requires":["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"requires":["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"units":"ems","requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":{},"left":{},"center":{},"right":{}},"default":"center","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","units":"ems","default":0,"requires":["text-field"],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["text-field",{"!":"text-variable-anchor"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"units":"degrees","requires":["text-field",{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":{},"vertical":{}},"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"requires":["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":{},"uppercase":{},"lowercase":{}},"default":"none","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","units":"ems","length":2,"default":[0,0],"requires":["text-field",{"!":"text-radial-offset"}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"requires":["text-field","icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},"in":{},"!in":{},"all":{},"any":{},"none":{},"has":{},"!has":{},"within":{}}},"geometry_type":{"type":"enum","values":{"Point":{},"LineString":{},"Polygon":{}}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":{},"exponential":{},"interval":{},"categorical":{}},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":{},"lab":{},"hcl":{}},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":{},"viewport":{}},"property-type":"data-constant","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":{},"equalEarth":{},"equirectangular":{},"lambertConformalConic":{},"mercator":{},"naturalEarth":{},"winkelTripel":{},"globe":{}},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["source"]}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"requires":[{"!":"fill-pattern"},{"fill-antialias":true}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-extrusion-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-extrusion-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"requires":["fill-extrusion-height"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","private":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["fill-extrusion-edge-radius"]},"fill-extrusion-rounded-roof":{"type":"boolean","default":true,"requires":["fill-extrusion-edge-radius"],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"line-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["line-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"transition":false,"units":"line widths","requires":[{"!":"line-pattern"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","transition":false,"requires":[{"!":"line-pattern"},{"source":"geojson","has":{"lineMetrics":true}}],"expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"transition":false,"requires":[{"source":"geojson","has":{"lineMetrics":true}}],"property-type":"constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["circle-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"transition":false,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"transition":false,"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["icon-image","icon-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["text-field","text-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"units":"degrees","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":{},"nearest":{}},"default":"linear","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"transition":false,"units":"milliseconds","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"transition":false,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"background-pattern"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":{},"atmosphere":{}},"default":"atmosphere","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"requires":[{"sky-type":"atmosphere"}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","requires":[{"sky-type":"atmosphere"}],"default":10,"minimum":0,"maximum":100,"transition":false,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","requires":[{"sky-type":"gradient"}],"value":"number","default":[0,0],"length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","requires":[{"sky-type":"gradient"}],"default":90,"minimum":0,"maximum":180,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"transition":false,"requires":[{"sky-type":"gradient"}],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"transition":{"duration":{"type":"number","default":300,"minimum":0,"units":"milliseconds"},"delay":{"type":"number","default":0,"minimum":0,"units":"milliseconds"}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function Qo(t,...e){for(const i of e)for(const a in i)t[a]=i[a];return t}function xo(t){return t instanceof Number||t instanceof String||t instanceof Boolean?t.valueOf():t}function Ki(t){if(Array.isArray(t))return t.map(Ki);if(t instanceof Object&&!(t instanceof Number||t instanceof String||t instanceof Boolean)){const e={};for(const i in t)e[i]=Ki(t[i]);return e}return xo(t)}class gr extends Error{constructor(e,i){super(i),this.message=i,this.key=e}}var bo=gr;class Zr{constructor(e,i=[]){this.parent=e,this.bindings={};for(const[a,u]of i)this.bindings[a]=u}concat(e){return new Zr(this,e)}get(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(`${e} not found in scope.`)}has(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)}}var Mr=Zr;const kr={kind:"null"},Qn={kind:"number"},Ui={kind:"string"},ye={kind:"boolean"},rt={kind:"color"},Le={kind:"object"},tt={kind:"value"},Nt={kind:"collator"},Ut={kind:"formatted"},_n={kind:"resolvedImage"};function Cn(t,e){return{kind:"array",itemType:t,N:e}}function vn(t){if("array"===t.kind){const e=vn(t.itemType);return"number"==typeof t.N?`array<${e}, ${t.N}>`:"value"===t.itemType.kind?"array":`array<${e}>`}return t.kind}const On=[kr,Qn,Ui,ye,rt,Ut,Le,Cn(tt),_n];function di(t,e){if("error"===e.kind)return null;if("array"===t.kind){if("array"===e.kind&&(0===e.N&&"value"===e.itemType.kind||!di(t.itemType,e.itemType))&&("number"!=typeof t.N||t.N===e.N))return null}else{if(t.kind===e.kind)return null;if("value"===t.kind)for(const i of On)if(!di(i,e))return null}return`Expected ${vn(t)} but found ${vn(e)} instead.`}function Di(t,e){return e.some(i=>i.kind===t.kind)}function Bi(t,e){return e.some(i=>"null"===i?null===t:"array"===i?Array.isArray(t):"object"===i?t&&!Array.isArray(t)&&"object"==typeof t:i===typeof t)}var Lo,Qi={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function ao(t){return(t=Math.round(t))<0?0:t>255?255:t}function To(t){return ao("%"===t[t.length-1]?parseFloat(t)/100*255:parseInt(t))}function or(t){return(e="%"===t[t.length-1]?parseFloat(t)/100:parseFloat(t))<0?0:e>1?1:e;var e}function Wo(t,e,i){return i<0?i+=1:i>1&&(i-=1),6*i<1?t+(e-t)*i*6:2*i<1?e:3*i<2?t+(e-t)*(2/3-i)*6:t}try{Lo={}.parseCSSColor=function(t){var e,i=t.replace(/ /g,"").toLowerCase();if(i in Qi)return Qi[i].slice();if("#"===i[0])return 4===i.length?(e=parseInt(i.substr(1),16))>=0&&e<=4095?[(3840&e)>>4|(3840&e)>>8,240&e|(240&e)>>4,15&e|(15&e)<<4,1]:null:7===i.length&&(e=parseInt(i.substr(1),16))>=0&&e<=16777215?[(16711680&e)>>16,(65280&e)>>8,255&e,1]:null;var a=i.indexOf("("),u=i.indexOf(")");if(-1!==a&&u+1===i.length){var f=i.substr(0,a),_=i.substr(a+1,u-(a+1)).split(","),w=1;switch(f){case"rgba":if(4!==_.length)return null;w=or(_.pop());case"rgb":return 3!==_.length?null:[To(_[0]),To(_[1]),To(_[2]),w];case"hsla":if(4!==_.length)return null;w=or(_.pop());case"hsl":if(3!==_.length)return null;var E=(parseFloat(_[0])%360+360)%360/360,D=or(_[1]),k=or(_[2]),z=k<=.5?k*(D+1):k+D-k*D,j=2*k-z;return[ao(255*Wo(j,z,E+1/3)),ao(255*Wo(j,z,E)),ao(255*Wo(j,z,E-1/3)),w];default:return null}}return null}}catch{}class dr{constructor(e,i,a,u=1){this.r=e,this.g=i,this.b=a,this.a=u}static parse(e){if(!e)return;if(e instanceof dr)return e;if("string"!=typeof e)return;const i=Lo(e);return i?new dr(i[0]/255*i[3],i[1]/255*i[3],i[2]/255*i[3],i[3]):void 0}toString(){const[e,i,a,u]=this.toArray();return`rgba(${Math.round(e)},${Math.round(i)},${Math.round(a)},${u})`}toArray(){const{r:e,g:i,b:a,a:u}=this;return 0===u?[0,0,0,0]:[255*e/u,255*i/u,255*a/u,u]}toArray01(){const{r:e,g:i,b:a,a:u}=this;return 0===u?[0,0,0,0]:[e/u,i/u,a/u,u]}toArray01PremultipliedAlpha(){const{r:e,g:i,b:a,a:u}=this;return[e,i,a,u]}}dr.black=new dr(0,0,0,1),dr.white=new dr(1,1,1,1),dr.transparent=new dr(0,0,0,0),dr.red=new dr(1,0,0,1),dr.blue=new dr(0,0,1,1);var Co=dr;class xs{constructor(e,i,a){this.sensitivity=e?i?"variant":"case":i?"accent":"base",this.locale=a,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(e,i){return this.collator.compare(e,i)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class ea{constructor(e,i,a,u,f){this.text=e.normalize?e.normalize():e,this.image=i,this.scale=a,this.fontStack=u,this.textColor=f}}class hr{constructor(e){this.sections=e}static fromString(e){return new hr([new ea(e,null,null,null,null)])}isEmpty(){return 0===this.sections.length||!this.sections.some(e=>0!==e.text.length||e.image&&0!==e.image.name.length)}static factory(e){return e instanceof hr?e:hr.fromString(e)}toString(){return 0===this.sections.length?"":this.sections.map(e=>e.text).join("")}serialize(){const e=["format"];for(const i of this.sections){if(i.image){e.push(["image",i.image.name]);continue}e.push(i.text);const a={};i.fontStack&&(a["text-font"]=["literal",i.fontStack.split(",")]),i.scale&&(a["font-scale"]=i.scale),i.textColor&&(a["text-color"]=["rgba"].concat(i.textColor.toArray())),e.push(a)}return e}}class wo{constructor(e){this.name=e.name,this.available=e.available}toString(){return this.name}static fromString(e){return e?new wo({name:e,available:!1}):null}serialize(){return["image",this.name]}}function pi(t,e,i,a){return"number"==typeof t&&t>=0&&t<=255&&"number"==typeof e&&e>=0&&e<=255&&"number"==typeof i&&i>=0&&i<=255?void 0===a||"number"==typeof a&&a>=0&&a<=1?null:`Invalid rgba value [${[t,e,i,a].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${("number"==typeof a?[t,e,i,a]:[t,e,i]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Ri(t){if(null===t||"string"==typeof t||"boolean"==typeof t||"number"==typeof t||t instanceof Co||t instanceof xs||t instanceof hr||t instanceof wo)return!0;if(Array.isArray(t)){for(const e of t)if(!Ri(e))return!1;return!0}if("object"==typeof t){for(const e in t)if(!Ri(t[e]))return!1;return!0}return!1}function Li(t){if(null===t)return kr;if("string"==typeof t)return Ui;if("boolean"==typeof t)return ye;if("number"==typeof t)return Qn;if(t instanceof Co)return rt;if(t instanceof xs)return Nt;if(t instanceof hr)return Ut;if(t instanceof wo)return _n;if(Array.isArray(t)){const e=t.length;let i;for(const a of t){const u=Li(a);if(i){if(i===u)continue;i=tt;break}i=u}return Cn(i||tt,e)}return Le}function er(t){const e=typeof t;return null===t?"":"string"===e||"number"===e||"boolean"===e?String(t):t instanceof Co||t instanceof hr||t instanceof wo?t.toString():JSON.stringify(t)}class is{constructor(e,i){this.type=e,this.value=i}static parse(e,i){if(2!==e.length)return i.error(`'literal' expression requires exactly one argument, but found ${e.length-1} instead.`);if(!Ri(e[1]))return i.error("invalid value");const a=e[1];let u=Li(a);const f=i.expectedType;return"array"!==u.kind||0!==u.N||!f||"array"!==f.kind||"number"==typeof f.N&&0!==f.N||(u=f),new is(u,a)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof Co?["rgba"].concat(this.value.toArray()):this.value instanceof hr?this.value.serialize():this.value}}var jo=is,Jo=class{constructor(t){this.name="ExpressionEvaluationError",this.message=t}toJSON(){return this.message}};const Oo={string:Ui,number:Qn,boolean:ye,object:Le};class Ur{constructor(e,i){this.type=e,this.args=i}static parse(e,i){if(e.length<2)return i.error("Expected at least one argument.");let a,u=1;const f=e[0];if("array"===f){let w,E;if(e.length>2){const D=e[1];if("string"!=typeof D||!(D in Oo)||"object"===D)return i.error('The item type argument of "array" must be one of string, number, boolean',1);w=Oo[D],u++}else w=tt;if(e.length>3){if(null!==e[2]&&("number"!=typeof e[2]||e[2]<0||e[2]!==Math.floor(e[2])))return i.error('The length argument to "array" must be a positive integer literal',2);E=e[2],u++}a=Cn(w,E)}else a=Oo[f];const _=[];for(;u<e.length;u++){const w=i.parse(e[u],u,tt);if(!w)return null;_.push(w)}return new Ur(a,_)}evaluate(e){for(let i=0;i<this.args.length;i++){const a=this.args[i].evaluate(e);if(!di(this.type,Li(a)))return a;if(i===this.args.length-1)throw new Jo(`Expected value to be of type ${vn(this.type)}, but found ${vn(Li(a))} instead.`)}return null}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){const e=this.type,i=[e.kind];if("array"===e.kind){const a=e.itemType;if("string"===a.kind||"number"===a.kind||"boolean"===a.kind){i.push(a.kind);const u=e.N;("number"==typeof u||this.args.length>1)&&i.push(u)}}return i.concat(this.args.map(a=>a.serialize()))}}var xr=Ur;class Si{constructor(e){this.type=Ut,this.sections=e}static parse(e,i){if(e.length<2)return i.error("Expected at least one argument.");const a=e[1];if(!Array.isArray(a)&&"object"==typeof a)return i.error("First argument must be an image or text section.");const u=[];let f=!1;for(let _=1;_<=e.length-1;++_){const w=e[_];if(f&&"object"==typeof w&&!Array.isArray(w)){f=!1;let E=null;if(w["font-scale"]&&(E=i.parse(w["font-scale"],1,Qn),!E))return null;let D=null;if(w["text-font"]&&(D=i.parse(w["text-font"],1,Cn(Ui)),!D))return null;let k=null;if(w["text-color"]&&(k=i.parse(w["text-color"],1,rt),!k))return null;const z=u[u.length-1];z.scale=E,z.font=D,z.textColor=k}else{const E=i.parse(e[_],1,tt);if(!E)return null;const D=E.type.kind;if("string"!==D&&"value"!==D&&"null"!==D&&"resolvedImage"!==D)return i.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");f=!0,u.push({content:E,scale:null,font:null,textColor:null})}}return new Si(u)}evaluate(e){return new hr(this.sections.map(i=>{const a=i.content.evaluate(e);return Li(a)===_n?new ea("",a,null,null,null):new ea(er(a),null,i.scale?i.scale.evaluate(e):null,i.font?i.font.evaluate(e).join(","):null,i.textColor?i.textColor.evaluate(e):null)}))}eachChild(e){for(const i of this.sections)e(i.content),i.scale&&e(i.scale),i.font&&e(i.font),i.textColor&&e(i.textColor)}outputDefined(){return!1}serialize(){const e=["format"];for(const i of this.sections){e.push(i.content.serialize());const a={};i.scale&&(a["font-scale"]=i.scale.serialize()),i.font&&(a["text-font"]=i.font.serialize()),i.textColor&&(a["text-color"]=i.textColor.serialize()),e.push(a)}return e}}class us{constructor(e){this.type=_n,this.input=e}static parse(e,i){if(2!==e.length)return i.error("Expected two arguments.");const a=i.parse(e[1],1,Ui);return a?new us(a):i.error("No image name provided.")}evaluate(e){const i=this.input.evaluate(e),a=wo.fromString(i);return a&&e.availableImages&&(a.available=e.availableImages.indexOf(i)>-1),a}eachChild(e){e(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}const ta={"to-boolean":ye,"to-color":rt,"to-number":Qn,"to-string":Ui};class Xr{constructor(e,i){this.type=e,this.args=i}static parse(e,i){if(e.length<2)return i.error("Expected at least one argument.");const a=e[0];if(("to-boolean"===a||"to-string"===a)&&2!==e.length)return i.error("Expected one argument.");const u=ta[a],f=[];for(let _=1;_<e.length;_++){const w=i.parse(e[_],_,tt);if(!w)return null;f.push(w)}return new Xr(u,f)}evaluate(e){if("boolean"===this.type.kind)return!!this.args[0].evaluate(e);if("color"===this.type.kind){let i,a;for(const u of this.args){if(i=u.evaluate(e),a=null,i instanceof Co)return i;if("string"==typeof i){const f=e.parseColor(i);if(f)return f}else if(Array.isArray(i)&&(a=i.length<3||i.length>4?`Invalid rbga value ${JSON.stringify(i)}: expected an array containing either three or four numeric values.`:pi(i[0],i[1],i[2],i[3]),!a))return new Co(i[0]/255,i[1]/255,i[2]/255,i[3])}throw new Jo(a||`Could not parse color from value '${"string"==typeof i?i:String(JSON.stringify(i))}'`)}if("number"===this.type.kind){let i=null;for(const a of this.args){if(i=a.evaluate(e),null===i)return 0;const u=Number(i);if(!isNaN(u))return u}throw new Jo(`Could not convert ${JSON.stringify(i)} to number.`)}return"formatted"===this.type.kind?hr.fromString(er(this.args[0].evaluate(e))):"resolvedImage"===this.type.kind?wo.fromString(er(this.args[0].evaluate(e))):er(this.args[0].evaluate(e))}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){if("formatted"===this.type.kind)return new Si([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if("resolvedImage"===this.type.kind)return new us(this.args[0]).serialize();const e=[`to-${this.type.kind}`];return this.eachChild(i=>{e.push(i.serialize())}),e}}var ko=Xr;const Ir=["Unknown","Point","LineString","Polygon"];var Fr=class{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null}id(){return this.feature&&void 0!==this.feature.id?this.feature.id:null}geometryType(){return this.feature?"number"==typeof this.feature.type?Ir[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const t=this.featureDistanceData.center,e=this.featureDistanceData.scale,{x:i,y:a}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(i*e-t[0])+this.featureDistanceData.bearing[1]*(a*e-t[1])}return 0}parseColor(t){let e=this._parseColorCache[t];return e||(e=this._parseColorCache[t]=Co.parse(t)),e}};class Br{constructor(e,i,a,u){this.name=e,this.type=i,this._evaluate=a,this.args=u}evaluate(e){return this._evaluate(e,this.args)}eachChild(e){this.args.forEach(e)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(e=>e.serialize()))}static parse(e,i){const a=e[0],u=Br.definitions[a];if(!u)return i.error(`Unknown expression "${a}". If you wanted a literal array, use ["literal", [...]].`,0);const f=Array.isArray(u)?u[0]:u.type,_=Array.isArray(u)?[[u[1],u[2]]]:u.overloads,w=_.filter(([D])=>!Array.isArray(D)||D.length===e.length-1);let E=null;for(const[D,k]of w){E=new re(i.registry,i.path,null,i.scope);const z=[];let j=!1;for(let K=1;K<e.length;K++){const te=e[K],he=Array.isArray(D)?D[K-1]:D.type,Oe=E.parse(te,1+z.length,he);if(!Oe){j=!0;break}z.push(Oe)}if(!j)if(Array.isArray(D)&&D.length!==z.length)E.error(`Expected ${D.length} arguments, but found ${z.length} instead.`);else{for(let K=0;K<z.length;K++){const te=Array.isArray(D)?D[K]:D.type,he=z[K];E.concat(K+1).checkSubtype(te,he.type)}if(0===E.errors.length)return new Br(a,f,k,z)}}if(1===w.length)i.errors.push(...E.errors);else{const D=(w.length?w:_).map(([z])=>{return j=z,Array.isArray(j)?`(${j.map(vn).join(", ")})`:`(${vn(j.type)}...)`;var j}).join(" | "),k=[];for(let z=1;z<e.length;z++){const j=i.parse(e[z],1+k.length);if(!j)return null;k.push(vn(j.type))}i.error(`Expected arguments of type ${D}, but found (${k.join(", ")}) instead.`)}return null}static register(e,i){Br.definitions=i;for(const a in i)e[a]=Br}}var br=Br;class bs{constructor(e,i,a){this.type=Nt,this.locale=a,this.caseSensitive=e,this.diacriticSensitive=i}static parse(e,i){if(2!==e.length)return i.error("Expected one argument.");const a=e[1];if("object"!=typeof a||Array.isArray(a))return i.error("Collator options argument must be an object.");const u=i.parse(void 0!==a["case-sensitive"]&&a["case-sensitive"],1,ye);if(!u)return null;const f=i.parse(void 0!==a["diacritic-sensitive"]&&a["diacritic-sensitive"],1,ye);if(!f)return null;let _=null;return a.locale&&(_=i.parse(a.locale,1,Ui),!_)?null:new bs(u,f,_)}evaluate(e){return new xs(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)}eachChild(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)}outputDefined(){return!1}serialize(){const e={};return e["case-sensitive"]=this.caseSensitive.serialize(),e["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(e.locale=this.locale.serialize()),["collator",e]}}const rr=8192;function Ar(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[2]=Math.max(t[2],e[0]),t[3]=Math.max(t[3],e[1])}function Qr(t,e){return!(t[0]<=e[0]||t[2]>=e[2]||t[1]<=e[1]||t[3]>=e[3])}function ws(t,e){const i=(180+t[0])/360,a=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t[1]*Math.PI/360)))/360,u=Math.pow(2,e.z);return[Math.round(i*u*rr),Math.round(a*u*rr)]}function eo(t,e,i){const a=t[0]-e[0],u=t[1]-e[1],f=t[0]-i[0],_=t[1]-i[1];return a*_-f*u==0&&a*f<=0&&u*_<=0}function ds(t,e){let i=!1;for(let _=0,w=e.length;_<w;_++){const E=e[_];for(let D=0,k=E.length;D<k-1;D++){if(eo(t,E[D],E[D+1]))return!1;(u=E[D])[1]>(a=t)[1]!=(f=E[D+1])[1]>a[1]&&a[0]<(f[0]-u[0])*(a[1]-u[1])/(f[1]-u[1])+u[0]&&(i=!i)}}var a,u,f;return i}function na(t,e){for(let i=0;i<e.length;i++)if(ds(t,e[i]))return!0;return!1}function Ss(t,e,i,a){const u=a[0]-i[0],f=a[1]-i[1],_=(t[0]-i[0])*f-u*(t[1]-i[1]),w=(e[0]-i[0])*f-u*(e[1]-i[1]);return _>0&&w<0||_<0&&w>0}function Sr(t,e,i){for(const D of i)for(let k=0;k<D.length-1;++k)if((w=[(_=D[k+1])[0]-(f=D[k])[0],_[1]-f[1]])[0]*(E=[(u=e)[0]-(a=t)[0],u[1]-a[1]])[1]-w[1]*E[0]!=0&&Ss(a,u,f,_)&&Ss(f,_,a,u))return!0;var a,u,f,_,w,E;return!1}function lo(t,e){for(let i=0;i<t.length;++i)if(!ds(t[i],e))return!1;for(let i=0;i<t.length-1;++i)if(Sr(t[i],t[i+1],e))return!1;return!0}function ia(t,e){for(let i=0;i<e.length;i++)if(lo(t,e[i]))return!0;return!1}function Ps(t,e,i){const a=[];for(let u=0;u<t.length;u++){const f=[];for(let _=0;_<t[u].length;_++){const w=ws(t[u][_],i);Ar(e,w),f.push(w)}a.push(f)}return a}function wr(t,e,i){const a=[];for(let u=0;u<t.length;u++){const f=Ps(t[u],e,i);a.push(f)}return a}function Wa(t,e,i,a){if(t[0]<i[0]||t[0]>i[2]){const u=.5*a;let f=t[0]-i[0]>u?-a:i[0]-t[0]>u?a:0;0===f&&(f=t[0]-i[2]>u?-a:i[2]-t[0]>u?a:0),t[0]+=f}Ar(e,t)}function Pr(t,e,i,a){const u=Math.pow(2,a.z)*rr,f=[a.x*rr,a.y*rr],_=[];if(!t)return _;for(const w of t)for(const E of w){const D=[E.x+f[0],E.y+f[1]];Wa(D,e,i,u),_.push(D)}return _}function Nr(t,e,i,a){const u=Math.pow(2,a.z)*rr,f=[a.x*rr,a.y*rr],_=[];if(!t)return _;for(const E of t){const D=[];for(const k of E){const z=[k.x+f[0],k.y+f[1]];Ar(e,z),D.push(z)}_.push(D)}if(e[2]-e[0]<=u/2){(w=e)[0]=w[1]=1/0,w[2]=w[3]=-1/0;for(const E of _)for(const D of E)Wa(D,e,i,u)}var w;return _}class Gs{constructor(e,i){this.type=ye,this.geojson=e,this.geometries=i}static parse(e,i){if(2!==e.length)return i.error(`'within' expression requires exactly one argument, but found ${e.length-1} instead.`);if(Ri(e[1])){const a=e[1];if("FeatureCollection"===a.type)for(let u=0;u<a.features.length;++u){const f=a.features[u].geometry.type;if("Polygon"===f||"MultiPolygon"===f)return new Gs(a,a.features[u].geometry)}else if("Feature"===a.type){const u=a.geometry.type;if("Polygon"===u||"MultiPolygon"===u)return new Gs(a,a.geometry)}else if("Polygon"===a.type||"MultiPolygon"===a.type)return new Gs(a,a)}return i.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(null!=e.geometry()&&null!=e.canonicalID()){if("Point"===e.geometryType())return function(i,a){const u=[1/0,1/0,-1/0,-1/0],f=[1/0,1/0,-1/0,-1/0],_=i.canonicalID();if(!_)return!1;if("Polygon"===a.type){const w=Ps(a.coordinates,f,_),E=Pr(i.geometry(),u,f,_);if(!Qr(u,f))return!1;for(const D of E)if(!ds(D,w))return!1}if("MultiPolygon"===a.type){const w=wr(a.coordinates,f,_),E=Pr(i.geometry(),u,f,_);if(!Qr(u,f))return!1;for(const D of E)if(!na(D,w))return!1}return!0}(e,this.geometries);if("LineString"===e.geometryType())return function(i,a){const u=[1/0,1/0,-1/0,-1/0],f=[1/0,1/0,-1/0,-1/0],_=i.canonicalID();if(!_)return!1;if("Polygon"===a.type){const w=Ps(a.coordinates,f,_),E=Nr(i.geometry(),u,f,_);if(!Qr(u,f))return!1;for(const D of E)if(!lo(D,w))return!1}if("MultiPolygon"===a.type){const w=wr(a.coordinates,f,_),E=Nr(i.geometry(),u,f,_);if(!Qr(u,f))return!1;for(const D of E)if(!ia(D,w))return!1}return!0}(e,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}var Cs=Gs;function Ts(t){if(t instanceof br&&("get"===t.name&&1===t.args.length||"feature-state"===t.name||"has"===t.name&&1===t.args.length||"properties"===t.name||"geometry-type"===t.name||"id"===t.name||/^filter-/.test(t.name))||t instanceof Cs)return!1;let e=!0;return t.eachChild(i=>{e&&!Ts(i)&&(e=!1)}),e}function pr(t){if(t instanceof br&&"feature-state"===t.name)return!1;let e=!0;return t.eachChild(i=>{e&&!pr(i)&&(e=!1)}),e}function Cr(t,e){if(t instanceof br&&e.indexOf(t.name)>=0)return!1;let i=!0;return t.eachChild(a=>{i&&!Cr(a,e)&&(i=!1)}),i}class Ma{constructor(e,i){this.type=i.type,this.name=e,this.boundExpression=i}static parse(e,i){if(2!==e.length||"string"!=typeof e[1])return i.error("'var' expression requires exactly one string literal argument.");const a=e[1];return i.scope.has(a)?new Ma(a,i.scope.get(a)):i.error(`Unknown variable "${a}". Make sure "${a}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(e){return this.boundExpression.evaluate(e)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}var oa=Ma;class S{constructor(e,i=[],a,u=new Mr,f=[]){this.registry=e,this.path=i,this.key=i.map(_=>`[${_}]`).join(""),this.scope=u,this.errors=f,this.expectedType=a}parse(e,i,a,u,f={}){return i?this.concat(i,a,u)._parse(e,f):this._parse(e,f)}_parse(e,i){function a(u,f,_){return"assert"===_?new xr(f,[u]):"coerce"===_?new ko(f,[u]):u}if(null!==e&&"string"!=typeof e&&"boolean"!=typeof e&&"number"!=typeof e||(e=["literal",e]),Array.isArray(e)){if(0===e.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const u=e[0];if("string"!=typeof u)return this.error(`Expression name must be a string, but found ${typeof u} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const f=this.registry[u];if(f){let _=f.parse(e,this);if(!_)return null;if(this.expectedType){const w=this.expectedType,E=_.type;if("string"!==w.kind&&"number"!==w.kind&&"boolean"!==w.kind&&"object"!==w.kind&&"array"!==w.kind||"value"!==E.kind)if("color"!==w.kind&&"formatted"!==w.kind&&"resolvedImage"!==w.kind||"value"!==E.kind&&"string"!==E.kind){if(this.checkSubtype(w,E))return null}else _=a(_,w,i.typeAnnotation||"coerce");else _=a(_,w,i.typeAnnotation||"assert")}if(!(_ instanceof jo)&&"resolvedImage"!==_.type.kind&&P(_)){const w=new Fr;try{_=new jo(_.type,_.evaluate(w))}catch(E){return this.error(E.message),null}}return _}return this.error(`Unknown expression "${u}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(void 0===e?"'undefined' value invalid. Use null instead.":"object"==typeof e?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof e} instead.`)}concat(e,i,a){const u="number"==typeof e?this.path.concat(e):this.path,f=a?this.scope.concat(a):this.scope;return new S(this.registry,u,i||null,f,this.errors)}error(e,...i){const a=`${this.key}${i.map(u=>`[${u}]`).join("")}`;this.errors.push(new bo(a,e))}checkSubtype(e,i){const a=di(e,i);return a&&this.error(a),a}}var re=S;function P(t){if(t instanceof oa)return P(t.boundExpression);if(t instanceof br&&"error"===t.name||t instanceof bs||t instanceof Cs)return!1;const e=t instanceof ko||t instanceof xr;let i=!0;return t.eachChild(a=>{i=e?i&&P(a):i&&a instanceof jo}),!!i&&Ts(t)&&Cr(t,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center"])}function ne(t,e){const i=t.length-1;let a,u,f=0,_=i,w=0;for(;f<=_;)if(w=Math.floor((f+_)/2),a=t[w],u=t[w+1],a<=e){if(w===i||e<u)return w;f=w+1}else{if(!(a>e))throw new Jo("Input is not a number.");_=w-1}return 0}class He{constructor(e,i,a){this.type=e,this.input=i,this.labels=[],this.outputs=[];for(const[u,f]of a)this.labels.push(u),this.outputs.push(f)}static parse(e,i){if(e.length-1<4)return i.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return i.error("Expected an even number of arguments.");const a=i.parse(e[1],1,Qn);if(!a)return null;const u=[];let f=null;i.expectedType&&"value"!==i.expectedType.kind&&(f=i.expectedType);for(let _=1;_<e.length;_+=2){const w=1===_?-1/0:e[_],E=e[_+1],D=_,k=_+1;if("number"!=typeof w)return i.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',D);if(u.length&&u[u.length-1][0]>=w)return i.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',D);const z=i.parse(E,k,f);if(!z)return null;f=f||z.type,u.push([w,z])}return new He(f,a,u)}evaluate(e){const i=this.labels,a=this.outputs;if(1===i.length)return a[0].evaluate(e);const u=this.input.evaluate(e);if(u<=i[0])return a[0].evaluate(e);const f=i.length;return u>=i[f-1]?a[f-1].evaluate(e):a[ne(i,u)].evaluate(e)}eachChild(e){e(this.input);for(const i of this.outputs)e(i)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}serialize(){const e=["step",this.input.serialize()];for(let i=0;i<this.labels.length;i++)i>0&&e.push(this.labels[i]),e.push(this.outputs[i].serialize());return e}}var Ln=He;function Kn(t,e,i){return t*(1-i)+e*i}var zi=Object.freeze({__proto__:null,array:function(t,e,i){return t.map((a,u)=>Kn(a,e[u],i))},color:function(t,e,i){return new Co(Kn(t.r,e.r,i),Kn(t.g,e.g,i),Kn(t.b,e.b,i),Kn(t.a,e.a,i))},number:Kn});const J=1.08883,G=4/29,ke=6/29,bn=3*ke*ke,hi=ke*ke*ke,sr=Math.PI/180,hs=180/Math.PI;function Ws(t){return t>hi?Math.pow(t,1/3):t/bn+G}function qa(t){return t>ke?t*t*t:bn*(t-G)}function kc(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function Fc(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function ua(t){const e=Fc(t.r),i=Fc(t.g),a=Fc(t.b),u=Ws((.4124564*e+.3575761*i+.1804375*a)/.95047),f=Ws((.2126729*e+.7151522*i+.072175*a)/1);return{l:116*f-16,a:500*(u-f),b:200*(f-Ws((.0193339*e+.119192*i+.9503041*a)/J)),alpha:t.a}}function Ll(t){let e=(t.l+16)/116,i=isNaN(t.a)?e:e+t.a/500,a=isNaN(t.b)?e:e-t.b/200;return e=1*qa(e),i=.95047*qa(i),a=J*qa(a),new Co(kc(3.2404542*i-1.5371385*e-.4985314*a),kc(-.969266*i+1.8760108*e+.041556*a),kc(.0556434*i-.2040259*e+1.0572252*a),t.alpha)}function rc(t,e,i){const a=e-t;return t+i*(a>180||a<-180?a-360*Math.round(a/360):a)}const Os={forward:ua,reverse:Ll,interpolate:function(t,e,i){return{l:Kn(t.l,e.l,i),a:Kn(t.a,e.a,i),b:Kn(t.b,e.b,i),alpha:Kn(t.alpha,e.alpha,i)}}},da={forward:function(t){const{l:e,a:i,b:a}=ua(t),u=Math.atan2(a,i)*hs;return{h:u<0?u+360:u,c:Math.sqrt(i*i+a*a),l:e,alpha:t.a}},reverse:function(t){const e=t.h*sr,i=t.c;return Ll({l:t.l,a:Math.cos(e)*i,b:Math.sin(e)*i,alpha:t.alpha})},interpolate:function(t,e,i){return{h:rc(t.h,e.h,i),c:Kn(t.c,e.c,i),l:Kn(t.l,e.l,i),alpha:Kn(t.alpha,e.alpha,i)}}};var kl=Object.freeze({__proto__:null,hcl:da,lab:Os});class Ya{constructor(e,i,a,u,f){this.type=e,this.operator=i,this.interpolation=a,this.input=u,this.labels=[],this.outputs=[];for(const[_,w]of f)this.labels.push(_),this.outputs.push(w)}static interpolationFactor(e,i,a,u){let f=0;if("exponential"===e.name)f=Ja(i,e.base,a,u);else if("linear"===e.name)f=Ja(i,1,a,u);else if("cubic-bezier"===e.name){const _=e.controlPoints;f=new qe(_[0],_[1],_[2],_[3]).solve(Ja(i,1,a,u))}return f}static parse(e,i){let[a,u,f,..._]=e;if(!Array.isArray(u)||0===u.length)return i.error("Expected an interpolation type expression.",1);if("linear"===u[0])u={name:"linear"};else if("exponential"===u[0]){const D=u[1];if("number"!=typeof D)return i.error("Exponential interpolation requires a numeric base.",1,1);u={name:"exponential",base:D}}else{if("cubic-bezier"!==u[0])return i.error(`Unknown interpolation type ${String(u[0])}`,1,0);{const D=u.slice(1);if(4!==D.length||D.some(k=>"number"!=typeof k||k<0||k>1))return i.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);u={name:"cubic-bezier",controlPoints:D}}}if(e.length-1<4)return i.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return i.error("Expected an even number of arguments.");if(f=i.parse(f,2,Qn),!f)return null;const w=[];let E=null;"interpolate-hcl"===a||"interpolate-lab"===a?E=rt:i.expectedType&&"value"!==i.expectedType.kind&&(E=i.expectedType);for(let D=0;D<_.length;D+=2){const k=_[D],z=_[D+1],j=D+3,K=D+4;if("number"!=typeof k)return i.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',j);if(w.length&&w[w.length-1][0]>=k)return i.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',j);const te=i.parse(z,K,E);if(!te)return null;E=E||te.type,w.push([k,te])}return"number"===E.kind||"color"===E.kind||"array"===E.kind&&"number"===E.itemType.kind&&"number"==typeof E.N?new Ya(E,a,u,f,w):i.error(`Type ${vn(E)} is not interpolatable.`)}evaluate(e){const i=this.labels,a=this.outputs;if(1===i.length)return a[0].evaluate(e);const u=this.input.evaluate(e);if(u<=i[0])return a[0].evaluate(e);const f=i.length;if(u>=i[f-1])return a[f-1].evaluate(e);const _=ne(i,u),w=Ya.interpolationFactor(this.interpolation,u,i[_],i[_+1]),E=a[_].evaluate(e),D=a[_+1].evaluate(e);return"interpolate"===this.operator?zi[this.type.kind.toLowerCase()](E,D,w):"interpolate-hcl"===this.operator?da.reverse(da.interpolate(da.forward(E),da.forward(D),w)):Os.reverse(Os.interpolate(Os.forward(E),Os.forward(D),w))}eachChild(e){e(this.input);for(const i of this.outputs)e(i)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}serialize(){let e;e="linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const i=[this.operator,e,this.input.serialize()];for(let a=0;a<this.labels.length;a++)i.push(this.labels[a],this.outputs[a].serialize());return i}}function Ja(t,e,i,a){const u=a-i,f=t-i;return 0===u?0:1===e?f/u:(Math.pow(e,f)-1)/(Math.pow(e,u)-1)}var ps=Ya;class Fl{constructor(e,i){this.type=e,this.args=i}static parse(e,i){if(e.length<2)return i.error("Expectected at least one argument.");let a=null;const u=i.expectedType;u&&"value"!==u.kind&&(a=u);const f=[];for(const w of e.slice(1)){const E=i.parse(w,1+f.length,a,void 0,{typeAnnotation:"omit"});if(!E)return null;a=a||E.type,f.push(E)}const _=u&&f.some(w=>di(u,w.type));return new Fl(_?tt:a,f)}evaluate(e){let i,a=null,u=0;for(const f of this.args){if(u++,a=f.evaluate(e),a&&a instanceof wo&&!a.available&&(i||(i=a),a=null,u===this.args.length))return i;if(null!==a)break}return a}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){const e=["coalesce"];return this.eachChild(i=>{e.push(i.serialize())}),e}}var Rs=Fl;class ha{constructor(e,i){this.type=i.type,this.bindings=[].concat(e),this.result=i}evaluate(e){return this.result.evaluate(e)}eachChild(e){for(const i of this.bindings)e(i[1]);e(this.result)}static parse(e,i){if(e.length<4)return i.error(`Expected at least 3 arguments, but found ${e.length-1} instead.`);const a=[];for(let f=1;f<e.length-1;f+=2){const _=e[f];if("string"!=typeof _)return i.error(`Expected string, but found ${typeof _} instead.`,f);if(/[^a-zA-Z0-9_]/.test(_))return i.error("Variable names must contain only alphanumeric characters or '_'.",f);const w=i.parse(e[f+1],f+1);if(!w)return null;a.push([_,w])}const u=i.parse(e[e.length-1],e.length-1,i.expectedType,a);return u?new ha(a,u):null}outputDefined(){return this.result.outputDefined()}serialize(){const e=["let"];for(const[i,a]of this.bindings)e.push(i,a.serialize());return e.push(this.result.serialize()),e}}var Or=ha;class pl{constructor(e,i,a){this.type=e,this.index=i,this.input=a}static parse(e,i){if(3!==e.length)return i.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const a=i.parse(e[1],1,Qn),u=i.parse(e[2],2,Cn(i.expectedType||tt));return a&&u?new pl(u.type.itemType,a,u):null}evaluate(e){const i=this.index.evaluate(e),a=this.input.evaluate(e);if(i<0)throw new Jo(`Array index out of bounds: ${i} < 0.`);if(i>=a.length)throw new Jo(`Array index out of bounds: ${i} > ${a.length-1}.`);if(i!==Math.floor(i))throw new Jo(`Array index must be an integer, but found ${i} instead.`);return a[i]}eachChild(e){e(this.index),e(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}var fd=pl;class pa{constructor(e,i){this.type=ye,this.needle=e,this.haystack=i}static parse(e,i){if(3!==e.length)return i.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const a=i.parse(e[1],1,tt),u=i.parse(e[2],2,tt);return a&&u?Di(a.type,[ye,Ui,Qn,kr,tt])?new pa(a,u):i.error(`Expected first argument to be of type boolean, string, number or null, but found ${vn(a.type)} instead`):null}evaluate(e){const i=this.needle.evaluate(e),a=this.haystack.evaluate(e);if(null==a)return!1;if(!Bi(i,["boolean","string","number","null"]))throw new Jo(`Expected first argument to be of type boolean, string, number or null, but found ${vn(Li(i))} instead.`);if(!Bi(a,["string","array"]))throw new Jo(`Expected second argument to be of type array or string, but found ${vn(Li(a))} instead.`);return a.indexOf(i)>=0}eachChild(e){e(this.needle),e(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}var fa=pa;class Es{constructor(e,i,a){this.type=Qn,this.needle=e,this.haystack=i,this.fromIndex=a}static parse(e,i){if(e.length<=2||e.length>=5)return i.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const a=i.parse(e[1],1,tt),u=i.parse(e[2],2,tt);if(!a||!u)return null;if(!Di(a.type,[ye,Ui,Qn,kr,tt]))return i.error(`Expected first argument to be of type boolean, string, number or null, but found ${vn(a.type)} instead`);if(4===e.length){const f=i.parse(e[3],3,Qn);return f?new Es(a,u,f):null}return new Es(a,u)}evaluate(e){const i=this.needle.evaluate(e),a=this.haystack.evaluate(e);if(!Bi(i,["boolean","string","number","null"]))throw new Jo(`Expected first argument to be of type boolean, string, number or null, but found ${vn(Li(i))} instead.`);if(!Bi(a,["string","array"]))throw new Jo(`Expected second argument to be of type array or string, but found ${vn(Li(a))} instead.`);if(this.fromIndex){const u=this.fromIndex.evaluate(e);return a.indexOf(i,u)}return a.indexOf(i)}eachChild(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)}outputDefined(){return!1}serialize(){if(null!=this.fromIndex&&void 0!==this.fromIndex){const e=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),e]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}var sc=Es;class Bc{constructor(e,i,a,u,f,_){this.inputType=e,this.type=i,this.input=a,this.cases=u,this.outputs=f,this.otherwise=_}static parse(e,i){if(e.length<5)return i.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if(e.length%2!=1)return i.error("Expected an even number of arguments.");let a,u;i.expectedType&&"value"!==i.expectedType.kind&&(u=i.expectedType);const f={},_=[];for(let D=2;D<e.length-1;D+=2){let k=e[D];const z=e[D+1];Array.isArray(k)||(k=[k]);const j=i.concat(D);if(0===k.length)return j.error("Expected at least one branch label.");for(const te of k){if("number"!=typeof te&&"string"!=typeof te)return j.error("Branch labels must be numbers or strings.");if("number"==typeof te&&Math.abs(te)>Number.MAX_SAFE_INTEGER)return j.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if("number"==typeof te&&Math.floor(te)!==te)return j.error("Numeric branch labels must be integer values.");if(a){if(j.checkSubtype(a,Li(te)))return null}else a=Li(te);if(void 0!==f[String(te)])return j.error("Branch labels must be unique.");f[String(te)]=_.length}const K=i.parse(z,D,u);if(!K)return null;u=u||K.type,_.push(K)}const w=i.parse(e[1],1,tt);if(!w)return null;const E=i.parse(e[e.length-1],e.length-1,u);return E?"value"!==w.type.kind&&i.concat(1).checkSubtype(a,w.type)?null:new Bc(a,u,w,f,_,E):null}evaluate(e){const i=this.input.evaluate(e);return(Li(i)===this.inputType&&this.outputs[this.cases[i]]||this.otherwise).evaluate(e)}eachChild(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)}outputDefined(){return this.outputs.every(e=>e.outputDefined())&&this.otherwise.outputDefined()}serialize(){const e=["match",this.input.serialize()],i=Object.keys(this.cases).sort(),a=[],u={};for(const _ of i){const w=u[this.cases[_]];void 0===w?(u[this.cases[_]]=a.length,a.push([this.cases[_],[_]])):a[w][1].push(_)}const f=_=>"number"===this.inputType.kind?Number(_):_;for(const[_,w]of a)e.push(1===w.length?f(w[0]):w.map(f)),e.push(this.outputs[_].serialize());return e.push(this.otherwise.serialize()),e}}var Nc=Bc;class fl{constructor(e,i,a){this.type=e,this.branches=i,this.otherwise=a}static parse(e,i){if(e.length<4)return i.error(`Expected at least 3 arguments, but found only ${e.length-1}.`);if(e.length%2!=0)return i.error("Expected an odd number of arguments.");let a;i.expectedType&&"value"!==i.expectedType.kind&&(a=i.expectedType);const u=[];for(let _=1;_<e.length-1;_+=2){const w=i.parse(e[_],_,ye);if(!w)return null;const E=i.parse(e[_+1],_+1,a);if(!E)return null;u.push([w,E]),a=a||E.type}const f=i.parse(e[e.length-1],e.length-1,a);return f?new fl(a,u,f):null}evaluate(e){for(const[i,a]of this.branches)if(i.evaluate(e))return a.evaluate(e);return this.otherwise.evaluate(e)}eachChild(e){for(const[i,a]of this.branches)e(i),e(a);e(this.otherwise)}outputDefined(){return this.branches.every(([e,i])=>i.outputDefined())&&this.otherwise.outputDefined()}serialize(){const e=["case"];return this.eachChild(i=>{e.push(i.serialize())}),e}}var Bl=fl;class Ia{constructor(e,i,a,u){this.type=e,this.input=i,this.beginIndex=a,this.endIndex=u}static parse(e,i){if(e.length<=2||e.length>=5)return i.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const a=i.parse(e[1],1,tt),u=i.parse(e[2],2,Qn);if(!a||!u)return null;if(!Di(a.type,[Cn(tt),Ui,tt]))return i.error(`Expected first argument to be of type array or string, but found ${vn(a.type)} instead`);if(4===e.length){const f=i.parse(e[3],3,Qn);return f?new Ia(a.type,a,u,f):null}return new Ia(a.type,a,u)}evaluate(e){const i=this.input.evaluate(e),a=this.beginIndex.evaluate(e);if(!Bi(i,["string","array"]))throw new Jo(`Expected first argument to be of type array or string, but found ${vn(Li(i))} instead.`);if(this.endIndex){const u=this.endIndex.evaluate(e);return i.slice(a,u)}return i.slice(a)}eachChild(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)}outputDefined(){return!1}serialize(){if(null!=this.endIndex&&void 0!==this.endIndex){const e=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),e]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}var Nl=Ia;function ml(t,e){return"=="===t||"!="===t?"boolean"===e.kind||"string"===e.kind||"number"===e.kind||"null"===e.kind||"value"===e.kind:"string"===e.kind||"number"===e.kind||"value"===e.kind}function fu(t,e,i,a){return 0===a.compare(e,i)}function Ba(t,e,i){const a="=="!==t&&"!="!==t;return class O1{constructor(f,_,w){this.type=ye,this.lhs=f,this.rhs=_,this.collator=w,this.hasUntypedArgument="value"===f.type.kind||"value"===_.type.kind}static parse(f,_){if(3!==f.length&&4!==f.length)return _.error("Expected two or three arguments.");const w=f[0];let E=_.parse(f[1],1,tt);if(!E)return null;if(!ml(w,E.type))return _.concat(1).error(`"${w}" comparisons are not supported for type '${vn(E.type)}'.`);let D=_.parse(f[2],2,tt);if(!D)return null;if(!ml(w,D.type))return _.concat(2).error(`"${w}" comparisons are not supported for type '${vn(D.type)}'.`);if(E.type.kind!==D.type.kind&&"value"!==E.type.kind&&"value"!==D.type.kind)return _.error(`Cannot compare types '${vn(E.type)}' and '${vn(D.type)}'.`);a&&("value"===E.type.kind&&"value"!==D.type.kind?E=new xr(D.type,[E]):"value"!==E.type.kind&&"value"===D.type.kind&&(D=new xr(E.type,[D])));let k=null;if(4===f.length){if("string"!==E.type.kind&&"string"!==D.type.kind&&"value"!==E.type.kind&&"value"!==D.type.kind)return _.error("Cannot use collator to compare non-string types.");if(k=_.parse(f[3],3,Nt),!k)return null}return new O1(E,D,k)}evaluate(f){const _=this.lhs.evaluate(f),w=this.rhs.evaluate(f);if(a&&this.hasUntypedArgument){const E=Li(_),D=Li(w);if(E.kind!==D.kind||"string"!==E.kind&&"number"!==E.kind)throw new Jo(`Expected arguments for "${t}" to be (string, string) or (number, number), but found (${E.kind}, ${D.kind}) instead.`)}if(this.collator&&!a&&this.hasUntypedArgument){const E=Li(_),D=Li(w);if("string"!==E.kind||"string"!==D.kind)return e(f,_,w)}return this.collator?i(f,_,w,this.collator.evaluate(f)):e(f,_,w)}eachChild(f){f(this.lhs),f(this.rhs),this.collator&&f(this.collator)}outputDefined(){return!0}serialize(){const f=[t];return this.eachChild(_=>{f.push(_.serialize())}),f}}}const ac=Ba("==",function(t,e,i){return e===i},fu),mu=Ba("!=",function(t,e,i){return e!==i},function(t,e,i,a){return!fu(0,e,i,a)}),zl=Ba("<",function(t,e,i){return e<i},function(t,e,i,a){return a.compare(e,i)<0}),lc=Ba(">",function(t,e,i){return e>i},function(t,e,i,a){return a.compare(e,i)>0}),zc=Ba("<=",function(t,e,i){return e<=i},function(t,e,i,a){return a.compare(e,i)<=0}),Uc=Ba(">=",function(t,e,i){return e>=i},function(t,e,i,a){return a.compare(e,i)>=0});class Ul{constructor(e,i,a,u,f,_){this.type=Ui,this.number=e,this.locale=i,this.currency=a,this.unit=u,this.minFractionDigits=f,this.maxFractionDigits=_}static parse(e,i){if(3!==e.length)return i.error("Expected two arguments.");const a=i.parse(e[1],1,Qn);if(!a)return null;const u=e[2];if("object"!=typeof u||Array.isArray(u))return i.error("NumberFormat options argument must be an object.");let f=null;if(u.locale&&(f=i.parse(u.locale,1,Ui),!f))return null;let _=null;if(u.currency&&(_=i.parse(u.currency,1,Ui),!_))return null;let w=null;if(u.unit&&(w=i.parse(u.unit,1,Ui),!w))return null;let E=null;if(u["min-fraction-digits"]&&(E=i.parse(u["min-fraction-digits"],1,Qn),!E))return null;let D=null;return u["max-fraction-digits"]&&(D=i.parse(u["max-fraction-digits"],1,Qn),!D)?null:new Ul(a,f,_,w,E,D)}evaluate(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(e):void 0,unit:this.unit?this.unit.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))}eachChild(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.unit&&e(this.unit),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const e={};return this.locale&&(e.locale=this.locale.serialize()),this.currency&&(e.currency=this.currency.serialize()),this.unit&&(e.unit=this.unit.serialize()),this.minFractionDigits&&(e["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(e["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),e]}}class Na{constructor(e){this.type=Qn,this.input=e}static parse(e,i){if(2!==e.length)return i.error(`Expected 1 argument, but found ${e.length-1} instead.`);const a=i.parse(e[1],1);return a?"array"!==a.type.kind&&"string"!==a.type.kind&&"value"!==a.type.kind?i.error(`Expected argument of type string or array, but found ${vn(a.type)} instead.`):new Na(a):null}evaluate(e){const i=this.input.evaluate(e);if("string"==typeof i||Array.isArray(i))return i.length;throw new Jo(`Expected value to be of type string or array, but found ${vn(Li(i))} instead.`)}eachChild(e){e(this.input)}outputDefined(){return!1}serialize(){const e=["length"];return this.eachChild(i=>{e.push(i.serialize())}),e}}const cc={"==":ac,"!=":mu,">":lc,"<":zl,">=":Uc,"<=":zc,array:xr,at:fd,boolean:xr,case:Bl,coalesce:Rs,collator:bs,format:Si,image:us,in:fa,"index-of":sc,interpolate:ps,"interpolate-hcl":ps,"interpolate-lab":ps,length:Na,let:Or,literal:jo,match:Nc,number:xr,"number-format":Ul,object:xr,slice:Nl,step:Ln,string:xr,"to-boolean":ko,"to-color":ko,"to-number":ko,"to-string":ko,var:oa,within:Cs};function uc(t,[e,i,a,u]){e=e.evaluate(t),i=i.evaluate(t),a=a.evaluate(t);const f=u?u.evaluate(t):1,_=pi(e,i,a,f);if(_)throw new Jo(_);return new Co(e/255*f,i/255*f,a/255*f,f)}function ra(t,e){return t in e}function ma(t,e){const i=e[t];return void 0===i?null:i}function Z(t){return{type:t}}br.register(cc,{error:[{kind:"error"},[Ui],(t,[e])=>{throw new Jo(e.evaluate(t))}],typeof:[Ui,[tt],(t,[e])=>vn(Li(e.evaluate(t)))],"to-rgba":[Cn(Qn,4),[rt],(t,[e])=>e.evaluate(t).toArray()],rgb:[rt,[Qn,Qn,Qn],uc],rgba:[rt,[Qn,Qn,Qn,Qn],uc],has:{type:ye,overloads:[[[Ui],(t,[e])=>ra(e.evaluate(t),t.properties())],[[Ui,Le],(t,[e,i])=>ra(e.evaluate(t),i.evaluate(t))]]},get:{type:tt,overloads:[[[Ui],(t,[e])=>ma(e.evaluate(t),t.properties())],[[Ui,Le],(t,[e,i])=>ma(e.evaluate(t),i.evaluate(t))]]},"feature-state":[tt,[Ui],(t,[e])=>ma(e.evaluate(t),t.featureState||{})],properties:[Le,[],t=>t.properties()],"geometry-type":[Ui,[],t=>t.geometryType()],id:[tt,[],t=>t.id()],zoom:[Qn,[],t=>t.globals.zoom],pitch:[Qn,[],t=>t.globals.pitch||0],"distance-from-center":[Qn,[],t=>t.distanceFromCenter()],"heatmap-density":[Qn,[],t=>t.globals.heatmapDensity||0],"line-progress":[Qn,[],t=>t.globals.lineProgress||0],"sky-radial-progress":[Qn,[],t=>t.globals.skyRadialProgress||0],accumulated:[tt,[],t=>void 0===t.globals.accumulated?null:t.globals.accumulated],"+":[Qn,Z(Qn),(t,e)=>{let i=0;for(const a of e)i+=a.evaluate(t);return i}],"*":[Qn,Z(Qn),(t,e)=>{let i=1;for(const a of e)i*=a.evaluate(t);return i}],"-":{type:Qn,overloads:[[[Qn,Qn],(t,[e,i])=>e.evaluate(t)-i.evaluate(t)],[[Qn],(t,[e])=>-e.evaluate(t)]]},"/":[Qn,[Qn,Qn],(t,[e,i])=>e.evaluate(t)/i.evaluate(t)],"%":[Qn,[Qn,Qn],(t,[e,i])=>e.evaluate(t)%i.evaluate(t)],ln2:[Qn,[],()=>Math.LN2],pi:[Qn,[],()=>Math.PI],e:[Qn,[],()=>Math.E],"^":[Qn,[Qn,Qn],(t,[e,i])=>Math.pow(e.evaluate(t),i.evaluate(t))],sqrt:[Qn,[Qn],(t,[e])=>Math.sqrt(e.evaluate(t))],log10:[Qn,[Qn],(t,[e])=>Math.log(e.evaluate(t))/Math.LN10],ln:[Qn,[Qn],(t,[e])=>Math.log(e.evaluate(t))],log2:[Qn,[Qn],(t,[e])=>Math.log(e.evaluate(t))/Math.LN2],sin:[Qn,[Qn],(t,[e])=>Math.sin(e.evaluate(t))],cos:[Qn,[Qn],(t,[e])=>Math.cos(e.evaluate(t))],tan:[Qn,[Qn],(t,[e])=>Math.tan(e.evaluate(t))],asin:[Qn,[Qn],(t,[e])=>Math.asin(e.evaluate(t))],acos:[Qn,[Qn],(t,[e])=>Math.acos(e.evaluate(t))],atan:[Qn,[Qn],(t,[e])=>Math.atan(e.evaluate(t))],min:[Qn,Z(Qn),(t,e)=>Math.min(...e.map(i=>i.evaluate(t)))],max:[Qn,Z(Qn),(t,e)=>Math.max(...e.map(i=>i.evaluate(t)))],abs:[Qn,[Qn],(t,[e])=>Math.abs(e.evaluate(t))],round:[Qn,[Qn],(t,[e])=>{const i=e.evaluate(t);return i<0?-Math.round(-i):Math.round(i)}],floor:[Qn,[Qn],(t,[e])=>Math.floor(e.evaluate(t))],ceil:[Qn,[Qn],(t,[e])=>Math.ceil(e.evaluate(t))],"filter-==":[ye,[Ui,tt],(t,[e,i])=>t.properties()[e.value]===i.value],"filter-id-==":[ye,[tt],(t,[e])=>t.id()===e.value],"filter-type-==":[ye,[Ui],(t,[e])=>t.geometryType()===e.value],"filter-<":[ye,[Ui,tt],(t,[e,i])=>{const a=t.properties()[e.value],u=i.value;return typeof a==typeof u&&a<u}],"filter-id-<":[ye,[tt],(t,[e])=>{const i=t.id(),a=e.value;return typeof i==typeof a&&i<a}],"filter->":[ye,[Ui,tt],(t,[e,i])=>{const a=t.properties()[e.value],u=i.value;return typeof a==typeof u&&a>u}],"filter-id->":[ye,[tt],(t,[e])=>{const i=t.id(),a=e.value;return typeof i==typeof a&&i>a}],"filter-<=":[ye,[Ui,tt],(t,[e,i])=>{const a=t.properties()[e.value],u=i.value;return typeof a==typeof u&&a<=u}],"filter-id-<=":[ye,[tt],(t,[e])=>{const i=t.id(),a=e.value;return typeof i==typeof a&&i<=a}],"filter->=":[ye,[Ui,tt],(t,[e,i])=>{const a=t.properties()[e.value],u=i.value;return typeof a==typeof u&&a>=u}],"filter-id->=":[ye,[tt],(t,[e])=>{const i=t.id(),a=e.value;return typeof i==typeof a&&i>=a}],"filter-has":[ye,[tt],(t,[e])=>e.value in t.properties()],"filter-has-id":[ye,[],t=>null!==t.id()&&void 0!==t.id()],"filter-type-in":[ye,[Cn(Ui)],(t,[e])=>e.value.indexOf(t.geometryType())>=0],"filter-id-in":[ye,[Cn(tt)],(t,[e])=>e.value.indexOf(t.id())>=0],"filter-in-small":[ye,[Ui,Cn(tt)],(t,[e,i])=>i.value.indexOf(t.properties()[e.value])>=0],"filter-in-large":[ye,[Ui,Cn(tt)],(t,[e,i])=>function(a,u,f,_){for(;f<=_;){const w=f+_>>1;if(u[w]===a)return!0;u[w]>a?_=w-1:f=w+1}return!1}(t.properties()[e.value],i.value,0,i.value.length-1)],all:{type:ye,overloads:[[[ye,ye],(t,[e,i])=>e.evaluate(t)&&i.evaluate(t)],[Z(ye),(t,e)=>{for(const i of e)if(!i.evaluate(t))return!1;return!0}]]},any:{type:ye,overloads:[[[ye,ye],(t,[e,i])=>e.evaluate(t)||i.evaluate(t)],[Z(ye),(t,e)=>{for(const i of e)if(i.evaluate(t))return!0;return!1}]]},"!":[ye,[ye],(t,[e])=>!e.evaluate(t)],"is-supported-script":[ye,[Ui],(t,[e])=>{const i=t.globals&&t.globals.isSupportedScript;return!i||i(e.evaluate(t))}],upcase:[Ui,[Ui],(t,[e])=>e.evaluate(t).toUpperCase()],downcase:[Ui,[Ui],(t,[e])=>e.evaluate(t).toLowerCase()],concat:[Ui,Z(tt),(t,e)=>e.map(i=>er(i.evaluate(t))).join("")],"resolved-locale":[Ui,[Nt],(t,[e])=>e.evaluate(t).resolvedLocale()]});var de=cc;function W(t){return{result:"success",value:t}}function Ce(t){return{result:"error",value:t}}function Tt(t){return"data-driven"===t["property-type"]}function yn(t){return!!t.expression&&t.expression.parameters.indexOf("zoom")>-1}function Dn(t){return!!t.expression&&t.expression.interpolated}function Xn(t){return t instanceof Number?"number":t instanceof String?"string":t instanceof Boolean?"boolean":Array.isArray(t)?"array":null===t?"null":typeof t}function Eo(t){return"object"==typeof t&&null!==t&&!Array.isArray(t)}function yo(t){return t}function Xi(t,e){const i="color"===e.type,a=t.stops&&"object"==typeof t.stops[0][0],u=a||!(a||void 0!==t.property),f=t.type||(Dn(e)?"exponential":"interval");if(i&&((t=Qo({},t)).stops&&(t.stops=t.stops.map(D=>[D[0],Co.parse(D[1])])),t.default=Co.parse(t.default?t.default:e.default)),t.colorSpace&&"rgb"!==t.colorSpace&&!kl[t.colorSpace])throw new Error(`Unknown color space: ${t.colorSpace}`);let _,w,E;if("exponential"===f)_=Do;else if("interval"===f)_=Ro;else if("categorical"===f){_=fr,w=Object.create(null);for(const D of t.stops)w[D[0]]=D[1];E=typeof t.stops[0][0]}else{if("identity"!==f)throw new Error(`Unknown function type "${f}"`);_=Ls}if(a){const D={},k=[];for(let K=0;K<t.stops.length;K++){const te=t.stops[K],he=te[0].zoom;void 0===D[he]&&(D[he]={zoom:he,type:t.type,property:t.property,default:t.default,stops:[]},k.push(he)),D[he].stops.push([te[0].value,te[1]])}const z=[];for(const K of k)z.push([D[K].zoom,Xi(D[K],e)]);const j={name:"linear"};return{kind:"composite",interpolationType:j,interpolationFactor:ps.interpolationFactor.bind(void 0,j),zoomStops:z.map(K=>K[0]),evaluate:({zoom:K},te)=>Do({stops:z,base:t.base},e,K).evaluate(K,te)}}if(u){const D="exponential"===f?{name:"exponential",base:void 0!==t.base?t.base:1}:null;return{kind:"camera",interpolationType:D,interpolationFactor:ps.interpolationFactor.bind(void 0,D),zoomStops:t.stops.map(k=>k[0]),evaluate:({zoom:k})=>_(t,e,k,w,E)}}return{kind:"source",evaluate(D,k){const z=k&&k.properties?k.properties[t.property]:void 0;return void 0===z?co(t.default,e.default):_(t,e,z,w,E)}}}function co(t,e,i){return void 0!==t?t:void 0!==e?e:void 0!==i?i:void 0}function fr(t,e,i,a,u){return co(typeof i===u?a[i]:void 0,t.default,e.default)}function Ro(t,e,i){if("number"!==Xn(i))return co(t.default,e.default);const a=t.stops.length;if(1===a||i<=t.stops[0][0])return t.stops[0][1];if(i>=t.stops[a-1][0])return t.stops[a-1][1];const u=ne(t.stops.map(f=>f[0]),i);return t.stops[u][1]}function Do(t,e,i){const a=void 0!==t.base?t.base:1;if("number"!==Xn(i))return co(t.default,e.default);const u=t.stops.length;if(1===u||i<=t.stops[0][0])return t.stops[0][1];if(i>=t.stops[u-1][0])return t.stops[u-1][1];const f=ne(t.stops.map(k=>k[0]),i),_=function(k,z,j,K){const te=K-j,he=k-j;return 0===te?0:1===z?he/te:(Math.pow(z,he)-1)/(Math.pow(z,te)-1)}(i,a,t.stops[f][0],t.stops[f+1][0]),w=t.stops[f][1],E=t.stops[f+1][1];let D=zi[e.type]||yo;if(t.colorSpace&&"rgb"!==t.colorSpace){const k=kl[t.colorSpace];D=(z,j)=>k.reverse(k.interpolate(k.forward(z),k.forward(j),_))}return"function"==typeof w.evaluate?{evaluate(...k){const z=w.evaluate.apply(void 0,k),j=E.evaluate.apply(void 0,k);if(void 0!==z&&void 0!==j)return D(z,j,_)}}:D(w,E,_)}function Ls(t,e,i){return"color"===e.type?i=Co.parse(i):"formatted"===e.type?i=hr.fromString(i.toString()):"resolvedImage"===e.type?i=wo.fromString(i.toString()):Xn(i)===e.type||"enum"===e.type&&e.values[i]||(i=void 0),co(i,t.default,e.default)}class Ds{constructor(e,i){var a;this.expression=e,this._warningHistory={},this._evaluator=new Fr,this._defaultValue=i?"color"===(a=i).type&&(Eo(a.default)||Array.isArray(a.default))?new Co(0,0,0,0):"color"===a.type?Co.parse(a.default)||null:void 0===a.default?null:a.default:null,this._enumValues=i&&"enum"===i.type?i.values:null}evaluateWithoutErrorHandling(e,i,a,u,f,_,w,E){return this._evaluator.globals=e,this._evaluator.feature=i,this._evaluator.featureState=a,this._evaluator.canonical=u||null,this._evaluator.availableImages=f||null,this._evaluator.formattedSection=_,this._evaluator.featureTileCoord=w||null,this._evaluator.featureDistanceData=E||null,this.expression.evaluate(this._evaluator)}evaluate(e,i,a,u,f,_,w,E){this._evaluator.globals=e,this._evaluator.feature=i||null,this._evaluator.featureState=a||null,this._evaluator.canonical=u||null,this._evaluator.availableImages=f||null,this._evaluator.formattedSection=_||null,this._evaluator.featureTileCoord=w||null,this._evaluator.featureDistanceData=E||null;try{const D=this.expression.evaluate(this._evaluator);if(null==D||"number"==typeof D&&D!=D)return this._defaultValue;if(this._enumValues&&!(D in this._enumValues))throw new Jo(`Expected value to be one of ${Object.keys(this._enumValues).map(k=>JSON.stringify(k)).join(", ")}, but found ${JSON.stringify(D)} instead.`);return D}catch(D){return this._warningHistory[D.message]||(this._warningHistory[D.message]=!0,typeof console<"u"&&console.warn(D.message)),this._defaultValue}}}function fs(t){return Array.isArray(t)&&t.length>0&&"string"==typeof t[0]&&t[0]in de}function Vr(t,e){const i=new re(de,[],e?function(u){const f={color:rt,string:Ui,number:Qn,enum:Ui,boolean:ye,formatted:Ut,resolvedImage:_n};return"array"===u.type?Cn(f[u.value]||tt,u.length):f[u.type]}(e):void 0),a=i.parse(t,void 0,void 0,void 0,e&&"string"===e.type?{typeAnnotation:"coerce"}:void 0);return a?W(new Ds(a,e)):Ce(i.errors)}class qs{constructor(e,i){this.kind=e,this._styleExpression=i,this.isStateDependent="constant"!==e&&!pr(i.expression)}evaluateWithoutErrorHandling(e,i,a,u,f,_){return this._styleExpression.evaluateWithoutErrorHandling(e,i,a,u,f,_)}evaluate(e,i,a,u,f,_){return this._styleExpression.evaluate(e,i,a,u,f,_)}}class os{constructor(e,i,a,u){this.kind=e,this.zoomStops=a,this._styleExpression=i,this.isStateDependent="camera"!==e&&!pr(i.expression),this.interpolationType=u}evaluateWithoutErrorHandling(e,i,a,u,f,_){return this._styleExpression.evaluateWithoutErrorHandling(e,i,a,u,f,_)}evaluate(e,i,a,u,f,_){return this._styleExpression.evaluate(e,i,a,u,f,_)}interpolationFactor(e,i,a){return this.interpolationType?ps.interpolationFactor(this.interpolationType,e,i,a):0}}function ki(t,e){if("error"===(t=Vr(t,e)).result)return t;const i=t.value.expression,a=Ts(i);if(!a&&!Tt(e))return Ce([new bo("","data expressions not supported")]);const u=Cr(i,["zoom","pitch","distance-from-center"]);if(!u&&!yn(e))return Ce([new bo("","zoom expressions not supported")]);const f=ms(i);return f||u?f instanceof bo?Ce([f]):f instanceof ps&&!Dn(e)?Ce([new bo("",'"interpolate" expressions cannot be used with this property')]):W(f?new os(a?"camera":"composite",t.value,f.labels,f instanceof ps?f.interpolation:void 0):new qs(a?"constant":"source",t.value)):Ce([new bo("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Zl{constructor(e,i){this._parameters=e,this._specification=i,Qo(this,Xi(this._parameters,this._specification))}static deserialize(e){return new Zl(e._parameters,e._specification)}static serialize(e){return{_parameters:e._parameters,_specification:e._specification}}}function ms(t){let e=null;if(t instanceof Or)e=ms(t.result);else if(t instanceof Rs){for(const i of t.args)if(e=ms(i),e)break}else(t instanceof Ln||t instanceof ps)&&t.input instanceof br&&"zoom"===t.input.name&&(e=t);return e instanceof bo||t.eachChild(i=>{const a=ms(i);a instanceof bo?e=a:!e&&a?e=new bo("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):e&&a&&e!==a&&(e=new bo("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),e}class ci{constructor(e,i,a,u){this.message=(e?`${e}: `:"")+a,u&&(this.identifier=u),null!=i&&i.__line__&&(this.line=i.__line__)}}function sa(t){const e=t.key,i=t.value,a=t.valueSpec||{},u=t.objectElementValidators||{},f=t.style,_=t.styleSpec;let w=[];const E=Xn(i);if("object"!==E)return[new ci(e,i,`object expected, ${E} found`)];for(const D in i){const k=D.split(".")[0];let z;u[k]?z=u[k]:a[k]?z=es:u["*"]?z=u["*"]:a["*"]&&(z=es),z?w=w.concat(z({key:(e&&`${e}.`)+D,value:i[D],valueSpec:a[k]||a["*"],style:f,styleSpec:_,object:i,objectKey:D},i)):w.push(new ci(e,i[D],`unknown property "${D}"`))}for(const D in a)u[D]||a[D].required&&void 0===a[D].default&&void 0===i[D]&&w.push(new ci(e,i,`missing required property "${D}"`));return w}function gu(t){const e=t.value,i=t.valueSpec,a=t.style,u=t.styleSpec,f=t.key,_=t.arrayElementValidator||es;if("array"!==Xn(e))return[new ci(f,e,`array expected, ${Xn(e)} found`)];if(i.length&&e.length!==i.length)return[new ci(f,e,`array length ${i.length} expected, length ${e.length} found`)];if(i["min-length"]&&e.length<i["min-length"])return[new ci(f,e,`array length at least ${i["min-length"]} expected, length ${e.length} found`)];let w={type:i.value,values:i.values,minimum:i.minimum,maximum:i.maximum,function:void 0};u.$version<7&&(w.function=i.function),"object"===Xn(i.value)&&(w=i.value);let E=[];for(let D=0;D<e.length;D++)E=E.concat(_({array:e,arrayIndex:D,value:e[D],valueSpec:w,style:a,styleSpec:u,key:`${f}[${D}]`}));return E}function gl(t){const e=t.key,i=t.value,a=t.valueSpec;let u=Xn(i);if("number"===u&&i!=i&&(u="NaN"),"number"!==u)return[new ci(e,i,`number expected, ${u} found`)];if("minimum"in a){let f=a.minimum;if("array"===Xn(a.minimum)&&(f=a.minimum[t.arrayIndex]),i<f)return[new ci(e,i,`${i} is less than the minimum value ${f}`)]}if("maximum"in a){let f=a.maximum;if("array"===Xn(a.maximum)&&(f=a.maximum[t.arrayIndex]),i>f)return[new ci(e,i,`${i} is greater than the maximum value ${f}`)]}return[]}function ga(t){const e=t.valueSpec,i=xo(t.value.type);let a,u,f,_={};const w="categorical"!==i&&void 0===t.value.property,E=!w,D="array"===Xn(t.value.stops)&&"array"===Xn(t.value.stops[0])&&"object"===Xn(t.value.stops[0][0]),k=sa({key:t.key,value:t.value,valueSpec:t.styleSpec.function,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{stops:function(K){if("identity"===i)return[new ci(K.key,K.value,'identity function may not have a "stops" property')];let te=[];const he=K.value;return te=te.concat(gu({key:K.key,value:he,valueSpec:K.valueSpec,style:K.style,styleSpec:K.styleSpec,arrayElementValidator:z})),"array"===Xn(he)&&0===he.length&&te.push(new ci(K.key,he,"array must have at least one stop")),te},default:function(K){return es({key:K.key,value:K.value,valueSpec:e,style:K.style,styleSpec:K.styleSpec})}}});return"identity"===i&&w&&k.push(new ci(t.key,t.value,'missing required property "property"')),"identity"===i||t.value.stops||k.push(new ci(t.key,t.value,'missing required property "stops"')),"exponential"===i&&t.valueSpec.expression&&!Dn(t.valueSpec)&&k.push(new ci(t.key,t.value,"exponential functions not supported")),t.styleSpec.$version>=8&&(E&&!Tt(t.valueSpec)?k.push(new ci(t.key,t.value,"property functions not supported")):w&&!yn(t.valueSpec)&&k.push(new ci(t.key,t.value,"zoom functions not supported"))),"categorical"!==i&&!D||void 0!==t.value.property||k.push(new ci(t.key,t.value,'"property" property is required')),k;function z(K){let te=[];const he=K.value,Oe=K.key;if("array"!==Xn(he))return[new ci(Oe,he,`array expected, ${Xn(he)} found`)];if(2!==he.length)return[new ci(Oe,he,`array length 2 expected, length ${he.length} found`)];if(D){if("object"!==Xn(he[0]))return[new ci(Oe,he,`object expected, ${Xn(he[0])} found`)];if(void 0===he[0].zoom)return[new ci(Oe,he,"object stop key must have zoom")];if(void 0===he[0].value)return[new ci(Oe,he,"object stop key must have value")];const ot=xo(he[0].zoom);if("number"!=typeof ot)return[new ci(Oe,he[0].zoom,"stop zoom values must be numbers")];if(f&&f>ot)return[new ci(Oe,he[0].zoom,"stop zoom values must appear in ascending order")];ot!==f&&(f=ot,u=void 0,_={}),te=te.concat(sa({key:`${Oe}[0]`,value:he[0],valueSpec:{zoom:{}},style:K.style,styleSpec:K.styleSpec,objectElementValidators:{zoom:gl,value:j}}))}else te=te.concat(j({key:`${Oe}[0]`,value:he[0],valueSpec:{},style:K.style,styleSpec:K.styleSpec},he));return fs(Ki(he[1]))?te.concat([new ci(`${Oe}[1]`,he[1],"expressions are not allowed in function stops.")]):te.concat(es({key:`${Oe}[1]`,value:he[1],valueSpec:e,style:K.style,styleSpec:K.styleSpec}))}function j(K,te){const he=Xn(K.value),Oe=xo(K.value),ot=null!==K.value?K.value:te;if(a){if(he!==a)return[new ci(K.key,ot,`${he} stop domain type must match previous stop domain type ${a}`)]}else a=he;if("number"!==he&&"string"!==he&&"boolean"!==he&&"number"!=typeof Oe&&"string"!=typeof Oe&&"boolean"!=typeof Oe)return[new ci(K.key,ot,"stop domain value must be a number, string, or boolean")];if("number"!==he&&"categorical"!==i){let Ct=`number expected, ${he} found`;return Tt(e)&&void 0===i&&(Ct+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new ci(K.key,ot,Ct)]}return"categorical"!==i||"number"!==he||"number"==typeof Oe&&isFinite(Oe)&&Math.floor(Oe)===Oe?"categorical"!==i&&"number"===he&&"number"==typeof Oe&&"number"==typeof u&&void 0!==u&&Oe<u?[new ci(K.key,ot,"stop domain values must appear in ascending order")]:(u=Oe,"categorical"===i&&Oe in _?[new ci(K.key,ot,"stop domain values must be unique")]:(_[Oe]=!0,[])):[new ci(K.key,ot,`integer expected, found ${String(Oe)}`)]}}function qo(t){const e=("property"===t.expressionContext?ki:Vr)(Ki(t.value),t.valueSpec);if("error"===e.result)return e.value.map(a=>new ci(`${t.key}${a.key}`,t.value,a.message));const i=e.value.expression||e.value._styleExpression.expression;if("property"===t.expressionContext&&"text-font"===t.propertyKey&&!i.outputDefined())return[new ci(t.key,t.value,`Invalid data expression for "${t.propertyKey}". Output values must be contained as literals within the expression.`)];if("property"===t.expressionContext&&"layout"===t.propertyType&&!pr(i))return[new ci(t.key,t.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===t.expressionContext)return Vl(i,t);if(t.expressionContext&&0===t.expressionContext.indexOf("cluster")){if(!Cr(i,["zoom","feature-state"]))return[new ci(t.key,t.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===t.expressionContext&&!Ts(i))return[new ci(t.key,t.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Vl(t,e){const i=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(e.valueSpec&&e.valueSpec.expression)for(const u of e.valueSpec.expression.parameters)i.delete(u);if(0===i.size)return[];const a=[];return t instanceof br&&i.has(t.name)?[new ci(e.key,e.value,`["${t.name}"] expression is not supported in a filter for a ${e.object.type} layer with id: ${e.object.id}`)]:(t.eachChild(u=>{a.push(...Vl(u,e))}),a)}function Ka(t){const e=t.key,i=t.value,a=t.valueSpec,u=[];return Array.isArray(a.values)?-1===a.values.indexOf(xo(i))&&u.push(new ci(e,i,`expected one of [${a.values.join(", ")}], ${JSON.stringify(i)} found`)):-1===Object.keys(a.values).indexOf(xo(i))&&u.push(new ci(e,i,`expected one of [${Object.keys(a.values).join(", ")}], ${JSON.stringify(i)} found`)),u}function Zc(t){if(!0===t||!1===t)return!0;if(!Array.isArray(t)||0===t.length)return!1;switch(t[0]){case"has":return t.length>=2&&"$id"!==t[1]&&"$type"!==t[1];case"in":return t.length>=3&&("string"!=typeof t[1]||Array.isArray(t[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==t.length||Array.isArray(t[1])||Array.isArray(t[2]);case"any":case"all":for(const e of t.slice(1))if(!Zc(e)&&"boolean"!=typeof e)return!1;return!0;default:return!0}}function dc(t,e="fill"){if(null==t)return{filter:()=>!0,needGeometry:!1,needFeature:!1};Zc(t)||(t=Aa(t));const i=t;let a=!0;try{a=function(D){if(!_l(D))return D;let k=Ki(D);return Mo(k),k=Hn(k),k}(i)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.\nThis is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md\nand paste the contents of this message in the report.\nThank you!\nFilter Expression:\n${JSON.stringify(i,null,2)}\n        `)}const u=tn[`filter_${e}`],f=Vr(a,u);let _=null;if("error"===f.result)throw new Error(f.value.map(D=>`${D.key}: ${D.message}`).join(", "));_=(D,k,z)=>f.value.evaluate(D,k,{},z);let w=null,E=null;if(a!==i){const D=Vr(i,u);if("error"===D.result)throw new Error(D.value.map(k=>`${k.key}: ${k.message}`).join(", "));w=(k,z,j,K,te)=>D.value.evaluate(k,z,{},j,void 0,void 0,K,te),E=!Ts(D.value.expression)}return{filter:_,dynamicFilter:w||void 0,needGeometry:pc(a),needFeature:!!E}}function Hn(t){if(!Array.isArray(t))return t;const e=function(i){if(hc.has(i[0]))for(let a=1;a<i.length;a++)if(_l(i[a]))return!0;return i}(t);return!0===e?e:e.map(i=>Hn(i))}function Mo(t){let e=!1;const i=[];if("case"===t[0]){for(let a=1;a<t.length-1;a+=2)e=e||_l(t[a]),i.push(t[a+1]);i.push(t[t.length-1])}else if("match"===t[0]){e=e||_l(t[1]);for(let a=2;a<t.length-1;a+=2)i.push(t[a+1]);i.push(t[t.length-1])}else if("step"===t[0]){e=e||_l(t[1]);for(let a=1;a<t.length-1;a+=2)i.push(t[a+1])}e&&(t.length=0,t.push("any",...i));for(let a=1;a<t.length;a++)Mo(t[a])}function _l(t){if(!Array.isArray(t))return!1;if("pitch"===(e=t[0])||"distance-from-center"===e)return!0;var e;for(let i=1;i<t.length;i++)if(_l(t[i]))return!0;return!1}const hc=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function jr(t,e){return t<e?-1:t>e?1:0}function pc(t){if(!Array.isArray(t))return!1;if("within"===t[0])return!0;for(let e=1;e<t.length;e++)if(pc(t[e]))return!0;return!1}function Aa(t){if(!t)return!0;const e=t[0];return t.length<=1?"any"!==e:"=="===e?ks(t[1],t[2],"=="):"!="===e?Vc(ks(t[1],t[2],"==")):"<"===e||">"===e||"<="===e||">="===e?ks(t[1],t[2],e):"any"===e?(i=t.slice(1),["any"].concat(i.map(Aa))):"all"===e?["all"].concat(t.slice(1).map(Aa)):"none"===e?["all"].concat(t.slice(1).map(Aa).map(Vc)):"in"===e?Fs(t[1],t.slice(2)):"!in"===e?Vc(Fs(t[1],t.slice(2))):"has"===e?jl(t[1]):"!has"===e?Vc(jl(t[1])):"within"!==e||t;var i}function ks(t,e,i){switch(t){case"$type":return[`filter-type-${i}`,e];case"$id":return[`filter-id-${i}`,e];default:return[`filter-${i}`,t,e]}}function Fs(t,e){if(0===e.length)return!1;switch(t){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some(i=>typeof i!=typeof e[0])?["filter-in-large",t,["literal",e.sort(jr)]]:["filter-in-small",t,["literal",e]]}}function jl(t){switch(t){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",t]}}function Vc(t){return["!",t]}function jc(t){return Zc(Ki(t.value))?qo(Qo({},t,{expressionContext:"filter",valueSpec:t.styleSpec[`filter_${t.layerType||"fill"}`]})):$l(t)}function $l(t){const e=t.value,i=t.key;if("array"!==Xn(e))return[new ci(i,e,`array expected, ${Xn(e)} found`)];const a=t.styleSpec;let u,f=[];if(e.length<1)return[new ci(i,e,"filter array must have at least 1 element")];switch(f=f.concat(Ka({key:`${i}[0]`,value:e[0],valueSpec:a.filter_operator,style:t.style,styleSpec:t.styleSpec})),xo(e[0])){case"<":case"<=":case">":case">=":e.length>=2&&"$type"===xo(e[1])&&f.push(new ci(i,e,`"$type" cannot be use with operator "${e[0]}"`));case"==":case"!=":3!==e.length&&f.push(new ci(i,e,`filter array for operator "${e[0]}" must have 3 elements`));case"in":case"!in":e.length>=2&&(u=Xn(e[1]),"string"!==u&&f.push(new ci(`${i}[1]`,e[1],`string expected, ${u} found`)));for(let _=2;_<e.length;_++)u=Xn(e[_]),"$type"===xo(e[1])?f=f.concat(Ka({key:`${i}[${_}]`,value:e[_],valueSpec:a.geometry_type,style:t.style,styleSpec:t.styleSpec})):"string"!==u&&"number"!==u&&"boolean"!==u&&f.push(new ci(`${i}[${_}]`,e[_],`string, number, or boolean expected, ${u} found`));break;case"any":case"all":case"none":for(let _=1;_<e.length;_++)f=f.concat($l({key:`${i}[${_}]`,value:e[_],style:t.style,styleSpec:t.styleSpec}));break;case"has":case"!has":u=Xn(e[1]),2!==e.length?f.push(new ci(i,e,`filter array for "${e[0]}" operator must have 2 elements`)):"string"!==u&&f.push(new ci(`${i}[1]`,e[1],`string expected, ${u} found`));break;case"within":u=Xn(e[1]),2!==e.length?f.push(new ci(i,e,`filter array for "${e[0]}" operator must have 2 elements`)):"object"!==u&&f.push(new ci(`${i}[1]`,e[1],`object expected, ${u} found`))}return f}function Wr(t,e){const i=t.key,a=t.style,u=t.styleSpec,f=t.value,_=t.objectKey,w=u[`${e}_${t.layerType}`];if(!w)return[];const E=_.match(/^(.*)-transition$/);if("paint"===e&&E&&w[E[1]]&&w[E[1]].transition)return es({key:i,value:f,valueSpec:u.transition,style:a,styleSpec:u});const D=t.valueSpec||w[_];if(!D)return[new ci(i,f,`unknown property "${_}"`)];let k;if("string"===Xn(f)&&Tt(D)&&!D.tokens&&(k=/^{([^}]+)}$/.exec(f))){const j=`\`{ "type": "identity", "property": ${k?JSON.stringify(k[1]):'"_"'} }\``;return[new ci(i,f,`"${_}" does not support interpolation syntax\nUse an identity property function instead: ${j}.`)]}const z=[];return"symbol"===t.layerType&&("text-field"===_&&a&&!a.glyphs&&z.push(new ci(i,f,'use of "text-field" requires a style "glyphs" property')),"text-font"===_&&Eo(Ki(f))&&"identity"===xo(f.type)&&z.push(new ci(i,f,'"text-font" does not support identity functions'))),z.concat(es({key:t.key,value:f,valueSpec:D,style:a,styleSpec:u,expressionContext:"property",propertyType:e,propertyKey:_}))}function aa(t){return Wr(t,"paint")}function yl(t){return Wr(t,"layout")}function Xa(t){let e=[];const i=t.value,a=t.key,u=t.style,f=t.styleSpec;i.type||i.ref||e.push(new ci(a,i,'either "type" or "ref" is required'));let _=xo(i.type);const w=xo(i.ref);if(i.id){const E=xo(i.id);for(let D=0;D<t.arrayIndex;D++){const k=u.layers[D];xo(k.id)===E&&e.push(new ci(a,i.id,`duplicate layer id "${i.id}", previously used at line ${k.id.__line__}`))}}if("ref"in i){let E;["type","source","source-layer","filter","layout"].forEach(D=>{D in i&&e.push(new ci(a,i[D],`"${D}" is prohibited for ref layers`))}),u.layers.forEach(D=>{xo(D.id)===w&&(E=D)}),E?E.ref?e.push(new ci(a,i.ref,"ref cannot reference another ref layer")):_=xo(E.type):"string"==typeof w&&e.push(new ci(a,i.ref,`ref layer "${w}" not found`))}else if("background"!==_&&"sky"!==_)if(i.source){const E=u.sources&&u.sources[i.source],D=E&&xo(E.type);E?"vector"===D&&"raster"===_?e.push(new ci(a,i.source,`layer "${i.id}" requires a raster source`)):"raster"===D&&"raster"!==_?e.push(new ci(a,i.source,`layer "${i.id}" requires a vector source`)):"vector"!==D||i["source-layer"]?"raster-dem"===D&&"hillshade"!==_?e.push(new ci(a,i.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==_||!i.paint||!i.paint["line-gradient"]&&!i.paint["line-trim-offset"]||"geojson"===D&&E.lineMetrics||e.push(new ci(a,i,`layer "${i.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):e.push(new ci(a,i,`layer "${i.id}" must specify a "source-layer"`)):e.push(new ci(a,i.source,`source "${i.source}" not found`))}else e.push(new ci(a,i,'missing required property "source"'));return e=e.concat(sa({key:a,value:i,valueSpec:f.layer,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":()=>[],type:()=>es({key:`${a}.type`,value:i.type,valueSpec:f.layer.type,style:t.style,styleSpec:t.styleSpec,object:i,objectKey:"type"}),filter:E=>jc(Qo({layerType:_},E)),layout:E=>sa({layer:i,key:E.key,value:E.value,valueSpec:{},style:E.style,styleSpec:E.styleSpec,objectElementValidators:{"*":D=>yl(Qo({layerType:_},D))}}),paint:E=>sa({layer:i,key:E.key,value:E.value,valueSpec:{},style:E.style,styleSpec:E.styleSpec,objectElementValidators:{"*":D=>aa(Qo({layerType:_},D))}})}})),e}function rs(t){const e=t.value,i=t.key,a=Xn(e);return"string"!==a?[new ci(i,e,`string expected, ${a} found`)]:[]}const md={promoteId:function({key:t,value:e}){if("string"===Xn(e))return rs({key:t,value:e});{const i=[];for(const a in e)i.push(...rs({key:`${t}.${a}`,value:e[a]}));return i}}};function fc(t){const e=t.value,i=t.key,a=t.styleSpec,u=t.style;if(!e.type)return[new ci(i,e,'"type" is required')];const f=xo(e.type);let _;switch(f){case"vector":case"raster":case"raster-dem":return _=sa({key:i,value:e,valueSpec:a[`source_${f.replace("-","_")}`],style:t.style,styleSpec:a,objectElementValidators:md}),_;case"geojson":if(_=sa({key:i,value:e,valueSpec:a.source_geojson,style:u,styleSpec:a,objectElementValidators:md}),e.cluster)for(const w in e.clusterProperties){const[E,D]=e.clusterProperties[w],k="string"==typeof E?[E,["accumulated"],["get",w]]:E;_.push(...qo({key:`${i}.${w}.map`,value:D,expressionContext:"cluster-map"})),_.push(...qo({key:`${i}.${w}.reduce`,value:k,expressionContext:"cluster-reduce"}))}return _;case"video":return sa({key:i,value:e,valueSpec:a.source_video,style:u,styleSpec:a});case"image":return sa({key:i,value:e,valueSpec:a.source_image,style:u,styleSpec:a});case"canvas":return[new ci(i,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Ka({key:`${i}.type`,value:e.type,valueSpec:{values:gd(a)},style:u,styleSpec:a})}}function gd(t){return t.source.reduce((e,i)=>{const a=t[i];return"enum"===a.type.type&&(e=e.concat(Object.keys(a.type.values))),e},[])}function _d(t){const e=t.value,i=t.styleSpec,a=i.light,u=t.style;let f=[];const _=Xn(e);if(void 0===e)return f;if("object"!==_)return f=f.concat([new ci("light",e,`object expected, ${_} found`)]),f;for(const w in e){const E=w.match(/^(.*)-transition$/);f=f.concat(E&&a[E[1]]&&a[E[1]].transition?es({key:w,value:e[w],valueSpec:i.transition,style:u,styleSpec:i}):a[w]?es({key:w,value:e[w],valueSpec:a[w],style:u,styleSpec:i}):[new ci(w,e[w],`unknown property "${w}"`)])}return f}function mc(t){const e=t.value,i=t.key,a=t.style,u=t.styleSpec,f=u.terrain;let _=[];const w=Xn(e);if(void 0===e)return _;if("object"!==w)return _=_.concat([new ci("terrain",e,`object expected, ${w} found`)]),_;for(const E in e){const D=E.match(/^(.*)-transition$/);_=_.concat(D&&f[D[1]]&&f[D[1]].transition?es({key:E,value:e[E],valueSpec:u.transition,style:a,styleSpec:u}):f[E]?es({key:E,value:e[E],valueSpec:f[E],style:a,styleSpec:u}):[new ci(E,e[E],`unknown property "${E}"`)])}if(e.source){const E=a.sources&&a.sources[e.source],D=E&&xo(E.type);E?"raster-dem"!==D&&_.push(new ci(i,e.source,`terrain cannot be used with a source of type ${String(D)}, it only be used with a "raster-dem" source type`)):_.push(new ci(i,e.source,`source "${e.source}" not found`))}else _.push(new ci(i,e,'terrain is missing required property "source"'));return _}function $c(t){const e=t.value,i=t.style,a=t.styleSpec,u=a.fog;let f=[];const _=Xn(e);if(void 0===e)return f;if("object"!==_)return f=f.concat([new ci("fog",e,`object expected, ${_} found`)]),f;for(const w in e){const E=w.match(/^(.*)-transition$/);f=f.concat(E&&u[E[1]]&&u[E[1]].transition?es({key:w,value:e[w],valueSpec:a.transition,style:i,styleSpec:a}):u[w]?es({key:w,value:e[w],valueSpec:u[w],style:i,styleSpec:a}):[new ci(w,e[w],`unknown property "${w}"`)])}return f}const Hc={"*":()=>[],array:gu,boolean:function(t){const e=t.value,i=t.key,a=Xn(e);return"boolean"!==a?[new ci(i,e,`boolean expected, ${a} found`)]:[]},number:gl,color:function(t){const e=t.key,i=t.value,a=Xn(i);return"string"!==a?[new ci(e,i,`color expected, ${a} found`)]:null===Lo(i)?[new ci(e,i,`color expected, "${i}" found`)]:[]},enum:Ka,filter:jc,function:ga,layer:Xa,object:sa,source:fc,light:_d,terrain:mc,fog:$c,string:rs,formatted:function(t){return 0===rs(t).length?[]:qo(t)},resolvedImage:function(t){return 0===rs(t).length?[]:qo(t)},projection:function(t){const e=t.value,i=t.styleSpec,a=i.projection,u=t.style;let f=[];const _=Xn(e);if("object"===_)for(const w in e)f=f.concat(es({key:w,value:e[w],valueSpec:a[w],style:u,styleSpec:i}));else"string"!==_&&(f=f.concat([new ci("projection",e,`object or string expected, ${_} found`)]));return f}};function es(t){const e=t.value,i=t.valueSpec,a=t.styleSpec;return i.expression&&Eo(xo(e))?ga(t):i.expression&&fs(Ki(e))?qo(t):i.type&&Hc[i.type]?Hc[i.type](t):sa(Qo({},t,{valueSpec:i.type?a[i.type]:i}))}function _u(t){const e=t.value,i=t.key,a=rs(t);return a.length||(-1===e.indexOf("{fontstack}")&&a.push(new ci(i,e,'"glyphs" url must include a "{fontstack}" token')),-1===e.indexOf("{range}")&&a.push(new ci(i,e,'"glyphs" url must include a "{range}" token'))),a}function Gc(t,e=tn){return Bs(es({key:"",value:t,valueSpec:e.$root,styleSpec:e,style:t,objectElementValidators:{glyphs:_u,"*":()=>[]}}))}const Wc=t=>Bs(aa(t)),yu=t=>Bs(yl(t));function Bs(t){return t.slice().sort((e,i)=>e.line&&i.line?e.line-i.line:0)}function qc(t,e){let i=!1;if(e&&e.length)for(const a of e)t.fire(new Ai(new Error(a.message))),i=!0;return i}var vu=_a,Ns=3;function _a(t,e,i){var a=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;var u=new Int32Array(this.arrayBuffer);t=u[0],this.d=(e=u[1])+2*(i=u[2]);for(var f=0;f<this.d*this.d;f++){var _=u[Ns+f],w=u[Ns+f+1];a.push(_===w?null:u.subarray(_,w))}var E=u[Ns+a.length+1];this.keys=u.subarray(u[Ns+a.length],E),this.bboxes=u.subarray(E),this.insert=this._insertReadonly}else{this.d=e+2*i;for(var D=0;D<this.d*this.d;D++)a.push([]);this.keys=[],this.bboxes=[]}this.n=e,this.extent=t,this.padding=i,this.scale=e/t,this.uid=0;var k=i/e*t;this.min=-k,this.max=t+k}_a.prototype.insert=function(t,e,i,a,u){this._forEachCell(e,i,a,u,this._insertCell,this.uid++),this.keys.push(t),this.bboxes.push(e),this.bboxes.push(i),this.bboxes.push(a),this.bboxes.push(u)},_a.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},_a.prototype._insertCell=function(t,e,i,a,u,f){this.cells[u].push(f)},_a.prototype.query=function(t,e,i,a,u){var f=this.min,_=this.max;if(t<=f&&e<=f&&_<=i&&_<=a&&!u)return Array.prototype.slice.call(this.keys);var w=[];return this._forEachCell(t,e,i,a,this._queryCell,w,{},u),w},_a.prototype._queryCell=function(t,e,i,a,u,f,_,w){var E=this.cells[u];if(null!==E)for(var D=this.keys,k=this.bboxes,z=0;z<E.length;z++){var j=E[z];if(void 0===_[j]){var K=4*j;(w?w(k[K+0],k[K+1],k[K+2],k[K+3]):t<=k[K+2]&&e<=k[K+3]&&i>=k[K+0]&&a>=k[K+1])?(_[j]=!0,f.push(D[j])):_[j]=!1}}},_a.prototype._forEachCell=function(t,e,i,a,u,f,_,w){for(var E=this._convertToCellCoord(t),D=this._convertToCellCoord(e),k=this._convertToCellCoord(i),z=this._convertToCellCoord(a),j=E;j<=k;j++)for(var K=D;K<=z;K++){var te=this.d*K+j;if((!w||w(this._convertFromCellCoord(j),this._convertFromCellCoord(K),this._convertFromCellCoord(j+1),this._convertFromCellCoord(K+1)))&&u.call(this,t,e,i,a,te,f,_,w))return}},_a.prototype._convertFromCellCoord=function(t){return(t-this.padding)/this.scale},_a.prototype._convertToCellCoord=function(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))},_a.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var t=this.cells,e=Ns+this.cells.length+1+1,i=0,a=0;a<this.cells.length;a++)i+=this.cells[a].length;var u=new Int32Array(e+i+this.keys.length+this.bboxes.length);u[0]=this.extent,u[1]=this.n,u[2]=this.padding;for(var f=e,_=0;_<t.length;_++){var w=t[_];u[Ns+_]=f,u.set(w,f),f+=w.length}return u[Ns+t.length]=f,u.set(this.keys,f),u[Ns+t.length+1]=f+=this.keys.length,u.set(this.bboxes,f),f+=this.bboxes.length,u.buffer};var za=be(vu);const qr={};function ui(t,e,i={}){Object.defineProperty(t,"_classRegistryKey",{value:e,writeable:!1}),qr[e]={klass:t,omit:i.omit||[]}}ui(Object,"Object"),za.serialize=function(t,e){const i=t.toArrayBuffer();return e&&e.push(i),{buffer:i}},za.deserialize=function(t){return new za(t.buffer)},Object.defineProperty(za,"name",{value:"Grid"}),ui(za,"Grid"),ui(Co,"Color"),ui(Error,"Error"),ui(Gt,"AJAXError"),ui(wo,"ResolvedImage"),ui(Zl,"StylePropertyFunction"),ui(Ds,"StyleExpression",{omit:["_evaluator"]}),ui(os,"ZoomDependentExpression"),ui(qs,"ZoomConstantExpression"),ui(br,"CompoundExpression",{omit:["_evaluate"]});for(const t in de)qr[de[t]._classRegistryKey]||ui(de[t],`Expression${t}`);function _r(t){return t&&typeof ArrayBuffer<"u"&&(t instanceof ArrayBuffer||t.constructor&&"ArrayBuffer"===t.constructor.name)}function xu(t){return Q.ImageBitmap&&t instanceof Q.ImageBitmap}function Hl(t,e){if(null==t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp)return t;if(_r(t)||xu(t))return e&&e.push(t),t;if(ArrayBuffer.isView(t)){const i=t;return e&&e.push(i.buffer),i}if(t instanceof Q.ImageData)return e&&e.push(t.data.buffer),t;if(Array.isArray(t)){const i=[];for(const a of t)i.push(Hl(a,e));return i}if("object"==typeof t){const i=t.constructor,a=i._classRegistryKey;if(!a)throw new Error(`can't serialize object of unregistered class ${a}`);const u=i.serialize?i.serialize(t,e):{};if(!i.serialize){for(const f in t)t.hasOwnProperty(f)&&(qr[a].omit.indexOf(f)>=0||(u[f]=Hl(t[f],e)));t instanceof Error&&(u.message=t.message)}if(u.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==a&&(u.$name=a),u}throw new Error("can't serialize object of type "+typeof t)}function vl(t){if(null==t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp||_r(t)||xu(t)||ArrayBuffer.isView(t)||t instanceof Q.ImageData)return t;if(Array.isArray(t))return t.map(vl);if("object"==typeof t){const e=t.$name||"Object",{klass:i}=qr[e];if(!i)throw new Error(`can't deserialize unregistered class ${e}`);if(i.deserialize)return i.deserialize(t);const a=Object.create(i.prototype);for(const u of Object.keys(t))"$name"!==u&&(a[u]=vl(t[u]));return a}throw new Error("can't deserialize object of type "+typeof t)}const ai={"Latin-1 Supplement":t=>t>=128&&t<=255,Arabic:t=>t>=1536&&t<=1791,"Arabic Supplement":t=>t>=1872&&t<=1919,"Arabic Extended-A":t=>t>=2208&&t<=2303,"Hangul Jamo":t=>t>=4352&&t<=4607,"Unified Canadian Aboriginal Syllabics":t=>t>=5120&&t<=5759,Khmer:t=>t>=6016&&t<=6143,"Unified Canadian Aboriginal Syllabics Extended":t=>t>=6320&&t<=6399,"General Punctuation":t=>t>=8192&&t<=8303,"Letterlike Symbols":t=>t>=8448&&t<=8527,"Number Forms":t=>t>=8528&&t<=8591,"Miscellaneous Technical":t=>t>=8960&&t<=9215,"Control Pictures":t=>t>=9216&&t<=9279,"Optical Character Recognition":t=>t>=9280&&t<=9311,"Enclosed Alphanumerics":t=>t>=9312&&t<=9471,"Geometric Shapes":t=>t>=9632&&t<=9727,"Miscellaneous Symbols":t=>t>=9728&&t<=9983,"Miscellaneous Symbols and Arrows":t=>t>=11008&&t<=11263,"CJK Radicals Supplement":t=>t>=11904&&t<=12031,"Kangxi Radicals":t=>t>=12032&&t<=12255,"Ideographic Description Characters":t=>t>=12272&&t<=12287,"CJK Symbols and Punctuation":t=>t>=12288&&t<=12351,Hiragana:t=>t>=12352&&t<=12447,Katakana:t=>t>=12448&&t<=12543,Bopomofo:t=>t>=12544&&t<=12591,"Hangul Compatibility Jamo":t=>t>=12592&&t<=12687,Kanbun:t=>t>=12688&&t<=12703,"Bopomofo Extended":t=>t>=12704&&t<=12735,"CJK Strokes":t=>t>=12736&&t<=12783,"Katakana Phonetic Extensions":t=>t>=12784&&t<=12799,"Enclosed CJK Letters and Months":t=>t>=12800&&t<=13055,"CJK Compatibility":t=>t>=13056&&t<=13311,"CJK Unified Ideographs Extension A":t=>t>=13312&&t<=19903,"Yijing Hexagram Symbols":t=>t>=19904&&t<=19967,"CJK Unified Ideographs":t=>t>=19968&&t<=40959,"Yi Syllables":t=>t>=40960&&t<=42127,"Yi Radicals":t=>t>=42128&&t<=42191,"Hangul Jamo Extended-A":t=>t>=43360&&t<=43391,"Hangul Syllables":t=>t>=44032&&t<=55215,"Hangul Jamo Extended-B":t=>t>=55216&&t<=55295,"Private Use Area":t=>t>=57344&&t<=63743,"CJK Compatibility Ideographs":t=>t>=63744&&t<=64255,"Arabic Presentation Forms-A":t=>t>=64336&&t<=65023,"Vertical Forms":t=>t>=65040&&t<=65055,"CJK Compatibility Forms":t=>t>=65072&&t<=65103,"Small Form Variants":t=>t>=65104&&t<=65135,"Arabic Presentation Forms-B":t=>t>=65136&&t<=65279,"Halfwidth and Fullwidth Forms":t=>t>=65280&&t<=65519};function L(t){for(const e of t)if(U(e.charCodeAt(0)))return!0;return!1}function B(t){for(const e of t)if(!A(e.charCodeAt(0)))return!1;return!0}function A(t){return!(ai.Arabic(t)||ai["Arabic Supplement"](t)||ai["Arabic Extended-A"](t)||ai["Arabic Presentation Forms-A"](t)||ai["Arabic Presentation Forms-B"](t))}function U(t){return!(746!==t&&747!==t&&(t<4352||!(ai["Bopomofo Extended"](t)||ai.Bopomofo(t)||ai["CJK Compatibility Forms"](t)&&!(t>=65097&&t<=65103)||ai["CJK Compatibility Ideographs"](t)||ai["CJK Compatibility"](t)||ai["CJK Radicals Supplement"](t)||ai["CJK Strokes"](t)||!(!ai["CJK Symbols and Punctuation"](t)||t>=12296&&t<=12305||t>=12308&&t<=12319||12336===t)||ai["CJK Unified Ideographs Extension A"](t)||ai["CJK Unified Ideographs"](t)||ai["Enclosed CJK Letters and Months"](t)||ai["Hangul Compatibility Jamo"](t)||ai["Hangul Jamo Extended-A"](t)||ai["Hangul Jamo Extended-B"](t)||ai["Hangul Jamo"](t)||ai["Hangul Syllables"](t)||ai.Hiragana(t)||ai["Ideographic Description Characters"](t)||ai.Kanbun(t)||ai["Kangxi Radicals"](t)||ai["Katakana Phonetic Extensions"](t)||ai.Katakana(t)&&12540!==t||!(!ai["Halfwidth and Fullwidth Forms"](t)||65288===t||65289===t||65293===t||t>=65306&&t<=65310||65339===t||65341===t||65343===t||t>=65371&&t<=65503||65507===t||t>=65512&&t<=65519)||!(!ai["Small Form Variants"](t)||t>=65112&&t<=65118||t>=65123&&t<=65126)||ai["Unified Canadian Aboriginal Syllabics"](t)||ai["Unified Canadian Aboriginal Syllabics Extended"](t)||ai["Vertical Forms"](t)||ai["Yijing Hexagram Symbols"](t)||ai["Yi Syllables"](t)||ai["Yi Radicals"](t))))}function le(t){return!(U(t)||(e=t,ai["Latin-1 Supplement"](e)&&(167===e||169===e||174===e||177===e||188===e||189===e||190===e||215===e||247===e)||ai["General Punctuation"](e)&&(8214===e||8224===e||8225===e||8240===e||8241===e||8251===e||8252===e||8258===e||8263===e||8264===e||8265===e||8273===e)||ai["Letterlike Symbols"](e)||ai["Number Forms"](e)||ai["Miscellaneous Technical"](e)&&(e>=8960&&e<=8967||e>=8972&&e<=8991||e>=8996&&e<=9e3||9003===e||e>=9085&&e<=9114||e>=9150&&e<=9165||9167===e||e>=9169&&e<=9179||e>=9186&&e<=9215)||ai["Control Pictures"](e)&&9251!==e||ai["Optical Character Recognition"](e)||ai["Enclosed Alphanumerics"](e)||ai["Geometric Shapes"](e)||ai["Miscellaneous Symbols"](e)&&!(e>=9754&&e<=9759)||ai["Miscellaneous Symbols and Arrows"](e)&&(e>=11026&&e<=11055||e>=11088&&e<=11097||e>=11192&&e<=11243)||ai["CJK Symbols and Punctuation"](e)||ai.Katakana(e)||ai["Private Use Area"](e)||ai["CJK Compatibility Forms"](e)||ai["Small Form Variants"](e)||ai["Halfwidth and Fullwidth Forms"](e)||8734===e||8756===e||8757===e||e>=9984&&e<=10087||e>=10102&&e<=10131||65532===e||65533===e));var e}function Fe(t){return t>=1424&&t<=2303||ai["Arabic Presentation Forms-A"](t)||ai["Arabic Presentation Forms-B"](t)}function We(t,e){return!(!e&&Fe(t)||t>=2304&&t<=3583||t>=3840&&t<=4255||ai.Khmer(t))}function Jt(t){for(const e of t)if(Fe(e.charCodeAt(0)))return!0;return!1}const Rn="deferred",fi="loading",Mi="loaded";let Io=null,p="unavailable",o=null;const c=function(t){t&&"string"==typeof t&&t.indexOf("NetworkError")>-1&&(p="error"),Io&&Io(t)};function m(){b.fire(new oo("pluginStateChange",{pluginStatus:p,pluginURL:o}))}const b=new ho,T=function(){return p},I=function(){if(p!==Rn||!o)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");p=fi,m(),o&&ri({url:o},t=>{t?c(t):(p=Mi,m())})},O={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>p===Mi||null!=O.applyArabicShaping,isLoading:()=>p===fi,setState(t){p=t.pluginStatus,o=t.pluginURL},isParsed:()=>null!=O.applyArabicShaping&&null!=O.processBidirectionalText&&null!=O.processStyledBidirectionalText,getPluginURL:()=>o};class N{constructor(e,i){this.zoom=e,i?(this.now=i.now,this.fadeDuration=i.fadeDuration,this.transition=i.transition,this.pitch=i.pitch):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0)}isSupportedScript(e){return function(i,a){for(const u of i)if(!We(u.charCodeAt(0),a))return!1;return!0}(e,O.isLoaded())}}class H{constructor(e,i){this.property=e,this.value=i,this.expression=function(a,u){if(Eo(a))return new Zl(a,u);if(fs(a)){const f=ki(a,u);if("error"===f.result)throw new Error(f.value.map(_=>`${_.key}: ${_.message}`).join(", "));return f.value}{let f=a;return"string"==typeof a&&"color"===u.type&&(f=Co.parse(a)),{kind:"constant",evaluate:()=>f}}}(void 0===i?e.specification.default:i,e.specification)}isDataDriven(){return"source"===this.expression.kind||"composite"===this.expression.kind}possiblyEvaluate(e,i,a){return this.property.possiblyEvaluate(this,e,i,a)}}class ${constructor(e){this.property=e,this.value=new H(e,void 0)}transitioned(e,i){return new Ie(this.property,this.value,i,ze({},e.transition,this.transition),e.now)}untransitioned(){return new Ie(this.property,this.value,null,{},0)}}class ce{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues)}getValue(e){return an(this._values[e].value.value)}setValue(e,i){this._values.hasOwnProperty(e)||(this._values[e]=new $(this._values[e].property)),this._values[e].value=new H(this._values[e].property,null===i?void 0:an(i))}getTransition(e){return an(this._values[e].transition)}setTransition(e,i){this._values.hasOwnProperty(e)||(this._values[e]=new $(this._values[e].property)),this._values[e].transition=an(i)||void 0}serialize(){const e={};for(const i of Object.keys(this._values)){const a=this.getValue(i);void 0!==a&&(e[i]=a);const u=this.getTransition(i);void 0!==u&&(e[`${i}-transition`]=u)}return e}transitioned(e,i){const a=new je(this._properties);for(const u of Object.keys(this._values))a._values[u]=this._values[u].transitioned(e,i._values[u]);return a}untransitioned(){const e=new je(this._properties);for(const i of Object.keys(this._values))e._values[i]=this._values[i].untransitioned();return e}}class Ie{constructor(e,i,a,u,f){const _=u.delay||0,w=u.duration||0;f=f||0,this.property=e,this.value=i,this.begin=f+_,this.end=this.begin+w,e.specification.transition&&(u.delay||u.duration)&&(this.prior=a)}possiblyEvaluate(e,i,a){const u=e.now||0,f=this.value.possiblyEvaluate(e,i,a),_=this.prior;if(_){if(u>this.end)return this.prior=null,f;if(this.value.isDataDriven())return this.prior=null,f;if(u<this.begin)return _.possiblyEvaluate(e,i,a);{const w=(u-this.begin)/(this.end-this.begin);return this.property.interpolate(_.possiblyEvaluate(e,i,a),f,we(w))}}return f}}class je{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)}possiblyEvaluate(e,i,a){const u=new nt(this._properties);for(const f of Object.keys(this._values))u._values[f]=this._values[f].possiblyEvaluate(e,i,a);return u}hasTransition(){for(const e of Object.keys(this._values))if(this._values[e].prior)return!0;return!1}}class Ke{constructor(e){this._properties=e,this._values=Object.create(e.defaultPropertyValues)}getValue(e){return an(this._values[e].value)}setValue(e,i){this._values[e]=new H(this._values[e].property,null===i?void 0:an(i))}serialize(){const e={};for(const i of Object.keys(this._values)){const a=this.getValue(i);void 0!==a&&(e[i]=a)}return e}possiblyEvaluate(e,i,a){const u=new nt(this._properties);for(const f of Object.keys(this._values))u._values[f]=this._values[f].possiblyEvaluate(e,i,a);return u}}class Ye{constructor(e,i,a){this.property=e,this.value=i,this.parameters=a}isConstant(){return"constant"===this.value.kind}constantOr(e){return"constant"===this.value.kind?this.value.value:e}evaluate(e,i,a,u){return this.property.evaluate(this.value,this.parameters,e,i,a,u)}}class nt{constructor(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)}get(e){return this._values[e]}}class ue{constructor(e){this.specification=e}possiblyEvaluate(e,i){return e.expression.evaluate(i)}interpolate(e,i,a){const u=zi[this.specification.type];return u?u(e,i,a):e}}class $e{constructor(e,i){this.specification=e,this.overrides=i}possiblyEvaluate(e,i,a,u){return new Ye(this,"constant"===e.expression.kind||"camera"===e.expression.kind?{kind:"constant",value:e.expression.evaluate(i,null,{},a,u)}:e.expression,i)}interpolate(e,i,a){if("constant"!==e.value.kind||"constant"!==i.value.kind)return e;if(void 0===e.value.value||void 0===i.value.value)return new Ye(this,{kind:"constant",value:void 0},e.parameters);const u=zi[this.specification.type];return u?new Ye(this,{kind:"constant",value:u(e.value.value,i.value.value,a)},e.parameters):e}evaluate(e,i,a,u,f,_){return"constant"===e.kind?e.value:e.evaluate(i,a,u,f,_)}}class pt{constructor(e){this.specification=e}possiblyEvaluate(e,i,a,u){return!!e.expression.evaluate(i,null,{},a,u)}interpolate(){return!1}}class ht{constructor(e){this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const i=new N(0,{});for(const a in e){const u=e[a];u.specification.overridable&&this.overridableProperties.push(a);const f=this.defaultPropertyValues[a]=new H(u,void 0),_=this.defaultTransitionablePropertyValues[a]=new $(u);this.defaultTransitioningPropertyValues[a]=_.untransitioned(),this.defaultPossiblyEvaluatedValues[a]=f.possiblyEvaluate(i)}}}function Ot(t,e){return 256*(t=ve(Math.floor(t),0,255))+ve(Math.floor(e),0,255)}ui($e,"DataDrivenProperty"),ui(ue,"DataConstantProperty"),ui(pt,"ColorRampProperty");const kt={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Rt{constructor(e,i){this._structArray=e,this._pos1=i*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Yt{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(e,i){return e._trim(),i&&(e.isTransferred=!0,i.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}}static deserialize(e){const i=Object.create(this.prototype);return i.arrayBuffer=e.arrayBuffer,i.length=e.length,i.capacity=e.arrayBuffer.byteLength/i.bytesPerElement,i._refreshViews(),i}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(e){this.reserve(e),this.length=e}reserve(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const i=this.uint8;this._refreshViews(),i&&this.uint8.set(i)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function $t(t,e=1){let i=0,a=0;return{members:t.map(u=>{const f=kt[u.type].BYTES_PER_ELEMENT,_=i=ln(i,Math.max(e,f)),w=u.components||1;return a=Math.max(a,f),i+=f*w,{name:u.name,type:u.type,components:w,offset:_}}),size:ln(i,Math.max(a,e)),alignment:e}}function ln(t,e){return Math.ceil(t/e)*e}class Gn extends Yt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i){const a=this.length;return this.resize(a+1),this.emplace(a,e,i)}emplace(e,i,a){const u=2*e;return this.int16[u+0]=i,this.int16[u+1]=a,e}}Gn.prototype.bytesPerElement=4,ui(Gn,"StructArrayLayout2i4");class on extends Yt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,a){const u=this.length;return this.resize(u+1),this.emplace(u,e,i,a)}emplace(e,i,a,u){const f=3*e;return this.int16[f+0]=i,this.int16[f+1]=a,this.int16[f+2]=u,e}}on.prototype.bytesPerElement=6,ui(on,"StructArrayLayout3i6");class An extends Yt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,a,u){const f=this.length;return this.resize(f+1),this.emplace(f,e,i,a,u)}emplace(e,i,a,u,f){const _=4*e;return this.int16[_+0]=i,this.int16[_+1]=a,this.int16[_+2]=u,this.int16[_+3]=f,e}}An.prototype.bytesPerElement=8,ui(An,"StructArrayLayout4i8");class hn extends Yt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,a,u,f,_,w){const E=this.length;return this.resize(E+1),this.emplace(E,e,i,a,u,f,_,w)}emplace(e,i,a,u,f,_,w,E){const D=6*e,k=12*e,z=3*e;return this.int16[D+0]=i,this.int16[D+1]=a,this.uint8[k+4]=u,this.uint8[k+5]=f,this.uint8[k+6]=_,this.uint8[k+7]=w,this.float32[z+2]=E,e}}hn.prototype.bytesPerElement=12,ui(hn,"StructArrayLayout2i4ub1f12");class jn extends Yt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,a,u){const f=this.length;return this.resize(f+1),this.emplace(f,e,i,a,u)}emplace(e,i,a,u,f){const _=4*e;return this.float32[_+0]=i,this.float32[_+1]=a,this.float32[_+2]=u,this.float32[_+3]=f,e}}jn.prototype.bytesPerElement=16,ui(jn,"StructArrayLayout4f16");class cn extends Yt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,a,u,f){const _=this.length;return this.resize(_+1),this.emplace(_,e,i,a,u,f)}emplace(e,i,a,u,f,_){const w=6*e,E=3*e;return this.uint16[w+0]=i,this.uint16[w+1]=a,this.uint16[w+2]=u,this.uint16[w+3]=f,this.float32[E+2]=_,e}}cn.prototype.bytesPerElement=12,ui(cn,"StructArrayLayout4ui1f12");class Mn extends Yt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,a,u){const f=this.length;return this.resize(f+1),this.emplace(f,e,i,a,u)}emplace(e,i,a,u,f){const _=4*e;return this.uint16[_+0]=i,this.uint16[_+1]=a,this.uint16[_+2]=u,this.uint16[_+3]=f,e}}Mn.prototype.bytesPerElement=8,ui(Mn,"StructArrayLayout4ui8");class Vn extends Yt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,a,u,f,_){const w=this.length;return this.resize(w+1),this.emplace(w,e,i,a,u,f,_)}emplace(e,i,a,u,f,_,w){const E=6*e;return this.int16[E+0]=i,this.int16[E+1]=a,this.int16[E+2]=u,this.int16[E+3]=f,this.int16[E+4]=_,this.int16[E+5]=w,e}}Vn.prototype.bytesPerElement=12,ui(Vn,"StructArrayLayout6i12");class Bn extends Yt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,a,u,f,_,w,E,D,k,z,j){const K=this.length;return this.resize(K+1),this.emplace(K,e,i,a,u,f,_,w,E,D,k,z,j)}emplace(e,i,a,u,f,_,w,E,D,k,z,j,K){const te=12*e;return this.int16[te+0]=i,this.int16[te+1]=a,this.int16[te+2]=u,this.int16[te+3]=f,this.uint16[te+4]=_,this.uint16[te+5]=w,this.uint16[te+6]=E,this.uint16[te+7]=D,this.int16[te+8]=k,this.int16[te+9]=z,this.int16[te+10]=j,this.int16[te+11]=K,e}}Bn.prototype.bytesPerElement=24,ui(Bn,"StructArrayLayout4i4ui4i24");class qn extends Yt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,a,u,f,_){const w=this.length;return this.resize(w+1),this.emplace(w,e,i,a,u,f,_)}emplace(e,i,a,u,f,_,w){const E=10*e,D=5*e;return this.int16[E+0]=i,this.int16[E+1]=a,this.int16[E+2]=u,this.float32[D+2]=f,this.float32[D+3]=_,this.float32[D+4]=w,e}}qn.prototype.bytesPerElement=20,ui(qn,"StructArrayLayout3i3f20");class Ti extends Yt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e){const i=this.length;return this.resize(i+1),this.emplace(i,e)}emplace(e,i){return this.uint32[1*e+0]=i,e}}Ti.prototype.bytesPerElement=4,ui(Ti,"StructArrayLayout1ul4");class Vi extends Yt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,a,u,f,_,w,E,D,k,z,j,K){const te=this.length;return this.resize(te+1),this.emplace(te,e,i,a,u,f,_,w,E,D,k,z,j,K)}emplace(e,i,a,u,f,_,w,E,D,k,z,j,K,te){const he=20*e,Oe=10*e;return this.int16[he+0]=i,this.int16[he+1]=a,this.int16[he+2]=u,this.int16[he+3]=f,this.int16[he+4]=_,this.float32[Oe+3]=w,this.float32[Oe+4]=E,this.float32[Oe+5]=D,this.float32[Oe+6]=k,this.int16[he+14]=z,this.uint32[Oe+8]=j,this.uint16[he+18]=K,this.uint16[he+19]=te,e}}Vi.prototype.bytesPerElement=40,ui(Vi,"StructArrayLayout5i4f1i1ul2ui40");class _i extends Yt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,a,u,f,_,w){const E=this.length;return this.resize(E+1),this.emplace(E,e,i,a,u,f,_,w)}emplace(e,i,a,u,f,_,w,E){const D=8*e;return this.int16[D+0]=i,this.int16[D+1]=a,this.int16[D+2]=u,this.int16[D+4]=f,this.int16[D+5]=_,this.int16[D+6]=w,this.int16[D+7]=E,e}}_i.prototype.bytesPerElement=16,ui(_i,"StructArrayLayout3i2i2i16");class Oi extends Yt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,a,u,f){const _=this.length;return this.resize(_+1),this.emplace(_,e,i,a,u,f)}emplace(e,i,a,u,f,_){const w=4*e,E=8*e;return this.float32[w+0]=i,this.float32[w+1]=a,this.float32[w+2]=u,this.int16[E+6]=f,this.int16[E+7]=_,e}}Oi.prototype.bytesPerElement=16,ui(Oi,"StructArrayLayout2f1f2i16");class po extends Yt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,a,u){const f=this.length;return this.resize(f+1),this.emplace(f,e,i,a,u)}emplace(e,i,a,u,f){const _=12*e,w=3*e;return this.uint8[_+0]=i,this.uint8[_+1]=a,this.float32[w+1]=u,this.float32[w+2]=f,e}}po.prototype.bytesPerElement=12,ui(po,"StructArrayLayout2ub2f12");class mo extends Yt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,a){const u=this.length;return this.resize(u+1),this.emplace(u,e,i,a)}emplace(e,i,a,u){const f=3*e;return this.float32[f+0]=i,this.float32[f+1]=a,this.float32[f+2]=u,e}}mo.prototype.bytesPerElement=12,ui(mo,"StructArrayLayout3f12");class bi extends Yt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,a){const u=this.length;return this.resize(u+1),this.emplace(u,e,i,a)}emplace(e,i,a,u){const f=3*e;return this.uint16[f+0]=i,this.uint16[f+1]=a,this.uint16[f+2]=u,e}}bi.prototype.bytesPerElement=6,ui(bi,"StructArrayLayout3ui6");class Fo extends Yt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e,i,a,u,f,_,w,E,D,k,z,j,K,te,he,Oe,ot,Ct,at,wt,At){const It=this.length;return this.resize(It+1),this.emplace(It,e,i,a,u,f,_,w,E,D,k,z,j,K,te,he,Oe,ot,Ct,at,wt,At)}emplace(e,i,a,u,f,_,w,E,D,k,z,j,K,te,he,Oe,ot,Ct,at,wt,At,It){const un=30*e,rn=15*e,En=60*e;return this.int16[un+0]=i,this.int16[un+1]=a,this.int16[un+2]=u,this.float32[rn+2]=f,this.float32[rn+3]=_,this.uint16[un+8]=w,this.uint16[un+9]=E,this.uint32[rn+5]=D,this.uint32[rn+6]=k,this.uint32[rn+7]=z,this.uint16[un+16]=j,this.uint16[un+17]=K,this.uint16[un+18]=te,this.float32[rn+10]=he,this.float32[rn+11]=Oe,this.uint8[En+48]=ot,this.uint8[En+49]=Ct,this.uint8[En+50]=at,this.uint32[rn+13]=wt,this.int16[un+28]=At,this.uint8[En+58]=It,e}}Fo.prototype.bytesPerElement=60,ui(Fo,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class Bo extends Yt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e,i,a,u,f,_,w,E,D,k,z,j,K,te,he,Oe,ot,Ct,at,wt,At,It,un,rn,En,$n,fn,kn,Fn,Zn){const Yn=this.length;return this.resize(Yn+1),this.emplace(Yn,e,i,a,u,f,_,w,E,D,k,z,j,K,te,he,Oe,ot,Ct,at,wt,At,It,un,rn,En,$n,fn,kn,Fn,Zn)}emplace(e,i,a,u,f,_,w,E,D,k,z,j,K,te,he,Oe,ot,Ct,at,wt,At,It,un,rn,En,$n,fn,kn,Fn,Zn,Yn){const Tn=38*e,si=19*e;return this.int16[Tn+0]=i,this.int16[Tn+1]=a,this.int16[Tn+2]=u,this.float32[si+2]=f,this.float32[si+3]=_,this.int16[Tn+8]=w,this.int16[Tn+9]=E,this.int16[Tn+10]=D,this.int16[Tn+11]=k,this.int16[Tn+12]=z,this.int16[Tn+13]=j,this.uint16[Tn+14]=K,this.uint16[Tn+15]=te,this.uint16[Tn+16]=he,this.uint16[Tn+17]=Oe,this.uint16[Tn+18]=ot,this.uint16[Tn+19]=Ct,this.uint16[Tn+20]=at,this.uint16[Tn+21]=wt,this.uint16[Tn+22]=At,this.uint16[Tn+23]=It,this.uint16[Tn+24]=un,this.uint16[Tn+25]=rn,this.uint16[Tn+26]=En,this.uint16[Tn+27]=$n,this.uint16[Tn+28]=fn,this.uint32[si+15]=kn,this.float32[si+16]=Fn,this.float32[si+17]=Zn,this.float32[si+18]=Yn,e}}Bo.prototype.bytesPerElement=76,ui(Bo,"StructArrayLayout3i2f6i15ui1ul3f76");class No extends Yt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e){const i=this.length;return this.resize(i+1),this.emplace(i,e)}emplace(e,i){return this.float32[1*e+0]=i,e}}No.prototype.bytesPerElement=4,ui(No,"StructArrayLayout1f4");class zo extends Yt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,a,u,f){const _=this.length;return this.resize(_+1),this.emplace(_,e,i,a,u,f)}emplace(e,i,a,u,f,_){const w=5*e;return this.float32[w+0]=i,this.float32[w+1]=a,this.float32[w+2]=u,this.float32[w+3]=f,this.float32[w+4]=_,e}}zo.prototype.bytesPerElement=20,ui(zo,"StructArrayLayout5f20");class gs extends Yt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,a,u){const f=this.length;return this.resize(f+1),this.emplace(f,e,i,a,u)}emplace(e,i,a,u,f){const _=6*e;return this.uint32[3*e+0]=i,this.uint16[_+2]=a,this.uint16[_+3]=u,this.uint16[_+4]=f,e}}gs.prototype.bytesPerElement=12,ui(gs,"StructArrayLayout1ul3ui12");class Yr extends Yt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i){const a=this.length;return this.resize(a+1),this.emplace(a,e,i)}emplace(e,i,a){const u=2*e;return this.uint16[u+0]=i,this.uint16[u+1]=a,e}}Yr.prototype.bytesPerElement=4,ui(Yr,"StructArrayLayout2ui4");class _s extends Yt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e){const i=this.length;return this.resize(i+1),this.emplace(i,e)}emplace(e,i){return this.uint16[1*e+0]=i,e}}_s.prototype.bytesPerElement=2,ui(_s,"StructArrayLayout1ui2");class Qa extends Yt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i){const a=this.length;return this.resize(a+1),this.emplace(a,e,i)}emplace(e,i,a){const u=2*e;return this.float32[u+0]=i,this.float32[u+1]=a,e}}Qa.prototype.bytesPerElement=8,ui(Qa,"StructArrayLayout2f8");class yr extends Rt{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}yr.prototype.size=40;class ar extends Vi{get(e){return new yr(this,e)}}ui(ar,"CollisionBoxArray");class Uo extends Rt{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(e){this._structArray.uint8[this._pos1+49]=e}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(e){this._structArray.uint8[this._pos1+50]=e}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(e){this._structArray.uint32[this._pos4+13]=e}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(e){this._structArray.uint8[this._pos1+58]=e}}Uo.prototype.size=60;class Jr extends Fo{get(e){return new Uo(this,e)}}ui(Jr,"PlacedSymbolArray");class Ys extends Rt{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+11]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+13]}get key(){return this._structArray.uint16[this._pos2+14]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+17]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+19]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+21]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+22]}get featureIndex(){return this._structArray.uint16[this._pos2+23]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+25]}get numIconVertices(){return this._structArray.uint16[this._pos2+26]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+27]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+28]}get crossTileID(){return this._structArray.uint32[this._pos4+15]}set crossTileID(e){this._structArray.uint32[this._pos4+15]=e}get textOffset0(){return this._structArray.float32[this._pos4+16]}get textOffset1(){return this._structArray.float32[this._pos4+17]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+18]}}Ys.prototype.size=76;class vr extends Bo{get(e){return new Ys(this,e)}}ui(vr,"SymbolInstanceArray");class la extends No{getoffsetX(e){return this.float32[1*e+0]}}ui(la,"GlyphOffsetArray");class xl extends Gn{getx(e){return this.int16[2*e+0]}gety(e){return this.int16[2*e+1]}}ui(xl,"SymbolLineVertexArray");class gc extends Rt{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}gc.prototype.size=12;class bu extends gs{get(e){return new gc(this,e)}}ui(bu,"FeatureIndexArray");class mr extends Yr{geta_centroid_pos0(e){return this.uint16[2*e+0]}geta_centroid_pos1(e){return this.uint16[2*e+1]}}ui(mr,"FillExtrusionCentroidArray");const bl=$t([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),Sa=$t([{name:"a_dash",components:4,type:"Uint16"}]);var wu={exports:{}},yd=function(t,e){var i,a,u,f,_,w,E,D;for(a=t.length-(i=3&t.length),u=e,_=3432918353,w=461845907,D=0;D<a;)E=255&t.charCodeAt(D)|(255&t.charCodeAt(++D))<<8|(255&t.charCodeAt(++D))<<16|(255&t.charCodeAt(++D))<<24,++D,u=27492+(65535&(f=5*(65535&(u=(u^=E=(65535&(E=(E=(65535&E)*_+(((E>>>16)*_&65535)<<16)&4294967295)<<15|E>>>17))*w+(((E>>>16)*w&65535)<<16)&4294967295)<<13|u>>>19))+((5*(u>>>16)&65535)<<16)&4294967295))+((58964+(f>>>16)&65535)<<16);switch(E=0,i){case 3:E^=(255&t.charCodeAt(D+2))<<16;case 2:E^=(255&t.charCodeAt(D+1))<<8;case 1:u^=E=(65535&(E=(E=(65535&(E^=255&t.charCodeAt(D)))*_+(((E>>>16)*_&65535)<<16)&4294967295)<<15|E>>>17))*w+(((E>>>16)*w&65535)<<16)&4294967295}return u^=t.length,u=2246822507*(65535&(u^=u>>>16))+((2246822507*(u>>>16)&65535)<<16)&4294967295,u=3266489909*(65535&(u^=u>>>13))+((3266489909*(u>>>16)&65535)<<16)&4294967295,(u^=u>>>16)>>>0},vd=function(t,e){for(var i,a=t.length,u=e^a,f=0;a>=4;)i=1540483477*(65535&(i=255&t.charCodeAt(f)|(255&t.charCodeAt(++f))<<8|(255&t.charCodeAt(++f))<<16|(255&t.charCodeAt(++f))<<24))+((1540483477*(i>>>16)&65535)<<16),u=1540483477*(65535&u)+((1540483477*(u>>>16)&65535)<<16)^(i=1540483477*(65535&(i^=i>>>24))+((1540483477*(i>>>16)&65535)<<16)),a-=4,++f;switch(a){case 3:u^=(255&t.charCodeAt(f+2))<<16;case 2:u^=(255&t.charCodeAt(f+1))<<8;case 1:u=1540483477*(65535&(u^=255&t.charCodeAt(f)))+((1540483477*(u>>>16)&65535)<<16)}return u=1540483477*(65535&(u^=u>>>13))+((1540483477*(u>>>16)&65535)<<16),(u^=u>>>15)>>>0};wu.exports=yd,wu.exports.murmur3=yd,wu.exports.murmur2=vd;var Up=be(wu.exports);class Zp{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(e,i,a,u){this.ids.push(vm(e)),this.positions.push(i,a,u)}getPositions(e){const i=vm(e);let a=0,u=this.ids.length-1;for(;a<u;){const _=a+u>>1;this.ids[_]>=i?u=_:a=_+1}const f=[];for(;this.ids[a]===i;)f.push({index:this.positions[3*a],start:this.positions[3*a+1],end:this.positions[3*a+2]}),a++;return f}static serialize(e,i){const a=new Float64Array(e.ids),u=new Uint32Array(e.positions);return xm(a,u,0,a.length-1),i&&i.push(a.buffer,u.buffer),{ids:a,positions:u}}static deserialize(e){const i=new Zp;return i.ids=e.ids,i.positions=e.positions,i.indexed=!0,i}}function vm(t){const e=+t;return!isNaN(e)&&Number.MIN_SAFE_INTEGER<=e&&e<=Number.MAX_SAFE_INTEGER?e:Up(String(t))}function xm(t,e,i,a){for(;i<a;){const u=t[i+a>>1];let f=i-1,_=a+1;for(;;){do{f++}while(t[f]<u);do{_--}while(t[_]>u);if(f>=_)break;Js(t,f,_),Js(e,3*f,3*_),Js(e,3*f+1,3*_+1),Js(e,3*f+2,3*_+2)}_-i<a-_?(xm(t,e,i,_),i=_+1):(xm(t,e,_+1,a),a=_)}}function Js(t,e,i){const a=t[e];t[e]=t[i],t[i]=a}ui(Zp,"FeaturePositionMap");class el{constructor(e){this.gl=e.gl,this.initialized=!1}fetchUniformLocation(e,i){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(e,i),this.initialized=!0),!!this.location}}class Wl extends el{constructor(e){super(e),this.current=0}set(e,i,a){this.fetchUniformLocation(e,i)&&this.current!==a&&(this.current=a,this.gl.uniform1f(this.location,a))}}class a_ extends el{constructor(e){super(e),this.current=[0,0,0,0]}set(e,i,a){this.fetchUniformLocation(e,i)&&(a[0]===this.current[0]&&a[1]===this.current[1]&&a[2]===this.current[2]&&a[3]===this.current[3]||(this.current=a,this.gl.uniform4f(this.location,a[0],a[1],a[2],a[3])))}}class Vp extends el{constructor(e){super(e),this.current=Co.transparent}set(e,i,a){this.fetchUniformLocation(e,i)&&(a.r===this.current.r&&a.g===this.current.g&&a.b===this.current.b&&a.a===this.current.a||(this.current=a,this.gl.uniform4f(this.location,a.r,a.g,a.b,a.a)))}}const l_=new Float32Array(16),c_=new Float32Array(9),u_=new Float32Array(4);function jp(t){return[Ot(255*t.r,255*t.g),Ot(255*t.b,255*t.a)]}class xd{constructor(e,i,a){this.value=e,this.uniformNames=i.map(u=>`u_${u}`),this.type=a}setUniform(e,i,a,u,f){i.set(e,f,u.constantOr(this.value))}getBinding(e,i){return"color"===this.type?new Vp(e):new Wl(e)}}class Cu{constructor(e,i){this.uniformNames=i.map(a=>`u_${a}`),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(e){this.pixelRatio=e.pixelRatio||1,this.pattern=e.tl.concat(e.br)}setUniform(e,i,a,u,f){const _="u_pattern"===f||"u_dash"===f?this.pattern:"u_pixel_ratio"===f?this.pixelRatio:null;_&&i.set(e,f,_)}getBinding(e,i){return"u_pattern"===i||"u_dash"===i?new a_(e):new Wl(e)}}class tl{constructor(e,i,a,u){this.expression=e,this.type=a,this.maxValue=0,this.paintVertexAttributes=i.map(f=>({name:`a_${f}`,type:"Float32",components:"color"===a?2:1,offset:0})),this.paintVertexArray=new u}populatePaintArray(e,i,a,u,f,_){const w=this.paintVertexArray.length,E=this.expression.evaluate(new N(0),i,{},f,u,_);this.paintVertexArray.resize(e),this._setPaintValue(w,e,E)}updatePaintArray(e,i,a,u,f){const _=this.expression.evaluate({zoom:0},a,u,void 0,f);this._setPaintValue(e,i,_)}_setPaintValue(e,i,a){if("color"===this.type){const u=jp(a);for(let f=e;f<i;f++)this.paintVertexArray.emplace(f,u[0],u[1])}else{for(let u=e;u<i;u++)this.paintVertexArray.emplace(u,a);this.maxValue=Math.max(this.maxValue,Math.abs(a))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class ya{constructor(e,i,a,u,f,_){this.expression=e,this.uniformNames=i.map(w=>`u_${w}_t`),this.type=a,this.useIntegerZoom=u,this.zoom=f,this.maxValue=0,this.paintVertexAttributes=i.map(w=>({name:`a_${w}`,type:"Float32",components:"color"===a?4:2,offset:0})),this.paintVertexArray=new _}populatePaintArray(e,i,a,u,f,_){const w=this.expression.evaluate(new N(this.zoom),i,{},f,u,_),E=this.expression.evaluate(new N(this.zoom+1),i,{},f,u,_),D=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(D,e,w,E)}updatePaintArray(e,i,a,u,f){const _=this.expression.evaluate({zoom:this.zoom},a,u,void 0,f),w=this.expression.evaluate({zoom:this.zoom+1},a,u,void 0,f);this._setPaintValue(e,i,_,w)}_setPaintValue(e,i,a,u){if("color"===this.type){const f=jp(a),_=jp(u);for(let w=e;w<i;w++)this.paintVertexArray.emplace(w,f[0],f[1],_[0],_[1])}else{for(let f=e;f<i;f++)this.paintVertexArray.emplace(f,a,u);this.maxValue=Math.max(this.maxValue,Math.abs(a),Math.abs(u))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(e,i,a,u,f){const _=this.useIntegerZoom?Math.floor(a.zoom):a.zoom,w=ve(this.expression.interpolationFactor(_,this.zoom,this.zoom+1),0,1);i.set(e,f,w)}getBinding(e,i){return new Wl(e)}}class _c{constructor(e,i,a,u,f){this.expression=e,this.layerId=f,this.paintVertexAttributes=("array"===a?Sa:bl).members;for(let _=0;_<i.length;++_);this.paintVertexArray=new u}populatePaintArray(e,i,a){const u=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValues(u,e,i.patterns&&i.patterns[this.layerId],a)}updatePaintArray(e,i,a,u,f,_){this._setPaintValues(e,i,a.patterns&&a.patterns[this.layerId],_)}_setPaintValues(e,i,a,u){if(!u||!a)return;const f=u[a];if(!f)return;const{tl:_,br:w,pixelRatio:E}=f;for(let D=e;D<i;D++)this.paintVertexArray.emplace(D,_[0],_[1],w[0],w[1],E)}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class nl{constructor(e,i,a=(()=>!0)){this.binders={},this._buffers=[];const u=[];for(const f in e.paint._values){if(!a(f))continue;const _=e.paint.get(f);if(!(_ instanceof Ye&&Tt(_.property.specification)))continue;const w=d_(f,e.type),E=_.value,D=_.property.specification.type,k=!!_.property.useIntegerZoom,z="line-dasharray"===f||f.endsWith("pattern"),j="line-dasharray"===f&&"constant"!==e.layout.get("line-cap").value.kind;if("constant"!==E.kind||j)if("source"===E.kind||j||z){const K=bd(f,D,"source");this.binders[f]=z?new _c(E,w,D,K,e.id):new tl(E,w,D,K),u.push(`/a_${f}`)}else{const K=bd(f,D,"composite");this.binders[f]=new ya(E,w,D,k,i,K),u.push(`/z_${f}`)}else this.binders[f]=z?new Cu(E.value,w):new xd(E.value,w,D),u.push(`/u_${f}`)}this.cacheKey=u.sort().join("")}getMaxValue(e){const i=this.binders[e];return i instanceof tl||i instanceof ya?i.maxValue:0}populatePaintArrays(e,i,a,u,f,_){for(const w in this.binders){const E=this.binders[w];(E instanceof tl||E instanceof ya||E instanceof _c)&&E.populatePaintArray(e,i,a,u,f,_)}}setConstantPatternPositions(e){for(const i in this.binders){const a=this.binders[i];a instanceof Cu&&a.setConstantPatternPositions(e)}}updatePaintArrays(e,i,a,u,f,_){let w=!1;for(const E in e){const D=i.getPositions(E);for(const k of D){const z=a.feature(k.index);for(const j in this.binders){const K=this.binders[j];if((K instanceof tl||K instanceof ya||K instanceof _c)&&!0===K.expression.isStateDependent){const te=u.paint.get(j);K.expression=te.value,K.updatePaintArray(k.start,k.end,z,e[E],f,_),w=!0}}}}return w}defines(){const e=[];for(const i in this.binders){const a=this.binders[i];(a instanceof xd||a instanceof Cu)&&e.push(...a.uniformNames.map(u=>`#define HAS_UNIFORM_${u}`))}return e}getBinderAttributes(){const e=[];for(const i in this.binders){const a=this.binders[i];if(a instanceof tl||a instanceof ya||a instanceof _c)for(let u=0;u<a.paintVertexAttributes.length;u++)e.push(a.paintVertexAttributes[u].name)}return e}getBinderUniforms(){const e=[];for(const i in this.binders){const a=this.binders[i];if(a instanceof xd||a instanceof Cu||a instanceof ya)for(const u of a.uniformNames)e.push(u)}return e}getPaintVertexBuffers(){return this._buffers}getUniforms(e){const i=[];for(const a in this.binders){const u=this.binders[a];if(u instanceof xd||u instanceof Cu||u instanceof ya)for(const f of u.uniformNames)i.push({name:f,property:a,binding:u.getBinding(e,f)})}return i}setUniforms(e,i,a,u,f){for(const{name:_,property:w,binding:E}of a)this.binders[w].setUniform(e,E,f,u.get(w),_)}updatePaintBuffers(){this._buffers=[];for(const e in this.binders){const i=this.binders[e];(i instanceof tl||i instanceof ya||i instanceof _c)&&i.paintVertexBuffer&&this._buffers.push(i.paintVertexBuffer)}}upload(e){for(const i in this.binders){const a=this.binders[i];(a instanceof tl||a instanceof ya||a instanceof _c)&&a.upload(e)}this.updatePaintBuffers()}destroy(){for(const e in this.binders){const i=this.binders[e];(i instanceof tl||i instanceof ya||i instanceof _c)&&i.destroy()}}}class Yc{constructor(e,i,a=(()=>!0)){this.programConfigurations={};for(const u of e)this.programConfigurations[u.id]=new nl(u,i,a);this.needsUpload=!1,this._featureMap=new Zp,this._bufferOffset=0}populatePaintArrays(e,i,a,u,f,_,w){for(const E in this.programConfigurations)this.programConfigurations[E].populatePaintArrays(e,i,u,f,_,w);void 0!==i.id&&this._featureMap.add(i.id,a,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0}updatePaintArrays(e,i,a,u,f){for(const _ of a)this.needsUpload=this.programConfigurations[_.id].updatePaintArrays(e,this._featureMap,i,_,u,f)||this.needsUpload}get(e){return this.programConfigurations[e]}upload(e){if(this.needsUpload){for(const i in this.programConfigurations)this.programConfigurations[i].upload(e);this.needsUpload=!1}}destroy(){for(const e in this.programConfigurations)this.programConfigurations[e].destroy()}}const yh={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function d_(t,e){return yh[t]||[t.replace(`${e}-`,"").replace(/-/g,"_")]}const bm={"line-pattern":{source:cn,composite:cn},"fill-pattern":{source:cn,composite:cn},"fill-extrusion-pattern":{source:cn,composite:cn},"line-dasharray":{source:Mn,composite:Mn}},$p={color:{source:Qa,composite:jn},number:{source:No,composite:Qa}};function bd(t,e,i){const a=bm[t];return a&&a[i]||$p[e][i]}ui(xd,"ConstantBinder"),ui(Cu,"PatternConstantBinder"),ui(tl,"SourceExpressionBinder"),ui(_c,"PatternCompositeBinder"),ui(ya,"CompositeExpressionBinder"),ui(nl,"ProgramConfiguration",{omit:["_buffers"]}),ui(Yc,"ProgramConfigurationSet");const Hp="-transition";class il extends ho{constructor(e,i){if(super(),this.id=e.id,this.type=e.type,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,"custom"!==e.type&&(this.metadata=e.metadata,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,"background"!==e.type&&"sky"!==e.type&&(this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter),i.layout&&(this._unevaluatedLayout=new Ke(i.layout)),i.paint)){this._transitionablePaint=new ce(i.paint);for(const a in e.paint)this.setPaintProperty(a,e.paint[a],{validate:!1});for(const a in e.layout)this.setLayoutProperty(a,e.layout[a],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new nt(i.paint)}}getLayoutProperty(e){return"visibility"===e?this.visibility:this._unevaluatedLayout.getValue(e)}setLayoutProperty(e,i,a={}){null!=i&&this._validate(yu,`layers.${this.id}.layout.${e}`,e,i,a)||("visibility"!==e?this._unevaluatedLayout.setValue(e,i):this.visibility=i)}getPaintProperty(e){return wn(e,Hp)?this._transitionablePaint.getTransition(e.slice(0,-11)):this._transitionablePaint.getValue(e)}setPaintProperty(e,i,a={}){if(null!=i&&this._validate(Wc,`layers.${this.id}.paint.${e}`,e,i,a))return!1;if(wn(e,Hp))return this._transitionablePaint.setTransition(e.slice(0,-11),i||void 0),!1;{const u=this._transitionablePaint._values[e],f=u.value.isDataDriven(),_=u.value;this._transitionablePaint.setValue(e,i),this._handleSpecialPaintPropertyUpdate(e);const w=this._transitionablePaint._values[e].value,E=w.isDataDriven(),D=wn(e,"pattern")||"line-dasharray"===e;return E||f||D||this._handleOverridablePaintPropertyUpdate(e,_,w)}}_handleSpecialPaintPropertyUpdate(e){}getProgramIds(){return null}getProgramConfiguration(e){return null}_handleOverridablePaintPropertyUpdate(e,i,a){return!1}isHidden(e){return!!(this.minzoom&&e<this.minzoom)||!!(this.maxzoom&&e>=this.maxzoom)||"none"===this.visibility}updateTransitions(e){this._transitioningPaint=this._transitionablePaint.transitioned(e,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(e,i){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(e,void 0,i)),this.paint=this._transitioningPaint.possiblyEvaluate(e,void 0,i)}serialize(){const e={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(e.layout=e.layout||{},e.layout.visibility=this.visibility),mn(e,(i,a)=>!(void 0===i||"layout"===a&&!Object.keys(i).length||"paint"===a&&!Object.keys(i).length))}_validate(e,i,a,u,f={}){return(!f||!1!==f.validate)&&qc(this,e.call(Gc,{key:i,layerType:this.type,objectKey:a,value:u,styleSpec:tn,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const e in this.paint._values){const i=this.paint.get(e);if(i instanceof Ye&&Tt(i.property.specification)&&("source"===i.value.kind||"composite"===i.value.kind)&&i.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=dc(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}}const h_=$t([{name:"a_pos",components:2,type:"Int16"}],4),Tu=$t([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class Tr{constructor(e=[]){this.segments=e}prepareSegment(e,i,a,u){let f=this.segments[this.segments.length-1];return e>Tr.MAX_VERTEX_ARRAY_LENGTH&&St(`Max vertices per segment is ${Tr.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${e}`),(!f||f.vertexLength+e>Tr.MAX_VERTEX_ARRAY_LENGTH||f.sortKey!==u)&&(f={vertexOffset:i.length,primitiveOffset:a.length,vertexLength:0,primitiveLength:0},void 0!==u&&(f.sortKey=u),this.segments.push(f)),f}get(){return this.segments}destroy(){for(const e of this.segments)for(const i in e.vaos)e.vaos[i].destroy()}static simpleSegment(e,i,a,u){return new Tr([{vertexOffset:e,primitiveOffset:i,vertexLength:a,primitiveLength:u,vaos:{},sortKey:0}])}}Tr.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,ui(Tr,"SegmentVector");var Pi=8192;class Jc{constructor(e,i){e&&(i?this.setSouthWest(e).setNorthEast(i):4===e.length?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1]))}setNorthEast(e){return this._ne=e instanceof tr?new tr(e.lng,e.lat):tr.convert(e),this}setSouthWest(e){return this._sw=e instanceof tr?new tr(e.lng,e.lat):tr.convert(e),this}extend(e){const i=this._sw,a=this._ne;let u,f;if(e instanceof tr)u=e,f=e;else{if(!(e instanceof Jc))return Array.isArray(e)?4===e.length||e.every(Array.isArray)?this.extend(Jc.convert(e)):this.extend(tr.convert(e)):"object"==typeof e&&null!==e&&e.hasOwnProperty("lat")&&(e.hasOwnProperty("lon")||e.hasOwnProperty("lng"))?this.extend(tr.convert(e)):this;if(u=e._sw,f=e._ne,!u||!f)return this}return i||a?(i.lng=Math.min(u.lng,i.lng),i.lat=Math.min(u.lat,i.lat),a.lng=Math.max(f.lng,a.lng),a.lat=Math.max(f.lat,a.lat)):(this._sw=new tr(u.lng,u.lat),this._ne=new tr(f.lng,f.lat)),this}getCenter(){return new tr((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new tr(this.getWest(),this.getNorth())}getSouthEast(){return new tr(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(e){const{lng:i,lat:a}=tr.convert(e);let u=this._sw.lng<=i&&i<=this._ne.lng;return this._sw.lng>this._ne.lng&&(u=this._sw.lng>=i&&i>=this._ne.lng),this._sw.lat<=a&&a<=this._ne.lat&&u}static convert(e){return!e||e instanceof Jc?e:new Jc(e)}}var wd=1e-6,va=typeof Float32Array<"u"?Float32Array:Array;function p_(){var t=new va(9);return va!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function wm(t,e,i){var a=e[0],u=e[1],f=e[2],_=e[3],w=e[4],E=e[5],D=e[6],k=e[7],z=e[8],j=i[0],K=i[1],te=i[2],he=i[3],Oe=i[4],ot=i[5],Ct=i[6],at=i[7],wt=i[8];return t[0]=j*a+K*_+te*D,t[1]=j*u+K*w+te*k,t[2]=j*f+K*E+te*z,t[3]=he*a+Oe*_+ot*D,t[4]=he*u+Oe*w+ot*k,t[5]=he*f+Oe*E+ot*z,t[6]=Ct*a+at*_+wt*D,t[7]=Ct*u+at*w+wt*k,t[8]=Ct*f+at*E+wt*z,t}function ol(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Gp(t,e){var i=e[0],a=e[1],u=e[2],f=e[3],_=e[4],w=e[5],E=e[6],D=e[7],k=e[8],z=e[9],j=e[10],K=e[11],te=e[12],he=e[13],Oe=e[14],ot=e[15],Ct=i*w-a*_,at=i*E-u*_,wt=i*D-f*_,At=a*E-u*w,It=a*D-f*w,un=u*D-f*E,rn=k*he-z*te,En=k*Oe-j*te,$n=k*ot-K*te,fn=z*Oe-j*he,kn=z*ot-K*he,Fn=j*ot-K*Oe,Zn=Ct*Fn-at*kn+wt*fn+At*$n-It*En+un*rn;return Zn?(t[0]=(w*Fn-E*kn+D*fn)*(Zn=1/Zn),t[1]=(u*kn-a*Fn-f*fn)*Zn,t[2]=(he*un-Oe*It+ot*At)*Zn,t[3]=(j*It-z*un-K*At)*Zn,t[4]=(E*$n-_*Fn-D*En)*Zn,t[5]=(i*Fn-u*$n+f*En)*Zn,t[6]=(Oe*wt-te*un-ot*at)*Zn,t[7]=(k*un-j*wt+K*at)*Zn,t[8]=(_*kn-w*$n+D*rn)*Zn,t[9]=(a*$n-i*kn-f*rn)*Zn,t[10]=(te*It-he*wt+ot*Ct)*Zn,t[11]=(z*wt-k*It-K*Ct)*Zn,t[12]=(w*En-_*fn-E*rn)*Zn,t[13]=(i*fn-a*En+u*rn)*Zn,t[14]=(he*at-te*At-Oe*Ct)*Zn,t[15]=(k*At-z*at+j*Ct)*Zn,t):null}function wl(t,e,i){var a=e[0],u=e[1],f=e[2],_=e[3],w=e[4],E=e[5],D=e[6],k=e[7],z=e[8],j=e[9],K=e[10],te=e[11],he=e[12],Oe=e[13],ot=e[14],Ct=e[15],at=i[0],wt=i[1],At=i[2],It=i[3];return t[0]=at*a+wt*w+At*z+It*he,t[1]=at*u+wt*E+At*j+It*Oe,t[2]=at*f+wt*D+At*K+It*ot,t[3]=at*_+wt*k+At*te+It*Ct,t[4]=(at=i[4])*a+(wt=i[5])*w+(At=i[6])*z+(It=i[7])*he,t[5]=at*u+wt*E+At*j+It*Oe,t[6]=at*f+wt*D+At*K+It*ot,t[7]=at*_+wt*k+At*te+It*Ct,t[8]=(at=i[8])*a+(wt=i[9])*w+(At=i[10])*z+(It=i[11])*he,t[9]=at*u+wt*E+At*j+It*Oe,t[10]=at*f+wt*D+At*K+It*ot,t[11]=at*_+wt*k+At*te+It*Ct,t[12]=(at=i[12])*a+(wt=i[13])*w+(At=i[14])*z+(It=i[15])*he,t[13]=at*u+wt*E+At*j+It*Oe,t[14]=at*f+wt*D+At*K+It*ot,t[15]=at*_+wt*k+At*te+It*Ct,t}function Eu(t,e,i){var a,u,f,_,w,E,D,k,z,j,K,te,he=i[0],Oe=i[1],ot=i[2];return e===t?(t[12]=e[0]*he+e[4]*Oe+e[8]*ot+e[12],t[13]=e[1]*he+e[5]*Oe+e[9]*ot+e[13],t[14]=e[2]*he+e[6]*Oe+e[10]*ot+e[14],t[15]=e[3]*he+e[7]*Oe+e[11]*ot+e[15]):(u=e[1],f=e[2],_=e[3],w=e[4],E=e[5],D=e[6],k=e[7],z=e[8],j=e[9],K=e[10],te=e[11],t[0]=a=e[0],t[1]=u,t[2]=f,t[3]=_,t[4]=w,t[5]=E,t[6]=D,t[7]=k,t[8]=z,t[9]=j,t[10]=K,t[11]=te,t[12]=a*he+w*Oe+z*ot+e[12],t[13]=u*he+E*Oe+j*ot+e[13],t[14]=f*he+D*Oe+K*ot+e[14],t[15]=_*he+k*Oe+te*ot+e[15]),t}function Kc(t,e,i){var a=i[0],u=i[1],f=i[2];return t[0]=e[0]*a,t[1]=e[1]*a,t[2]=e[2]*a,t[3]=e[3]*a,t[4]=e[4]*u,t[5]=e[5]*u,t[6]=e[6]*u,t[7]=e[7]*u,t[8]=e[8]*f,t[9]=e[9]*f,t[10]=e[10]*f,t[11]=e[11]*f,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function vh(t,e,i){var a=Math.sin(i),u=Math.cos(i),f=e[4],_=e[5],w=e[6],E=e[7],D=e[8],k=e[9],z=e[10],j=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=f*u+D*a,t[5]=_*u+k*a,t[6]=w*u+z*a,t[7]=E*u+j*a,t[8]=D*u-f*a,t[9]=k*u-_*a,t[10]=z*u-w*a,t[11]=j*u-E*a,t}function Wp(t,e,i){var a=Math.sin(i),u=Math.cos(i),f=e[0],_=e[1],w=e[2],E=e[3],D=e[8],k=e[9],z=e[10],j=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=f*u-D*a,t[1]=_*u-k*a,t[2]=w*u-z*a,t[3]=E*u-j*a,t[8]=f*a+D*u,t[9]=_*a+k*u,t[10]=w*a+z*u,t[11]=E*a+j*u,t}function qp(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function f_(t,e,i){var a,u,f,_=i[0],w=i[1],E=i[2],D=Math.hypot(_,w,E);return D<wd?null:(_*=D=1/D,w*=D,E*=D,a=Math.sin(e),u=Math.cos(e),t[0]=_*_*(f=1-u)+u,t[1]=w*_*f+E*a,t[2]=E*_*f-w*a,t[3]=0,t[4]=_*w*f-E*a,t[5]=w*w*f+u,t[6]=E*w*f+_*a,t[7]=0,t[8]=_*E*f+w*a,t[9]=w*E*f-_*a,t[10]=E*E*f+u,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)}Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});var m_=wl;function Yp(){var t=new va(3);return va!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function xh(t){var e=new va(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function bh(t){return Math.hypot(t[0],t[1],t[2])}function Cd(t,e,i){var a=new va(3);return a[0]=t,a[1]=e,a[2]=i,a}function rl(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],t}function Cm(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],t}function g_(t,e,i){return t[0]=e[0]*i[0],t[1]=e[1]*i[1],t[2]=e[2]*i[2],t}function wh(t,e,i){return t[0]=Math.min(e[0],i[0]),t[1]=Math.min(e[1],i[1]),t[2]=Math.min(e[2],i[2]),t}function Ch(t,e,i){return t[0]=Math.max(e[0],i[0]),t[1]=Math.max(e[1],i[1]),t[2]=Math.max(e[2],i[2]),t}function Ua(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t}function Td(t,e,i,a){return t[0]=e[0]+i[0]*a,t[1]=e[1]+i[1]*a,t[2]=e[2]+i[2]*a,t}function ys(t,e){var i=e[0],a=e[1],u=e[2],f=i*i+a*a+u*u;return f>0&&(f=1/Math.sqrt(f)),t[0]=e[0]*f,t[1]=e[1]*f,t[2]=e[2]*f,t}function xa(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function Th(t,e,i){var a=e[0],u=e[1],f=e[2],_=i[0],w=i[1],E=i[2];return t[0]=u*E-f*w,t[1]=f*_-a*E,t[2]=a*w-u*_,t}function zr(t,e,i){var a=e[0],u=e[1],f=e[2],_=i[3]*a+i[7]*u+i[11]*f+i[15];return t[0]=(i[0]*a+i[4]*u+i[8]*f+i[12])/(_=_||1),t[1]=(i[1]*a+i[5]*u+i[9]*f+i[13])/_,t[2]=(i[2]*a+i[6]*u+i[10]*f+i[14])/_,t}function Jp(t,e,i){var a=i[0],u=i[1],f=i[2],_=e[0],w=e[1],E=e[2],D=u*E-f*w,k=f*_-a*E,z=a*w-u*_,j=u*z-f*k,K=f*D-a*z,te=a*k-u*D,he=2*i[3];return k*=he,z*=he,K*=2,te*=2,t[0]=_+(D*=he)+(j*=2),t[1]=w+k+K,t[2]=E+z+te,t}var Cl,Za=Cm,Tm=g_,Eh=bh;function Ed(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t}function sl(t,e){var i=e[0],a=e[1],u=e[2],f=e[3],_=i*i+a*a+u*u+f*f;return _>0&&(_=1/Math.sqrt(_)),t[0]=i*_,t[1]=a*_,t[2]=u*_,t[3]=f*_,t}function Xc(t,e,i){var a=e[0],u=e[1],f=e[2],_=e[3];return t[0]=i[0]*a+i[4]*u+i[8]*f+i[12]*_,t[1]=i[1]*a+i[5]*u+i[9]*f+i[13]*_,t[2]=i[2]*a+i[6]*u+i[10]*f+i[14]*_,t[3]=i[3]*a+i[7]*u+i[11]*f+i[15]*_,t}function Em(){var t=new va(4);return va!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function Dm(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function Kp(t,e,i){i*=.5;var a=e[0],u=e[1],f=e[2],_=e[3],w=Math.sin(i),E=Math.cos(i);return t[0]=a*E+_*w,t[1]=u*E+f*w,t[2]=f*E-u*w,t[3]=_*E-a*w,t}function Dh(t,e,i){i*=.5;var a=e[0],u=e[1],f=e[2],_=e[3],w=Math.sin(i),E=Math.cos(i);return t[0]=a*E-f*w,t[1]=u*E+_*w,t[2]=f*E+a*w,t[3]=_*E-u*w,t}Yp(),Cl=new va(4),va!=Float32Array&&(Cl[0]=0,Cl[1]=0,Cl[2]=0,Cl[3]=0);var __=sl;Yp(),Cd(1,0,0),Cd(0,1,0),Em(),Em(),p_();const y_=$t([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:Mm}=y_,Xp=$t([{name:"a_pos_3",components:3,type:"Int16"}]);var Dd=$t([{name:"a_pos",type:"Int16",components:2}]);class Qp{constructor(e,i){this.pos=e,this.dir=i}intersectsPlane(e,i,a){const u=xa(i,this.dir);if(Math.abs(u)<1e-6)return!1;const f=((e[0]-this.pos[0])*i[0]+(e[1]-this.pos[1])*i[1]+(e[2]-this.pos[2])*i[2])/u;return a[0]=this.pos[0]+this.dir[0]*f,a[1]=this.pos[1]+this.dir[1]*f,a[2]=this.pos[2]+this.dir[2]*f,!0}closestPointOnSphere(e,i,a){if(he=(K=this.pos)[0],Oe=K[1],ot=K[2],Ct=(te=e)[0],at=te[1],wt=te[2],Math.abs(he-Ct)<=wd*Math.max(1,Math.abs(he),Math.abs(Ct))&&Math.abs(Oe-at)<=wd*Math.max(1,Math.abs(Oe),Math.abs(at))&&Math.abs(ot-wt)<=wd*Math.max(1,Math.abs(ot),Math.abs(wt))||0===i)return a[0]=a[1]=a[2]=0,!1;var K,te,he,Oe,ot,Ct,at,wt;const[u,f,_]=this.dir,w=this.pos[0]-e[0],E=this.pos[1]-e[1],D=this.pos[2]-e[2],k=u*u+f*f+_*_,z=2*(w*u+E*f+D*_),j=z*z-4*k*(w*w+E*E+D*D-i*i);if(j<0){const K=Math.max(-z/2,0),te=w+u*K,he=E+f*K,Oe=D+_*K,ot=Math.hypot(te,he,Oe);return a[0]=te*i/ot,a[1]=he*i/ot,a[2]=Oe*i/ot,!1}{const K=(-z-Math.sqrt(j))/(2*k);if(K<0){const te=Math.hypot(w,E,D);return a[0]=w*i/te,a[1]=E*i/te,a[2]=D*i/te,!1}return a[0]=w+u*K,a[1]=E+f*K,a[2]=D+_*K,!0}}}class Ks{constructor(e,i,a,u,f){this.TL=e,this.TR=i,this.BR=a,this.BL=u,this.horizon=f}static fromInvProjectionMatrix(e,i,a){const u=[-1,1,1],f=[1,1,1],_=[1,-1,1],w=[-1,-1,1],E=zr(u,u,e),D=zr(f,f,e),k=zr(_,_,e),z=zr(w,w,e);return new Ks(E,D,k,z,i/a)}}class Md{constructor(e,i){this.points=e,this.planes=i}static fromInvProjectionMatrix(e,i,a,u){const f=Math.pow(2,a),_=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(E=>{const D=Xc([],E,e),k=1/D[3]/i*f;return(z=D)[0]=(j=D)[0]*(K=[k,k,u?1/D[3]:k,k])[0],z[1]=j[1]*K[1],z[2]=j[2]*K[2],z[3]=j[3]*K[3],z;var z,j,K}),w=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(E=>{const D=ys([],Th([],Za([],_[E[0]],_[E[1]]),Za([],_[E[2]],_[E[1]]))),k=-xa(D,_[E[1]]);return D.concat(k)});return new Md(_,w)}}class zs{static fromPoints(e){const i=[1/0,1/0,1/0],a=[-1/0,-1/0,-1/0];for(const u of e)wh(i,i,u),Ch(a,a,u);return new zs(i,a)}static applyTransform(e,i){const a=e.getCorners();for(let u=0;u<a.length;++u)zr(a[u],a[u],i);return zs.fromPoints(a)}constructor(e,i){this.min=e,this.max=i,this.center=Ua([],rl([],this.min,this.max),.5)}quadrant(e){const i=[e%2==0,e<2],a=xh(this.min),u=xh(this.max);for(let f=0;f<i.length;f++)a[f]=i[f]?this.min[f]:this.center[f],u[f]=i[f]?this.center[f]:this.max[f];return u[2]=this.max[2],new zs(a,u)}distanceX(e){return Math.max(Math.min(this.max[0],e[0]),this.min[0])-e[0]}distanceY(e){return Math.max(Math.min(this.max[1],e[1]),this.min[1])-e[1]}distanceZ(e){return Math.max(Math.min(this.max[2],e[2]),this.min[2])-e[2]}getCorners(){const e=this.min,i=this.max;return[[e[0],e[1],e[2]],[i[0],e[1],e[2]],[i[0],i[1],e[2]],[e[0],i[1],e[2]],[e[0],e[1],i[2]],[i[0],e[1],i[2]],[i[0],i[1],i[2]],[e[0],i[1],i[2]]]}intersects(e){const i=this.getCorners();let a=!0;for(let u=0;u<e.planes.length;u++){const f=e.planes[u];let _=0;for(let w=0;w<i.length;w++)_+=xa(f,i[w])+f[3]>=0;if(0===_)return 0;_!==i.length&&(a=!1)}if(a)return 2;for(let u=0;u<3;u++){let f=Number.MAX_VALUE,_=-Number.MAX_VALUE;for(let w=0;w<e.points.length;w++){const E=e.points[w][u]-this.min[u];f=Math.min(f,E),_=Math.max(_,E)}if(_<0||f>this.max[u]-this.min[u])return 0}return 1}}const Id=5,Us=6,ba=Pi/Math.PI/2,Im=16383,Ad=[64,32,16],Pa=-ba,Va=ba,Am=[new zs([Pa,Pa,Pa],[Va,Va,Va]),new zs([Pa,Pa,Pa],[0,0,Va]),new zs([0,Pa,Pa],[Va,0,Va]),new zs([Pa,0,Pa],[0,Va,Va]),new zs([0,0,Pa],[Va,Va,Va])];function Mh(t){return t*ba/iu}function ef(t,e,i,a=!0){const u=Ua([],t._camera.position,t.worldSize),f=[e,i,1,1];Xc(f,f,t.pixelMatrixInverse),Ed(f,f,1/f[3]);const _=ys([],Za([],f,u)),w=t.globeMatrix,E=[w[12],w[13],w[14]],D=Za([],E,u),k=bh(D),z=ys([],D),j=t.worldSize/(2*Math.PI),K=xa(z,_),te=Math.asin(j/k);if(te<Math.acos(K)){if(!a)return null;const $n=[],fn=[];Ua($n,_,k/K),ys(fn,Za(fn,$n,D)),ys(_,rl(_,D,Ua(_,fn,Math.tan(te)*k)))}const he=[];new Qp(u,_).closestPointOnSphere(E,j,he);const Oe=ys([],Ci(w,0)),ot=ys([],Ci(w,1)),Ct=ys([],Ci(w,2)),at=xa(Oe,he),wt=xa(ot,he),At=xa(Ct,he),It=ae(Math.asin(-wt/j));let un=ae(Math.atan2(at,At));un=t.center.lng+function($n,fn){const kn=(fn-$n+180)%360-180;return kn<-180?kn+360:kn}(t.center.lng,un);const rn=$a(un),En=ve(al(It),0,1);return new Au(rn,En)}class v_{constructor(e,i,a){this.a=Za([],e,a),this.b=Za([],i,a),this.center=a;const u=ys([],this.a),f=ys([],this.b);this.angle=Math.acos(xa(u,f))}}function tf(t,e){if(0===t.angle)return null;let i;return i=0===t.a[e]?1/t.angle*.5*Math.PI:1/t.angle*Math.atan(t.b[e]/t.a[e]/Math.sin(t.angle)-1/Math.tan(t.angle)),i<0||i>1?null:function(a,u,f,_){const w=Math.sin(f);return a*(Math.sin((1-_)*f)/w)+u*(Math.sin(_*f)/w)}(t.a[e],t.b[e],t.angle,ve(i,0,1))+t.center[e]}function ja(t){if(t.z<=1)return Am[t.z+2*t.y+t.x];const e=Ah(Ih(t));return zs.fromPoints(e)}function ql(t,e,i){return Ua(t,t,1-i),Td(t,t,e,i)}function Sm(t,e){const i=Iu(e.zoom);if(0===i)return ja(t);const a=Ih(t),u=Ah(a),f=$a(a.getWest())*e.worldSize,_=$a(a.getEast())*e.worldSize,w=al(a.getNorth())*e.worldSize,E=al(a.getSouth())*e.worldSize,D=[f,w,0],k=[_,w,0],z=[f,E,0],j=[_,E,0],K=Gp([],e.globeMatrix);return zr(D,D,K),zr(k,k,K),zr(z,z,K),zr(j,j,K),u[0]=ql(u[0],z,i),u[1]=ql(u[1],j,i),u[2]=ql(u[2],k,i),u[3]=ql(u[3],D,i),zs.fromPoints(u)}function Du(t,e,i){for(const a of t)zr(a,a,e),Ua(a,a,i)}function Ih({x:t,y:e,z:i}){const a=1/(1<<i),u=new tr(wa(t*a),vs((e+1)*a)),f=new tr(wa((t+1)*a),vs(e*a));return new Jc(u,f)}function Ah(t){const e=Te(t.getNorth()),i=Te(t.getSouth()),a=Math.cos(e),u=Math.cos(i),f=Math.sin(e),_=Math.sin(i),w=t.getWest(),E=t.getEast();return[Qc(u,_,w),Qc(u,_,E),Qc(a,f,E),Qc(a,f,w)]}function Qc(t,e,i,a=ba){return i=Te(i),[t*Math.sin(i)*a,-e*a,t*Math.cos(i)*a]}function eu(t,e,i){return Qc(Math.cos(Te(t)),Math.sin(Te(t)),e,i)}function Tl(t,e,i,a){const u=1<<i.z,f=(t/Pi+i.x)/u;return eu(vs((e/Pi+i.y)/u),wa(f),a)}function tu({min:t,max:e}){return Im/Math.max(e[0]-t[0],e[1]-t[1],e[2]-t[2])}const nf=new Float64Array(16);function nu(t){const e=tu(t),i=qp(nf,[e,e,e]);return Eu(i,i,((a=[])[0]=-(u=t.min)[0],a[1]=-u[1],a[2]=-u[2],a));var a,u}function Mu(t){const e=(a=t.min,(i=nf)[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=1,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=1,i[11]=0,i[12]=a[0],i[13]=a[1],i[14]=a[2],i[15]=1,i);var i,a;const u=1/tu(t);return Kc(e,e,[u,u,u])}function Pm(t,e,i,a,u){const f=function(E){const D=Pi/(2*Math.PI);return E/(2*Math.PI)/D}(i),_=[t,e,-i/(2*Math.PI)],w=ol(new Float64Array(16));return Eu(w,w,_),Kc(w,w,[f,f,f]),vh(w,w,Te(-u)),Wp(w,w,Te(-a)),w}function Iu(t){return en(Id,Us,t)}function Om(t,e){const i=eu(e.lat,e.lng);return _=(u=Cm([],function(te){const he=eu(te._center.lat,te._center.lng);let Oe=Th([],Cd(0,1,0),he);const ot=f_([],-te.angle,he);Oe=zr(Oe,Oe,ot),f_(ot,-te._pitch,Oe);const Ct=ys([],he);return Ua(Ct,Ct,Mh(te.cameraToCenterDistance/te.pixelsPerMeter)),zr(Ct,Ct,ot),rl([],he,Ct)}(t),i))[0],w=u[1],E=u[2],D=(f=i)[0],k=f[1],z=f[2],K=(j=Math.sqrt(_*_+w*w+E*E)*Math.sqrt(D*D+k*k+z*z))&&xa(u,f)/j,Math.acos(Math.min(Math.max(K,-1),1));var u,f,_,w,E,D,k,z,j,K}function rf(t,e){return Om(t,e)>Math.PI/2*1.01}const Rm=Te(85),b_=Math.cos(Rm),Lm=Math.sin(Rm),iu=6371008.8,sf=2*Math.PI*iu;class El{constructor(e,i){if(isNaN(e)||isNaN(i))throw new Error(`Invalid LngLat object: (${e}, ${i})`);if(this.lng=+e,this.lat=+i,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new El(dt(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(e){const i=Math.PI/180,a=this.lat*i,u=e.lat*i,f=Math.sin(a)*Math.sin(u)+Math.cos(a)*Math.cos(u)*Math.cos((e.lng-this.lng)*i);return iu*Math.acos(Math.min(f,1))}toBounds(e=0){const i=360*e/40075017,a=i/Math.cos(Math.PI/180*this.lat);return new Jc(new El(this.lng-a,this.lat-i),new El(this.lng+a,this.lat+i))}toEcef(e){const i=Mh(e);return eu(this.lat,this.lng,ba+i)}static convert(e){if(e instanceof El)return e;if(Array.isArray(e)&&(2===e.length||3===e.length))return new El(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&"object"==typeof e&&null!==e)return new El(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}var tr=El;function af(t){return sf*Math.cos(t*Math.PI/180)}function $a(t){return(180+t)/360}function al(t){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t*Math.PI/360)))/360}function Zs(t,e){return t/af(e)}function wa(t){return 360*t-180}function vs(t){return 360/Math.PI*Math.atan(Math.exp((180-360*t)*Math.PI/180))-90}function km(t,e){return t*af(vs(e))}const Vs=85.051129;function Sd(t){return 1/Math.cos(t*Math.PI/180)}class Au{constructor(e,i,a=0){this.x=+e,this.y=+i,this.z=+a}static fromLngLat(e,i=0){const a=tr.convert(e);return new Au($a(a.lng),al(a.lat),Zs(i,a.lat))}toLngLat(){return new tr(wa(this.x),vs(this.y))}toAltitude(){return km(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/sf*Sd(vs(this.y))}}function Sh(t,e,i,a,u,f,_,w,E){const D=(e+a)/2,k=(i+u)/2,z=new Me(D,k);w(z),function(j,K,te,he,Oe,ot){const Ct=te-Oe,at=he-ot;return Math.abs((he-K)*Ct-(te-j)*at)/Math.hypot(Ct,at)}(z.x,z.y,f.x,f.y,_.x,_.y)>=E?(Sh(t,e,i,D,k,f,z,w,E),Sh(t,D,k,a,u,z,_,w,E)):t.push(_)}function lf(t,e,i){let a=t[0],u=a.x,f=a.y;e(a);const _=[a];for(let w=1;w<t.length;w++){const E=t[w],{x:D,y:k}=E;e(E),Sh(_,u,f,D,k,a,E,e,i),u=D,f=k,a=E}return _}function Ph(t,e,i,a){if(a(e,i)){const u=e.add(i)._mult(.5);Ph(t,e,u,a),Ph(t,u,i,a)}else t.push(i)}function cf(t,e){let i=t[0];const a=[i];for(let u=1;u<t.length;u++){const f=t[u];Ph(a,i,f,e),i=f}return a}const Oh=Math.pow(2,14)-1,Pd=-Oh-1;function Od(t,e){const i=Math.round(t.x*e),a=Math.round(t.y*e);return t.x=ve(i,Pd,Oh),t.y=ve(a,Pd,Oh),(i<t.x||i>t.x+1||a<t.y||a>t.y+1)&&St("Geometry exceeds allowed extent, reduce your vector tile buffer size"),t}function Dl(t,e,i){const a=t.loadGeometry(),u=t.extent,f=Pi/u;if(e&&i&&i.projection.isReprojectedInTileSpace){const _=1<<e.z,{scale:w,x:E,y:D,projection:k}=i,z=j=>{const K=wa((e.x+j.x/u)/_),te=vs((e.y+j.y/u)/_),he=k.project(K,te);j.x=(he.x*w-E)*u,j.y=(he.y*w-D)*u};for(let j=0;j<a.length;j++)if(1!==t.type)a[j]=lf(a[j],z,1);else{const K=[];for(const te of a[j])te.x<0||te.x>=u||te.y<0||te.y>=u||(z(te),K.push(te));a[j]=K}}for(const _ of a)for(const w of _)Od(w,f);return a}function Yl(t,e){return{type:t.type,id:t.id,properties:t.properties,geometry:e?Dl(t):[]}}function ou(t,e,i,a,u){t.emplaceBack(2*e+(a+1)/2,2*i+(u+1)/2)}function Rd(t,e,i){t.emplaceBack(e.x,e.y,e.z,16384*i[0],16384*i[1],16384*i[2])}class Ld{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(i=>i.id),this.index=e.index,this.hasPattern=!1,this.projection=e.projection,this.layoutVertexArray=new Gn,this.indexArray=new bi,this.segments=new Tr,this.programConfigurations=new Yc(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id)}populate(e,i,a,u){const f=this.layers[0],_=[];let w=null;"circle"===f.type&&(w=f.layout.get("circle-sort-key"));for(const{feature:D,id:k,index:z,sourceLayerIndex:j}of e){const K=this.layers[0]._featureFilter.needGeometry,te=Yl(D,K);if(!this.layers[0]._featureFilter.filter(new N(this.zoom),te,a))continue;const he=w?w.evaluate(te,{},a):void 0,Oe={id:k,properties:D.properties,type:D.type,sourceLayerIndex:j,index:z,geometry:K?te.geometry:Dl(D,a,u),patterns:{},sortKey:he};_.push(Oe)}w&&_.sort((D,k)=>D.sortKey-k.sortKey);let E=null;"globe"===u.projection.name&&(this.globeExtVertexArray=new Vn,E=u.projection);for(const D of _){const{geometry:k,index:z,sourceLayerIndex:j}=D,K=e[z].feature;this.addFeature(D,k,z,i.availableImages,a,E),i.featureIndex.insert(K,k,z,j,this.index)}}update(e,i,a,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,i,this.stateDependentLayers,a,u)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,h_.members),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=e.createVertexBuffer(this.globeExtVertexArray,Tu.members))),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(e,i,a,u,f,_){for(const w of i)for(const E of w){const D=E.x,k=E.y;if(D<0||D>=Pi||k<0||k>=Pi)continue;if(_){const K=_.projectTilePoint(D,k,f),te=_.upVector(f,D,k),he=this.globeExtVertexArray;Rd(he,K,te),Rd(he,K,te),Rd(he,K,te),Rd(he,K,te)}const z=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),j=z.vertexLength;ou(this.layoutVertexArray,D,k,-1,-1),ou(this.layoutVertexArray,D,k,1,-1),ou(this.layoutVertexArray,D,k,1,1),ou(this.layoutVertexArray,D,k,-1,1),this.indexArray.emplaceBack(j,j+1,j+2),this.indexArray.emplaceBack(j,j+2,j+3),z.vertexLength+=4,z.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,a,{},u,f)}}function Su(t,e){for(let i=0;i<t.length;i++)if(Jl(e,t[i]))return!0;for(let i=0;i<e.length;i++)if(Jl(t,e[i]))return!0;return!!df(t,e)}function w_(t,e,i){return!!Jl(t,e)||!!Rh(e,t,i)}function uf(t,e){if(1===t.length)return kd(e,t[0]);for(let i=0;i<e.length;i++){const a=e[i];for(let u=0;u<a.length;u++)if(Jl(t,a[u]))return!0}for(let i=0;i<t.length;i++)if(kd(e,t[i]))return!0;for(let i=0;i<e.length;i++)if(df(t,e[i]))return!0;return!1}function C_(t,e,i){if(t.length>1){if(df(t,e))return!0;for(let a=0;a<e.length;a++)if(Rh(e[a],t,i))return!0}for(let a=0;a<t.length;a++)if(Rh(t[a],e,i))return!0;return!1}function df(t,e){if(0===t.length||0===e.length)return!1;for(let i=0;i<t.length-1;i++){const a=t[i],u=t[i+1];for(let f=0;f<e.length-1;f++)if(T_(a,u,e[f],e[f+1]))return!0}return!1}function T_(t,e,i,a){return st(t,i,a)!==st(e,i,a)&&st(t,e,i)!==st(t,e,a)}function Rh(t,e,i){const a=i*i;if(1===e.length)return t.distSqr(e[0])<a;for(let u=1;u<e.length;u++)if(hf(t,e[u-1],e[u])<a)return!0;return!1}function hf(t,e,i){const a=e.distSqr(i);if(0===a)return t.distSqr(e);const u=((t.x-e.x)*(i.x-e.x)+(t.y-e.y)*(i.y-e.y))/a;return t.distSqr(u<0?e:u>1?i:i.sub(e)._mult(u)._add(e))}function kd(t,e){let i,a,u,f=!1;for(let _=0;_<t.length;_++){i=t[_];for(let w=0,E=i.length-1;w<i.length;E=w++)a=i[w],u=i[E],a.y>e.y!=u.y>e.y&&e.x<(u.x-a.x)*(e.y-a.y)/(u.y-a.y)+a.x&&(f=!f)}return f}function Jl(t,e){let i=!1;for(let a=0,u=t.length-1;a<t.length;u=a++){const f=t[a],_=t[u];f.y>e.y!=_.y>e.y&&e.x<(_.x-f.x)*(e.y-f.y)/(_.y-f.y)+f.x&&(i=!i)}return i}function ru(t,e,i,a,u){for(const _ of t)if(e<=_.x&&i<=_.y&&a>=_.x&&u>=_.y)return!0;const f=[new Me(e,i),new Me(e,u),new Me(a,u),new Me(a,i)];if(t.length>2)for(const _ of f)if(Jl(t,_))return!0;for(let _=0;_<t.length-1;_++)if(E_(t[_],t[_+1],f))return!0;return!1}function E_(t,e,i){const a=i[0],u=i[2];if(t.x<a.x&&e.x<a.x||t.x>u.x&&e.x>u.x||t.y<a.y&&e.y<a.y||t.y>u.y&&e.y>u.y)return!1;const f=st(t,e,i[0]);return f!==st(t,e,i[1])||f!==st(t,e,i[2])||f!==st(t,e,i[3])}function Pu(t,e,i){const a=e.paint.get(t).value;return"constant"===a.kind?a.value:i.programConfigurations.get(e.id).getMaxValue(t)}function pf(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function Fm(t,e,i,a,u){if(!e[0]&&!e[1])return t;const f=Me.convert(e)._mult(u);"viewport"===i&&f._rotate(-a);const _=[];for(let w=0;w<t.length;w++)_.push(t[w].sub(f));return _}function Lh(t,e,i,a){const u=Me.convert(t)._mult(a);return"viewport"===e&&u._rotate(-i),u}ui(Ld,"CircleBucket",{omit:["layers"]});const D_=new ht({"circle-sort-key":new $e(tn.layout_circle["circle-sort-key"])});var Fd={paint:new ht({"circle-radius":new $e(tn.paint_circle["circle-radius"]),"circle-color":new $e(tn.paint_circle["circle-color"]),"circle-blur":new $e(tn.paint_circle["circle-blur"]),"circle-opacity":new $e(tn.paint_circle["circle-opacity"]),"circle-translate":new ue(tn.paint_circle["circle-translate"]),"circle-translate-anchor":new ue(tn.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new ue(tn.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new ue(tn.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new $e(tn.paint_circle["circle-stroke-width"]),"circle-stroke-color":new $e(tn.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new $e(tn.paint_circle["circle-stroke-opacity"])}),layout:D_};function Bd(t,e,i,a,u,f,_,w,E){if(f&&t.queryGeometry.isAboveHorizon)return!1;f&&(E*=t.pixelToTileUnitsFactor);const D=t.tileID.canonical,k=i.projection.upVectorScale(D,i.center.lat,i.worldSize).metersToTile;for(const z of e)for(const j of z){const K=j.add(w),te=u&&i.elevation?i.elevation.exaggeration()*u.getElevationAt(K.x,K.y,!0):0,he=i.projection.projectTilePoint(K.x,K.y,D);if(te>0){const at=i.projection.upVector(D,K.x,K.y);he.x+=at[0]*k*te,he.y+=at[1]*k*te,he.z+=at[2]*k*te}const Oe=f?K:ff(he.x,he.y,he.z,a),ot=f?t.tilespaceRays.map(at=>Nm(at,te)):t.queryGeometry.screenGeometry,Ct=Xc([],[he.x,he.y,he.z,1],a);if(!_&&f?E*=Ct[3]/i.cameraToCenterDistance:_&&!f&&(E*=i.cameraToCenterDistance/Ct[3]),f){const at=vs((j.y/Pi+D.y)/(1<<D.z));E/=i.projection.pixelsPerMeter(at,1)/Zs(1,at)}if(w_(ot,Oe,E))return!0}return!1}function ff(t,e,i,a){const u=Xc([],[t,e,i,1],a);return new Me(u[0]/u[3],u[1]/u[3])}const mf=Cd(0,0,0),Bm=Cd(0,0,1);function Nm(t,e){const i=Yp();return mf[2]=e,t.intersectsPlane(mf,Bm,i),new Me(i[0],i[1])}class gf extends Ld{}function zm(t,{width:e,height:i},a,u){if(u){if(u instanceof Uint8ClampedArray)u=new Uint8Array(u.buffer);else if(u.length!==e*i*a)throw new RangeError("mismatched image size")}else u=new Uint8Array(e*i*a);return t.width=e,t.height=i,t.data=u,t}function Um(t,e,i){const{width:a,height:u}=e;a===t.width&&u===t.height||(_f(t,e,{x:0,y:0},{x:0,y:0},{width:Math.min(t.width,a),height:Math.min(t.height,u)},i),t.width=a,t.height=u,t.data=e.data)}function _f(t,e,i,a,u,f){if(0===u.width||0===u.height)return e;if(u.width>t.width||u.height>t.height||i.x>t.width-u.width||i.y>t.height-u.height)throw new RangeError("out of range source coordinates for image copy");if(u.width>e.width||u.height>e.height||a.x>e.width-u.width||a.y>e.height-u.height)throw new RangeError("out of range destination coordinates for image copy");const _=t.data,w=e.data;for(let E=0;E<u.height;E++){const D=((i.y+E)*t.width+i.x)*f,k=((a.y+E)*e.width+a.x)*f;for(let z=0;z<u.width*f;z++)w[k+z]=_[D+z]}return e}ui(gf,"HeatmapBucket",{omit:["layers"]});class Kl{constructor(e,i){zm(this,e,1,i)}resize(e){Um(this,new Kl(e),1)}clone(){return new Kl({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,i,a,u,f){_f(e,i,a,u,f,1)}}class Ca{constructor(e,i){zm(this,e,4,i)}resize(e){Um(this,new Ca(e),4)}replace(e,i){i?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e}clone(){return new Ca({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,i,a,u,f){_f(e,i,a,u,f,4)}}ui(Kl,"AlphaImage"),ui(Ca,"RGBAImage");var vc={paint:new ht({"heatmap-radius":new $e(tn.paint_heatmap["heatmap-radius"]),"heatmap-weight":new $e(tn.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new ue(tn.paint_heatmap["heatmap-intensity"]),"heatmap-color":new pt(tn.paint_heatmap["heatmap-color"]),"heatmap-opacity":new ue(tn.paint_heatmap["heatmap-opacity"])})};function su(t){const e={},i=t.resolution||256,a=t.clips?t.clips.length:1,u=t.image||new Ca({width:i,height:a}),f=(_,w,E)=>{e[t.evaluationKey]=E;const D=t.expression.evaluate(e);u.data[_+w+0]=Math.floor(255*D.r/D.a),u.data[_+w+1]=Math.floor(255*D.g/D.a),u.data[_+w+2]=Math.floor(255*D.b/D.a),u.data[_+w+3]=Math.floor(255*D.a)};if(t.clips)for(let _=0,w=0;_<a;++_,w+=4*i)for(let E=0,D=0;E<i;E++,D+=4){const k=E/(i-1),{start:z,end:j}=t.clips[_];f(w,D,z*(1-k)+j*k)}else for(let _=0,w=0;_<i;_++,w+=4)f(0,w,_/(i-1));return u}var M_={paint:new ht({"hillshade-illumination-direction":new ue(tn.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new ue(tn.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new ue(tn.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new ue(tn.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new ue(tn.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new ue(tn.paint_hillshade["hillshade-accent-color"])})};const pv=$t([{name:"a_pos",components:2,type:"Int16"}],4),{members:fv}=pv;var Zm={exports:{}};function yf(t,e,i){i=i||2;var a,u,f,_,w,E,D,k=e&&e.length,z=k?e[0]*i:t.length,j=I_(t,0,z,i,!0),K=[];if(!j||j.next===j.prev)return K;if(k&&(j=function(he,Oe,ot,Ct){var at,wt,At,It=[];for(at=0,wt=Oe.length;at<wt;at++)(At=I_(he,Oe[at]*Ct,at<wt-1?Oe[at+1]*Ct:he.length,Ct,!1))===At.next&&(At.steiner=!0),It.push(jm(At));for(It.sort(Xl),at=0;at<It.length;at++)ot=zd(It[at],ot);return ot}(t,e,j,i)),t.length>80*i){a=f=t[0],u=_=t[1];for(var te=i;te<z;te+=i)(w=t[te])<a&&(a=w),(E=t[te+1])<u&&(u=E),w>f&&(f=w),E>_&&(_=E);D=0!==(D=Math.max(f-a,_-u))?32767/D:0}return Nd(j,K,i,a,u,D,0),K}function I_(t,e,i,a,u){var f,_;if(u===Bh(t,e,i,a)>0)for(f=e;f<i;f+=a)_=Hm(f,t[f],t[f+1],_);else for(f=i-a;f>=e;f-=a)_=Hm(f,t[f],t[f+1],_);return _&&Ou(_,_.next)&&(Zd(_),_=_.next),_}function xc(t,e){if(!t)return t;e||(e=t);var i,a=t;do{if(i=!1,a.steiner||!Ou(a,a.next)&&0!==Kr(a.prev,a,a.next))a=a.next;else{if(Zd(a),(a=e=a.prev)===a.next)break;i=!0}}while(i||a!==e);return e}function Nd(t,e,i,a,u,f,_){if(t){!_&&f&&function(k,z,j,K){var te=k;do{0===te.z&&(te.z=kh(te.x,te.y,z,j,K)),te.prevZ=te.prev,te.nextZ=te.next,te=te.next}while(te!==k);te.prevZ.nextZ=null,te.prevZ=null,function(he){var Oe,ot,Ct,at,wt,At,It,un,rn=1;do{for(ot=he,he=null,wt=null,At=0;ot;){for(At++,Ct=ot,It=0,Oe=0;Oe<rn&&(It++,Ct=Ct.nextZ);Oe++);for(un=rn;It>0||un>0&&Ct;)0!==It&&(0===un||!Ct||ot.z<=Ct.z)?(at=ot,ot=ot.nextZ,It--):(at=Ct,Ct=Ct.nextZ,un--),wt?wt.nextZ=at:he=at,at.prevZ=wt,wt=at;ot=Ct}wt.nextZ=null,rn*=2}while(At>1)}(te)}(t,a,u,f);for(var w,E,D=t;t.prev!==t.next;)if(w=t.prev,E=t.next,f?S_(t,a,u,f):A_(t))e.push(w.i/i|0),e.push(t.i/i|0),e.push(E.i/i|0),Zd(t),t=E.next,D=E.next;else if((t=E)===D){_?1===_?Nd(t=P_(xc(t),e,i),e,i,a,u,f,2):2===_&&vf(t,e,i,a,u,f):Nd(xc(t),e,i,a,u,f,1);break}}}function A_(t){var e=t.prev,i=t,a=t.next;if(Kr(e,i,a)>=0)return!1;for(var u=e.x,f=i.x,_=a.x,w=e.y,E=i.y,D=a.y,k=u<f?u<_?u:_:f<_?f:_,z=w<E?w<D?w:D:E<D?E:D,j=u>f?u>_?u:_:f>_?f:_,K=w>E?w>D?w:D:E>D?E:D,te=a.next;te!==e;){if(te.x>=k&&te.x<=j&&te.y>=z&&te.y<=K&&Ud(u,w,f,E,_,D,te.x,te.y)&&Kr(te.prev,te,te.next)>=0)return!1;te=te.next}return!0}function S_(t,e,i,a){var u=t.prev,f=t,_=t.next;if(Kr(u,f,_)>=0)return!1;for(var w=u.x,E=f.x,D=_.x,k=u.y,z=f.y,j=_.y,K=w<E?w<D?w:D:E<D?E:D,te=k<z?k<j?k:j:z<j?z:j,he=w>E?w>D?w:D:E>D?E:D,Oe=k>z?k>j?k:j:z>j?z:j,ot=kh(K,te,e,i,a),Ct=kh(he,Oe,e,i,a),at=t.prevZ,wt=t.nextZ;at&&at.z>=ot&&wt&&wt.z<=Ct;){if(at.x>=K&&at.x<=he&&at.y>=te&&at.y<=Oe&&at!==u&&at!==_&&Ud(w,k,E,z,D,j,at.x,at.y)&&Kr(at.prev,at,at.next)>=0||(at=at.prevZ,wt.x>=K&&wt.x<=he&&wt.y>=te&&wt.y<=Oe&&wt!==u&&wt!==_&&Ud(w,k,E,z,D,j,wt.x,wt.y)&&Kr(wt.prev,wt,wt.next)>=0))return!1;wt=wt.nextZ}for(;at&&at.z>=ot;){if(at.x>=K&&at.x<=he&&at.y>=te&&at.y<=Oe&&at!==u&&at!==_&&Ud(w,k,E,z,D,j,at.x,at.y)&&Kr(at.prev,at,at.next)>=0)return!1;at=at.prevZ}for(;wt&&wt.z<=Ct;){if(wt.x>=K&&wt.x<=he&&wt.y>=te&&wt.y<=Oe&&wt!==u&&wt!==_&&Ud(w,k,E,z,D,j,wt.x,wt.y)&&Kr(wt.prev,wt,wt.next)>=0)return!1;wt=wt.nextZ}return!0}function P_(t,e,i){var a=t;do{var u=a.prev,f=a.next.next;!Ou(u,f)&&Fh(u,a,a.next,f)&&Ru(u,f)&&Ru(f,u)&&(e.push(u.i/i|0),e.push(a.i/i|0),e.push(f.i/i|0),Zd(a),Zd(a.next),a=t=f),a=a.next}while(a!==t);return xc(a)}function vf(t,e,i,a,u,f){var _=t;do{for(var w=_.next.next;w!==_.prev;){if(_.i!==w.i&&mv(_,w)){var E=$m(_,w);return _=xc(_,_.next),E=xc(E,E.next),Nd(_,e,i,a,u,f,0),void Nd(E,e,i,a,u,f,0)}w=w.next}_=_.next}while(_!==t)}function Xl(t,e){return t.x-e.x}function zd(t,e){var i=function(u,f){var _,w=f,E=u.x,D=u.y,k=-1/0;do{if(D<=w.y&&D>=w.next.y&&w.next.y!==w.y){var z=w.x+(D-w.y)*(w.next.x-w.x)/(w.next.y-w.y);if(z<=E&&z>k&&(k=z,_=w.x<w.next.x?w:w.next,z===E))return _}w=w.next}while(w!==f);if(!_)return null;var j,K=_,te=_.x,he=_.y,Oe=1/0;w=_;do{E>=w.x&&w.x>=te&&E!==w.x&&Ud(D<he?E:k,D,te,he,D<he?k:E,D,w.x,w.y)&&(j=Math.abs(D-w.y)/(E-w.x),Ru(w,u)&&(j<Oe||j===Oe&&(w.x>_.x||w.x===_.x&&Vm(_,w)))&&(_=w,Oe=j)),w=w.next}while(w!==K);return _}(t,e);if(!i)return e;var a=$m(i,t);return xc(a,a.next),xc(i,i.next)}function Vm(t,e){return Kr(t.prev,t,e.prev)<0&&Kr(e.next,t,t.next)<0}function kh(t,e,i,a,u){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-i)*u|0)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-a)*u|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function jm(t){var e=t,i=t;do{(e.x<i.x||e.x===i.x&&e.y<i.y)&&(i=e),e=e.next}while(e!==t);return i}function Ud(t,e,i,a,u,f,_,w){return(u-_)*(e-w)>=(t-_)*(f-w)&&(t-_)*(a-w)>=(i-_)*(e-w)&&(i-_)*(f-w)>=(u-_)*(a-w)}function mv(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(i,a){var u=i;do{if(u.i!==i.i&&u.next.i!==i.i&&u.i!==a.i&&u.next.i!==a.i&&Fh(u,u.next,i,a))return!0;u=u.next}while(u!==i);return!1}(t,e)&&(Ru(t,e)&&Ru(e,t)&&function(i,a){var u=i,f=!1,_=(i.x+a.x)/2,w=(i.y+a.y)/2;do{u.y>w!=u.next.y>w&&u.next.y!==u.y&&_<(u.next.x-u.x)*(w-u.y)/(u.next.y-u.y)+u.x&&(f=!f),u=u.next}while(u!==i);return f}(t,e)&&(Kr(t.prev,t,e.prev)||Kr(t,e.prev,e))||Ou(t,e)&&Kr(t.prev,t,t.next)>0&&Kr(e.prev,e,e.next)>0)}function Kr(t,e,i){return(e.y-t.y)*(i.x-e.x)-(e.x-t.x)*(i.y-e.y)}function Ou(t,e){return t.x===e.x&&t.y===e.y}function Fh(t,e,i,a){var u=bf(Kr(t,e,i)),f=bf(Kr(t,e,a)),_=bf(Kr(i,a,t)),w=bf(Kr(i,a,e));return u!==f&&_!==w||!(0!==u||!xf(t,i,e))||!(0!==f||!xf(t,a,e))||!(0!==_||!xf(i,t,a))||!(0!==w||!xf(i,e,a))}function xf(t,e,i){return e.x<=Math.max(t.x,i.x)&&e.x>=Math.min(t.x,i.x)&&e.y<=Math.max(t.y,i.y)&&e.y>=Math.min(t.y,i.y)}function bf(t){return t>0?1:t<0?-1:0}function Ru(t,e){return Kr(t.prev,t,t.next)<0?Kr(t,e,t.next)>=0&&Kr(t,t.prev,e)>=0:Kr(t,e,t.prev)<0||Kr(t,t.next,e)<0}function $m(t,e){var i=new wf(t.i,t.x,t.y),a=new wf(e.i,e.x,e.y),u=t.next,f=e.prev;return t.next=e,e.prev=t,i.next=u,u.prev=i,a.next=i,i.prev=a,f.next=a,a.prev=f,a}function Hm(t,e,i,a){var u=new wf(t,e,i);return a?(u.next=a.next,u.prev=a,a.next.prev=u,a.next=u):(u.prev=u,u.next=u),u}function Zd(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function wf(t,e,i){this.i=t,this.x=e,this.y=i,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Bh(t,e,i,a){for(var u=0,f=e,_=i-a;f<i;f+=a)u+=(t[_]-t[f])*(t[f+1]+t[_+1]),_=f;return u}Zm.exports=yf,Zm.exports.default=yf,yf.deviation=function(t,e,i,a){var u=e&&e.length,f=Math.abs(Bh(t,0,u?e[0]*i:t.length,i));if(u)for(var _=0,w=e.length;_<w;_++)f-=Math.abs(Bh(t,e[_]*i,_<w-1?e[_+1]*i:t.length,i));var E=0;for(_=0;_<a.length;_+=3){var D=a[_]*i,k=a[_+1]*i,z=a[_+2]*i;E+=Math.abs((t[D]-t[z])*(t[k+1]-t[D+1])-(t[D]-t[k])*(t[z+1]-t[D+1]))}return 0===f&&0===E?0:Math.abs((E-f)/f)},yf.flatten=function(t){for(var e=t[0][0].length,i={vertices:[],holes:[],dimensions:e},a=0,u=0;u<t.length;u++){for(var f=0;f<t[u].length;f++)for(var _=0;_<e;_++)i.vertices.push(t[u][f][_]);u>0&&i.holes.push(a+=t[u-1].length)}return i};var Lu=be(Zm.exports);function O_(t,e,i,a,u){Nh(t,e,i||0,a||t.length-1,u||ss)}function Nh(t,e,i,a,u){for(;a>i;){if(a-i>600){var f=a-i+1,_=e-i+1,w=Math.log(f),E=.5*Math.exp(2*w/3),D=.5*Math.sqrt(w*E*(f-E)/f)*(_-f/2<0?-1:1);Nh(t,e,Math.max(i,Math.floor(e-_*E/f+D)),Math.min(a,Math.floor(e+(f-_)*E/f+D)),u)}var k=t[e],z=i,j=a;for(Vd(t,i,e),u(t[a],k)>0&&Vd(t,i,a);z<j;){for(Vd(t,z,j),z++,j--;u(t[z],k)<0;)z++;for(;u(t[j],k)>0;)j--}0===u(t[i],k)?Vd(t,i,j):Vd(t,++j,a),j<=e&&(i=j+1),e<=j&&(a=j-1)}}function Vd(t,e,i){var a=t[e];t[e]=t[i],t[i]=a}function ss(t,e){return t<e?-1:t>e?1:0}function Cf(t,e){const i=t.length;if(i<=1)return[t];const a=[];let u,f;for(let _=0;_<i;_++){const w=qt(t[_]);0!==w&&(t[_].area=Math.abs(w),void 0===f&&(f=w<0),f===w<0?(u&&a.push(u),u=[t[_]]):u.push(t[_]))}if(u&&a.push(u),e>1)for(let _=0;_<a.length;_++)a[_].length<=e||(O_(a[_],e,1,a[_].length-1,R_),a[_]=a[_].slice(0,e));return a}function R_(t,e){return e.area-t.area}function jd(t,e,i){const a=i.patternDependencies;let u=!1;for(const f of e){const _=f.paint.get(`${t}-pattern`);_.isConstant()||(u=!0);const w=_.constantOr(null);w&&(u=!0,a[w]=!0)}return u}function zh(t,e,i,a,u){const f=u.patternDependencies;for(const _ of e){const w=_.paint.get(`${t}-pattern`).value;if("constant"!==w.kind){let E=w.evaluate({zoom:a},i,{},u.availableImages);E=E&&E.name?E.name:E,f[E]=!0,i.patterns[_.id]=E}}return i}class Uh{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(i=>i.id),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Gn,this.indexArray=new bi,this.indexArray2=new Yr,this.programConfigurations=new Yc(e.layers,e.zoom),this.segments=new Tr,this.segments2=new Tr,this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id),this.projection=e.projection}populate(e,i,a,u){this.hasPattern=jd("fill",this.layers,i);const f=this.layers[0].layout.get("fill-sort-key"),_=[];for(const{feature:w,id:E,index:D,sourceLayerIndex:k}of e){const z=this.layers[0]._featureFilter.needGeometry,j=Yl(w,z);if(!this.layers[0]._featureFilter.filter(new N(this.zoom),j,a))continue;const K=f?f.evaluate(j,{},a,i.availableImages):void 0,te={id:E,properties:w.properties,type:w.type,sourceLayerIndex:k,index:D,geometry:z?j.geometry:Dl(w,a,u),patterns:{},sortKey:K};_.push(te)}f&&_.sort((w,E)=>w.sortKey-E.sortKey);for(const w of _){const{geometry:E,index:D,sourceLayerIndex:k}=w;if(this.hasPattern){const z=zh("fill",this.layers,w,this.zoom,i);this.patternFeatures.push(z)}else this.addFeature(w,E,D,a,{},i.availableImages);i.featureIndex.insert(e[D].feature,E,D,k,this.index)}}update(e,i,a,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,i,this.stateDependentLayers,a,u)}addFeatures(e,i,a,u,f){for(const _ of this.patternFeatures)this.addFeature(_,_.geometry,_.index,i,a,u)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,fv),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(e,i,a,u,f,_=[]){for(const w of Cf(i,500)){let E=0;for(const te of w)E+=te.length;const D=this.segments.prepareSegment(E,this.layoutVertexArray,this.indexArray),k=D.vertexLength,z=[],j=[];for(const te of w){if(0===te.length)continue;te!==w[0]&&j.push(z.length/2);const he=this.segments2.prepareSegment(te.length,this.layoutVertexArray,this.indexArray2),Oe=he.vertexLength;this.layoutVertexArray.emplaceBack(te[0].x,te[0].y),this.indexArray2.emplaceBack(Oe+te.length-1,Oe),z.push(te[0].x),z.push(te[0].y);for(let ot=1;ot<te.length;ot++)this.layoutVertexArray.emplaceBack(te[ot].x,te[ot].y),this.indexArray2.emplaceBack(Oe+ot-1,Oe+ot),z.push(te[ot].x),z.push(te[ot].y);he.vertexLength+=te.length,he.primitiveLength+=te.length}const K=Lu(z,j);for(let te=0;te<K.length;te+=3)this.indexArray.emplaceBack(k+K[te],k+K[te+1],k+K[te+2]);D.vertexLength+=E,D.primitiveLength+=K.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,a,f,_,u)}}ui(Uh,"FillBucket",{omit:["layers","patternFeatures"]});const L_=new ht({"fill-sort-key":new $e(tn.layout_fill["fill-sort-key"])});var k_={paint:new ht({"fill-antialias":new ue(tn.paint_fill["fill-antialias"]),"fill-opacity":new $e(tn.paint_fill["fill-opacity"]),"fill-color":new $e(tn.paint_fill["fill-color"]),"fill-outline-color":new $e(tn.paint_fill["fill-outline-color"]),"fill-translate":new ue(tn.paint_fill["fill-translate"]),"fill-translate-anchor":new ue(tn.paint_fill["fill-translate-anchor"]),"fill-pattern":new $e(tn.paint_fill["fill-pattern"])}),layout:L_};const F_=$t([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),Gm=$t([{name:"a_centroid_pos",components:2,type:"Uint16"}]),gv=$t([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:_v}=F_;var bc={},lr=_t,ku=au;function au(t,e,i,a,u){this.properties={},this.extent=i,this.type=0,this._pbf=t,this._geometry=-1,this._keys=a,this._values=u,t.readFields(Wm,this,e)}function Wm(t,e,i){1==t?e.id=i.readVarint():2==t?function(a,u){for(var f=a.readVarint()+a.pos;a.pos<f;){var _=u._keys[a.readVarint()],w=u._values[a.readVarint()];u.properties[_]=w}}(i,e):3==t?e.type=i.readVarint():4==t&&(e._geometry=i.pos)}function qm(t){for(var e,i,a=0,u=0,f=t.length,_=f-1;u<f;_=u++)a+=((i=t[_]).x-(e=t[u]).x)*(e.y+i.y);return a}au.types=["Unknown","Point","LineString","Polygon"],au.prototype.loadGeometry=function(){var t=this._pbf;t.pos=this._geometry;for(var e,i=t.readVarint()+t.pos,a=1,u=0,f=0,_=0,w=[];t.pos<i;){if(u<=0){var E=t.readVarint();a=7&E,u=E>>3}if(u--,1===a||2===a)f+=t.readSVarint(),_+=t.readSVarint(),1===a&&(e&&w.push(e),e=[]),e.push(new lr(f,_));else{if(7!==a)throw new Error("unknown command "+a);e&&e.push(e[0].clone())}}return e&&w.push(e),w},au.prototype.bbox=function(){var t=this._pbf;t.pos=this._geometry;for(var e=t.readVarint()+t.pos,i=1,a=0,u=0,f=0,_=1/0,w=-1/0,E=1/0,D=-1/0;t.pos<e;){if(a<=0){var k=t.readVarint();i=7&k,a=k>>3}if(a--,1===i||2===i)(u+=t.readSVarint())<_&&(_=u),u>w&&(w=u),(f+=t.readSVarint())<E&&(E=f),f>D&&(D=f);else if(7!==i)throw new Error("unknown command "+i)}return[_,E,w,D]},au.prototype.toGeoJSON=function(t,e,i){var a,u,f=this.extent*Math.pow(2,i),_=this.extent*t,w=this.extent*e,E=this.loadGeometry(),D=au.types[this.type];function k(K){for(var te=0;te<K.length;te++){var he=K[te];K[te]=[360*(he.x+_)/f-180,360/Math.PI*Math.atan(Math.exp((180-360*(he.y+w)/f)*Math.PI/180))-90]}}switch(this.type){case 1:var z=[];for(a=0;a<E.length;a++)z[a]=E[a][0];k(E=z);break;case 2:for(a=0;a<E.length;a++)k(E[a]);break;case 3:for(E=function(K){var te=K.length;if(te<=1)return[K];for(var he,Oe,ot=[],Ct=0;Ct<te;Ct++){var at=qm(K[Ct]);0!==at&&(void 0===Oe&&(Oe=at<0),Oe===at<0?(he&&ot.push(he),he=[K[Ct]]):he.push(K[Ct]))}return he&&ot.push(he),ot}(E),a=0;a<E.length;a++)for(u=0;u<E[a].length;u++)k(E[a][u])}1===E.length?E=E[0]:D="Multi"+D;var j={type:"Feature",geometry:{type:D,coordinates:E},properties:this.properties};return"id"in this&&(j.id=this.id),j};var Tf=ku,Ym=Ef;function Ef(t,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=t,this._keys=[],this._values=[],this._features=[],t.readFields(Jm,this,e),this.length=this._features.length}function Jm(t,e,i){15===t?e.version=i.readVarint():1===t?e.name=i.readString():5===t?e.extent=i.readVarint():2===t?e._features.push(i.pos):3===t?e._keys.push(i.readString()):4===t&&e._values.push(function(a){for(var u=null,f=a.readVarint()+a.pos;a.pos<f;){var _=a.readVarint()>>3;u=1===_?a.readString():2===_?a.readFloat():3===_?a.readDouble():4===_?a.readVarint64():5===_?a.readVarint():6===_?a.readSVarint():7===_?a.readBoolean():null}return u}(i))}Ef.prototype.feature=function(t){if(t<0||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];var e=this._pbf.readVarint()+this._pbf.pos;return new Tf(this._pbf,e,this.extent,this._keys,this._values)};var Df=Ym;function yv(t,e,i){if(3===t){var a=new Df(i,i.readVarint()+i.pos);a.length&&(e[a.name]=a)}}var $d=bc.VectorTile=function(t,e){this.layers=t.readFields(yv,{},e)},Zh=bc.VectorTileFeature=ku;function Fu(t,e,i,a){const u=[],f=0===a?(_,w,E,D,k,z)=>{_.push(new Me(z,E+(z-w)/(D-w)*(k-E)))}:(_,w,E,D,k,z)=>{_.push(new Me(w+(z-E)/(k-E)*(D-w),z))};for(const _ of t){const w=[];for(const E of _){if(E.length<=2)continue;const D=[];for(let j=0;j<E.length-1;j++){const K=E[j].x,te=E[j].y,he=E[j+1].x,Oe=E[j+1].y,ot=0===a?K:te,Ct=0===a?he:Oe;ot<e?Ct>e&&f(D,K,te,he,Oe,e):ot>i?Ct<i&&f(D,K,te,he,Oe,i):D.push(E[j]),Ct<e&&ot>=e&&f(D,K,te,he,Oe,e),Ct>i&&ot<=i&&f(D,K,te,he,Oe,i)}let k=E[E.length-1];const z=0===a?k.x:k.y;z>=e&&z<=i&&D.push(k),D.length&&(k=D[D.length-1],D[0].x===k.x&&D[0].y===k.y||D.push(D[0]),w.push(D))}w.length&&u.push(w)}return u}bc.VectorTileLayer=Ym;const Km=Zh.types,Xm=Math.pow(2,13);function ll(t,e,i,a,u,f,_,w){t.emplaceBack((e<<1)+_,(i<<1)+f,(Math.floor(a*Xm)<<1)+u,Math.round(w))}function Hd(t,e,i){t.emplaceBack(e.x,e.y,e.z,16384*i[0],16384*i[1],16384*i[2])}class Vh{constructor(){this.acc=new Me(0,0),this.polyCount=[]}startRing(e){this.currentPolyCount={edges:0,top:0},this.polyCount.push(this.currentPolyCount),this.min||(this.min=new Me(e.x,e.y),this.max=new Me(e.x,e.y))}append(e,i){this.currentPolyCount.edges++,this.acc._add(e);const a=this.min,u=this.max;e.x<a.x?a.x=e.x:e.x>u.x&&(u.x=e.x),e.y<a.y?a.y=e.y:e.y>u.y&&(u.y=e.y),((0===e.x||e.x===Pi)&&e.x===i.x)!=((0===e.y||e.y===Pi)&&e.y===i.y)&&this.processBorderOverlap(e,i),i.x<0!=e.x<0&&this.addBorderIntersection(0,Kn(i.y,e.y,(0-i.x)/(e.x-i.x))),i.x>Pi!=e.x>Pi&&this.addBorderIntersection(1,Kn(i.y,e.y,(Pi-i.x)/(e.x-i.x))),i.y<0!=e.y<0&&this.addBorderIntersection(2,Kn(i.x,e.x,(0-i.y)/(e.y-i.y))),i.y>Pi!=e.y>Pi&&this.addBorderIntersection(3,Kn(i.x,e.x,(Pi-i.y)/(e.y-i.y)))}addBorderIntersection(e,i){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const a=this.borders[e];i<a[0]&&(a[0]=i),i>a[1]&&(a[1]=i)}processBorderOverlap(e,i){if(e.x===i.x){if(e.y===i.y)return;const a=0===e.x?0:1;this.addBorderIntersection(a,i.y),this.addBorderIntersection(a,e.y)}else{const a=0===e.y?2:3;this.addBorderIntersection(a,i.x),this.addBorderIntersection(a,e.x)}}centroid(){const e=this.polyCount.reduce((i,a)=>i+a.edges,0);return 0!==e?this.acc.div(e)._round():new Me(0,0)}span(){return new Me(this.max.x-this.min.x,this.max.y-this.min.y)}intersectsCount(){return this.borders.reduce((e,i)=>e+ +(i[0]!==Number.MAX_VALUE),0)}}class wc{constructor(e){this.zoom=e.zoom,this.canonical=e.canonical,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(i=>i.id),this.index=e.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=e.projection,this.layoutVertexArray=new An,this.centroidVertexArray=new mr,this.indexArray=new bi,this.programConfigurations=new Yc(e.layers,e.zoom),this.segments=new Tr,this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id),this.enableTerrain=e.enableTerrain}populate(e,i,a,u){this.features=[],this.hasPattern=jd("fill-extrusion",this.layers,i),this.featuresOnBorder=[],this.borders=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=function(f){const _=Math.exp(Math.PI*(1-f.y/(1<<f.z)*2));return 80150034*_/(_*_+1)/Pi/(1<<f.z)}(a),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter;for(const{feature:f,id:_,index:w,sourceLayerIndex:E}of e){const D=this.layers[0]._featureFilter.needGeometry,k=Yl(f,D);if(!this.layers[0]._featureFilter.filter(new N(this.zoom),k,a))continue;const z={id:_,sourceLayerIndex:E,index:w,geometry:D?k.geometry:Dl(f,a,u),properties:f.properties,type:f.type,patterns:{}},j=this.layoutVertexArray.length;this.hasPattern?this.features.push(zh("fill-extrusion",this.layers,z,this.zoom,i)):this.addFeature(z,z.geometry,w,a,{},i.availableImages,u),i.featureIndex.insert(f,z.geometry,w,E,this.index,j)}this.sortBorders()}addFeatures(e,i,a,u,f){for(const _ of this.features){const{geometry:w}=_;this.addFeature(_,w,_.index,i,a,u,f)}this.sortBorders()}update(e,i,a,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,i,this.stateDependentLayers,a,u)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,_v),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=e.createVertexBuffer(this.layoutVertexExtArray,gv.members,!0))),this.programConfigurations.upload(e),this.uploaded=!0}uploadCentroid(e){0!==this.centroidVertexArray.length&&(this.centroidVertexBuffer?this.needsCentroidUpdate&&this.centroidVertexBuffer.updateData(this.centroidVertexArray):this.centroidVertexBuffer=e.createVertexBuffer(this.centroidVertexArray,Gm.members,!0),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(e,i,a,u,f,_,w){const E=[new Me(0,0),new Me(Pi,Pi)],D=w.projection,k="globe"===D.name,z=this.enableTerrain&&!k?new Vh:null,j="Polygon"===Km[e.type];k&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new Vn);const K=Cf(i,500);for(let ot=K.length-1;ot>=0;ot--){const Ct=K[ot];(0===Ct.length||(te=Ct[0]).every(at=>at.x<=0)||te.every(at=>at.x>=Pi)||te.every(at=>at.y<=0)||te.every(at=>at.y>=Pi))&&K.splice(ot,1)}var te;let he;if(k)he=tg(K,E,u);else{he=[];for(const ot of K)he.push({polygon:ot,bounds:E})}const Oe=j?this.edgeRadius:0;for(const{polygon:ot,bounds:Ct}of he){let at=0,wt=0;for(const It of ot)j&&!It[0].equals(It[It.length-1])&&It.push(It[0]),wt+=j?It.length-1:It.length;const At=this.segments.prepareSegment((j?5:4)*wt,this.layoutVertexArray,this.indexArray);if(j){const It=[],un=[];at=At.vertexLength;for(const En of ot){let $n,fn;En.length&&En!==ot[0]&&un.push(It.length/2),$n=En[1].sub(En[0])._perp()._unit();for(let kn=1;kn<En.length;kn++){const Fn=En[kn],Zn=En[kn===En.length-1?1:kn+1];let{x:Yn,y:Tn}=Fn;if(Oe){fn=Zn.sub(Fn)._perp()._unit();const si=$n.add(fn)._unit(),yi=Oe*Math.min(4,1/($n.x*si.x+$n.y*si.y));Yn+=yi*si.x,Tn+=yi*si.y,$n=fn}ll(this.layoutVertexArray,Yn,Tn,0,0,1,1,0),At.vertexLength++,It.push(Fn.x,Fn.y),k&&Hd(this.layoutVertexExtArray,D.projectTilePoint(Yn,Tn,u),D.upVector(u,Yn,Tn))}}const rn=Lu(It,un);for(let En=0;En<rn.length;En+=3)this.indexArray.emplaceBack(at+rn[En],at+rn[En+2],at+rn[En+1]),At.primitiveLength++}for(const It of ot){z&&It.length&&z.startRing(It[0]);let un,rn,En,$n=It.length>4&&jh(It[It.length-2],It[0],It[1]),fn=Oe?Mf(It[It.length-2],It[0],It[1],Oe):0;rn=It[1].sub(It[0])._perp()._unit();let kn=!0;for(let Fn=1,Zn=0;Fn<It.length;Fn++){let Yn=It[Fn-1],Tn=It[Fn];const si=It[Fn===It.length-1?1:Fn+1];if(z&&j&&z.currentPolyCount.top++,Cc(Tn,Yn,Ct)){Oe&&(rn=si.sub(Tn)._perp()._unit(),kn=!kn);continue}z&&z.append(Tn,Yn);const yi=Tn.sub(Yn)._perp(),li=yi.x/(Math.abs(yi.x)+Math.abs(yi.y)),no=yi.y>0?1:0,Jn=Yn.dist(Tn);if(Zn+Jn>32768&&(Zn=0),Oe){En=si.sub(Tn)._perp()._unit();let Yi=Gd(Yn,Tn,si,Qm(rn,En),Oe);isNaN(Yi)&&(Yi=0);const Ni=Tn.sub(Yn)._unit();Yn=Yn.add(Ni.mult(fn))._round(),Tn=Tn.add(Ni.mult(-Yi))._round(),fn=Yi,rn=En}const Ei=At.vertexLength,Wi=It.length>4&&jh(Yn,Tn,si);let Ao=$h(Zn,$n,kn);if(ll(this.layoutVertexArray,Yn.x,Yn.y,li,no,0,0,Ao),ll(this.layoutVertexArray,Yn.x,Yn.y,li,no,0,1,Ao),Zn+=Jn,Ao=$h(Zn,Wi,!kn),$n=Wi,ll(this.layoutVertexArray,Tn.x,Tn.y,li,no,0,0,Ao),ll(this.layoutVertexArray,Tn.x,Tn.y,li,no,0,1,Ao),At.vertexLength+=4,this.indexArray.emplaceBack(Ei+0,Ei+1,Ei+2),this.indexArray.emplaceBack(Ei+1,Ei+3,Ei+2),At.primitiveLength+=2,Oe){const Yi=at+(1===Fn?It.length-2:Fn-2),Ni=1===Fn?at:Yi+1;if(this.indexArray.emplaceBack(Ei+1,Yi,Ei+3),this.indexArray.emplaceBack(Yi,Ni,Ei+3),At.primitiveLength+=2,void 0===un&&(un=Ei),!Cc(si,It[Fn],Ct)){const Yo=Fn===It.length-1?un:At.vertexLength;this.indexArray.emplaceBack(Ei+2,Ei+3,Yo),this.indexArray.emplaceBack(Ei+3,Yo+1,Yo),this.indexArray.emplaceBack(Ei+3,Ni,Yo+1),At.primitiveLength+=3}kn=!kn}if(k){const Yi=this.layoutVertexExtArray,Ni=D.projectTilePoint(Yn.x,Yn.y,u),Yo=D.projectTilePoint(Tn.x,Tn.y,u),io=D.upVector(u,Yn.x,Yn.y),ro=D.upVector(u,Tn.x,Tn.y);Hd(Yi,Ni,io),Hd(Yi,Ni,io),Hd(Yi,Yo,ro),Hd(Yi,Yo,ro)}}j&&(at+=It.length-1)}}if(z&&z.polyCount.length>0){if(z.borders){z.vertexArrayOffset=this.centroidVertexArray.length;const ot=z.borders,Ct=this.featuresOnBorder.push(z)-1;for(let at=0;at<4;at++)ot[at][0]!==Number.MAX_VALUE&&this.borders[at].push(Ct)}this.encodeCentroid(z.borders?void 0:z.centroid(),z)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,a,f,_,u)}sortBorders(){for(let e=0;e<4;e++)this.borders[e].sort((i,a)=>this.featuresOnBorder[i].borders[e][0]-this.featuresOnBorder[a].borders[e][0])}encodeCentroid(e,i,a=!0){let u,f;if(e)if(0!==e.y){const w=i.span()._mult(this.tileToMeter);u=(Math.max(e.x,1)<<3)+Math.min(7,Math.round(w.x/10)),f=(Math.max(e.y,1)<<3)+Math.min(7,Math.round(w.y/10))}else u=Math.ceil(7*(e.x+450)),f=0;else u=0,f=+a;let _=a?this.centroidVertexArray.length:i.vertexArrayOffset;for(const w of i.polyCount){a&&this.centroidVertexArray.resize(this.centroidVertexArray.length+4*w.edges+w.top);for(let E=0;E<w.top;E++)this.centroidVertexArray.emplace(_++,u,f);for(let E=0;E<2*w.edges;E++)this.centroidVertexArray.emplace(_++,0,f),this.centroidVertexArray.emplace(_++,u,f)}}}function Qm(t,e){const i=t.add(e)._unit();return t.x*i.x+t.y*i.y}function Mf(t,e,i,a){const u=e.sub(t)._perp()._unit(),f=i.sub(e)._perp()._unit();return Gd(t,e,i,Qm(u,f),a)}function Gd(t,e,i,a,u){const f=Math.sqrt(1-a*a);return Math.min(t.dist(e)/3,e.dist(i)/3,u*f/a)}function Cc(t,e,i){return t.x<i[0].x&&e.x<i[0].x||t.x>i[1].x&&e.x>i[1].x||t.y<i[0].y&&e.y<i[0].y||t.y>i[1].y&&e.y>i[1].y}function jh(t,e,i){if(t.x<0||t.x>=Pi||e.x<0||e.x>=Pi||i.x<0||i.x>=Pi)return!1;const a=i.sub(e),u=a.perp(),f=t.sub(e);return(a.x*f.x+a.y*f.y)/Math.sqrt((a.x*a.x+a.y*a.y)*(f.x*f.x+f.y*f.y))>-.866&&u.x*f.x+u.y*f.y<0}function $h(t,e,i){const a=e?2|t:-3&t;return i?1|a:-2&a}function eg(){const t=Math.PI/32,e=Math.tan(t),i=iu;return i*Math.sqrt(1+2*e*e)-i}function tg(t,e,i){const a=1<<i.z,u=wa(i.x/a),f=wa((i.x+1)/a),_=vs(i.y/a),w=vs((i.y+1)/a);return function(E,D,k,z,j=0,K){const te=[];if(!E.length||!k||!z)return te;const he=(It,un)=>{for(const rn of It)te.push({polygon:rn,bounds:un})},Oe=Math.ceil(Math.log2(k)),ot=Math.ceil(Math.log2(z)),Ct=Oe-ot,at=[];for(let It=0;It<Math.abs(Ct);It++)at.push(Ct>0?0:1);for(let It=0;It<Math.min(Oe,ot);It++)at.push(0),at.push(1);let wt=E;if(wt=Fu(wt,D[0].y-j,D[1].y+j,1),wt=Fu(wt,D[0].x-j,D[1].x+j,0),!wt.length)return te;const At=[];for(at.length?At.push({polygons:wt,bounds:D,depth:0}):he(wt,D);At.length;){const It=At.pop(),un=It.depth,rn=at[un],En=It.bounds[0],$n=It.bounds[1],fn=0===rn?En.x:En.y,kn=0===rn?$n.x:$n.y,Fn=K?K(rn,fn,kn):.5*(fn+kn),Zn=Fu(It.polygons,fn-j,Fn+j,rn),Yn=Fu(It.polygons,Fn-j,kn+j,rn);if(Zn.length){const Tn=[En,new Me(0===rn?Fn:$n.x,1===rn?Fn:$n.y)];at.length>un+1?At.push({polygons:Zn,bounds:Tn,depth:un+1}):he(Zn,Tn)}if(Yn.length){const Tn=[new Me(0===rn?Fn:En.x,1===rn?Fn:En.y),$n];at.length>un+1?At.push({polygons:Yn,bounds:Tn,depth:un+1}):he(Yn,Tn)}}return te}(t,e,Math.ceil((f-u)/11.25),Math.ceil((_-w)/11.25),1,(E,D,k)=>{if(0===E)return.5*(D+k);{const z=vs((i.y+D/Pi)/a);return(al(.5*(vs((i.y+k/Pi)/a)+z))*a-i.y)*Pi}})}ui(wc,"FillExtrusionBucket",{omit:["layers","features"]}),ui(Vh,"PartMetadata");const ng=new ht({"fill-extrusion-edge-radius":new ue(tn["layout_fill-extrusion"]["fill-extrusion-edge-radius"])});var Bu={paint:new ht({"fill-extrusion-opacity":new ue(tn["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new $e(tn["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new ue(tn["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new ue(tn["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new $e(tn["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new $e(tn["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new $e(tn["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new ue(tn["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new ue(tn["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new ue(tn["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-rounded-roof":new ue(tn["paint_fill-extrusion"]["fill-extrusion-rounded-roof"])}),layout:ng};function ig(t,e,i){var a=2*Math.PI*6378137/256/Math.pow(2,i);return[t*a-2*Math.PI*6378137/2,e*a-2*Math.PI*6378137/2]}class Hh{constructor(e,i,a){this.z=e,this.x=i,this.y=a,this.key=Nu(0,e,e,i,a)}equals(e){return this.z===e.z&&this.x===e.x&&this.y===e.y}url(e,i){const a=(_=this.y,w=this.z,E=ig(256*(f=this.x),256*(_=Math.pow(2,w)-_-1),w),D=ig(256*(f+1),256*(_+1),w),E[0]+","+E[1]+","+D[0]+","+D[1]),u=function(f,_,w){let E,D="";for(let k=f;k>0;k--)E=1<<k-1,D+=(_&E?1:0)+(w&E?2:0);return D}(this.z,this.x,this.y);var f,_,w,E,D;return e[(this.x+this.y)%e.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String("tms"===i?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",u).replace("{bbox-epsg-3857}",a)}toString(){return`${this.z}/${this.x}/${this.y}`}}class og{constructor(e,i){this.wrap=e,this.canonical=i,this.key=Nu(e,i.z,i.z,i.x,i.y)}}class Is{constructor(e,i,a,u,f){this.overscaledZ=e,this.wrap=i,this.canonical=new Hh(a,+u,+f),this.key=0===i&&e===a?this.canonical.key:Nu(i,e,a,u,f)}equals(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)}scaledTo(e){const i=this.canonical.z-e;return e>this.canonical.z?new Is(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Is(e,this.wrap,e,this.canonical.x>>i,this.canonical.y>>i)}calculateScaledKey(e,i=!0){if(this.overscaledZ===e&&i)return this.key;if(e>this.canonical.z)return Nu(this.wrap*+i,e,this.canonical.z,this.canonical.x,this.canonical.y);{const a=this.canonical.z-e;return Nu(this.wrap*+i,e,e,this.canonical.x>>a,this.canonical.y>>a)}}isChildOf(e){if(e.wrap!==this.wrap)return!1;const i=this.canonical.z-e.canonical.z;return 0===e.overscaledZ||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>i&&e.canonical.y===this.canonical.y>>i}children(e){if(this.overscaledZ>=e)return[new Is(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const i=this.canonical.z+1,a=2*this.canonical.x,u=2*this.canonical.y;return[new Is(i,this.wrap,i,a,u),new Is(i,this.wrap,i,a+1,u),new Is(i,this.wrap,i,a,u+1),new Is(i,this.wrap,i,a+1,u+1)]}isLessThan(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))}wrapped(){return new Is(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(e){return new Is(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new og(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function Nu(t,e,i,a,u){const f=1<<Math.min(i,22);let _=f*(u%f)+a%f;return t&&i<22&&(_+=f*f*((t<0?-2*t-1:2*t)%(1<<2*(22-i)))),16*(32*_+i)+(e-i)}ui(Hh,"CanonicalTileID"),ui(Is,"OverscaledTileID",{omit:["projMatrix"]});class zu extends Me{constructor(e,i,a){super(e,i),this.z=a}}function Uu(t,e){return t.x*e.x+t.y*e.y}function Gh(t,e){if(1===t.length){let i=0;const a=e[i++];let u;for(;!u||a.equals(u);)if(u=e[i++],!u)return 1/0;for(;i<e.length;i++){const f=e[i],_=t[0],w=u.sub(a),E=f.sub(a),D=_.sub(a),k=Uu(w,w),z=Uu(w,E),j=Uu(E,E),K=Uu(D,w),te=Uu(D,E),he=k*j-z*z,Oe=(j*K-z*te)/he,ot=(k*te-z*K)/he,Ct=a.z*(1-Oe-ot)+u.z*Oe+f.z*ot;if(isFinite(Ct))return Ct}return 1/0}{let i=1/0;for(const a of e)i=Math.min(i,a.z);return i}}function B_(t,e,i,a,u,f,_,w){const E=_*u.getElevationAt(t,e,!0,!0),D=0!==f[0],k=D?0===f[1]?_*(f[0]/7-450):_*function(z,j,K){const te=Math.floor(j[0]/8),he=Math.floor(j[1]/8),Oe=10*(j[0]-8*te),ot=10*(j[1]-8*he),Ct=z.getElevationAt(te,he,!0,!0),at=z.getMeterToDEM(K),wt=Math.floor(.5*(Oe*at-1)),At=Math.floor(.5*(ot*at-1)),It=z.tileCoordToPixel(te,he),un=2*wt+1,rn=2*At+1,En=(yi=un,li=rn,[(Yn=z).getElevationAtPixel(Tn=It.x-wt,si=It.y-At,!0),Yn.getElevationAtPixel(Tn+li,si,!0),Yn.getElevationAtPixel(Tn,si+li,!0),Yn.getElevationAtPixel(Tn+yi,si+li,!0)]),$n=Math.abs(En[0]-En[1]),fn=Math.abs(En[2]-En[3]),kn=Math.abs(En[0]-En[2])+Math.abs(En[1]-En[3]),Fn=Math.min(.25,.5*at*($n+fn)/un),Zn=Math.min(.25,.5*at*kn/rn);var Yn,Tn,si,yi,li;return Ct+Math.max(Fn*Oe,Zn*ot)}(u,f,w):E;return{base:E+(0===i)?-1:i,top:D?Math.max(k+a,E+i+2):E+a}}const vv=$t([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:N_}=vv,z_=$t([{name:"a_packed",components:4,type:"Float32"}]),{members:xv}=z_,bv=Zh.types,Wh=Math.cos(Math.PI/180*37.5);class qh{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(i=>i.id),this.index=e.index,this.projection=e.projection,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(i=>{this.gradients[i.id]={}}),this.layoutVertexArray=new hn,this.layoutVertexArray2=new jn,this.indexArray=new bi,this.programConfigurations=new Yc(e.layers,e.zoom),this.segments=new Tr,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id)}populate(e,i,a,u){this.hasPattern=jd("line",this.layers,i);const f=this.layers[0].layout.get("line-sort-key"),_=[];for(const{feature:k,id:z,index:j,sourceLayerIndex:K}of e){const te=this.layers[0]._featureFilter.needGeometry,he=Yl(k,te);if(!this.layers[0]._featureFilter.filter(new N(this.zoom),he,a))continue;const Oe=f?f.evaluate(he,{},a):void 0,ot={id:z,properties:k.properties,type:k.type,sourceLayerIndex:K,index:j,geometry:te?he.geometry:Dl(k,a,u),patterns:{},sortKey:Oe};_.push(ot)}f&&_.sort((k,z)=>k.sortKey-z.sortKey);const{lineAtlas:w,featureIndex:E}=i,D=this.addConstantDashes(w);for(const k of _){const{geometry:z,index:j,sourceLayerIndex:K}=k;if(D&&this.addFeatureDashes(k,w),this.hasPattern){const te=zh("line",this.layers,k,this.zoom,i);this.patternFeatures.push(te)}else this.addFeature(k,z,j,a,w.positions,i.availableImages);E.insert(e[j].feature,z,j,K,this.index)}}addConstantDashes(e){let i=!1;for(const a of this.layers){const u=a.paint.get("line-dasharray").value,f=a.layout.get("line-cap").value;if("constant"!==u.kind||"constant"!==f.kind)i=!0;else{const _=f.value,w=u.value;if(!w)continue;e.addDash(w,_)}}return i}addFeatureDashes(e,i){const a=this.zoom;for(const u of this.layers){const f=u.paint.get("line-dasharray").value,_=u.layout.get("line-cap").value;if("constant"===f.kind&&"constant"===_.kind)continue;let w,E;if("constant"===f.kind){if(w=f.value,!w)continue}else w=f.evaluate({zoom:a},e);E="constant"===_.kind?_.value:_.evaluate({zoom:a},e),i.addDash(w,E),e.patterns[u.id]=i.getKey(w,E)}}update(e,i,a,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,i,this.stateDependentLayers,a,u)}addFeatures(e,i,a,u,f){for(const _ of this.patternFeatures)this.addFeature(_,_.geometry,_.index,i,a,u)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(0!==this.layoutVertexArray2.length&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,xv)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,N_),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(e){if(e.properties&&e.properties.hasOwnProperty("mapbox_clip_start")&&e.properties.hasOwnProperty("mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}}addFeature(e,i,a,u,f,_){const w=this.layers[0].layout,E=w.get("line-join").evaluate(e,{}),D=w.get("line-cap").evaluate(e,{}),k=w.get("line-miter-limit"),z=w.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(const j of i)this.addLine(j,e,E,D,k,z);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,a,f,_,u)}addLine(e,i,a,u,f,_){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let ot=0;ot<e.length-1;ot++)this.totalDistance+=e[ot].dist(e[ot+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const w="Polygon"===bv[i.type];let E=e.length;for(;E>=2&&e[E-1].equals(e[E-2]);)E--;let D=0;for(;D<E-1&&e[D].equals(e[D+1]);)D++;if(E<(w?3:2))return;"bevel"===a&&(f=1.05);const k=this.overscaling<=16?15*Pi/(512*this.overscaling):0,z=this.segments.prepareSegment(10*E,this.layoutVertexArray,this.indexArray);let j,K,te,he,Oe;this.e1=this.e2=-1,w&&(j=e[E-2],Oe=e[D].sub(j)._unit()._perp());for(let ot=D;ot<E;ot++){if(te=ot===E-1?w?e[D+1]:void 0:e[ot+1],te&&e[ot].equals(te))continue;Oe&&(he=Oe),j&&(K=j),j=e[ot],Oe=te?te.sub(j)._unit()._perp():he,he=he||Oe;let Ct=he.add(Oe);0===Ct.x&&0===Ct.y||Ct._unit();const at=he.x*Oe.x+he.y*Oe.y,wt=Ct.x*Oe.x+Ct.y*Oe.y,At=0!==wt?1/wt:1/0,It=2*Math.sqrt(2-2*wt),un=wt<Wh&&K&&te,rn=he.x*Oe.y-he.y*Oe.x>0;if(un&&ot>D){const fn=j.dist(K);if(fn>2*k){const kn=j.sub(j.sub(K)._mult(k/fn)._round());this.updateDistance(K,kn),this.addCurrentVertex(kn,he,0,0,z),K=kn}}const En=K&&te;let $n=En?a:w?"butt":u;if(En&&"round"===$n&&(At<_?$n="miter":At<=2&&($n="fakeround")),"miter"===$n&&At>f&&($n="bevel"),"bevel"===$n&&(At>2&&($n="flipbevel"),At<f&&($n="miter")),K&&this.updateDistance(K,j),"miter"===$n)Ct._mult(At),this.addCurrentVertex(j,Ct,0,0,z);else if("flipbevel"===$n){if(At>100)Ct=Oe.mult(-1);else{const fn=At*he.add(Oe).mag()/he.sub(Oe).mag();Ct._perp()._mult(fn*(rn?-1:1))}this.addCurrentVertex(j,Ct,0,0,z),this.addCurrentVertex(j,Ct.mult(-1),0,0,z)}else if("bevel"===$n||"fakeround"===$n){const fn=-Math.sqrt(At*At-1),kn=rn?fn:0,Fn=rn?0:fn;if(K&&this.addCurrentVertex(j,he,kn,Fn,z),"fakeround"===$n){const Zn=Math.round(180*It/Math.PI/20);for(let Yn=1;Yn<Zn;Yn++){let Tn=Yn/Zn;if(.5!==Tn){const yi=Tn-.5;Tn+=Tn*yi*(Tn-1)*((1.0904+at*(at*(3.55645-1.43519*at)-3.2452))*yi*yi+(.848013+at*(.215638*at-1.06021)))}const si=Oe.sub(he)._mult(Tn)._add(he)._unit()._mult(rn?-1:1);this.addHalfVertex(j,si.x,si.y,!1,rn,0,z)}}te&&this.addCurrentVertex(j,Oe,-kn,-Fn,z)}else if("butt"===$n)this.addCurrentVertex(j,Ct,0,0,z);else if("square"===$n){const fn=K?1:-1;K||this.addCurrentVertex(j,Ct,fn,fn,z),this.addCurrentVertex(j,Ct,0,0,z),K&&this.addCurrentVertex(j,Ct,fn,fn,z)}else"round"===$n&&(K&&(this.addCurrentVertex(j,he,0,0,z),this.addCurrentVertex(j,he,1,1,z,!0)),te&&(this.addCurrentVertex(j,Oe,-1,-1,z,!0),this.addCurrentVertex(j,Oe,0,0,z)));if(un&&ot<E-1){const fn=j.dist(te);if(fn>2*k){const kn=j.add(te.sub(j)._mult(k/fn)._round());this.updateDistance(j,kn),this.addCurrentVertex(kn,Oe,0,0,z),j=kn}}}}addCurrentVertex(e,i,a,u,f,_=!1){const w=i.y*u-i.x,E=-i.y-i.x*u;this.addHalfVertex(e,i.x+i.y*a,i.y-i.x*a,_,!1,a,f),this.addHalfVertex(e,w,E,_,!0,-u,f)}addHalfVertex({x:e,y:i},a,u,f,_,w,E){this.layoutVertexArray.emplaceBack((e<<1)+(f?1:0),(i<<1)+(_?1:0),Math.round(63*a)+128,Math.round(63*u)+128,1+(0===w?0:w<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const D=E.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,D),E.primitiveLength++),_?this.e2=D:this.e1=D}updateScaledDistance(){if(this.lineClips){const e=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=e*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(e,i){this.distance+=e.dist(i),this.updateScaledDistance()}}ui(qh,"LineBucket",{omit:["layers","patternFeatures"]});const If=new ht({"line-cap":new $e(tn.layout_line["line-cap"]),"line-join":new $e(tn.layout_line["line-join"]),"line-miter-limit":new ue(tn.layout_line["line-miter-limit"]),"line-round-limit":new ue(tn.layout_line["line-round-limit"]),"line-sort-key":new $e(tn.layout_line["line-sort-key"])});var Yh={paint:new ht({"line-opacity":new $e(tn.paint_line["line-opacity"]),"line-color":new $e(tn.paint_line["line-color"]),"line-translate":new ue(tn.paint_line["line-translate"]),"line-translate-anchor":new ue(tn.paint_line["line-translate-anchor"]),"line-width":new $e(tn.paint_line["line-width"]),"line-gap-width":new $e(tn.paint_line["line-gap-width"]),"line-offset":new $e(tn.paint_line["line-offset"]),"line-blur":new $e(tn.paint_line["line-blur"]),"line-dasharray":new $e(tn.paint_line["line-dasharray"]),"line-pattern":new $e(tn.paint_line["line-pattern"]),"line-gradient":new pt(tn.paint_line["line-gradient"]),"line-trim-offset":new ue(tn.paint_line["line-trim-offset"])}),layout:If};const Zu=new class extends $e{possiblyEvaluate(t,e){return e=new N(Math.floor(e.zoom),{now:e.now,fadeDuration:e.fadeDuration,transition:e.transition}),super.possiblyEvaluate(t,e)}evaluate(t,e,i,a){return e=ze({},e,{zoom:Math.floor(e.zoom)}),super.evaluate(t,e,i,a)}}(Yh.paint.properties["line-width"].specification);function Jh(t,e){return e>0?e+2*t:t}Zu.useIntegerZoom=!0;const Af=$t([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Wd=$t([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),Kh=$t([{name:"a_projected_pos",components:4,type:"Float32"}],4);$t([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const qd=$t([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),rg=$t([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"}]);$t([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const Xh=$t([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),Qh=$t([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);$t([{name:"triangle",components:3,type:"Uint16"}]),$t([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),$t([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),$t([{type:"Float32",name:"offsetX"}]),$t([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var As=24;const Oa=128;function Yd(t,e){const{expression:i}=e;if("constant"===i.kind)return{kind:"constant",layoutSize:i.evaluate(new N(t+1))};if("source"===i.kind)return{kind:"source"};{const{zoomStops:a,interpolationType:u}=i;let f=0;for(;f<a.length&&a[f]<=t;)f++;f=Math.max(0,f-1);let _=f;for(;_<a.length&&a[_]<t+1;)_++;_=Math.min(a.length-1,_);const w=a[f],E=a[_];return"composite"===i.kind?{kind:"composite",minZoom:w,maxZoom:E,interpolationType:u}:{kind:"camera",minZoom:w,maxZoom:E,minSize:i.evaluate(new N(w)),maxSize:i.evaluate(new N(E)),interpolationType:u}}}function Jd(t,{uSize:e,uSizeT:i},{lowerSize:a,upperSize:u}){return"source"===t.kind?a/Oa:"composite"===t.kind?Kn(a/Oa,u/Oa,i):e}function Vu(t,e){let i=0,a=0;if("constant"===t.kind)a=t.layoutSize;else if("source"!==t.kind){const{interpolationType:u,minZoom:f,maxZoom:_}=t,w=u?ve(ps.interpolationFactor(u,e,f,_),0,1):0;"camera"===t.kind?a=Kn(t.minSize,t.maxSize,w):i=w}return{uSizeT:i,uSize:a}}var U_=Object.freeze({__proto__:null,SIZE_PACK_FACTOR:Oa,evaluateSizeForFeature:Jd,evaluateSizeForZoom:Vu,getSizeData:Yd});function sg(t,e,i){return t.sections.forEach(a=>{a.text=function(u,f,_){const w=f.layout.get("text-transform").evaluate(_,{});return"uppercase"===w?u=u.toLocaleUpperCase():"lowercase"===w&&(u=u.toLocaleLowerCase()),O.applyArabicShaping&&(u=O.applyArabicShaping(u)),u}(a.text,e,i)}),t}const ju={"!":"\ufe15","#":"\uff03",$:"\uff04","%":"\uff05","&":"\uff06","(":"\ufe35",")":"\ufe36","*":"\uff0a","+":"\uff0b",",":"\ufe10","-":"\ufe32",".":"\u30fb","/":"\uff0f",":":"\ufe13",";":"\ufe14","<":"\ufe3f","=":"\uff1d",">":"\ufe40","?":"\ufe16","@":"\uff20","[":"\ufe47","\\":"\uff3c","]":"\ufe48","^":"\uff3e",_:"\ufe33","`":"\uff40","{":"\ufe37","|":"\u2015","}":"\ufe38","~":"\uff5e","\xa2":"\uffe0","\xa3":"\uffe1","\xa5":"\uffe5","\xa6":"\uffe4","\xac":"\uffe2","\xaf":"\uffe3","\u2013":"\ufe32","\u2014":"\ufe31","\u2018":"\ufe43","\u2019":"\ufe44","\u201c":"\ufe41","\u201d":"\ufe42","\u2026":"\ufe19","\u2027":"\u30fb","\u20a9":"\uffe6","\u3001":"\ufe11","\u3002":"\ufe12","\u3008":"\ufe3f","\u3009":"\ufe40","\u300a":"\ufe3d","\u300b":"\ufe3e","\u300c":"\ufe41","\u300d":"\ufe42","\u300e":"\ufe43","\u300f":"\ufe44","\u3010":"\ufe3b","\u3011":"\ufe3c","\u3014":"\ufe39","\u3015":"\ufe3a","\u3016":"\ufe17","\u3017":"\ufe18","\uff01":"\ufe15","\uff08":"\ufe35","\uff09":"\ufe36","\uff0c":"\ufe10","\uff0d":"\ufe32","\uff0e":"\u30fb","\uff1a":"\ufe13","\uff1b":"\ufe14","\uff1c":"\ufe3f","\uff1e":"\ufe40","\uff1f":"\ufe16","\uff3b":"\ufe47","\uff3d":"\ufe48","\uff3f":"\ufe33","\uff5b":"\ufe37","\uff5c":"\u2015","\uff5d":"\ufe38","\uff5f":"\ufe35","\uff60":"\ufe36","\uff61":"\ufe12","\uff62":"\ufe41","\uff63":"\ufe42","\u2190":"\u2191","\u2192":"\u2193"};function Z_(t){return"\ufe36"===t||"\ufe48"===t||"\ufe38"===t||"\ufe44"===t||"\ufe42"===t||"\ufe3e"===t||"\ufe3c"===t||"\ufe3a"===t||"\ufe18"===t||"\ufe40"===t||"\ufe10"===t||"\ufe13"===t||"\ufe14"===t||"\uff40"===t||"\uffe3"===t||"\ufe11"===t||"\ufe12"===t}function V_(t){return"\ufe35"===t||"\ufe47"===t||"\ufe37"===t||"\ufe43"===t||"\ufe41"===t||"\ufe3d"===t||"\ufe3b"===t||"\ufe39"===t||"\ufe17"===t||"\ufe3f"===t}var j_=Ko,ag=function(t,e,i,a,u){var f,_,w=8*u-a-1,E=(1<<w)-1,D=E>>1,k=-7,z=i?u-1:0,j=i?-1:1,K=t[e+z];for(z+=j,f=K&(1<<-k)-1,K>>=-k,k+=w;k>0;f=256*f+t[e+z],z+=j,k-=8);for(_=f&(1<<-k)-1,f>>=-k,k+=a;k>0;_=256*_+t[e+z],z+=j,k-=8);if(0===f)f=1-D;else{if(f===E)return _?NaN:1/0*(K?-1:1);_+=Math.pow(2,a),f-=D}return(K?-1:1)*_*Math.pow(2,f-a)},ep=function(t,e,i,a,u,f){var _,w,E,D=8*f-u-1,k=(1<<D)-1,z=k>>1,j=23===u?Math.pow(2,-24)-Math.pow(2,-77):0,K=a?0:f-1,te=a?1:-1,he=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(w=isNaN(e)?1:0,_=k):(_=Math.floor(Math.log(e)/Math.LN2),e*(E=Math.pow(2,-_))<1&&(_--,E*=2),(e+=_+z>=1?j/E:j*Math.pow(2,1-z))*E>=2&&(_++,E/=2),_+z>=k?(w=0,_=k):_+z>=1?(w=(e*E-1)*Math.pow(2,u),_+=z):(w=e*Math.pow(2,z-1)*Math.pow(2,u),_=0));u>=8;t[i+K]=255&w,K+=te,w/=256,u-=8);for(_=_<<u|w,D+=u;D>0;t[i+K]=255&_,K+=te,_/=256,D-=8);t[i+K-te]|=128*he};function Ko(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length}Ko.Varint=0,Ko.Fixed64=1,Ko.Bytes=2,Ko.Fixed32=5;var Sf=4294967296,Pf=1/Sf,tp=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function Ha(t){return t.type===Ko.Bytes?t.readVarint()+t.pos:t.pos+1}function Of(t,e,i){var a=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));i.realloc(a);for(var u=i.pos-1;u>=t;u--)i.buf[u+a]=i.buf[u]}function $_(t,e){for(var i=0;i<t.length;i++)e.writeVarint(t[i])}function lg(t,e){for(var i=0;i<t.length;i++)e.writeSVarint(t[i])}function wv(t,e){for(var i=0;i<t.length;i++)e.writeFloat(t[i])}function H_(t,e){for(var i=0;i<t.length;i++)e.writeDouble(t[i])}function np(t,e){for(var i=0;i<t.length;i++)e.writeBoolean(t[i])}function G_(t,e){for(var i=0;i<t.length;i++)e.writeFixed32(t[i])}function Hu(t,e){for(var i=0;i<t.length;i++)e.writeSFixed32(t[i])}function Kd(t,e){for(var i=0;i<t.length;i++)e.writeFixed64(t[i])}function W_(t,e){for(var i=0;i<t.length;i++)e.writeSFixed64(t[i])}function Xd(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+16777216*t[e+3]}function Gu(t,e,i){t[i]=e,t[i+1]=e>>>8,t[i+2]=e>>>16,t[i+3]=e>>>24}function cg(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+(t[e+3]<<24)}Ko.prototype={destroy:function(){this.buf=null},readFields:function(t,e,i){for(i=i||this.length;this.pos<i;){var a=this.readVarint(),u=a>>3,f=this.pos;this.type=7&a,t(u,e,this),this.pos===f&&this.skip(a)}return e},readMessage:function(t,e){return this.readFields(t,e,this.readVarint()+this.pos)},readFixed32:function(){var t=Xd(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=cg(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=Xd(this.buf,this.pos)+Xd(this.buf,this.pos+4)*Sf;return this.pos+=8,t},readSFixed64:function(){var t=Xd(this.buf,this.pos)+cg(this.buf,this.pos+4)*Sf;return this.pos+=8,t},readFloat:function(){var t=ag(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=ag(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var e,i,a=this.buf;return e=127&(i=a[this.pos++]),i<128?e:(e|=(127&(i=a[this.pos++]))<<7,i<128?e:(e|=(127&(i=a[this.pos++]))<<14,i<128?e:(e|=(127&(i=a[this.pos++]))<<21,i<128?e:function(u,f,_){var w,E,D=_.buf;if(w=(112&(E=D[_.pos++]))>>4,E<128||(w|=(127&(E=D[_.pos++]))<<3,E<128)||(w|=(127&(E=D[_.pos++]))<<10,E<128)||(w|=(127&(E=D[_.pos++]))<<17,E<128)||(w|=(127&(E=D[_.pos++]))<<24,E<128)||(w|=(1&(E=D[_.pos++]))<<31,E<128))return function $u(t,e,i){return i?4294967296*e+(t>>>0):4294967296*(e>>>0)+(t>>>0)}(u,w,f);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(i=a[this.pos]))<<28,t,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var t=this.readVarint()+this.pos,e=this.pos;return this.pos=t,t-e>=12&&tp?tp.decode(this.buf.subarray(e,t)):function(i,a,u){for(var f="",_=a;_<u;){var w,E,D,k=i[_],z=null,j=k>239?4:k>223?3:k>191?2:1;if(_+j>u)break;1===j?k<128&&(z=k):2===j?128==(192&(w=i[_+1]))&&(z=(31&k)<<6|63&w)<=127&&(z=null):3===j?(E=i[_+2],128==(192&(w=i[_+1]))&&128==(192&E)&&((z=(15&k)<<12|(63&w)<<6|63&E)<=2047||z>=55296&&z<=57343)&&(z=null)):4===j&&(E=i[_+2],D=i[_+3],128==(192&(w=i[_+1]))&&128==(192&E)&&128==(192&D)&&((z=(15&k)<<18|(63&w)<<12|(63&E)<<6|63&D)<=65535||z>=1114112)&&(z=null)),null===z?(z=65533,j=1):z>65535&&(z-=65536,f+=String.fromCharCode(z>>>10&1023|55296),z=56320|1023&z),f+=String.fromCharCode(z),_+=j}return f}(this.buf,e,t)},readBytes:function(){var t=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,t);return this.pos=t,e},readPackedVarint:function(t,e){if(this.type!==Ko.Bytes)return t.push(this.readVarint(e));var i=Ha(this);for(t=t||[];this.pos<i;)t.push(this.readVarint(e));return t},readPackedSVarint:function(t){if(this.type!==Ko.Bytes)return t.push(this.readSVarint());var e=Ha(this);for(t=t||[];this.pos<e;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){if(this.type!==Ko.Bytes)return t.push(this.readBoolean());var e=Ha(this);for(t=t||[];this.pos<e;)t.push(this.readBoolean());return t},readPackedFloat:function(t){if(this.type!==Ko.Bytes)return t.push(this.readFloat());var e=Ha(this);for(t=t||[];this.pos<e;)t.push(this.readFloat());return t},readPackedDouble:function(t){if(this.type!==Ko.Bytes)return t.push(this.readDouble());var e=Ha(this);for(t=t||[];this.pos<e;)t.push(this.readDouble());return t},readPackedFixed32:function(t){if(this.type!==Ko.Bytes)return t.push(this.readFixed32());var e=Ha(this);for(t=t||[];this.pos<e;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){if(this.type!==Ko.Bytes)return t.push(this.readSFixed32());var e=Ha(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){if(this.type!==Ko.Bytes)return t.push(this.readFixed64());var e=Ha(this);for(t=t||[];this.pos<e;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){if(this.type!==Ko.Bytes)return t.push(this.readSFixed64());var e=Ha(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed64());return t},skip:function(t){var e=7&t;if(e===Ko.Varint)for(;this.buf[this.pos++]>127;);else if(e===Ko.Bytes)this.pos=this.readVarint()+this.pos;else if(e===Ko.Fixed32)this.pos+=4;else{if(e!==Ko.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(t,e){this.writeVarint(t<<3|e)},realloc:function(t){for(var e=this.length||16;e<this.pos+t;)e*=2;if(e!==this.length){var i=new Uint8Array(e);i.set(this.buf),this.buf=i,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),Gu(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),Gu(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),Gu(this.buf,-1&t,this.pos),Gu(this.buf,Math.floor(t*Pf),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),Gu(this.buf,-1&t,this.pos),Gu(this.buf,Math.floor(t*Pf),this.pos+4),this.pos+=8},writeVarint:function(t){(t=+t||0)>268435455||t<0?function(e,i){var a,u,f,w;if(e>=0?(a=e%4294967296|0,u=e/4294967296|0):(u=~(-e/4294967296),4294967295^(a=~(-e%4294967296))?a=a+1|0:(a=0,u=u+1|0)),e>=0x10000000000000000||e<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");i.realloc(10),f=a,(w=i).buf[w.pos++]=127&f|128,f>>>=7,w.buf[w.pos++]=127&f|128,f>>>=7,w.buf[w.pos++]=127&f|128,f>>>=7,w.buf[w.pos++]=127&f|128,w.buf[w.pos]=127&(f>>>=7),function(f,_){var w=(7&f)<<4;_.buf[_.pos++]|=w|((f>>>=3)?128:0),f&&(_.buf[_.pos++]=127&f|((f>>>=7)?128:0),f&&(_.buf[_.pos++]=127&f|((f>>>=7)?128:0),f&&(_.buf[_.pos++]=127&f|((f>>>=7)?128:0),f&&(_.buf[_.pos++]=127&f|((f>>>=7)?128:0),f&&(_.buf[_.pos++]=127&f)))))}(u,i)}(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))},writeSVarint:function(t){this.writeVarint(t<0?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(!!t)},writeString:function(t){t=String(t),this.realloc(4*t.length),this.pos++;var e=this.pos;this.pos=function(a,u,f){for(var _,w,E=0;E<u.length;E++){if((_=u.charCodeAt(E))>55295&&_<57344){if(!w){_>56319||E+1===u.length?(a[f++]=239,a[f++]=191,a[f++]=189):w=_;continue}if(_<56320){a[f++]=239,a[f++]=191,a[f++]=189,w=_;continue}_=w-55296<<10|_-56320|65536,w=null}else w&&(a[f++]=239,a[f++]=191,a[f++]=189,w=null);_<128?a[f++]=_:(_<2048?a[f++]=_>>6|192:(_<65536?a[f++]=_>>12|224:(a[f++]=_>>18|240,a[f++]=_>>12&63|128),a[f++]=_>>6&63|128),a[f++]=63&_|128)}return f}(this.buf,t,this.pos);var i=this.pos-e;i>=128&&Of(e,i,this),this.pos=e-1,this.writeVarint(i),this.pos+=i},writeFloat:function(t){this.realloc(4),ep(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),ep(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var e=t.length;this.writeVarint(e),this.realloc(e);for(var i=0;i<e;i++)this.buf[this.pos++]=t[i]},writeRawMessage:function(t,e){this.pos++;var i=this.pos;t(e,this);var a=this.pos-i;a>=128&&Of(i,a,this),this.pos=i-1,this.writeVarint(a),this.pos+=a},writeMessage:function(t,e,i){this.writeTag(t,Ko.Bytes),this.writeRawMessage(e,i)},writePackedVarint:function(t,e){e.length&&this.writeMessage(t,$_,e)},writePackedSVarint:function(t,e){e.length&&this.writeMessage(t,lg,e)},writePackedBoolean:function(t,e){e.length&&this.writeMessage(t,np,e)},writePackedFloat:function(t,e){e.length&&this.writeMessage(t,wv,e)},writePackedDouble:function(t,e){e.length&&this.writeMessage(t,H_,e)},writePackedFixed32:function(t,e){e.length&&this.writeMessage(t,G_,e)},writePackedSFixed32:function(t,e){e.length&&this.writeMessage(t,Hu,e)},writePackedFixed64:function(t,e){e.length&&this.writeMessage(t,Kd,e)},writePackedSFixed64:function(t,e){e.length&&this.writeMessage(t,W_,e)},writeBytesField:function(t,e){this.writeTag(t,Ko.Bytes),this.writeBytes(e)},writeFixed32Field:function(t,e){this.writeTag(t,Ko.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(t,e){this.writeTag(t,Ko.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(t,e){this.writeTag(t,Ko.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(t,e){this.writeTag(t,Ko.Fixed64),this.writeSFixed64(e)},writeVarintField:function(t,e){this.writeTag(t,Ko.Varint),this.writeVarint(e)},writeSVarintField:function(t,e){this.writeTag(t,Ko.Varint),this.writeSVarint(e)},writeStringField:function(t,e){this.writeTag(t,Ko.Bytes),this.writeString(e)},writeFloatField:function(t,e){this.writeTag(t,Ko.Fixed32),this.writeFloat(e)},writeDoubleField:function(t,e){this.writeTag(t,Ko.Fixed64),this.writeDouble(e)},writeBooleanField:function(t,e){this.writeVarintField(t,!!e)}};var ip=be(j_);const op=3;function q_(t,e,i){e.glyphs=[],1===t&&i.readMessage(Rf,e)}function Rf(t,e,i){if(3===t){const{id:a,bitmap:u,width:f,height:_,left:w,top:E,advance:D}=i.readMessage(Qd,{});e.glyphs.push({id:a,bitmap:new Kl({width:f+2*op,height:_+2*op},u),metrics:{width:f,height:_,left:w,top:E,advance:D}})}else 4===t?e.ascender=i.readSVarint():5===t&&(e.descender=i.readSVarint())}function Qd(t,e,i){1===t?e.id=i.readVarint():2===t?e.bitmap=i.readBytes():3===t?e.width=i.readVarint():4===t?e.height=i.readVarint():5===t?e.left=i.readSVarint():6===t?e.top=i.readSVarint():7===t&&(e.advance=i.readVarint())}const Lf=op;function ug(t){let e=0,i=0;for(const _ of t)e+=_.w*_.h,i=Math.max(i,_.w);t.sort((_,w)=>w.h-_.h);const a=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),i),h:1/0}];let u=0,f=0;for(const _ of t)for(let w=a.length-1;w>=0;w--){const E=a[w];if(!(_.w>E.w||_.h>E.h)){if(_.x=E.x,_.y=E.y,f=Math.max(f,_.y+_.h),u=Math.max(u,_.x+_.w),_.w===E.w&&_.h===E.h){const D=a.pop();w<a.length&&(a[w]=D)}else _.h===E.h?(E.x+=_.w,E.w-=_.w):_.w===E.w?(E.y+=_.h,E.h-=_.h):(a.push({x:E.x+_.w,y:E.y,w:E.w-_.w,h:_.h}),E.y+=_.h,E.h-=_.h);break}}return{w:u,h:f,fill:e/(u*f)||0}}const js=1;class Tc{constructor(e,{pixelRatio:i,version:a,stretchX:u,stretchY:f,content:_}){this.paddedRect=e,this.pixelRatio=i,this.stretchX=u,this.stretchY=f,this.content=_,this.version=a}get tl(){return[this.paddedRect.x+js,this.paddedRect.y+js]}get br(){return[this.paddedRect.x+this.paddedRect.w-js,this.paddedRect.y+this.paddedRect.h-js]}get displaySize(){return[(this.paddedRect.w-2*js)/this.pixelRatio,(this.paddedRect.h-2*js)/this.pixelRatio]}}class eh{constructor(e,i){const a={},u={};this.haveRenderCallbacks=[];const f=[];this.addImages(e,a,f),this.addImages(i,u,f);const{w:_,h:w}=ug(f),E=new Ca({width:_||1,height:w||1});for(const D in e){const k=e[D],z=a[D].paddedRect;Ca.copy(k.data,E,{x:0,y:0},{x:z.x+js,y:z.y+js},k.data)}for(const D in i){const k=i[D],z=u[D].paddedRect,j=z.x+js,K=z.y+js,te=k.data.width,he=k.data.height;Ca.copy(k.data,E,{x:0,y:0},{x:j,y:K},k.data),Ca.copy(k.data,E,{x:0,y:he-1},{x:j,y:K-1},{width:te,height:1}),Ca.copy(k.data,E,{x:0,y:0},{x:j,y:K+he},{width:te,height:1}),Ca.copy(k.data,E,{x:te-1,y:0},{x:j-1,y:K},{width:1,height:he}),Ca.copy(k.data,E,{x:0,y:0},{x:j+te,y:K},{width:1,height:he})}this.image=E,this.iconPositions=a,this.patternPositions=u}addImages(e,i,a){for(const u in e){const f=e[u],_={x:0,y:0,w:f.data.width+2*js,h:f.data.height+2*js};a.push(_),i[u]=new Tc(_,f),f.hasRenderCallback&&this.haveRenderCallbacks.push(u)}}patchUpdatedImages(e,i){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(a=>e.hasImage(a)),e.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const a in e.updatedImages)this.patchUpdatedImage(this.iconPositions[a],e.getImage(a),i),this.patchUpdatedImage(this.patternPositions[a],e.getImage(a),i)}patchUpdatedImage(e,i,a){if(!e||!i||e.version===i.version)return;e.version=i.version;const[u,f]=e.tl;a.update(i.data,void 0,{x:u,y:f})}}ui(Tc,"ImagePosition"),ui(eh,"ImageAtlas");const Ta={horizontal:1,vertical:2,horizontalOnly:3},kf=-17;class th{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(e,i){const a=new th;return a.scale=e||1,a.fontStack=i,a}static forImage(e){const i=new th;return i.imageName=e,i}}class Wu{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(e,i){const a=new Wu;for(let u=0;u<e.sections.length;u++){const f=e.sections[u];f.image?a.addImageSection(f):a.addTextSection(f,i)}return a}length(){return this.text.length}getSection(e){return this.sections[this.sectionIndex[e]]}getSections(){return this.sections}getSectionIndex(e){return this.sectionIndex[e]}getCharCode(e){return this.text.charCodeAt(e)}verticalizePunctuation(e){this.text=function(i,a){let u="";for(let f=0;f<i.length;f++){const _=i.charCodeAt(f+1)||null,w=i.charCodeAt(f-1)||null;u+=!a&&(_&&le(_)&&!ju[i[f+1]]||w&&le(w)&&!ju[i[f-1]])||!ju[i[f]]?i[f]:ju[i[f]]}return u}(this.text,e)}trim(){let e=0;for(let a=0;a<this.text.length&&rp[this.text.charCodeAt(a)];a++)e++;let i=this.text.length;for(let a=this.text.length-1;a>=0&&a>=e&&rp[this.text.charCodeAt(a)];a--)i--;this.text=this.text.substring(e,i),this.sectionIndex=this.sectionIndex.slice(e,i)}substring(e,i){const a=new Wu;return a.text=this.text.substring(e,i),a.sectionIndex=this.sectionIndex.slice(e,i),a.sections=this.sections,a}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((e,i)=>Math.max(e,this.sections[i].scale),0)}addTextSection(e,i){this.text+=e.text,this.sections.push(th.forText(e.scale,e.fontStack||i));const a=this.sections.length-1;for(let u=0;u<e.text.length;++u)this.sectionIndex.push(a)}addImageSection(e){const i=e.image?e.image.name:"";if(0===i.length)return void St("Can't add FormattedSection with an empty image.");const a=this.getNextImageSectionCharCode();a?(this.text+=String.fromCharCode(a),this.sections.push(th.forImage(i)),this.sectionIndex.push(this.sections.length-1)):St("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Ff(t,e,i,a,u,f,_,w,E,D,k,z,j,K,te){const he=Wu.fromFeature(t,u);z===Ta.vertical&&he.verticalizePunctuation(j);let Oe=[];const ot=function(It,un,rn,En,$n,fn){if(!It)return[];const kn=[],Fn=function(si,yi,li,no,Jn,Ei){let Wi=0;for(let Ao=0;Ao<si.length();Ao++){const Yi=si.getSection(Ao);Wi+=dg(si.getCharCode(Ao),Yi,no,Jn,yi,Ei)}return Wi/Math.max(1,Math.ceil(Wi/li))}(It,un,rn,En,$n,fn),Zn=It.text.indexOf("\u200b")>=0;let Yn=0;for(let si=0;si<It.length();si++){const yi=It.getSection(si),li=It.getCharCode(si);if(rp[li]||(Yn+=dg(li,yi,En,$n,un,fn)),si<It.length()-1){const no=!((Tn=li)<11904||!(ai["Bopomofo Extended"](Tn)||ai.Bopomofo(Tn)||ai["CJK Compatibility Forms"](Tn)||ai["CJK Compatibility Ideographs"](Tn)||ai["CJK Compatibility"](Tn)||ai["CJK Radicals Supplement"](Tn)||ai["CJK Strokes"](Tn)||ai["CJK Symbols and Punctuation"](Tn)||ai["CJK Unified Ideographs Extension A"](Tn)||ai["CJK Unified Ideographs"](Tn)||ai["Enclosed CJK Letters and Months"](Tn)||ai["Halfwidth and Fullwidth Forms"](Tn)||ai.Hiragana(Tn)||ai["Ideographic Description Characters"](Tn)||ai["Kangxi Radicals"](Tn)||ai["Katakana Phonetic Extensions"](Tn)||ai.Katakana(Tn)||ai["Vertical Forms"](Tn)||ai["Yi Radicals"](Tn)||ai["Yi Syllables"](Tn)));(Y_[li]||no||yi.imageName)&&kn.push(Ml(si+1,Yn,Fn,kn,qu(li,It.getCharCode(si+1),no&&Zn),!1))}}var Tn;return Nf(Ml(It.length(),Yn,Fn,kn,0,!0))}(he,D,f,e,a,K),{processBidirectionalText:Ct,processStyledBidirectionalText:at}=O;if(Ct&&1===he.sections.length){const It=Ct(he.toString(),ot);for(const un of It){const rn=new Wu;rn.text=un,rn.sections=he.sections;for(let En=0;En<un.length;En++)rn.sectionIndex.push(0);Oe.push(rn)}}else if(at){const It=at(he.text,he.sectionIndex,ot);for(const un of It){const rn=new Wu;rn.text=un[0],rn.sectionIndex=un[1],rn.sections=he.sections,Oe.push(rn)}}else Oe=function(It,un){const rn=[],En=It.text;let $n=0;for(const fn of un)rn.push(It.substring($n,fn)),$n=fn;return $n<En.length&&rn.push(It.substring($n,En.length)),rn}(he,ot);const wt=[],At={positionedLines:wt,text:he.toString(),top:k[1],bottom:k[1],left:k[0],right:k[0],writingMode:z,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(It,un,rn,En,$n,fn,kn,Fn,Zn,Yn,Tn,si){let yi=0,li=0,no=0;const Jn="right"===Fn?1:"left"===Fn?0:.5;let Ei=!1;for(const io of $n){const ro=io.getSections();for(const Zo of ro){if(Zo.imageName)continue;const cr=un[Zo.fontStack];if(cr&&(Ei=void 0!==cr.ascender&&void 0!==cr.descender,!Ei))break}if(!Ei)break}let Wi=0;for(const io of $n){io.trim();const ro=io.getMaxScale(),Zo=(ro-1)*As,cr={positionedGlyphs:[],lineOffset:0};It.positionedLines[Wi]=cr;const ur=cr.positionedGlyphs;let nr=0;if(!io.length()){li+=fn,++Wi;continue}let Er=0,Dr=0;for(let $o=0;$o<io.length();$o++){const ts=io.getSection($o),$r=io.getSectionIndex($o),Lr=io.getCharCode($o);let Po=ts.scale,Hr=null,ir=null,Qs=null,Gr=As,as=0;const ns=!(Zn===Ta.horizontal||!Tn&&!U(Lr)||Tn&&(rp[Lr]||(Ao=Lr,ai.Arabic(Ao)||ai["Arabic Supplement"](Ao)||ai["Arabic Extended-A"](Ao)||ai["Arabic Presentation Forms-A"](Ao)||ai["Arabic Presentation Forms-B"](Ao))));if(ts.imageName){const $s=En[ts.imageName];if(!$s)continue;Qs=ts.imageName,It.iconsInText=It.iconsInText||!0,ir=$s.paddedRect;const ls=$s.displaySize;Po=Po*As/si,Hr={width:ls[0],height:ls[1],left:js,top:-Lf,advance:ns?ls[1]:ls[0],localGlyph:!1},as=Ei?-Hr.height*Po:kf+ro*As-ls[1]*Po,Gr=Hr.advance;const hl=(ns?ls[0]:ls[1])*Po-As*ro;hl>0&&hl>nr&&(nr=hl)}else{const $s=rn[ts.fontStack];if(!$s)continue;$s[Lr]&&(ir=$s[Lr]);const ls=un[ts.fontStack];if(!ls)continue;const hl=ls.glyphs[Lr];if(!hl)continue;if(Hr=hl.metrics,Gr=8203!==Lr?As:0,Ei){const ld=void 0!==ls.ascender?Math.abs(ls.ascender):0,cd=void 0!==ls.descender?Math.abs(ls.descender):0,du=(ld+cd)*Po;Er<du&&(Er=du,Dr=(ld-cd)/2*Po),as=-ld*Po}else as=kf+(ro-Po)*As}ns?(It.verticalizable=!0,ur.push({glyph:Lr,imageName:Qs,x:yi,y:li+as,vertical:ns,scale:Po,localGlyph:Hr.localGlyph,fontStack:ts.fontStack,sectionIndex:$r,metrics:Hr,rect:ir}),yi+=Gr*Po+Yn):(ur.push({glyph:Lr,imageName:Qs,x:yi,y:li+as,vertical:ns,scale:Po,localGlyph:Hr.localGlyph,fontStack:ts.fontStack,sectionIndex:$r,metrics:Hr,rect:ir}),yi+=Hr.advance*Po+Yn)}0!==ur.length&&(no=Math.max(yi-Yn,no),Ei?pg(ur,Jn,nr,Dr,fn*ro/2):pg(ur,Jn,nr,0,fn/2)),yi=0;const Rr=fn*ro+nr;cr.lineOffset=Math.max(nr,Zo),li+=Rr,++Wi}var Ao;const Yi=li,{horizontalAlign:Ni,verticalAlign:Yo}=hg(kn);(function(io,ro,Zo,cr,ur,nr){const Er=(ro-Zo)*ur,Dr=-nr*cr;for(const Rr of io)for(const $o of Rr.positionedGlyphs)$o.x+=Er,$o.y+=Dr})(It.positionedLines,Jn,Ni,Yo,no,Yi),It.top+=-Yo*Yi,It.bottom=It.top+Yi,It.left+=-Ni*no,It.right=It.left+no,It.hasBaseline=Ei}(At,e,i,a,Oe,_,w,E,z,D,j,te),!function(It){for(const un of It)if(0!==un.positionedGlyphs.length)return!1;return!0}(wt)&&At}const rp={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Y_={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function dg(t,e,i,a,u,f){if(e.imageName){const _=a[e.imageName];return _?_.displaySize[0]*e.scale*As/f+u:0}{const _=i[e.fontStack],w=_&&_.glyphs[t];return w?w.metrics.advance*e.scale+u:0}}function Bf(t,e,i,a){const u=Math.pow(t-e,2);return a?t<e?u/2:2*u:u+Math.abs(i)*i}function qu(t,e,i){let a=0;return 10===t&&(a-=1e4),i&&(a+=150),40!==t&&65288!==t||(a+=50),41!==e&&65289!==e||(a+=50),a}function Ml(t,e,i,a,u,f){let _=null,w=Bf(e,i,u,f);for(const E of a){const D=Bf(e-E.x,i,u,f)+E.badness;D<=w&&(_=E,w=D)}return{index:t,x:e,priorBreak:_,badness:w}}function Nf(t){return t?Nf(t.priorBreak).concat(t.index):[]}function hg(t){let e=.5,i=.5;switch(t){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0}switch(t){case"bottom":case"bottom-right":case"bottom-left":i=1;break;case"top":case"top-right":case"top-left":i=0}return{horizontalAlign:e,verticalAlign:i}}function pg(t,e,i,a,u){if(!(e||i||a||u))return;const f=t.length-1,_=t[f],w=(_.x+_.metrics.advance*_.scale)*e;for(let E=0;E<=f;E++)t[E].x-=w,t[E].y+=i+a+u}function Cv(t,e,i){const{horizontalAlign:a,verticalAlign:u}=hg(i),f=e[0]-t.displaySize[0]*a,_=e[1]-t.displaySize[1]*u;return{image:t,top:_,bottom:_+t.displaySize[1],left:f,right:f+t.displaySize[0]}}function J_(t,e,i,a,u,f){const _=t.image;let w;if(_.content){const Oe=_.content,ot=_.pixelRatio||1;w=[Oe[0]/ot,Oe[1]/ot,_.displaySize[0]-Oe[2]/ot,_.displaySize[1]-Oe[3]/ot]}const E=e.left*f,D=e.right*f;let k,z,j,K;"width"===i||"both"===i?(K=u[0]+E-a[3],z=u[0]+D+a[1]):(K=u[0]+(E+D-_.displaySize[0])/2,z=K+_.displaySize[0]);const te=e.top*f,he=e.bottom*f;return"height"===i||"both"===i?(k=u[1]+te-a[0],j=u[1]+he+a[2]):(k=u[1]+(te+he-_.displaySize[1])/2,j=k+_.displaySize[1]),{image:_,top:k,right:z,bottom:j,left:K,collisionPadding:w}}class Il extends Me{constructor(e,i,a,u,f){super(e,i),this.angle=u,this.z=a,void 0!==f&&(this.segment=f)}clone(){return new Il(this.x,this.y,this.z,this.angle,this.segment)}}function zf(t,e,i,a,u){if(void 0===e.segment)return!0;let f=e,_=e.segment+1,w=0;for(;w>-i/2;){if(_--,_<0)return!1;w-=t[_].dist(f),f=t[_]}w+=t[_].dist(t[_+1]),_++;const E=[];let D=0;for(;w<i/2;){const k=t[_],z=t[_+1];if(!z)return!1;let j=t[_-1].angleTo(k)-k.angleTo(z);for(j=Math.abs((j+3*Math.PI)%(2*Math.PI)-Math.PI),E.push({distance:w,angleDelta:j}),D+=j;w-E[0].distance>a;)D-=E.shift().angleDelta;if(D>u)return!1;_++,w+=k.dist(z)}return!0}function K_(t){let e=0;for(let i=0;i<t.length-1;i++)e+=t[i].dist(t[i+1]);return e}function Uf(t,e,i){return t?.6*e*i:0}function nh(t,e){return Math.max(t?t.right-t.left:0,e?e.right-e.left:0)}function fg(t,e,i,a,u,f){const _=Uf(i,u,f),w=nh(i,a)*f;let E=0;const D=K_(t)/2;for(let k=0;k<t.length-1;k++){const z=t[k],j=t[k+1],K=z.dist(j);if(E+K>D){const te=(D-E)/K,he=Kn(z.x,j.x,te),Oe=Kn(z.y,j.y,te),ot=new Il(he,Oe,0,j.angleTo(z),k);return!_||zf(t,ot,w,_,e)?ot:void 0}E+=K}}function mg(t,e,i,a,u,f,_,w,E){const D=Uf(a,f,_),k=nh(a,u),z=k*_,j=0===t[0].x||t[0].x===E||0===t[0].y||t[0].y===E;return e-z<e/4&&(e=z+e/4),Zf(t,j?e/2*w%e:(k/2+2*f)*_*w%e,e,D,i,z,j,!1,E)}function Zf(t,e,i,a,u,f,_,w,E){const D=f/2,k=K_(t);let z=0,j=e-i,K=[];for(let te=0;te<t.length-1;te++){const he=t[te],Oe=t[te+1],ot=he.dist(Oe),Ct=Oe.angleTo(he);for(;j+i<z+ot;){j+=i;const at=(j-z)/ot,wt=Kn(he.x,Oe.x,at),At=Kn(he.y,Oe.y,at);if(wt>=0&&wt<E&&At>=0&&At<E&&j-D>=0&&j+D<=k){const It=new Il(wt,At,0,Ct,te);It._round(),a&&!zf(t,It,f,a,u)||K.push(It)}}z+=ot}return w||K.length||_||(K=Zf(t,z/2,i,a,u,f,_,!0,E)),K}function _o(t,e,i,a,u){const f=[];for(let _=0;_<t.length;_++){const w=t[_];let E;for(let D=0;D<w.length-1;D++){let k=w[D],z=w[D+1];k.x<e&&z.x<e||(k.x<e?k=new Me(e,k.y+(e-k.x)/(z.x-k.x)*(z.y-k.y))._round():z.x<e&&(z=new Me(e,k.y+(e-k.x)/(z.x-k.x)*(z.y-k.y))._round()),k.y<i&&z.y<i||(k.y<i?k=new Me(k.x+(i-k.y)/(z.y-k.y)*(z.x-k.x),i)._round():z.y<i&&(z=new Me(k.x+(i-k.y)/(z.y-k.y)*(z.x-k.x),i)._round()),k.x>=a&&z.x>=a||(k.x>=a?k=new Me(a,k.y+(a-k.x)/(z.x-k.x)*(z.y-k.y))._round():z.x>=a&&(z=new Me(a,k.y+(a-k.x)/(z.x-k.x)*(z.y-k.y))._round()),k.y>=u&&z.y>=u||(k.y>=u?k=new Me(k.x+(u-k.y)/(z.y-k.y)*(z.x-k.x),u)._round():z.y>=u&&(z=new Me(k.x+(u-k.y)/(z.y-k.y)*(z.x-k.x),u)._round()),E&&k.equals(E[E.length-1])||(E=[k],f.push(E)),E.push(z)))))}}return f}ui(Il,"Anchor");const Yu=1e20;function Vf(t,e,i,a,u,f,_,w,E){for(let D=e;D<e+a;D++)X_(t,i*f+D,f,u,_,w,E);for(let D=i;D<i+u;D++)X_(t,D*f+e,1,a,_,w,E)}function X_(t,e,i,a,u,f,_){f[0]=0,_[0]=-Yu,_[1]=Yu,u[0]=t[e];for(let w=1,E=0,D=0;w<a;w++){u[w]=t[e+w*i];const k=w*w;do{const z=f[E];D=(u[w]-u[z]+k-z*z)/(w-z)/2}while(D<=_[E]&&--E>-1);E++,f[E]=w,_[E]=D,_[E+1]=Yu}for(let w=0,E=0;w<a;w++){for(;_[E+1]<w;)E++;const D=f[E],k=w-D;t[e+w*i]=u[D]+k*k}}const cl=2,sp={none:0,ideographs:1,all:2};class Ju{constructor(e,i,a){this.requestManager=e,this.localGlyphMode=i,this.localFontFamily=a,this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(e){this.url=e}getGlyphs(e,i){const a=[];for(const u in e)for(const f of e[u])a.push({stack:u,id:f});mt(a,({stack:u,id:f},_)=>{let w=this.entries[u];w||(w=this.entries[u]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let E=w.glyphs[f];if(void 0!==E)return void _(null,{stack:u,id:f,glyph:E});if(E=this._tinySDF(w,u,f),E)return w.glyphs[f]=E,void _(null,{stack:u,id:f,glyph:E});const D=Math.floor(f/256);if(256*D>65535)return void _(new Error("glyphs > 65535 not supported"));if(w.ranges[D])return void _(null,{stack:u,id:f,glyph:E});let k=w.requests[D];k||(k=w.requests[D]=[],Ju.loadGlyphRange(u,D,this.url,this.requestManager,(z,j)=>{if(j){w.ascender=j.ascender,w.descender=j.descender;for(const K in j.glyphs)this._doesCharSupportLocalGlyph(+K)||(w.glyphs[+K]=j.glyphs[+K]);w.ranges[D]=!0}for(const K of k)K(z,j);delete w.requests[D]})),k.push((z,j)=>{z?_(z):j&&_(null,{stack:u,id:f,glyph:j.glyphs[f]||null})})},(u,f)=>{if(u)i(u);else if(f){const _={};for(const{stack:w,id:E,glyph:D}of f)void 0===_[w]&&(_[w]={}),void 0===_[w].glyphs&&(_[w].glyphs={}),_[w].glyphs[E]=D&&{id:D.id,bitmap:D.bitmap.clone(),metrics:D.metrics},_[w].ascender=this.entries[w].ascender,_[w].descender=this.entries[w].descender;i(null,_)}})}_doesCharSupportLocalGlyph(e){return this.localGlyphMode!==sp.none&&(this.localGlyphMode===sp.all?!!this.localFontFamily:!!this.localFontFamily&&(ai["CJK Unified Ideographs"](e)||ai["Hangul Syllables"](e)||ai.Hiragana(e)||ai.Katakana(e)||ai["CJK Symbols and Punctuation"](e)))}_tinySDF(e,i,a){const u=this.localFontFamily;if(!u||!this._doesCharSupportLocalGlyph(a))return;let f=e.tinySDF;if(!f){let he="400";/bold/i.test(i)?he="900":/medium/i.test(i)?he="500":/light/i.test(i)&&(he="200"),f=e.tinySDF=new Ju.TinySDF({fontFamily:u,fontWeight:he,fontSize:24*cl,buffer:3*cl,radius:8*cl}),f.fontWeight=he}if(this.localGlyphs[f.fontWeight][a])return this.localGlyphs[f.fontWeight][a];const _=String.fromCharCode(a),{data:w,width:E,height:D,glyphWidth:k,glyphHeight:z,glyphLeft:j,glyphTop:K,glyphAdvance:te}=f.draw(_);return this.localGlyphs[f.fontWeight][a]={id:a,bitmap:new Kl({width:E,height:D},w),metrics:{width:k/cl,height:z/cl,left:j/cl,top:K/cl-27,advance:te/cl,localGlyph:!0}}}}Ju.loadGlyphRange=function(t,e,i,a,u){const f=256*e,_=f+255,w=a.transformRequest(a.normalizeGlyphsURL(i).replace("{fontstack}",t).replace("{range}",`${f}-${_}`),ct.Glyphs);ri(w,(E,D)=>{if(E)u(E);else if(D){const k={},z=new ip(D).readFields(q_,{});for(const j of z.glyphs)k[j.id]=j;u(null,{glyphs:k,ascender:z.ascender,descender:z.descender})}})},Ju.TinySDF=class{constructor({fontSize:t=24,buffer:e=3,radius:i=8,cutoff:a=.25,fontFamily:u="sans-serif",fontWeight:f="normal",fontStyle:_="normal"}={}){this.buffer=e,this.cutoff=a,this.radius=i;const w=this.size=t+4*e,E=this._createCanvas(w),D=this.ctx=E.getContext("2d",{willReadFrequently:!0});D.font=`${_} ${f} ${t}px ${u}`,D.textBaseline="alphabetic",D.textAlign="left",D.fillStyle="black",this.gridOuter=new Float64Array(w*w),this.gridInner=new Float64Array(w*w),this.f=new Float64Array(w),this.z=new Float64Array(w+1),this.v=new Uint16Array(w)}_createCanvas(t){const e=document.createElement("canvas");return e.width=e.height=t,e}draw(t){const{width:e,actualBoundingBoxAscent:i,actualBoundingBoxDescent:a,actualBoundingBoxLeft:u,actualBoundingBoxRight:f}=this.ctx.measureText(t),_=Math.ceil(i),w=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(f-u))),E=Math.min(this.size-this.buffer,_+Math.ceil(a)),D=w+2*this.buffer,k=E+2*this.buffer,z=Math.max(D*k,0),j=new Uint8ClampedArray(z),K={data:j,width:D,height:k,glyphWidth:w,glyphHeight:E,glyphTop:_,glyphLeft:0,glyphAdvance:e};if(0===w||0===E)return K;const{ctx:te,buffer:he,gridInner:Oe,gridOuter:ot}=this;te.clearRect(he,he,w,E),te.fillText(t,he,he+_);const Ct=te.getImageData(he,he,w,E);ot.fill(Yu,0,z),Oe.fill(0,0,z);for(let at=0;at<E;at++)for(let wt=0;wt<w;wt++){const At=Ct.data[4*(at*w+wt)+3]/255;if(0===At)continue;const It=(at+he)*D+wt+he;if(1===At)ot[It]=0,Oe[It]=Yu;else{const un=.5-At;ot[It]=un>0?un*un:0,Oe[It]=un<0?un*un:0}}Vf(ot,0,0,D,k,D,this.f,this.v,this.z),Vf(Oe,he,he,w,E,D,this.f,this.v,this.z);for(let at=0;at<z;at++){const wt=Math.sqrt(ot[at])-Math.sqrt(Oe[at]);j[at]=Math.round(255-255*(wt/this.radius+this.cutoff))}return K}};const Ku=js;function jf(t,e,i,a){const u=[],f=t.image,_=f.pixelRatio,w=f.paddedRect.w-2*Ku,E=f.paddedRect.h-2*Ku,D=t.right-t.left,k=t.bottom-t.top,z=f.stretchX||[[0,w]],j=f.stretchY||[[0,E]],K=(fn,kn)=>fn+kn[1]-kn[0],te=z.reduce(K,0),he=j.reduce(K,0),Oe=w-te,ot=E-he;let Ct=0,at=te,wt=0,At=he,It=0,un=Oe,rn=0,En=ot;if(f.content&&a){const fn=f.content;Ct=ap(z,0,fn[0]),wt=ap(j,0,fn[1]),at=ap(z,fn[0],fn[2]),At=ap(j,fn[1],fn[3]),It=fn[0]-Ct,rn=fn[1]-wt,un=fn[2]-fn[0]-at,En=fn[3]-fn[1]-At}const $n=(fn,kn,Fn,Zn)=>{const Yn=lp(fn.stretch-Ct,at,D,t.left),Tn=cp(fn.fixed-It,un,fn.stretch,te),si=lp(kn.stretch-wt,At,k,t.top),yi=cp(kn.fixed-rn,En,kn.stretch,he),li=lp(Fn.stretch-Ct,at,D,t.left),no=cp(Fn.fixed-It,un,Fn.stretch,te),Jn=lp(Zn.stretch-wt,At,k,t.top),Ei=cp(Zn.fixed-rn,En,Zn.stretch,he),Wi=new Me(Yn,si),Ao=new Me(li,si),Yi=new Me(li,Jn),Ni=new Me(Yn,Jn),Yo=new Me(Tn/_,yi/_),io=new Me(no/_,Ei/_),ro=e*Math.PI/180;if(ro){const ur=Math.sin(ro),nr=Math.cos(ro),Er=[nr,-ur,ur,nr];Wi._matMult(Er),Ao._matMult(Er),Ni._matMult(Er),Yi._matMult(Er)}const Zo=fn.stretch+fn.fixed,cr=kn.stretch+kn.fixed;return{tl:Wi,tr:Ao,bl:Ni,br:Yi,tex:{x:f.paddedRect.x+Ku+Zo,y:f.paddedRect.y+Ku+cr,w:Fn.stretch+Fn.fixed-Zo,h:Zn.stretch+Zn.fixed-cr},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Yo,pixelOffsetBR:io,minFontScaleX:un/_/D,minFontScaleY:En/_/k,isSDF:i}};if(a&&(f.stretchX||f.stretchY)){const fn=$f(z,Oe,te),kn=$f(j,ot,he);for(let Fn=0;Fn<fn.length-1;Fn++){const Zn=fn[Fn],Yn=fn[Fn+1];for(let Tn=0;Tn<kn.length-1;Tn++)u.push($n(Zn,kn[Tn],Yn,kn[Tn+1]))}}else u.push($n({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:w+1},{fixed:0,stretch:E+1}));return u}function ap(t,e,i){let a=0;for(const u of t)a+=Math.max(e,Math.min(i,u[1]))-Math.max(e,Math.min(i,u[0]));return a}function $f(t,e,i){const a=[{fixed:-Ku,stretch:0}];for(const[u,f]of t){const _=a[a.length-1];a.push({fixed:u-_.stretch,stretch:_.stretch}),a.push({fixed:u-_.stretch,stretch:_.stretch+(f-u)})}return a.push({fixed:e+Ku,stretch:i}),a}function lp(t,e,i,a){return t/e*i+a}function cp(t,e,i,a){return t-e*i/a}function Tv(t,e,i,a){const u=e+t.positionedLines[a].lineOffset;return 0===a?i+u/2:i+(u+(e+t.positionedLines[a-1].lineOffset))/2}class gg{constructor(e=[],i=_g){if(this.data=e,this.length=this.data.length,this.compare=i,this.length>0)for(let a=(this.length>>1)-1;a>=0;a--)this._down(a)}push(e){this.data.push(e),this.length++,this._up(this.length-1)}pop(){if(0===this.length)return;const e=this.data[0],i=this.data.pop();return this.length--,this.length>0&&(this.data[0]=i,this._down(0)),e}peek(){return this.data[0]}_up(e){const{data:i,compare:a}=this,u=i[e];for(;e>0;){const f=e-1>>1,_=i[f];if(a(u,_)>=0)break;i[e]=_,e=f}i[e]=u}_down(e){const{data:i,compare:a}=this,u=this.length>>1,f=i[e];for(;e<u;){let _=1+(e<<1),w=i[_];const E=_+1;if(E<this.length&&a(i[E],w)<0&&(_=E,w=i[E]),a(w,f)>=0)break;i[e]=w,e=_}i[e]=f}}function _g(t,e){return t<e?-1:t>e?1:0}function Ec(t,e=1,i=!1){let a=1/0,u=1/0,f=-1/0,_=-1/0;const w=t[0];for(let K=0;K<w.length;K++){const te=w[K];(!K||te.x<a)&&(a=te.x),(!K||te.y<u)&&(u=te.y),(!K||te.x>f)&&(f=te.x),(!K||te.y>_)&&(_=te.y)}const E=Math.min(f-a,_-u);let D=E/2;const k=new gg([],Xu);if(0===E)return new Me(a,u);for(let K=a;K<f;K+=E)for(let te=u;te<_;te+=E)k.push(new lu(K+D,te+D,D,t));let z=function(K){let te=0,he=0,Oe=0;const ot=K[0];for(let Ct=0,at=ot.length,wt=at-1;Ct<at;wt=Ct++){const At=ot[Ct],It=ot[wt],un=At.x*It.y-It.x*At.y;he+=(At.x+It.x)*un,Oe+=(At.y+It.y)*un,te+=3*un}return new lu(he/te,Oe/te,0,K)}(t),j=k.length;for(;k.length;){const K=k.pop();(K.d>z.d||!z.d)&&(z=K,i&&console.log("found best %d after %d probes",Math.round(1e4*K.d)/1e4,j)),K.max-z.d<=e||(D=K.h/2,k.push(new lu(K.p.x-D,K.p.y-D,D,t)),k.push(new lu(K.p.x+D,K.p.y-D,D,t)),k.push(new lu(K.p.x-D,K.p.y+D,D,t)),k.push(new lu(K.p.x+D,K.p.y+D,D,t)),j+=4)}return i&&(console.log(`num probes: ${j}`),console.log(`best distance: ${z.d}`)),z.p}function Xu(t,e){return e.max-t.max}class lu{constructor(e,i,a,u){this.p=new Me(e,i),this.h=a,this.d=function(f,_){let w=!1,E=1/0;for(let D=0;D<_.length;D++){const k=_[D];for(let z=0,j=k.length,K=j-1;z<j;K=z++){const te=k[z],he=k[K];te.y>f.y!=he.y>f.y&&f.x<(he.x-te.x)*(f.y-te.y)/(he.y-te.y)+te.x&&(w=!w),E=Math.min(E,hf(f,te,he))}}return(w?1:-1)*Math.sqrt(E)}(this.p,u),this.max=this.d+this.h*Math.SQRT2}}const Qu=7,ed=Number.POSITIVE_INFINITY,td=Math.sqrt(2);function up(t,[e,i]){let a=0,u=0;if(i===ed){e<0&&(e=0);const f=e/td;switch(t){case"top-right":case"top-left":u=f-Qu;break;case"bottom-right":case"bottom-left":u=-f+Qu;break;case"bottom":u=-e+Qu;break;case"top":u=e-Qu}switch(t){case"top-right":case"bottom-right":a=-f;break;case"top-left":case"bottom-left":a=f;break;case"left":a=e;break;case"right":a=-e}}else{switch(e=Math.abs(e),i=Math.abs(i),t){case"top-right":case"top-left":case"top":u=i-Qu;break;case"bottom-right":case"bottom-left":case"bottom":u=-i+Qu}switch(t){case"top-right":case"bottom-right":case"right":a=-e;break;case"top-left":case"bottom-left":case"left":a=e}}return[a,u]}function ih(t,e,i,a,u,f,_,w,E,D){t.createArrays(),t.tilePixelRatio=Pi/(512*t.overscaling),t.compareText={},t.iconsNeedLinear=!1;const k=t.layers[0].layout,z=t.layers[0]._unevaluatedLayout._values,j={};if("composite"===t.textSizeData.kind){const{minZoom:he,maxZoom:Oe}=t.textSizeData;j.compositeTextSizes=[z["text-size"].possiblyEvaluate(new N(he),w),z["text-size"].possiblyEvaluate(new N(Oe),w)]}if("composite"===t.iconSizeData.kind){const{minZoom:he,maxZoom:Oe}=t.iconSizeData;j.compositeIconSizes=[z["icon-size"].possiblyEvaluate(new N(he),w),z["icon-size"].possiblyEvaluate(new N(Oe),w)]}j.layoutTextSize=z["text-size"].possiblyEvaluate(new N(E+1),w),j.layoutIconSize=z["icon-size"].possiblyEvaluate(new N(E+1),w),j.textMaxSize=z["text-size"].possiblyEvaluate(new N(18),w);const K="map"===k.get("text-rotation-alignment")&&"point"!==k.get("symbol-placement"),te=k.get("text-size");for(const he of t.features){const Oe=k.get("text-font").evaluate(he,{},w).join(","),ot=te.evaluate(he,{},w),Ct=j.layoutTextSize.evaluate(he,{},w),at=(j.layoutIconSize.evaluate(he,{},w),{horizontal:{},vertical:void 0}),wt=he.text;let At,It=[0,0];if(wt){const En=wt.toString(),$n=k.get("text-letter-spacing").evaluate(he,{},w)*As,fn=k.get("text-line-height").evaluate(he,{},w)*As,kn=B(En)?$n:0,Fn=k.get("text-anchor").evaluate(he,{},w),Zn=k.get("text-variable-anchor");if(!Zn){const li=k.get("text-radial-offset").evaluate(he,{},w);It=li?up(Fn,[li*As,ed]):k.get("text-offset").evaluate(he,{},w).map(no=>no*As)}let Yn=K?"center":k.get("text-justify").evaluate(he,{},w);const Tn="point"===k.get("symbol-placement"),si=Tn?k.get("text-max-width").evaluate(he,{},w)*As:1/0,yi=li=>{t.allowVerticalPlacement&&L(En)&&(at.vertical=Ff(wt,e,i,u,Oe,si,fn,Fn,li,kn,It,Ta.vertical,!0,Ct,ot))};if(!K&&Zn){const li="auto"===Yn?Zn.map(Jn=>dp(Jn)):[Yn];let no=!1;for(let Jn=0;Jn<li.length;Jn++){const Ei=li[Jn];if(!at.horizontal[Ei])if(no)at.horizontal[Ei]=at.horizontal[0];else{const Wi=Ff(wt,e,i,u,Oe,si,fn,"center",Ei,kn,It,Ta.horizontal,!1,Ct,ot);Wi&&(at.horizontal[Ei]=Wi,no=1===Wi.positionedLines.length)}}yi("left")}else{if("auto"===Yn&&(Yn=dp(Fn)),Tn||k.get("text-writing-mode").indexOf("horizontal")>=0||!L(En)){const li=Ff(wt,e,i,u,Oe,si,fn,Fn,Yn,kn,It,Ta.horizontal,!1,Ct,ot);li&&(at.horizontal[Yn]=li)}yi(Tn?"left":Yn)}}let un=!1;if(he.icon&&he.icon.name){const En=a[he.icon.name];En&&(At=Cv(u[he.icon.name],k.get("icon-offset").evaluate(he,{},w),k.get("icon-anchor").evaluate(he,{},w)),un=En.sdf,void 0===t.sdfIcons?t.sdfIcons=En.sdf:t.sdfIcons!==En.sdf&&St("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(En.pixelRatio!==t.pixelRatio||0!==k.get("icon-rotate").constantOr(1))&&(t.iconsNeedLinear=!0))}const rn=hp(at.horizontal)||at.vertical;t.iconsInText||(t.iconsInText=!!rn&&rn.iconsInText),(rn||At)&&Hf(t,he,at,At,a,j,Ct,0,It,un,_,w,D)}f&&t.generateCollisionDebugBuffers(E,t.collisionBoxArray)}function dp(t){switch(t){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Hf(t,e,i,a,u,f,_,w,E,D,k,z,j){let K=f.textMaxSize.evaluate(e,{},z);void 0===K&&(K=_);const te=t.layers[0].layout,he=te.get("icon-offset").evaluate(e,{},z),Oe=hp(i.horizontal)||i.vertical,ot="globe"===j.name,Ct=As,at=_/Ct,wt=t.tilePixelRatio*K/Ct,At=(Fn=t.overscaling,t.zoom>18&&Fn>2&&(Fn>>=1),Math.max(Pi/(512*Fn),1)*te.get("symbol-spacing")),It=te.get("text-padding")*t.tilePixelRatio,un=te.get("icon-padding")*t.tilePixelRatio,rn=Te(te.get("text-max-angle")),En="map"===te.get("text-rotation-alignment")&&"point"!==te.get("symbol-placement"),$n="map"===te.get("icon-rotation-alignment")&&"point"!==te.get("symbol-placement"),fn=te.get("symbol-placement"),kn=At/2;var Fn;const Zn=te.get("icon-text-fit");let Yn;a&&"none"!==Zn&&(t.allowVerticalPlacement&&i.vertical&&(Yn=J_(a,i.vertical,Zn,te.get("icon-text-fit-padding"),he,at)),Oe&&(a=J_(a,Oe,Zn,te.get("icon-text-fit-padding"),he,at)));const Tn=(si,yi,li)=>{if(yi.x<0||yi.x>=Pi||yi.y<0||yi.y>=Pi)return;let no=null;if(ot){const{x:Jn,y:Ei,z:Wi}=j.projectTilePoint(yi.x,yi.y,li);no={anchor:new Il(Jn,Ei,Wi,0,void 0),up:j.upVector(li,yi.x,yi.y)}}!function(Jn,Ei,Wi,Ao,Yi,Ni,Yo,io,ro,Zo,cr,ur,nr,Er,Dr,Rr,$o,ts,$r,Lr,Po,Hr,ir,Qs,Gr){const as=Jn.addToLineVertexArray(Ei,Ao);let ns,$s,ls,hl,ld,cd,du,Mp=0,jg=0,hh=0,ph=0,fh=-1,Ip=-1;const Ol={};let $g=Up("");const hu=Wi?Wi.anchor:Ei;let ud=0,dd=0;if(void 0===ro._unevaluatedLayout.getValue("text-radial-offset")?[ud,dd]=ro.layout.get("text-offset").evaluate(Po,{},Gr).map(Ea=>Ea*As):(ud=ro.layout.get("text-radial-offset").evaluate(Po,{},Gr)*As,dd=ed),Jn.allowVerticalPlacement&&Yi.vertical){const Ea=Yi.vertical;if(Dr)cd=Wf(Ea),io&&(du=Wf(io));else{const ca=ro.layout.get("text-rotate").evaluate(Po,{},Gr)+90;ls=pp(Zo,hu,Ei,cr,ur,nr,Ea,Er,ca,Rr),io&&(hl=pp(Zo,hu,Ei,cr,ur,nr,io,ts,ca))}}if(Ni){const Ea=ro.layout.get("icon-rotate").evaluate(Po,{},Gr),ca="none"!==ro.layout.get("icon-text-fit"),pu=jf(Ni,Ea,ir,ca),Sp=io?jf(io,Ea,ir,ca):void 0;$s=pp(Zo,hu,Ei,cr,ur,nr,Ni,ts,Ea),Mp=4*pu.length;const Pp=Jn.iconSizeData;let Pc=null;"source"===Pp.kind?(Pc=[Oa*ro.layout.get("icon-size").evaluate(Po,{},Gr)],Pc[0]>Al&&St(`${Jn.layerIds[0]}: Value for "icon-size" is >= ${cu}. Reduce your "icon-size".`)):"composite"===Pp.kind&&(Pc=[Oa*Hr.compositeIconSizes[0].evaluate(Po,{},Gr),Oa*Hr.compositeIconSizes[1].evaluate(Po,{},Gr)],(Pc[0]>Al||Pc[1]>Al)&&St(`${Jn.layerIds[0]}: Value for "icon-size" is >= ${cu}. Reduce your "icon-size".`)),Jn.addSymbols(Jn.icon,pu,Pc,Lr,$r,Po,!1,Wi,Ei,as.lineStartIndex,as.lineLength,-1,Qs,Gr),fh=Jn.icon.placedSymbolArray.length-1,Sp&&(jg=4*Sp.length,Jn.addSymbols(Jn.icon,Sp,Pc,Lr,$r,Po,Ta.vertical,Wi,Ei,as.lineStartIndex,as.lineLength,-1,Qs,Gr),Ip=Jn.icon.placedSymbolArray.length-1)}for(const Ea in Yi.horizontal){const ca=Yi.horizontal[Ea];ns||($g=Up(ca.text),Dr?ld=Wf(ca):ns=pp(Zo,hu,Ei,cr,ur,nr,ca,Er,ro.layout.get("text-rotate").evaluate(Po,{},Gr),Rr));const pu=1===ca.positionedLines.length;if(hh+=Gf(Jn,Wi,Ei,ca,Yo,ro,Dr,Po,Rr,as,Yi.vertical?Ta.horizontal:Ta.horizontalOnly,pu?Object.keys(Yi.horizontal):[Ea],Ol,fh,Hr,Qs,Gr),pu)break}Yi.vertical&&(ph+=Gf(Jn,Wi,Ei,Yi.vertical,Yo,ro,Dr,Po,Rr,as,Ta.vertical,["vertical"],Ol,Ip,Hr,Qs,Gr));let Rl=-1;const Ap=(Ea,ca)=>Ea?Math.max(Ea,ca):ca;Rl=Ap(ld,Rl),Rl=Ap(cd,Rl),Rl=Ap(du,Rl);const my=Rl>-1?1:0;Jn.glyphOffsetArray.length>=Mc.MAX_GLYPHS&&St("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==Po.sortKey&&Jn.addToSortKeyRanges(Jn.symbolInstances.length,Po.sortKey),Jn.symbolInstances.emplaceBack(hu.x,hu.y,hu.z,Ei.x,Ei.y,Ol.right>=0?Ol.right:-1,Ol.center>=0?Ol.center:-1,Ol.left>=0?Ol.left:-1,Ol.vertical>=0?Ol.vertical:-1,fh,Ip,$g,void 0!==ns?ns:Jn.collisionBoxArray.length,void 0!==ns?ns+1:Jn.collisionBoxArray.length,void 0!==ls?ls:Jn.collisionBoxArray.length,void 0!==ls?ls+1:Jn.collisionBoxArray.length,void 0!==$s?$s:Jn.collisionBoxArray.length,void 0!==$s?$s+1:Jn.collisionBoxArray.length,hl||Jn.collisionBoxArray.length,hl?hl+1:Jn.collisionBoxArray.length,cr,hh,ph,Mp,jg,my,0,ud,dd,Rl)}(t,yi,no,si,i,a,u,Yn,t.layers[0],t.collisionBoxArray,e.index,e.sourceLayerIndex,t.index,It,En,E,0,un,$n,he,e,f,D,k,z)};if("line"===fn)for(const si of _o(e.geometry,0,0,Pi,Pi)){const yi=mg(si,At,rn,i.vertical||Oe,a,Ct,wt,t.overscaling,Pi);for(const li of yi)Oe&&Q_(t,Oe.text,kn,li)||Tn(si,li,z)}else if("line-center"===fn){for(const si of e.geometry)if(si.length>1){const yi=fg(si,rn,i.vertical||Oe,a,Ct,wt);yi&&Tn(si,yi,z)}}else if("Polygon"===e.type)for(const si of Cf(e.geometry,0)){const yi=Ec(si,16);Tn(si[0],new Il(yi.x,yi.y,0,0,void 0),z)}else if("LineString"===e.type)for(const si of e.geometry)Tn(si,new Il(si[0].x,si[0].y,0,0,void 0),z);else if("Point"===e.type)for(const si of e.geometry)for(const yi of si)Tn([yi],new Il(yi.x,yi.y,0,0,void 0),z)}const cu=255,Al=cu*Oa;function Gf(t,e,i,a,u,f,_,w,E,D,k,z,j,K,te,he,Oe){const ot=function(wt,At,It,un,rn,En,$n,fn){const kn=[];if(0===At.positionedLines.length)return kn;const Fn=un.layout.get("text-rotate").evaluate(En,{})*Math.PI/180,Zn=function(li){const no=li[0],Jn=li[1],Ei=no*Jn;return Ei>0?[no,-Jn]:Ei<0?[-no,Jn]:0===no?[Jn,no]:[Jn,-no]}(It);let Yn=Math.abs(At.top-At.bottom);for(const li of At.positionedLines)Yn-=li.lineOffset;const Tn=At.positionedLines.length,si=Yn/Tn;let yi=At.top-It[1];for(let li=0;li<Tn;++li){const no=At.positionedLines[li];yi=Tv(At,si,yi,li);for(const Jn of no.positionedGlyphs){if(!Jn.rect)continue;const Ei=Jn.rect||{};let Wi=Lf+1,Ao=!0,Yi=1,Ni=0;if(Jn.imageName){const ir=$n[Jn.imageName];if(!ir)continue;if(ir.sdf){St("SDF images are not supported in formatted text and will be ignored.");continue}Ao=!1,Yi=ir.pixelRatio,Wi=js/Yi}const Yo=(rn||fn)&&Jn.vertical,io=Jn.metrics.advance*Jn.scale/2,ro=Jn.metrics,Zo=Jn.rect;if(null===Zo)continue;fn&&At.verticalizable&&(Ni=Jn.imageName?io-Jn.metrics.width*Jn.scale/2:0);const cr=rn?[Jn.x+io,Jn.y]:[0,0];let ur=[0,0],nr=[0,0],Er=!1;rn||(Yo?(nr=[Jn.x+io+Zn[0],Jn.y+Zn[1]-Ni],Er=!0):ur=[Jn.x+io+It[0],Jn.y+It[1]-Ni]);const Dr=Zo.w*Jn.scale/(Yi*(Jn.localGlyph?cl:1)),Rr=Zo.h*Jn.scale/(Yi*(Jn.localGlyph?cl:1));let $o,ts,$r,Lr;if(Yo){const ir=Jn.y-yi,Qs=new Me(-io,io-ir),Gr=-Math.PI/2,as=new Me(...nr);$o=new Me(-io+ur[0],ur[1]),$o._rotateAround(Gr,Qs)._add(as),$o.x+=-ir+io,$o.y-=(ro.left-Wi)*Jn.scale;const ns=Jn.imageName?ro.advance*Jn.scale:As*Jn.scale,$s=String.fromCharCode(Jn.glyph);Z_($s)?$o.x+=(1-Wi)*Jn.scale:V_($s)?$o.x+=ns-ro.height*Jn.scale+(-Wi-1)*Jn.scale:$o.x+=Jn.imageName||ro.width+2*Wi===Zo.w&&ro.height+2*Wi===Zo.h?(ns-Rr)/2:(ns-(ro.height+2*Wi)*Jn.scale)/2,ts=new Me($o.x,$o.y-Dr),$r=new Me($o.x+Rr,$o.y),Lr=new Me($o.x+Rr,$o.y-Dr)}else{const ir=(ro.left-Wi)*Jn.scale-io+ur[0],Qs=(-ro.top-Wi)*Jn.scale+ur[1],Gr=ir+Dr,as=Qs+Rr;$o=new Me(ir,Qs),ts=new Me(Gr,Qs),$r=new Me(ir,as),Lr=new Me(Gr,as)}if(Fn){let ir;ir=rn?new Me(0,0):Er?new Me(Zn[0],Zn[1]):new Me(It[0],It[1]),$o._rotateAround(Fn,ir),ts._rotateAround(Fn,ir),$r._rotateAround(Fn,ir),Lr._rotateAround(Fn,ir)}const Po=new Me(0,0),Hr=new Me(0,0);kn.push({tl:$o,tr:ts,bl:$r,br:Lr,tex:Ei,writingMode:At.writingMode,glyphOffset:cr,sectionIndex:Jn.sectionIndex,isSDF:Ao,pixelOffsetTL:Po,pixelOffsetBR:Hr,minFontScaleX:0,minFontScaleY:0})}}return kn}(0,a,E,f,_,w,u,t.allowVerticalPlacement),Ct=t.textSizeData;let at=null;"source"===Ct.kind?(at=[Oa*f.layout.get("text-size").evaluate(w,{},Oe)],at[0]>Al&&St(`${t.layerIds[0]}: Value for "text-size" is >= ${cu}. Reduce your "text-size".`)):"composite"===Ct.kind&&(at=[Oa*te.compositeTextSizes[0].evaluate(w,{},Oe),Oa*te.compositeTextSizes[1].evaluate(w,{},Oe)],(at[0]>Al||at[1]>Al)&&St(`${t.layerIds[0]}: Value for "text-size" is >= ${cu}. Reduce your "text-size".`)),t.addSymbols(t.text,ot,at,E,_,w,k,e,i,D.lineStartIndex,D.lineLength,K,he,Oe);for(const wt of z)j[wt]=t.text.placedSymbolArray.length-1;return 4*ot.length}function hp(t){for(const e in t)return t[e];return null}function pp(t,e,i,a,u,f,_,w,E,D){let k=_.top,z=_.bottom,j=_.left,K=_.right;const te=_.collisionPadding;if(te&&(j-=te[0],k-=te[1],K+=te[2],z+=te[3]),E){const he=new Me(j,k),Oe=new Me(K,k),ot=new Me(j,z),Ct=new Me(K,z),at=Te(E);let wt=new Me(0,0);D&&(wt=new Me(D[0],D[1])),he._rotateAround(at,wt),Oe._rotateAround(at,wt),ot._rotateAround(at,wt),Ct._rotateAround(at,wt),j=Math.min(he.x,Oe.x,ot.x,Ct.x),K=Math.max(he.x,Oe.x,ot.x,Ct.x),k=Math.min(he.y,Oe.y,ot.y,Ct.y),z=Math.max(he.y,Oe.y,ot.y,Ct.y)}return t.emplaceBack(e.x,e.y,e.z,i.x,i.y,j,k,K,z,w,a,u,f),t.length-1}function Wf(t){t.collisionPadding&&(t.top-=t.collisionPadding[1],t.bottom+=t.collisionPadding[3]);const e=t.bottom-t.top;return e>0?Math.max(10,e):null}function Q_(t,e,i,a){const u=t.compareText;if(e in u){const f=u[e];for(let _=f.length-1;_>=0;_--)if(a.dist(f[_])<i)return!0}else u[e]=[];return u[e].push(a),!1}function qf(t,e){const i=t.fovAboveCenter,a=t.elevation?t.elevation.getMinElevationBelowMSL()*e:0,u=(t._camera.position[2]*t.worldSize-a)/Math.cos(t._pitch),f=Math.sin(i)*u/Math.sin(Math.max(Math.PI/2-t._pitch-i,.01)),_=Math.sin(t._pitch)*f+u;return Math.min(1.01*_,u*(1/t._horizonShift))}function uu(t,e){if(!e.isReprojectedInTileSpace)return{scale:1<<t.z,x:t.x,y:t.y,x2:t.x+1,y2:t.y+1,projection:e};const i=Math.pow(2,-t.z),a=t.x*i,u=(t.x+1)*i,f=t.y*i,_=(t.y+1)*i,w=wa(a),E=wa(u),D=vs(f),k=vs(_),z=e.project(w,D),j=e.project(E,D),K=e.project(E,k),te=e.project(w,k);let he=Math.min(z.x,j.x,K.x,te.x),Oe=Math.min(z.y,j.y,K.y,te.y),ot=Math.max(z.x,j.x,K.x,te.x),Ct=Math.max(z.y,j.y,K.y,te.y);const at=i/16;function wt(It,un,rn,En,$n,fn){const kn=(rn+$n)/2,Fn=(En+fn)/2,Zn=e.project(wa(kn),vs(Fn)),Yn=Math.max(0,he-Zn.x,Oe-Zn.y,Zn.x-ot,Zn.y-Ct);he=Math.min(he,Zn.x),ot=Math.max(ot,Zn.x),Oe=Math.min(Oe,Zn.y),Ct=Math.max(Ct,Zn.y),Yn>at&&(wt(It,Zn,rn,En,kn,Fn),wt(Zn,un,kn,Fn,$n,fn))}wt(z,j,a,f,u,f),wt(j,K,u,f,u,_),wt(K,te,u,_,a,_),wt(te,z,a,_,a,f),he-=at,Oe-=at,ot+=at,Ct+=at;const At=1/Math.max(ot-he,Ct-Oe);return{scale:At,x:he*At,y:Oe*At,x2:ot*At,y2:Ct*At,projection:e}}const ey=ol(new Float32Array(16));class Dc{constructor(e){this.spec=e,this.name=e.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(e,i){return{x:0,y:0,z:0}}unproject(e,i){return new tr(0,0)}projectTilePoint(e,i,a){return{x:e,y:i,z:0}}locationPoint(e,i,a=!0){return e._coordinatePoint(e.locationCoordinate(i),a)}pixelsPerMeter(e,i){return Zs(1,e)*i}pixelSpaceConversion(e,i,a){return 1}farthestPixelDistance(e){return qf(e,e.pixelsPerMeter)}pointCoordinate(e,i,a,u){const f=e.horizonLineFromTop(!1),_=new Me(i,Math.max(f,a));return e.rayIntersectionCoordinate(e.pointRayIntersection(_,u))}pointCoordinate3D(e,i,a){const u=new Me(i,a);if(e.elevation)return e.elevation.pointCoordinate(u);{const f=this.pointCoordinate(e,u.x,u.y,0);return[f.x,f.y,f.z]}}isPointAboveHorizon(e,i){if(e.elevation)return!this.pointCoordinate3D(e,i.x,i.y);const a=e.horizonLineFromTop();return i.y<a}createInversionMatrix(e,i){return ey}createTileMatrix(e,i,a){let u,f,_;const w=a.canonical,E=ol(new Float64Array(16));if(this.isReprojectedInTileSpace){const D=uu(w,this);u=1,f=D.x+a.wrap*D.scale,_=D.y,Kc(E,E,[u/D.scale,u/D.scale,e.pixelsPerMeter/i])}else u=i/e.zoomScale(w.z),f=(w.x+Math.pow(2,w.z)*a.wrap)*u,_=w.y*u;return Eu(E,E,[f,_,0]),Kc(E,E,[u/Pi,u/Pi,1]),E}upVector(e,i,a){return[0,0,1]}upVectorScale(e,i,a){return{metersToTile:1}}}class ty extends Dc{constructor(e){super(e),this.range=[4,7],this.center=e.center||[-96,37.5];const[i,a]=this.parallels=e.parallels||[29.5,45.5],u=Math.sin(Te(i));this.n=(u+Math.sin(Te(a)))/2,this.c=1+u*(2*this.n-u),this.r0=Math.sqrt(this.c)/this.n}project(e,i){const{n:a,c:u,r0:f}=this,_=Te(e-this.center[0]),w=Te(i),E=Math.sqrt(u-2*a*Math.sin(w))/a;return{x:E*Math.sin(_*a),y:E*Math.cos(_*a)-f,z:0}}unproject(e,i){const{n:a,c:u,r0:f}=this,_=f+i;let w=Math.atan2(e,Math.abs(_))*Math.sign(_);_*a<0&&(w-=Math.PI*Math.sign(e)*Math.sign(_));const E=Te(this.center[0])*a;w=dt(w,-Math.PI-E,Math.PI-E);const D=ve(ae(w/a)+this.center[0],-180,180),k=Math.asin(ve((u-(e*e+_*_)*a*a)/(2*a),-1,1)),z=ve(ae(k),-Vs,Vs);return new tr(D,z)}}const nd=1.340264,id=-.081106,oh=893e-6,rh=.003796,Xs=Math.sqrt(3)/2;class ny extends Dc{project(e,i){i=i/180*Math.PI,e=e/180*Math.PI;const a=Math.asin(Xs*Math.sin(i)),u=a*a,f=u*u*u;return{x:.5*(e*Math.cos(a)/(Xs*(nd+3*id*u+f*(7*oh+9*rh*u)))/Math.PI+.5),y:1-.5*(a*(nd+id*u+f*(oh+rh*u))/Math.PI+1),z:0}}unproject(e,i){e=(2*e-.5)*Math.PI;let a=i=(2*(1-i)-1)*Math.PI,u=a*a,f=u*u*u;for(let k,z,j,K=0;K<12&&(z=a*(nd+id*u+f*(oh+rh*u))-i,j=nd+3*id*u+f*(7*oh+9*rh*u),k=z/j,a=ve(a-k,-Math.PI/3,Math.PI/3),u=a*a,f=u*u*u,!(Math.abs(k)<1e-12));++K);const _=Xs*e*(nd+3*id*u+f*(7*oh+9*rh*u))/Math.cos(a),w=Math.asin(Math.sin(a)/Xs),E=ve(180*_/Math.PI,-180,180),D=ve(180*w/Math.PI,-Vs,Vs);return new tr(E,D)}}class iy extends Dc{constructor(e){super(e),this.wrap=!0,this.supportsWorldCopies=!0}project(e,i){return{x:.5+e/360,y:.5-i/360,z:0}}unproject(e,i){const a=360*(e-.5),u=ve(360*(.5-i),-Vs,Vs);return new tr(a,u)}}const sh=Math.PI/2;function od(t){return Math.tan((sh+t)/2)}class yg extends Dc{constructor(e){super(e),this.center=e.center||[0,30];const[i,a]=this.parallels=e.parallels||[30,30];let u=Te(i),f=Te(a);this.southernCenter=u+f<0,this.southernCenter&&(u=-u,f=-f);const _=Math.cos(u),w=od(u);this.n=u===f?Math.sin(u):Math.log(_/Math.cos(f))/Math.log(od(f)/w),this.f=_*Math.pow(od(u),this.n)/this.n}project(e,i){i=Te(i),this.southernCenter&&(i=-i),e=Te(e-this.center[0]);const a=1e-6,{n:u,f}=this;f>0?i<-sh+a&&(i=-sh+a):i>sh-a&&(i=sh-a);const _=f/Math.pow(od(i),u);let w=_*Math.sin(u*e),E=f-_*Math.cos(u*e);return w=.5*(w/Math.PI+.5),E=.5*(E/Math.PI+.5),{x:w,y:this.southernCenter?E:1-E,z:0}}unproject(e,i){e=(2*e-.5)*Math.PI,this.southernCenter&&(i=1-i),i=(2*(1-i)-.5)*Math.PI;const{n:a,f:u}=this,f=u-i,_=Math.sign(f),w=Math.sign(a)*Math.sqrt(e*e+f*f);let E=Math.atan2(e,Math.abs(f))*_;f*a<0&&(E-=Math.PI*Math.sign(e)*_);const D=ve(ae(E/a)+this.center[0],-180,180),k=ve(ae(2*Math.atan(Math.pow(u/w,1/a))-sh),-Vs,Vs);return new tr(D,this.southernCenter?-k:k)}}class vg extends Dc{constructor(e){super(e),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(e,i){return{x:$a(e),y:al(i),z:0}}unproject(e,i){const a=wa(e),u=vs(i);return new tr(a,u)}}const xg=Te(Vs);class oy extends Dc{project(e,i){const a=(i=Te(i))*i,u=a*a;return{x:.5*((e=Te(e))*(.8707-.131979*a+u*(u*(.003971*a-.001529*u)-.013791))/Math.PI+.5),y:1-.5*(i*(1.007226+a*(.015085+u*(.028874*a-.044475-.005916*u)))/Math.PI+1),z:0}}unproject(e,i){e=(2*e-.5)*Math.PI;let a=i=(2*(1-i)-1)*Math.PI,u=25,f=0,_=a*a;do{_=a*a;const D=_*_;f=(a*(1.007226+_*(.015085+D*(.028874*_-.044475-.005916*D)))-i)/(1.007226+_*(.045255+D*(.259866*_-.311325-.005916*11*D))),a=ve(a-f,-xg,xg)}while(Math.abs(f)>1e-6&&--u>0);_=a*a;const w=ve(ae(e/(.8707+_*(_*(_*_*_*(.003971-.001529*_)-.013791)-.131979))),-180,180),E=ae(a);return new tr(w,E)}}const Yf=Te(Vs);class ry extends Dc{project(e,i){i=Te(i),e=Te(e);const a=Math.cos(i),u=2/Math.PI,f=Math.acos(a*Math.cos(e/2)),_=Math.sin(f)/f,w=.5*(e*u+2*a*Math.sin(e/2)/_)||0,E=.5*(i+Math.sin(i)/_)||0;return{x:.5*(w/Math.PI+.5),y:1-.5*(E/Math.PI+1),z:0}}unproject(e,i){let a=e=(2*e-.5)*Math.PI,u=i=(2*(1-i)-1)*Math.PI,f=25;const _=1e-6;let w=0,E=0;do{const D=Math.cos(u),k=Math.sin(u),z=2*k*D,j=k*k,K=D*D,te=Math.cos(a/2),he=Math.sin(a/2),Oe=2*te*he,ot=he*he,Ct=1-K*te*te,at=Ct?1/Ct:0,wt=Ct?Math.acos(D*te)*Math.sqrt(1/Ct):0,At=.5*(2*wt*D*he+2*a/Math.PI)-e,It=.5*(wt*k+u)-i,un=.5*at*(K*ot+wt*D*te*j)+1/Math.PI,rn=at*(Oe*z/4-wt*k*he),En=.125*at*(z*he-wt*k*K*Oe),$n=.5*at*(j*te+wt*ot*D)+.5,fn=rn*En-$n*un;w=(It*rn-At*$n)/fn,E=(At*En-It*un)/fn,a=ve(a-w,-Math.PI,Math.PI),u=ve(u-E,-Yf,Yf)}while((Math.abs(w)>_||Math.abs(E)>_)&&--f>0);return new tr(ae(a),ae(u))}}class bg extends Dc{constructor(e){super(e),this.center=e.center||[0,0],this.parallels=e.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(Te(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(e,i){const{scale:a,cosPhi:u}=this;return{x:Te(e)*u*a+.5,y:-Math.sin(Te(i))/u*a+.5,z:0}}unproject(e,i){const{scale:a,cosPhi:u}=this,f=-(i-.5)/a,_=ve(ae((e-.5)/a)/u,-180,180),w=Math.asin(ve(f*u,-1,1)),E=ve(ae(w),-Vs,Vs);return new tr(_,E)}}class Jf extends vg{constructor(e){super(e),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(e,i,a){const u=Tl(e,i,a);return zr(u,u,nu(ja(a))),{x:u[0],y:u[1],z:u[2]}}locationPoint(e,i){const a=eu(i.lat,i.lng),u=ys([],a),f=e.elevation?e.elevation.getAtPointOrZero(e.locationCoordinate(i),e._centerAltitude):e._centerAltitude;Td(a,a,u,Zs(1,0)*Pi*f);const _=ol(new Float64Array(16));return wl(_,e.pixelMatrix,e.globeMatrix),zr(a,a,_),new Me(a[0],a[1])}pixelsPerMeter(e,i){return Zs(1,0)*i}pixelSpaceConversion(e,i,a){const u=Zs(1,e)*i,f=Kn(Zs(1,45)*i,u,a);return this.pixelsPerMeter(e,i)/f}createTileMatrix(e,i,a){const u=Mu(ja(a.canonical));return wl(new Float64Array(16),e.globeMatrix,u)}createInversionMatrix(e,i){const{center:a}=e,u=nu(ja(i));return Wp(u,u,Te(a.lng)),vh(u,u,Te(a.lat)),Kc(u,u,[e._pixelsPerMercatorPixel,e._pixelsPerMercatorPixel,1]),Float32Array.from(u)}pointCoordinate(e,i,a,u){return ef(e,i,a,!0)||new Au(0,0)}pointCoordinate3D(e,i,a){const u=this.pointCoordinate(e,i,a,0);return[u.x,u.y,u.z]}isPointAboveHorizon(e,i){return!ef(e,i.x,i.y,!1)}farthestPixelDistance(e){const i=function(u,f){const _=u.cameraToCenterDistance,w=u._centerAltitude*f,E=u._camera,D=u._camera.forward(),k=rl([],Ua([],D,-_),[0,0,w]),z=u.worldSize/(2*Math.PI),j=[0,0,-z],K=u.width/u.height,te=Math.tan(u.fovAboveCenter),he=Ua([],E.up(),te),Oe=Ua([],E.right(),te*K),ot=ys([],rl([],rl([],D,he),Oe)),Ct=[];let at;if(new Qp(k,ot).closestPointOnSphere(j,z,Ct)){const wt=rl([],Ct,j),At=Za([],wt,k);at=Math.cos(u.fovAboveCenter)*bh(At)}else{const wt=Za([],k,j),At=Za([],j,k);ys(At,At);const It=bh(wt)-z;at=Math.sqrt(It*(It+2*z));const un=Math.acos(at/(z+It))-Math.acos(xa(D,At));at*=Math.cos(un)}return 1.01*at}(e,this.pixelsPerMeter(e.center.lat,e.worldSize)),a=Iu(e.zoom);if(a>0){const u=qf(e,Zs(1,e.center.lat)*e.worldSize),f=e.worldSize/(2*Math.PI),_=Math.max(e.width,e.height)/e.worldSize*Math.PI;return Kn(i,u+f*(1-Math.cos(_)),Math.pow(a,10))}return i}upVector(e,i,a){return Tl(i,a,e,1)}upVectorScale(e){return{metersToTile:Mh(tu(ja(e)))}}}function wg(t){const e=t.parallels,i=!!e&&Math.abs(e[0]+e[1])<.01;switch(t.name){case"mercator":return new vg(t);case"equirectangular":return new iy(t);case"naturalEarth":return new oy(t);case"equalEarth":return new ny(t);case"winkelTripel":return new ry(t);case"albers":return i?new bg(t):new ty(t);case"lambertConformalConic":return i?new bg(t):new yg(t);case"globe":return new Jf(t)}throw new Error(`Invalid projection name: ${t.name}`)}const sy=Zh.types,ay=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function fp(t,e,i,a,u,f,_,w,E,D,k,z,j){const K=w?Math.min(Al,Math.round(w[0])):0,te=w?Math.min(Al,Math.round(w[1])):0;t.emplaceBack(e,i,Math.round(32*a),Math.round(32*u),f,_,(K<<1)+(E?1:0),te,16*D,16*k,256*z,256*j)}function mp(t,e,i,a,u,f,_){t.emplaceBack(e,i,a,u,f,_)}function Ra(t,e,i,a,u){t.emplaceBack(e,i,a,u),t.emplaceBack(e,i,a,u),t.emplaceBack(e,i,a,u),t.emplaceBack(e,i,a,u)}function Kf(t){for(const e of t.sections)if(Jt(e.text))return!0;return!1}class Xf{constructor(e){this.layoutVertexArray=new Bn,this.indexArray=new bi,this.programConfigurations=e,this.segments=new Tr,this.dynamicLayoutVertexArray=new jn,this.opacityVertexArray=new Ti,this.placedSymbolArray=new Jr,this.globeExtVertexArray=new qn}isEmpty(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length}upload(e,i,a,u){this.isEmpty()||(a&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Af.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,i),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,Kh.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,ay,!0),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=e.createVertexBuffer(this.globeExtVertexArray,Wd.members,!0)),this.opacityVertexBuffer.itemSize=1),(a||u)&&this.programConfigurations.upload(e))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}}ui(Xf,"SymbolBuffers");class gp{constructor(e,i,a){this.layoutVertexArray=new e,this.layoutAttributes=i,this.indexArray=new a,this.segments=new Tr,this.collisionVertexArray=new po,this.collisionVertexArrayExt=new mo}upload(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,qd.members,!0),this.collisionVertexBufferExt=e.createVertexBuffer(this.collisionVertexArrayExt,rg.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}ui(gp,"CollisionBuffers");class Mc{constructor(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(_=>_.id),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=ol([]),this.placementViewportMatrix=ol([]);const i=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Yd(this.zoom,i["text-size"]),this.iconSizeData=Yd(this.zoom,i["icon-size"]);const a=this.layers[0].layout,u=a.get("symbol-sort-key"),f=a.get("symbol-z-order");this.canOverlap=a.get("text-allow-overlap")||a.get("icon-allow-overlap")||a.get("text-ignore-placement")||a.get("icon-ignore-placement"),this.sortFeaturesByKey="viewport-y"!==f&&void 0!==u.constantOr(1),this.sortFeaturesByY=("viewport-y"===f||"auto"===f&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=a.get("text-writing-mode").map(_=>Ta[_]),this.stateDependentLayerIds=this.layers.filter(_=>_.isStateDependent()).map(_=>_.id),this.sourceID=e.sourceID,this.projection=e.projection}createArrays(){this.text=new Xf(new Yc(this.layers,this.zoom,e=>/^text/.test(e))),this.icon=new Xf(new Yc(this.layers,this.zoom,e=>/^icon/.test(e))),this.glyphOffsetArray=new la,this.lineVertexArray=new xl,this.symbolInstances=new vr}calculateGlyphDependencies(e,i,a,u,f){for(let _=0;_<e.length;_++)if(i[e.charCodeAt(_)]=!0,u&&f){const w=ju[e.charAt(_)];w&&(i[w.charCodeAt(0)]=!0)}}populate(e,i,a,u){const f=this.layers[0],_=f.layout,w="globe"===this.projection.name,E=_.get("text-font"),D=_.get("text-field"),k=_.get("icon-image"),z=("constant"!==D.value.kind||D.value.value instanceof hr&&!D.value.value.isEmpty()||D.value.value.toString().length>0)&&("constant"!==E.value.kind||E.value.value.length>0),j="constant"!==k.value.kind||!!k.value.value||Object.keys(k.parameters).length>0,K=_.get("symbol-sort-key");if(this.features=[],!z&&!j)return;const te=i.iconDependencies,he=i.glyphDependencies,Oe=i.availableImages,ot=new N(this.zoom);for(const{feature:Ct,id:at,index:wt,sourceLayerIndex:At}of e){const It=f._featureFilter.needGeometry,un=Yl(Ct,It);if(!f._featureFilter.filter(ot,un,a))continue;if(It||(un.geometry=Dl(Ct,a,u)),w&&1!==Ct.type&&a.z<=5){const fn=un.geometry,kn=.98078528056,Fn=(Zn,Yn)=>xa(Tl(Zn.x,Zn.y,a,1),Tl(Yn.x,Yn.y,a,1))<kn;for(let Zn=0;Zn<fn.length;Zn++)fn[Zn]=cf(fn[Zn],Fn)}let rn,En;if(z){const fn=f.getValueAndResolveTokens("text-field",un,a,Oe),kn=hr.factory(fn);Kf(kn)&&(this.hasRTLText=!0),(!this.hasRTLText||"unavailable"===T()||this.hasRTLText&&O.isParsed())&&(rn=sg(kn,f,un))}if(j){const fn=f.getValueAndResolveTokens("icon-image",un,a,Oe);En=fn instanceof wo?fn:wo.fromString(fn)}if(!rn&&!En)continue;const $n=this.sortFeaturesByKey?K.evaluate(un,{},a):void 0;if(this.features.push({id:at,text:rn,icon:En,index:wt,sourceLayerIndex:At,geometry:un.geometry,properties:Ct.properties,type:sy[Ct.type],sortKey:$n}),En&&(te[En.name]=!0),rn){const fn=E.evaluate(un,{},a).join(","),kn="map"===_.get("text-rotation-alignment")&&"point"!==_.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Ta.vertical)>=0;for(const Fn of rn.sections)if(Fn.image)te[Fn.image.name]=!0;else{const Zn=L(rn.toString()),Yn=Fn.fontStack||fn,Tn=he[Yn]=he[Yn]||{};this.calculateGlyphDependencies(Fn.text,Tn,kn,this.allowVerticalPlacement,Zn)}}}"line"===_.get("symbol-placement")&&(this.features=function(Ct){const at={},wt={},At=[];let It=0;function un(fn){At.push(Ct[fn]),It++}function rn(fn,kn,Fn){const Zn=wt[fn];return delete wt[fn],wt[kn]=Zn,At[Zn].geometry[0].pop(),At[Zn].geometry[0]=At[Zn].geometry[0].concat(Fn[0]),Zn}function En(fn,kn,Fn){const Zn=at[kn];return delete at[kn],at[fn]=Zn,At[Zn].geometry[0].shift(),At[Zn].geometry[0]=Fn[0].concat(At[Zn].geometry[0]),Zn}function $n(fn,kn,Fn){const Zn=Fn?kn[0][kn[0].length-1]:kn[0][0];return`${fn}:${Zn.x}:${Zn.y}`}for(let fn=0;fn<Ct.length;fn++){const kn=Ct[fn],Fn=kn.geometry,Zn=kn.text?kn.text.toString():null;if(!Zn){un(fn);continue}const Yn=$n(Zn,Fn),Tn=$n(Zn,Fn,!0);if(Yn in wt&&Tn in at&&wt[Yn]!==at[Tn]){const si=En(Yn,Tn,Fn),yi=rn(Yn,Tn,At[si].geometry);delete at[Yn],delete wt[Tn],wt[$n(Zn,At[yi].geometry,!0)]=yi,At[si].geometry=null}else Yn in wt?rn(Yn,Tn,Fn):Tn in at?En(Yn,Tn,Fn):(un(fn),at[Yn]=It-1,wt[Tn]=It-1)}return At.filter(fn=>fn.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((Ct,at)=>Ct.sortKey-at.sortKey)}update(e,i,a,u){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,i,this.layers,a,u),this.icon.programConfigurations.updatePaintArrays(e,i,this.layers,a,u))}isEmpty(){return 0===this.symbolInstances.length&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=wg(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(e,i){const a=this.lineVertexArray.length;if(void 0!==e.segment)for(const{x:u,y:f}of i)this.lineVertexArray.emplaceBack(u,f);return{lineStartIndex:a,lineLength:this.lineVertexArray.length-a}}addSymbols(e,i,a,u,f,_,w,E,D,k,z,j,K,te){const he=e.indexArray,Oe=e.layoutVertexArray,ot=e.globeExtVertexArray,Ct=e.segments.prepareSegment(4*i.length,Oe,he,this.canOverlap?_.sortKey:void 0),at=this.glyphOffsetArray.length,wt=Ct.vertexLength,At=this.allowVerticalPlacement&&w===Ta.vertical?Math.PI/2:0,It=_.text&&_.text.sections;for(let rn=0;rn<i.length;rn++){const{tl:En,tr:$n,bl:fn,br:kn,tex:Fn,pixelOffsetTL:Zn,pixelOffsetBR:Yn,minFontScaleX:Tn,minFontScaleY:si,glyphOffset:yi,isSDF:li,sectionIndex:no}=i[rn],Jn=Ct.vertexLength,Ei=yi[1];if(fp(Oe,D.x,D.y,En.x,Ei+En.y,Fn.x,Fn.y,a,li,Zn.x,Zn.y,Tn,si),fp(Oe,D.x,D.y,$n.x,Ei+$n.y,Fn.x+Fn.w,Fn.y,a,li,Yn.x,Zn.y,Tn,si),fp(Oe,D.x,D.y,fn.x,Ei+fn.y,Fn.x,Fn.y+Fn.h,a,li,Zn.x,Yn.y,Tn,si),fp(Oe,D.x,D.y,kn.x,Ei+kn.y,Fn.x+Fn.w,Fn.y+Fn.h,a,li,Yn.x,Yn.y,Tn,si),E){const{x:Wi,y:Ao,z:Yi}=E.anchor,[Ni,Yo,io]=E.up;mp(ot,Wi,Ao,Yi,Ni,Yo,io),mp(ot,Wi,Ao,Yi,Ni,Yo,io),mp(ot,Wi,Ao,Yi,Ni,Yo,io),mp(ot,Wi,Ao,Yi,Ni,Yo,io),Ra(e.dynamicLayoutVertexArray,Wi,Ao,Yi,At)}else Ra(e.dynamicLayoutVertexArray,D.x,D.y,D.z,At);he.emplaceBack(Jn,Jn+1,Jn+2),he.emplaceBack(Jn+1,Jn+2,Jn+3),Ct.vertexLength+=4,Ct.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(yi[0]),rn!==i.length-1&&no===i[rn+1].sectionIndex||e.programConfigurations.populatePaintArrays(Oe.length,_,_.index,{},K,te,It&&It[no])}const un=E?E.anchor:D;e.placedSymbolArray.emplaceBack(un.x,un.y,un.z,D.x,D.y,at,this.glyphOffsetArray.length-at,wt,k,z,D.segment,a?a[0]:0,a?a[1]:0,u[0],u[1],w,0,!1,0,j,0)}_commitLayoutVertex(e,i,a,u,f,_,w){e.emplaceBack(i,a,u,f,_,Math.round(w.x),Math.round(w.y))}_addCollisionDebugVertices(e,i,a,u,f,_,w){const E=a.segments.prepareSegment(4,a.layoutVertexArray,a.indexArray),D=E.vertexLength,k=w.tileAnchorX,z=w.tileAnchorY;for(let K=0;K<4;K++)a.collisionVertexArray.emplaceBack(0,0,0,0);a.collisionVertexArrayExt.emplaceBack(i,-e.padding,-e.padding),a.collisionVertexArrayExt.emplaceBack(i,e.padding,-e.padding),a.collisionVertexArrayExt.emplaceBack(i,e.padding,e.padding),a.collisionVertexArrayExt.emplaceBack(i,-e.padding,e.padding),this._commitLayoutVertex(a.layoutVertexArray,u,f,_,k,z,new Me(e.x1,e.y1)),this._commitLayoutVertex(a.layoutVertexArray,u,f,_,k,z,new Me(e.x2,e.y1)),this._commitLayoutVertex(a.layoutVertexArray,u,f,_,k,z,new Me(e.x2,e.y2)),this._commitLayoutVertex(a.layoutVertexArray,u,f,_,k,z,new Me(e.x1,e.y2)),E.vertexLength+=4;const j=a.indexArray;j.emplaceBack(D,D+1),j.emplaceBack(D+1,D+2),j.emplaceBack(D+2,D+3),j.emplaceBack(D+3,D),E.primitiveLength+=4}_addTextDebugCollisionBoxes(e,i,a,u,f,_){for(let w=u;w<f;w++){const E=a.get(w),D=this.getSymbolInstanceTextSize(e,_,i,w);this._addCollisionDebugVertices(E,D,this.textCollisionBox,E.projectedAnchorX,E.projectedAnchorY,E.projectedAnchorZ,_)}}_addIconDebugCollisionBoxes(e,i,a,u,f,_){for(let w=u;w<f;w++){const E=a.get(w),D=this.getSymbolInstanceIconSize(e,i,_.placedIconSymbolIndex);this._addCollisionDebugVertices(E,D,this.iconCollisionBox,E.projectedAnchorX,E.projectedAnchorY,E.projectedAnchorZ,_)}}generateCollisionDebugBuffers(e,i){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new gp(_i,Xh.members,Yr),this.iconCollisionBox=new gp(_i,Xh.members,Yr);const a=Vu(this.iconSizeData,e),u=Vu(this.textSizeData,e);for(let f=0;f<this.symbolInstances.length;f++){const _=this.symbolInstances.get(f);this._addTextDebugCollisionBoxes(u,e,i,_.textBoxStartIndex,_.textBoxEndIndex,_),this._addTextDebugCollisionBoxes(u,e,i,_.verticalTextBoxStartIndex,_.verticalTextBoxEndIndex,_),this._addIconDebugCollisionBoxes(a,e,i,_.iconBoxStartIndex,_.iconBoxEndIndex,_),this._addIconDebugCollisionBoxes(a,e,i,_.verticalIconBoxStartIndex,_.verticalIconBoxEndIndex,_)}}getSymbolInstanceTextSize(e,i,a,u){const f=this.text.placedSymbolArray.get(i.rightJustifiedTextSymbolIndex>=0?i.rightJustifiedTextSymbolIndex:i.centerJustifiedTextSymbolIndex>=0?i.centerJustifiedTextSymbolIndex:i.leftJustifiedTextSymbolIndex>=0?i.leftJustifiedTextSymbolIndex:i.verticalPlacedTextSymbolIndex>=0?i.verticalPlacedTextSymbolIndex:u),_=Jd(this.textSizeData,e,f)/As;return this.tilePixelRatio*_}getSymbolInstanceIconSize(e,i,a){const u=this.icon.placedSymbolArray.get(a),f=Jd(this.iconSizeData,e,u);return this.tilePixelRatio*f}_commitDebugCollisionVertexUpdate(e,i,a){e.emplaceBack(i,-a,-a),e.emplaceBack(i,a,-a),e.emplaceBack(i,a,a),e.emplaceBack(i,-a,a)}_updateTextDebugCollisionBoxes(e,i,a,u,f,_){for(let w=u;w<f;w++){const E=a.get(w),D=this.getSymbolInstanceTextSize(e,_,i,w);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,D,E.padding)}}_updateIconDebugCollisionBoxes(e,i,a,u,f,_){for(let w=u;w<f;w++){const E=a.get(w),D=this.getSymbolInstanceIconSize(e,i,_);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,D,E.padding)}}updateCollisionDebugBuffers(e,i){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const a=Vu(this.iconSizeData,e),u=Vu(this.textSizeData,e);for(let f=0;f<this.symbolInstances.length;f++){const _=this.symbolInstances.get(f);this._updateTextDebugCollisionBoxes(u,e,i,_.textBoxStartIndex,_.textBoxEndIndex,_),this._updateTextDebugCollisionBoxes(u,e,i,_.verticalTextBoxStartIndex,_.verticalTextBoxEndIndex,_),this._updateIconDebugCollisionBoxes(a,e,i,_.iconBoxStartIndex,_.iconBoxEndIndex,_.placedIconSymbolIndex),this._updateIconDebugCollisionBoxes(a,e,i,_.verticalIconBoxStartIndex,_.verticalIconBoxEndIndex,_.placedIconSymbolIndex)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(e,i,a,u,f,_,w,E,D){const k={};if(i<a){const{x1:z,y1:j,x2:K,y2:te,padding:he,projectedAnchorX:Oe,projectedAnchorY:ot,projectedAnchorZ:Ct,tileAnchorX:at,tileAnchorY:wt,featureIndex:At}=e.get(i);k.textBox={x1:z,y1:j,x2:K,y2:te,padding:he,projectedAnchorX:Oe,projectedAnchorY:ot,projectedAnchorZ:Ct,tileAnchorX:at,tileAnchorY:wt},k.textFeatureIndex=At}if(u<f){const{x1:z,y1:j,x2:K,y2:te,padding:he,projectedAnchorX:Oe,projectedAnchorY:ot,projectedAnchorZ:Ct,tileAnchorX:at,tileAnchorY:wt,featureIndex:At}=e.get(u);k.verticalTextBox={x1:z,y1:j,x2:K,y2:te,padding:he,projectedAnchorX:Oe,projectedAnchorY:ot,projectedAnchorZ:Ct,tileAnchorX:at,tileAnchorY:wt},k.verticalTextFeatureIndex=At}if(_<w){const{x1:z,y1:j,x2:K,y2:te,padding:he,projectedAnchorX:Oe,projectedAnchorY:ot,projectedAnchorZ:Ct,tileAnchorX:at,tileAnchorY:wt,featureIndex:At}=e.get(_);k.iconBox={x1:z,y1:j,x2:K,y2:te,padding:he,projectedAnchorX:Oe,projectedAnchorY:ot,projectedAnchorZ:Ct,tileAnchorX:at,tileAnchorY:wt},k.iconFeatureIndex=At}if(E<D){const{x1:z,y1:j,x2:K,y2:te,padding:he,projectedAnchorX:Oe,projectedAnchorY:ot,projectedAnchorZ:Ct,tileAnchorX:at,tileAnchorY:wt,featureIndex:At}=e.get(E);k.verticalIconBox={x1:z,y1:j,x2:K,y2:te,padding:he,projectedAnchorX:Oe,projectedAnchorY:ot,projectedAnchorZ:Ct,tileAnchorX:at,tileAnchorY:wt},k.verticalIconFeatureIndex=At}return k}deserializeCollisionBoxes(e){this.collisionArrays=[];for(let i=0;i<this.symbolInstances.length;i++){const a=this.symbolInstances.get(i);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,a.textBoxStartIndex,a.textBoxEndIndex,a.verticalTextBoxStartIndex,a.verticalTextBoxEndIndex,a.iconBoxStartIndex,a.iconBoxEndIndex,a.verticalIconBoxStartIndex,a.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(e,i){const a=e.placedSymbolArray.get(i),u=a.vertexStartIndex+4*a.numGlyphs;for(let f=a.vertexStartIndex;f<u;f+=4)e.indexArray.emplaceBack(f,f+1,f+2),e.indexArray.emplaceBack(f+1,f+2,f+3)}getSortedSymbolIndexes(e){if(this.sortedAngle===e&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;const i=Math.sin(e),a=Math.cos(e),u=[],f=[],_=[];for(let w=0;w<this.symbolInstances.length;++w){_.push(w);const E=this.symbolInstances.get(w);u.push(0|Math.round(i*E.tileAnchorX+a*E.tileAnchorY)),f.push(E.featureIndex)}return _.sort((w,E)=>u[w]-u[E]||f[E]-f[w]),_}addToSortKeyRanges(e,i){const a=this.sortKeyRanges[this.sortKeyRanges.length-1];a&&a.sortKey===i?a.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:i,symbolInstanceStart:e,symbolInstanceEnd:e+1})}sortFeatures(e){if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const i of this.symbolInstanceIndexes){const a=this.symbolInstances.get(i);this.featureSortOrder.push(a.featureIndex);const{rightJustifiedTextSymbolIndex:u,centerJustifiedTextSymbolIndex:f,leftJustifiedTextSymbolIndex:_,verticalPlacedTextSymbolIndex:w,placedIconSymbolIndex:E,verticalPlacedIconSymbolIndex:D}=a;u>=0&&this.addIndicesForPlacedSymbol(this.text,u),f>=0&&f!==u&&this.addIndicesForPlacedSymbol(this.text,f),_>=0&&_!==f&&_!==u&&this.addIndicesForPlacedSymbol(this.text,_),w>=0&&this.addIndicesForPlacedSymbol(this.text,w),E>=0&&this.addIndicesForPlacedSymbol(this.icon,E),D>=0&&this.addIndicesForPlacedSymbol(this.icon,D)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}ui(Mc,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),Mc.MAX_GLYPHS=65535,Mc.addDynamicAttributes=Ra;const Cg=new ht({"symbol-placement":new ue(tn.layout_symbol["symbol-placement"]),"symbol-spacing":new ue(tn.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new ue(tn.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new $e(tn.layout_symbol["symbol-sort-key"]),"symbol-z-order":new ue(tn.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new ue(tn.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new ue(tn.layout_symbol["icon-ignore-placement"]),"icon-optional":new ue(tn.layout_symbol["icon-optional"]),"icon-rotation-alignment":new ue(tn.layout_symbol["icon-rotation-alignment"]),"icon-size":new $e(tn.layout_symbol["icon-size"]),"icon-text-fit":new ue(tn.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new ue(tn.layout_symbol["icon-text-fit-padding"]),"icon-image":new $e(tn.layout_symbol["icon-image"]),"icon-rotate":new $e(tn.layout_symbol["icon-rotate"]),"icon-padding":new ue(tn.layout_symbol["icon-padding"]),"icon-keep-upright":new ue(tn.layout_symbol["icon-keep-upright"]),"icon-offset":new $e(tn.layout_symbol["icon-offset"]),"icon-anchor":new $e(tn.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new ue(tn.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new ue(tn.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new ue(tn.layout_symbol["text-rotation-alignment"]),"text-field":new $e(tn.layout_symbol["text-field"]),"text-font":new $e(tn.layout_symbol["text-font"]),"text-size":new $e(tn.layout_symbol["text-size"]),"text-max-width":new $e(tn.layout_symbol["text-max-width"]),"text-line-height":new $e(tn.layout_symbol["text-line-height"]),"text-letter-spacing":new $e(tn.layout_symbol["text-letter-spacing"]),"text-justify":new $e(tn.layout_symbol["text-justify"]),"text-radial-offset":new $e(tn.layout_symbol["text-radial-offset"]),"text-variable-anchor":new ue(tn.layout_symbol["text-variable-anchor"]),"text-anchor":new $e(tn.layout_symbol["text-anchor"]),"text-max-angle":new ue(tn.layout_symbol["text-max-angle"]),"text-writing-mode":new ue(tn.layout_symbol["text-writing-mode"]),"text-rotate":new $e(tn.layout_symbol["text-rotate"]),"text-padding":new ue(tn.layout_symbol["text-padding"]),"text-keep-upright":new ue(tn.layout_symbol["text-keep-upright"]),"text-transform":new $e(tn.layout_symbol["text-transform"]),"text-offset":new $e(tn.layout_symbol["text-offset"]),"text-allow-overlap":new ue(tn.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new ue(tn.layout_symbol["text-ignore-placement"]),"text-optional":new ue(tn.layout_symbol["text-optional"])});var _p={paint:new ht({"icon-opacity":new $e(tn.paint_symbol["icon-opacity"]),"icon-color":new $e(tn.paint_symbol["icon-color"]),"icon-halo-color":new $e(tn.paint_symbol["icon-halo-color"]),"icon-halo-width":new $e(tn.paint_symbol["icon-halo-width"]),"icon-halo-blur":new $e(tn.paint_symbol["icon-halo-blur"]),"icon-translate":new ue(tn.paint_symbol["icon-translate"]),"icon-translate-anchor":new ue(tn.paint_symbol["icon-translate-anchor"]),"text-opacity":new $e(tn.paint_symbol["text-opacity"]),"text-color":new $e(tn.paint_symbol["text-color"],{runtimeType:rt,getOverride:t=>t.textColor,hasOverride:t=>!!t.textColor}),"text-halo-color":new $e(tn.paint_symbol["text-halo-color"]),"text-halo-width":new $e(tn.paint_symbol["text-halo-width"]),"text-halo-blur":new $e(tn.paint_symbol["text-halo-blur"]),"text-translate":new ue(tn.paint_symbol["text-translate"]),"text-translate-anchor":new ue(tn.paint_symbol["text-translate-anchor"])}),layout:Cg};class ah{constructor(e){this.type=e.property.overrides?e.property.overrides.runtimeType:kr,this.defaultValue=e}evaluate(e){if(e.formattedSection){const i=this.defaultValue.property.overrides;if(i&&i.hasOverride(e.formattedSection))return i.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default}eachChild(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}ui(ah,"FormatSectionOverride",{omit:["defaultValue"]});class rd extends il{constructor(e){super(e,_p)}recalculate(e,i){super.recalculate(e,i),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const a=this.layout.get("text-writing-mode");if(a){const u=[];for(const f of a)u.indexOf(f)<0&&u.push(f);this.layout._values["text-writing-mode"]=u}else this.layout._values["text-writing-mode"]="point"===this.layout.get("symbol-placement")?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(e,i,a,u){const f=this.layout.get(e).evaluate(i,{},a,u),_=this._unevaluatedLayout._values[e];return _.isDataDriven()||fs(_.value)||!f?f:(w=i.properties,f.replace(/{([^{}]+)}/g,(D,k)=>k in w?String(w[k]):""));var w}createBucket(e){return new Mc(e)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const e of _p.paint.overridableProperties){if(!rd.hasPaintOverride(this.layout,e))continue;const i=this.paint.get(e),a=new ah(i),u=new Ds(a,i.property.specification);let f=null;f="constant"===i.value.kind||"source"===i.value.kind?new qs("source",u):new os("composite",u,i.value.zoomStops,i.value._interpolationType),this.paint._values[e]=new Ye(i.property,f,i.parameters)}}_handleOverridablePaintPropertyUpdate(e,i,a){return!(!this.layout||i.isDataDriven()||a.isDataDriven())&&rd.hasPaintOverride(this.layout,e)}static hasPaintOverride(e,i){const a=e.get("text-field"),u=_p.paint.properties[i];let f=!1;const _=w=>{for(const E of w)if(u.overrides&&u.overrides.hasOverride(E))return void(f=!0)};if("constant"===a.value.kind&&a.value.value instanceof hr)_(a.value.value.sections);else if("source"===a.value.kind){const w=D=>{f||(D instanceof jo&&Li(D.value)===Ut?_(D.value.sections):D instanceof Si?_(D.sections):D.eachChild(w))},E=a.value;E._styleExpression&&w(E._styleExpression.expression)}return f}getProgramConfiguration(e){return new nl(this,e)}}var Ev={paint:new ht({"background-color":new ue(tn.paint_background["background-color"]),"background-pattern":new ue(tn.paint_background["background-pattern"]),"background-opacity":new ue(tn.paint_background["background-opacity"])})},Tg={paint:new ht({"raster-opacity":new ue(tn.paint_raster["raster-opacity"]),"raster-hue-rotate":new ue(tn.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new ue(tn.paint_raster["raster-brightness-min"]),"raster-brightness-max":new ue(tn.paint_raster["raster-brightness-max"]),"raster-saturation":new ue(tn.paint_raster["raster-saturation"]),"raster-contrast":new ue(tn.paint_raster["raster-contrast"]),"raster-resampling":new ue(tn.paint_raster["raster-resampling"]),"raster-fade-duration":new ue(tn.paint_raster["raster-fade-duration"])})};class Eg extends il{constructor(e){super(e,{}),this.implementation=e}is3D(){return"3d"===this.implementation.renderingMode}hasOffscreenPass(){return void 0!==this.implementation.prerender}isLayerDraped(){return void 0!==this.implementation.renderToTile}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(e){this.implementation.onAdd&&this.implementation.onAdd(e,e.painter.context.gl)}onRemove(e){this.implementation.onRemove&&this.implementation.onRemove(e,e.painter.context.gl)}}var Dg={paint:new ht({"sky-type":new ue(tn.paint_sky["sky-type"]),"sky-atmosphere-sun":new ue(tn.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new ue(tn.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new ue(tn.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new ue(tn.paint_sky["sky-gradient-radius"]),"sky-gradient":new pt(tn.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new ue(tn.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new ue(tn.paint_sky["sky-atmosphere-color"]),"sky-opacity":new ue(tn.paint_sky["sky-opacity"])})};function yp(t,e,i){const a=[0,0,1],u=Dm([]);return Dh(u,u,i?-Te(t)+Math.PI:Te(t)),Kp(u,u,-Te(e)),Jp(a,a,u),ys(a,a)}const Qf={circle:class extends il{constructor(t){super(t,Fd)}createBucket(t){return new Ld(t)}queryRadius(t){const e=t;return Pu("circle-radius",this,e)+Pu("circle-stroke-width",this,e)+pf(this.paint.get("circle-translate"))}queryIntersectsFeature(t,e,i,a,u,f,_,w){const E=Lh(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),f.angle,t.pixelToTileUnitsFactor),D=this.paint.get("circle-radius").evaluate(e,i)+this.paint.get("circle-stroke-width").evaluate(e,i);return Bd(t,a,f,_,w,"map"===this.paint.get("circle-pitch-alignment"),"map"===this.paint.get("circle-pitch-scale"),E,D)}getProgramIds(){return["circle"]}getProgramConfiguration(t){return new nl(this,t)}},heatmap:class extends il{createBucket(t){return new gf(t)}constructor(t){super(t,vc),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(t){"heatmap-color"===t&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=su({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(t){return Pu("heatmap-radius",this,t)}queryIntersectsFeature(t,e,i,a,u,f,_,w){const E=this.paint.get("heatmap-radius").evaluate(e,i);return Bd(t,a,f,_,w,!0,!0,new Me(0,0),E)}hasOffscreenPass(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility}getProgramIds(){return["heatmap","heatmapTexture"]}getProgramConfiguration(t){return new nl(this,t)}},hillshade:class extends il{constructor(t){super(t,M_)}hasOffscreenPass(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility}getProgramIds(){return["hillshade","hillshadePrepare"]}},fill:class extends il{constructor(t){super(t,k_)}getProgramIds(){const t=this.paint.get("fill-pattern"),e=t&&t.constantOr(1),i=[e?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&i.push(e&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),i}getProgramConfiguration(t){return new nl(this,t)}recalculate(t,e){super.recalculate(t,e);const i=this.paint._values["fill-outline-color"];"constant"===i.value.kind&&void 0===i.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(t){return new Uh(t)}queryRadius(){return pf(this.paint.get("fill-translate"))}queryIntersectsFeature(t,e,i,a,u,f){return!t.queryGeometry.isAboveHorizon&&uf(Fm(t.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),f.angle,t.pixelToTileUnitsFactor),a)}isTileClipped(){return!0}},"fill-extrusion":class extends il{constructor(t){super(t,Bu)}createBucket(t){return new wc(t)}queryRadius(){return pf(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}getProgramConfiguration(t){return new nl(this,t)}queryIntersectsFeature(t,e,i,a,u,f,_,w,E){const D=Lh(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),f.angle,t.pixelToTileUnitsFactor),k=this.paint.get("fill-extrusion-height").evaluate(e,i),z=this.paint.get("fill-extrusion-base").evaluate(e,i),j=[0,0],K=w&&f.elevation,te=f.elevation?f.elevation.exaggeration():1,he=t.tile.getBucket(this);if(K&&he instanceof wc){const wt=he.centroidVertexArray,At=E+1;At<wt.length&&(j[0]=wt.geta_centroid_pos0(At),j[1]=wt.geta_centroid_pos1(At))}if(0===j[0]&&1===j[1])return!1;"globe"===f.projection.name&&(a=tg([a],[new Me(0,0),new Me(Pi,Pi)],t.tileID.canonical).map(wt=>wt.polygon).flat());const Oe=K?w:null,[ot,Ct]=(At=a,It=z,un=k,rn=D,En=_,$n=Oe,fn=j,kn=te,Fn=f.center.lat,"globe"===(wt=f).projection.name?function(Yn,Tn,si,yi,li,no,Jn,Ei,Wi,Ao,Yi){const Ni=[],Yo=[],io=Yn.projection.upVectorScale(Yi,Yn.center.lat,Yn.worldSize).metersToTile,ro=[0,0,0,1],Zo=[0,0,0,1],cr=(nr,Er,Dr,Rr)=>{nr[0]=Er,nr[1]=Dr,nr[2]=Rr,nr[3]=1},ur=eg();si>0&&(si+=ur),yi+=ur;for(const nr of Tn){const Er=[],Dr=[];for(const Rr of nr){const $o=Rr.x+li.x,ts=Rr.y+li.y,$r=Yn.projection.projectTilePoint($o,ts,Yi),Lr=Yn.projection.upVector(Yi,Rr.x,Rr.y);let Po=si,Hr=yi;if(Jn){const ir=B_($o,ts,si,yi,Jn,Ei,Wi,Ao);Po+=ir.base,Hr+=ir.top}0!==si?cr(ro,$r.x+Lr[0]*io*Po,$r.y+Lr[1]*io*Po,$r.z+Lr[2]*io*Po):cr(ro,$r.x,$r.y,$r.z),cr(Zo,$r.x+Lr[0]*io*Hr,$r.y+Lr[1]*io*Hr,$r.z+Lr[2]*io*Hr),zr(ro,ro,no),zr(Zo,Zo,no),Er.push(new zu(ro[0],ro[1],ro[2])),Dr.push(new zu(Zo[0],Zo[1],Zo[2]))}Ni.push(Er),Yo.push(Dr)}return[Ni,Yo]}(wt,At,It,un,rn,En,$n,fn,kn,Fn,t.tileID.canonical):$n?function(Yn,Tn,si,yi,li,no,Jn,Ei,Wi){const Ao=[],Yi=[],Ni=[0,0,0,1];for(const Yo of Yn){const io=[],ro=[];for(const Zo of Yo){const cr=Zo.x+yi.x,ur=Zo.y+yi.y,nr=B_(cr,ur,Tn,si,no,Jn,Ei,Wi);Ni[0]=cr,Ni[1]=ur,Ni[2]=nr.base,Ni[3]=1,Xc(Ni,Ni,li),Ni[3]=Math.max(Ni[3],1e-5);const Er=new zu(Ni[0]/Ni[3],Ni[1]/Ni[3],Ni[2]/Ni[3]);Ni[0]=cr,Ni[1]=ur,Ni[2]=nr.top,Ni[3]=1,Xc(Ni,Ni,li),Ni[3]=Math.max(Ni[3],1e-5);const Dr=new zu(Ni[0]/Ni[3],Ni[1]/Ni[3],Ni[2]/Ni[3]);io.push(Er),ro.push(Dr)}Ao.push(io),Yi.push(ro)}return[Ao,Yi]}(At,It,un,rn,En,$n,fn,kn,Fn):function(Yn,Tn,si,yi,li){const no=[],Jn=[],Ei=li[8]*Tn,Wi=li[9]*Tn,Ao=li[10]*Tn,Yi=li[11]*Tn,Ni=li[8]*si,Yo=li[9]*si,io=li[10]*si,ro=li[11]*si;for(const Zo of Yn){const cr=[],ur=[];for(const nr of Zo){const Er=nr.x+yi.x,Dr=nr.y+yi.y,Rr=li[0]*Er+li[4]*Dr+li[12],$o=li[1]*Er+li[5]*Dr+li[13],ts=li[2]*Er+li[6]*Dr+li[14],$r=li[3]*Er+li[7]*Dr+li[15],Lr=Rr+Ei,Po=$o+Wi,Hr=ts+Ao,ir=Math.max($r+Yi,1e-5),Qs=Rr+Ni,Gr=$o+Yo,as=ts+io,ns=Math.max($r+ro,1e-5);cr.push(new zu(Lr/ir,Po/ir,Hr/ir)),ur.push(new zu(Qs/ns,Gr/ns,as/ns))}no.push(cr),Jn.push(ur)}return[no,Jn]}(At,It,un,rn,En)),at=t.queryGeometry;var wt,At,It,un,rn,En,$n,fn,kn,Fn;return function(wt,At,It){let un=1/0;uf(It,At)&&(un=Gh(It,At[0]));for(let rn=0;rn<At.length;rn++){const En=At[rn],$n=wt[rn];for(let fn=0;fn<En.length-1;fn++){const kn=En[fn],Fn=[kn,En[fn+1],$n[fn+1],$n[fn],kn];Su(It,Fn)&&(un=Math.min(un,Gh(It,Fn)))}}return un!==1/0&&un}(ot,Ct,at.isPointQuery()?at.screenBounds:at.screenGeometry)}},line:class extends il{constructor(t){super(t,Yh),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(t){if("line-gradient"===t){const e=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=e._styleExpression&&e._styleExpression.expression instanceof Ln,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(t,e){super.recalculate(t,e),this.paint._values["line-floorwidth"]=Zu.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,t)}createBucket(t){return new qh(t)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getProgramConfiguration(t){return new nl(this,t)}queryRadius(t){const e=t,i=Jh(Pu("line-width",this,e),Pu("line-gap-width",this,e)),a=Pu("line-offset",this,e);return i/2+Math.abs(a)+pf(this.paint.get("line-translate"))}queryIntersectsFeature(t,e,i,a,u,f){if(t.queryGeometry.isAboveHorizon)return!1;const _=Fm(t.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),f.angle,t.pixelToTileUnitsFactor),w=t.pixelToTileUnitsFactor/2*Jh(this.paint.get("line-width").evaluate(e,i),this.paint.get("line-gap-width").evaluate(e,i)),E=this.paint.get("line-offset").evaluate(e,i);return E&&(a=function(D,k){const z=[],j=new Me(0,0);for(let K=0;K<D.length;K++){const te=D[K],he=[];for(let Oe=0;Oe<te.length;Oe++){const ot=te[Oe],Ct=te[Oe+1],at=0===Oe?j:ot.sub(te[Oe-1])._unit()._perp(),wt=Oe===te.length-1?j:Ct.sub(ot)._unit()._perp(),At=at._add(wt)._unit();At._mult(1/(At.x*wt.x+At.y*wt.y)),he.push(At._mult(k)._add(ot))}z.push(he)}return z}(a,E*t.pixelToTileUnitsFactor)),function(D,k,z){for(let j=0;j<k.length;j++){const K=k[j];if(D.length>=3)for(let te=0;te<K.length;te++)if(Jl(D,K[te]))return!0;if(C_(D,K,z))return!0}return!1}(_,a,w)}isTileClipped(){return!0}},symbol:rd,background:class extends il{constructor(t){super(t,Ev)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}},raster:class extends il{constructor(t){super(t,Tg)}getProgramIds(){return["raster"]}},sky:class extends il{constructor(t){super(t,Dg),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(t){"sky-gradient"===t?this._updateColorRamp():"sky-atmosphere-sun"!==t&&"sky-atmosphere-halo-color"!==t&&"sky-atmosphere-color"!==t&&"sky-atmosphere-sun-intensity"!==t||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=su({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(t){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const e=t.style.light.properties.get("position");return this._lightPosition.azimuthal!==e.azimuthal||this._lightPosition.polar!==e.polar}return!1}getCenter(t,e){if("atmosphere"===this.paint.get("sky-type")){const a=this.paint.get("sky-atmosphere-sun"),u=!a,f=t.style.light,_=f.properties.get("position");return u&&"viewport"===f.properties.get("anchor")&&St("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),u?yp(_.azimuthal,90-_.polar,e):yp(a[0],90-a[1],e)}const i=this.paint.get("sky-gradient-center");return yp(i[0],90-i[1],e)}is3D(){return!1}isSky(){return!0}markSkyboxValid(t){this._skyboxInvalidated=!1,this._lightPosition=t.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const t=this.paint.get("sky-type");return"atmosphere"===t?["skyboxCapture","skybox"]:"gradient"===t?["skyboxGradient"]:null}}};class La{constructor(e,i,a,u){this.context=e,this.format=a,this.texture=e.gl.createTexture(),this.update(i,u)}update(e,i,a){const{width:u,height:f}=e,{context:_}=this,{gl:w}=_,{HTMLImageElement:E,HTMLCanvasElement:D,HTMLVideoElement:k,ImageData:z,ImageBitmap:j}=Q;if(w.bindTexture(w.TEXTURE_2D,this.texture),_.pixelStoreUnpackFlipY.set(!1),_.pixelStoreUnpack.set(1),_.pixelStoreUnpackPremultiplyAlpha.set(this.format===w.RGBA&&(!i||!1!==i.premultiply)),a||this.size&&this.size[0]===u&&this.size[1]===f){const{x:K,y:te}=a||{x:0,y:0};e instanceof E||e instanceof D||e instanceof k||e instanceof z||j&&e instanceof j?w.texSubImage2D(w.TEXTURE_2D,0,K,te,w.RGBA,w.UNSIGNED_BYTE,e):w.texSubImage2D(w.TEXTURE_2D,0,K,te,u,f,w.RGBA,w.UNSIGNED_BYTE,e.data)}else this.size=[u,f],e instanceof E||e instanceof D||e instanceof k||e instanceof z||j&&e instanceof j?w.texImage2D(w.TEXTURE_2D,0,this.format,this.format,w.UNSIGNED_BYTE,e):w.texImage2D(w.TEXTURE_2D,0,this.format,u,f,0,this.format,w.UNSIGNED_BYTE,e.data);this.useMipmap=!!(i&&i.useMipmap&&this.isSizePowerOfTwo()),this.useMipmap&&w.generateMipmap(w.TEXTURE_2D)}bind(e,i){const{context:a}=this,{gl:u}=a;u.bindTexture(u.TEXTURE_2D,this.texture),e!==this.filter&&(u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MAG_FILTER,e),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MIN_FILTER,this.useMipmap?e===u.NEAREST?u.NEAREST_MIPMAP_NEAREST:u.LINEAR_MIPMAP_NEAREST:e),this.filter=e),i!==this.wrap&&(u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_S,i),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_T,i),this.wrap=i)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:e}=this.context;e.deleteTexture(this.texture),this.texture=null}}class ly{constructor(e){this._callback=e,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class cy{constructor(){this.tasks={},this.taskQueue=[],Wt(["process"],this),this.invoker=new ly(this.process),this.nextId=0}add(e,i){const a=this.nextId++,u=function({type:f,isSymbolTile:_,zoom:w}){return w=w||0,"message"===f?0:"maybePrepare"!==f||_?"parseTile"!==f||_?"parseTile"===f&&_?300-w:"maybePrepare"===f&&_?400-w:500:200-w:100-w}(i);if(0===u){dn();try{e()}finally{}return{cancel:()=>{}}}return this.tasks[a]={fn:e,metadata:i,priority:u,id:a},this.taskQueue.push(a),this.invoker.trigger(),{cancel:()=>{delete this.tasks[a]}}}process(){dn();try{if(this.taskQueue=this.taskQueue.filter(a=>!!this.tasks[a]),!this.taskQueue.length)return;const e=this.pick();if(null===e)return;const i=this.tasks[e];if(delete this.tasks[e],this.taskQueue.length&&this.invoker.trigger(),!i)return;i.fn()}finally{}}pick(){let e=null,i=1/0;for(let u=0;u<this.taskQueue.length;u++){const f=this.tasks[this.taskQueue[u]];f.priority<i&&(i=f.priority,e=u)}if(null===e)return null;const a=this.taskQueue[e];return this.taskQueue.splice(e,1),a}remove(){this.invoker.remove()}}class vp{constructor(e){this._stringToNumber={},this._numberToString=[];for(let i=0;i<e.length;i++){const a=e[i];this._stringToNumber[a]=i,this._numberToString[i]=a}}encode(e){return this._stringToNumber[e]}decode(e){return this._numberToString[e]}}const uy=["tile","layer","source","sourceLayer","state"];class Mg{constructor(e,i,a,u,f){this.type="Feature",this._vectorTileFeature=e,this._z=i,this._x=a,this._y=u,this.properties=e.properties,this.id=f}get geometry(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(e){this._geometry=e}toJSON(){const e={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};void 0!==this.id&&(e.id=this.id);for(const i of uy)void 0!==this[i]&&(e[i]=this[i]);return e}}const ec=new Uint16Array(8184);for(let t=0;t<2046;t++){let e=t+2,i=0,a=0,u=0,f=0,_=0,w=0;for(1&e?u=f=_=32:i=a=w=32;(e>>=1)>1;){const D=i+u>>1,k=a+f>>1;1&e?(u=i,f=a,i=_,a=w):(i=u,a=f,u=_,f=w),_=D,w=k}const E=4*t;ec[E+0]=i,ec[E+1]=a,ec[E+2]=u,ec[E+3]=f}const Sl=new Uint16Array(2178),ul=new Uint8Array(1089),Ic=new Uint16Array(1089);function lh(t){return 0===t?-.03125:32===t?.03125:0}var dy=$t([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);const Ig={type:2,extent:Pi,loadGeometry:()=>[[new Me(0,0),new Me(Pi+1,0),new Me(Pi+1,Pi+1),new Me(0,Pi+1),new Me(0,0)]]};class xp{constructor(e,i,a,u,f){this.tileID=e,this.uid=Ve(),this.uses=0,this.tileSize=i,this.tileZoom=a,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=f,this.expiredRequestCount=0,this.state="loading",u&&u.transform&&(this.projection=u.transform.projection)}registerFadeDuration(e){const i=e+this.timeAdded;i<So.now()||this.fadeEndTime&&i<this.fadeEndTime||(this.fadeEndTime=i)}wasRequested(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state}get tileTransform(){return this._tileTransform||(this._tileTransform=uu(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(e,i,a){if(this.unloadVectorData(),this.state="loaded",e){e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(u,f){const _={};if(!f)return _;for(const w of u){const E=w.layerIds.map(D=>f.getLayer(D)).filter(Boolean);if(0!==E.length){w.layers=E,w.stateDependentLayerIds&&(w.stateDependentLayers=w.stateDependentLayerIds.map(D=>E.filter(k=>k.id===D)[0]));for(const D of E)_[D.id]=w}}return _}(e.buckets,i.style),this.hasSymbolBuckets=!1;for(const u in this.buckets){const f=this.buckets[u];if(f instanceof Mc){if(this.hasSymbolBuckets=!0,!a)break;f.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const u in this.buckets){const f=this.buckets[u];if(f instanceof Mc&&f.hasRTLText){this.hasRTLText=!0,O.isLoading()||O.isLoaded()||"deferred"!==T()||I();break}}this.queryPadding=0;for(const u in this.buckets){const f=this.buckets[u];this.queryPadding=Math.max(this.queryPadding,i.style.getLayer(u).queryRadius(f))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage),e.lineAtlas&&(this.lineAtlas=e.lineAtlas)}else this.collisionBoxArray=new ar}unloadVectorData(){if(this.hasData()){for(const e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(e){return this.buckets[e.id]}upload(e){for(const a in this.buckets){const u=this.buckets[a];u.uploadPending()&&u.upload(e)}const i=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new La(e,this.imageAtlas.image,i.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new La(e,this.glyphAtlasImage,i.ALPHA),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new La(e,this.lineAtlas.image,i.ALPHA),this.lineAtlas.uploaded=!0)}prepare(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)}queryRenderedFeatures(e,i,a,u,f,_,w,E){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:u,pixelPosMatrix:w,transform:_,params:f,tileTransform:this.tileTransform},e,i,a):{}}querySourceFeatures(e,i){const a=this.latestFeatureIndex;if(!a||!a.rawTileData)return;const u=a.loadVTLayers(),f=i?i.sourceLayer:"",_=u._geojsonTileLayer||u[f];if(!_)return;const w=dc(i&&i.filter),{z:E,x:D,y:k}=this.tileID.canonical,z={z:E,x:D,y:k};for(let j=0;j<_.length;j++){const K=_.feature(j);if(w.needGeometry){const Oe=Yl(K,!0);if(!w.filter(new N(this.tileID.overscaledZ),Oe,this.tileID.canonical))continue}else if(!w.filter(new N(this.tileID.overscaledZ),K))continue;const te=a.getId(K,f),he=new Mg(K,E,D,k,te);he.tile=z,e.push(he)}}hasData(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(e){const i=this.expirationTime;if(e.cacheControl){const a=Sn(e.cacheControl);a["max-age"]&&(this.expirationTime=Date.now()+1e3*a["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){const a=Date.now();let u=!1;if(this.expirationTime>a)u=!1;else if(i)if(this.expirationTime<i)u=!0;else{const f=this.expirationTime-i;f?this.expirationTime=a+Math.max(f,3e4):u=!0}else u=!0;u?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)}setFeatureState(e,i){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||0===Object.keys(e).length||!i)return;const a=this.latestFeatureIndex.loadVTLayers(),u=i.style.listImages();for(const f in this.buckets){if(!i.style.hasLayer(f))continue;const _=this.buckets[f],w=_.layers[0].sourceLayer||"_geojsonTileLayer",E=a[w],D=e[w];if(!E||!D||0===Object.keys(D).length)continue;if(_.update(D,E,u,this.imageAtlas&&this.imageAtlas.patternPositions||{}),_ instanceof qh||_ instanceof Uh){const z=i.style._getSourceCache(_.layers[0].source);i._terrain&&i._terrain.enabled&&z&&_.programConfigurations.needsUpload&&i._terrain._clearRenderCacheForTile(z.id,this.tileID)}const k=i&&i.style&&i.style.getLayer(f);k&&(this.queryPadding=Math.max(this.queryPadding,k.queryRadius(_)))}}holdingForFade(){return void 0!==this.symbolFadeHoldUntil}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<So.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(e){this.symbolFadeHoldUntil=So.now()+e}setTexture(e,i){const a=i.context,u=a.gl;this.texture=this.texture||i.getTileTexture(e.width),this.texture?this.texture.update(e,{useMipmap:!0}):(this.texture=new La(a,e,u.RGBA,{useMipmap:!0}),this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE))}setDependencies(e,i){const a={};for(const u of i)a[u]=!0;this.dependencies[e]=a}hasDependency(e,i){for(const a of e){const u=this.dependencies[a];if(u)for(const f of i)if(u[f])return!0}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(e,i){if(!i||"mercator"===i.name||this._tileDebugBuffer)return;const a=Dl(Ig,this.tileID.canonical,this.tileTransform)[0],u=new Gn,f=new _s;for(let _=0;_<a.length;_++){const{x:w,y:E}=a[_];u.emplaceBack(w,E),f.emplaceBack(_)}f.emplaceBack(0),this._tileDebugIndexBuffer=e.createIndexBuffer(f),this._tileDebugBuffer=e.createVertexBuffer(u,Dd.members),this._tileDebugSegments=Tr.simpleSegment(0,0,u.length,f.length)}_makeTileBoundsBuffers(e,i){if(this._tileBoundsBuffer||!i||"mercator"===i.name)return;const a=Dl(Ig,this.tileID.canonical,this.tileTransform)[0];let u,f;if(this.isRaster){const _=function(w,E){const D=uu(w,E),k=Math.pow(2,w.z);for(let Oe=0;Oe<33;Oe++)for(let ot=0;ot<33;ot++){const Ct=wa((w.x+(ot+lh(ot))/32)/k),at=vs((w.y+(Oe+lh(Oe))/32)/k),wt=E.project(Ct,at),At=33*Oe+ot;Sl[2*At+0]=Math.round((wt.x*D.scale-D.x)*Pi),Sl[2*At+1]=Math.round((wt.y*D.scale-D.y)*Pi)}ul.fill(0),Ic.fill(0);for(let Oe=2045;Oe>=0;Oe--){const ot=4*Oe,Ct=ec[ot+0],at=ec[ot+1],wt=ec[ot+2],At=ec[ot+3],It=Ct+wt>>1,un=at+At>>1,rn=It+un-at,En=un+Ct-It,$n=33*at+Ct,fn=33*At+wt,kn=33*un+It,Fn=Math.hypot((Sl[2*$n+0]+Sl[2*fn+0])/2-Sl[2*kn+0],(Sl[2*$n+1]+Sl[2*fn+1])/2-Sl[2*kn+1])>=16;ul[kn]=ul[kn]||(Fn?1:0),Oe<1022&&(ul[kn]=ul[kn]||ul[33*(at+En>>1)+(Ct+rn>>1)]||ul[33*(At+En>>1)+(wt+rn>>1)])}const z=new An,j=new bi;let K=0;function te(Oe,ot){const Ct=33*ot+Oe;return 0===Ic[Ct]&&(z.emplaceBack(Sl[2*Ct+0],Sl[2*Ct+1],Oe*Pi/32,ot*Pi/32),Ic[Ct]=++K),Ic[Ct]-1}function he(Oe,ot,Ct,at,wt,At){const It=Oe+Ct>>1,un=ot+at>>1;if(Math.abs(Oe-wt)+Math.abs(ot-At)>1&&ul[33*un+It])he(wt,At,Oe,ot,It,un),he(Ct,at,wt,At,It,un);else{const rn=te(Oe,ot),En=te(Ct,at),$n=te(wt,At);j.emplaceBack(rn,En,$n)}}return he(0,0,32,32,32,0),he(32,32,0,0,0,32),{vertices:z,indices:j}}(this.tileID.canonical,i);u=_.vertices,f=_.indices}else{u=new An,f=new bi;for(const{x:w,y:E}of a)u.emplaceBack(w,E,0,0);const _=Lu(u.int16,void 0,4);for(let w=0;w<_.length;w+=3)f.emplaceBack(_[w],_[w+1],_[w+2])}this._tileBoundsBuffer=e.createVertexBuffer(u,dy.members),this._tileBoundsIndexBuffer=e.createIndexBuffer(f),this._tileBoundsSegments=Tr.simpleSegment(0,0,u.length,f.length)}_makeGlobeTileDebugBuffers(e,i){const a=i.projection;if(!a||"globe"!==a.name||i.freezeTileCoverage)return;const u=this.tileID.canonical,f=nu(Sm(u,i)),_=Iu(i.zoom);let w;_>0&&(w=Gp(new Float64Array(16),i.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(e,u,i,f,w,_),this._makeGlobeTileDebugTextBuffer(e,u,i,f,w,_)}_globePoint(e,i,a,u,f,_,w){let E=Tl(e,i,a);if(_){const D=1<<a.z,k=$a(u.center.lng),z=al(u.center.lat),j=(a.x+.5)/D-k;let K=0;j>.5?K=-1:j<-.5&&(K=1);let te=(e/Pi+a.x)/D+K,he=(i/Pi+a.y)/D;te=(te-k)*u._pixelsPerMercatorPixel+k,he=(he-z)*u._pixelsPerMercatorPixel+z;const Oe=[te*u.worldSize,he*u.worldSize,0];zr(Oe,Oe,_),E=ql(E,Oe,w)}return zr(E,E,f)}_makeGlobeTileDebugBorderBuffer(e,i,a,u,f,_){const w=new Gn,E=new _s,D=new on,k=(j,K,te,he,Oe)=>{const ot=(te-j)/(Oe-1),Ct=(he-K)/(Oe-1),at=w.length;for(let wt=0;wt<Oe;wt++){const At=j+wt*ot,It=K+wt*Ct;w.emplaceBack(At,It);const un=this._globePoint(At,It,i,a,u,f,_);D.emplaceBack(un[0],un[1],un[2]),E.emplaceBack(at+wt)}},z=Pi;k(0,0,z,0,16),k(z,0,z,z,16),k(z,z,0,z,16),k(0,z,0,0,16),this._tileDebugIndexBuffer=e.createIndexBuffer(E),this._tileDebugBuffer=e.createVertexBuffer(w,Dd.members),this._globeTileDebugBorderBuffer=e.createVertexBuffer(D,Xp.members),this._tileDebugSegments=Tr.simpleSegment(0,0,w.length,E.length)}_makeGlobeTileDebugTextBuffer(e,i,a,u,f,_){const w=Pi/4,E=new Gn,D=new bi,k=new on,z=25;D.reserve(32),E.reserve(z),k.reserve(z);const j=(K,te)=>z*K+te;for(let K=0;K<z;K++){const te=K*w;for(let he=0;he<z;he++){const Oe=he*w;E.emplaceBack(Oe,te);const ot=this._globePoint(Oe,te,i,a,u,f,_);k.emplaceBack(ot[0],ot[1],ot[2])}}for(let K=0;K<4;K++)for(let te=0;te<4;te++){const he=j(K,te),Oe=j(K,te+1),ot=j(K+1,te),Ct=j(K+1,te+1);D.emplaceBack(he,Oe,ot),D.emplaceBack(ot,Oe,Ct)}this._tileDebugTextIndexBuffer=e.createIndexBuffer(D),this._tileDebugTextBuffer=e.createVertexBuffer(E,Dd.members),this._globeTileDebugTextBuffer=e.createVertexBuffer(k,Xp.members),this._tileDebugTextSegments=Tr.simpleSegment(0,0,z,32)}}class Ag{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(e,i,a){const u=String(i);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][u]=this.stateChanges[e][u]||{},ze(this.stateChanges[e][u],a),null===this.deletedStates[e]){this.deletedStates[e]={};for(const f in this.state[e])f!==u&&(this.deletedStates[e][f]=null)}else if(this.deletedStates[e]&&null===this.deletedStates[e][u]){this.deletedStates[e][u]={};for(const f in this.state[e][u])a[f]||(this.deletedStates[e][u][f]=null)}else for(const f in a)this.deletedStates[e]&&this.deletedStates[e][u]&&null===this.deletedStates[e][u][f]&&delete this.deletedStates[e][u][f]}removeFeatureState(e,i,a){if(null===this.deletedStates[e])return;const u=String(i);if(this.deletedStates[e]=this.deletedStates[e]||{},a&&void 0!==i)null!==this.deletedStates[e][u]&&(this.deletedStates[e][u]=this.deletedStates[e][u]||{},this.deletedStates[e][u][a]=null);else if(void 0!==i)if(this.stateChanges[e]&&this.stateChanges[e][u])for(a in this.deletedStates[e][u]={},this.stateChanges[e][u])this.deletedStates[e][u][a]=null;else this.deletedStates[e][u]=null;else this.deletedStates[e]=null}getState(e,i){const a=String(i),u=ze({},(this.state[e]||{})[a],(this.stateChanges[e]||{})[a]);if(null===this.deletedStates[e])return{};if(this.deletedStates[e]){const f=this.deletedStates[e][i];if(null===f)return{};for(const _ in f)delete u[_]}return u}initializeTileState(e,i){e.setFeatureState(this.state,i)}coalesceChanges(e,i){const a={};for(const u in this.stateChanges){this.state[u]=this.state[u]||{};const f={};for(const _ in this.stateChanges[u])this.state[u][_]||(this.state[u][_]={}),ze(this.state[u][_],this.stateChanges[u][_]),f[_]=this.state[u][_];a[u]=f}for(const u in this.deletedStates){this.state[u]=this.state[u]||{};const f={};if(null===this.deletedStates[u])for(const _ in this.state[u])f[_]={},this.state[u][_]={};else for(const _ in this.deletedStates[u]){if(null===this.deletedStates[u][_])this.state[u][_]={};else if(this.state[u][_])for(const w of Object.keys(this.deletedStates[u][_]))delete this.state[u][_][w];f[_]=this.state[u][_]}a[u]=a[u]||{},ze(a[u],f)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(a).length)for(const u in e)e[u].setFeatureState(a,i)}}class Sg{constructor(e){this.size=e,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(e,i){const a=this.toIdx(e,i);return{min:this.minimums[a],max:this.maximums[a]}}isLeaf(e,i){return this.leaves[this.toIdx(e,i)]}toIdx(e,i){return i*this.size+e}}function Pg(t,e,i,a){let u=0,f=Number.MAX_VALUE;for(let _=0;_<3;_++)if(Math.abs(a[_])<1e-15){if(i[_]<t[_]||i[_]>e[_])return null}else{const w=1/a[_];let E=(t[_]-i[_])*w,D=(e[_]-i[_])*w;if(E>D){const k=E;E=D,D=k}if(E>u&&(u=E),D<f&&(f=D),u>f)return null}return u}function em(t,e,i,a,u,f,_,w,E,D,k){const z=a-t,j=u-e,K=f-i,te=_-t,he=w-e,Oe=E-i,ot=k[1]*Oe-k[2]*he,Ct=k[2]*te-k[0]*Oe,at=k[0]*he-k[1]*te,wt=z*ot+j*Ct+K*at;if(Math.abs(wt)<1e-15)return null;const At=1/wt,It=D[0]-t,un=D[1]-e,rn=D[2]-i,En=(It*ot+un*Ct+rn*at)*At;if(En<0||En>1)return null;const $n=un*K-rn*j,fn=rn*z-It*K,kn=It*j-un*z,Fn=(k[0]*$n+k[1]*fn+k[2]*kn)*At;return Fn<0||En+Fn>1?null:(te*$n+he*fn+Oe*kn)*At}function tm(t,e,i){return(t-e)/(i-e)}function sd(t,e,i,a,u,f,_,w,E){const D=1<<i,k=f-a,z=_-u,j=(t+1)/D*k+a,K=(e+0)/D*z+u,te=(e+1)/D*z+u;w[0]=(t+0)/D*k+a,w[1]=K,E[0]=j,E[1]=te}class Og{constructor(e){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=e,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const i=function(f){const _=Math.ceil(Math.log2(f.dim/8)),w=[];let E=Math.ceil(Math.pow(2,_));const D=1/E,k=(K,te,he,Oe,ot)=>{const Ct=Oe?1:0,at=(K+1)*he-Ct,wt=te*he,At=(te+1)*he-Ct;ot[0]=K*he,ot[1]=wt,ot[2]=at,ot[3]=At};let z=new Sg(E);const j=[];for(let K=0;K<E*E;K++){k(K%E,Math.floor(K/E),D,!1,j);const te=tc(j[0],j[1],f),he=tc(j[2],j[1],f),Oe=tc(j[2],j[3],f),ot=tc(j[0],j[3],f);z.minimums.push(Math.min(te,he,Oe,ot)),z.maximums.push(Math.max(te,he,Oe,ot)),z.leaves.push(1)}for(w.push(z),E/=2;E>=1;E/=2){const K=w[w.length-1];z=new Sg(E);for(let te=0;te<E*E;te++){k(te%E,Math.floor(te/E),2,!0,j);const he=K.getElevation(j[0],j[1]),Oe=K.getElevation(j[2],j[1]),ot=K.getElevation(j[2],j[3]),Ct=K.getElevation(j[0],j[3]),at=K.isLeaf(j[0],j[1]),wt=K.isLeaf(j[2],j[1]),At=K.isLeaf(j[2],j[3]),It=K.isLeaf(j[0],j[3]),un=Math.min(he.min,Oe.min,ot.min,Ct.min),rn=Math.max(he.max,Oe.max,ot.max,Ct.max),En=at&&wt&&At&&It;z.maximums.push(rn),z.minimums.push(un),z.leaves.push(rn-un<=5&&En?1:0)}w.push(z)}return w}(this.dem),a=i.length-1,u=i[a];this._addNode(u.minimums[0],u.maximums[0],u.leaves[0]),this._construct(i,0,0,a,0)}raycastRoot(e,i,a,u,f,_,w=1){return Pg([e,i,-100],[a,u,this.maximums[0]*w],f,_)}raycast(e,i,a,u,f,_,w=1){if(!this.nodeCount)return null;const E=this.raycastRoot(e,i,a,u,f,_,w);if(null==E)return null;const D=[],k=[],z=[],j=[],K=[{idx:0,t:E,nodex:0,nodey:0,depth:0}];for(;K.length>0;){const{idx:te,t:he,nodex:Oe,nodey:ot,depth:Ct}=K.pop();if(this.leaves[te]){sd(Oe,ot,Ct,e,i,a,u,z,j);const wt=1<<Ct,At=(Oe+0)/wt,It=(Oe+1)/wt,un=(ot+0)/wt,rn=(ot+1)/wt,En=tc(At,un,this.dem)*w,$n=tc(It,un,this.dem)*w,fn=tc(It,rn,this.dem)*w,kn=tc(At,rn,this.dem)*w,Fn=em(z[0],z[1],En,j[0],z[1],$n,j[0],j[1],fn,f,_),Zn=em(j[0],j[1],fn,z[0],j[1],kn,z[0],z[1],En,f,_),Yn=Math.min(null!==Fn?Fn:Number.MAX_VALUE,null!==Zn?Zn:Number.MAX_VALUE);if(Yn!==Number.MAX_VALUE)return Yn;{const Tn=Td([],f,_,he);if(nm(En,$n,kn,fn,tm(Tn[0],z[0],j[0]),tm(Tn[1],z[1],j[1]))>=Tn[2])return he}continue}let at=0;for(let wt=0;wt<this._siblingOffset.length;wt++){sd((Oe<<1)+this._siblingOffset[wt][0],(ot<<1)+this._siblingOffset[wt][1],Ct+1,e,i,a,u,z,j),z[2]=-100,j[2]=this.maximums[this.childOffsets[te]+wt]*w;const At=Pg(z,j,f,_);if(null!=At){const It=At;D[wt]=It;let un=!1;for(let rn=0;rn<at&&!un;rn++)It>=D[k[rn]]&&(k.splice(rn,0,wt),un=!0);un||(k[at]=wt),at++}}for(let wt=0;wt<at;wt++){const At=k[wt];K.push({idx:this.childOffsets[te]+At,t:D[At],nodex:(Oe<<1)+this._siblingOffset[At][0],nodey:(ot<<1)+this._siblingOffset[At][1],depth:Ct+1})}}return null}_addNode(e,i,a){return this.minimums.push(e),this.maximums.push(i),this.leaves.push(a),this.childOffsets.push(0),this.nodeCount++}_construct(e,i,a,u,f){if(1===e[u].isLeaf(i,a))return;this.childOffsets[f]||(this.childOffsets[f]=this.nodeCount);const _=u-1,w=e[_];let E=0,D=0;for(let k=0;k<this._siblingOffset.length;k++){const z=2*i+this._siblingOffset[k][0],j=2*a+this._siblingOffset[k][1],K=w.getElevation(z,j),te=w.isLeaf(z,j),he=this._addNode(K.min,K.max,te);te&&(E|=1<<k),D||(D=he)}for(let k=0;k<this._siblingOffset.length;k++)E&1<<k||this._construct(e,2*i+this._siblingOffset[k][0],2*a+this._siblingOffset[k][1],_,D+k)}}function nm(t,e,i,a,u,f){return Kn(Kn(t,i,f),Kn(e,a,f),u)}function tc(t,e,i){const a=i.dim,u=ve(t*a-.5,0,a-1),f=ve(e*a-.5,0,a-1),_=Math.floor(u),w=Math.floor(f),E=Math.min(_+1,a-1),D=Math.min(w+1,a-1);return nm(i.get(_,w),i.get(E,w),i.get(_,D),i.get(E,D),u-_,f-w)}const Rg={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function hy(t,e,i){return(256*t*256+256*e+i)/10-1e4}function ch(t,e,i){return 256*t+e+i/256-32768}class bp{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(e,i,a,u=!1,f=!1){if(this.uid=e,i.height!==i.width)throw new RangeError("DEM tiles must be square");if(a&&"mapbox"!==a&&"terrarium"!==a)return St(`"${a}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=i.height;const _=this.dim=i.height-2,w=new Uint32Array(i.data.buffer);if(this.pixels=new Uint8Array(i.data.buffer),this.encoding=a||"mapbox",this.borderReady=u,!u){for(let E=0;E<_;E++)w[this._idx(-1,E)]=w[this._idx(0,E)],w[this._idx(_,E)]=w[this._idx(_-1,E)],w[this._idx(E,-1)]=w[this._idx(E,0)],w[this._idx(E,_)]=w[this._idx(E,_-1)];w[this._idx(-1,-1)]=w[this._idx(0,0)],w[this._idx(_,-1)]=w[this._idx(_-1,0)],w[this._idx(-1,_)]=w[this._idx(0,_-1)],w[this._idx(_,_)]=w[this._idx(_-1,_-1)],f&&this._buildQuadTree()}}_buildQuadTree(){this._tree=new Og(this)}get(e,i,a=!1){a&&(e=ve(e,-1,this.dim),i=ve(i,-1,this.dim));const u=4*this._idx(e,i);return("terrarium"===this.encoding?ch:hy)(this.pixels[u],this.pixels[u+1],this.pixels[u+2])}static getUnpackVector(e){return Rg[e]}get unpackVector(){return Rg[this.encoding]}_idx(e,i){if(e<-1||e>=this.dim+1||i<-1||i>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(i+1)*this.stride+(e+1)}static pack(e,i){const a=[0,0,0,0],u=bp.getUnpackVector(i);let f=Math.floor((e+u[3])/u[2]);return a[2]=f%256,f=Math.floor(f/256),a[1]=f%256,f=Math.floor(f/256),a[0]=f,a}getPixels(){return new Ca({width:this.stride,height:this.stride},this.pixels)}backfillBorder(e,i,a){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");let u=i*this.dim,f=i*this.dim+this.dim,_=a*this.dim,w=a*this.dim+this.dim;switch(i){case-1:u=f-1;break;case 1:f=u+1}switch(a){case-1:_=w-1;break;case 1:w=_+1}const E=-i*this.dim,D=-a*this.dim;for(let k=_;k<w;k++)for(let z=u;z<f;z++){const j=4*this._idx(z,k),K=4*this._idx(z+E,k+D);this.pixels[j+0]=e.pixels[K+0],this.pixels[j+1]=e.pixels[K+1],this.pixels[j+2]=e.pixels[K+2],this.pixels[j+3]=e.pixels[K+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}ui(bp,"DEMData"),ui(Og,"DemMinMaxQuadTree",{omit:["dem"]});class Dv{constructor(e,i){this.max=e,this.onRemove=i,this.reset()}reset(){for(const e in this.data)for(const i of this.data[e])i.timeout&&clearTimeout(i.timeout),this.onRemove(i.value);return this.data={},this.order=[],this}add(e,i,a){const u=e.wrapped().key;void 0===this.data[u]&&(this.data[u]=[]);const f={value:i,timeout:void 0};if(void 0!==a&&(f.timeout=setTimeout(()=>{this.remove(e,f)},a)),this.data[u].push(f),this.order.push(u),this.order.length>this.max){const _=this._getAndRemoveByKey(this.order[0]);_&&this.onRemove(_)}return this}has(e){return e.wrapped().key in this.data}getAndRemove(e){return this.has(e)?this._getAndRemoveByKey(e.wrapped().key):null}_getAndRemoveByKey(e){const i=this.data[e].shift();return i.timeout&&clearTimeout(i.timeout),0===this.data[e].length&&delete this.data[e],this.order.splice(this.order.indexOf(e),1),i.value}getByKey(e){const i=this.data[e];return i?i[0].value:null}get(e){return this.has(e)?this.data[e.wrapped().key][0].value:null}remove(e,i){if(!this.has(e))return this;const a=e.wrapped().key,u=void 0===i?0:this.data[a].indexOf(i),f=this.data[a][u];return this.data[a].splice(u,1),f.timeout&&clearTimeout(f.timeout),0===this.data[a].length&&delete this.data[a],this.onRemove(f.value),this.order.splice(this.order.indexOf(a),1),this}setMaxSize(e){for(this.max=e;this.order.length>this.max;){const i=this._getAndRemoveByKey(this.order[0]);i&&this.onRemove(i)}return this}filter(e){const i=[];for(const a in this.data)for(const u of this.data[a])e(u.value)||i.push(u);for(const a of i)this.remove(a.value.tileID,a)}}class ad{constructor(e,i,a){this.func=e,this.mask=i,this.range=a}}ad.ReadOnly=!1,ad.ReadWrite=!0,ad.disabled=new ad(519,ad.ReadOnly,[0,1]);class om{constructor(e,i,a,u,f,_){this.test=e,this.ref=i,this.mask=a,this.fail=u,this.depthFail=f,this.pass=_}}om.disabled=new om({func:519,mask:0},0,0,7680,7680,7680);class Pl{constructor(e,i,a){this.blendFunction=e,this.blendColor=i,this.mask=a}}Pl.Replace=[1,0],Pl.disabled=new Pl(Pl.Replace,Co.transparent,[!1,!1,!1,!1]),Pl.unblended=new Pl(Pl.Replace,Co.transparent,[!0,!0,!0,!0]),Pl.alphaBlended=new Pl([1,771],Co.transparent,[!0,!0,!0,!0]);class dl{constructor(e,i,a){this.enable=e,this.mode=i,this.frontFace=a}}dl.disabled=new dl(!1,1029,2305),dl.backCCW=new dl(!0,1029,2305),dl.backCW=new dl(!0,1029,2304),dl.frontCW=new dl(!0,1028,2304),dl.frontCCW=new dl(!0,1028,2305);class Ac extends ho{constructor(e,i,a){super(),this.id=e,this._onlySymbols=a,i.on("data",u=>{"source"===u.dataType&&"metadata"===u.sourceDataType&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&"source"===u.dataType&&"content"===u.sourceDataType&&(this.reload(),this.transform&&this.update(this.transform))}),i.on("error",()=>{this._sourceErrored=!0}),this._source=i,this._tiles={},this._cache=new Dv(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=i.minTileCacheSize,this._maxTileCacheSize=i.maxTileCacheSize,this._loadedParentTiles={},this._coveredTiles={},this._state=new Ag,this._isRaster="raster"===this._source.type||"raster-dem"===this._source.type||"custom"===this._source.type&&"raster"===this._source._dataType}onAdd(e){this.map=e,this._minTileCacheSize=void 0===this._minTileCacheSize&&e?e._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=void 0===this._maxTileCacheSize&&e?e._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const e in this._tiles){const i=this._tiles[e];if("loaded"!==i.state&&"errored"!==i.state)return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const e=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,e&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(e,i){return e.isSymbolTile=this._onlySymbols,this._source.loadTile(e,i)}_unloadTile(e){if(this._source.unloadTile)return this._source.unloadTile(e,()=>{})}_abortTile(e){if(this._source.abortTile)return this._source.abortTile(e,()=>{})}serialize(){return this._source.serialize()}prepare(e){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const i in this._tiles){const a=this._tiles[i];a.upload(e),a.prepare(this.map.style.imageManager)}}getIds(){return lt(this._tiles).map(e=>e.tileID).sort(wp).map(e=>e.key)}getRenderableIds(e){const i=[];for(const a in this._tiles)this._isIdRenderable(+a,e)&&i.push(this._tiles[a]);return e?i.sort((a,u)=>{const f=a.tileID,_=u.tileID,w=new Me(f.canonical.x,f.canonical.y)._rotate(this.transform.angle),E=new Me(_.canonical.x,_.canonical.y)._rotate(this.transform.angle);return f.overscaledZ-_.overscaledZ||E.y-w.y||E.x-w.x}).map(a=>a.tileID.key):i.map(a=>a.tileID).sort(wp).map(a=>a.key)}hasRenderableParent(e){const i=this.findLoadedParent(e,0);return!!i&&this._isIdRenderable(i.tileID.key)}_isIdRenderable(e,i){return this._tiles[e]&&this._tiles[e].hasData()&&!this._coveredTiles[e]&&(i||!this._tiles[e].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const e in this._tiles)"errored"!==this._tiles[e].state&&this._reloadTile(+e,"reloading")}}_reloadTile(e,i){const a=this._tiles[e];a&&("loading"!==a.state&&(a.state=i),this._loadTile(a,this._tileLoaded.bind(this,a,e,i)))}_tileLoaded(e,i,a,u){if(u)if(e.state="errored",404!==u.status)this._source.fire(new Ai(u,{tile:e}));else if("raster-dem"===this._source.type&&this.usedForTerrain&&this.map.painter.terrain){const f=this.map.painter.terrain;this.update(this.transform,f.getScaledDemTileSize(),!0),f.resetTileLookupCache(this.id)}else this.update(this.transform);else e.timeAdded=So.now(),"expired"===a&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(i,e),"raster-dem"===this._source.type&&e.dem&&this._backfillDEM(e),this._state.initializeTileState(e,this.map?this.map.painter:null),this._source.fire(new oo("data",{dataType:"source",tile:e,coord:e.tileID,sourceCacheId:this.id}))}_backfillDEM(e){const i=this.getRenderableIds();for(let u=0;u<i.length;u++){const f=i[u];if(e.neighboringTiles&&e.neighboringTiles[f]){const _=this.getTileByID(f);a(e,_),a(_,e)}}function a(u,f){if(!u.dem||u.dem.borderReady)return;u.needsHillshadePrepare=!0,u.needsDEMTextureUpload=!0;let _=f.tileID.canonical.x-u.tileID.canonical.x;const w=f.tileID.canonical.y-u.tileID.canonical.y,E=Math.pow(2,u.tileID.canonical.z),D=f.tileID.key;0===_&&0===w||Math.abs(w)>1||(Math.abs(_)>1&&(1===Math.abs(_+E)?_+=E:1===Math.abs(_-E)&&(_-=E)),f.dem&&u.dem&&(u.dem.backfillBorder(f.dem,_,w),u.neighboringTiles&&u.neighboringTiles[D]&&(u.neighboringTiles[D].backfilled=!0)))}}getTile(e){return this.getTileByID(e.key)}getTileByID(e){return this._tiles[e]}_retainLoadedChildren(e,i,a,u){for(const f in this._tiles){let _=this._tiles[f];if(u[f]||!_.hasData()||_.tileID.overscaledZ<=i||_.tileID.overscaledZ>a)continue;let w=_.tileID;for(;_&&_.tileID.overscaledZ>i+1;){const D=_.tileID.scaledTo(_.tileID.overscaledZ-1);_=this._tiles[D.key],_&&_.hasData()&&(w=D)}let E=w;for(;E.overscaledZ>i;)if(E=E.scaledTo(E.overscaledZ-1),e[E.key]){u[w.key]=w;break}}}findLoadedParent(e,i){if(e.key in this._loadedParentTiles){const a=this._loadedParentTiles[e.key];return a&&a.tileID.overscaledZ>=i?a:null}for(let a=e.overscaledZ-1;a>=i;a--){const u=e.scaledTo(a),f=this._getLoadedTile(u);if(f)return f}}_getLoadedTile(e){const i=this._tiles[e.key];return i&&i.hasData()?i:this._cache.getByKey(this._source.reparseOverscaled?e.wrapped().key:e.canonical.key)}updateCacheSize(e,i){i=i||this._source.tileSize;const a=Math.ceil(e.width/i)+1,u=Math.ceil(e.height/i)+1,f=Math.floor(a*u*5),_="number"==typeof this._minTileCacheSize?Math.max(this._minTileCacheSize,f):f,w="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,_):_;this._cache.setMaxSize(w)}handleWrapJump(e){const i=Math.round((e-(void 0===this._prevLng?e:this._prevLng))/360);if(this._prevLng=e,i){const a={};for(const u in this._tiles){const f=this._tiles[u];f.tileID=f.tileID.unwrapTo(f.tileID.wrap+i),a[f.tileID.key]=f}this._tiles=a;for(const u in this._timers)clearTimeout(this._timers[u]),delete this._timers[u];for(const u in this._tiles)this._setTileReloadTimer(+u,this._tiles[u])}}update(e,i,a){if(this.transform=e,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!a)return;let u;this.updateCacheSize(e,i),"globe"!==this.transform.projection.name&&this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?u=e.getVisibleUnwrappedCoordinates(this._source.tileID).map(w=>new Is(w.canonical.z,w.wrap,w.canonical.z,w.canonical.x,w.canonical.y)):(u=e.coveringTiles({tileSize:i||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!a,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(u=u.filter(w=>this._source.hasTile(w)))):u=[];const f=this._updateRetainedTiles(u);if(Lg(this._source.type)&&0!==u.length){const w={},E={},D=Object.keys(f);for(const z of D){const j=f[z],K=this._tiles[z];if(!K||K.fadeEndTime&&K.fadeEndTime<=So.now())continue;const te=this.findLoadedParent(j,Math.max(j.overscaledZ-Ac.maxOverzooming,this._source.minzoom));te&&(this._addTile(te.tileID),w[te.tileID.key]=te.tileID),E[z]=j}const k=u[u.length-1].overscaledZ;for(const z in this._tiles){const j=this._tiles[z];if(f[z]||!j.hasData())continue;let K=j.tileID;for(;K.overscaledZ>k;){K=K.scaledTo(K.overscaledZ-1);const te=this._tiles[K.key];if(te&&te.hasData()&&E[K.key]){f[z]=j.tileID;break}}}for(const z in w)f[z]||(this._coveredTiles[z]=!0,f[z]=w[z])}for(const w in f)this._tiles[w].clearFadeHold();const _=function(w,E){const D=[];for(const k in w)k in E||D.push(k);return D}(this._tiles,f);for(const w of _){const E=this._tiles[w];E.hasSymbolBuckets&&!E.holdingForFade()?E.setHoldDuration(this.map._fadeDuration):E.hasSymbolBuckets&&!E.symbolFadeFinished()||this._removeTile(+w)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const e in this._tiles)this._tiles[e].holdingForFade()&&this._removeTile(+e)}_updateRetainedTiles(e){const i={};if(0===e.length)return i;const a={},u=e.reduce((D,k)=>Math.min(D,k.overscaledZ),1/0),f=e[0].overscaledZ,_=Math.max(f-Ac.maxOverzooming,this._source.minzoom),w=Math.max(f+Ac.maxUnderzooming,this._source.minzoom),E={};for(const D of e){const k=this._addTile(D);i[D.key]=D,k.hasData()||u<this._source.maxzoom&&(E[D.key]=D)}this._retainLoadedChildren(E,u,w,i);for(const D of e){let k=this._tiles[D.key];if(k.hasData())continue;if(D.canonical.z>=this._source.maxzoom){const j=D.children(this._source.maxzoom)[0],K=this.getTile(j);if(K&&K.hasData()){i[j.key]=j;continue}}else{const j=D.children(this._source.maxzoom);if(i[j[0].key]&&i[j[1].key]&&i[j[2].key]&&i[j[3].key])continue}let z=k.wasRequested();for(let j=D.overscaledZ-1;j>=_;--j){const K=D.scaledTo(j);if(a[K.key]||(a[K.key]=!0,k=this.getTile(K),!k&&z&&(k=this._addTile(K)),k&&(i[K.key]=K,z=k.wasRequested(),k.hasData())))break}}return i}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const e in this._tiles){const i=[];let a,u=this._tiles[e].tileID;for(;u.overscaledZ>0;){if(u.key in this._loadedParentTiles){a=this._loadedParentTiles[u.key];break}i.push(u.key);const f=u.scaledTo(u.overscaledZ-1);if(a=this._getLoadedTile(f),a)break;u=f}for(const f of i)this._loadedParentTiles[f]=a}}_addTile(e){let i=this._tiles[e.key];if(i)return i;i=this._cache.getAndRemove(e),i&&(this._setTileReloadTimer(e.key,i),i.tileID=e,this._state.initializeTileState(i,this.map?this.map.painter:null),this._cacheTimers[e.key]&&(clearTimeout(this._cacheTimers[e.key]),delete this._cacheTimers[e.key],this._setTileReloadTimer(e.key,i)));const a=!!i;if(!a){const u=this.map?this.map.painter:null;i=new xp(e,this._source.tileSize*e.overscaleFactor(),this.transform.tileZoom,u,this._isRaster),this._loadTile(i,this._tileLoaded.bind(this,i,e.key,i.state))}return i?(i.uses++,this._tiles[e.key]=i,a||this._source.fire(new oo("dataloading",{tile:i,coord:i.tileID,dataType:"source"})),i):null}_setTileReloadTimer(e,i){e in this._timers&&(clearTimeout(this._timers[e]),delete this._timers[e]);const a=i.getExpiryTimeout();a&&(this._timers[e]=setTimeout(()=>{this._reloadTile(e,"expired"),delete this._timers[e]},a))}_removeTile(e){const i=this._tiles[e];i&&(i.uses--,delete this._tiles[e],this._timers[e]&&(clearTimeout(this._timers[e]),delete this._timers[e]),i.uses>0||(i.hasData()&&"reloading"!==i.state?this._cache.add(i.tileID,i,i.getExpiryTimeout()):(i.aborted=!0,this._abortTile(i),this._unloadTile(i))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const e in this._tiles)this._removeTile(+e);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(e,i,a){const u=[],f=this.transform;if(!f)return u;const _="globe"===f.projection.name,w=$a(f.center.lng);for(const E in this._tiles){const D=this._tiles[E];if(a&&D.clearQueryDebugViz(),D.holdingForFade())continue;let k;if(_){const z=D.tileID.canonical;if(0===z.z){const j=[Math.abs(ve(w,...Sc(z,-1))-w),Math.abs(ve(w,...Sc(z,1))-w)];k=[0,2*j.indexOf(Math.min(...j))-1]}else{const j=[Math.abs(ve(w,...Sc(z,-1))-w),Math.abs(ve(w,...Sc(z,0))-w),Math.abs(ve(w,...Sc(z,1))-w)];k=[j.indexOf(Math.min(...j))-1]}}else k=[0];for(const z of k){const j=e.containsTile(D,f,i,z);j&&u.push(j)}}return u}getVisibleCoordinates(e){const i=this.getRenderableIds(e).map(a=>this._tiles[a].tileID);for(const a of i)a.projMatrix=this.transform.calculateProjMatrix(a.toUnwrapped());return i}hasTransition(){if(this._source.hasTransition())return!0;if(Lg(this._source.type))for(const e in this._tiles){const i=this._tiles[e];if(void 0!==i.fadeEndTime&&i.fadeEndTime>=So.now())return!0}return!1}setFeatureState(e,i,a){this._state.updateState(e=e||"_geojsonTileLayer",i,a)}removeFeatureState(e,i,a){this._state.removeFeatureState(e=e||"_geojsonTileLayer",i,a)}getFeatureState(e,i){return this._state.getState(e=e||"_geojsonTileLayer",i)}setDependencies(e,i,a){const u=this._tiles[e];u&&u.setDependencies(i,a)}reloadTilesForDependencies(e,i){for(const a in this._tiles)this._tiles[a].hasDependency(e,i)&&this._reloadTile(+a,"reloading");this._cache.filter(a=>!a.hasDependency(e,i))}_preloadTiles(e,i){if(!this._sourceLoaded){const w=()=>{this._sourceLoaded&&(this._source.off("data",w),this._preloadTiles(e,i))};return void this._source.on("data",w)}const a=new Map,u=Array.isArray(e)?e:[e],f=this.map.painter.terrain,_=this.usedForTerrain&&f?f.getScaledDemTileSize():this._source.tileSize;for(const w of u){const E=w.coveringTiles({tileSize:_,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const D of E)a.set(D.key,D);this.usedForTerrain&&w.updateElevation(!1)}mt(Array.from(a.values()),(w,E)=>{const D=new xp(w,this._source.tileSize*w.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(D,k=>{"raster-dem"===this._source.type&&D.dem&&this._backfillDEM(D),E(k,D)})},i)}}function wp(t,e){const i=Math.abs(2*t.wrap)-+(t.wrap<0),a=Math.abs(2*e.wrap)-+(e.wrap<0);return t.overscaledZ-e.overscaledZ||a-i||e.canonical.y-t.canonical.y||e.canonical.x-t.canonical.x}function Lg(t){return"raster"===t||"image"===t||"video"===t||"custom"===t}function Sc(t,e){const i=1<<t.z;return[t.x/i+e,(t.x+1)/i+e]}Ac.maxOverzooming=10,Ac.maxUnderzooming=3;class Cp{constructor(e,i,a){this._demTile=e,this._dem=this._demTile.dem,this._scale=i,this._offset=a}static create(e,i,a){const u=a||e.findDEMTileFor(i);if(!u||!u.dem)return;const f=u.dem,_=u.tileID,w=1<<i.canonical.z-_.canonical.z;return new Cp(u,u.tileSize/Pi/w,[(i.canonical.x/w-_.canonical.x)*f.dim,(i.canonical.y/w-_.canonical.y)*f.dim])}tileCoordToPixel(e,i){const a=i*this._scale+this._offset[1],u=Math.floor(e*this._scale+this._offset[0]),f=Math.floor(a);return new Me(u,f)}getElevationAt(e,i,a,u){const f=e*this._scale+this._offset[0],_=i*this._scale+this._offset[1],w=Math.floor(f),E=Math.floor(_),D=this._dem;return u=!!u,a?Kn(Kn(D.get(w,E,u),D.get(w,E+1,u),_-E),Kn(D.get(w+1,E,u),D.get(w+1,E+1,u),_-E),f-w):D.get(w,E,u)}getElevationAtPixel(e,i,a){return this._dem.get(e,i,!!a)}getMeterToDEM(e){return(1<<this._demTile.tileID.canonical.z)*Zs(1,e)*this._dem.stride}}class kg{constructor(e,i){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new za(Pi,16,0),this.featureIndexArray=new bu,this.promoteId=i}insert(e,i,a,u,f,_=0){const w=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(a,u,f,_);const E=this.grid;for(let D=0;D<i.length;D++){const k=i[D],z=[1/0,1/0,-1/0,-1/0];for(let j=0;j<k.length;j++){const K=k[j];z[0]=Math.min(z[0],K.x),z[1]=Math.min(z[1],K.y),z[2]=Math.max(z[2],K.x),z[3]=Math.max(z[3],K.y)}z[0]<Pi&&z[1]<Pi&&z[2]>=0&&z[3]>=0&&E.insert(w,z[0],z[1],z[2],z[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new $d(new ip(this.rawTileData)).layers,this.sourceLayerCoder=new vp(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const e in this.vtLayers)this.vtFeatures[e]=[]}return this.vtLayers}query(e,i,a,u){this.loadVTLayers();const f=e.params||{},_=dc(f.filter),w=e.tileResult,E=e.transform,D=w.bufferedTilespaceBounds,k=this.grid.query(D.min.x,D.min.y,D.max.x,D.max.y,(te,he,Oe,ot)=>ru(w.bufferedTilespaceGeometry,te,he,Oe,ot));k.sort(py);let z=null;E.elevation&&k.length>0&&(z=Cp.create(E.elevation,this.tileID));const j={};let K;for(let te=0;te<k.length;te++){const he=k[te];if(he===K)continue;K=he;const Oe=this.featureIndexArray.get(he);let ot=null;this.loadMatchingFeature(j,Oe,_,f.layers,f.availableImages,i,a,u,(Ct,at,wt,At=0)=>(ot||(ot=Dl(Ct,this.tileID.canonical,e.tileTransform)),at.queryIntersectsFeature(w,Ct,wt,ot,this.z,e.transform,e.pixelPosMatrix,z,At)))}return j}loadMatchingFeature(e,i,a,u,f,_,w,E,D){const{featureIndex:k,bucketIndex:z,sourceLayerIndex:j,layoutVertexArrayOffset:K}=i,te=this.bucketLayerIDs[z];if(u&&!function(Ct,at){for(let wt=0;wt<Ct.length;wt++)if(at.indexOf(Ct[wt])>=0)return!0;return!1}(u,te))return;const he=this.sourceLayerCoder.decode(j),Oe=this.vtLayers[he].feature(k);if(a.needGeometry){const Ct=Yl(Oe,!0);if(!a.filter(new N(this.tileID.overscaledZ),Ct,this.tileID.canonical))return}else if(!a.filter(new N(this.tileID.overscaledZ),Oe))return;const ot=this.getId(Oe,he);for(let Ct=0;Ct<te.length;Ct++){const at=te[Ct];if(u&&u.indexOf(at)<0)continue;const wt=_[at];if(!wt)continue;let At={};void 0!==ot&&E&&(At=E.getState(wt.sourceLayer||"_geojsonTileLayer",ot));const It=ze({},w[at]);It.paint=Fg(It.paint,wt.paint,Oe,At,f),It.layout=Fg(It.layout,wt.layout,Oe,At,f);const un=!D||D(Oe,wt,At,K);if(!un)continue;const rn=new Mg(Oe,this.z,this.x,this.y,ot);rn.layer=It;let En=e[at];void 0===En&&(En=e[at]=[]),En.push({featureIndex:k,feature:rn,intersectionZ:un})}}lookupSymbolFeatures(e,i,a,u,f,_,w,E){const D={};this.loadVTLayers();const k=dc(f);for(const z of e)this.loadMatchingFeature(D,{bucketIndex:a,sourceLayerIndex:u,featureIndex:z,layoutVertexArrayOffset:0},k,_,w,E,i);return D}loadFeature(e){const{featureIndex:i,sourceLayerIndex:a}=e;this.loadVTLayers();const u=this.sourceLayerCoder.decode(a),f=this.vtFeatures[u];if(f[i])return f[i];const _=this.vtLayers[u].feature(i);return f[i]=_,_}hasLayer(e){for(const i of this.bucketLayerIDs)for(const a of i)if(e===a)return!0;return!1}getId(e,i){let a=e.id;if(this.promoteId){const u="string"==typeof this.promoteId?this.promoteId:this.promoteId[i];null!=u&&(a=e.properties[u]),"boolean"==typeof a&&(a=Number(a))}return a}}function Fg(t,e,i,a,u){return Xt(t,(f,_)=>{const w=e instanceof nt?e.get(_):null;return w&&w.evaluate?w.evaluate(i,a,u):w})}function py(t,e){return e-t}ui(kg,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});class Bg{constructor(e,i){this.width=e,this.height=i,this.nextRow=0,this.image=new Kl({width:e,height:i}),this.positions={},this.uploaded=!1}getDash(e,i){const a=this.getKey(e,i);return this.positions[a]}trim(){const e=this.width,i=this.height=Be(this.nextRow);this.image.resize({width:e,height:i})}getKey(e,i){return e.join(",")+i}getDashRanges(e,i,a){const u=[];let f=e.length%2==1?-e[e.length-1]*a:0,_=e[0]*a,w=!0;u.push({left:f,right:_,isDash:w,zeroLength:0===e[0]});let E=e[0];for(let D=1;D<e.length;D++){w=!w;const k=e[D];f=E*a,E+=k,_=E*a,u.push({left:f,right:_,isDash:w,zeroLength:0===k})}return u}addRoundDash(e,i,a){const u=i/2;for(let f=-a;f<=a;f++){const _=this.width*(this.nextRow+a+f);let w=0,E=e[w];for(let D=0;D<this.width;D++){D/E.right>1&&(E=e[++w]);const k=Math.abs(D-E.left),z=Math.abs(D-E.right),j=Math.min(k,z);let K;const te=f/a*(u+1);if(E.isDash){const he=u-Math.abs(te);K=Math.sqrt(j*j+he*he)}else K=u-Math.sqrt(j*j+te*te);this.image.data[_+D]=Math.max(0,Math.min(255,K+128))}}}addRegularDash(e,i){for(let E=e.length-1;E>=0;--E){const D=e[E],k=e[E+1];D.zeroLength?e.splice(E,1):k&&k.isDash===D.isDash&&(k.left=D.left,e.splice(E,1))}const a=e[0],u=e[e.length-1];a.isDash===u.isDash&&(a.left=u.left-this.width,u.right=a.right+this.width);const f=this.width*this.nextRow;let _=0,w=e[_];for(let E=0;E<this.width;E++){E/w.right>1&&(w=e[++_]);const D=Math.abs(E-w.left),k=Math.abs(E-w.right),z=Math.min(D,k);this.image.data[f+E]=Math.max(0,Math.min(255,(w.isDash?z:-z)+i+128))}}addDash(e,i){const a=this.getKey(e,i);if(this.positions[a])return this.positions[a];const u="round"===i,f=u?7:0,_=2*f+1;if(this.nextRow+_>this.height)return St("LineAtlas out of space"),null;0===e.length&&e.push(1);let w=0;for(let k=0;k<e.length;k++)e[k]<0&&(St("Negative value is found in line dasharray, replacing values with 0"),e[k]=0),w+=e[k];if(0!==w){const k=this.width/w,z=this.getDashRanges(e,this.width,k);u?this.addRoundDash(z,k,f):this.addRegularDash(z,"square"===i?.5*k:0)}const E=this.nextRow+f;this.nextRow+=_;const D={tl:[E,f],br:[w,0]};return this.positions[a]=D,D}}ui(Bg,"LineAtlas");const Ng=1*cl;class zg{constructor(e){const i={},a=[];for(const w in e){const E=e[w],D=i[w]={};for(const k in E.glyphs){const z=E.glyphs[+k];if(!z||0===z.bitmap.width||0===z.bitmap.height)continue;const j=z.metrics.localGlyph?Ng:1,K={x:0,y:0,w:z.bitmap.width+2*j,h:z.bitmap.height+2*j};a.push(K),D[k]=K}}const{w:u,h:f}=ug(a),_=new Kl({width:u||1,height:f||1});for(const w in e){const E=e[w];for(const D in E.glyphs){const k=E.glyphs[+D];if(!k||0===k.bitmap.width||0===k.bitmap.height)continue;const z=i[w][D],j=k.metrics.localGlyph?Ng:1;Kl.copy(k.bitmap,_,{x:0,y:0},{x:z.x+j,y:z.y+j},k.bitmap)}}this.image=_,this.positions=i}}ui(zg,"GlyphAtlas");class Ug{constructor(e){this.tileID=new Is(e.tileID.overscaledZ,e.tileID.wrap,e.tileID.canonical.z,e.tileID.canonical.x,e.tileID.canonical.y),this.tileZoom=e.tileZoom,this.uid=e.uid,this.zoom=e.zoom,this.canonical=e.tileID.canonical,this.pixelRatio=e.pixelRatio,this.tileSize=e.tileSize,this.source=e.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=e.showCollisionBoxes,this.collectResourceTiming=!!e.collectResourceTiming,this.returnDependencies=!!e.returnDependencies,this.promoteId=e.promoteId,this.enableTerrain=!!e.enableTerrain,this.isSymbolTile=e.isSymbolTile,this.tileTransform=uu(e.tileID.canonical,e.projection),this.projection=e.projection}parse(e,i,a,u,f){this.status="parsing",this.data=e,this.collisionBoxArray=new ar;const _=new vp(Object.keys(e.layers).sort()),w=new kg(this.tileID,this.promoteId);w.bucketLayerIDs=[];const E={},D=new Bg(256,256),k={featureIndex:w,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:D,availableImages:a},z=i.familiesBySource[this.source];for(const At in z){const It=e.layers[At];if(!It)continue;let un=!1,rn=!1;for(const fn of z[At])"symbol"===fn[0].type?un=!0:rn=!0;if(!0===this.isSymbolTile&&!un||!1===this.isSymbolTile&&!rn)continue;1===It.version&&St(`Vector tile source "${this.source}" layer "${At}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const En=_.encode(At),$n=[];for(let fn=0;fn<It.length;fn++){const kn=It.feature(fn),Fn=w.getId(kn,At);$n.push({feature:kn,id:Fn,index:fn,sourceLayerIndex:En})}for(const fn of z[At]){const kn=fn[0];void 0!==this.isSymbolTile&&"symbol"===kn.type!==this.isSymbolTile||kn.minzoom&&this.zoom<Math.floor(kn.minzoom)||kn.maxzoom&&this.zoom>=kn.maxzoom||"none"!==kn.visibility&&(Tp(fn,this.zoom,a),(E[kn.id]=kn.createBucket({index:w.bucketLayerIDs.length,layers:fn,zoom:this.zoom,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:En,sourceID:this.source,enableTerrain:this.enableTerrain,projection:this.projection.spec,availableImages:a})).populate($n,k,this.tileID.canonical,this.tileTransform),w.bucketLayerIDs.push(fn.map(Fn=>Fn.id)))}}let j,K,te,he;D.trim();const Oe={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},ot=()=>{if(j)return f(j);if(K&&te&&he){const At=new zg(K),It=new eh(te,he);for(const un in E){const rn=E[un];rn instanceof Mc?(Tp(rn.layers,this.zoom,a),ih(rn,K,At.positions,te,It.iconPositions,this.showCollisionBoxes,a,this.tileID.canonical,this.tileZoom,this.projection)):rn.hasPattern&&(rn instanceof qh||rn instanceof Uh||rn instanceof wc)&&(Tp(rn.layers,this.zoom,a),rn.addFeatures(k,this.tileID.canonical,It.patternPositions,a,this.tileTransform))}this.status="done",f(null,{buckets:lt(E).filter(un=>!un.isEmpty()),featureIndex:w,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:At.image,lineAtlas:D,imageAtlas:It,glyphMap:this.returnDependencies?K:null,iconMap:this.returnDependencies?te:null,glyphPositions:this.returnDependencies?At.positions:null})}},Ct=Xt(k.glyphDependencies,At=>Object.keys(At).map(Number));Object.keys(Ct).length?u.send("getGlyphs",{uid:this.uid,stacks:Ct},(At,It)=>{j||(j=At,K=It,ot())},void 0,!1,Oe):K={};const at=Object.keys(k.iconDependencies);at.length?u.send("getImages",{icons:at,source:this.source,tileID:this.tileID,type:"icons"},(At,It)=>{j||(j=At,te=It,ot())},void 0,!1,Oe):te={};const wt=Object.keys(k.patternDependencies);wt.length?u.send("getImages",{icons:wt,source:this.source,tileID:this.tileID,type:"patterns"},(At,It)=>{j||(j=At,he=It,ot())},void 0,!1,Oe):he={},ot()}}function Tp(t,e,i){const a=new N(e);for(const u of t)u.recalculate(a,i)}class Zg{constructor(e){this.entries={},this.scheduler=e}request(e,i,a,u){const f=this.entries[e]=this.entries[e]||{callbacks:[]};if(f.result){const[_,w]=f.result;return this.scheduler?this.scheduler.add(()=>{u(_,w)},i):u(_,w),()=>{}}return f.callbacks.push(u),f.cancel||(f.cancel=a((_,w)=>{f.result=[_,w];for(const E of f.callbacks)this.scheduler?this.scheduler.add(()=>{E(_,w)},i):E(_,w);setTimeout(()=>delete this.entries[e],3e3)})),()=>{f.result||(f.callbacks=f.callbacks.filter(_=>_!==u),f.callbacks.length||(f.cancel(),delete this.entries[e]))}}}function fy(t,e,i){const a=JSON.stringify(t.request);return t.data&&(this.deduped.entries[a]={result:[null,t.data]}),this.deduped.request(a,{type:"parseTile",isSymbolTile:t.isSymbolTile,zoom:t.tileZoom},u=>{const f=ri(t.request,(_,w,E,D)=>{_?u(_):w&&u(null,{vectorTile:i?void 0:new $d(new ip(w)),rawData:w,cacheControl:E,expires:D})});return()=>{f.cancel(),u()}},e)}const am=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Ep{static from(e){if(!(e instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[i,a]=new Uint8Array(e,0,2);if(219!==i)throw new Error("Data does not appear to be in a KDBush format.");const u=a>>4;if(1!==u)throw new Error(`Got v${u} data when expected v1.`);const f=am[15&a];if(!f)throw new Error("Unrecognized array type.");const[_]=new Uint16Array(e,2,1),[w]=new Uint32Array(e,4,1);return new Ep(w,_,f,e)}constructor(e,i=64,a=Float64Array,u){if(isNaN(e)||e<0)throw new Error(`Unpexpected numItems value: ${e}.`);this.numItems=+e,this.nodeSize=Math.min(Math.max(+i,2),65535),this.ArrayType=a,this.IndexArrayType=e<65536?Uint16Array:Uint32Array;const f=am.indexOf(this.ArrayType),_=2*e*this.ArrayType.BYTES_PER_ELEMENT,w=e*this.IndexArrayType.BYTES_PER_ELEMENT,E=(8-w%8)%8;if(f<0)throw new Error(`Unexpected typed array class: ${a}.`);u&&u instanceof ArrayBuffer?(this.data=u,this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+w+E,2*e),this._pos=2*e,this._finished=!0):(this.data=new ArrayBuffer(8+_+w+E),this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+w+E,2*e),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+f]),new Uint16Array(this.data,2,1)[0]=i,new Uint32Array(this.data,4,1)[0]=e)}add(e,i){const a=this._pos>>1;return this.ids[a]=a,this.coords[this._pos++]=e,this.coords[this._pos++]=i,a}finish(){const e=this._pos>>1;if(e!==this.numItems)throw new Error(`Added ${e} items when expected ${this.numItems}.`);return Vg(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(e,i,a,u){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:f,coords:_,nodeSize:w}=this,E=[0,f.length-1,0],D=[];for(;E.length;){const k=E.pop()||0,z=E.pop()||0,j=E.pop()||0;if(z-j<=w){for(let Oe=j;Oe<=z;Oe++){const ot=_[2*Oe],Ct=_[2*Oe+1];ot>=e&&ot<=a&&Ct>=i&&Ct<=u&&D.push(f[Oe])}continue}const K=j+z>>1,te=_[2*K],he=_[2*K+1];te>=e&&te<=a&&he>=i&&he<=u&&D.push(f[K]),(0===k?e<=te:i<=he)&&(E.push(j),E.push(K-1),E.push(1-k)),(0===k?a>=te:u>=he)&&(E.push(K+1),E.push(z),E.push(1-k))}return D}within(e,i,a){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:u,coords:f,nodeSize:_}=this,w=[0,u.length-1,0],E=[],D=a*a;for(;w.length;){const k=w.pop()||0,z=w.pop()||0,j=w.pop()||0;if(z-j<=_){for(let Oe=j;Oe<=z;Oe++)Dp(f[2*Oe],f[2*Oe+1],e,i)<=D&&E.push(u[Oe]);continue}const K=j+z>>1,te=f[2*K],he=f[2*K+1];Dp(te,he,e,i)<=D&&E.push(u[K]),(0===k?e-a<=te:i-a<=he)&&(w.push(j),w.push(K-1),w.push(1-k)),(0===k?e+a>=te:i+a>=he)&&(w.push(K+1),w.push(z),w.push(1-k))}return E}}function Vg(t,e,i,a,u,f){if(u-a<=i)return;const _=a+u>>1;uh(t,e,_,a,u,f),Vg(t,e,i,a,_-1,1-f),Vg(t,e,i,_+1,u,1-f)}function uh(t,e,i,a,u,f){for(;u>a;){if(u-a>600){const D=u-a+1,k=i-a+1,z=Math.log(D),j=.5*Math.exp(2*z/3),K=.5*Math.sqrt(z*j*(D-j)/D)*(k-D/2<0?-1:1);uh(t,e,i,Math.max(a,Math.floor(i-k*j/D+K)),Math.min(u,Math.floor(i+(D-k)*j/D+K)),f)}const _=e[2*i+f];let w=a,E=u;for(dh(t,e,a,i),e[2*u+f]>_&&dh(t,e,a,u);w<E;){for(dh(t,e,w,E),w++,E--;e[2*w+f]<_;)w++;for(;e[2*E+f]>_;)E--}e[2*a+f]===_?dh(t,e,a,E):(E++,dh(t,e,E,u)),E<=i&&(a=E+1),i<=E&&(u=E-1)}}function dh(t,e,i,a){lm(t,i,a),lm(e,2*i,2*a),lm(e,2*i+1,2*a+1)}function lm(t,e,i){const a=t[e];t[e]=t[i],t[i]=a}function Dp(t,e,i,a){const u=t-i,f=e-a;return u*u+f*f}s.ARRAY_TYPE=va,s.AUTH_ERR_MSG=vt,s.Aabb=zs,s.Actor=class{constructor(t,e,i){this.target=t,this.parent=e,this.mapId=i,this.callbacks={},this.cancelCallbacks={},Wt(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.globalScope=dn()?t:Q,this.scheduler=new cy}send(t,e,i,a,u=!1,f){const _=Math.round(1e18*Math.random()).toString(36).substring(0,10);i&&(i.metadata=f,this.callbacks[_]=i);const w=gi(this.globalScope)?void 0:[];return this.target.postMessage({id:_,type:t,hasCallback:!!i,targetMapId:a,mustQueue:u,sourceMapId:this.mapId,data:Hl(e,w)},w),{cancel:()=>{i&&delete this.callbacks[_],this.target.postMessage({id:_,type:"<cancel>",targetMapId:a,sourceMapId:this.mapId})}}}receive(t){const e=t.data,i=e.id;if(i&&(!e.targetMapId||this.mapId===e.targetMapId))if("<cancel>"===e.type){const a=this.cancelCallbacks[i];delete this.cancelCallbacks[i],a&&a.cancel()}else if(e.mustQueue||dn()){const a=this.callbacks[i];this.cancelCallbacks[i]=this.scheduler.add(()=>this.processTask(i,e),a&&a.metadata||{type:"message"})}else this.processTask(i,e)}processTask(t,e){if("<response>"===e.type){const i=this.callbacks[t];delete this.callbacks[t],i&&(e.error?i(vl(e.error)):i(null,vl(e.data)))}else{const i=gi(this.globalScope)?void 0:[],a=e.hasCallback?(f,_)=>{delete this.cancelCallbacks[t],this.target.postMessage({id:t,type:"<response>",sourceMapId:this.mapId,error:f?Hl(f):null,data:Hl(_,i)},i)}:f=>{},u=vl(e.data);if(this.parent[e.type])this.parent[e.type](e.sourceMapId,u,a);else if(this.parent.getWorkerSource){const f=e.type.split(".");this.parent.getWorkerSource(e.sourceMapId,f[0],u.source)[f[1]](u,a)}else a(new Error(`Could not find function ${e.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}},s.CanonicalTileID=Hh,s.Color=Co,s.ColorMode=Pl,s.CullFaceMode=dl,s.DEMData=bp,s.DataConstantProperty=ue,s.DedupedRequest=Zg,s.DepthMode=ad,s.EXTENT=Pi,s.Elevation=class{isDataAvailableAtPoint(t){const e=this._source();if(this.isUsingMockSource()||!e||t.y<0||t.y>1)return!1;const i=e.getSource().maxzoom,a=1<<i,u=Math.floor(t.x),f=Math.floor((t.x-u)*a),_=Math.floor(t.y*a),w=this.findDEMTileFor(new Is(i,u,i,f,_));return!(!w||!w.dem)}getAtPointOrZero(t,e=0){return this.getAtPoint(t,e)||0}getAtPoint(t,e,i=!0){if(this.isUsingMockSource())return null;null==e&&(e=null);const a=this._source();if(!a||t.y<0||t.y>1)return e;const u=a.getSource().maxzoom,f=1<<u,_=Math.floor(t.x),w=t.x-_,E=new Is(u,_,u,Math.floor(w*f),Math.floor(t.y*f)),D=this.findDEMTileFor(E);if(!D||!D.dem)return e;const k=D.dem,z=1<<D.tileID.canonical.z,j=(w*z-D.tileID.canonical.x)*k.dim,K=(t.y*z-D.tileID.canonical.y)*k.dim,te=Math.floor(j),he=Math.floor(K);return(i?this.exaggeration():1)*Kn(Kn(k.get(te,he),k.get(te,he+1),K-he),Kn(k.get(te+1,he),k.get(te+1,he+1),K-he),j-te)}getAtTileOffset(t,e,i){const a=1<<t.canonical.z;return this.getAtPointOrZero(new Au(t.wrap+(t.canonical.x+e/Pi)/a,(t.canonical.y+i/Pi)/a))}getAtTileOffsetFunc(t,e,i,a){return u=>{const f=this.getAtTileOffset(t,u.x,u.y),_=a.upVector(t.canonical,u.x,u.y);return Ua(_,_,f*a.upVectorScale(t.canonical,e,i).metersToTile),_}}getForTilePoints(t,e,i,a){if(this.isUsingMockSource())return!1;const u=Cp.create(this,t,a);return!!u&&(e.forEach(f=>{f[2]=this.exaggeration()*u.getElevationAt(f[0],f[1],i)}),!0)}getMinMaxForTile(t){if(this.isUsingMockSource())return null;const e=this.findDEMTileFor(t);if(!e||!e.dem)return null;const i=e.dem.tree,a=e.tileID,u=1<<t.canonical.z-a.canonical.z;let f=t.canonical.x/u-a.canonical.x,_=t.canonical.y/u-a.canonical.y,w=0;for(let E=0;E<t.canonical.z-a.canonical.z&&!i.leaves[w];E++){f*=2,_*=2;const D=2*Math.floor(_)+Math.floor(f);w=i.childOffsets[w]+D,f%=1,_%=1}return{min:this.exaggeration()*i.minimums[w],max:this.exaggeration()*i.maximums[w]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(t,e,i){throw new Error("Pure virtual method called.")}pointCoordinate(t){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(t){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}},s.ErrorEvent=Ai,s.EvaluationParameters=N,s.Event=oo,s.Evented=ho,s.FillExtrusionBucket=wc,s.Frustum=Md,s.FrustumCorners=Ks,s.GLOBE_RADIUS=ba,s.GLOBE_SCALE_MATCH_LATITUDE=45,s.GLOBE_ZOOM_THRESHOLD_MAX=Us,s.GLOBE_ZOOM_THRESHOLD_MIN=Id,s.GlobeSharedBuffers=class{constructor(t){this._createGrid(t),this._createPoles(t)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const t of this._poleSegments)t.destroy();for(const t of this._gridSegments)t.withSkirts.destroy(),t.withoutSkirts.destroy();if(this._wireframeIndexBuffer){this._wireframeIndexBuffer.destroy();for(const t of this._wireframeSegments)t.destroy()}}_fillGridMeshWithLods(t,e){const i=new Gn,a=new bi,u=[],f=t+1+2,_=e[0]+1,w=e[0]+1+(1+e.length),E=(D,k,z)=>{let j=D===f-1?D-2:0===D?D:D-1;return j+=z?24575:0,[j,k]};for(let D=0;D<f;++D)i.emplaceBack(...E(D,0,!0));for(let D=0;D<_;++D)for(let k=0;k<f;++k)i.emplaceBack(...E(k,D,(0===k||k===f-1)&&!0));for(let D=0;D<e.length;++D){const k=e[D];for(let z=0;z<f;++z)i.emplaceBack(...E(z,k,!0))}for(let D=0;D<e.length;++D){const k=a.length,z=e[D]+1+2,j=new bi;for(let he=0;he<z-1;he++){const Oe=he===z-2,ot=Oe?f*(w-e.length+D-he):f;for(let Ct=0;Ct<f-1;Ct++){const at=he*f+Ct;0===he||Oe||0===Ct||Ct===f-2?(j.emplaceBack(at+1,at,at+ot),j.emplaceBack(at+ot,at+ot+1,at+1)):(a.emplaceBack(at+1,at,at+ot),a.emplaceBack(at+ot,at+ot+1,at+1))}}const K=Tr.simpleSegment(0,k,i.length,a.length-k);for(let he=0;he<j.uint16.length;he+=3)a.emplaceBack(j.uint16[he],j.uint16[he+1],j.uint16[he+2]);const te=Tr.simpleSegment(0,k,i.length,a.length-k);u.push({withoutSkirts:K,withSkirts:te})}return{vertices:i,indices:a,segments:u}}_createGrid(t){const e=this._fillGridMeshWithLods(64,Ad);this._gridSegments=e.segments,this._gridBuffer=t.createVertexBuffer(e.vertices,Dd.members),this._gridIndexBuffer=t.createIndexBuffer(e.indices,!0)}_createPoles(t){const e=new bi;for(let u=0;u<=64;u++)e.emplaceBack(0,u+1,u+2);this._poleIndexBuffer=t.createIndexBuffer(e,!0);const i=new zo,a=new zo;this._poleSegments=[];for(let u=0,f=0;u<Id;u++){const _=360/(1<<u);i.emplaceBack(0,-ba,0,.5,0),a.emplaceBack(0,-ba,0,.5,1);for(let w=0;w<=64;w++){const E=w/64,D=Kn(0,_,E),[k,z,j]=Qc(b_,Lm,D,ba);i.emplaceBack(k,z,j,E,0),a.emplaceBack(k,z,j,E,1)}this._poleSegments.push(Tr.simpleSegment(f,0,66,64)),f+=66}this._poleNorthVertexBuffer=t.createVertexBuffer(i,Mm,!1),this._poleSouthVertexBuffer=t.createVertexBuffer(a,Mm,!1)}getGridBuffers(t,e){return[this._gridBuffer,this._gridIndexBuffer,e?this._gridSegments[t].withSkirts:this._gridSegments[t].withoutSkirts]}getPoleBuffers(t){return[this._poleNorthVertexBuffer,this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[t]]}getWirefameBuffers(t,e){if(!this._wireframeSegments){const i=new Yr,a=64,u=a+1+2,f=1;this._wireframeSegments=[];for(let _=0,w=0;_<Ad.length;_++){const E=Ad[_];for(let k=f;k<E+f;k++)for(let z=f;z<a+f;z++){const j=k*u+z;i.emplaceBack(j,j+1),i.emplaceBack(j,j+u),i.emplaceBack(j,j+u+1)}const D=E*a*3;this._wireframeSegments.push(Tr.simpleSegment(0,w,(E+1)*u,D)),w+=D}this._wireframeIndexBuffer=t.createIndexBuffer(i)}return[this._gridBuffer,this._wireframeIndexBuffer,this._wireframeSegments[e]]}},s.GlyphManager=Ju,s.ImagePosition=Tc,s.KDBush=Ep,s.LivePerformanceUtils=Et,s.LngLat=tr,s.LngLatBounds=Jc,s.LocalGlyphMode=sp,s.MAX_MERCATOR_LATITUDE=Vs,s.MercatorCoordinate=Au,s.ONE_EM=As,s.OverscaledTileID=Is,s.PerformanceMarkers=bt,s.Point=Me,s.Properties=ht,s.RGBAImage=Ca,s.Ray=Qp,s.RequestManager=class{constructor(t,e,i){this._transformRequestFn=t,this._customAccessToken=e,this._silenceAuthErrors=!!i,this._createSkuToken()}_createSkuToken(){const t=function(){let e="";for(let i=0;i<10;i++)e+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",_e,e].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=t.token,this._skuTokenExpiresAt=t.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(t,e){return this._transformRequestFn&&this._transformRequestFn(t,e)||{url:t}}normalizeStyleURL(t,e){if(!Lt(t))return t;const i=et(t);return i.path=`/styles/v1${i.path}`,this._makeAPIURL(i,this._customAccessToken||e)}normalizeGlyphsURL(t,e){if(!Lt(t))return t;const i=et(t);return i.path=`/fonts/v1${i.path}`,this._makeAPIURL(i,this._customAccessToken||e)}normalizeSourceURL(t,e,i,a){if(!Lt(t))return t;const u=et(t);return u.path=`/v4/${u.authority}.json`,u.params.push("secure"),i&&u.params.push(`language=${i}`),a&&u.params.push(`worldview=${a}`),this._makeAPIURL(u,this._customAccessToken||e)}normalizeSpriteURL(t,e,i,a){const u=et(t);return Lt(t)?(u.path=`/styles/v1${u.path}/sprite${e}${i}`,this._makeAPIURL(u,this._customAccessToken||a)):(u.path+=`${e}${i}`,Ue(u))}normalizeTileURL(t,e,i){if(this._isSkuTokenExpired()&&this._createSkuToken(),t&&!Lt(t))return t;const a=et(t);a.path=a.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${e||i&&"raster"!==a.authority&&512===i?"@2x":""}${fe.supported?".webp":"$1"}`),"raster"===a.authority?a.path=`/${y.RASTER_URL_PREFIX}${a.path}`:(a.path=a.path.replace(/^.+\/v4\//,"/"),a.path=`/${y.TILE_URL_VERSION}${a.path}`);const u=this._customAccessToken||function(f){for(const _ of f){const w=_.match(/^access_token=(.*)$/);if(w)return w[1]}return null}(a.params)||y.ACCESS_TOKEN;return y.REQUIRE_ACCESS_TOKEN&&u&&this._skuToken&&a.params.push(`sku=${this._skuToken}`),this._makeAPIURL(a,u)}canonicalizeTileURL(t,e){const i=et(t);if(!i.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!i.path.match(/\.[\w]+$/))return t;let a="mapbox://";i.path.match(/^\/raster\/v1\//)?a+=`raster/${i.path.replace(`/${y.RASTER_URL_PREFIX}/`,"")}`:a+=`tiles/${i.path.replace(`/${y.TILE_URL_VERSION}/`,"")}`;let u=i.params;return e&&(u=u.filter(f=>!f.match(/^access_token=/))),u.length&&(a+=`?${u.join("&")}`),a}canonicalizeTileset(t,e){const i=!!e&&Lt(e),a=[];for(const u of t.tiles||[])Zt(u)?a.push(this.canonicalizeTileURL(u,i)):a.push(u);return a}_makeAPIURL(t,e){const i="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",a=et(y.API_URL);if(t.protocol=a.protocol,t.authority=a.authority,"http"===t.protocol){const u=t.params.indexOf("secure");u>=0&&t.params.splice(u,1)}if("/"!==a.path&&(t.path=`${a.path}${t.path}`),!y.REQUIRE_ACCESS_TOKEN)return Ue(t);if(e=e||y.ACCESS_TOKEN,!this._silenceAuthErrors){if(!e)throw new Error(`An API access token is required to use Mapbox GL. ${i}`);if("s"===e[0])throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${i}`)}return t.params=t.params.filter(u=>-1===u.indexOf("access_token")),t.params.push(`access_token=${e||""}`),Ue(t)}},s.ResourceType=ct,s.SegmentVector=Tr,s.SourceCache=Ac,s.StencilMode=om,s.StructArrayLayout1ui2=_s,s.StructArrayLayout2f1f2i16=Oi,s.StructArrayLayout2i4=Gn,s.StructArrayLayout2ui4=Yr,s.StructArrayLayout3f12=mo,s.StructArrayLayout3ui6=bi,s.StructArrayLayout4i8=An,s.StructArrayLayout5f20=zo,s.Texture=La,s.Tile=xp,s.Transitionable=ce,s.Uniform1f=Wl,s.Uniform1i=class extends el{constructor(t){super(t),this.current=0}set(t,e,i){this.fetchUniformLocation(t,e)&&this.current!==i&&(this.current=i,this.gl.uniform1i(this.location,i))}},s.Uniform2f=class extends el{constructor(t){super(t),this.current=[0,0]}set(t,e,i){this.fetchUniformLocation(t,e)&&(i[0]===this.current[0]&&i[1]===this.current[1]||(this.current=i,this.gl.uniform2f(this.location,i[0],i[1])))}},s.Uniform3f=class extends el{constructor(t){super(t),this.current=[0,0,0]}set(t,e,i){this.fetchUniformLocation(t,e)&&(i[0]===this.current[0]&&i[1]===this.current[1]&&i[2]===this.current[2]||(this.current=i,this.gl.uniform3f(this.location,i[0],i[1],i[2])))}},s.Uniform4f=a_,s.UniformColor=Vp,s.UniformMatrix2f=class extends el{constructor(t){super(t),this.current=u_}set(t,e,i){if(this.fetchUniformLocation(t,e))for(let a=0;a<4;a++)if(i[a]!==this.current[a]){this.current=i,this.gl.uniformMatrix2fv(this.location,!1,i);break}}},s.UniformMatrix3f=class extends el{constructor(t){super(t),this.current=c_}set(t,e,i){if(this.fetchUniformLocation(t,e))for(let a=0;a<9;a++)if(i[a]!==this.current[a]){this.current=i,this.gl.uniformMatrix3fv(this.location,!1,i);break}}},s.UniformMatrix4f=class extends el{constructor(t){super(t),this.current=l_}set(t,e,i){if(this.fetchUniformLocation(t,e)){if(i[12]!==this.current[12]||i[0]!==this.current[0])return this.current=i,void this.gl.uniformMatrix4fv(this.location,!1,i);for(let a=1;a<16;a++)if(i[a]!==this.current[a]){this.current=i,this.gl.uniformMatrix4fv(this.location,!1,i);break}}}},s.UnwrappedTileID=og,s.ValidationError=ci,s.VectorTileFeature=Zh,s.VectorTileWorkerSource=class extends ho{constructor(t,e,i,a,u){super(),this.actor=t,this.layerIndex=e,this.availableImages=i,this.loadVectorData=u||fy,this.loading={},this.loaded={},this.deduped=new Zg(t.scheduler),this.isSpriteLoaded=a,this.scheduler=t.scheduler}loadTile(t,e){const i=t.uid,a=t&&t.request,u=a&&a.collectResourceTiming,f=this.loading[i]=new Ug(t);f.abort=this.loadVectorData(t,(_,w)=>{const E=!this.loading[i];if(delete this.loading[i],E||_||!w)return f.status="done",E||(this.loaded[i]=f),e(_);const D=w.rawData,k={};w.expires&&(k.expires=w.expires),w.cacheControl&&(k.cacheControl=w.cacheControl),f.vectorTile=w.vectorTile||new $d(new ip(D));const z=()=>{f.parse(f.vectorTile,this.layerIndex,this.availableImages,this.actor,(j,K)=>{if(j||!K)return e(j);const te={};if(u){const he=oi(a);he.length>0&&(te.resourceTiming=JSON.parse(JSON.stringify(he)))}e(null,ze({rawTileData:D.slice(0)},K,k,te))})};this.isSpriteLoaded?z():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(z,{type:"parseTile",isSymbolTile:t.isSymbolTile,zoom:t.tileZoom}):z()}),this.loaded=this.loaded||{},this.loaded[i]=f})}reloadTile(t,e){const i=this.loaded,a=t.uid,u=this;if(i&&i[a]){const f=i[a];f.showCollisionBoxes=t.showCollisionBoxes,f.enableTerrain=!!t.enableTerrain,f.projection=t.projection,f.tileTransform=uu(t.tileID.canonical,t.projection);const _=(w,E)=>{const D=f.reloadCallback;D&&(delete f.reloadCallback,f.parse(f.vectorTile,u.layerIndex,this.availableImages,u.actor,D)),e(w,E)};"parsing"===f.status?f.reloadCallback=_:"done"===f.status&&(f.vectorTile?f.parse(f.vectorTile,this.layerIndex,this.availableImages,this.actor,_):_())}}abortTile(t,e){const i=t.uid,a=this.loading[i];a&&(a.abort&&a.abort(),delete this.loading[i]),e()}removeTile(t,e){const i=this.loaded,a=t.uid;i&&i[a]&&delete i[a],e()}},s.WritingMode=Ta,s.ZoomDependentExpression=os,s.add=rl,s.addDynamicAttributes=Ra,s.adjoint=function(t,e){var i=e[0],a=e[1],u=e[2],f=e[3],_=e[4],w=e[5],E=e[6],D=e[7],k=e[8];return t[0]=_*k-w*D,t[1]=u*D-a*k,t[2]=a*w-u*_,t[3]=w*E-f*k,t[4]=i*k-u*E,t[5]=u*f-i*w,t[6]=f*D-_*E,t[7]=a*E-i*D,t[8]=i*_-a*f,t},s.asyncAll=mt,s.bezier=Ze,s.bindAll=Wt,s.boundsAttributes=dy,s.bufferConvexPolygon=function(t,e){const i=[];for(let a=0;a<t.length;a++){const u=dt(a-1,-1,t.length-1),f=dt(a+1,-1,t.length-1),_=t[a],w=t[f],E=t[u].sub(_).unit(),D=w.sub(_).unit(),k=D.angleWithSep(E.x,E.y),z=E.add(D).unit().mult(-1*e/Math.sin(k/2));i.push(_.add(z))}return i},s.cacheEntryPossiblyAdded=function(t){ge++,ge>Fi&&(t.getActor().send("enforceCacheSizeLimit",Hi),ge=0)},s.calculateGlobeLabelMatrix=function(t,e){const{x:i,y:a}=t.point,u=Pm(i,a,t.worldSize/t._pixelsPerMercatorPixel,0,0);return wl(u,u,Mu(ja(e)))},s.calculateGlobeMatrix=function(t){const{x:e,y:i}=t.point,{lng:a,lat:u}=t._center;return Pm(e,i,t.worldSize,a,u)},s.calculateGlobeMercatorMatrix=function(t){const e=t.pixelsPerMeter,i=e/Zs(1,t.center.lat),a=ol(new Float64Array(16));return Eu(a,a,[t.point.x,t.point.y,0]),Kc(a,a,[i,i,e]),Float32Array.from(a)},s.circumferenceAtLatitude=af,s.clamp=ve,s.clearTileCache=function(t){if(!xn())return;const e=Q.caches.delete(Ji);t&&e.catch(t).then(()=>t())},s.clipLine=_o,s.clone=function(t){var e=new va(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},s.clone$1=an,s.collisionCircleLayout=Qh,s.config=y,s.conjugate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t},s.create=function(){var t=new va(16);return va!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t},s.create$1=p_,s.createExpression=Vr,s.createLayout=$t,s.createStyleLayer=function(t){return"custom"===t.type?new Eg(t):new Qf[t.type](t)},s.cross=Th,s.degToRad=Te,s.distance=function(t,e){return Math.hypot(e[0]-t[0],e[1]-t[1],e[2]-t[2])},s.div=function(t,e,i){return t[0]=e[0]/i[0],t[1]=e[1]/i[1],t[2]=e[2]/i[2],t},s.dot=xa,s.earthRadius=iu,s.ease=Ae,s.easeCubicInOut=we,s.ecefToLatLng=function([t,e,i]){const a=Math.hypot(t,e,i),u=Math.atan2(t,i),f=.5*Math.PI-Math.acos(-e/a);return new tr(ae(u),ae(f))},s.emitValidationErrors=qc,s.endsWith=wn,s.enforceCacheSizeLimit=function(t){Qt(),ii&&ii.then(e=>{e.keys().then(i=>{for(let a=0;a<i.length-t;a++)e.delete(i[a])})})},s.evaluateSizeForFeature=Jd,s.evaluateSizeForZoom=Vu,s.evaluateVariableOffset=up,s.evented=b,s.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},s.exactEquals$1=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]},s.exported=So,s.exported$1=fe,s.extend=ze,s.extend$1=Qo,s.fillExtrusionHeightLift=eg,s.filterObject=mn,s.fromMat4=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t},s.fromQuat=function(t,e){var i=e[0],a=e[1],u=e[2],f=e[3],_=i+i,w=a+a,E=u+u,D=i*_,k=a*_,z=a*w,j=u*_,K=u*w,te=u*E,he=f*_,Oe=f*w,ot=f*E;return t[0]=1-z-te,t[1]=k+ot,t[2]=j-Oe,t[3]=0,t[4]=k-ot,t[5]=1-D-te,t[6]=K+he,t[7]=0,t[8]=j+Oe,t[9]=K-he,t[10]=1-D-z,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},s.fromRotation=function(t,e){var i=Math.sin(e),a=Math.cos(e);return t[0]=a,t[1]=i,t[2]=0,t[3]=-i,t[4]=a,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},s.fromScaling=qp,s.furthestTileCorner=function(t){const e=Math.round((t+45+360)%360/90)%4;return yt[e]},s.getAABBPointSquareDist=function(t,e,i){let a=0;for(let u=0;u<2;++u){const f=i?i[u]:0;t[u]>f&&(a+=(t[u]-f)*(t[u]-f)),e[u]<f&&(a+=(f-e[u])*(f-e[u]))}return a},s.getAnchorAlignment=hg,s.getAnchorJustification=dp,s.getBounds=function(t){let e=1/0,i=1/0,a=-1/0,u=-1/0;for(const f of t)e=Math.min(e,f.x),i=Math.min(i,f.y),a=Math.max(a,f.x),u=Math.max(u,f.y);return{min:new Me(e,i),max:new Me(a,u)}},s.getColumn=Ci,s.getDefaultExportFromCjs=be,s.getGridMatrix=function(t,e,i,a){const u=e.getNorth(),f=e.getSouth(),_=e.getWest(),w=e.getEast(),E=1<<t.z,D=w-_,k=u-f,z=D/64,j=-k/Ad[i],K=[0,z,0,j,0,0,u,_,0];if(t.z>0){const te=180/a;wm(K,K,[te/D+1,0,0,0,te/k+1,0,-.5*te/z,.5*te/j,1])}return K[2]=E,K[5]=t.x,K[8]=t.y,K},s.getImage=Qe,s.getJSON=function(t,e){return Gi(ze(t,{type:"json"}),e)},s.getLatitudinalLod=function(t){const e=Vs-5;t=ve(t,-e,e)/e*90;const i=Math.pow(Math.abs(Math.sin(Te(t))),3);return Math.round(i*(Ad.length-1))},s.getMapSessionAPI=to,s.getPerformanceMeasurement=oi,s.getProjection=wg,s.getRTLTextPluginStatus=T,s.getReferrer=pn,s.getTilePoint=function(t,{x:e,y:i},a=0){return new Me(((e-a)*t.scale-t.x)*Pi,(i*t.scale-t.y)*Pi)},s.getTileVec3=function(t,e,i=0){return Cd(((e.x-i)*t.scale-t.x)*Pi,(e.y*t.scale-t.y)*Pi,km(e.z,e.y))},s.getVideo=function(t,e){const i=Q.document.createElement("video");i.muted=!0,i.onloadstart=function(){e(null,i)};for(let a=0;a<t.length;a++){const u=Q.document.createElement("source");Vo(t[a])||(i.crossOrigin="Anonymous"),u.src=t[a],i.appendChild(u)}return{cancel:()=>{}}},s.globeCenterToScreenPoint=function(t){const e=[0,0,0],i=ol(new Float64Array(16));return wl(i,t.pixelMatrix,t.globeMatrix),zr(e,e,i),new Me(e[0],e[1])},s.globeDenormalizeECEF=Mu,s.globeECEFOrigin=function(t,e){const i=[0,0,0];return zr(i,i,nu(ja(e.canonical))),zr(i,i,t),i},s.globeMetersToEcef=Mh,s.globeNormalizeECEF=nu,s.globePixelsToTileUnits=function(t,e){return Pi/(512*Math.pow(2,t))*tu(ja(e))},s.globePoleMatrixForTile=function(t,e,i){const a=ol(new Float64Array(16)),u=(e/(1<<t)-.5)*Math.PI*2;return Wp(a,i.globeMatrix,u),Float32Array.from(a)},s.globeTileBounds=ja,s.globeTiltAtLngLat=Om,s.globeToMercatorTransition=Iu,s.globeUseCustomAntiAliasing=function(t,e,i){const a=Iu(i.zoom),u=t.style.map._antialias,f=!!e.extStandardDerivatives,_=e.extStandardDerivativesForceOff||t.terrain&&t.terrain.exaggeration()>0;return 0===a&&!u&&!_&&f},s.identity=ol,s.identity$1=Dm,s.invert=Gp,s.isFullscreen=function(){return!!Q.document.fullscreenElement||!!Q.document.webkitFullscreenElement},s.isLngLatBehindGlobe=rf,s.isMapAuthenticated=function(t){return nn.has(t)},s.isMapboxURL=Lt,s.isSafariWithAntialiasingBug=function(t){const e=t.navigator?t.navigator.userAgent:null;return!!gi(t)&&e&&(e.match("Version/15.4")||e.match("Version/15.5")||e.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},s.latFromMercatorY=vs,s.latLngToECEF=eu,s.len=Eh,s.length=bh,s.length$1=function(t){return Math.hypot(t[0],t[1],t[2],t[3])},s.lngFromMercatorX=wa,s.loadVectorTile=fy,s.makeRequest=Gi,s.mapValue=function(t,e,i,a,u){return ve((t-e)/(i-e)*(u-a)+a,a,u)},s.mercatorScale=Sd,s.mercatorXfromLng=$a,s.mercatorYfromLat=al,s.mercatorZfromAltitude=Zs,s.mul=m_,s.mul$1=Tm,s.multiply=wl,s.multiply$1=wm,s.multiply$2=g_,s.nextPowerOfTwo=Be,s.normalize=ys,s.normalize$1=__,s.normalize$2=sl,s.number=Kn,s.ortho=function(t,e,i,a,u,f,_){var w=1/(e-i),E=1/(a-u),D=1/(f-_);return t[0]=-2*w,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*E,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*D,t[11]=0,t[12]=(e+i)*w,t[13]=(u+a)*E,t[14]=(_+f)*D,t[15]=1,t},s.pbf=j_,s.perspective=function(t,e,i,a,u){var f,_=1/Math.tan(e/2);return t[0]=_/i,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=_,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=u&&u!==1/0?(t[10]=(u+a)*(f=1/(a-u)),t[14]=2*u*a*f):(t[10]=-1,t[14]=-2*a),t},s.pick=function(t,e){const i={};for(let a=0;a<e.length;a++){const u=e[a];u in t&&(i[u]=t[u])}return i},s.plugin=O,s.pointGeometry=_t,s.polesInViewport=function(t){const e=ol(new Float64Array(16));wl(e,t.pixelMatrix,t.globeMatrix);const i=[0,Pa,0],a=[0,Va,0];return zr(i,i,e),zr(a,a,e),[i[0]>0&&i[0]<=t.width&&i[1]>0&&i[1]<=t.height&&!rf(t,new tr(t.center.lat,90)),a[0]>0&&a[0]<=t.width&&a[1]>0&&a[1]<=t.height&&!rf(t,new tr(t.center.lat,-90))]},s.polygonContainsPoint=Jl,s.polygonIntersectsBox=ru,s.polygonIntersectsPolygon=Su,s.polygonizeBounds=function(t,e,i=0,a=!0){const u=new Me(i,i),f=t.sub(u),_=e.add(u),w=[f,new Me(_.x,f.y),_,new Me(f.x,_.y)];return a&&w.push(f.clone()),w},s.posAttributes=Dd,s.postMapLoadEvent=wi,s.postPerformanceEvent=Zi,s.postTurnstileEvent=gn,s.potpack=ug,s.prevPowerOfTwo=function(t){return t<=1?1:Math.pow(2,Math.floor(Math.log(t)/Math.LN2))},s.radToDeg=ae,s.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],s.registerForPluginStateChange=function(t){return t({pluginStatus:p,pluginURL:o}),b.on("pluginStateChange",t),t},s.removeAuthState=function(t){nn.delete(t)},s.renderColorRamp=su,s.resample=lf,s.rotateX=vh,s.rotateX$1=Kp,s.rotateY=Wp,s.rotateY$1=Dh,s.rotateZ=function(t,e,i){var a=Math.sin(i),u=Math.cos(i),f=e[0],_=e[1],w=e[2],E=e[3],D=e[4],k=e[5],z=e[6],j=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=f*u+D*a,t[1]=_*u+k*a,t[2]=w*u+z*a,t[3]=E*u+j*a,t[4]=D*u-f*a,t[5]=k*u-_*a,t[6]=z*u-w*a,t[7]=j*u-E*a,t},s.rotateZ$1=function(t,e,i){i*=.5;var a=e[0],u=e[1],f=e[2],_=e[3],w=Math.sin(i),E=Math.cos(i);return t[0]=a*E+u*w,t[1]=u*E-a*w,t[2]=f*E+_*w,t[3]=_*E-f*w,t},s.scale=Kc,s.scale$1=Ed,s.scale$2=Ua,s.scaleAndAdd=Td,s.set=function(t,e,i,a){return t[0]=e,t[1]=i,t[2]=a,t},s.setCacheLimits=function(t,e){Hi=t,Fi=e},s.setColumn=function(t,e,i){t[4*e+0]=i[0],t[4*e+1]=i[1],t[4*e+2]=i[2],t[4*e+3]=i[3]},s.setRTLTextPlugin=function(t,e,i=!1){if(p===Rn||p===fi||p===Mi)throw new Error("setRTLTextPlugin cannot be called multiple times.");o=So.resolveURL(t),p=Rn,Io=e,m(),i||I()},s.smoothstep=en,s.spec=tn,s.squaredLength=function(t){var e=t[0],i=t[1],a=t[2];return e*e+i*i+a*a},s.storeAuthState=function(t,e){e?nn.add(t):nn.delete(t)},s.sub=Za,s.subtract=Cm,s.symbolSize=U_,s.tileAABB=function(t,e,i,a,u,f,_,w,E){if("globe"===E.name)return function x_(t,e,i){const a=e/t.worldSize,u=t.globeMatrix;if(i.z<=1){const rn=ja(i).getCorners();return Du(rn,u,a),zs.fromPoints(rn)}const f=Ih(i),_=Ah(f);Du(_,u,a);const w=Number.MAX_VALUE,E=[-w,-w,-w],D=[w,w,w];if(f.contains(t.center)){for(const $n of _)wh(D,D,$n),Ch(E,E,$n);E[2]=0;const rn=t.point,En=[rn.x*a,rn.y*a,0];return wh(D,D,En),Ch(E,E,En),new zs(D,E)}const k=[u[12]*a,u[13]*a,u[14]*a],z=f.getCenter(),j=ve(t.center.lat,-Vs,Vs),K=ve(z.lat,-Vs,Vs),te=$a(t.center.lng),he=al(j);let Oe=te-$a(z.lng);const ot=he-al(K);Oe>.5?Oe-=1:Oe<-.5&&(Oe+=1);let Ct=0;Math.abs(Oe)>Math.abs(ot)?Ct=Oe>=0?1:3:(Ct=ot>=0?0:2,Td(k,k,[u[4]*a,u[5]*a,u[6]*a],-Math.sin(Te(ot>=0?f.getSouth():f.getNorth()))*ba));const at=_[Ct],wt=_[(Ct+1)%4],At=new v_(at,wt,k),It=[tf(At,0)||at[0],tf(At,1)||at[1],tf(At,2)||at[2]],un=Iu(t.zoom);if(un>0){const rn=function({x:$n,y:fn,z:kn},Fn,Zn,Yn,Tn){const si=1/(1<<kn);let yi=$n*si,li=yi+si,no=fn*si,Jn=no+si,Ei=0;const Wi=(yi+li)/2-Yn;return Wi>.5?Ei=-1:Wi<-.5&&(Ei=1),yi=((yi+Ei)*Fn-(Yn*=Fn))*Zn+Yn,li=((li+Ei)*Fn-Yn)*Zn+Yn,no=(no*Fn-(Tn*=Fn))*Zn+Tn,Jn=(Jn*Fn-Tn)*Zn+Tn,[[yi,Jn,0],[li,Jn,0],[li,no,0],[yi,no,0]]}(i,e,t._pixelsPerMercatorPixel,te,he);for(let $n=0;$n<_.length;$n++)ql(_[$n],rn[$n],un);const En=rl([],rn[Ct],rn[(Ct+1)%4]);Ua(En,En,.5),ql(It,En,un)}for(const rn of _)wh(D,D,rn),Ch(E,E,rn);return D[2]=Math.min(at[2],wt[2]),wh(D,D,It),Ch(E,E,It),new zs(D,E)}(t,e,new Hh(i,a,u));const D=uu({z:i,x:a,y:u},E);return new zs([(f+D.x/D.scale)*e,e*(D.y/D.scale),_],[(f+D.x2/D.scale)*e,e*(D.y2/D.scale),w])},s.tileCornersToBounds=Ih,s.tileTransform=uu,s.transformMat3=function(t,e,i){var a=e[0],u=e[1],f=e[2];return t[0]=a*i[0]+u*i[3]+f*i[6],t[1]=a*i[1]+u*i[4]+f*i[7],t[2]=a*i[2]+u*i[5]+f*i[8],t},s.transformMat4=zr,s.transformMat4$1=Xc,s.transformQuat=Jp,s.transitionTileAABBinECEF=Sm,s.translate=Eu,s.transpose=function(t,e){if(t===e){var i=e[1],a=e[2],u=e[5];t[1]=e[3],t[2]=e[6],t[3]=i,t[5]=e[7],t[6]=a,t[7]=u}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t},s.triggerPluginCompletionEvent=c,s.uniqueId=Ve,s.updateGlobeVertexNormal=function(t,e,i,a,u){const f=5*e+2;t.float32[f+0]=i,t.float32[f+1]=a,t.float32[f+2]=u},s.validateCustomStyleLayer=function(t){const e=[],i=t.id;return void 0===i&&e.push({message:`layers.${i}: missing required property "id"`}),void 0===t.render&&e.push({message:`layers.${i}: missing required method "render"`}),t.renderingMode&&"2d"!==t.renderingMode&&"3d"!==t.renderingMode&&e.push({message:`layers.${i}: property "renderingMode" must be either "2d" or "3d"`}),e},s.validateFilter=t=>Bs(jc(t)),s.validateFog=t=>Bs($c(t)),s.validateLayer=t=>Bs(Xa(t)),s.validateLight=t=>Bs(_d(t)),s.validateSource=t=>Bs(fc(t)),s.validateStyle=Gc,s.validateTerrain=t=>Bs(mc(t)),s.values=lt,s.vectorTile=bc,s.version=ie,s.warnOnce=St,s.window=Q,s.wrap=dt}),d(0,function(s){function Q(ut){if("number"==typeof ut||"boolean"==typeof ut||"string"==typeof ut||null==ut)return JSON.stringify(ut);if(Array.isArray(ut)){let xe="[";for(const Qe of ut)xe+=`${Q(Qe)},`;return`${xe}]`}let pe="{";for(const xe of Object.keys(ut).sort())pe+=`${xe}:${Q(ut[xe])},`;return`${pe}}`}function ie(ut){let pe="";for(const xe of s.refProperties)pe+=`/${Q(ut[xe])}`;return pe}class q{constructor(pe){this.keyCache={},pe&&this.replace(pe)}replace(pe){this._layerConfigs={},this._layers={},this.update(pe,[])}update(pe,xe){for(const vt of pe)this._layerConfigs[vt.id]=vt,(this._layers[vt.id]=s.createStyleLayer(vt)).compileFilter(),this.keyCache[vt.id]&&delete this.keyCache[vt.id];for(const vt of xe)delete this.keyCache[vt],delete this._layerConfigs[vt],delete this._layers[vt];this.familiesBySource={};const Qe=function(vt,Lt){const Zt={};for(let Pt=0;Pt<vt.length;Pt++){const Kt=Lt&&Lt[vt[Pt].id]||ie(vt[Pt]);Lt&&(Lt[vt[Pt].id]=Kt);let In=Zt[Kt];In||(In=Zt[Kt]=[]),In.push(vt[Pt])}const jt=[];for(const Pt in Zt)jt.push(Zt[Pt]);return jt}(s.values(this._layerConfigs),this.keyCache);for(const vt of Qe){const Lt=vt.map(et=>this._layers[et.id]),Zt=Lt[0];if("none"===Zt.visibility)continue;const jt=Zt.source||"";let Pt=this.familiesBySource[jt];Pt||(Pt=this.familiesBySource[jt]={});const Kt=Zt.sourceLayer||"_geojsonTileLayer";let In=Pt[Kt];In||(In=Pt[Kt]=[]),In.push(Lt)}}}class y{loadTile(pe,xe){const{uid:Qe,encoding:vt,rawImageData:Lt,padding:Zt,buildQuadTree:jt}=pe,Pt=s.window.ImageBitmap&&Lt instanceof s.window.ImageBitmap?this.getImageData(Lt,Zt):Lt;xe(null,new s.DEMData(Qe,Pt,vt,Zt<1,jt))}getImageData(pe,xe){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(pe.width,pe.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=pe.width,this.offscreenCanvas.height=pe.height,this.offscreenCanvasContext.drawImage(pe,0,0,pe.width,pe.height);const Qe=this.offscreenCanvasContext.getImageData(-xe,-xe,pe.width+2*xe,pe.height+2*xe);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),Qe}}function fe(ut,pe){if(0!==ut.length){Se(ut[0],pe);for(var xe=1;xe<ut.length;xe++)Se(ut[xe],!pe)}}function Se(ut,pe){for(var xe=0,Qe=0,vt=0,Lt=ut.length,Zt=Lt-1;vt<Lt;Zt=vt++){var jt=(ut[vt][0]-ut[Zt][0])*(ut[Zt][1]+ut[vt][1]),Pt=xe+jt;Qe+=Math.abs(xe)>=Math.abs(jt)?xe-Pt+jt:jt-Pt+xe,xe=Pt}xe+Qe>=0!=!!pe&&ut.reverse()}var De=s.getDefaultExportFromCjs(function ut(pe,xe){var Qe,vt=pe&&pe.type;if("FeatureCollection"===vt)for(Qe=0;Qe<pe.features.length;Qe++)ut(pe.features[Qe],xe);else if("GeometryCollection"===vt)for(Qe=0;Qe<pe.geometries.length;Qe++)ut(pe.geometries[Qe],xe);else if("Feature"===vt)ut(pe.geometry,xe);else if("Polygon"===vt)fe(pe.coordinates,xe);else if("MultiPolygon"===vt)for(Qe=0;Qe<pe.coordinates.length;Qe++)fe(pe.coordinates[Qe],xe);return pe});const X=s.VectorTileFeature.prototype.toGeoJSON;var se={exports:{}},Ee=s.pointGeometry,_e=s.vectorTile.VectorTileFeature,be=Re;function Re(ut,pe){this.options=pe||{},this.features=ut,this.length=ut.length}function Ne(ut,pe){this.id="number"==typeof ut.id?ut.id:void 0,this.type=ut.type,this.rawGeometry=1===ut.type?[ut.geometry]:ut.geometry,this.properties=ut.tags,this.extent=pe||4096}Re.prototype.feature=function(ut){return new Ne(this.features[ut],this.options.extent)},Ne.prototype.loadGeometry=function(){var ut=this.rawGeometry;this.geometry=[];for(var pe=0;pe<ut.length;pe++){for(var xe=ut[pe],Qe=[],vt=0;vt<xe.length;vt++)Qe.push(new Ee(xe[vt][0],xe[vt][1]));this.geometry.push(Qe)}return this.geometry},Ne.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var ut=this.geometry,pe=1/0,xe=-1/0,Qe=1/0,vt=-1/0,Lt=0;Lt<ut.length;Lt++)for(var Zt=ut[Lt],jt=0;jt<Zt.length;jt++){var Pt=Zt[jt];pe=Math.min(pe,Pt.x),xe=Math.max(xe,Pt.x),Qe=Math.min(Qe,Pt.y),vt=Math.max(vt,Pt.y)}return[pe,Qe,xe,vt]},Ne.prototype.toGeoJSON=_e.prototype.toGeoJSON;var qe=s.pbf,_t=be;function Je(ut){var pe=new qe;return function(xe,Qe){for(var vt in xe.layers)Qe.writeMessage(3,Me,xe.layers[vt])}(ut,pe),pe.finish()}function Me(ut,pe){var xe;pe.writeVarintField(15,ut.version||1),pe.writeStringField(1,ut.name||""),pe.writeVarintField(5,ut.extent||4096);var Qe={keys:[],values:[],keycache:{},valuecache:{}};for(xe=0;xe<ut.length;xe++)Qe.feature=ut.feature(xe),pe.writeMessage(2,it,Qe);var vt=Qe.keys;for(xe=0;xe<vt.length;xe++)pe.writeStringField(3,vt[xe]);var Lt=Qe.values;for(xe=0;xe<Lt.length;xe++)pe.writeMessage(4,we,Lt[xe])}function it(ut,pe){var xe=ut.feature;void 0!==xe.id&&pe.writeVarintField(1,xe.id),pe.writeMessage(2,Xe,ut),pe.writeVarintField(3,xe.type),pe.writeMessage(4,yt,xe)}function Xe(ut,pe){var xe=ut.feature,Qe=ut.keys,vt=ut.values,Lt=ut.keycache,Zt=ut.valuecache;for(var jt in xe.properties){var Pt=xe.properties[jt],Kt=Lt[jt];if(null!==Pt){void 0===Kt&&(Qe.push(jt),Lt[jt]=Kt=Qe.length-1),pe.writeVarint(Kt);var In=typeof Pt;"string"!==In&&"boolean"!==In&&"number"!==In&&(Pt=JSON.stringify(Pt));var et=In+":"+Pt,Ue=Zt[et];void 0===Ue&&(vt.push(Pt),Zt[et]=Ue=vt.length-1),pe.writeVarint(Ue)}}}function Te(ut,pe){return(pe<<3)+(7&ut)}function ae(ut){return ut<<1^ut>>31}function yt(ut,pe){for(var xe=ut.loadGeometry(),Qe=ut.type,vt=0,Lt=0,Zt=xe.length,jt=0;jt<Zt;jt++){var Pt=xe[jt],Kt=1;1===Qe&&(Kt=Pt.length),pe.writeVarint(Te(1,Kt));for(var In=3===Qe?Pt.length-1:Pt.length,et=0;et<In;et++){1===et&&1!==Qe&&pe.writeVarint(Te(2,In-1));var Ue=Pt[et].x-vt,Y=Pt[et].y-Lt;pe.writeVarint(ae(Ue)),pe.writeVarint(ae(Y)),vt+=Ue,Lt+=Y}3===Qe&&pe.writeVarint(Te(7,1))}}function we(ut,pe){var xe=typeof ut;"string"===xe?pe.writeStringField(1,ut):"boolean"===xe?pe.writeBooleanField(7,ut):"number"===xe&&(ut%1!=0?pe.writeDoubleField(3,ut):ut<0?pe.writeSVarintField(6,ut):pe.writeVarintField(5,ut))}se.exports=Je,se.exports.fromVectorTileJs=Je,se.exports.fromGeojsonVt=function(ut,pe){pe=pe||{};var xe={};for(var Qe in ut)xe[Qe]=new _t(ut[Qe].features,pe),xe[Qe].name=Qe,xe[Qe].version=pe.version,xe[Qe].extent=pe.extent;return Je({layers:xe})},se.exports.GeoJSONWrapper=_t;var Ze=s.getDefaultExportFromCjs(se.exports);const Ae={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:ut=>ut},ve=Math.fround||(en=new Float32Array(1),ut=>(en[0]=+ut,en[0]));var en;const dt=3,mt=5,lt=6;class ze{constructor(pe){this.options=Object.assign(Object.create(Ae),pe),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(pe){const{log:xe,minZoom:Qe,maxZoom:vt}=this.options;xe&&console.time("total time");const Lt=`prepare ${pe.length} points`;xe&&console.time(Lt),this.points=pe;const Zt=[];for(let Pt=0;Pt<pe.length;Pt++){const Kt=pe[Pt];if(!Kt.geometry)continue;const[In,et]=Kt.geometry.coordinates,Ue=ve(gt(In)),Y=ve(Be(et));Zt.push(Ue,Y,1/0,Pt,-1,1),this.options.reduce&&Zt.push(0)}let jt=this.trees[vt+1]=this._createTree(Zt);xe&&console.timeEnd(Lt);for(let Pt=vt;Pt>=Qe;Pt--){const Kt=+Date.now();jt=this.trees[Pt]=this._createTree(this._cluster(jt,Pt)),xe&&console.log("z%d: %d clusters in %dms",Pt,jt.numItems,+Date.now()-Kt)}return xe&&console.timeEnd("total time"),this}getClusters(pe,xe){let Qe=((pe[0]+180)%360+360)%360-180;const vt=Math.max(-90,Math.min(90,pe[1]));let Lt=180===pe[2]?180:((pe[2]+180)%360+360)%360-180;const Zt=Math.max(-90,Math.min(90,pe[3]));if(pe[2]-pe[0]>=360)Qe=-180,Lt=180;else if(Qe>Lt){const et=this.getClusters([Qe,vt,180,Zt],xe),Ue=this.getClusters([-180,vt,Lt,Zt],xe);return et.concat(Ue)}const jt=this.trees[this._limitZoom(xe)],Pt=jt.range(gt(Qe),Be(Zt),gt(Lt),Be(vt)),Kt=jt.data,In=[];for(const et of Pt){const Ue=this.stride*et;In.push(Kt[Ue+mt]>1?xt(Kt,Ue,this.clusterProps):this.points[Kt[Ue+dt]])}return In}getChildren(pe){const xe=this._getOriginId(pe),Qe=this._getOriginZoom(pe),vt="No cluster with the specified id.",Lt=this.trees[Qe];if(!Lt)throw new Error(vt);const Zt=Lt.data;if(xe*this.stride>=Zt.length)throw new Error(vt);const jt=this.options.radius/(this.options.extent*Math.pow(2,Qe-1)),Pt=Lt.within(Zt[xe*this.stride],Zt[xe*this.stride+1],jt),Kt=[];for(const In of Pt){const et=In*this.stride;Zt[et+4]===pe&&Kt.push(Zt[et+mt]>1?xt(Zt,et,this.clusterProps):this.points[Zt[et+dt]])}if(0===Kt.length)throw new Error(vt);return Kt}getLeaves(pe,xe,Qe){const vt=[];return this._appendLeaves(vt,pe,xe=xe||10,Qe=Qe||0,0),vt}getTile(pe,xe,Qe){const vt=this.trees[this._limitZoom(pe)],Lt=Math.pow(2,pe),{extent:Zt,radius:jt}=this.options,Pt=jt/Zt,Kt=(Qe-Pt)/Lt,In=(Qe+1+Pt)/Lt,et={features:[]};return this._addTileFeatures(vt.range((xe-Pt)/Lt,Kt,(xe+1+Pt)/Lt,In),vt.data,xe,Qe,Lt,et),0===xe&&this._addTileFeatures(vt.range(1-Pt/Lt,Kt,1,In),vt.data,Lt,Qe,Lt,et),xe===Lt-1&&this._addTileFeatures(vt.range(0,Kt,Pt/Lt,In),vt.data,-1,Qe,Lt,et),et.features.length?et:null}getClusterExpansionZoom(pe){let xe=this._getOriginZoom(pe)-1;for(;xe<=this.options.maxZoom;){const Qe=this.getChildren(pe);if(xe++,1!==Qe.length)break;pe=Qe[0].properties.cluster_id}return xe}_appendLeaves(pe,xe,Qe,vt,Lt){const Zt=this.getChildren(xe);for(const jt of Zt){const Pt=jt.properties;if(Pt&&Pt.cluster?Lt+Pt.point_count<=vt?Lt+=Pt.point_count:Lt=this._appendLeaves(pe,Pt.cluster_id,Qe,vt,Lt):Lt<vt?Lt++:pe.push(jt),pe.length===Qe)break}return Lt}_createTree(pe){const xe=new s.KDBush(pe.length/this.stride|0,this.options.nodeSize,Float32Array);for(let Qe=0;Qe<pe.length;Qe+=this.stride)xe.add(pe[Qe],pe[Qe+1]);return xe.finish(),xe.data=pe,xe}_addTileFeatures(pe,xe,Qe,vt,Lt,Zt){for(const jt of pe){const Pt=jt*this.stride,Kt=xe[Pt+mt]>1;let In,et,Ue;if(Kt)In=Ve(xe,Pt,this.clusterProps),et=xe[Pt],Ue=xe[Pt+1];else{const Ge=this.points[xe[Pt+dt]];In=Ge.properties;const[Ft,gn]=Ge.geometry.coordinates;et=gt(Ft),Ue=Be(gn)}const Y={type:1,geometry:[[Math.round(this.options.extent*(et*Lt-Qe)),Math.round(this.options.extent*(Ue*Lt-vt))]],tags:In};let me;me=Kt||this.options.generateId?xe[Pt+dt]:this.points[xe[Pt+dt]].id,void 0!==me&&(Y.id=me),Zt.features.push(Y)}}_limitZoom(pe){return Math.max(this.options.minZoom,Math.min(Math.floor(+pe),this.options.maxZoom+1))}_cluster(pe,xe){const{radius:Qe,extent:vt,reduce:Lt,minPoints:Zt}=this.options,jt=Qe/(vt*Math.pow(2,xe)),Pt=pe.data,Kt=[],In=this.stride;for(let et=0;et<Pt.length;et+=In){if(Pt[et+2]<=xe)continue;Pt[et+2]=xe;const Ue=Pt[et],Y=Pt[et+1],me=pe.within(Pt[et],Pt[et+1],jt),Ge=Pt[et+mt];let Ft=Ge;for(const gn of me){const ei=gn*In;Pt[ei+2]>xe&&(Ft+=Pt[ei+mt])}if(Ft>Ge&&Ft>=Zt){let gn,ei=Ue*Ge,wi=Y*Ge,Ii=-1;const Zi=((et/In|0)<<5)+(xe+1)+this.points.length;for(const fo of me){const to=fo*In;if(Pt[to+2]<=xe)continue;Pt[to+2]=xe;const nn=Pt[to+mt];ei+=Pt[to]*nn,wi+=Pt[to+1]*nn,Pt[to+4]=Zi,Lt&&(gn||(gn=this._map(Pt,et,!0),Ii=this.clusterProps.length,this.clusterProps.push(gn)),Lt(gn,this._map(Pt,to)))}Pt[et+4]=Zi,Kt.push(ei/Ft,wi/Ft,1/0,Zi,-1,Ft),Lt&&Kt.push(Ii)}else{for(let gn=0;gn<In;gn++)Kt.push(Pt[et+gn]);if(Ft>1)for(const gn of me){const ei=gn*In;if(!(Pt[ei+2]<=xe)){Pt[ei+2]=xe;for(let wi=0;wi<In;wi++)Kt.push(Pt[ei+wi])}}}}return Kt}_getOriginId(pe){return pe-this.points.length>>5}_getOriginZoom(pe){return(pe-this.points.length)%32}_map(pe,xe,Qe){if(pe[xe+mt]>1){const Zt=this.clusterProps[pe[xe+lt]];return Qe?Object.assign({},Zt):Zt}const vt=this.points[pe[xe+dt]].properties,Lt=this.options.map(vt);return Qe&&Lt===vt?Object.assign({},Lt):Lt}}function xt(ut,pe,xe){return{type:"Feature",id:ut[pe+dt],properties:Ve(ut,pe,xe),geometry:{type:"Point",coordinates:[(Qe=ut[pe],360*(Qe-.5)),Bt(ut[pe+1])]}};var Qe}function Ve(ut,pe,xe){const Qe=ut[pe+mt],vt=Qe>=1e4?`${Math.round(Qe/1e3)}k`:Qe>=1e3?Math.round(Qe/100)/10+"k":Qe,Lt=ut[pe+lt],Zt=-1===Lt?{}:Object.assign({},xe[Lt]);return Object.assign(Zt,{cluster:!0,cluster_id:ut[pe+dt],point_count:Qe,point_count_abbreviated:vt})}function gt(ut){return ut/360+.5}function Be(ut){const pe=Math.sin(ut*Math.PI/180),xe=.5-.25*Math.log((1+pe)/(1-pe))/Math.PI;return xe<0?0:xe>1?1:xe}function Bt(ut){const pe=(180-360*ut)*Math.PI/180;return 360*Math.atan(Math.exp(pe))/Math.PI-90}function Wt(ut,pe,xe,Qe){for(var vt,Lt=Qe,Zt=xe-pe>>1,jt=xe-pe,Pt=ut[pe],Kt=ut[pe+1],In=ut[xe],et=ut[xe+1],Ue=pe+3;Ue<xe;Ue+=3){var Y=wn(ut[Ue],ut[Ue+1],Pt,Kt,In,et);if(Y>Lt)vt=Ue,Lt=Y;else if(Y===Lt){var me=Math.abs(Ue-Zt);me<jt&&(vt=Ue,jt=me)}}Lt>Qe&&(vt-pe>3&&Wt(ut,pe,vt,Qe),ut[vt+2]=Lt,xe-vt>3&&Wt(ut,vt,xe,Qe))}function wn(ut,pe,xe,Qe,vt,Lt){var Zt=vt-xe,jt=Lt-Qe;if(0!==Zt||0!==jt){var Pt=((ut-xe)*Zt+(pe-Qe)*jt)/(Zt*Zt+jt*jt);Pt>1?(xe=vt,Qe=Lt):Pt>0&&(xe+=Zt*Pt,Qe+=jt*Pt)}return(Zt=ut-xe)*Zt+(jt=pe-Qe)*jt}function Xt(ut,pe,xe,Qe){var vt={id:void 0===ut?null:ut,type:pe,geometry:xe,tags:Qe,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(Lt){var Zt=Lt.geometry,jt=Lt.type;if("Point"===jt||"MultiPoint"===jt||"LineString"===jt)mn(Lt,Zt);else if("Polygon"===jt||"MultiLineString"===jt)for(var Pt=0;Pt<Zt.length;Pt++)mn(Lt,Zt[Pt]);else if("MultiPolygon"===jt)for(Pt=0;Pt<Zt.length;Pt++)for(var Kt=0;Kt<Zt[Pt].length;Kt++)mn(Lt,Zt[Pt][Kt])}(vt),vt}function mn(ut,pe){for(var xe=0;xe<pe.length;xe+=3)ut.minX=Math.min(ut.minX,pe[xe]),ut.minY=Math.min(ut.minY,pe[xe+1]),ut.maxX=Math.max(ut.maxX,pe[xe]),ut.maxY=Math.max(ut.maxY,pe[xe+1])}function an(ut,pe,xe,Qe){if(pe.geometry){var vt=pe.geometry.coordinates,Lt=pe.geometry.type,Zt=Math.pow(xe.tolerance/((1<<xe.maxZoom)*xe.extent),2),jt=[],Pt=pe.id;if(xe.promoteId?Pt=pe.properties[xe.promoteId]:xe.generateId&&(Pt=Qe||0),"Point"===Lt)Vt(vt,jt);else if("MultiPoint"===Lt)for(var Kt=0;Kt<vt.length;Kt++)Vt(vt[Kt],jt);else if("LineString"===Lt)St(vt,jt,Zt,!1);else if("MultiLineString"===Lt){if(xe.lineMetrics){for(Kt=0;Kt<vt.length;Kt++)St(vt[Kt],jt=[],Zt,!1),ut.push(Xt(Pt,"LineString",jt,pe.properties));return}st(vt,jt,Zt,!1)}else if("Polygon"===Lt)st(vt,jt,Zt,!0);else{if("MultiPolygon"!==Lt){if("GeometryCollection"===Lt){for(Kt=0;Kt<pe.geometry.geometries.length;Kt++)an(ut,{id:Pt,geometry:pe.geometry.geometries[Kt],properties:pe.properties},xe,Qe);return}throw new Error("Input data is not a valid GeoJSON object.")}for(Kt=0;Kt<vt.length;Kt++){var In=[];st(vt[Kt],In,Zt,!0),jt.push(In)}}ut.push(Xt(Pt,Lt,jt,pe.properties))}}function Vt(ut,pe){pe.push(qt(ut[0])),pe.push(dn(ut[1])),pe.push(0)}function St(ut,pe,xe,Qe){for(var vt,Lt,Zt=0,jt=0;jt<ut.length;jt++){var Pt=qt(ut[jt][0]),Kt=dn(ut[jt][1]);pe.push(Pt),pe.push(Kt),pe.push(0),jt>0&&(Zt+=Qe?(vt*Kt-Pt*Lt)/2:Math.sqrt(Math.pow(Pt-vt,2)+Math.pow(Kt-Lt,2))),vt=Pt,Lt=Kt}var In=pe.length-3;pe[2]=1,Wt(pe,0,In,xe),pe[In+2]=1,pe.size=Math.abs(Zt),pe.start=0,pe.end=pe.size}function st(ut,pe,xe,Qe){for(var vt=0;vt<ut.length;vt++){var Lt=[];St(ut[vt],Lt,xe,Qe),pe.push(Lt)}}function qt(ut){return ut/360+.5}function dn(ut){var pe=Math.sin(ut*Math.PI/180),xe=.5-.25*Math.log((1+pe)/(1-pe))/Math.PI;return xe<0?0:xe>1?1:xe}function Sn(ut,pe,xe,Qe,vt,Lt,Zt,jt){if(Qe/=pe,Lt>=(xe/=pe)&&Zt<Qe)return ut;if(Zt<xe||Lt>=Qe)return null;for(var Pt=[],Kt=0;Kt<ut.length;Kt++){var In=ut[Kt],et=In.geometry,Ue=In.type,Y=0===vt?In.minX:In.minY,me=0===vt?In.maxX:In.maxY;if(Y>=xe&&me<Qe)Pt.push(In);else if(!(me<xe||Y>=Qe)){var Ge=[];if("Point"===Ue||"MultiPoint"===Ue)zt(et,Ge,xe,Qe,vt);else if("LineString"===Ue)gi(et,Ge,xe,Qe,vt,!1,jt.lineMetrics);else if("MultiLineString"===Ue)Ci(et,Ge,xe,Qe,vt,!1);else if("Polygon"===Ue)Ci(et,Ge,xe,Qe,vt,!0);else if("MultiPolygon"===Ue)for(var Ft=0;Ft<et.length;Ft++){var gn=[];Ci(et[Ft],gn,xe,Qe,vt,!0),gn.length&&Ge.push(gn)}if(Ge.length){if(jt.lineMetrics&&"LineString"===Ue){for(Ft=0;Ft<Ge.length;Ft++)Pt.push(Xt(In.id,Ue,Ge[Ft],In.tags));continue}"LineString"!==Ue&&"MultiLineString"!==Ue||(1===Ge.length?(Ue="LineString",Ge=Ge[0]):Ue="MultiLineString"),"Point"!==Ue&&"MultiPoint"!==Ue||(Ue=3===Ge.length?"Point":"MultiPoint"),Pt.push(Xt(In.id,Ue,Ge,In.tags))}}}return Pt.length?Pt:null}function zt(ut,pe,xe,Qe,vt){for(var Lt=0;Lt<ut.length;Lt+=3){var Zt=ut[Lt+vt];Zt>=xe&&Zt<=Qe&&(pe.push(ut[Lt]),pe.push(ut[Lt+1]),pe.push(ut[Lt+2]))}}function gi(ut,pe,xe,Qe,vt,Lt,Zt){for(var jt,Pt,Kt=$i(ut),In=0===vt?Hi:Fi,et=ut.start,Ue=0;Ue<ut.length-3;Ue+=3){var Y=ut[Ue],me=ut[Ue+1],Ge=ut[Ue+2],Ft=ut[Ue+3],gn=ut[Ue+4],ei=0===vt?Y:me,wi=0===vt?Ft:gn,Ii=!1;Zt&&(jt=Math.sqrt(Math.pow(Y-Ft,2)+Math.pow(me-gn,2))),ei<xe?wi>xe&&(Pt=In(Kt,Y,me,Ft,gn,xe),Zt&&(Kt.start=et+jt*Pt)):ei>Qe?wi<Qe&&(Pt=In(Kt,Y,me,Ft,gn,Qe),Zt&&(Kt.start=et+jt*Pt)):Ji(Kt,Y,me,Ge),wi<xe&&ei>=xe&&(Pt=In(Kt,Y,me,Ft,gn,xe),Ii=!0),wi>Qe&&ei<=Qe&&(Pt=In(Kt,Y,me,Ft,gn,Qe),Ii=!0),!Lt&&Ii&&(Zt&&(Kt.end=et+jt*Pt),pe.push(Kt),Kt=$i(ut)),Zt&&(et+=jt)}var Zi=ut.length-3;Y=ut[Zi],me=ut[Zi+1],Ge=ut[Zi+2],(ei=0===vt?Y:me)>=xe&&ei<=Qe&&Ji(Kt,Y,me,Ge),Zi=Kt.length-3,Lt&&Zi>=3&&(Kt[Zi]!==Kt[0]||Kt[Zi+1]!==Kt[1])&&Ji(Kt,Kt[0],Kt[1],Kt[2]),Kt.length&&pe.push(Kt)}function $i(ut){var pe=[];return pe.size=ut.size,pe.start=ut.start,pe.end=ut.end,pe}function Ci(ut,pe,xe,Qe,vt,Lt){for(var Zt=0;Zt<ut.length;Zt++)gi(ut[Zt],pe,xe,Qe,vt,Lt,!1)}function Ji(ut,pe,xe,Qe){ut.push(pe),ut.push(xe),ut.push(Qe)}function Hi(ut,pe,xe,Qe,vt,Lt){var Zt=(Lt-pe)/(Qe-pe);return ut.push(Lt),ut.push(xe+(vt-xe)*Zt),ut.push(1),Zt}function Fi(ut,pe,xe,Qe,vt,Lt){var Zt=(Lt-xe)/(vt-xe);return ut.push(pe+(Qe-pe)*Zt),ut.push(Lt),ut.push(1),Zt}function ii(ut,pe){for(var xe=[],Qe=0;Qe<ut.length;Qe++){var vt,Lt=ut[Qe],Zt=Lt.type;if("Point"===Zt||"MultiPoint"===Zt||"LineString"===Zt)vt=mi(Lt.geometry,pe);else if("MultiLineString"===Zt||"Polygon"===Zt){vt=[];for(var jt=0;jt<Lt.geometry.length;jt++)vt.push(mi(Lt.geometry[jt],pe))}else if("MultiPolygon"===Zt)for(vt=[],jt=0;jt<Lt.geometry.length;jt++){for(var Pt=[],Kt=0;Kt<Lt.geometry[jt].length;Kt++)Pt.push(mi(Lt.geometry[jt][Kt],pe));vt.push(Pt)}xe.push(Xt(Lt.id,Zt,vt,Lt.tags))}return xe}function mi(ut,pe){var xe=[];xe.size=ut.size,void 0!==ut.start&&(xe.start=ut.start,xe.end=ut.end);for(var Qe=0;Qe<ut.length;Qe+=3)xe.push(ut[Qe]+pe,ut[Qe+1],ut[Qe+2]);return xe}function xn(ut,pe){if(ut.transformed)return ut;var xe,Qe,vt,Lt=1<<ut.z,Zt=ut.x,jt=ut.y;for(xe=0;xe<ut.features.length;xe++){var Pt=ut.features[xe],Kt=Pt.geometry,In=Pt.type;if(Pt.geometry=[],1===In)for(Qe=0;Qe<Kt.length;Qe+=2)Pt.geometry.push(Qt(Kt[Qe],Kt[Qe+1],pe,Lt,Zt,jt));else for(Qe=0;Qe<Kt.length;Qe++){var et=[];for(vt=0;vt<Kt[Qe].length;vt+=2)et.push(Qt(Kt[Qe][vt],Kt[Qe][vt+1],pe,Lt,Zt,jt));Pt.geometry.push(et)}}return ut.transformed=!0,ut}function Qt(ut,pe,xe,Qe,vt,Lt){return[Math.round(xe*(ut*Qe-vt)),Math.round(xe*(pe*Qe-Lt))]}function Mt(ut,pe,xe,Qe,vt){for(var Lt=pe===vt.maxZoom?0:vt.tolerance/((1<<pe)*vt.extent),Zt={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:xe,y:Qe,z:pe,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},jt=0;jt<ut.length;jt++){Zt.numFeatures++,ge(Zt,ut[jt],Lt,vt);var Pt=ut[jt].minX,Kt=ut[jt].minY,In=ut[jt].maxX,et=ut[jt].maxY;Pt<Zt.minX&&(Zt.minX=Pt),Kt<Zt.minY&&(Zt.minY=Kt),In>Zt.maxX&&(Zt.maxX=In),et>Zt.maxY&&(Zt.maxY=et)}return Zt}function ge(ut,pe,xe,Qe){var vt=pe.geometry,Lt=pe.type,Zt=[];if("Point"===Lt||"MultiPoint"===Lt)for(var jt=0;jt<vt.length;jt+=3)Zt.push(vt[jt]),Zt.push(vt[jt+1]),ut.numPoints++,ut.numSimplified++;else if("LineString"===Lt)ct(Zt,vt,ut,xe,!1,!1);else if("MultiLineString"===Lt||"Polygon"===Lt)for(jt=0;jt<vt.length;jt++)ct(Zt,vt[jt],ut,xe,"Polygon"===Lt,0===jt);else if("MultiPolygon"===Lt)for(var Pt=0;Pt<vt.length;Pt++){var Kt=vt[Pt];for(jt=0;jt<Kt.length;jt++)ct(Zt,Kt[jt],ut,xe,!0,0===jt)}if(Zt.length){var In=pe.tags||null;if("LineString"===Lt&&Qe.lineMetrics){for(var et in In={},pe.tags)In[et]=pe.tags[et];In.mapbox_clip_start=vt.start/vt.size,In.mapbox_clip_end=vt.end/vt.size}var Ue={geometry:Zt,type:"Polygon"===Lt||"MultiPolygon"===Lt?3:"LineString"===Lt||"MultiLineString"===Lt?2:1,tags:In};null!==pe.id&&(Ue.id=pe.id),ut.features.push(Ue)}}function ct(ut,pe,xe,Qe,vt,Lt){var Zt=Qe*Qe;if(Qe>0&&pe.size<(vt?Zt:Qe))xe.numPoints+=pe.length/3;else{for(var jt=[],Pt=0;Pt<pe.length;Pt+=3)(0===Qe||pe[Pt+2]>Zt)&&(xe.numSimplified++,jt.push(pe[Pt]),jt.push(pe[Pt+1])),xe.numPoints++;vt&&function(Kt,In){for(var et=0,Ue=0,Y=Kt.length,me=Y-2;Ue<Y;me=Ue,Ue+=2)et+=(Kt[Ue]-Kt[me])*(Kt[Ue+1]+Kt[me+1]);if(et>0===In)for(Ue=0,Y=Kt.length;Ue<Y/2;Ue+=2){var Ge=Kt[Ue],Ft=Kt[Ue+1];Kt[Ue]=Kt[Y-2-Ue],Kt[Ue+1]=Kt[Y-1-Ue],Kt[Y-2-Ue]=Ge,Kt[Y-1-Ue]=Ft}}(jt,Lt),ut.push(jt)}}function Gt(ut,pe){var xe=(pe=this.options=function(vt,Lt){for(var Zt in Lt)vt[Zt]=Lt[Zt];return vt}(Object.create(this.options),pe)).debug;if(xe&&console.time("preprocess data"),pe.maxZoom<0||pe.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(pe.promoteId&&pe.generateId)throw new Error("promoteId and generateId cannot be used together.");var vt,Lt,Zt,jt,Pt,Kt,Qe=function(vt,Lt){var Zt=[];if("FeatureCollection"===vt.type)for(var jt=0;jt<vt.features.length;jt++)an(Zt,vt.features[jt],Lt,jt);else an(Zt,"Feature"===vt.type?vt:{geometry:vt},Lt);return Zt}(ut,pe);this.tiles={},this.tileCoords=[],xe&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",pe.indexMaxZoom,pe.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),jt=vt=Qe,Pt=Sn(vt,1,-1-(Zt=(Lt=pe).buffer/Lt.extent),Zt,0,-1,2,Lt),Kt=Sn(vt,1,1-Zt,2+Zt,0,-1,2,Lt),(Pt||Kt)&&(jt=Sn(vt,1,-Zt,1+Zt,0,-1,2,Lt)||[],Pt&&(jt=ii(Pt,1).concat(jt)),Kt&&(jt=jt.concat(ii(Kt,-1)))),(Qe=jt).length&&this.splitTile(Qe,0,0,0),xe&&(Qe.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function pn(ut,pe,xe){return 32*((1<<ut)*xe+pe)+ut}function Gi(ut,pe){const xe=ut.tileID.canonical;if(!this._geoJSONIndex)return pe(null,null);const Qe=this._geoJSONIndex.getTile(xe.z,xe.x,xe.y);if(!Qe)return pe(null,null);const vt=new class{constructor(Zt){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=s.EXTENT,this.length=Zt.length,this._features=Zt}feature(Zt){return new class{constructor(jt){this._feature=jt,this.extent=s.EXTENT,this.type=jt.type,this.properties=jt.tags,"id"in jt&&!isNaN(jt.id)&&(this.id=parseInt(jt.id,10))}loadGeometry(){if(1===this._feature.type){const jt=[];for(const Pt of this._feature.geometry)jt.push([new s.Point(Pt[0],Pt[1])]);return jt}{const jt=[];for(const Pt of this._feature.geometry){const Kt=[];for(const In of Pt)Kt.push(new s.Point(In[0],In[1]));jt.push(Kt)}return jt}}toGeoJSON(jt,Pt,Kt){return X.call(this,jt,Pt,Kt)}}(this._features[Zt])}}(Qe.features);let Lt=Ze(vt);0===Lt.byteOffset&&Lt.byteLength===Lt.buffer.byteLength||(Lt=new Uint8Array(Lt)),pe(null,{vectorTile:vt,rawData:Lt.buffer})}Gt.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Gt.prototype.splitTile=function(ut,pe,xe,Qe,vt,Lt,Zt){for(var jt=[ut,pe,xe,Qe],Pt=this.options,Kt=Pt.debug;jt.length;){Qe=jt.pop(),xe=jt.pop(),pe=jt.pop(),ut=jt.pop();var In=1<<pe,et=pn(pe,xe,Qe),Ue=this.tiles[et];if(!Ue&&(Kt>1&&console.time("creation"),Ue=this.tiles[et]=Mt(ut,pe,xe,Qe,Pt),this.tileCoords.push({z:pe,x:xe,y:Qe}),Kt)){Kt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",pe,xe,Qe,Ue.numFeatures,Ue.numPoints,Ue.numSimplified),console.timeEnd("creation"));var Y="z"+pe;this.stats[Y]=(this.stats[Y]||0)+1,this.total++}if(Ue.source=ut,vt){if(pe===Pt.maxZoom||pe===vt)continue;var me=1<<vt-pe;if(xe!==Math.floor(Lt/me)||Qe!==Math.floor(Zt/me))continue}else if(pe===Pt.indexMaxZoom||Ue.numPoints<=Pt.indexMaxPoints)continue;if(Ue.source=null,0!==ut.length){Kt>1&&console.time("clipping");var Ge,Ft,gn,ei,wi,Ii,Zi=.5*Pt.buffer/Pt.extent,fo=.5-Zi,to=.5+Zi,nn=1+Zi;Ge=Ft=gn=ei=null,wi=Sn(ut,In,xe-Zi,xe+to,0,Ue.minX,Ue.maxX,Pt),Ii=Sn(ut,In,xe+fo,xe+nn,0,Ue.minX,Ue.maxX,Pt),ut=null,wi&&(Ge=Sn(wi,In,Qe-Zi,Qe+to,1,Ue.minY,Ue.maxY,Pt),Ft=Sn(wi,In,Qe+fo,Qe+nn,1,Ue.minY,Ue.maxY,Pt),wi=null),Ii&&(gn=Sn(Ii,In,Qe-Zi,Qe+to,1,Ue.minY,Ue.maxY,Pt),ei=Sn(Ii,In,Qe+fo,Qe+nn,1,Ue.minY,Ue.maxY,Pt),Ii=null),Kt>1&&console.timeEnd("clipping"),jt.push(Ge||[],pe+1,2*xe,2*Qe),jt.push(Ft||[],pe+1,2*xe,2*Qe+1),jt.push(gn||[],pe+1,2*xe+1,2*Qe),jt.push(ei||[],pe+1,2*xe+1,2*Qe+1)}}},Gt.prototype.getTile=function(ut,pe,xe){var Qe=this.options,vt=Qe.extent,Lt=Qe.debug;if(ut<0||ut>24)return null;var Zt=1<<ut,jt=pn(ut,pe=(pe%Zt+Zt)%Zt,xe);if(this.tiles[jt])return xn(this.tiles[jt],vt);Lt>1&&console.log("drilling down to z%d-%d-%d",ut,pe,xe);for(var Pt,Kt=ut,In=pe,et=xe;!Pt&&Kt>0;)Kt--,In=Math.floor(In/2),et=Math.floor(et/2),Pt=this.tiles[pn(Kt,In,et)];return Pt&&Pt.source?(Lt>1&&console.log("found parent tile z%d-%d-%d",Kt,In,et),Lt>1&&console.time("drilling down"),this.splitTile(Pt.source,Kt,In,et,ut,pe,xe),Lt>1&&console.timeEnd("drilling down"),this.tiles[jt]?xn(this.tiles[jt],vt):null):null};class ri extends s.VectorTileWorkerSource{constructor(pe,xe,Qe,vt,Lt){super(pe,xe,Qe,vt,Gi),Lt&&(this.loadGeoJSON=Lt)}loadData(pe,xe){const Qe=pe&&pe.request,vt=Qe&&Qe.collectResourceTiming;this.loadGeoJSON(pe,(Lt,Zt)=>{if(Lt||!Zt)return xe(Lt);if("object"!=typeof Zt)return xe(new Error(`Input data given to '${pe.source}' is not a valid GeoJSON object.`));{De(Zt,!0);try{if(pe.filter){const Pt=s.createExpression(pe.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if("error"===Pt.result)throw new Error(Pt.value.map(In=>`${In.key}: ${In.message}`).join(", "));Zt={type:"FeatureCollection",features:Zt.features.filter(In=>Pt.value.evaluate({zoom:0},In))}}this._geoJSONIndex=pe.cluster?new ze(function({superclusterOptions:Pt,clusterProperties:Kt}){if(!Kt||!Pt)return Pt;const In={},et={},Ue={accumulated:null,zoom:0},Y={properties:null},me=Object.keys(Kt);for(const Ge of me){const[Ft,gn]=Kt[Ge],ei=s.createExpression(gn),wi=s.createExpression("string"==typeof Ft?[Ft,["accumulated"],["get",Ge]]:Ft);In[Ge]=ei.value,et[Ge]=wi.value}return Pt.map=Ge=>{Y.properties=Ge;const Ft={};for(const gn of me)Ft[gn]=In[gn].evaluate(Ue,Y);return Ft},Pt.reduce=(Ge,Ft)=>{Y.properties=Ft;for(const gn of me)Ue.accumulated=Ge[gn],Ge[gn]=et[gn].evaluate(Ue,Y)},Pt}(pe)).load(Zt.features):new Gt(Pt=Zt,pe.geojsonVtOptions)}catch(Pt){return xe(Pt)}this.loaded={};const jt={};if(vt){const Pt=s.getPerformanceMeasurement(Qe);Pt&&(jt.resourceTiming={},jt.resourceTiming[pe.source]=JSON.parse(JSON.stringify(Pt)))}xe(null,jt)}var Pt})}reloadTile(pe,xe){const Qe=this.loaded;return Qe&&Qe[pe.uid]?super.reloadTile(pe,xe):this.loadTile(pe,xe)}loadGeoJSON(pe,xe){if(pe.request)s.getJSON(pe.request,xe);else{if("string"!=typeof pe.data)return xe(new Error(`Input data given to '${pe.source}' is not a valid GeoJSON object.`));try{return xe(null,JSON.parse(pe.data))}catch{return xe(new Error(`Input data given to '${pe.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(pe,xe){try{xe(null,this._geoJSONIndex.getClusterExpansionZoom(pe.clusterId))}catch(Qe){xe(Qe)}}getClusterChildren(pe,xe){try{xe(null,this._geoJSONIndex.getChildren(pe.clusterId))}catch(Qe){xe(Qe)}}getClusterLeaves(pe,xe){try{xe(null,this._geoJSONIndex.getLeaves(pe.clusterId,pe.limit,pe.offset))}catch(Qe){xe(Qe)}}}class Vo{constructor(pe){this.self=pe,this.actor=new s.Actor(pe,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=s.getProjection({name:"mercator"}),this.workerSourceTypes={vector:s.VectorTileWorkerSource,geojson:ri},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(xe,Qe)=>{if(this.workerSourceTypes[xe])throw new Error(`Worker source with name "${xe}" already registered.`);this.workerSourceTypes[xe]=Qe},this.self.registerRTLTextPlugin=xe=>{if(s.plugin.isParsed())throw new Error("RTL text plugin already registered.");s.plugin.applyArabicShaping=xe.applyArabicShaping,s.plugin.processBidirectionalText=xe.processBidirectionalText,s.plugin.processStyledBidirectionalText=xe.processStyledBidirectionalText}}clearCaches(pe,xe,Qe){delete this.layerIndexes[pe],delete this.availableImages[pe],delete this.workerSources[pe],delete this.demWorkerSources[pe],Qe()}checkIfReady(pe,xe,Qe){Qe()}setReferrer(pe,xe){this.referrer=xe}spriteLoaded(pe,xe){this.isSpriteLoaded[pe]=xe;for(const Qe in this.workerSources[pe]){const vt=this.workerSources[pe][Qe];for(const Lt in vt)vt[Lt]instanceof s.VectorTileWorkerSource&&(vt[Lt].isSpriteLoaded=xe,vt[Lt].fire(new s.Event("isSpriteLoaded")))}}setImages(pe,xe,Qe){this.availableImages[pe]=xe;for(const vt in this.workerSources[pe]){const Lt=this.workerSources[pe][vt];for(const Zt in Lt)Lt[Zt].availableImages=xe}Qe()}enableTerrain(pe,xe,Qe){this.terrain=xe,Qe()}setProjection(pe,xe){this.projections[pe]=s.getProjection(xe)}setLayers(pe,xe,Qe){this.getLayerIndex(pe).replace(xe),Qe()}updateLayers(pe,xe,Qe){this.getLayerIndex(pe).update(xe.layers,xe.removedIds),Qe()}loadTile(pe,xe,Qe){const vt=this.enableTerrain?s.extend({enableTerrain:this.terrain},xe):xe;vt.projection=this.projections[pe]||this.defaultProjection,this.getWorkerSource(pe,xe.type,xe.source).loadTile(vt,Qe)}loadDEMTile(pe,xe,Qe){const vt=this.enableTerrain?s.extend({buildQuadTree:this.terrain},xe):xe;this.getDEMWorkerSource(pe,xe.source).loadTile(vt,Qe)}reloadTile(pe,xe,Qe){const vt=this.enableTerrain?s.extend({enableTerrain:this.terrain},xe):xe;vt.projection=this.projections[pe]||this.defaultProjection,this.getWorkerSource(pe,xe.type,xe.source).reloadTile(vt,Qe)}abortTile(pe,xe,Qe){this.getWorkerSource(pe,xe.type,xe.source).abortTile(xe,Qe)}removeTile(pe,xe,Qe){this.getWorkerSource(pe,xe.type,xe.source).removeTile(xe,Qe)}removeSource(pe,xe,Qe){if(!this.workerSources[pe]||!this.workerSources[pe][xe.type]||!this.workerSources[pe][xe.type][xe.source])return;const vt=this.workerSources[pe][xe.type][xe.source];delete this.workerSources[pe][xe.type][xe.source],void 0!==vt.removeSource?vt.removeSource(xe,Qe):Qe()}loadWorkerSource(pe,xe,Qe){try{this.self.importScripts(xe.url),Qe()}catch(vt){Qe(vt.toString())}}syncRTLPluginState(pe,xe,Qe){try{s.plugin.setState(xe);const vt=s.plugin.getPluginURL();if(s.plugin.isLoaded()&&!s.plugin.isParsed()&&null!=vt){this.self.importScripts(vt);const Lt=s.plugin.isParsed();Qe(Lt?void 0:new Error(`RTL Text Plugin failed to import scripts from ${vt}`),Lt)}}catch(vt){Qe(vt.toString())}}getAvailableImages(pe){let xe=this.availableImages[pe];return xe||(xe=[]),xe}getLayerIndex(pe){let xe=this.layerIndexes[pe];return xe||(xe=this.layerIndexes[pe]=new q),xe}getWorkerSource(pe,xe,Qe){return this.workerSources[pe]||(this.workerSources[pe]={}),this.workerSources[pe][xe]||(this.workerSources[pe][xe]={}),this.workerSources[pe][xe][Qe]||(this.workerSources[pe][xe][Qe]=new this.workerSourceTypes[xe]({send:(Lt,Zt,jt,Pt,Kt,In)=>{this.actor.send(Lt,Zt,jt,pe,Kt,In)},scheduler:this.actor.scheduler},this.getLayerIndex(pe),this.getAvailableImages(pe),this.isSpriteLoaded[pe])),this.workerSources[pe][xe][Qe]}getDEMWorkerSource(pe,xe){return this.demWorkerSources[pe]||(this.demWorkerSources[pe]={}),this.demWorkerSources[pe][xe]||(this.demWorkerSources[pe][xe]=new y),this.demWorkerSources[pe][xe]}enforceCacheSizeLimit(pe,xe){s.enforceCacheSizeLimit(xe)}getWorkerPerformanceMetrics(pe,xe,Qe){Qe(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new Vo(self)),Vo}),d(0,function(s){function Q(p,o){if(Array.isArray(p)){if(!Array.isArray(o)||p.length!==o.length)return!1;for(let c=0;c<p.length;c++)if(!Q(p[c],o[c]))return!1;return!0}if("object"==typeof p&&null!==p&&null!==o){if("object"!=typeof o||Object.keys(p).length!==Object.keys(o).length)return!1;for(const c in p)if(!Q(p[c],o[c]))return!1;return!0}return p===o}var ie=q;function q(p){return o=p,!(typeof window>"u"||typeof document>"u"||!(Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray)||!Function.prototype||!Function.prototype.bind||!(Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions)||!("JSON"in window&&"parse"in JSON&&"stringify"in JSON)||!function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var m,b,T=new Blob([""],{type:"text/javascript"}),I=URL.createObjectURL(T);try{b=new Worker(I),m=!0}catch{m=!1}return b&&b.terminate(),URL.revokeObjectURL(I),m}()||!("Uint8ClampedArray"in window)||!ArrayBuffer.isView||!function(){var m=document.createElement("canvas");m.width=m.height=1;var b=m.getContext("2d");if(!b)return!1;var T=b.getImageData(0,0,1,1);return T&&T.width===m.width}()||(void 0===y[c=o&&o.failIfMajorPerformanceCaveat]&&(y[c]=function(m){var b,I,O,N,T=(I=m,O=document.createElement("canvas"),(N=Object.create(q.webGLContextAttributes)).failIfMajorPerformanceCaveat=I,O.getContext("webgl",N)||O.getContext("experimental-webgl",N));if(!T)return!1;try{b=T.createShader(T.VERTEX_SHADER)}catch{return!1}return!(!b||T.isContextLost())&&(T.shaderSource(b,"void main() {}"),T.compileShader(b),!0===T.getShaderParameter(b,T.COMPILE_STATUS))}(c)),!y[c]||document.documentMode));var o,c}var y={};function fe(p,o,c){const m=s.window.document.createElement(p);return void 0!==o&&(m.className=o),c&&c.appendChild(m),m}function Se(p,o,c){const m=s.window.document.createElementNS("http://www.w3.org/2000/svg",p);for(const b of Object.keys(o))m.setAttributeNS(null,b,o[b]);return c&&c.appendChild(m),m}q.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const De=s.window.document&&s.window.document.documentElement.style,X=De&&void 0!==De.userSelect?"userSelect":"WebkitUserSelect";let se;function Ee(){De&&X&&(se=De[X],De[X]="none")}function _e(){De&&X&&(De[X]=se)}function be(p){p.preventDefault(),p.stopPropagation(),s.window.removeEventListener("click",be,!0)}function Re(){s.window.addEventListener("click",be,!0),s.window.setTimeout(()=>{s.window.removeEventListener("click",be,!0)},0)}function Ne(p,o){const c=p.getBoundingClientRect();return Je(p,c,o)}function qe(p,o){const c=p.getBoundingClientRect(),m=[];for(let b=0;b<o.length;b++)m.push(Je(p,c,o[b]));return m}function _t(p){return void 0!==s.window.InstallTrigger&&2===p.button&&p.ctrlKey&&s.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:p.button}function Je(p,o,c){const m=p.offsetWidth===o.width?1:p.offsetWidth/o.width;return new s.Point((c.clientX-o.left)*m,(c.clientY-o.top)*m)}function Me(p,o){var c=o[0],m=o[1],b=o[2],T=o[3],I=c*T-b*m;return I?(p[0]=T*(I=1/I),p[1]=-m*I,p[2]=-b*I,p[3]=c*I,p):null}function it(p){const{userImage:o}=p;return!!(o&&o.render&&o.render())&&(p.data.replace(new Uint8Array(o.data.buffer)),!0)}class Xe extends s.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new s.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(o){if(this.loaded!==o&&(this.loaded=o,o)){for(const{ids:c,callback:m}of this.requestors)this._notify(c,m);this.requestors=[]}}hasImage(o){return!!this.getImage(o)}getImage(o){return this.images[o]}addImage(o,c){this._validate(o,c)&&(this.images[o]=c)}_validate(o,c){let m=!0;return this._validateStretch(c.stretchX,c.data&&c.data.width)||(this.fire(new s.ErrorEvent(new Error(`Image "${o}" has invalid "stretchX" value`))),m=!1),this._validateStretch(c.stretchY,c.data&&c.data.height)||(this.fire(new s.ErrorEvent(new Error(`Image "${o}" has invalid "stretchY" value`))),m=!1),this._validateContent(c.content,c)||(this.fire(new s.ErrorEvent(new Error(`Image "${o}" has invalid "content" value`))),m=!1),m}_validateStretch(o,c){if(!o)return!0;let m=0;for(const b of o){if(b[0]<m||b[1]<b[0]||c<b[1])return!1;m=b[1]}return!0}_validateContent(o,c){return!(o&&(4!==o.length||o[0]<0||c.data.width<o[0]||o[1]<0||c.data.height<o[1]||o[2]<0||c.data.width<o[2]||o[3]<0||c.data.height<o[3]||o[2]<o[0]||o[3]<o[1]))}updateImage(o,c){c.version=this.images[o].version+1,this.images[o]=c,this.updatedImages[o]=!0}removeImage(o){const c=this.images[o];delete this.images[o],delete this.patterns[o],c.userImage&&c.userImage.onRemove&&c.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(o,c){let m=!0;if(!this.isLoaded())for(const b of o)this.images[b]||(m=!1);this.isLoaded()||m?this._notify(o,c):this.requestors.push({ids:o,callback:c})}_notify(o,c){const m={};for(const b of o){this.images[b]||this.fire(new s.Event("styleimagemissing",{id:b}));const T=this.images[b];T?m[b]={data:T.data.clone(),pixelRatio:T.pixelRatio,sdf:T.sdf,version:T.version,stretchX:T.stretchX,stretchY:T.stretchY,content:T.content,hasRenderCallback:!(!T.userImage||!T.userImage.render)}:s.warnOnce(`Image "${b}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}c(null,m)}getPixelSize(){const{width:o,height:c}=this.atlasImage;return{width:o,height:c}}getPattern(o){const c=this.patterns[o],m=this.getImage(o);if(!m)return null;if(c&&c.position.version===m.version)return c.position;if(c)c.position.version=m.version;else{const b={w:m.data.width+2,h:m.data.height+2,x:0,y:0},T=new s.ImagePosition(b,m);this.patterns[o]={bin:b,position:T}}return this._updatePatternAtlas(),this.patterns[o].position}bind(o){const c=o.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new s.Texture(o,this.atlasImage,c.RGBA),this.atlasTexture&&this.atlasTexture.bind(c.LINEAR,c.CLAMP_TO_EDGE)}_updatePatternAtlas(){const o=[];for(const T in this.patterns)o.push(this.patterns[T].bin);const{w:c,h:m}=s.potpack(o),b=this.atlasImage;b.resize({width:c||1,height:m||1});for(const T in this.patterns){const{bin:I}=this.patterns[T],O=I.x+1,N=I.y+1,H=this.images[T].data,$=H.width,ce=H.height;s.RGBAImage.copy(H,b,{x:0,y:0},{x:O,y:N},{width:$,height:ce}),s.RGBAImage.copy(H,b,{x:0,y:ce-1},{x:O,y:N-1},{width:$,height:1}),s.RGBAImage.copy(H,b,{x:0,y:0},{x:O,y:N+ce},{width:$,height:1}),s.RGBAImage.copy(H,b,{x:$-1,y:0},{x:O-1,y:N},{width:1,height:ce}),s.RGBAImage.copy(H,b,{x:0,y:0},{x:O+$,y:N},{width:1,height:ce})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(o){for(const c of o){if(this.callbackDispatchedThisFrame[c])continue;this.callbackDispatchedThisFrame[c]=!0;const m=this.images[c];it(m)&&this.updateImage(c,m)}}}const Te=new s.Properties({anchor:new s.DataConstantProperty(s.spec.light.anchor),position:new class{constructor(){this.specification=s.spec.light.position}possiblyEvaluate(p,o){return function([c,m,b]){const T=s.degToRad(m+90),I=s.degToRad(b);return{x:c*Math.cos(T)*Math.sin(I),y:c*Math.sin(T)*Math.sin(I),z:c*Math.cos(I),azimuthal:m,polar:b}}(p.expression.evaluate(o))}interpolate(p,o,c){return{x:s.number(p.x,o.x,c),y:s.number(p.y,o.y,c),z:s.number(p.z,o.z,c),azimuthal:s.number(p.azimuthal,o.azimuthal,c),polar:s.number(p.polar,o.polar,c)}}},color:new s.DataConstantProperty(s.spec.light.color),intensity:new s.DataConstantProperty(s.spec.light.intensity)});class ae extends s.Evented{constructor(o){super(),this._transitionable=new s.Transitionable(Te),this.setLight(o),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(o,c={}){if(!this._validate(s.validateLight,o,c))for(const m in o){const b=o[m];s.endsWith(m,"-transition")?this._transitionable.setTransition(m.slice(0,-11),b):this._transitionable.setValue(m,b)}}updateTransitions(o){this._transitioning=this._transitionable.transitioned(o,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(o){this.properties=this._transitioning.possiblyEvaluate(o)}_validate(o,c,m){return(!m||!1!==m.validate)&&s.emitValidationErrors(this,o.call(s.validateStyle,s.extend({value:c,style:{glyphs:!0,sprite:!0},styleSpec:s.spec})))}}const yt=new s.Properties({source:new s.DataConstantProperty(s.spec.terrain.source),exaggeration:new s.DataConstantProperty(s.spec.terrain.exaggeration)});let we=class extends s.Evented{constructor(p,o){super(),this._transitionable=new s.Transitionable(yt),this.set(p),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=o}get(){return this._transitionable.serialize()}set(p){for(const o in p){const c=p[o];s.endsWith(o,"-transition")?this._transitionable.setTransition(o.slice(0,-11),c):this._transitionable.setValue(o,c)}}updateTransitions(p){this._transitioning=this._transitionable.transitioned(p,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(p){this.properties=this._transitioning.possiblyEvaluate(p)}};function Ze(p,o,c,m){const b=s.smoothstep(45,65,c),[T,I]=Ae(p,m),O=s.length(o);let N=1-Math.min(1,Math.exp((O-T)/(I-T)*-6));return N*=N*N,N=Math.min(1,1.00747*N),N*b*p.alpha}function Ae(p,o){const c=.5/Math.tan(.5*o);return[p.range[0]+c,p.range[1]+c]}const ve=new s.Properties({range:new s.DataConstantProperty(s.spec.fog.range),color:new s.DataConstantProperty(s.spec.fog.color),"high-color":new s.DataConstantProperty(s.spec.fog["high-color"]),"space-color":new s.DataConstantProperty(s.spec.fog["space-color"]),"horizon-blend":new s.DataConstantProperty(s.spec.fog["horizon-blend"]),"star-intensity":new s.DataConstantProperty(s.spec.fog["star-intensity"])});class en extends s.Evented{constructor(o,c){super(),this._transitionable=new s.Transitionable(ve),this.set(o),this._transitioning=this._transitionable.untransitioned(),this._transform=c}get state(){const o=this._transform,c="globe"===o.projection.name,m=s.globeToMercatorTransition(o.zoom),b=this.properties.get("range"),T=[.5,3];return{range:c?[s.number(T[0],b[0],m),s.number(T[1],b[1],m)]:b,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(o,c={}){if(!this._validate(s.validateFog,o,c)){for(const m of Object.keys(s.spec.fog))o&&void 0===o[m]&&(o[m]=s.spec.fog[m].default);for(const m in o){const b=o[m];s.endsWith(m,"-transition")?this._transitionable.setTransition(m.slice(0,-11),b):this._transitionable.setValue(m,b)}}}getOpacity(o){if(!this._transform.projection.supportsFog)return 0;const c=this.properties&&this.properties.get("color")||1;return("globe"===this._transform.projection.name?1:s.smoothstep(45,65,o))*c.a}getOpacityAtLatLng(o,c){return this._transform.projection.supportsFog?function(m,b,T){const I=s.MercatorCoordinate.fromLngLat(b),O=T.elevation?T.elevation.getAtPointOrZero(I):0,N=[I.x,I.y,O];return s.transformMat4(N,N,T.mercatorFogMatrix),Ze(m,N,T.pitch,T._fov)}(this.state,o,c):0}getFovAdjustedRange(o){return this._transform.projection.supportsFog?Ae(this.state,o):[0,1]}updateTransitions(o){this._transitioning=this._transitionable.transitioned(o,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(o){this.properties=this._transitioning.possiblyEvaluate(o)}_validate(o,c,m){return(!m||!1!==m.validate)&&s.emitValidationErrors(this,o.call(s.validateStyle,s.extend({value:c,style:{glyphs:!0,sprite:!0},styleSpec:s.spec})))}}class dt{constructor(o,c){this.workerPool=o,this.actors=[],this.currentActor=0,this.id=s.uniqueId();const m=this.workerPool.acquire(this.id);for(let b=0;b<m.length;b++){const T=new dt.Actor(m[b],c,this.id);T.name=`Worker ${b}`,this.actors.push(T)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(o,c,m){s.asyncAll(this.actors,(b,T)=>{b.send(o,c,T)},m=m||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(o=>{o.remove()}),this.actors=[],this.workerPool.release(this.id)}}function mt(p,o,c){return o*(s.EXTENT/(p.tileSize*Math.pow(2,c-p.tileID.overscaledZ)))}dt.Actor=s.Actor;class lt{constructor(o,c,m,b){this.screenBounds=o,this.cameraPoint=c,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=m,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,b)}static createFromScreenPoints(o,c){let m,b;if(o instanceof s.Point||"number"==typeof o[0]){const T=s.Point.convert(o);m=[T],b=c.isPointAboveHorizon(T)}else{const T=s.Point.convert(o[0]),I=s.Point.convert(o[1]);m=[T,I],b=s.polygonizeBounds(T,I).every(O=>c.isPointAboveHorizon(O))}return new lt(m,c.getCameraPoint(),b,c)}isPointQuery(){return 1===this.screenBounds.length}bufferedScreenGeometry(o){return s.polygonizeBounds(this.screenBounds[0],1===this.screenBounds.length?this.screenBounds[0]:this.screenBounds[1],o)}bufferedCameraGeometry(o){const c=this.screenBounds[0],m=1===this.screenBounds.length?this.screenBounds[0].add(new s.Point(1,1)):this.screenBounds[1],b=s.polygonizeBounds(c,m,0,!1);return this.cameraPoint.y>m.y&&(this.cameraPoint.x>c.x&&this.cameraPoint.x<m.x?b.splice(3,0,this.cameraPoint):this.cameraPoint.x>=m.x?b[2]=this.cameraPoint:this.cameraPoint.x<=c.x&&(b[3]=this.cameraPoint)),s.bufferConvexPolygon(b,o)}bufferedCameraGeometryGlobe(o){const c=this.screenBounds[0],m=1===this.screenBounds.length?this.screenBounds[0].add(new s.Point(1,1)):this.screenBounds[1],b=s.polygonizeBounds(c,m,o),T=this.cameraPoint.clone();switch(3*((T.y>c.y)+(T.y>m.y))+((T.x>c.x)+(T.x>m.x))){case 0:b[0]=T,b[4]=T.clone();break;case 1:b.splice(1,0,T);break;case 2:b[1]=T;break;case 3:b.splice(4,0,T);break;case 5:b.splice(2,0,T);break;case 6:b[3]=T;break;case 7:b.splice(3,0,T);break;case 8:b[2]=T}return b}containsTile(o,c,m,b=0){const T=o.queryPadding/c._pixelsPerMercatorPixel+1,I=m?this._bufferedCameraMercator(T,c):this._bufferedScreenMercator(T,c);let O=o.tileID.wrap+(I.unwrapped?b:0);const N=I.polygon.map(nt=>s.getTilePoint(o.tileTransform,nt,O));if(!s.polygonIntersectsBox(N,0,0,s.EXTENT,s.EXTENT))return;O=o.tileID.wrap+(this.screenGeometryMercator.unwrapped?b:0);const H=this.screenGeometryMercator.polygon.map(nt=>s.getTileVec3(o.tileTransform,nt,O)),$=H.map(nt=>new s.Point(nt[0],nt[1])),ce=c.getFreeCameraOptions().position||new s.MercatorCoordinate(0,0,0),Ie=s.getTileVec3(o.tileTransform,ce,O),je=H.map(nt=>{const ue=s.sub(nt,nt,Ie);return s.normalize(ue,ue),new s.Ray(Ie,ue)}),Ke=mt(o,1,c.zoom)*c._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:$,tilespaceRays:je,bufferedTilespaceGeometry:N,bufferedTilespaceBounds:(Ye=s.getBounds(N),Ye.min.x=s.clamp(Ye.min.x,0,s.EXTENT),Ye.min.y=s.clamp(Ye.min.y,0,s.EXTENT),Ye.max.x=s.clamp(Ye.max.x,0,s.EXTENT),Ye.max.y=s.clamp(Ye.max.y,0,s.EXTENT),Ye),tile:o,tileID:o.tileID,pixelToTileUnitsFactor:Ke};var Ye}_bufferedScreenMercator(o,c){const m=Ve(o);if(this._screenRaycastCache[m])return this._screenRaycastCache[m];{let b;return b="globe"===c.projection.name?this._projectAndResample(this.bufferedScreenGeometry(o),c):{polygon:this.bufferedScreenGeometry(o).map(T=>c.pointCoordinate3D(T)),unwrapped:!0},this._screenRaycastCache[m]=b,b}}_bufferedCameraMercator(o,c){const m=Ve(o);if(this._cameraRaycastCache[m])return this._cameraRaycastCache[m];{let b;return b="globe"===c.projection.name?this._projectAndResample(this.bufferedCameraGeometryGlobe(o),c):{polygon:this.bufferedCameraGeometry(o).map(T=>c.pointCoordinate3D(T)),unwrapped:!0},this._cameraRaycastCache[m]=b,b}}_projectAndResample(o,c){const m=function(T,I){const O=s.multiply([],I.pixelMatrix,I.globeMatrix),N=[0,-s.GLOBE_RADIUS,0,1],H=[0,s.GLOBE_RADIUS,0,1],$=[0,0,0,1];s.transformMat4$1(N,N,O),s.transformMat4$1(H,H,O),s.transformMat4$1($,$,O);const ce=new s.Point(N[0]/N[3],N[1]/N[3]),Ie=new s.Point(H[0]/H[3],H[1]/H[3]),je=s.polygonContainsPoint(T,ce)&&N[3]<$[3],Ke=s.polygonContainsPoint(T,Ie)&&H[3]<$[3];if(!je&&!Ke)return null;const Ye=function(Rt,Yt,$t){for(let ln=1;ln<Rt.length;ln++){const Gn=xt(Yt.pointCoordinate3D(Rt[ln-1]).x),on=xt(Yt.pointCoordinate3D(Rt[ln]).x);if($t<0){if(Gn<on)return{idx:ln,t:-Gn/(on-1-Gn)}}else if(on<Gn)return{idx:ln,t:(1-Gn)/(on+1-Gn)}}return null}(T,I,je?-1:1);if(!Ye)return null;const{idx:nt,t:ue}=Ye;let $e=nt>1?ze(T.slice(0,nt),I):[],pt=nt<T.length?ze(T.slice(nt),I):[];$e=$e.map(Rt=>new s.Point(xt(Rt.x),Rt.y)),pt=pt.map(Rt=>new s.Point(xt(Rt.x),Rt.y));const ht=[...$e];0===ht.length&&ht.push(pt[pt.length-1]);const Ot=s.number(ht[ht.length-1].y,(0===pt.length?$e[0]:pt[0]).y,ue);let kt;return kt=je?[new s.Point(0,Ot),new s.Point(0,0),new s.Point(1,0),new s.Point(1,Ot)]:[new s.Point(1,Ot),new s.Point(1,1),new s.Point(0,1),new s.Point(0,Ot)],ht.push(...kt),0===pt.length?ht.push($e[0]):ht.push(...pt),{polygon:ht.map(Rt=>new s.MercatorCoordinate(Rt.x,Rt.y)),unwrapped:!1}}(o,c);if(m)return m;const b=function(T,I){let O=!1,N=-1/0,H=0;for(let ce=0;ce<T.length-1;ce++)T[ce].x>N&&(N=T[ce].x,H=ce);for(let ce=0;ce<T.length-1;ce++){const Ie=(H+ce)%(T.length-1),je=T[Ie],Ke=T[Ie+1];Math.abs(je.x-Ke.x)>.5&&(je.x<Ke.x?(je.x+=1,0===Ie&&(T[T.length-1].x+=1)):(Ke.x+=1,Ie+1===T.length-1&&(T[0].x+=1)),O=!0)}const $=s.mercatorXfromLng(I.center.lng);return O&&$<Math.abs($-1)&&T.forEach(ce=>{ce.x-=1}),{polygon:T,unwrapped:O}}(ze(o,c).map(T=>new s.Point(xt(T.x),T.y)),c);return{polygon:b.polygon.map(T=>new s.MercatorCoordinate(T.x,T.y)),unwrapped:b.unwrapped}}}function ze(p,o){return s.resample(p,c=>{const m=o.pointCoordinate3D(c);c.x=m.x,c.y=m.y},1/256)}function xt(p){return p<0?1+p%1:p%1}function Ve(p){return 100*p|0}function gt(p,o,c,m,b){const T=function(I,O){if(I)return b(I);if(O){p.url&&O.tiles&&p.tiles&&delete p.tiles;const N=s.pick(s.extend(O,p),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);O.vector_layers&&(N.vectorLayers=O.vector_layers,N.vectorLayerIds=N.vectorLayers.map(H=>H.id)),N.tiles=o.canonicalizeTileset(N,p.url),b(null,N)}};return p.url?s.getJSON(o.transformRequest(o.normalizeSourceURL(p.url,null,c,m),s.ResourceType.Source),T):s.exported.frame(()=>T(null,p))}class Be{constructor(o,c,m){this.bounds=s.LngLatBounds.convert(this.validateBounds(o)),this.minzoom=c||0,this.maxzoom=m||24}validateBounds(o){return Array.isArray(o)&&4===o.length?[Math.max(-180,o[0]),Math.max(-90,o[1]),Math.min(180,o[2]),Math.min(90,o[3])]:[-180,-90,180,90]}contains(o){const c=Math.pow(2,o.z),m=Math.floor(s.mercatorXfromLng(this.bounds.getWest())*c),b=Math.floor(s.mercatorYfromLat(this.bounds.getNorth())*c),T=Math.ceil(s.mercatorXfromLng(this.bounds.getEast())*c),I=Math.ceil(s.mercatorYfromLat(this.bounds.getSouth())*c);return o.x>=m&&o.x<T&&o.y>=b&&o.y<I}}class Bt{constructor(o,c,m){this.context=o;const b=o.gl;this.buffer=b.createBuffer(),this.dynamicDraw=!!m,this.context.unbindVAO(),o.bindElementBuffer.set(this.buffer),b.bufferData(b.ELEMENT_ARRAY_BUFFER,c.arrayBuffer,this.dynamicDraw?b.DYNAMIC_DRAW:b.STATIC_DRAW),this.dynamicDraw||c.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(o){const c=this.context.gl;this.context.unbindVAO(),this.bind(),c.bufferSubData(c.ELEMENT_ARRAY_BUFFER,0,o.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Wt={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class wn{constructor(o,c,m,b){this.length=c.length,this.attributes=m,this.itemSize=c.bytesPerElement,this.dynamicDraw=b,this.context=o;const T=o.gl;this.buffer=T.createBuffer(),o.bindVertexBuffer.set(this.buffer),T.bufferData(T.ARRAY_BUFFER,c.arrayBuffer,this.dynamicDraw?T.DYNAMIC_DRAW:T.STATIC_DRAW),this.dynamicDraw||c.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(o){const c=this.context.gl;this.bind(),c.bufferSubData(c.ARRAY_BUFFER,0,o.arrayBuffer)}enableAttributes(o,c){for(let m=0;m<this.attributes.length;m++){const b=c.attributes[this.attributes[m].name];void 0!==b&&o.enableVertexAttribArray(b)}}setVertexAttribPointers(o,c,m){for(let b=0;b<this.attributes.length;b++){const T=this.attributes[b],I=c.attributes[T.name];void 0!==I&&o.vertexAttribPointer(I,T.components,o[Wt[T.type]],!1,this.itemSize,T.offset+this.itemSize*(m||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Xt{constructor(o){this.gl=o.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(o){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class mn extends Xt{getDefault(){return s.Color.transparent}set(o){const c=this.current;(o.r!==c.r||o.g!==c.g||o.b!==c.b||o.a!==c.a||this.dirty)&&(this.gl.clearColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)}}class an extends Xt{getDefault(){return 1}set(o){(o!==this.current||this.dirty)&&(this.gl.clearDepth(o),this.current=o,this.dirty=!1)}}class Vt extends Xt{getDefault(){return 0}set(o){(o!==this.current||this.dirty)&&(this.gl.clearStencil(o),this.current=o,this.dirty=!1)}}class St extends Xt{getDefault(){return[!0,!0,!0,!0]}set(o){const c=this.current;(o[0]!==c[0]||o[1]!==c[1]||o[2]!==c[2]||o[3]!==c[3]||this.dirty)&&(this.gl.colorMask(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)}}class st extends Xt{getDefault(){return!0}set(o){(o!==this.current||this.dirty)&&(this.gl.depthMask(o),this.current=o,this.dirty=!1)}}class qt extends Xt{getDefault(){return 255}set(o){(o!==this.current||this.dirty)&&(this.gl.stencilMask(o),this.current=o,this.dirty=!1)}}class dn extends Xt{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(o){const c=this.current;(o.func!==c.func||o.ref!==c.ref||o.mask!==c.mask||this.dirty)&&(this.gl.stencilFunc(o.func,o.ref,o.mask),this.current=o,this.dirty=!1)}}class Sn extends Xt{getDefault(){const o=this.gl;return[o.KEEP,o.KEEP,o.KEEP]}set(o){const c=this.current;(o[0]!==c[0]||o[1]!==c[1]||o[2]!==c[2]||this.dirty)&&(this.gl.stencilOp(o[0],o[1],o[2]),this.current=o,this.dirty=!1)}}class zt extends Xt{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const c=this.gl;o?c.enable(c.STENCIL_TEST):c.disable(c.STENCIL_TEST),this.current=o,this.dirty=!1}}class gi extends Xt{getDefault(){return[0,1]}set(o){const c=this.current;(o[0]!==c[0]||o[1]!==c[1]||this.dirty)&&(this.gl.depthRange(o[0],o[1]),this.current=o,this.dirty=!1)}}class $i extends Xt{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const c=this.gl;o?c.enable(c.DEPTH_TEST):c.disable(c.DEPTH_TEST),this.current=o,this.dirty=!1}}class Ci extends Xt{getDefault(){return this.gl.LESS}set(o){(o!==this.current||this.dirty)&&(this.gl.depthFunc(o),this.current=o,this.dirty=!1)}}class Ji extends Xt{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const c=this.gl;o?c.enable(c.BLEND):c.disable(c.BLEND),this.current=o,this.dirty=!1}}class Hi extends Xt{getDefault(){const o=this.gl;return[o.ONE,o.ZERO]}set(o){const c=this.current;(o[0]!==c[0]||o[1]!==c[1]||this.dirty)&&(this.gl.blendFunc(o[0],o[1]),this.current=o,this.dirty=!1)}}class Fi extends Xt{getDefault(){return s.Color.transparent}set(o){const c=this.current;(o.r!==c.r||o.g!==c.g||o.b!==c.b||o.a!==c.a||this.dirty)&&(this.gl.blendColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)}}class ii extends Xt{getDefault(){return this.gl.FUNC_ADD}set(o){(o!==this.current||this.dirty)&&(this.gl.blendEquation(o),this.current=o,this.dirty=!1)}}class mi extends Xt{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const c=this.gl;o?c.enable(c.CULL_FACE):c.disable(c.CULL_FACE),this.current=o,this.dirty=!1}}class xn extends Xt{getDefault(){return this.gl.BACK}set(o){(o!==this.current||this.dirty)&&(this.gl.cullFace(o),this.current=o,this.dirty=!1)}}class Qt extends Xt{getDefault(){return this.gl.CCW}set(o){(o!==this.current||this.dirty)&&(this.gl.frontFace(o),this.current=o,this.dirty=!1)}}let Mt,ge=class extends Xt{getDefault(){return null}set(p){(p!==this.current||this.dirty)&&(this.gl.useProgram(p),this.current=p,this.dirty=!1)}};class ct extends Xt{getDefault(){return this.gl.TEXTURE0}set(o){(o!==this.current||this.dirty)&&(this.gl.activeTexture(o),this.current=o,this.dirty=!1)}}class Gt extends Xt{getDefault(){const o=this.gl;return[0,0,o.drawingBufferWidth,o.drawingBufferHeight]}set(o){const c=this.current;(o[0]!==c[0]||o[1]!==c[1]||o[2]!==c[2]||o[3]!==c[3]||this.dirty)&&(this.gl.viewport(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)}}class pn extends Xt{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const c=this.gl;c.bindFramebuffer(c.FRAMEBUFFER,o),this.current=o,this.dirty=!1}}class Gi extends Xt{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const c=this.gl;c.bindRenderbuffer(c.RENDERBUFFER,o),this.current=o,this.dirty=!1}}class ri extends Xt{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const c=this.gl;c.bindTexture(c.TEXTURE_2D,o),this.current=o,this.dirty=!1}}class Vo extends Xt{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const c=this.gl;c.bindBuffer(c.ARRAY_BUFFER,o),this.current=o,this.dirty=!1}}class ut extends Xt{getDefault(){return null}set(o){const c=this.gl;c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,o),this.current=o,this.dirty=!1}}class pe extends Xt{constructor(o){super(o),this.vao=o.extVertexArrayObject}getDefault(){return null}set(o){this.vao&&(o!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(o),this.current=o,this.dirty=!1)}}class xe extends Xt{getDefault(){return 4}set(o){if(o===this.current&&!this.dirty)return;const c=this.gl;c.pixelStorei(c.UNPACK_ALIGNMENT,o),this.current=o,this.dirty=!1}}class Qe extends Xt{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const c=this.gl;c.pixelStorei(c.UNPACK_PREMULTIPLY_ALPHA_WEBGL,o),this.current=o,this.dirty=!1}}class vt extends Xt{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const c=this.gl;c.pixelStorei(c.UNPACK_FLIP_Y_WEBGL,o),this.current=o,this.dirty=!1}}class Lt extends Xt{constructor(o,c){super(o),this.context=o,this.parent=c}getDefault(){return null}}class Zt extends Lt{setDirty(){this.dirty=!0}set(o){if(o===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const c=this.gl;c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,o,0),this.current=o,this.dirty=!1}}class jt extends Lt{attachment(){return this.gl.DEPTH_ATTACHMENT}set(o){if(o===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const c=this.gl;c.framebufferRenderbuffer(c.FRAMEBUFFER,this.attachment(),c.RENDERBUFFER,o),this.current=o,this.dirty=!1}}class Pt extends jt{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class Kt{constructor(o,c,m,b){this.context=o,this.width=c,this.height=m;const T=this.framebuffer=o.gl.createFramebuffer();this.colorAttachment=new Zt(o,T),b&&(this.depthAttachment=new jt(o,T))}destroy(){const o=this.context.gl,c=this.colorAttachment.get();if(c&&o.deleteTexture(c),this.depthAttachment){const m=this.depthAttachment.get();m&&o.deleteRenderbuffer(m)}o.deleteFramebuffer(this.framebuffer)}}class In{constructor(o,c=!1){if(this.gl=o,this.isWebGL2=c,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),c){const m=o;this.extVertexArrayObject={createVertexArrayOES:m.createVertexArray.bind(o),deleteVertexArrayOES:m.deleteVertexArray.bind(o),bindVertexArrayOES:m.bindVertexArray.bind(o)}}this.clearColor=new mn(this),this.clearDepth=new an(this),this.clearStencil=new Vt(this),this.colorMask=new St(this),this.depthMask=new st(this),this.stencilMask=new qt(this),this.stencilFunc=new dn(this),this.stencilOp=new Sn(this),this.stencilTest=new zt(this),this.depthRange=new gi(this),this.depthTest=new $i(this),this.depthFunc=new Ci(this),this.blend=new Ji(this),this.blendFunc=new Hi(this),this.blendColor=new Fi(this),this.blendEquation=new ii(this),this.cullFace=new mi(this),this.cullFaceSide=new xn(this),this.frontFace=new Qt(this),this.program=new ge(this),this.activeTexture=new ct(this),this.viewport=new Gt(this),this.bindFramebuffer=new pn(this),this.bindRenderbuffer=new Gi(this),this.bindTexture=new ri(this),this.bindVertexBuffer=new Vo(this),this.bindElementBuffer=new ut(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new pe(this),this.pixelStoreUnpack=new xe(this),this.pixelStoreUnpackPremultiplyAlpha=new Qe(this),this.pixelStoreUnpackFlipY=new vt(this),this.extTextureFilterAnisotropic=o.getExtension("EXT_texture_filter_anisotropic")||o.getExtension("MOZ_EXT_texture_filter_anisotropic")||o.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=o.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureFilterAnisotropicForceOff=!1,this.extStandardDerivativesForceOff=!1,this.extDebugRendererInfo=o.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=o.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=o.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),c||(this.extTextureHalfFloat=o.getExtension("OES_texture_half_float")),(c||this.extTextureHalfFloat&&o.getExtension("OES_texture_half_float_linear"))&&(this.extRenderToTextureHalfFloat=o.getExtension("EXT_color_buffer_half_float")),this.extStandardDerivatives=c||o.getExtension("OES_standard_derivatives"),this.extTimerQuery=o.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=o.getParameter(o.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(o,c){return new Bt(this,o,c)}createVertexBuffer(o,c,m){return new wn(this,o,c,m)}createRenderbuffer(o,c,m){const b=this.gl,T=b.createRenderbuffer();return this.bindRenderbuffer.set(T),b.renderbufferStorage(b.RENDERBUFFER,o,c,m),this.bindRenderbuffer.set(null),T}createFramebuffer(o,c,m){return new Kt(this,o,c,m)}clear({color:o,depth:c,stencil:m}){const b=this.gl;let T=0;o&&(T|=b.COLOR_BUFFER_BIT,this.clearColor.set(o),this.colorMask.set([!0,!0,!0,!0])),void 0!==c&&(T|=b.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(c),this.depthMask.set(!0)),void 0!==m&&(T|=b.STENCIL_BUFFER_BIT,this.clearStencil.set(m),this.stencilMask.set(255)),b.clear(T)}setCullFace(o){!1===o.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(o.mode),this.frontFace.set(o.frontFace))}setDepthMode(o){o.func!==this.gl.ALWAYS||o.mask?(this.depthTest.set(!0),this.depthFunc.set(o.func),this.depthMask.set(o.mask),this.depthRange.set(o.range)):this.depthTest.set(!1)}setStencilMode(o){o.test.func!==this.gl.ALWAYS||o.mask?(this.stencilTest.set(!0),this.stencilMask.set(o.mask),this.stencilOp.set([o.fail,o.depthFail,o.pass]),this.stencilFunc.set({func:o.test.func,ref:o.ref,mask:o.test.mask})):this.stencilTest.set(!1)}setColorMode(o){Q(o.blendFunction,s.ColorMode.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(o.blendFunction),this.blendColor.set(o.blendColor)),this.colorMask.set(o.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class et extends s.Evented{constructor(o,c,m,b){if(super(),this.id=o,this.dispatcher=m,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,s.extend(this,s.pick(c,["url","scheme","tileSize","promoteId"])),this._options=s.extend({type:"vector"},c),this._collectResourceTiming=c.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(b),this._tileWorkers={},this._deduped=new s.DedupedRequest}load(o){this._loaded=!1,this.fire(new s.Event("dataloading",{dataType:"source"}));const c=Array.isArray(this.map._language)?this.map._language.join():this.map._language,m=this.map._worldview;this._tileJSONRequest=gt(this._options,this.map._requestManager,c,m,(b,T)=>{this._tileJSONRequest=null,this._loaded=!0,b?(c&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${c}`),m&&2!==m.length&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${m}`),this.fire(new s.ErrorEvent(b))):T&&(s.extend(this,T),T.bounds&&(this.tileBounds=new Be(T.bounds,this.minzoom,this.maxzoom)),s.postTurnstileEvent(T.tiles,this.map._requestManager._customAccessToken),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"}))),o&&o(b)})}loaded(){return this._loaded}hasTile(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)}onAdd(o){this.map=o,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(o){return this._options.tiles=o,this.reload(),this}setUrl(o){return this.url=o,this._options.url=o,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return s.extend({},this._options)}loadTile(o,c){const m=this.map._requestManager.normalizeTileURL(o.tileID.canonical.url(this.tiles,this.scheme)),b={request:this.map._requestManager.transformRequest(m,s.ResourceType.Tile),data:void 0,uid:o.uid,tileID:o.tileID,tileZoom:o.tileZoom,zoom:o.tileID.overscaledZ,tileSize:this.tileSize*o.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:s.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:o.isSymbolTile};if(b.request.collectResourceTiming=this._collectResourceTiming,o.actor&&"expired"!==o.state)"loading"===o.state?o.reloadCallback=c:o.request=o.actor.send("reloadTile",b,T.bind(this));else if(o.actor=this._tileWorkers[m]=this._tileWorkers[m]||this.dispatcher.getActor(),this.dispatcher.ready)o.request=o.actor.send("loadTile",b,T.bind(this),void 0,!0);else{const I=s.loadVectorTile.call({deduped:this._deduped},b,(O,N)=>{O||!N?T.call(this,O):(b.data={cacheControl:N.cacheControl,expires:N.expires,rawData:N.rawData.slice(0)},o.actor&&o.actor.send("loadTile",b,T.bind(this),void 0,!0))},!0);o.request={cancel:I}}function T(I,O){return delete o.request,o.aborted?c(null):I&&404!==I.status?c(I):(O&&O.resourceTiming&&(o.resourceTiming=O.resourceTiming),this.map._refreshExpiredTiles&&O&&o.setExpiryData(O),o.loadVectorData(O,this.map.painter),s.cacheEntryPossiblyAdded(this.dispatcher),c(null),void(o.reloadCallback&&(this.loadTile(o,o.reloadCallback),o.reloadCallback=null)))}}abortTile(o){o.request&&(o.request.cancel(),delete o.request),o.actor&&o.actor.send("abortTile",{uid:o.uid,type:this.type,source:this.id})}unloadTile(o){o.unloadVectorData(),o.actor&&o.actor.send("removeTile",{uid:o.uid,type:this.type,source:this.id})}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class Ue extends s.Evented{constructor(o,c,m,b){super(),this.id=o,this.dispatcher=m,this.setEventedParent(b),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=s.extend({type:"raster"},c),s.extend(this,s.pick(c,["url","scheme","tileSize"]))}load(o){this._loaded=!1,this.fire(new s.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=gt(this._options,this.map._requestManager,null,null,(c,m)=>{this._tileJSONRequest=null,this._loaded=!0,c?this.fire(new s.ErrorEvent(c)):m&&(s.extend(this,m),m.bounds&&(this.tileBounds=new Be(m.bounds,this.minzoom,this.maxzoom)),s.postTurnstileEvent(m.tiles),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"}))),o&&o(c)})}loaded(){return this._loaded}onAdd(o){this.map=o,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(o){return this._options.tiles=o,this.reload(),this}setUrl(o){return this.url=o,this._options.url=o,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return s.extend({},this._options)}hasTile(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)}loadTile(o,c){const m=s.exported.devicePixelRatio>=2,b=this.map._requestManager.normalizeTileURL(o.tileID.canonical.url(this.tiles,this.scheme),m,this.tileSize);o.request=s.getImage(this.map._requestManager.transformRequest(b,s.ResourceType.Tile),(T,I,O,N)=>(delete o.request,o.aborted?(o.state="unloaded",c(null)):T?(o.state="errored",c(T)):I?(this.map._refreshExpiredTiles&&o.setExpiryData({cacheControl:O,expires:N}),o.setTexture(I,this.map.painter),o.state="loaded",s.cacheEntryPossiblyAdded(this.dispatcher),void c(null)):c(null)))}static loadTileData(o,c,m){o.setTexture(c,m)}static unloadTileData(o,c){o.texture&&c.saveTileTexture(o.texture)}abortTile(o,c){o.request&&(o.request.cancel(),delete o.request),c()}unloadTile(o,c){o.texture&&this.map.painter.saveTileTexture(o.texture),c()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}function Y(p,o,c,m,b,T,I,O){const N=[p,c,b,o,m,T,1,1,1],H=[I,O,1],$=s.adjoint([],N),[ce,Ie,je]=s.transformMat3(H,H,s.transpose($,$));return s.multiply$1(N,[ce,0,0,0,Ie,0,0,0,je],N)}class me extends s.Evented{constructor(o,c,m,b){super(),this.id=o,this.dispatcher=m,this.coordinates=c.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(b),this.options=c,this._dirty=!1}load(o,c){this._loaded=c||!1,this.fire(new s.Event("dataloading",{dataType:"source"})),this.url=this.options.url,this._imageRequest=s.getImage(this.map._requestManager.transformRequest(this.url,s.ResourceType.Image),(m,b)=>{if(this._imageRequest=null,this._loaded=!0,m)this.fire(new s.ErrorEvent(m));else if(b){const{HTMLImageElement:T}=s.window;this.image=b instanceof T?s.exported.getImageData(b):b,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,o&&(this.coordinates=o),this._finishLoading()}})}loaded(){return this._loaded}updateImage(o){return this.image&&o.url?(this._imageRequest&&o.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=o.url,this.load(o.coordinates,this._loaded),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(o){this.map=o,this.load()}onRemove(){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),this.texture&&this.texture.destroy()}setCoordinates(o){this.coordinates=o,this._boundsArray=void 0;const c=o.map(s.MercatorCoordinate.fromLngLat);return this.tileID=function(m){let b=1/0,T=1/0,I=-1/0,O=-1/0;for(const ce of m)b=Math.min(b,ce.x),T=Math.min(T,ce.y),I=Math.max(I,ce.x),O=Math.max(O,ce.y);const N=Math.max(I-b,O-T),H=Math.max(0,Math.floor(-Math.log(N)/Math.LN2)),$=Math.pow(2,H);return new s.CanonicalTileID(H,Math.floor((b+I)/2*$),Math.floor((T+O)/2*$))}(c),this.minzoom=this.maxzoom=this.tileID.z,this.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0}_prepareData(o){for(const N in this.tiles){const H=this.tiles[N];"loaded"!==H.state&&(H.state="loaded",H.texture=this.texture)}if(this._boundsArray)return;const c=s.tileTransform(this.tileID,this.map.transform.projection),[m,b,T,I]=this.coordinates.map(N=>{const H=c.projection.project(N[0],N[1]);return s.getTilePoint(c,H)._round()});this.perspectiveTransform=function(N,H,$,ce,Ie,je,Ke,Ye,nt,ue){const $e=Y(0,0,N,0,0,H,N,H),pt=Y($,ce,Ie,je,Ke,Ye,nt,ue);return s.multiply$1(pt,s.adjoint($e,$e),pt),[pt[6]/pt[8]*N/s.EXTENT,pt[7]/pt[8]*H/s.EXTENT]}(this.width,this.height,m.x,m.y,b.x,b.y,I.x,I.y,T.x,T.y);const O=this._boundsArray=new s.StructArrayLayout4i8;O.emplaceBack(m.x,m.y,0,0),O.emplaceBack(b.x,b.y,s.EXTENT,0),O.emplaceBack(I.x,I.y,0,s.EXTENT),O.emplaceBack(T.x,T.y,s.EXTENT,s.EXTENT),this.boundsBuffer&&this.boundsBuffer.destroy(),this.boundsBuffer=o.createVertexBuffer(O,s.boundsAttributes.members),this.boundsSegments=s.SegmentVector.simpleSegment(0,0,4,2)}prepare(){if(0===Object.keys(this.tiles).length||!this.image)return;const o=this.map.painter.context,c=o.gl;this._dirty&&(this.texture?this.texture.update(this.image):(this.texture=new s.Texture(o,this.image,c.RGBA),this.texture.bind(c.LINEAR,c.CLAMP_TO_EDGE)),this._dirty=!1),this._prepareData(o)}loadTile(o,c){this.tileID&&this.tileID.equals(o.tileID.canonical)?(this.tiles[String(o.tileID.wrap)]=o,o.buckets={},c(null)):(o.state="errored",c(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}const Ge={vector:et,raster:Ue,"raster-dem":class extends Ue{constructor(p,o,c,m){super(p,o,c,m),this.type="raster-dem",this.maxzoom=22,this._options=s.extend({type:"raster-dem"},o),this.encoding=o.encoding||"mapbox"}loadTile(p,o){const c=this.map._requestManager.normalizeTileURL(p.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function m(b,T){b&&(p.state="errored",o(b)),T&&(p.dem=T,p.dem.onDeserialize(),p.needsHillshadePrepare=!0,p.needsDEMTextureUpload=!0,p.state="loaded",o(null))}p.request=s.getImage(this.map._requestManager.transformRequest(c,s.ResourceType.Tile),function(b,T,I,O){if(delete p.request,p.aborted)p.state="unloaded",o(null);else if(b)p.state="errored",o(b);else if(T){this.map._refreshExpiredTiles&&p.setExpiryData({cacheControl:I,expires:O});const N=s.window.ImageBitmap&&T instanceof s.window.ImageBitmap&&(null==Mt&&(Mt=s.window.OffscreenCanvas&&new s.window.OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof s.window.createImageBitmap),Mt),H=1-(T.width-s.prevPowerOfTwo(T.width))/2;H<1||p.neighboringTiles||(p.neighboringTiles=this._getNeighboringTiles(p.tileID));const $=N?T:s.exported.getImageData(T,H),ce={uid:p.uid,coord:p.tileID,source:this.id,rawImageData:$,encoding:this.encoding,padding:H};p.actor&&"expired"!==p.state||(p.actor=this.dispatcher.getActor(),p.actor.send("loadDEMTile",ce,m.bind(this),void 0,!0))}}.bind(this))}_getNeighboringTiles(p){const o=p.canonical,c=Math.pow(2,o.z),m=(o.x-1+c)%c,b=0===o.x?p.wrap-1:p.wrap,T=(o.x+1+c)%c,I=o.x+1===c?p.wrap+1:p.wrap,O={};return O[new s.OverscaledTileID(p.overscaledZ,b,o.z,m,o.y).key]={backfilled:!1},O[new s.OverscaledTileID(p.overscaledZ,I,o.z,T,o.y).key]={backfilled:!1},o.y>0&&(O[new s.OverscaledTileID(p.overscaledZ,b,o.z,m,o.y-1).key]={backfilled:!1},O[new s.OverscaledTileID(p.overscaledZ,p.wrap,o.z,o.x,o.y-1).key]={backfilled:!1},O[new s.OverscaledTileID(p.overscaledZ,I,o.z,T,o.y-1).key]={backfilled:!1}),o.y+1<c&&(O[new s.OverscaledTileID(p.overscaledZ,b,o.z,m,o.y+1).key]={backfilled:!1},O[new s.OverscaledTileID(p.overscaledZ,p.wrap,o.z,o.x,o.y+1).key]={backfilled:!1},O[new s.OverscaledTileID(p.overscaledZ,I,o.z,T,o.y+1).key]={backfilled:!1}),O}unloadTile(p){p.demTexture&&this.map.painter.saveTileTexture(p.demTexture),p.fbo&&(p.fbo.destroy(),delete p.fbo),p.dem&&delete p.dem,delete p.neighboringTiles,p.state="unloaded"}},geojson:class extends s.Evented{constructor(p,o,c,m){super(),this.id=p,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=c.getActor(),this.setEventedParent(m),this._data=o.data,this._options=s.extend({},o),this._collectResourceTiming=o.collectResourceTiming,void 0!==o.maxzoom&&(this.maxzoom=o.maxzoom),o.type&&(this.type=o.type),o.attribution&&(this.attribution=o.attribution),this.promoteId=o.promoteId;const b=s.EXTENT/this.tileSize;this.workerOptions=s.extend({source:this.id,cluster:o.cluster||!1,geojsonVtOptions:{buffer:(void 0!==o.buffer?o.buffer:128)*b,tolerance:(void 0!==o.tolerance?o.tolerance:.375)*b,extent:s.EXTENT,maxZoom:this.maxzoom,lineMetrics:o.lineMetrics||!1,generateId:o.generateId||!1},superclusterOptions:{maxZoom:void 0!==o.clusterMaxZoom?o.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,o.clusterMinPoints||2),extent:s.EXTENT,radius:(void 0!==o.clusterRadius?o.clusterRadius:50)*b,log:!1,generateId:o.generateId||!1},clusterProperties:o.clusterProperties,filter:o.filter},o.workerOptions)}onAdd(p){this.map=p,this.setData(this._data)}setData(p){return this._data=p,this._updateWorkerData(),this}getClusterExpansionZoom(p,o){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:p,source:this.id},o),this}getClusterChildren(p,o){return this.actor.send("geojson.getClusterChildren",{clusterId:p,source:this.id},o),this}getClusterLeaves(p,o,c,m){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:p,limit:o,offset:c},m),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new s.Event("dataloading",{dataType:"source"})),this._loaded=!1;const p=s.extend({},this.workerOptions),o=this._data;"string"==typeof o?(p.request=this.map._requestManager.transformRequest(s.exported.resolveURL(o),s.ResourceType.Source),p.request.collectResourceTiming=this._collectResourceTiming):p.data=JSON.stringify(o),this._pendingLoad=this.actor.send(`${this.type}.loadData`,p,(c,m)=>{if(this._loaded=!0,this._pendingLoad=null,c)this.fire(new s.ErrorEvent(c));else{const b={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&m&&m.resourceTiming&&m.resourceTiming[this.id]&&(b.resourceTiming=m.resourceTiming[this.id]),this.fire(new s.Event("data",b)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(p,o){const c=p.actor?"reloadTile":"loadTile";p.actor=this.actor,p.request=this.actor.send(c,{type:this.type,uid:p.uid,tileID:p.tileID,tileZoom:p.tileZoom,zoom:p.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:s.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},(m,b)=>(delete p.request,p.unloadVectorData(),p.aborted?o(null):m?o(m):(p.loadVectorData(b,this.map.painter,"reloadTile"===c),o(null))),void 0,"loadTile"===c)}abortTile(p){p.request&&(p.request.cancel(),delete p.request),p.aborted=!0}unloadTile(p){p.unloadVectorData(),this.actor.send("removeTile",{uid:p.uid,type:this.type,source:this.id})}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return s.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends me{constructor(p,o,c,m){super(p,o,c,m),this.roundZoom=!0,this.type="video",this.options=o}load(){this._loaded=!1;const p=this.options;this.urls=[];for(const o of p.urls)this.urls.push(this.map._requestManager.transformRequest(o,s.ResourceType.Source).url);s.getVideo(this.urls,(o,c)=>{this._loaded=!0,o?this.fire(new s.ErrorEvent(o)):c&&(this.video=c,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(p){if(this.video){const o=this.video.seekable;p<o.start(0)||p>o.end(0)?this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${o.start(0)} and ${o.end(0)}-second mark.`))):this.video.currentTime=p}}getVideo(){return this.video}onAdd(p){this.map||(this.map=p,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(0===Object.keys(this.tiles).length||this.video.readyState<2)return;const p=this.map.painter.context,o=p.gl;this.texture?this.video.paused||(this.texture.bind(o.LINEAR,o.CLAMP_TO_EDGE),o.texSubImage2D(o.TEXTURE_2D,0,0,0,o.RGBA,o.UNSIGNED_BYTE,this.video)):(this.texture=new s.Texture(p,this.video,o.RGBA),this.texture.bind(o.LINEAR,o.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(p)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:me,canvas:class extends me{constructor(p,o,c,m){super(p,o,c,m),o.coordinates?Array.isArray(o.coordinates)&&4===o.coordinates.length&&!o.coordinates.some(b=>!Array.isArray(b)||2!==b.length||b.some(T=>"number"!=typeof T))||this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${p}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${p}`,null,'missing required property "coordinates"'))),o.animate&&"boolean"!=typeof o.animate&&this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${p}`,null,'optional "animate" property must be a boolean value'))),o.canvas?"string"==typeof o.canvas||o.canvas instanceof s.window.HTMLCanvasElement||this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${p}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${p}`,null,'missing required property "canvas"'))),this.options=o,this.animate=void 0===o.animate||o.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof s.window.HTMLCanvasElement?this.options.canvas:s.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new s.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(p){this.map=p,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let p=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,p=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,p=!0),this._hasInvalidDimensions()||0===Object.keys(this.tiles).length)return;const o=this.map.painter.context;this.texture?(p||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new s.Texture(o,this.canvas,o.gl.RGBA,{premultiply:!0}),this._prepareData(o)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const p of[this.canvas.width,this.canvas.height])if(isNaN(p)||p<=0)return!0;return!1}},custom:class extends s.Evented{constructor(p,o,c,m){super(),this.id=p,this.type="custom",this._dataType="raster",this._dispatcher=c,this._implementation=o,this.setEventedParent(m),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new s.ErrorEvent(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new s.ErrorEvent(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new Be(this._implementation.bounds,this.minzoom,this.maxzoom)),o.update=this._update.bind(this),o.clearTiles=this._clearTiles.bind(this),o.coveringTiles=this._coveringTiles.bind(this),s.extend(this,s.pick(o,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return s.pick(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new s.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(p){this._map=p,this._loaded=!1,this.fire(new s.Event("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(p),this.load()}onRemove(p){this._implementation.onRemove&&this._implementation.onRemove(p)}hasTile(p){if(this._implementation.hasTile){const{x:o,y:c,z:m}=p.canonical;return this._implementation.hasTile({x:o,y:c,z:m})}return!this.tileBounds||this.tileBounds.contains(p.canonical)}loadTile(p,o){const{x:c,y:m,z:b}=p.tileID.canonical,T=new s.window.AbortController;p.request=Promise.resolve(this._implementation.loadTile({x:c,y:m,z:b},{signal:T.signal})).then(function(I){return delete p.request,p.aborted?(p.state="unloaded",o(null)):void 0===I?(p.state="errored",o(null)):null===I?(this.loadTileData(p,{width:this.tileSize,height:this.tileSize,data:null}),p.state="loaded",o(null)):(O=I)instanceof s.window.ImageData||O instanceof s.window.HTMLCanvasElement||O instanceof s.window.ImageBitmap||O instanceof s.window.HTMLImageElement?(this.loadTileData(p,I),p.state="loaded",void o(null)):(p.state="errored",o(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)));var O}.bind(this)).catch(I=>{20!==I.code&&(p.state="errored",o(I))}),p.request.cancel=()=>T.abort()}loadTileData(p,o){Ue.loadTileData(p,o,this._map.painter)}unloadTileData(p){Ue.unloadTileData(p,this._map.painter)}unloadTile(p,o){if(this.unloadTileData(p),this._implementation.unloadTile){const{x:c,y:m,z:b}=p.tileID.canonical;this._implementation.unloadTile({x:c,y:m,z:b})}o()}abortTile(p,o){p.request&&p.request.cancel&&(p.request.cancel(),delete p.request),o()}hasTransition(){return!1}_coveringTiles(){return this._map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(p=>({x:p.canonical.x,y:p.canonical.y,z:p.canonical.z}))}_clearTiles(){this._map.style._clearSource(this.id)}_update(){this.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"}))}}},Ft=function(p,o,c,m){const b=new Ge[o.type](p,o,c,m);if(b.id!==p)throw new Error(`Expected Source id to be ${p} instead of ${b.id}`);return s.bindAll(["load","abort","unload","serialize","prepare"],b),b};function gn(p,o){const c=s.identity([]);return s.scale(c,c,[.5*p.width,.5*-p.height,1]),s.translate(c,c,[1,-1,0]),s.multiply(c,c,p.calculateProjMatrix(o.toUnwrapped())),Float32Array.from(c)}function ei(p,o,c,m,b,T,I,O=!1){const N=p.tilesIn(m,I,O);N.sort(Ii);const H=[];for(const ce of N)H.push({wrappedTileID:ce.tile.tileID.wrapped().key,queryResults:ce.tile.queryRenderedFeatures(o,c,p._state,ce,b,T,gn(p.transform,ce.tile.tileID),O)});const $=function(ce){const Ie={},je={};for(const Ke of ce){const Ye=Ke.queryResults,nt=Ke.wrappedTileID,ue=je[nt]=je[nt]||{};for(const $e in Ye){const pt=Ye[$e],ht=ue[$e]=ue[$e]||{},Ot=Ie[$e]=Ie[$e]||[];for(const kt of pt)ht[kt.featureIndex]||(ht[kt.featureIndex]=!0,Ot.push(kt))}}return Ie}(H);for(const ce in $)$[ce].forEach(Ie=>{const je=Ie.feature,Ke=je.layer;Ke&&"background"!==Ke.type&&"sky"!==Ke.type&&(je.source=Ke.source,Ke["source-layer"]&&(je.sourceLayer=Ke["source-layer"]),je.state=void 0!==je.id?p.getFeatureState(Ke["source-layer"],je.id):{})});return $}function wi(p,o){const c=p.getRenderableIds().map(T=>p.getTileByID(T)),m=[],b={};for(let T=0;T<c.length;T++){const I=c[T],O=I.tileID.canonical.key;b[O]||(b[O]=!0,I.querySourceFeatures(m,o))}return m}function Ii(p,o){const c=p.tileID,m=o.tileID;return c.overscaledZ-m.overscaledZ||c.canonical.y-m.canonical.y||c.wrap-m.wrap||c.canonical.x-m.canonical.x}function Zi(){return null!=Io.workerClass?new Io.workerClass:new s.window.Worker(Io.workerUrl)}const fo="mapboxgl_preloaded_worker_pool";class to{constructor(){this.active={}}acquire(o){if(!this.workers)for(this.workers=[];this.workers.length<to.workerCount;)this.workers.push(new Zi);return this.active[o]=!0,this.workers.slice()}release(o){delete this.active[o],0===this.numActive()&&(this.workers.forEach(c=>{c.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[fo]}numActive(){return Object.keys(this.active).length}}let nn;function bt(){return nn||(nn=new to),nn}function Et(p,o){const c={};for(const m in p)"ref"!==m&&(c[m]=p[m]);return s.refProperties.forEach(m=>{m in o&&(c[m]=o[m])}),c}function Nn(p){p=p.slice();const o=Object.create(null);for(let c=0;c<p.length;c++)o[p[c].id]=p[c];for(let c=0;c<p.length;c++)"ref"in p[c]&&(p[c]=Et(p[c],o[p[c].ref]));return p}to.workerCount=2;const Pn={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setProjection:"setProjection"};function oi(p,o,c){c.push({command:Pn.addSource,args:[p,o[p]]})}function ti(p,o,c){o.push({command:Pn.removeSource,args:[p]}),c[p]=!0}function qi(p,o,c,m){ti(p,c,m),oi(p,o,c)}function xi(p,o,c){let m;for(m in p[c])if(p[c].hasOwnProperty(m)&&"data"!==m&&!Q(p[c][m],o[c][m]))return!1;for(m in o[c])if(o[c].hasOwnProperty(m)&&"data"!==m&&!Q(p[c][m],o[c][m]))return!1;return!0}function go(p,o,c,m,b,T){let I;for(I in o=o||{},p=p||{})p.hasOwnProperty(I)&&(Q(p[I],o[I])||c.push({command:T,args:[m,I,o[I],b]}));for(I in o)o.hasOwnProperty(I)&&!p.hasOwnProperty(I)&&(Q(p[I],o[I])||c.push({command:T,args:[m,I,o[I],b]}))}function So(p){return p.id}function Go(p,o){return p[o.id]=o,p}class uo{constructor(o,c){this.reset(o,c)}reset(o,c){this.points=o||[],this._distances=[0];for(let m=1;m<this.points.length;m++)this._distances[m]=this._distances[m-1]+this.points[m].dist(this.points[m-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(c||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(o){if(1===this.points.length)return this.points[0];o=s.clamp(o,0,1);let c=1,m=this._distances[c];const b=o*this.paddedLength+this.padding;for(;m<b&&c<this._distances.length;)m=this._distances[++c];const T=c-1,I=this._distances[T],O=m-I,N=O>0?(b-I)/O:0;return this.points[T].mult(1-N).add(this.points[c].mult(N))}}class oo{constructor(o,c,m){const b=this.boxCells=[],T=this.circleCells=[];this.xCellCount=Math.ceil(o/m),this.yCellCount=Math.ceil(c/m);for(let I=0;I<this.xCellCount*this.yCellCount;I++)b.push([]),T.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=o,this.height=c,this.xScale=this.xCellCount/o,this.yScale=this.yCellCount/c,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(o,c,m,b,T){this._forEachCell(c,m,b,T,this._insertBoxCell,this.boxUid++),this.boxKeys.push(o),this.bboxes.push(c),this.bboxes.push(m),this.bboxes.push(b),this.bboxes.push(T)}insertCircle(o,c,m,b){this._forEachCell(c-b,m-b,c+b,m+b,this._insertCircleCell,this.circleUid++),this.circleKeys.push(o),this.circles.push(c),this.circles.push(m),this.circles.push(b)}_insertBoxCell(o,c,m,b,T,I){this.boxCells[T].push(I)}_insertCircleCell(o,c,m,b,T,I){this.circleCells[T].push(I)}_query(o,c,m,b,T,I){if(m<0||o>this.width||b<0||c>this.height)return!T&&[];const O=[];if(o<=0&&c<=0&&this.width<=m&&this.height<=b){if(T)return!0;for(let N=0;N<this.boxKeys.length;N++)O.push({key:this.boxKeys[N],x1:this.bboxes[4*N],y1:this.bboxes[4*N+1],x2:this.bboxes[4*N+2],y2:this.bboxes[4*N+3]});for(let N=0;N<this.circleKeys.length;N++){const H=this.circles[3*N],$=this.circles[3*N+1],ce=this.circles[3*N+2];O.push({key:this.circleKeys[N],x1:H-ce,y1:$-ce,x2:H+ce,y2:$+ce})}return I?O.filter(I):O}return this._forEachCell(o,c,m,b,this._queryCell,O,{hitTest:T,seenUids:{box:{},circle:{}}},I),T?O.length>0:O}_queryCircle(o,c,m,b,T){const I=o-m,O=o+m,N=c-m,H=c+m;if(O<0||I>this.width||H<0||N>this.height)return!b&&[];const $=[];return this._forEachCell(I,N,O,H,this._queryCellCircle,$,{hitTest:b,circle:{x:o,y:c,radius:m},seenUids:{box:{},circle:{}}},T),b?$.length>0:$}query(o,c,m,b,T){return this._query(o,c,m,b,!1,T)}hitTest(o,c,m,b,T){return this._query(o,c,m,b,!0,T)}hitTestCircle(o,c,m,b){return this._queryCircle(o,c,m,!0,b)}_queryCell(o,c,m,b,T,I,O,N){const H=O.seenUids,$=this.boxCells[T];if(null!==$){const Ie=this.bboxes;for(const je of $)if(!H.box[je]){H.box[je]=!0;const Ke=4*je;if(o<=Ie[Ke+2]&&c<=Ie[Ke+3]&&m>=Ie[Ke+0]&&b>=Ie[Ke+1]&&(!N||N(this.boxKeys[je]))){if(O.hitTest)return I.push(!0),!0;I.push({key:this.boxKeys[je],x1:Ie[Ke],y1:Ie[Ke+1],x2:Ie[Ke+2],y2:Ie[Ke+3]})}}}const ce=this.circleCells[T];if(null!==ce){const Ie=this.circles;for(const je of ce)if(!H.circle[je]){H.circle[je]=!0;const Ke=3*je;if(this._circleAndRectCollide(Ie[Ke],Ie[Ke+1],Ie[Ke+2],o,c,m,b)&&(!N||N(this.circleKeys[je]))){if(O.hitTest)return I.push(!0),!0;{const Ye=Ie[Ke],nt=Ie[Ke+1],ue=Ie[Ke+2];I.push({key:this.circleKeys[je],x1:Ye-ue,y1:nt-ue,x2:Ye+ue,y2:nt+ue})}}}}}_queryCellCircle(o,c,m,b,T,I,O,N){const H=O.circle,$=O.seenUids,ce=this.boxCells[T];if(null!==ce){const je=this.bboxes;for(const Ke of ce)if(!$.box[Ke]){$.box[Ke]=!0;const Ye=4*Ke;if(this._circleAndRectCollide(H.x,H.y,H.radius,je[Ye+0],je[Ye+1],je[Ye+2],je[Ye+3])&&(!N||N(this.boxKeys[Ke])))return I.push(!0),!0}}const Ie=this.circleCells[T];if(null!==Ie){const je=this.circles;for(const Ke of Ie)if(!$.circle[Ke]){$.circle[Ke]=!0;const Ye=3*Ke;if(this._circlesCollide(je[Ye],je[Ye+1],je[Ye+2],H.x,H.y,H.radius)&&(!N||N(this.circleKeys[Ke])))return I.push(!0),!0}}}_forEachCell(o,c,m,b,T,I,O,N){const H=this._convertToXCellCoord(o),$=this._convertToYCellCoord(c),ce=this._convertToXCellCoord(m),Ie=this._convertToYCellCoord(b);for(let je=H;je<=ce;je++)for(let Ke=$;Ke<=Ie;Ke++)if(T.call(this,o,c,m,b,this.xCellCount*Ke+je,I,O,N))return}_convertToXCellCoord(o){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(o*this.xScale)))}_convertToYCellCoord(o){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(o*this.yScale)))}_circlesCollide(o,c,m,b,T,I){const O=b-o,N=T-c,H=m+I;return H*H>O*O+N*N}_circleAndRectCollide(o,c,m,b,T,I,O){const N=(I-b)/2,H=Math.abs(o-(b+N));if(H>N+m)return!1;const $=(O-T)/2,ce=Math.abs(c-(T+$));if(ce>$+m)return!1;if(H<=N||ce<=$)return!0;const Ie=H-N,je=ce-$;return Ie*Ie+je*je<=m*m}}const Ai={unknown:0,flipRequired:1,flipNotRequired:2},ho=Math.tan(85*Math.PI/180);function tn(p,o,c,m,b,T,I){const O=s.create();if(c)if("globe"===T.name){const N=s.calculateGlobeLabelMatrix(b,o);s.multiply(O,O,N)}else{const N=Me([],I);O[0]=N[0],O[1]=N[1],O[4]=N[2],O[5]=N[3],m||s.rotateZ(O,O,b.angle)}else s.multiply(O,b.labelPlaneMatrix,p);return O}function Qo(p,o,c,m,b,T,I){const O=tn(p,o,c,m,b,T,I);return"globe"===T.name&&c||(O[2]=O[6]=O[10]=O[14]=0),O}function xo(p,o,c,m,b,T,I){if(c){if("globe"===T.name){const O=tn(p,o,c,m,b,T,I);return s.invert(O,O),s.multiply(O,p,O),O}{const O=s.clone(p),N=s.identity([]);return N[0]=I[0],N[1]=I[1],N[4]=I[2],N[5]=I[3],s.multiply(O,O,N),m||s.rotateZ(O,O,-b.angle),O}}return b.glCoordMatrix}function Ki(p,o,c,m){const b=[p,o,c,1];c?s.transformMat4$1(b,b,m):tt(b,b,m);const T=b[3];return b[0]/=T,b[1]/=T,b[2]/=T,b}function gr(p,o){return Math.min(.5+p/o*.5,1.5)}function bo(p,o){const c=p[0]/p[3],m=p[1]/p[3];return c>=-o[0]&&c<=o[0]&&m>=-o[1]&&m<=o[1]}function Zr(p,o,c,m,b,T,I,O,N,H){const $=c.transform,ce=m?p.textSizeData:p.iconSizeData,Ie=s.evaluateSizeForZoom(ce,c.transform.zoom),je="globe"===$.projection.name,Ke=[256/c.width*2+1,256/c.height*2+1],Ye=m?p.text.dynamicLayoutVertexArray:p.icon.dynamicLayoutVertexArray;Ye.clear();let nt=null;je&&(nt=m?p.text.globeExtVertexArray:p.icon.globeExtVertexArray);const ue=p.lineVertexArray,$e=m?p.text.placedSymbolArray:p.icon.placedSymbolArray,pt=c.transform.width/c.transform.height;let ht,Ot=!1;for(let kt=0;kt<$e.length;kt++){const Rt=$e.get(kt),{numGlyphs:Yt,writingMode:$t}=Rt;if($t!==s.WritingMode.vertical||Ot||ht===s.WritingMode.horizontal||(Ot=!0),ht=$t,(Rt.hidden||$t===s.WritingMode.vertical)&&!Ot){Le(Yt,Ye);continue}Ot=!1;const ln=new s.Point(Rt.tileAnchorX,Rt.tileAnchorY);let{x:Gn,y:on,z:An}=$.projection.projectTilePoint(ln.x,ln.y,H.canonical);if(N){const[Vi,_i,Oi]=N(ln);Gn+=Vi,on+=_i,An+=Oi}const hn=[Gn,on,An,1];if(s.transformMat4$1(hn,hn,o),!bo(hn,Ke)){Le(Yt,Ye);continue}const jn=gr(c.transform.cameraToCenterDistance,hn[3]),cn=s.evaluateSizeForFeature(ce,Ie,Rt),Mn=I?cn/jn:cn*jn,Vn=Ki(Gn,on,An,b);if(Vn[3]<=0){Le(Yt,Ye);continue}let Bn={};const qn=I?null:N,Ti=Qn(Rt,Mn,!1,O,o,b,T,p.glyphOffsetArray,ue,Ye,nt,Vn,ln,Bn,pt,qn,$.projection,H,I);Ot=Ti.useVertical,qn&&Ti.needsFlipping&&(Bn={}),(Ti.notEnoughRoom||Ot||Ti.needsFlipping&&Qn(Rt,Mn,!0,O,o,b,T,p.glyphOffsetArray,ue,Ye,nt,Vn,ln,Bn,pt,qn,$.projection,H,I).notEnoughRoom)&&Le(Yt,Ye)}m?(p.text.dynamicLayoutVertexBuffer.updateData(Ye),nt&&p.text.globeExtVertexBuffer.updateData(nt)):(p.icon.dynamicLayoutVertexBuffer.updateData(Ye),nt&&p.icon.globeExtVertexBuffer.updateData(nt))}function Mr(p,o,c,m,b,T,I,O,N,H,$,ce,Ie,je,Ke,Ye){const{lineStartIndex:nt,glyphStartIndex:ue,segment:$e}=O,pt=ue+O.numGlyphs,ht=nt+O.lineLength,Ot=o.getoffsetX(ue),kt=o.getoffsetX(pt-1),Rt=rt(p*Ot,c,m,b,T,I,$e,nt,ht,N,H,$,ce,Ie,!0,je,Ke,Ye);if(!Rt)return null;const Yt=rt(p*kt,c,m,b,T,I,$e,nt,ht,N,H,$,ce,Ie,!0,je,Ke,Ye);return Yt?{first:Rt,last:Yt}:null}function kr(p,o,c,m){return p===s.WritingMode.horizontal&&Math.abs(m)>Math.abs(c)?{useVertical:!0}:p===s.WritingMode.vertical?m>0?{needsFlipping:!0}:null:o!==Ai.unknown&&(0===(b=c)||Math.abs(m/b)>ho)?o===Ai.flipRequired?{needsFlipping:!0}:null:c<0?{needsFlipping:!0}:null;var b}function Qn(p,o,c,m,b,T,I,O,N,H,$,ce,Ie,je,Ke,Ye,nt,ue,$e){const pt=o/24,ht=p.lineOffsetX*pt,Ot=p.lineOffsetY*pt,{lineStartIndex:kt,glyphStartIndex:Rt,numGlyphs:Yt,segment:$t,writingMode:ln,flipState:Gn}=p,on=kt+p.lineLength,An=hn=>{if($){const[Vn,Bn,qn]=hn.up,Ti=H.length;s.updateGlobeVertexNormal($,Ti+0,Vn,Bn,qn),s.updateGlobeVertexNormal($,Ti+1,Vn,Bn,qn),s.updateGlobeVertexNormal($,Ti+2,Vn,Bn,qn),s.updateGlobeVertexNormal($,Ti+3,Vn,Bn,qn)}const[jn,cn,Mn]=hn.point;s.addDynamicAttributes(H,jn,cn,Mn,hn.angle)};if(Yt>1){const hn=Mr(pt,O,ht,Ot,c,ce,Ie,p,N,T,je,Ye,!1,nt,ue,$e);if(!hn)return{notEnoughRoom:!0};if(m&&!c){let[jn,cn,Mn]=hn.first.point,[Vn,Bn,qn]=hn.last.point;[jn,cn]=Ki(jn,cn,Mn,I),[Vn,Bn]=Ki(Vn,Bn,qn,I);const Ti=kr(ln,Gn,(Vn-jn)*Ke,Bn-cn);if(p.flipState=Ti&&Ti.needsFlipping?Ai.flipRequired:Ai.flipNotRequired,Ti)return Ti}An(hn.first);for(let jn=Rt+1;jn<Rt+Yt-1;jn++){const cn=rt(pt*O.getoffsetX(jn),ht,Ot,c,ce,Ie,$t,kt,on,N,T,je,Ye,!1,!1,nt,ue,$e);if(!cn)return H.length-=4*(jn-Rt),{notEnoughRoom:!0};An(cn)}An(hn.last)}else{if(m&&!c){const jn=Ki(Ie.x,Ie.y,0,b),cn=kt+$t+1,Mn=new s.Point(N.getx(cn),N.gety(cn)),Vn=Ki(Mn.x,Mn.y,0,b),Bn=Vn[3]>0?Vn:ye(Ie,Mn,jn,1,b,void 0,nt,ue.canonical),qn=kr(ln,Gn,(Bn[0]-jn[0])*Ke,Bn[1]-jn[1]);if(p.flipState=qn&&qn.needsFlipping?Ai.flipRequired:Ai.flipNotRequired,qn)return qn}const hn=rt(pt*O.getoffsetX(Rt),ht,Ot,c,ce,Ie,$t,kt,on,N,T,je,Ye,!1,!1,nt,ue,$e);if(!hn)return{notEnoughRoom:!0};An(hn)}return{}}function Ui(p,o,c,m,b){const{x:T,y:I,z:O}=m.projectTilePoint(p.x,p.y,o);if(!b)return Ki(T,I,O,c);const[N,H,$]=b(p);return Ki(T+N,I+H,O+$,c)}function ye(p,o,c,m,b,T,I,O){const N=Ui(p.sub(o)._unit()._add(p),O,b,I,T);return s.sub(N,c,N),s.normalize(N,N),s.scaleAndAdd(N,c,N,m)}function rt(p,o,c,m,b,T,I,O,N,H,$,ce,Ie,je,Ke,Ye,nt,ue){const $e=m?p-o:p+o;let pt=$e>0?1:-1,ht=0;m&&(pt*=-1,ht=Math.PI),pt<0&&(ht+=Math.PI);let Ot=O+I+(pt>0?0:1)|0,kt=b,Rt=b,Yt=0,$t=0;const ln=Math.abs($e),Gn=[],on=[];let An=T,hn=An;const jn=()=>ye(hn,An,Rt,ln-Yt+1,$,Ie,Ye,nt.canonical);for(;Yt+$t<=ln;){if(Ot+=pt,Ot<O||Ot>=N)return null;if(Rt=kt,hn=An,Gn.push(Rt),je&&on.push(hn),An=new s.Point(H.getx(Ot),H.gety(Ot)),kt=ce[Ot],!kt){const Oi=Ui(An,nt.canonical,$,Ye,Ie);kt=Oi[3]>0?ce[Ot]=Oi:jn()}Yt+=$t,$t=s.distance(Rt,kt)}Ke&&Ie&&(ce[Ot]&&(kt=jn(),$t=s.distance(Rt,kt)),ce[Ot]=kt);const cn=(ln-Yt)/$t,Mn=An.sub(hn)._mult(cn)._add(hn),Vn=s.sub([],kt,Rt),Bn=s.scaleAndAdd([],Rt,Vn,cn);let qn=[0,0,1],Ti=Vn[0],Vi=Vn[1];if(ue&&(qn=Ye.upVector(nt.canonical,Mn.x,Mn.y),0!==qn[0]||0!==qn[1]||1!==qn[2])){const Oi=[qn[2],0,-qn[0]],po=s.cross([],qn,Oi);s.normalize(Oi,Oi),s.normalize(po,po),Ti=s.dot(Vn,Oi),Vi=s.dot(Vn,po)}if(c){const Oi=s.cross([],qn,Vn);s.normalize(Oi,Oi),s.scaleAndAdd(Bn,Bn,Oi,c*pt)}const _i=ht+Math.atan2(Vi,Ti);return Gn.push(Bn),je&&on.push(Mn),{point:Bn,angle:_i,path:Gn,tilePath:on,up:qn}}function Le(p,o){const c=o.length,m=c+4*p;o.resize(m),o.float32.fill(-1/0,4*c,4*m)}function tt(p,o,c){const m=o[0],b=o[1];return p[0]=c[0]*m+c[4]*b+c[12],p[1]=c[1]*m+c[5]*b+c[13],p[3]=c[3]*m+c[7]*b+c[15],p}const Nt=100;class Ut{constructor(o,c,m=new oo(o.width+200,o.height+200,25),b=new oo(o.width+200,o.height+200,25)){this.transform=o,this.grid=m,this.ignoredGrid=b,this.pitchfactor=Math.cos(o._pitch)*o.cameraToCenterDistance,this.screenRightBoundary=o.width+Nt,this.screenBottomBoundary=o.height+Nt,this.gridRightBoundary=o.width+200,this.gridBottomBoundary=o.height+200,this.fogState=c}placeCollisionBox(o,c,m,b,T,I,O,N){let H=m.projectedAnchorX,$=m.projectedAnchorY,ce=m.projectedAnchorZ;const Ie=m.elevation,je=m.tileID,Ke=o.getProjection();if(Ie&&je){const[kt,Rt,Yt]=Ke.upVector(je.canonical,m.tileAnchorX,m.tileAnchorY),$t=Ke.upVectorScale(je.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;H+=kt*Ie*$t,$+=Rt*Ie*$t,ce+=Yt*Ie*$t}const Ye=this.projectAndGetPerspectiveRatio(O,H,$,ce,m.tileID,"globe"===Ke.name||!!Ie||this.transform.pitch>0,Ke),nt=I*Ye.perspectiveRatio,ue=(m.x1*c+b.x-m.padding)*nt+Ye.point.x,$e=(m.y1*c+b.y-m.padding)*nt+Ye.point.y,pt=(m.x2*c+b.x+m.padding)*nt+Ye.point.x,ht=(m.y2*c+b.y+m.padding)*nt+Ye.point.y,Ot=Ye.perspectiveRatio<=.55||Ye.occluded;return!this.isInsideGrid(ue,$e,pt,ht)||!T&&this.grid.hitTest(ue,$e,pt,ht,N)||Ot?{box:[],offscreen:!1,occluded:Ye.occluded}:{box:[ue,$e,pt,ht],offscreen:this.isOffscreen(ue,$e,pt,ht),occluded:!1}}placeCollisionCircles(o,c,m,b,T,I,O,N,H,$,ce,Ie,je,Ke,Ye){const nt=[],ue=this.transform.elevation,$e=o.getProjection(),pt=ue?ue.getAtTileOffsetFunc(Ye,this.transform.center.lat,this.transform.worldSize,$e):null,ht=new s.Point(m.tileAnchorX,m.tileAnchorY);let{x:Ot,y:kt,z:Rt}=$e.projectTilePoint(ht.x,ht.y,Ye.canonical);if(pt){const[Mn,Vn,Bn]=pt(ht);Ot+=Mn,kt+=Vn,Rt+=Bn}const Yt="globe"===$e.name,$t=this.projectAndGetPerspectiveRatio(O,Ot,kt,Rt,Ye,Yt||!!ue||this.transform.pitch>0,$e),{perspectiveRatio:ln}=$t,Gn=(ce?I/ln:I*ln)/s.ONE_EM,on=Ki(Ot,kt,Rt,N),An=$t.signedDistanceFromCamera>0?Mr(Gn,T,m.lineOffsetX*Gn,m.lineOffsetY*Gn,!1,on,ht,m,b,N,{},ue&&!ce?pt:null,ce&&!!ue,$e,Ye,ce):null;let hn=!1,jn=!1,cn=!0;if(An&&!$t.occluded){const Mn=.5*je*ln+Ke,Vn=new s.Point(-100,-100),Bn=new s.Point(this.screenRightBoundary,this.screenBottomBoundary),qn=new uo,{first:Ti,last:Vi}=An,_i=Ti.path.length;let Oi=[];for(let bi=_i-1;bi>=1;bi--)Oi.push(Ti.path[bi]);for(let bi=1;bi<Vi.path.length;bi++)Oi.push(Vi.path[bi]);const po=2.5*Mn;H&&(Oi=Oi.map(([bi,Fo,Bo],No)=>(pt&&!Yt&&(Bo=pt(No<_i-1?Ti.tilePath[_i-1-No]:Vi.tilePath[No-_i+2])[2]),Ki(bi,Fo,Bo,H))),Oi.some(bi=>bi[3]<=0)&&(Oi=[]));let mo=[];if(Oi.length>0){let bi=1/0,Fo=-1/0,Bo=1/0,No=-1/0;for(const zo of Oi)bi=Math.min(bi,zo[0]),Bo=Math.min(Bo,zo[1]),Fo=Math.max(Fo,zo[0]),No=Math.max(No,zo[1]);Fo>=Vn.x&&bi<=Bn.x&&No>=Vn.y&&Bo<=Bn.y&&(mo=[Oi.map(zo=>new s.Point(zo[0],zo[1]))],(bi<Vn.x||Fo>Bn.x||Bo<Vn.y||No>Bn.y)&&(mo=s.clipLine(mo,Vn.x,Vn.y,Bn.x,Bn.y)))}for(const bi of mo){qn.reset(bi,.25*Mn);let Fo=0;Fo=qn.length<=.5*Mn?1:Math.ceil(qn.paddedLength/po)+1;for(let Bo=0;Bo<Fo;Bo++){const No=Bo/Math.max(Fo-1,1),zo=qn.lerp(No),gs=zo.x+Nt,Yr=zo.y+Nt;nt.push(gs,Yr,Mn,0);const _s=gs-Mn,Qa=Yr-Mn,yr=gs+Mn,ar=Yr+Mn;if(cn=cn&&this.isOffscreen(_s,Qa,yr,ar),jn=jn||this.isInsideGrid(_s,Qa,yr,ar),!c&&this.grid.hitTestCircle(gs,Yr,Mn,Ie)&&(hn=!0,!$))return{circles:[],offscreen:!1,collisionDetected:hn,occluded:!1}}}}return{circles:!$&&hn||!jn?[]:nt,offscreen:cn,collisionDetected:hn,occluded:$t.occluded}}queryRenderedSymbols(o){if(0===o.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};const c=[];let m=1/0,b=1/0,T=-1/0,I=-1/0;for(const $ of o){const ce=new s.Point($.x+Nt,$.y+Nt);m=Math.min(m,ce.x),b=Math.min(b,ce.y),T=Math.max(T,ce.x),I=Math.max(I,ce.y),c.push(ce)}const O=this.grid.query(m,b,T,I).concat(this.ignoredGrid.query(m,b,T,I)),N={},H={};for(const $ of O){const ce=$.key;if(void 0===N[ce.bucketInstanceId]&&(N[ce.bucketInstanceId]={}),N[ce.bucketInstanceId][ce.featureIndex])continue;const Ie=[new s.Point($.x1,$.y1),new s.Point($.x2,$.y1),new s.Point($.x2,$.y2),new s.Point($.x1,$.y2)];s.polygonIntersectsPolygon(c,Ie)&&(N[ce.bucketInstanceId][ce.featureIndex]=!0,void 0===H[ce.bucketInstanceId]&&(H[ce.bucketInstanceId]=[]),H[ce.bucketInstanceId].push(ce.featureIndex))}return H}insertCollisionBox(o,c,m,b,T){(c?this.ignoredGrid:this.grid).insert({bucketInstanceId:m,featureIndex:b,collisionGroupID:T},o[0],o[1],o[2],o[3])}insertCollisionCircles(o,c,m,b,T){const I=c?this.ignoredGrid:this.grid,O={bucketInstanceId:m,featureIndex:b,collisionGroupID:T};for(let N=0;N<o.length;N+=4)I.insertCircle(O,o[N],o[N+1],o[N+2])}projectAndGetPerspectiveRatio(o,c,m,b,T,I,O){const N=[c,m,b,1];let H=!1;b||this.transform.pitch>0?(s.transformMat4$1(N,N,o),this.fogState&&T&&"globe"!==O.name&&(H=function(Ie,je,Ke,Ye,nt,ue){const $e=ue.calculateFogTileMatrix(nt),pt=[je,Ke,Ye];return s.transformMat4(pt,pt,$e),Ze(Ie,pt,ue.pitch,ue._fov)}(this.fogState,c,m,b,T.toUnwrapped(),this.transform)>.9)):tt(N,N,o);const $=N[3];return{point:new s.Point((N[0]/$+1)/2*this.transform.width+Nt,(-N[1]/$+1)/2*this.transform.height+Nt),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(O)/$*.5,1.5),signedDistanceFromCamera:$,occluded:I&&N[2]>$||H}}isOffscreen(o,c,m,b){return m<Nt||o>=this.screenRightBoundary||b<Nt||c>this.screenBottomBoundary}isInsideGrid(o,c,m,b){return m>=0&&o<this.gridRightBoundary&&b>=0&&c<this.gridBottomBoundary}getViewportMatrix(){const o=s.identity([]);return s.translate(o,o,[-100,-100,0]),o}}function _n(p,o,c){const m=o.createTileMatrix(p,p.worldSize,c.toUnwrapped());return s.multiply(new Float32Array(16),p.projMatrix,m)}function Cn(p,o,c){if(o.projection.name===c.projection.name)return p.projMatrix;const m=c.clone();return m.setProjection(o.projection),_n(m,o.getProjection(),p)}function vn(p,o,c){return o.name===c.projection.name?p.projMatrix:_n(c,o,p)}class On{constructor(o,c,m,b){this.opacity=o?Math.max(0,Math.min(1,o.opacity+(o.placed?c:-c))):b&&m?1:0,this.placed=m}isHidden(){return 0===this.opacity&&!this.placed}}class di{constructor(o,c,m,b,T,I=!1){this.text=new On(o?o.text:null,c,m,T),this.icon=new On(o?o.icon:null,c,b,T),this.clipped=I}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Di{constructor(o,c,m,b=!1){this.text=o,this.icon=c,this.skipFade=m,this.clipped=b}}class Bi{constructor(){this.invProjMatrix=s.create(),this.viewportMatrix=s.create(),this.circles=[]}}class Lo{constructor(o,c,m,b,T){this.bucketInstanceId=o,this.featureIndex=c,this.sourceLayerIndex=m,this.bucketIndex=b,this.tileID=T}}class Qi{constructor(o){this.crossSourceCollisions=o,this.maxGroupID=0,this.collisionGroups={}}get(o){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[o]){const c=++this.maxGroupID;this.collisionGroups[o]={ID:c,predicate:m=>m.collisionGroupID===c}}return this.collisionGroups[o]}}function ao(p,o,c,m,b){const{horizontalAlign:T,verticalAlign:I}=s.getAnchorAlignment(p),O=-(T-.5)*o,N=-(I-.5)*c,H=s.evaluateVariableOffset(p,m);return new s.Point(O+H[0]*b,N+H[1]*b)}function To(p,o,c,m,b){const T=new s.Point(p,o);return c&&T._rotate(m?b:-b),T}class or{constructor(o,c,m,b,T){this.transform=o.clone(),this.projection=o.projection.name,this.collisionIndex=new Ut(this.transform,T),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=c,this.retainedQueryData={},this.collisionGroups=new Qi(m),this.collisionCircleArrays={},this.prevPlacement=b,b&&(b.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(o,c,m,b){const T=m.getBucket(c),I=m.latestFeatureIndex;if(!T||!I||c.id!==T.layerIds[0])return;const O=T.layers[0].layout,N=m.collisionBoxArray,H=Math.pow(2,this.transform.zoom-m.tileID.overscaledZ),$=m.tileSize/s.EXTENT,ce=m.tileID.toUnwrapped();this.transform.setProjection(T.projection);const Ie=(je=m.tileID,Ke=T.getProjection(),Ye=this.transform,Ke.name===this.projection?Ye.calculateProjMatrix(je.toUnwrapped()):_n(Ye,Ke,je));var je,Ke,Ye;const nt="map"===O.get("text-pitch-alignment"),ue="map"===O.get("text-rotation-alignment");c.compileFilter();const $e=c.dynamicFilter(),pt=c.dynamicFilterNeedsFeature(),ht=this.transform.calculatePixelsToTileUnitsMatrix(m),Ot=Qo(Ie,m.tileID.canonical,nt,ue,this.transform,T.getProjection(),ht);let kt=null;if(nt){const $t=xo(Ie,m.tileID.canonical,nt,ue,this.transform,T.getProjection(),ht);kt=s.multiply([],this.transform.labelPlaneMatrix,$t)}let Rt=null;$e&&m.latestFeatureIndex&&(Rt={unwrappedTileID:ce,dynamicFilter:$e,dynamicFilterNeedsFeature:pt,featureIndex:m.latestFeatureIndex}),this.retainedQueryData[T.bucketInstanceId]=new Lo(T.bucketInstanceId,I,T.sourceLayerIndex,T.index,m.tileID);const Yt={bucket:T,layout:O,posMatrix:Ie,textLabelPlaneMatrix:Ot,labelToScreenMatrix:kt,clippingData:Rt,scale:H,textPixelRatio:$,holdingForFade:m.holdingForFade(),collisionBoxArray:N,partiallyEvaluatedTextSize:s.evaluateSizeForZoom(T.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:s.evaluateSizeForZoom(T.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(T.sourceID)};if(b)for(const $t of T.sortKeyRanges){const{sortKey:ln,symbolInstanceStart:Gn,symbolInstanceEnd:on}=$t;o.push({sortKey:ln,symbolInstanceStart:Gn,symbolInstanceEnd:on,parameters:Yt})}else o.push({symbolInstanceStart:0,symbolInstanceEnd:T.symbolInstances.length,parameters:Yt})}attemptAnchorPlacement(o,c,m,b,T,I,O,N,H,$,ce,Ie,je,Ke,Ye,nt,ue,$e){const{textOffset0:pt,textOffset1:ht,crossTileID:Ot}=Ie,kt=[pt,ht],Rt=ao(o,m,b,kt,T),Yt=this.collisionIndex.placeCollisionBox(Ke,T,c,To(Rt.x,Rt.y,I,O,this.transform.angle),ce,N,H,$.predicate);if(nt){const $t=Ke.getSymbolInstanceIconSize($e,this.transform.zoom,Ie.placedIconSymbolIndex);if(0===this.collisionIndex.placeCollisionBox(Ke,$t,nt,To(Rt.x,Rt.y,I,O,this.transform.angle),ce,N,H,$.predicate).box.length)return}if(Yt.box.length>0){let $t;return this.prevPlacement&&this.prevPlacement.variableOffsets[Ot]&&this.prevPlacement.placements[Ot]&&this.prevPlacement.placements[Ot].text&&($t=this.prevPlacement.variableOffsets[Ot].anchor),this.variableOffsets[Ot]={textOffset:kt,width:m,height:b,anchor:o,textScale:T,prevAnchor:$t},this.markUsedJustification(Ke,o,Ie,Ye),Ke.allowVerticalPlacement&&(this.markUsedOrientation(Ke,Ye,Ie),this.placedOrientations[Ot]=Ye),{shift:Rt,placedGlyphBoxes:Yt}}}placeLayerBucketPart(o,c,m,b){const{bucket:T,layout:I,posMatrix:O,textLabelPlaneMatrix:N,labelToScreenMatrix:H,clippingData:$,textPixelRatio:ce,holdingForFade:Ie,collisionBoxArray:je,partiallyEvaluatedTextSize:Ke,partiallyEvaluatedIconSize:Ye,collisionGroup:nt}=o.parameters,ue=I.get("text-optional"),$e=I.get("icon-optional"),pt=I.get("text-allow-overlap"),ht=I.get("icon-allow-overlap"),Ot="map"===I.get("text-rotation-alignment"),kt="map"===I.get("text-pitch-alignment"),Rt="none"!==I.get("icon-text-fit"),Yt="viewport-y"===I.get("symbol-z-order");this.transform.setProjection(T.projection);let $t=pt&&(ht||!T.hasIconData()||$e),ln=ht&&(pt||!T.hasTextData()||ue);!T.collisionArrays&&je&&T.deserializeCollisionBoxes(je),m&&b&&T.updateCollisionDebugBuffers(this.transform.zoom,je);const Gn=(on,An,hn)=>{const{crossTileID:jn,numVerticalGlyphVertices:cn}=on;if($){const yr={zoom:this.transform.zoom,pitch:this.transform.pitch};let ar=null;if($.dynamicFilterNeedsFeature){const Uo=this.retainedQueryData[T.bucketInstanceId];ar=$.featureIndex.loadFeature({featureIndex:on.featureIndex,bucketIndex:Uo.bucketIndex,sourceLayerIndex:Uo.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,$.dynamicFilter)(yr,ar,this.retainedQueryData[T.bucketInstanceId].tileID.canonical,new s.Point(on.tileAnchorX,on.tileAnchorY),this.transform.calculateDistanceTileData($.unwrappedTileID)))return this.placements[jn]=new Di(!1,!1,!1,!0),void c.add(jn)}if(c.has(jn))return;if(Ie)return void(this.placements[jn]=new Di(!1,!1,!1));let Mn=!1,Vn=!1,Bn=!0,qn=!1,Ti=!1,Vi=null,_i={box:null,offscreen:null,occluded:null},Oi={box:null,offscreen:null,occluded:null},po=null,mo=null,bi=null,Fo=0,Bo=0,No=0;hn.textFeatureIndex?Fo=hn.textFeatureIndex:on.useRuntimeCollisionCircles&&(Fo=on.featureIndex),hn.verticalTextFeatureIndex&&(Bo=hn.verticalTextFeatureIndex);const zo=yr=>{yr.tileID=this.retainedQueryData[T.bucketInstanceId].tileID;const ar=this.transform.elevation;(ar||yr.elevation)&&(yr.elevation=ar?ar.getAtTileOffset(yr.tileID,yr.tileAnchorX,yr.tileAnchorY):0)},gs=hn.textBox;if(gs){zo(gs);const yr=Uo=>{let Jr=s.WritingMode.horizontal;if(T.allowVerticalPlacement&&!Uo&&this.prevPlacement){const Ys=this.prevPlacement.placedOrientations[jn];Ys&&(this.placedOrientations[jn]=Ys,Jr=Ys,this.markUsedOrientation(T,Jr,on))}return Jr},ar=(Uo,Jr)=>{if(T.allowVerticalPlacement&&cn>0&&hn.verticalTextBox){for(const Ys of T.writingModes)if(Ys===s.WritingMode.vertical?(_i=Jr(),Oi=_i):_i=Uo(),_i&&_i.box&&_i.box.length)break}else _i=Uo()};if(I.get("text-variable-anchor")){let Uo=I.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[jn]){const vr=this.prevPlacement.variableOffsets[jn];Uo.indexOf(vr.anchor)>0&&(Uo=Uo.filter(la=>la!==vr.anchor),Uo.unshift(vr.anchor))}const Jr=(vr,la,xl)=>{const gc=T.getSymbolInstanceTextSize(Ke,on,this.transform.zoom,An),bu=(vr.x2-vr.x1)*gc+2*vr.padding,mr=(vr.y2-vr.y1)*gc+2*vr.padding,bl=Rt&&!ht?la:null;bl&&zo(bl);let Sa={box:[],offscreen:!1,occluded:!1};const wu=pt?2*Uo.length:Uo.length;for(let Ms=0;Ms<wu;++Ms){const Gl=this.attemptAnchorPlacement(Uo[Ms%Uo.length],vr,bu,mr,gc,Ot,kt,ce,O,nt,Ms>=Uo.length,on,An,T,xl,bl,Ke,Ye);if(Gl&&(Sa=Gl.placedGlyphBoxes,Sa&&Sa.box&&Sa.box.length)){Mn=!0,Vi=Gl.shift;break}}return Sa};ar(()=>Jr(gs,hn.iconBox,s.WritingMode.horizontal),()=>{const vr=hn.verticalTextBox;return vr&&zo(vr),T.allowVerticalPlacement&&!(_i&&_i.box&&_i.box.length)&&cn>0&&vr?Jr(vr,hn.verticalIconBox,s.WritingMode.vertical):{box:null,offscreen:null,occluded:null}}),_i&&(Mn=_i.box,Bn=_i.offscreen,qn=_i.occluded);const Ys=yr(!(!_i||!_i.box));if(!Mn&&this.prevPlacement){const vr=this.prevPlacement.variableOffsets[jn];vr&&(this.variableOffsets[jn]=vr,this.markUsedJustification(T,vr.anchor,on,Ys))}}else{const Uo=(Jr,Ys)=>{const vr=T.getSymbolInstanceTextSize(Ke,on,this.transform.zoom,An),la=this.collisionIndex.placeCollisionBox(T,vr,Jr,new s.Point(0,0),pt,ce,O,nt.predicate);return la&&la.box&&la.box.length&&(this.markUsedOrientation(T,Ys,on),this.placedOrientations[jn]=Ys),la};ar(()=>Uo(gs,s.WritingMode.horizontal),()=>{const Jr=hn.verticalTextBox;return T.allowVerticalPlacement&&cn>0&&Jr?(zo(Jr),Uo(Jr,s.WritingMode.vertical)):{box:null,offscreen:null,occluded:null}}),yr(!!(_i&&_i.box&&_i.box.length))}}if(po=_i,Mn=po&&po.box&&po.box.length>0,Bn=po&&po.offscreen,qn=po&&po.occluded,on.useRuntimeCollisionCircles){const yr=T.text.placedSymbolArray.get(on.centerJustifiedTextSymbolIndex>=0?on.centerJustifiedTextSymbolIndex:on.verticalPlacedTextSymbolIndex),ar=s.evaluateSizeForFeature(T.textSizeData,Ke,yr),Uo=I.get("text-padding");mo=this.collisionIndex.placeCollisionCircles(T,pt,yr,T.lineVertexArray,T.glyphOffsetArray,ar,O,N,H,m,kt,nt.predicate,on.collisionCircleDiameter*ar/s.ONE_EM,Uo,this.retainedQueryData[T.bucketInstanceId].tileID),Mn=pt||mo.circles.length>0&&!mo.collisionDetected,Bn=Bn&&mo.offscreen,qn=mo.occluded}if(hn.iconFeatureIndex&&(No=hn.iconFeatureIndex),hn.iconBox){const yr=ar=>{zo(ar);const Uo=Rt&&Vi?To(Vi.x,Vi.y,Ot,kt,this.transform.angle):new s.Point(0,0),Jr=T.getSymbolInstanceIconSize(Ye,this.transform.zoom,on.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(T,Jr,ar,Uo,ht,ce,O,nt.predicate)};Oi&&Oi.box&&Oi.box.length&&hn.verticalIconBox?(bi=yr(hn.verticalIconBox),Vn=bi.box.length>0):(bi=yr(hn.iconBox),Vn=bi.box.length>0),Bn=Bn&&bi.offscreen,Ti=bi.occluded}const Yr=ue||0===on.numHorizontalGlyphVertices&&0===cn,_s=$e||0===on.numIconVertices;if(Yr||_s?_s?Yr||(Vn=Vn&&Mn):Mn=Vn&&Mn:Vn=Mn=Vn&&Mn,Mn&&po&&po.box&&this.collisionIndex.insertCollisionBox(po.box,I.get("text-ignore-placement"),T.bucketInstanceId,Oi&&Oi.box&&Bo?Bo:Fo,nt.ID),Vn&&bi&&this.collisionIndex.insertCollisionBox(bi.box,I.get("icon-ignore-placement"),T.bucketInstanceId,No,nt.ID),mo&&(Mn&&this.collisionIndex.insertCollisionCircles(mo.circles,I.get("text-ignore-placement"),T.bucketInstanceId,Fo,nt.ID),m)){const yr=T.bucketInstanceId;let ar=this.collisionCircleArrays[yr];void 0===ar&&(ar=this.collisionCircleArrays[yr]=new Bi);for(let Uo=0;Uo<mo.circles.length;Uo+=4)ar.circles.push(mo.circles[Uo+0]),ar.circles.push(mo.circles[Uo+1]),ar.circles.push(mo.circles[Uo+2]),ar.circles.push(mo.collisionDetected?1:0)}const Qa="globe"!==T.projection.name;$t=$t&&(Qa||!qn),ln=ln&&(Qa||!Ti),this.placements[jn]=new Di(Mn||$t,Vn||ln,Bn||T.justReloaded),c.add(jn)};if(Yt){const on=T.getSortedSymbolIndexes(this.transform.angle);for(let An=on.length-1;An>=0;--An){const hn=on[An];Gn(T.symbolInstances.get(hn),hn,T.collisionArrays[hn])}}else for(let on=o.symbolInstanceStart;on<o.symbolInstanceEnd;on++)Gn(T.symbolInstances.get(on),on,T.collisionArrays[on]);if(m&&T.bucketInstanceId in this.collisionCircleArrays){const on=this.collisionCircleArrays[T.bucketInstanceId];s.invert(on.invProjMatrix,O),on.viewportMatrix=this.collisionIndex.getViewportMatrix()}T.justReloaded=!1}markUsedJustification(o,c,m,b){const{leftJustifiedTextSymbolIndex:T,centerJustifiedTextSymbolIndex:I,rightJustifiedTextSymbolIndex:O,verticalPlacedTextSymbolIndex:N,crossTileID:H}=m,$=s.getAnchorJustification(c),ce=b===s.WritingMode.vertical?N:"left"===$?T:"center"===$?I:"right"===$?O:-1;T>=0&&(o.text.placedSymbolArray.get(T).crossTileID=ce>=0&&T!==ce?0:H),I>=0&&(o.text.placedSymbolArray.get(I).crossTileID=ce>=0&&I!==ce?0:H),O>=0&&(o.text.placedSymbolArray.get(O).crossTileID=ce>=0&&O!==ce?0:H),N>=0&&(o.text.placedSymbolArray.get(N).crossTileID=ce>=0&&N!==ce?0:H)}markUsedOrientation(o,c,m){const b=c===s.WritingMode.horizontal||c===s.WritingMode.horizontalOnly?c:0,T=c===s.WritingMode.vertical?c:0,{leftJustifiedTextSymbolIndex:I,centerJustifiedTextSymbolIndex:O,rightJustifiedTextSymbolIndex:N,verticalPlacedTextSymbolIndex:H}=m,$=o.text.placedSymbolArray;I>=0&&($.get(I).placedOrientation=b),O>=0&&($.get(O).placedOrientation=b),N>=0&&($.get(N).placedOrientation=b),H>=0&&($.get(H).placedOrientation=T)}commit(o){this.commitTime=o,this.zoomAtLastRecencyCheck=this.transform.zoom;const c=this.prevPlacement;let m=!1;this.prevZoomAdjustment=c?c.zoomAdjustment(this.transform.zoom):0;const b=c?c.symbolFadeChange(o):1,T=c?c.opacities:{},I=c?c.variableOffsets:{},O=c?c.placedOrientations:{};for(const N in this.placements){const H=this.placements[N],$=T[N];$?(this.opacities[N]=new di($,b,H.text,H.icon,null,H.clipped),m=m||H.text!==$.text.placed||H.icon!==$.icon.placed):(this.opacities[N]=new di(null,b,H.text,H.icon,H.skipFade,H.clipped),m=m||H.text||H.icon)}for(const N in T){const H=T[N];if(!this.opacities[N]){const $=new di(H,b,!1,!1);$.isHidden()||(this.opacities[N]=$,m=m||H.text.placed||H.icon.placed)}}for(const N in I)this.variableOffsets[N]||!this.opacities[N]||this.opacities[N].isHidden()||(this.variableOffsets[N]=I[N]);for(const N in O)this.placedOrientations[N]||!this.opacities[N]||this.opacities[N].isHidden()||(this.placedOrientations[N]=O[N]);m?this.lastPlacementChangeTime=o:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=c?c.lastPlacementChangeTime:o)}updateLayerOpacities(o,c){const m=new Set;for(const b of c){const T=b.getBucket(o);T&&b.latestFeatureIndex&&o.id===T.layerIds[0]&&this.updateBucketOpacities(T,m,b.collisionBoxArray)}}updateBucketOpacities(o,c,m){o.hasTextData()&&o.text.opacityVertexArray.clear(),o.hasIconData()&&o.icon.opacityVertexArray.clear(),o.hasIconCollisionBoxData()&&o.iconCollisionBox.collisionVertexArray.clear(),o.hasTextCollisionBoxData()&&o.textCollisionBox.collisionVertexArray.clear();const b=o.layers[0].layout,T=!!o.layers[0].dynamicFilter(),I=new di(null,0,!1,!1,!0),O=b.get("text-allow-overlap"),N=b.get("icon-allow-overlap"),H=b.get("text-variable-anchor"),$="map"===b.get("text-rotation-alignment"),ce="map"===b.get("text-pitch-alignment"),Ie="none"!==b.get("icon-text-fit"),je=new di(null,0,O&&(N||!o.hasIconData()||b.get("icon-optional")),N&&(O||!o.hasTextData()||b.get("text-optional")),!0);!o.collisionArrays&&m&&(o.hasIconCollisionBoxData()||o.hasTextCollisionBoxData())&&o.deserializeCollisionBoxes(m);const Ke=(nt,ue,$e)=>{for(let pt=0;pt<ue/4;pt++)nt.opacityVertexArray.emplaceBack($e)};let Ye=0;for(let nt=0;nt<o.symbolInstances.length;nt++){const ue=o.symbolInstances.get(nt),{numHorizontalGlyphVertices:$e,numVerticalGlyphVertices:pt,crossTileID:ht,numIconVertices:Ot}=ue,kt=c.has(ht);let Rt=this.opacities[ht];kt?Rt=I:Rt||(Rt=je,this.opacities[ht]=Rt),c.add(ht);const Yt=$e>0||pt>0,$t=Ot>0,ln=this.placedOrientations[ht],Gn=ln===s.WritingMode.vertical,on=ln===s.WritingMode.horizontal||ln===s.WritingMode.horizontalOnly;if(!Yt&&!$t||Rt.isHidden()||Ye++,Yt){const An=Ri(Rt.text);Ke(o.text,$e,Gn?Li:An),Ke(o.text,pt,on?Li:An);const hn=Rt.text.isHidden(),{leftJustifiedTextSymbolIndex:jn,centerJustifiedTextSymbolIndex:cn,rightJustifiedTextSymbolIndex:Mn,verticalPlacedTextSymbolIndex:Vn}=ue,Bn=o.text.placedSymbolArray,qn=hn||Gn?1:0;jn>=0&&(Bn.get(jn).hidden=qn),cn>=0&&(Bn.get(cn).hidden=qn),Mn>=0&&(Bn.get(Mn).hidden=qn),Vn>=0&&(Bn.get(Vn).hidden=hn||on?1:0);const Ti=this.variableOffsets[ht];Ti&&this.markUsedJustification(o,Ti.anchor,ue,ln);const Vi=this.placedOrientations[ht];Vi&&(this.markUsedJustification(o,"left",ue,Vi),this.markUsedOrientation(o,Vi,ue))}if($t){const An=Ri(Rt.icon),{placedIconSymbolIndex:hn,verticalPlacedIconSymbolIndex:jn}=ue,cn=o.icon.placedSymbolArray,Mn=Rt.icon.isHidden()?1:0;hn>=0&&(Ke(o.icon,Ot,Gn?Li:An),cn.get(hn).hidden=Mn),jn>=0&&(Ke(o.icon,ue.numVerticalIconVertices,on?Li:An),cn.get(jn).hidden=Mn)}if(o.hasIconCollisionBoxData()||o.hasTextCollisionBoxData()){const An=o.collisionArrays[nt];if(An){let hn=new s.Point(0,0),jn=!0;if(An.textBox||An.verticalTextBox){if(H){const Mn=this.variableOffsets[ht];Mn?(hn=ao(Mn.anchor,Mn.width,Mn.height,Mn.textOffset,Mn.textScale),$&&hn._rotate(ce?this.transform.angle:-this.transform.angle)):jn=!1}T&&(jn=!Rt.clipped),An.textBox&&Wo(o.textCollisionBox.collisionVertexArray,Rt.text.placed,!jn||Gn,hn.x,hn.y),An.verticalTextBox&&Wo(o.textCollisionBox.collisionVertexArray,Rt.text.placed,!jn||on,hn.x,hn.y)}const cn=jn&&!(on||!An.verticalIconBox);An.iconBox&&Wo(o.iconCollisionBox.collisionVertexArray,Rt.icon.placed,cn,Ie?hn.x:0,Ie?hn.y:0),An.verticalIconBox&&Wo(o.iconCollisionBox.collisionVertexArray,Rt.icon.placed,!cn,Ie?hn.x:0,Ie?hn.y:0)}}}if(o.fullyClipped=0===Ye,o.sortFeatures(this.transform.angle),this.retainedQueryData[o.bucketInstanceId]&&(this.retainedQueryData[o.bucketInstanceId].featureSortOrder=o.featureSortOrder),o.hasTextData()&&o.text.opacityVertexBuffer&&o.text.opacityVertexBuffer.updateData(o.text.opacityVertexArray),o.hasIconData()&&o.icon.opacityVertexBuffer&&o.icon.opacityVertexBuffer.updateData(o.icon.opacityVertexArray),o.hasIconCollisionBoxData()&&o.iconCollisionBox.collisionVertexBuffer&&o.iconCollisionBox.collisionVertexBuffer.updateData(o.iconCollisionBox.collisionVertexArray),o.hasTextCollisionBoxData()&&o.textCollisionBox.collisionVertexBuffer&&o.textCollisionBox.collisionVertexBuffer.updateData(o.textCollisionBox.collisionVertexArray),o.bucketInstanceId in this.collisionCircleArrays){const nt=this.collisionCircleArrays[o.bucketInstanceId];o.placementInvProjMatrix=nt.invProjMatrix,o.placementViewportMatrix=nt.viewportMatrix,o.collisionCircleArray=nt.circles,delete this.collisionCircleArrays[o.bucketInstanceId]}}symbolFadeChange(o){return 0===this.fadeDuration?1:(o-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(o){return Math.max(0,(this.transform.zoom-o)/1.5)}hasTransitions(o){return this.stale||o-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(o,c){const m=this.zoomAtLastRecencyCheck===c?1-this.zoomAdjustment(c):1;return this.zoomAtLastRecencyCheck=c,this.commitTime+this.fadeDuration*m>o}setStale(){this.stale=!0}}function Wo(p,o,c,m,b){p.emplaceBack(o?1:0,c?1:0,m||0,b||0),p.emplaceBack(o?1:0,c?1:0,m||0,b||0),p.emplaceBack(o?1:0,c?1:0,m||0,b||0),p.emplaceBack(o?1:0,c?1:0,m||0,b||0)}const dr=Math.pow(2,25),Co=Math.pow(2,24),xs=Math.pow(2,17),ea=Math.pow(2,16),hr=Math.pow(2,9),wo=Math.pow(2,8),pi=Math.pow(2,1);function Ri(p){if(0===p.opacity&&!p.placed)return 0;if(1===p.opacity&&p.placed)return 4294967295;const o=p.placed?1:0,c=Math.floor(127*p.opacity);return c*dr+o*Co+c*xs+o*ea+c*hr+o*wo+c*pi+o}const Li=0;class er{constructor(o){this._sortAcrossTiles="viewport-y"!==o.layout.get("symbol-z-order")&&void 0!==o.layout.get("symbol-sort-key").constantOr(1),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(o,c,m,b,T){const I=this._bucketParts;for(;this._currentTileIndex<o.length;)if(c.getBucketParts(I,b,o[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,T())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,I.sort((O,N)=>O.sortKey-N.sortKey));this._currentPartIndex<I.length;){const O=I[this._currentPartIndex];if(c.placeLayerBucketPart(O,this._seenCrossTileIDs,m,0===O.symbolInstanceStart),this._currentPartIndex++,T())return!0}return!1}}class is{constructor(o,c,m,b,T,I,O,N){this.placement=new or(o,T,I,O,N),this._currentPlacementIndex=c.length-1,this._forceFullPlacement=m,this._showCollisionBoxes=b,this._done=!1}isDone(){return this._done}continuePlacement(o,c,m){const b=s.exported.now(),T=()=>{const I=s.exported.now()-b;return!this._forceFullPlacement&&I>2};for(;this._currentPlacementIndex>=0;){const I=c[o[this._currentPlacementIndex]],O=this.placement.collisionIndex.transform.zoom;if("symbol"===I.type&&(!I.minzoom||I.minzoom<=O)&&(!I.maxzoom||I.maxzoom>O)){if(this._inProgressLayer||(this._inProgressLayer=new er(I)),this._inProgressLayer.continuePlacement(m[I.source],this.placement,this._showCollisionBoxes,I,T))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(o){return this.placement.commit(o),this.placement}}const jo=512/s.EXTENT/2;class Jo{constructor(o,c,m){this.tileID=o,this.bucketInstanceId=m,this.index=new s.KDBush(c.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const b=o.canonical.x*s.EXTENT,T=o.canonical.y*s.EXTENT;for(let I=0;I<c.length;I++){const{key:O,crossTileID:N,tileAnchorX:H,tileAnchorY:$}=c.get(I),ce=Math.floor((b+H)*jo),Ie=Math.floor((T+$)*jo);this.index.add(ce,Ie),this.keys.push(O),this.crossTileIDs.push(N)}this.index.finish()}findMatches(o,c,m){const b=this.tileID.canonical.z<c.canonical.z?1:Math.pow(2,this.tileID.canonical.z-c.canonical.z),T=jo/Math.pow(2,c.canonical.z-this.tileID.canonical.z),I=c.canonical.x*s.EXTENT,O=c.canonical.y*s.EXTENT;for(let N=0;N<o.length;N++){const H=o.get(N);if(H.crossTileID)continue;const{key:$,tileAnchorX:ce,tileAnchorY:Ie}=H,je=Math.floor((I+ce)*T),Ke=Math.floor((O+Ie)*T),Ye=this.index.range(je-b,Ke-b,je+b,Ke+b);for(const nt of Ye){const ue=this.crossTileIDs[nt];if(this.keys[nt]===$&&!m.has(ue)){m.add(ue),H.crossTileID=ue;break}}}}}class Oo{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Ur{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(o){const c=Math.round((o-this.lng)/360);if(0!==c)for(const m in this.indexes){const b=this.indexes[m],T={};for(const I in b){const O=b[I];O.tileID=O.tileID.unwrapTo(O.tileID.wrap+c),T[O.tileID.key]=O}this.indexes[m]=T}this.lng=o}addBucket(o,c,m){if(this.indexes[o.overscaledZ]&&this.indexes[o.overscaledZ][o.key]){if(this.indexes[o.overscaledZ][o.key].bucketInstanceId===c.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(o.overscaledZ,this.indexes[o.overscaledZ][o.key])}for(let T=0;T<c.symbolInstances.length;T++)c.symbolInstances.get(T).crossTileID=0;this.usedCrossTileIDs[o.overscaledZ]||(this.usedCrossTileIDs[o.overscaledZ]=new Set);const b=this.usedCrossTileIDs[o.overscaledZ];for(const T in this.indexes){const I=this.indexes[T];if(Number(T)>o.overscaledZ)for(const O in I){const N=I[O];N.tileID.isChildOf(o)&&N.findMatches(c.symbolInstances,o,b)}else{const O=I[o.scaledTo(Number(T)).key];O&&O.findMatches(c.symbolInstances,o,b)}}for(let T=0;T<c.symbolInstances.length;T++){const I=c.symbolInstances.get(T);I.crossTileID||(I.crossTileID=m.generate(),b.add(I.crossTileID))}return void 0===this.indexes[o.overscaledZ]&&(this.indexes[o.overscaledZ]={}),this.indexes[o.overscaledZ][o.key]=new Jo(o,c.symbolInstances,c.bucketInstanceId),!0}removeBucketCrossTileIDs(o,c){for(const m of c.crossTileIDs)this.usedCrossTileIDs[o].delete(m)}removeStaleBuckets(o){let c=!1;for(const m in this.indexes){const b=this.indexes[m];for(const T in b)o[b[T].bucketInstanceId]||(this.removeBucketCrossTileIDs(m,b[T]),delete b[T],c=!0)}return c}}class xr{constructor(){this.layerIndexes={},this.crossTileIDs=new Oo,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(o,c,m,b){let T=this.layerIndexes[o.id];void 0===T&&(T=this.layerIndexes[o.id]=new Ur);let I=!1;const O={};"globe"!==b.name&&T.handleWrapJump(m);for(const N of c){const H=N.getBucket(o);H&&o.id===H.layerIds[0]&&(H.bucketInstanceId||(H.bucketInstanceId=++this.maxBucketInstanceId),T.addBucket(N.tileID,H,this.crossTileIDs)&&(I=!0),O[H.bucketInstanceId]=!0)}return T.removeStaleBuckets(O)&&(I=!0),I}pruneUnusedLayers(o){const c={};o.forEach(m=>{c[m]=!0});for(const m in this.layerIndexes)c[m]||delete this.layerIndexes[m]}}const Si=(p,o)=>s.emitValidationErrors(p,o&&o.filter(c=>"source.canvas"!==c.identifier)),us=s.pick(Pn,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection"]),ta=s.pick(Pn,["setCenter","setZoom","setBearing","setPitch"]),Xr={version:8,layers:[],sources:{}},ko={fill:!0,line:!0,background:!0,hillshade:!0,raster:!0};class Ir extends s.Evented{constructor(o,c={}){super(),this.map=o,this.dispatcher=new dt(bt(),this),this.imageManager=new Xe,this.imageManager.setEventedParent(this),this.glyphManager=new s.GlyphManager(o._requestManager,c.localFontFamily?s.LocalGlyphMode.all:c.localIdeographFontFamily?s.LocalGlyphMode.ideographs:s.LocalGlyphMode.none,c.localFontFamily||c.localIdeographFontFamily),this.crossTileSymbolIndex=new xr,this._layers={},this._num3DLayers=0,this._numSymbolLayers=0,this._numCircleLayers=0,this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._availableImages=[],this._order=[],this._drapedFirstOrder=[],this._markersNeedUpdate=!1,this._resetUpdates(),this.dispatcher.broadcast("setReferrer",s.getReferrer());const m=this;this._rtlTextPluginCallback=Ir.registerForPluginStateChange(b=>{m.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:b.pluginStatus,pluginURL:b.pluginURL},(T,I)=>{if(s.triggerPluginCompletionEvent(T),I&&I.every(O=>O))for(const O in m._sourceCaches){const N=m._sourceCaches[O],H=N.getSource().type;"vector"!==H&&"geojson"!==H||N.reload()}})}),this.on("data",b=>{if("source"!==b.dataType||"metadata"!==b.sourceDataType)return;const T=this.getSource(b.sourceId);if(T&&T.vectorLayerIds)for(const I in this._layers){const O=this._layers[I];O.source===T.id&&this._validateLayer(O)}})}loadURL(o,c={}){this.fire(new s.Event("dataloading",{dataType:"style"}));const m="boolean"==typeof c.validate?c.validate:!s.isMapboxURL(o);o=this.map._requestManager.normalizeStyleURL(o,c.accessToken);const b=this.map._requestManager.transformRequest(o,s.ResourceType.Style);this._request=s.getJSON(b,(T,I)=>{this._request=null,T?this.fire(new s.ErrorEvent(T)):I&&this._load(I,m)})}loadJSON(o,c={}){this.fire(new s.Event("dataloading",{dataType:"style"})),this._request=s.exported.frame(()=>{this._request=null,this._load(o,!1!==c.validate)})}loadEmpty(){this.fire(new s.Event("dataloading",{dataType:"style"})),this._load(Xr,!1)}_updateLayerCount(o,c){const m=c?1:-1;o.is3D()&&(this._num3DLayers+=m),"circle"===o.type&&(this._numCircleLayers+=m),"symbol"===o.type&&(this._numSymbolLayers+=m)}_load(o,c){if(c&&Si(this,s.validateStyle(o)))return;this._loaded=!0,this.stylesheet=s.clone$1(o),this._updateMapProjection();for(const b in o.sources)this.addSource(b,o.sources[b],{validate:!1});this._changed=!1,o.sprite?this._loadSprite(o.sprite):(this.imageManager.setLoaded(!0),this.dispatcher.broadcast("spriteLoaded",!0)),this.glyphManager.setURL(o.glyphs);const m=Nn(this.stylesheet.layers);this._order=m.map(b=>b.id),this._layers={},this._serializedLayers={};for(const b of m){const T=s.createStyleLayer(b);T.setEventedParent(this,{layer:{id:T.id}}),this._layers[T.id]=T,this._serializedLayers[T.id]=T.serialize(),this._updateLayerCount(T,!0)}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new ae(this.stylesheet.light),this.stylesheet.terrain&&!this.terrainSetForDrapingOnly()&&this._createTerrain(this.stylesheet.terrain,1),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this._updateDrapeFirstLayers(),this.fire(new s.Event("data",{dataType:"style"})),this.fire(new s.Event("style.load"))}terrainSetForDrapingOnly(){return!!this.terrain&&0===this.terrain.drapeRenderMode}setProjection(o){o?this.stylesheet.projection=o:delete this.stylesheet.projection,this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?this.getTerrain()||this.stylesheet.terrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null))}_updateMapProjection(){this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.stylesheet.projection)}_loadSprite(o){this._spriteRequest=function(c,m,b){let T,I,O;const N=s.exported.devicePixelRatio>1?"@2x":"";let H=s.getJSON(m.transformRequest(m.normalizeSpriteURL(c,N,".json"),s.ResourceType.SpriteJSON),(Ie,je)=>{H=null,O||(O=Ie,T=je,ce())}),$=s.getImage(m.transformRequest(m.normalizeSpriteURL(c,N,".png"),s.ResourceType.SpriteImage),(Ie,je)=>{$=null,O||(O=Ie,I=je,ce())});function ce(){if(O)b(O);else if(T&&I){const Ie=s.exported.getImageData(I),je={};for(const Ke in T){const{width:Ye,height:nt,x:ue,y:$e,sdf:pt,pixelRatio:ht,stretchX:Ot,stretchY:kt,content:Rt}=T[Ke],Yt=new s.RGBAImage({width:Ye,height:nt});s.RGBAImage.copy(Ie,Yt,{x:ue,y:$e},{x:0,y:0},{width:Ye,height:nt}),je[Ke]={data:Yt,pixelRatio:ht,sdf:pt,stretchX:Ot,stretchY:kt,content:Rt}}b(null,je)}}return{cancel(){H&&(H.cancel(),H=null),$&&($.cancel(),$=null)}}}(o,this.map._requestManager,(c,m)=>{if(this._spriteRequest=null,c)this.fire(new s.ErrorEvent(c));else if(m)for(const b in m)this.imageManager.addImage(b,m[b]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.dispatcher.broadcast("spriteLoaded",!0),this.fire(new s.Event("data",{dataType:"style"}))})}_validateLayer(o){const c=this.getSource(o.source);if(!c)return;const m=o.sourceLayer;m&&("geojson"===c.type||c.vectorLayerIds&&-1===c.vectorLayerIds.indexOf(m))&&this.fire(new s.ErrorEvent(new Error(`Source layer "${m}" does not exist on source "${c.id}" as specified by style layer "${o.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const o in this._sourceCaches)if(!this._sourceCaches[o].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(o){const c=[];for(const m of o){const b=this._layers[m];"custom"!==b.type&&c.push(b.serialize())}return c}hasTransitions(){if(this.light&&this.light.hasTransition()||this.fog&&this.fog.hasTransition())return!0;for(const o in this._sourceCaches)if(this._sourceCaches[o].hasTransition())return!0;for(const o in this._layers)if(this._layers[o].hasTransition())return!0;return!1}get order(){return this.map._optimizeForTerrain&&this.terrain?this._drapedFirstOrder:this._order}isLayerDraped(o){return!!this.terrain&&("function"==typeof o.isLayerDraped?o.isLayerDraped():ko[o.type])}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}update(o){if(!this._loaded)return;const c=this._changed;if(this._changed){const b=Object.keys(this._updatedLayers),T=Object.keys(this._removedLayers);(b.length||T.length)&&this._updateWorkerLayers(b,T);for(const I in this._updatedSources){const O=this._updatedSources[I];"reload"===O?this._reloadSource(I):"clear"===O&&this._clearSource(I)}this._updateTilesForChangedImages();for(const I in this._updatedPaintProps)this._layers[I].updateTransitions(o);this.light.updateTransitions(o),this.fog&&this.fog.updateTransitions(o),this._resetUpdates()}const m={};for(const b in this._sourceCaches){const T=this._sourceCaches[b];m[b]=T.used,T.used=!1}for(const b of this._order){const T=this._layers[b];if(T.recalculate(o,this._availableImages),!T.isHidden(o.zoom)){const O=this._getLayerSourceCache(T);O&&(O.used=!0)}const I=this.map.painter;if(I){const O=T.getProgramIds();if(!O)continue;const N=T.getProgramConfiguration(o.zoom);for(const H of O)I.useProgram(H,N)}}for(const b in m){const T=this._sourceCaches[b];m[b]!==T.used&&T.getSource().fire(new s.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:T.getSource().id}))}this.light.recalculate(o),this.terrain&&this.terrain.recalculate(o),this.fog&&this.fog.recalculate(o),this.z=o.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),c&&this.fire(new s.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const o=Object.keys(this._changedImages);if(o.length){for(const c in this._sourceCaches)this._sourceCaches[c].reloadTilesForDependencies(["icons","patterns"],o);this._changedImages={}}}_updateWorkerLayers(o,c){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(o),removedIds:c})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setState(o){if(this._checkLoaded(),Si(this,s.validateStyle(o)))return!1;(o=s.clone$1(o)).layers=Nn(o.layers);const c=function(b,T){if(!b)return[{command:Pn.setStyle,args:[T]}];let I=[];try{if(!Q(b.version,T.version))return[{command:Pn.setStyle,args:[T]}];Q(b.center,T.center)||I.push({command:Pn.setCenter,args:[T.center]}),Q(b.zoom,T.zoom)||I.push({command:Pn.setZoom,args:[T.zoom]}),Q(b.bearing,T.bearing)||I.push({command:Pn.setBearing,args:[T.bearing]}),Q(b.pitch,T.pitch)||I.push({command:Pn.setPitch,args:[T.pitch]}),Q(b.sprite,T.sprite)||I.push({command:Pn.setSprite,args:[T.sprite]}),Q(b.glyphs,T.glyphs)||I.push({command:Pn.setGlyphs,args:[T.glyphs]}),Q(b.transition,T.transition)||I.push({command:Pn.setTransition,args:[T.transition]}),Q(b.light,T.light)||I.push({command:Pn.setLight,args:[T.light]}),Q(b.fog,T.fog)||I.push({command:Pn.setFog,args:[T.fog]}),Q(b.projection,T.projection)||I.push({command:Pn.setProjection,args:[T.projection]});const O={},N=[];!function(ce,Ie,je,Ke){let Ye;for(Ye in Ie=Ie||{},ce=ce||{})ce.hasOwnProperty(Ye)&&(Ie.hasOwnProperty(Ye)||ti(Ye,je,Ke));for(Ye in Ie){if(!Ie.hasOwnProperty(Ye))continue;const nt=Ie[Ye];ce.hasOwnProperty(Ye)?Q(ce[Ye],nt)||("geojson"===ce[Ye].type&&"geojson"===nt.type&&xi(ce,Ie,Ye)?je.push({command:Pn.setGeoJSONSourceData,args:[Ye,nt.data]}):qi(Ye,Ie,je,Ke)):oi(Ye,Ie,je)}}(b.sources,T.sources,N,O);const H=[];b.layers&&b.layers.forEach(ce=>{ce.source&&O[ce.source]?I.push({command:Pn.removeLayer,args:[ce.id]}):H.push(ce)});let $=b.terrain;$&&O[$.source]&&(I.push({command:Pn.setTerrain,args:[void 0]}),$=void 0),I=I.concat(N),Q($,T.terrain)||I.push({command:Pn.setTerrain,args:[T.terrain]}),function(ce,Ie,je){Ie=Ie||[];const Ke=(ce=ce||[]).map(So),Ye=Ie.map(So),nt=ce.reduce(Go,{}),ue=Ie.reduce(Go,{}),$e=Ke.slice(),pt=Object.create(null);let ht,Ot,kt,Rt,Yt,$t,ln;for(ht=0,Ot=0;ht<Ke.length;ht++)kt=Ke[ht],ue.hasOwnProperty(kt)?Ot++:(je.push({command:Pn.removeLayer,args:[kt]}),$e.splice($e.indexOf(kt,Ot),1));for(ht=0,Ot=0;ht<Ye.length;ht++)kt=Ye[Ye.length-1-ht],$e[$e.length-1-ht]!==kt&&(nt.hasOwnProperty(kt)?(je.push({command:Pn.removeLayer,args:[kt]}),$e.splice($e.lastIndexOf(kt,$e.length-Ot),1)):Ot++,$t=$e[$e.length-ht],je.push({command:Pn.addLayer,args:[ue[kt],$t]}),$e.splice($e.length-ht,0,kt),pt[kt]=!0);for(ht=0;ht<Ye.length;ht++)if(kt=Ye[ht],Rt=nt[kt],Yt=ue[kt],!pt[kt]&&!Q(Rt,Yt))if(Q(Rt.source,Yt.source)&&Q(Rt["source-layer"],Yt["source-layer"])&&Q(Rt.type,Yt.type)){for(ln in go(Rt.layout,Yt.layout,je,kt,null,Pn.setLayoutProperty),go(Rt.paint,Yt.paint,je,kt,null,Pn.setPaintProperty),Q(Rt.filter,Yt.filter)||je.push({command:Pn.setFilter,args:[kt,Yt.filter]}),Q(Rt.minzoom,Yt.minzoom)&&Q(Rt.maxzoom,Yt.maxzoom)||je.push({command:Pn.setLayerZoomRange,args:[kt,Yt.minzoom,Yt.maxzoom]}),Rt)Rt.hasOwnProperty(ln)&&"layout"!==ln&&"paint"!==ln&&"filter"!==ln&&"metadata"!==ln&&"minzoom"!==ln&&"maxzoom"!==ln&&(0===ln.indexOf("paint.")?go(Rt[ln],Yt[ln],je,kt,ln.slice(6),Pn.setPaintProperty):Q(Rt[ln],Yt[ln])||je.push({command:Pn.setLayerProperty,args:[kt,ln,Yt[ln]]}));for(ln in Yt)Yt.hasOwnProperty(ln)&&!Rt.hasOwnProperty(ln)&&"layout"!==ln&&"paint"!==ln&&"filter"!==ln&&"metadata"!==ln&&"minzoom"!==ln&&"maxzoom"!==ln&&(0===ln.indexOf("paint.")?go(Rt[ln],Yt[ln],je,kt,ln.slice(6),Pn.setPaintProperty):Q(Rt[ln],Yt[ln])||je.push({command:Pn.setLayerProperty,args:[kt,ln,Yt[ln]]}))}else je.push({command:Pn.removeLayer,args:[kt]}),$t=$e[$e.lastIndexOf(kt)+1],je.push({command:Pn.addLayer,args:[Yt,$t]})}(H,T.layers,I)}catch(O){console.warn("Unable to compute style diff:",O),I=[{command:Pn.setStyle,args:[T]}]}return I}(this.serialize(),o).filter(b=>!(b.command in ta));if(0===c.length)return!1;const m=c.filter(b=>!(b.command in us));if(m.length>0)throw new Error(`Unimplemented: ${m.map(b=>b.command).join(", ")}.`);return c.forEach(b=>{"setTransition"!==b.command&&"setProjection"!==b.command&&this[b.command].apply(this,b.args)}),this.stylesheet=o,this._updateMapProjection(),!0}addImage(o,c){return this.getImage(o)?this.fire(new s.ErrorEvent(new Error("An image with this name already exists."))):(this.imageManager.addImage(o,c),this._afterImageUpdated(o),this)}updateImage(o,c){this.imageManager.updateImage(o,c)}getImage(o){return this.imageManager.getImage(o)}removeImage(o){return this.getImage(o)?(this.imageManager.removeImage(o),this._afterImageUpdated(o),this):this.fire(new s.ErrorEvent(new Error("No image with this name exists.")))}_afterImageUpdated(o){this._availableImages=this.imageManager.listImages(),this._changedImages[o]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new s.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addSource(o,c,m={}){if(this._checkLoaded(),void 0!==this.getSource(o))throw new Error("There is already a source with this ID");if(!c.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(c).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(c.type)>=0&&this._validate(s.validateSource,`sources.${o}`,c,null,m))return;this.map&&this.map._collectResourceTiming&&(c.collectResourceTiming=!0);const b=Ft(o,c,this.dispatcher,this);b.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(o),source:b.serialize(),sourceId:o}));const T=I=>{const O=(I?"symbol:":"other:")+o,N=this._sourceCaches[O]=new s.SourceCache(O,b,I);(I?this._symbolSourceCaches:this._otherSourceCaches)[o]=N,N.style=this,N.onAdd(this.map)};T(!1),"vector"!==c.type&&"geojson"!==c.type||T(!0),b.onAdd&&b.onAdd(this.map),this._changed=!0}removeSource(o){this._checkLoaded();const c=this.getSource(o);if(!c)throw new Error("There is no source with this ID");for(const b in this._layers)if(this._layers[b].source===o)return this.fire(new s.ErrorEvent(new Error(`Source "${o}" cannot be removed while layer "${b}" is using it.`)));if(this.terrain&&this.terrain.get().source===o)return this.fire(new s.ErrorEvent(new Error(`Source "${o}" cannot be removed while terrain is using it.`)));const m=this._getSourceCaches(o);for(const b of m)delete this._sourceCaches[b.id],delete this._updatedSources[b.id],b.fire(new s.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:b.getSource().id})),b.setEventedParent(null),b.clearTiles();return delete this._otherSourceCaches[o],delete this._symbolSourceCaches[o],c.setEventedParent(null),c.onRemove&&c.onRemove(this.map),this._changed=!0,this}setGeoJSONSourceData(o,c){this._checkLoaded(),this.getSource(o).setData(c),this._changed=!0}getSource(o){const c=this._getSourceCache(o);return c&&c.getSource()}_getSources(){const o=[];for(const c in this._otherSourceCaches){const m=this._getSourceCache(c);m&&o.push(m.getSource())}return o}addLayer(o,c,m={}){this._checkLoaded();const b=o.id;if(this.getLayer(b))return void this.fire(new s.ErrorEvent(new Error(`Layer with id "${b}" already exists on this map`)));let T;if("custom"===o.type){if(Si(this,s.validateCustomStyleLayer(o)))return;T=s.createStyleLayer(o)}else{if("object"==typeof o.source&&(this.addSource(b,o.source),o=s.clone$1(o),o=s.extend(o,{source:b})),this._validate(s.validateLayer,`layers.${b}`,o,{arrayIndex:-1},m))return;T=s.createStyleLayer(o),this._validateLayer(T),T.setEventedParent(this,{layer:{id:b}}),this._serializedLayers[T.id]=T.serialize(),this._updateLayerCount(T,!0)}const I=c?this._order.indexOf(c):this._order.length;if(c&&-1===I)return void this.fire(new s.ErrorEvent(new Error(`Layer with id "${c}" does not exist on this map.`)));this._order.splice(I,0,b),this._layerOrderChanged=!0,this._layers[b]=T;const O=this._getLayerSourceCache(T);if(this._removedLayers[b]&&T.source&&O&&"custom"!==T.type){const N=this._removedLayers[b];delete this._removedLayers[b],N.type!==T.type?this._updatedSources[T.source]="clear":(this._updatedSources[T.source]="reload",O.pause())}this._updateLayer(T),T.onAdd&&T.onAdd(this.map),this._updateDrapeFirstLayers()}moveLayer(o,c){if(this._checkLoaded(),this._changed=!0,!this._layers[o])return void this.fire(new s.ErrorEvent(new Error(`The layer '${o}' does not exist in the map's style and cannot be moved.`)));if(o===c)return;const m=this._order.indexOf(o);this._order.splice(m,1);const b=c?this._order.indexOf(c):this._order.length;c&&-1===b?this.fire(new s.ErrorEvent(new Error(`Layer with id "${c}" does not exist on this map.`))):(this._order.splice(b,0,o),this._layerOrderChanged=!0,this._updateDrapeFirstLayers())}removeLayer(o){this._checkLoaded();const c=this._layers[o];if(!c)return void this.fire(new s.ErrorEvent(new Error(`The layer '${o}' does not exist in the map's style and cannot be removed.`)));c.setEventedParent(null),this._updateLayerCount(c,!1);const m=this._order.indexOf(o);this._order.splice(m,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[o]=c,delete this._layers[o],delete this._serializedLayers[o],delete this._updatedLayers[o],delete this._updatedPaintProps[o],c.onRemove&&c.onRemove(this.map),this._updateDrapeFirstLayers()}getLayer(o){return this._layers[o]}hasLayer(o){return o in this._layers}hasLayerType(o){for(const c in this._layers)if(this._layers[c].type===o)return!0;return!1}setLayerZoomRange(o,c,m){this._checkLoaded();const b=this.getLayer(o);b?b.minzoom===c&&b.maxzoom===m||(null!=c&&(b.minzoom=c),null!=m&&(b.maxzoom=m),this._updateLayer(b)):this.fire(new s.ErrorEvent(new Error(`The layer '${o}' does not exist in the map's style and cannot have zoom extent.`)))}setFilter(o,c,m={}){this._checkLoaded();const b=this.getLayer(o);if(b){if(!Q(b.filter,c))return null==c?(b.filter=void 0,void this._updateLayer(b)):void(this._validate(s.validateFilter,`layers.${b.id}.filter`,c,{layerType:b.type},m)||(b.filter=s.clone$1(c),this._updateLayer(b)))}else this.fire(new s.ErrorEvent(new Error(`The layer '${o}' does not exist in the map's style and cannot be filtered.`)))}getFilter(o){const c=this.getLayer(o);return c&&s.clone$1(c.filter)}setLayoutProperty(o,c,m,b={}){this._checkLoaded();const T=this.getLayer(o);T?Q(T.getLayoutProperty(c),m)||(T.setLayoutProperty(c,m,b),this._updateLayer(T)):this.fire(new s.ErrorEvent(new Error(`The layer '${o}' does not exist in the map's style and cannot be styled.`)))}getLayoutProperty(o,c){const m=this.getLayer(o);if(m)return m.getLayoutProperty(c);this.fire(new s.ErrorEvent(new Error(`The layer '${o}' does not exist in the map's style.`)))}setPaintProperty(o,c,m,b={}){this._checkLoaded();const T=this.getLayer(o);T?Q(T.getPaintProperty(c),m)||(T.setPaintProperty(c,m,b)&&this._updateLayer(T),this._changed=!0,this._updatedPaintProps[o]=!0):this.fire(new s.ErrorEvent(new Error(`The layer '${o}' does not exist in the map's style and cannot be styled.`)))}getPaintProperty(o,c){const m=this.getLayer(o);return m&&m.getPaintProperty(c)}setFeatureState(o,c){this._checkLoaded();const m=o.source,b=o.sourceLayer,T=this.getSource(m);if(!T)return void this.fire(new s.ErrorEvent(new Error(`The source '${m}' does not exist in the map's style.`)));const I=T.type;if("geojson"===I&&b)return void this.fire(new s.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if("vector"===I&&!b)return void this.fire(new s.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));void 0===o.id&&this.fire(new s.ErrorEvent(new Error("The feature id parameter must be provided.")));const O=this._getSourceCaches(m);for(const N of O)N.setFeatureState(b,o.id,c)}removeFeatureState(o,c){this._checkLoaded();const m=o.source,b=this.getSource(m);if(!b)return void this.fire(new s.ErrorEvent(new Error(`The source '${m}' does not exist in the map's style.`)));const T=b.type,I="vector"===T?o.sourceLayer:void 0;if("vector"===T&&!I)return void this.fire(new s.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));if(c&&"string"!=typeof o.id&&"number"!=typeof o.id)return void this.fire(new s.ErrorEvent(new Error("A feature id is required to remove its specific state property.")));const O=this._getSourceCaches(m);for(const N of O)N.removeFeatureState(I,o.id,c)}getFeatureState(o){this._checkLoaded();const c=o.source,m=o.sourceLayer,b=this.getSource(c);if(b){if("vector"!==b.type||m)return void 0===o.id&&this.fire(new s.ErrorEvent(new Error("The feature id parameter must be provided."))),this._getSourceCaches(c)[0].getFeatureState(m,o.id);this.fire(new s.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new s.ErrorEvent(new Error(`The source '${c}' does not exist in the map's style.`)))}getTransition(){return s.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){const o={};for(const c in this._sourceCaches){const m=this._sourceCaches[c].getSource();o[m.id]||(o[m.id]=m.serialize())}return s.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,terrain:this.getTerrain()||void 0,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:o,layers:this._serializeLayers(this._order)},c=>void 0!==c)}_updateLayer(o){this._updatedLayers[o.id]=!0;const c=this._getLayerSourceCache(o);o.source&&!this._updatedSources[o.source]&&c&&"raster"!==c.getSource().type&&(this._updatedSources[o.source]="reload",c.pause()),this._changed=!0,o.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(o){const c=I=>"fill-extrusion"===this._layers[I].type,m={},b=[];for(let I=this._order.length-1;I>=0;I--){const O=this._order[I];if(c(O)){m[O]=I;for(const N of o){const H=N[O];if(H)for(const $ of H)b.push($)}}}b.sort((I,O)=>O.intersectionZ-I.intersectionZ);const T=[];for(let I=this._order.length-1;I>=0;I--){const O=this._order[I];if(c(O))for(let N=b.length-1;N>=0;N--){const H=b[N].feature;if(m[H.layer.id]<I)break;T.push(H),b.pop()}else for(const N of o){const H=N[O];if(H)for(const $ of H)T.push($.feature)}}return T}queryRenderedFeatures(o,c,m){c&&c.filter&&this._validate(s.validateFilter,"queryRenderedFeatures.filter",c.filter,null,c);const b={};if(c&&c.layers){if(!Array.isArray(c.layers))return this.fire(new s.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const N of c.layers){const H=this._layers[N];if(!H)return this.fire(new s.ErrorEvent(new Error(`The layer '${N}' does not exist in the map's style and cannot be queried for features.`))),[];b[H.source]=!0}}const T=[];c.availableImages=this._availableImages;const I=c&&c.layers?c.layers.some(N=>{const H=this.getLayer(N);return H&&H.is3D()}):this.has3DLayers(),O=lt.createFromScreenPoints(o,m);for(const N in this._sourceCaches){const H=this._sourceCaches[N].getSource().id;c.layers&&!b[H]||T.push(ei(this._sourceCaches[N],this._layers,this._serializedLayers,O,c,m,I,!!this.map._showQueryGeometry))}return this.placement&&T.push(function(N,H,$,ce,Ie,je,Ke){const Ye={},nt=je.queryRenderedSymbols(ce),ue=[];for(const $e of Object.keys(nt).map(Number))ue.push(Ke[$e]);ue.sort(Ii);for(const $e of ue){const pt=$e.featureIndex.lookupSymbolFeatures(nt[$e.bucketInstanceId],H,$e.bucketIndex,$e.sourceLayerIndex,Ie.filter,Ie.layers,Ie.availableImages,N);for(const ht in pt){const Ot=Ye[ht]=Ye[ht]||[],kt=pt[ht];kt.sort((Rt,Yt)=>{const $t=$e.featureSortOrder;if($t){const ln=$t.indexOf(Rt.featureIndex);return $t.indexOf(Yt.featureIndex)-ln}return Yt.featureIndex-Rt.featureIndex});for(const Rt of kt)Ot.push(Rt)}}for(const $e in Ye)Ye[$e].forEach(pt=>{const ht=pt.feature,Ot=$(N[$e]);if(!Ot)return;const kt=Ot.getFeatureState(ht.layer["source-layer"],ht.id);ht.source=ht.layer.source,ht.layer["source-layer"]&&(ht.sourceLayer=ht.layer["source-layer"]),ht.state=kt});return Ye}(this._layers,this._serializedLayers,this._getLayerSourceCache.bind(this),O.screenGeometry,c,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(T)}querySourceFeatures(o,c){c&&c.filter&&this._validate(s.validateFilter,"querySourceFeatures.filter",c.filter,null,c);const m=this._getSourceCaches(o);let b=[];for(const T of m)b=b.concat(wi(T,c));return b}addSourceType(o,c,m){return Ir.getSourceType(o)?m(new Error(`A source type called "${o}" already exists.`)):(Ir.setSourceType(o,c),c.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:o,url:c.workerSourceURL},m):m(null,null))}getLight(){return this.light.getLight()}setLight(o,c={}){this._checkLoaded();const m=this.light.getLight();let b=!1;for(const I in o)if(!Q(o[I],m[I])){b=!0;break}if(!b)return;const T=this._setTransitionParameters({duration:300,delay:0});this.light.setLight(o,c),this.light.updateTransitions(T)}getTerrain(){return this.terrain&&1===this.terrain.drapeRenderMode?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}setTerrain(o,c=1){if(this._checkLoaded(),!o)return delete this.terrain,delete this.stylesheet.terrain,this.dispatcher.broadcast("enableTerrain",!1),this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);let m=o;if(1===c){if("object"==typeof m.source){const b="terrain-dem-src";this.addSource(b,m.source),m=s.clone$1(m),m=s.extend(m,{source:b})}if(this._validate(s.validateTerrain,"terrain",m))return}if(!this.terrain||this.terrain&&c!==this.terrain.drapeRenderMode){if(!m)return;this._createTerrain(m,c)}else{const b=this.terrain,T=b.get();for(const I of Object.keys(s.spec.terrain))!m.hasOwnProperty(I)&&s.spec.terrain[I].default&&(m[I]=s.spec.terrain[I].default);for(const I in m)if(!Q(m[I],T[I])){b.set(m),this.stylesheet.terrain=m;const O=this._setTransitionParameters({duration:0});b.updateTransitions(O);break}}this._updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(o){const c=this.fog=new en(o,this.map.transform);this.stylesheet.fog=o;const m=this._setTransitionParameters({duration:0});c.updateTransitions(m)}_updateMarkersOpacity(){0!==this.map._markers.length&&this.map._requestDomTask(()=>{for(const o of this.map._markers)o._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(o){if(this._checkLoaded(),!o)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const c=this.fog,m=c.get();0===Object.keys(o).length&&c.set(o);for(const b in o)if(!Q(o[b],m[b])){c.set(o),this.stylesheet.fog=o;const T=this._setTransitionParameters({duration:0});c.updateTransitions(T);break}}else this._createFog(o);this._markersNeedUpdate=!0}_setTransitionParameters(o){return{now:s.exported.now(),transition:s.extend(o,this.stylesheet.transition)}}_updateDrapeFirstLayers(){if(!this.map._optimizeForTerrain||!this.terrain)return;const o=this._order.filter(m=>this.isLayerDraped(this._layers[m])),c=this._order.filter(m=>!this.isLayerDraped(this._layers[m]));this._drapedFirstOrder=[],this._drapedFirstOrder.push(...o),this._drapedFirstOrder.push(...c)}_createTerrain(o,c){const m=this.terrain=new we(o,c);this.stylesheet.terrain=o,this.dispatcher.broadcast("enableTerrain",!this.terrainSetForDrapingOnly()),this._force3DLayerUpdate();const b=this._setTransitionParameters({duration:0});m.updateTransitions(b)}_force3DLayerUpdate(){for(const o in this._layers){const c=this._layers[o];"fill-extrusion"===c.type&&this._updateLayer(c)}}_forceSymbolLayerUpdate(){for(const o in this._layers){const c=this._layers[o];"symbol"===c.type&&this._updateLayer(c)}}_validate(o,c,m,b,T={}){return(!T||!1!==T.validate)&&Si(this,o.call(s.validateStyle,s.extend({key:c,style:this.serialize(),value:m,styleSpec:s.spec},b)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),s.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const o in this._layers)this._layers[o].setEventedParent(null);for(const o in this._sourceCaches)this._sourceCaches[o].clearTiles(),this._sourceCaches[o].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(o){const c=this._getSourceCaches(o);for(const m of c)m.clearTiles()}_reloadSource(o){const c=this._getSourceCaches(o);for(const m of c)m.resume(),m.reload()}_reloadSources(){for(const o of this._getSources())o.reload&&o.reload()}_updateSources(o){for(const c in this._sourceCaches)this._sourceCaches[c].update(o)}_generateCollisionBoxes(){for(const o in this._sourceCaches){const c=this._sourceCaches[o];c.resume(),c.reload()}}_updatePlacement(o,c,m,b,T=!1){let I=!1,O=!1;const N={};for(const H of this._order){const $=this._layers[H];if("symbol"!==$.type)continue;if(!N[$.source]){const Ie=this._getLayerSourceCache($);if(!Ie)continue;N[$.source]=Ie.getRenderableIds(!0).map(je=>Ie.getTileByID(je)).sort((je,Ke)=>Ke.tileID.overscaledZ-je.tileID.overscaledZ||(je.tileID.isLessThan(Ke.tileID)?-1:1))}const ce=this.crossTileSymbolIndex.addLayer($,N[$.source],o.center.lng,o.projection);I=I||ce}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),T=T||this._layerOrderChanged||0===m,this._layerOrderChanged&&this.fire(new s.Event("neworder")),(T||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(s.exported.now(),o.zoom))&&(this.pauseablePlacement=new is(o,this._order,T,c,m,b,this.placement,this.fog&&o.projection.supportsFog?this.fog.state:null),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,N),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(s.exported.now()),O=!0),I&&this.pauseablePlacement.placement.setStale()),O||I)for(const H of this._order){const $=this._layers[H];"symbol"===$.type&&this.placement.updateLayerOpacities($,N[$.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(s.exported.now())}_releaseSymbolFadeTiles(){for(const o in this._sourceCaches)this._sourceCaches[o].releaseSymbolFadeTiles()}getImages(o,c,m){this.imageManager.getImages(c.icons,m),this._updateTilesForChangedImages();const b=T=>{T&&T.setDependencies(c.tileID.key,c.type,c.icons)};b(this._otherSourceCaches[c.source]),b(this._symbolSourceCaches[c.source])}getGlyphs(o,c,m){this.glyphManager.getGlyphs(c.stacks,m)}getResource(o,c,m){return s.makeRequest(c,m)}_getSourceCache(o){return this._otherSourceCaches[o]}_getLayerSourceCache(o){return"symbol"===o.type?this._symbolSourceCaches[o.source]:this._otherSourceCaches[o.source]}_getSourceCaches(o){const c=[];return this._otherSourceCaches[o]&&c.push(this._otherSourceCaches[o]),this._symbolSourceCaches[o]&&c.push(this._symbolSourceCaches[o]),c}_isSourceCacheLoaded(o){const c=this._getSourceCaches(o);return 0===c.length?(this.fire(new s.ErrorEvent(new Error(`There is no source with ID '${o}'`))),!1):c.every(m=>m.loaded())}has3DLayers(){return this._num3DLayers>0}hasSymbolLayers(){return this._numSymbolLayers>0}hasCircleLayers(){return this._numCircleLayers>0}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}Ir.getSourceType=function(p){return Ge[p]},Ir.setSourceType=function(p,o){Ge[p]=o},Ir.registerForPluginStateChange=s.registerForPluginStateChange;var Fr="\n#define EPSILON 0.0000001\n#define PI 3.141592653589793\n#define EXTENT 8192.0\n#define HALF_PI PI/2.0\n#define QUARTER_PI PI/4.0\n#define RAD_TO_DEG 180.0/PI\n#define DEG_TO_RAD PI/180.0\n#define GLOBE_RADIUS EXTENT/PI/2.0",Br="attribute highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;varying highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",br="\n#define ELEVATION_SCALE 7.0\n#define ELEVATION_OFFSET 450.0\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(\nmix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}\n#else\nvec3 elevationVector(vec2 pos) { return vec3(0,0,1); }\n#endif\nconst float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)\n{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}\n#ifdef TERRAIN\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nuniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;\n#else\nuniform sampler2D u_dem;uniform sampler2D u_dem_prev;\n#endif\nuniform vec4 u_dem_unpack;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float decodeElevation(vec4 v) {return dot(vec4(v.xyz*255.0,-1.0),u_dem_unpack);}float currentElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem,pos).a;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem,pos));\n#ifdef TERRAIN_DEM_NEAREST_FILTER\nreturn u_exaggeration*tl;\n#endif\nfloat tr=decodeElevation(texture2D(u_dem,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}float prevElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem_prev,pos).a;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem_prev,pos));float tr=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem_prev,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}\n#ifdef TERRAIN_VERTEX_MORPHING\nfloat elevation(vec2 apos) {\n#ifdef ZERO_EXAGGERATION\nreturn 0.0;\n#endif\nfloat nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}\n#else\nfloat elevation(vec2 apos) {\n#ifdef ZERO_EXAGGERATION\nreturn 0.0;\n#endif\nreturn currentElevation(apos);}\n#endif\nhighp float unpack_depth(highp vec4 rgba_depth)\n{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture2D(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(\nunpack_depth(texture2D(u_depth,uv-df.xz)),unpack_depth(texture2D(u_depth,uv+df.xz)),unpack_depth(texture2D(u_depth,uv-df.zy)),unpack_depth(texture2D(u_depth,uv+df.zy))\n);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nfloat tl=texture2D(u_dem,pos).a;float tr=texture2D(u_dem,pos+vec2(off.x,0.0)).a;float bl=texture2D(u_dem,pos+vec2(0.0,off.y)).a;float br=texture2D(u_dem,pos+off).a;\n#else\nvec4 demtl=vec4(texture2D(u_dem,pos).xyz*255.0,-1.0);float tl=dot(demtl,u_dem_unpack);vec4 demtr=vec4(texture2D(u_dem,pos+vec2(off.x,0.0)).xyz*255.0,-1.0);float tr=dot(demtr,u_dem_unpack);vec4 dembl=vec4(texture2D(u_dem,pos+vec2(0.0,off.y)).xyz*255.0,-1.0);float bl=dot(dembl,u_dem_unpack);vec4 dembr=vec4(texture2D(u_dem,pos+off).xyz*255.0,-1.0);float br=dot(dembr,u_dem_unpack);\n#endif\nreturn vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}\n#else\nfloat elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }\n#endif",bs="#ifdef FOG\nuniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;varying vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}\n#endif",rr="#ifdef FOG\nuniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump float u_fog_temporal_offset;varying vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,opacity);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec3 fog_dither(vec3 color) {vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}\n#endif";let Ar={},Qr={};const ws=[];Sr(Fr,ws),Sr(br,ws),Sr(bs,ws),Sr(rr,ws),Ar=lo("",br),Qr=lo(rr,bs);const eo=lo("\n#if __VERSION__ >=300\n#define varying in\n#define gl_FragColor glFragColor\n#define texture2D texture\n#define textureCube texture\nout vec4 glFragColor;\n#endif\nhighp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}highp float unpack_depth(highp vec4 rgba_depth)\n{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}","\n#if __VERSION__ >=300\n#define attribute in\n#define varying out\n#define texture2D texture\n#endif\nfloat wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {\n#ifndef PROJECTED_POS_ON_VIEWPORT\nfloat tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;\n#else\nreturn vec3(0.0);\n#endif\n}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(\nunpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);//Normalized device coordinate that is not rendered."),ds=Fr,na="\n#ifdef GL_ES\nprecision mediump float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif";var Ss={background:lo("uniform vec4 u_color;uniform float u_opacity;\n#ifdef LIGHTING_3D_MODE\nvarying vec4 v_color;\n#endif\nvoid main() {vec4 out_color;\n#ifdef LIGHTING_3D_MODE\nout_color=v_color;\n#else\nout_color=u_color;\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#ifdef LIGHTING_3D_MODE\nuniform vec4 u_color;varying vec4 v_color;\n#endif\nvoid main() {gl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef LIGHTING_3D_MODE\nv_color=apply_lighting(u_color);\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),backgroundPattern:lo("uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos;void main() {vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_tile_units_to_pixels,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),circle:lo("varying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(\nantialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)\n);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_apply_premultiplied(out_color,v_fog_pos);\n#endif\ngl_FragColor=out_color*(v_visibility*opacity_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","#define NUM_VISIBILITY_RINGS 2\n#define INV_SQRT2 0.70710678\n#define ELEVATION_BIAS 0.0001\n#define NUM_SAMPLES_PER_RING 16\nuniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;\n#endif\nvarying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {\n#if defined(TERRAIN)\nreturn elevation(pos)+ELEVATION_BIAS;\n#else\nreturn 0.0;\n#endif\n}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);\n#ifdef PITCH_WITH_MAP\n#ifdef PROJECTION_GLOBE_VIEW\nreturn u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );\n#else\nreturn u_matrix*( world_center+vec4(sample_offset,0,0) );\n#endif\n#else\nreturn projected_center+vec4(sample_offset,0,0);\n#endif\n}float get_sample_step() {\n#ifdef PITCH_WITH_MAP\nreturn 2.0*PI/float(NUM_SAMPLES_PER_RING);\n#else\nreturn PI/float(NUM_SAMPLES_PER_RING);\n#endif\n}void main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);\n#else \nsurface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);\n#endif\nvec4 projected_center=u_matrix*world_center;float view_scale=0.0;\n#ifdef PITCH_WITH_MAP\n#ifdef SCALE_WITH_MAP\nview_scale=1.0;\n#else\nview_scale=projected_center.w/u_camera_to_center_distance;\n#endif\n#else\n#ifdef SCALE_WITH_MAP\nview_scale=u_camera_to_center_distance;\n#else\nview_scale=projected_center.w;\n#endif\n#endif\ngl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;\n#ifdef TERRAIN\nfloat step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;\n#ifdef PITCH_WITH_MAP\nfloat cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;\n#else\nocclusion_world_center=world_center;occlusion_projected_center=projected_center;\n#endif\nfor(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);\n#else\nvisibility=1.0;\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nvisibility=1.0;\n#endif\nv_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);\n#ifdef FOG\nv_fog_pos=fog_position(world_center.xyz);\n#endif\n}"),clippingMask:lo("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:lo("uniform highp float u_intensity;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef FOG\nif (u_is_globe==0) {gl_FragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;\n#endif\nvarying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#else\npos=vec3(tilePos+extrude,elevation(tilePos));\n#endif\ngl_Position=u_matrix*vec4(pos,1);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),heatmapTexture:lo("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}","attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:lo("varying float v_placed;varying float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);gl_FragColor =mix(red,blue,step(0.5,v_placed))*0.5;gl_FragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}","attribute vec3 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;attribute float a_size_scale;attribute vec2 a_padding;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*elevation(a_anchor_pos),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:lo("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos_2f;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(\nmix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:lo("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;\n#endif\nvarying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;\n#ifdef PROJECTION_GLOBE_VIEW\ngl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);\n#else\ngl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);\n#endif\n}"),fill:lo("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\nvec4 out_color=color;\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillOutline:lo("varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillOutlinePattern:lo("uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;varying vec2 v_pos_world;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;varying vec2 v_pos_world;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillPattern:lo("uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillExtrusion:lo("varying vec4 v_color;\n#ifdef RENDER_SHADOWS\nvarying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;\n#endif\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#ifdef ZERO_ROOF_RADIUS\nvarying vec4 v_roof_color;\n#endif\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nvarying highp vec3 v_normal;\n#endif\nvoid main() {\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nvec3 normal=v_normal;\n#endif\nfloat z;vec4 color;\n#ifdef ZERO_ROOF_RADIUS\nz=float(normal.z > 0.00001);color=mix(v_color,v_roof_color,z);\n#else\ncolor=v_color;\n#endif\n#ifdef FAUX_AO\nfloat intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;\n#ifdef ZERO_ROOF_RADIUS\nconcave*=(1.0-z);\n#endif\nfloat x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);color.rgb=color.rgb*shade;\n#endif\n#ifdef RENDER_SHADOWS\n#ifdef ZERO_ROOF_RADIUS\nnormal=mix(normal,vec3(0.0,0.0,1.0),z);\n#endif\ncolor.xyz=shadowed_color_normal(color.xyz,normalize(normal),v_pos_light_view_0,v_pos_light_view_1,v_depth);\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;\n#endif\nvarying vec4 v_color;\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;\n#endif\n#ifdef ZERO_ROOF_RADIUS\nvarying vec4 v_roof_color;\n#endif\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nvarying highp vec3 v_normal;\n#endif\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nv_normal=normal;\n#endif\nbase=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\nfloat ele=0.0;float h=0.0;float c_ele;vec3 pos;\n#ifdef TERRAIN\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);pos=vec3(pos_nx.xy,h);\n#else\nh=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nfloat lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#endif\nfloat hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);\n#ifdef RENDER_SHADOWS\nv_pos_light_view_0=u_light_matrix_0*vec4(pos,1);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1);v_depth=gl_Position.w;\n#endif\nfloat NdotL=0.0;float colorvalue=0.0;\n#ifdef LIGHTING_3D_MODE\nNdotL=calculate_NdotL(normal);\n#else\ncolorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);\n#endif\nif (normal.y !=0.0) {float r=0.84;\n#ifndef LIGHTING_3D_MODE\nr=mix(0.7,0.98,1.0-u_lightintensity);\n#endif\nNdotL*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}v_color=vec4(0.0,0.0,0.0,1.0);\n#ifdef FAUX_AO\nfloat concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;\n#ifdef TERRAIN\ntop_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);\n#endif\nv_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);\n#ifdef PROJECTION_GLOBE_VIEW\ntop_height+=u_height_lift;\n#endif\ngl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;\n#endif\n#ifdef LIGHTING_3D_MODE\nv_color=apply_lighting(color,NdotL);\n#else\nv_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));\n#endif\nv_color*=u_opacity;\n#ifdef ZERO_ROOF_RADIUS\nv_roof_color=vec4(0.0,0.0,0.0,1.0);\n#ifdef LIGHTING_3D_MODE\nv_roof_color=apply_lighting(color,calculate_NdotL(vec3(0.0,0.0,1.0)));\n#else\nfloat roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));\n#endif\nv_roof_color*=u_opacity;\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),fillExtrusionPattern:lo("uniform vec2 u_texsize;uniform sampler2D u_image;\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#ifdef LIGHTING_3D_MODE\nvarying float v_NdotL;\n#endif\nvarying vec2 v_pos;varying vec4 v_lighting;uniform lowp float u_opacity;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color,v_NdotL)*u_opacity;\n#else\nout_color=out_color*v_lighting;\n#endif\n#ifdef FAUX_AO\nfloat intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;\n#endif\nvarying vec2 v_pos;varying vec4 v_lighting;\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#ifdef LIGHTING_3D_MODE\nvarying float v_NdotL;\n#endif\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\nfloat ele=0.0;float h=z;vec3 p;float c_ele;\n#ifdef TERRAIN\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);p=vec3(pos_nx.xy,h);\n#else\np=vec3(pos_nx.xy,z);\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nfloat lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#endif\nfloat hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0\n? pos_nx.xy\n: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;\n#ifdef LIGHTING_3D_MODE\nNdotL=calculate_NdotL(normal);\n#else\nNdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);\n#endif\nif (normal.y !=0.0) {float r=0.84;\n#ifndef LIGHTING_3D_MODE\nr=mix(0.7,0.98,1.0-u_lightintensity);\n#endif\nNdotL*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}\n#ifdef FAUX_AO\nfloat concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;\n#ifdef TERRAIN\ntop_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);\n#endif\nv_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);\n#ifdef PROJECTION_GLOBE_VIEW\ntop_height+=u_height_lift;\n#endif\ngl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;\n#endif\n#ifdef LIGHTING_3D_MODE\nv_NdotL=NdotL;\n#else\nv_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;\n#endif \n#ifdef FOG\nv_fog_pos=fog_position(p);\n#endif\n}"),hillshadePrepare:lo("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nreturn texture2D(u_image,coord).a/4.0;\n#else\nvec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;\n#endif\n}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(\n(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)\n)/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(\nderiv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:lo("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef LIGHTING_3D_MODE\ngl_FragColor=apply_lighting(gl_FragColor);\n#endif\n#ifdef FOG\ngl_FragColor=fog_dither(fog_apply_premultiplied(gl_FragColor,v_fog_pos));\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),line:lo("uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec4 v_uv;\n#ifdef RENDER_LINE_DASH\nuniform sampler2D u_dash_image;varying vec2 v_tex;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nuniform sampler2D u_gradient_image;\n#endif\nuniform float u_border_width;uniform vec4 u_border_color;float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nfloat linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize lowp vec4 dash\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);\n#ifdef RENDER_LINE_DASH\nfloat sdfdist=texture2D(u_dash_image,v_tex).a;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;alpha*=linearstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);\n#endif\nhighp vec4 out_color;\n#ifdef RENDER_LINE_GRADIENT\nout_color=texture2D(u_gradient_image,v_uv.xy);\n#else\nout_color=color;\n#endif\nfloat trimmed=1.0;\n#ifdef RENDER_LINE_TRIM_OFFSET\nhighp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {out_color=vec4(0,0,0,0);trimmed=0.0;}}\n#endif\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\n#ifdef RENDER_LINE_ALPHA_DISCARD\nif (alpha < u_alpha_discard_threshold) {discard;}\n#endif\n#ifdef RENDER_LINE_BORDER\nfloat edgeBlur=(u_border_width+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);\n#ifdef RENDER_LINE_BORDER_AUTO\nfloat Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}\n#else\nout_color.rgb=mix(u_border_color.rgb*u_border_color.a*trimmed,out_color.rgb,smoothAlpha);\n#endif\n}\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define EXTRUDE_SCALE 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;\n#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)\nattribute highp vec4 a_packed;\n#endif\n#ifdef RENDER_LINE_DASH\nattribute float a_linesofar;\n#endif\nuniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec4 v_uv;\n#ifdef RENDER_LINE_DASH\nuniform vec2 u_texsize;uniform float u_tile_units_to_pixels;varying vec2 v_tex;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nuniform float u_image_height;\n#endif\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize lowp vec4 dash\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\n#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)\nfloat a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];\n#ifdef RENDER_LINE_GRADIENT\nhighp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);\n#else\nv_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);\n#endif\n#endif\n#ifdef RENDER_LINE_DASH\nfloat scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/floorwidth,(-normal.y*height+dash.x+0.5)/u_texsize.y);\n#endif\nv_width2=vec2(outset,inset);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),linePattern:lo("uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;vec2 pattern_size=vec2(display_size.x/u_tile_units_to_pixels,display_size.y);float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x=mod(v_linesofar/pattern_size.x*aspect,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));vec4 color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\ncolor=apply_lighting(color);\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\nv_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),raster:lo("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(\ndot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply(out_color,v_fog_pos));\n#endif\ngl_FragColor=vec4(out_color*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {float w=1.0+dot(a_texture_pos,u_perspective_transform);gl_Position=u_matrix*vec4(a_pos*w,0,w);v_pos0=a_texture_pos/8192.0;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),symbolIcon:lo("uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform vec3 u_up_vector;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nvarying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjected_point;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetProjected_point=u_matrix*vec4(a_globe_anchor+displacement,1);\n#else\noffsetProjected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);\n#endif\nvec2 a=projected_point.xy/projected_point.w;vec2 b=offsetProjected_point.xy/offsetProjected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#endif\nfloat projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nv_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;}"),symbolSDF:lo("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nvarying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);\n#else\noffsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);\n#endif\nvec2 a=projected_point.xy/projected_point.w;vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#endif\nfloat gamma_scale=gl_Position.w;float projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nvec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade);}"),symbolTextAndIcon:lo("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_projected_pos;attribute float a_fade_opacity;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nvarying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offset_projected_point=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offset_projected_point.xy/offset_projected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*font_scale);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#endif\nfloat gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nv_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade,is_sdf);}"),terrainRaster:lo("uniform sampler2D u_image0;varying vec2 v_pos0;\n#ifdef FOG\nvarying float v_fog_opacity;\n#endif\n#ifdef RENDER_SHADOWS\nvarying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;\n#endif\nvoid main() {vec4 color=texture2D(u_image0,v_pos0);\n#ifdef RENDER_SHADOWS\ncolor.xyz=shadowed_color(color.xyz,v_pos_light_view_0,v_pos_light_view_1,v_depth);\n#endif\n#ifdef FOG\n#ifdef ZERO_EXAGGERATION\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#else\ncolor=fog_dither(fog_apply_from_vert(color,v_fog_opacity));\n#endif\n#endif\ngl_FragColor=color;\n#ifdef TERRAIN_WIREFRAME\ngl_FragColor=vec4(1.0,0.0,0.0,0.8);\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_skirt_height;attribute vec2 a_pos;varying vec2 v_pos0;\n#ifdef FOG\nvarying float v_fog_opacity;\n#endif\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;\n#endif\nconst float wireframeOffset=0.00015;void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;\n#ifdef TERRAIN_WIREFRAME\nelevation+=wireframeOffset;\n#endif\nv_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);\n#ifdef FOG\n#ifdef ZERO_EXAGGERATION\nv_fog_pos=fog_position(decodedPos);\n#else\nv_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));\n#endif\n#endif\n#ifdef RENDER_SHADOWS\nvec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);v_depth=gl_Position.w;\n#endif\n}"),terrainDepth:lo("#ifdef GL_ES\nprecision highp float;\n#endif\nvarying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}","uniform mat4 u_matrix;attribute vec2 a_pos;varying float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}"),skybox:lo("\nvarying lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(\ncos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=textureCube(u_cubemap,uv).rgb;\n#ifdef FOG\nsky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);\n#endif\nsky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);gl_FragColor=vec4(sky_color*u_opacity,u_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}",Br),skyboxGradient:lo("varying highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture2D(u_color_ramp,vec2(progress,0.5));\n#ifdef FOG\ncolor.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;\n#endif\ncolor*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}",Br),skyboxCapture:lo("\nvarying highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;\n#ifdef GL_ES\nprecision highp float;\n#endif\n#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)\n#define BETA_M                  vec3(21e-6,21e-6,21e-6)\n#define MIE_G                   0.76\n#define DENSITY_HEIGHT_SCALE_R  8000.0\n#define DENSITY_HEIGHT_SCALE_M  1200.0\n#define PLANET_RADIUS           6360e3\n#define ATMOSPHERE_RADIUS       6420e3\n#define SAMPLE_STEPS            10\n#define DENSITY_STEPS           4\nfloat ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;gl_FragColor=vec4(color,1.0);}","attribute highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;varying highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:lo("uniform sampler2D u_image0;varying vec2 v_pos0;\n#ifndef FOG\nuniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;\n#endif\nvoid main() {vec4 color;\n#ifdef CUSTOM_ANTIALIASING\nvec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture2D(u_image0,v_pos0);color=vec4(raster.rgb*antialias,raster.a*antialias);\n#else\ncolor=texture2D(u_image0,v_pos0);\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color;\n#ifdef TERRAIN_WIREFRAME\ngl_FragColor=vec4(1.0,0.0,0.0,0.8);\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;\n#ifdef GLOBE_POLES\nattribute vec3 a_globe_pos;attribute vec2 a_uv;\n#else\nattribute vec2 a_pos;\n#endif\nvarying vec2 v_pos0;const float wireframeOffset=1e3;float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(QUARTER_PI+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}void main() {\n#ifdef GLOBE_POLES\nvec3 globe_pos=a_globe_pos;vec2 uv=a_uv;\n#else\nfloat tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);\n#endif\nv_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;\n#ifdef GLOBE_POLES\nvec3 up_vector=globe_derived_up_vector;\n#else\nvec3 up_vector=elevationVector(tile_pos);\n#endif\nfloat height=elevation(tile_pos);\n#ifdef TERRAIN_WIREFRAME\nheight+=wireframeOffset;\n#endif\nglobe_pos+=up_vector*height;\n#ifndef GLOBE_POLES\nglobe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;\n#endif\n#ifdef GLOBE_POLES\nvec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);\n#else\nvec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);\n#endif\ngl_Position=u_proj_matrix*interpolated_pos;\n#ifdef FOG\nv_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);\n#endif\n}"),globeAtmosphere:lo("uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec3 u_start_color;uniform vec4 u_color;uniform vec4 u_space_color;uniform vec4 u_high_color;uniform float u_star_intensity;uniform float u_star_size;uniform float u_star_density;uniform float u_horizon_angle;uniform mat4 u_rotation_matrix;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;highp float random(highp vec3 p) {p=fract(p*vec3(23.2342,97.1231,91.2342));p+=dot(p.zxy,p.yxz+123.1234);return fract(p.x*p.y);}float stars(vec3 p,float scale,vec2 offset) {vec2 uv_scale=(u_viewport/u_star_size)*scale;vec3 position=vec3(p.xy*uv_scale+offset*u_viewport,p.z);vec3 q=fract(position)-0.5;vec3 id=floor(position);float random_visibility=step(random(id),u_star_density);float circle=smoothstep(0.5+u_star_intensity,0.5,length(q));return circle*random_visibility;}void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;\n#ifdef PROJECTION_GLOBE_VIEW\nglobe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {discard;return;}\n#endif\nhighp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?\n0.0 : max(acos(dot(dir,horizon_dir)),0.0);float horizon_angle;\n#ifdef PROJECTION_GLOBE_VIEW\nhighp vec3 closest_point=globe_pos_dot_dir*dir;float closest_point_to_center=length(closest_point-u_globe_pos);float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?\nPI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);\n#else\nhorizon_angle=horizon_angle_mercator;\n#endif\nhorizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c =mix(color_stop_2,c2,t);float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);vec2 uv=gl_FragCoord.xy/u_viewport-0.5;float aspect_ratio=u_viewport.x/u_viewport.y;vec4 uv_dir=vec4(normalize(vec3(uv.x*aspect_ratio,uv.y,1.0)),1.0);uv_dir=u_rotation_matrix*uv_dir;vec3 n=abs(uv_dir.xyz);vec2 uv_remap=(n.x > n.y && n.x > n.z) ? uv_dir.yz/uv_dir.x:\n(n.y > n.x && n.y > n.z) ? uv_dir.zx/uv_dir.y:\nuv_dir.xy/uv_dir.z;uv_remap.x/=aspect_ratio;vec3 D=vec3(uv_remap,1.0);highp float star_field=0.0;if (u_star_intensity > 0.0) {star_field+=stars(D,1.2,vec2(0.0,0.0));star_field+=stars(D,1.0,vec2(1.0,0.0));star_field+=stars(D,0.8,vec2(0.0,1.0));star_field+=stars(D,0.6,vec2(1.0,1.0));star_field*=(1.0-pow(t,0.25+(1.0-u_high_color.a)*0.75));c+=star_field*alpha_2;}c=dither(c,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=vec4(c,a);}","attribute vec3 a_pos;attribute vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(\nmix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}")};function Sr(p,o){const c=p.replace(/\s*\/\/[^\n]*\n/g,"\n").split("\n");for(let m of c)if(m=m.trim(),"#"===m[0]&&m.includes("if")&&!m.includes("endif")){m=m.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const b=m.split(" ");for(const T of b)o.includes(T)||o.push(T)}}function lo(p,o){const c=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,m=o.match(/attribute (highp |mediump |lowp )?([\w]+) ([\w]+)/g),b={},T=[...ws];return Sr(p,T),Sr(o,T),{fragmentSource:p=p.replace(c,(I,O,N,H,$)=>(b[$]=!0,"define"===O?`\n#ifndef HAS_UNIFORM_u_${$}\nvarying ${N} ${H} ${$};\n#else\nuniform ${N} ${H} u_${$};\n#endif\n`:`\n#ifdef HAS_UNIFORM_u_${$}\n    ${N} ${H} ${$} = u_${$};\n#endif\n`)),vertexSource:o=o.replace(c,(I,O,N,H,$)=>{const ce="float"===H?"vec2":"vec4",Ie=$.match(/color/)?"color":ce;return b[$]?"define"===O?`\n#ifndef HAS_UNIFORM_u_${$}\nuniform lowp float u_${$}_t;\nattribute ${N} ${ce} a_${$};\nvarying ${N} ${H} ${$};\n#else\nuniform ${N} ${H} u_${$};\n#endif\n`:"vec4"===Ie?`\n#ifndef HAS_UNIFORM_u_${$}\n    ${$} = a_${$};\n#else\n    ${N} ${H} ${$} = u_${$};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${$}\n    ${$} = unpack_mix_${Ie}(a_${$}, u_${$}_t);\n#else\n    ${N} ${H} ${$} = u_${$};\n#endif\n`:"define"===O?`\n#ifndef HAS_UNIFORM_u_${$}\nuniform lowp float u_${$}_t;\nattribute ${N} ${ce} a_${$};\n#else\nuniform ${N} ${H} u_${$};\n#endif\n`:"vec4"===Ie?`\n#ifndef HAS_UNIFORM_u_${$}\n    ${N} ${H} ${$} = a_${$};\n#else\n    ${N} ${H} ${$} = u_${$};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${$}\n    ${N} ${H} ${$} = unpack_mix_${Ie}(a_${$}, u_${$}_t);\n#else\n    ${N} ${H} ${$} = u_${$};\n#endif\n`}),staticAttributes:m,usedDefines:T}}class ia{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(o,c,m,b,T,I,O){this.context=o;let N=this.boundPaintVertexBuffers.length!==b.length;for(let $=0;!N&&$<b.length;$++)this.boundPaintVertexBuffers[$]!==b[$]&&(N=!0);let H=this.boundDynamicVertexBuffers.length!==O.length;for(let $=0;!H&&$<O.length;$++)this.boundDynamicVertexBuffers[$]!==O[$]&&(H=!0);if(!o.extVertexArrayObject||!this.vao||this.boundProgram!==c||this.boundLayoutVertexBuffer!==m||N||H||this.boundIndexBuffer!==T||this.boundVertexOffset!==I)this.freshBind(c,m,b,T,I,O);else{o.bindVertexArrayOES.set(this.vao);for(const $ of O)$&&$.bind();T&&T.dynamicDraw&&T.bind()}}freshBind(o,c,m,b,T,I){let O;const N=o.numAttributes,H=this.context,$=H.gl;if(H.extVertexArrayObject)this.vao&&this.destroy(),this.vao=H.extVertexArrayObject.createVertexArrayOES(),H.bindVertexArrayOES.set(this.vao),O=0,this.boundProgram=o,this.boundLayoutVertexBuffer=c,this.boundPaintVertexBuffers=m,this.boundIndexBuffer=b,this.boundVertexOffset=T,this.boundDynamicVertexBuffers=I;else{O=H.currentNumAttributes||0;for(let ce=N;ce<O;ce++)$.disableVertexAttribArray(ce)}c.enableAttributes($,o),c.bind(),c.setVertexAttribPointers($,o,T);for(const ce of m)ce.enableAttributes($,o),ce.bind(),ce.setVertexAttribPointers($,o,T);for(const ce of I)ce&&(ce.enableAttributes($,o),ce.bind(),ce.setVertexAttribPointers($,o,T));b&&b.bind(),H.currentNumAttributes=N}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function Ps(p,o){const c=Math.pow(2,o.canonical.z),m=o.canonical.y;return[new s.MercatorCoordinate(0,m/c).toLngLat().lat,new s.MercatorCoordinate(0,(m+1)/c).toLngLat().lat]}function wr(p,o,c,m,b,T,I){const O=p.context,N=O.gl,H=c.fbo;if(!H)return;p.prepareDrawTile();const $=p.useProgram("hillshade");O.activeTexture.set(N.TEXTURE0),N.bindTexture(N.TEXTURE_2D,H.colorAttachment.get());const ce=((Ye,nt,ue,$e)=>{const pt=ue.paint.get("hillshade-shadow-color"),ht=ue.paint.get("hillshade-highlight-color"),Ot=ue.paint.get("hillshade-accent-color");let kt=ue.paint.get("hillshade-illumination-direction")*(Math.PI/180);"viewport"===ue.paint.get("hillshade-illumination-anchor")&&(kt-=Ye.transform.angle);const Rt=!Ye.options.moving;return{u_matrix:$e||Ye.transform.calculateProjMatrix(nt.tileID.toUnwrapped(),Rt),u_image:0,u_latrange:Ps(0,nt.tileID),u_light:[ue.paint.get("hillshade-exaggeration"),kt],u_shadow:pt,u_highlight:ht,u_accent:Ot}})(p,c,m,p.terrain?o.projMatrix:null);p.prepareDrawProgram(O,$,o.toUnwrapped());const{tileBoundsBuffer:Ie,tileBoundsIndexBuffer:je,tileBoundsSegments:Ke}=p.getTileBoundsBuffers(c);$.draw(O,N.TRIANGLES,b,T,I,s.CullFaceMode.disabled,ce,m.id,Ie,je,Ke)}function Wa(p,o,c){if(!o.needsDEMTextureUpload)return;const m=p.context,b=m.gl;m.pixelStoreUnpackPremultiplyAlpha.set(!1),o.demTexture=o.demTexture||p.getTileTexture(c.stride);const T=c.getPixels();o.demTexture?o.demTexture.update(T,{premultiply:!1}):o.demTexture=new s.Texture(m,T,b.RGBA,{premultiply:!1}),o.needsDEMTextureUpload=!1}function Pr(p,o,c,m,b,T){const I=p.context,O=I.gl;if(!o.dem)return;const N=o.dem;if(I.activeTexture.set(O.TEXTURE1),Wa(p,o,N),!o.demTexture)return;o.demTexture.bind(O.NEAREST,O.CLAMP_TO_EDGE);const H=N.dim;I.activeTexture.set(O.TEXTURE0);let $=o.fbo;if(!$){const Ke=new s.Texture(I,{width:H,height:H,data:null},O.RGBA);Ke.bind(O.LINEAR,O.CLAMP_TO_EDGE),$=o.fbo=I.createFramebuffer(H,H,!0),$.colorAttachment.set(Ke.texture)}I.bindFramebuffer.set($.framebuffer),I.viewport.set([0,0,H,H]);const{tileBoundsBuffer:ce,tileBoundsIndexBuffer:Ie,tileBoundsSegments:je}=p.getMercatorTileBoundsBuffers();p.useProgram("hillshadePrepare").draw(I,O.TRIANGLES,m,b,T,s.CullFaceMode.disabled,((Ke,Ye)=>{const nt=Ye.stride,ue=s.create();return s.ortho(ue,0,s.EXTENT,-s.EXTENT,0,0,1),s.translate(ue,ue,[0,-s.EXTENT,0]),{u_matrix:ue,u_image:1,u_dimension:[nt,nt],u_zoom:Ke.overscaledZ,u_unpack:Ye.unpackVector}})(o.tileID,N),c.id,ce,Ie,je),o.needsHillshadePrepare=!1}const Nr=p=>({u_matrix:new s.UniformMatrix4f(p),u_image0:new s.Uniform1i(p),u_skirt_height:new s.Uniform1f(p)}),Gs=(p,o)=>({u_matrix:p,u_image0:0,u_skirt_height:o}),Cs=(p,o,c,m,b,T,I,O,N,H,$,ce,Ie,je,Ke)=>({u_proj_matrix:Float32Array.from(p),u_globe_matrix:o,u_normalize_matrix:Float32Array.from(m),u_merc_matrix:c,u_zoom_transition:b,u_merc_center:T,u_image0:0,u_frustum_tl:I,u_frustum_tr:O,u_frustum_br:N,u_frustum_bl:H,u_globe_pos:$,u_globe_radius:ce,u_viewport:Ie,u_grid_matrix:Ke?Float32Array.from(Ke):new Float32Array(9),u_skirt_height:je});function Ts(p,o){return null!=p&&null!=o&&!(!p.hasData()||!o.hasData())&&null!=p.demTexture&&null!=o.demTexture&&p.tileID.key!==o.tileID.key}const pr=new class{constructor(){this.operations={}}newMorphing(p,o,c,m,b){if(p in this.operations){const T=this.operations[p];T.to.tileID.key!==c.tileID.key&&(T.queued=c)}else this.operations[p]={startTime:m,phase:0,duration:b,from:o,to:c,queued:null}}getMorphValuesForProxy(p){if(!(p in this.operations))return null;const o=this.operations[p];return{from:o.from,to:o.to,phase:o.phase}}update(p){for(const o in this.operations){const c=this.operations[o];for(c.phase=(p-c.startTime)/c.duration;c.phase>=1||!this._validOp(c);)if(!this._nextOp(c,p)){delete this.operations[o];break}}}_nextOp(p,o){return!!p.queued&&(p.from=p.to,p.to=p.queued,p.queued=null,p.phase=0,p.startTime=o,!0)}_validOp(p){return p.from.hasData()&&p.to.hasData()}},Cr={0:null,1:"TERRAIN_VERTEX_MORPHING",2:"TERRAIN_WIREFRAME"};function Ma(p){return 6*Math.pow(1.5,22-p)}function oa(p,o){const c=1<<p.z;return!o&&(0===p.x||p.x===c-1)||0===p.y||p.y===c-1}const S=p=>({u_matrix:p});function re(p,o,c,m,b){if(b>0){const T=s.exported.now(),I=(T-p.timeAdded)/b,O=o?(T-o.timeAdded)/b:-1,N=c.getSource(),H=m.coveringZoomLevel({tileSize:N.tileSize,roundZoom:N.roundZoom}),$=!o||Math.abs(o.tileID.overscaledZ-H)>Math.abs(p.tileID.overscaledZ-H),ce=$&&p.refreshedUponExpiration?1:s.clamp($?I:1-O,0,1);return p.refreshedUponExpiration&&I>=1&&(p.refreshedUponExpiration=!1),o?{opacity:1,mix:1-ce}:{opacity:ce,mix:0}}return{opacity:1,mix:0}}class P extends s.SourceCache{constructor(o){const c={type:"raster-dem",maxzoom:o.transform.maxZoom},m=new dt(bt(),null),b=Ft("mock-dem",c,m,o.style);super("mock-dem",b,!1),b.setEventedParent(this),this._sourceLoaded=!0}_loadTile(o,c){o.state="loaded",c(null)}}class ne extends s.SourceCache{constructor(o){const c=Ft("proxy",{type:"geojson",maxzoom:o.transform.maxZoom},new dt(bt(),null),o.style);super("proxy",c,!1),c.setEventedParent(this),this.map=this.getSource().map=o,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(o,c,m){if(o.freezeTileCoverage)return;this.transform=o;const b=o.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((T,I)=>{if(T[I.key]="",!this._tiles[I.key]){const O=new s.Tile(I,this._source.tileSize*I.overscaleFactor(),o.tileZoom);O.state="loaded",this._tiles[I.key]=O}return T},{});for(const T in this._tiles)T in b||(this.freeFBO(T),this._tiles[T].unloadVectorData(),delete this._tiles[T])}freeFBO(o){const c=this.proxyCachedFBO[o];if(void 0!==c){const m=Object.values(c);this.renderCachePool.push(...m),delete this.proxyCachedFBO[o]}}deallocRenderCache(){this.renderCache.forEach(o=>o.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class He extends s.OverscaledTileID{constructor(o,c,m){super(o.overscaledZ,o.wrap,o.canonical.z,o.canonical.x,o.canonical.y),this.proxyTileKey=c,this.projMatrix=m}}class Ln extends s.Elevation{constructor(o,c){super(),this.painter=o,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[m,b,T]=function(N){const H=new s.StructArrayLayout2i4,$=new s.StructArrayLayout3ui6;H.reserve(17161),$.reserve(33800);const Ie=s.EXTENT/128,je=s.EXTENT+Ie/2,Ke=je+Ie;for(let nt=-Ie;nt<Ke;nt+=Ie)for(let ue=-Ie;ue<Ke;ue+=Ie){const $e=ue<0||ue>je||nt<0||nt>je?24575:0,pt=s.clamp(Math.round(ue),0,s.EXTENT),ht=s.clamp(Math.round(nt),0,s.EXTENT);H.emplaceBack(pt+$e,ht)}const Ye=(nt,ue)=>{const $e=131*ue+nt;$.emplaceBack($e+1,$e,$e+131),$.emplaceBack($e+131,$e+131+1,$e+1)};for(let nt=1;nt<129;nt++)for(let ue=1;ue<129;ue++)Ye(ue,nt);return[0,129].forEach(nt=>{for(let ue=0;ue<130;ue++)Ye(ue,nt),Ye(nt,ue)}),[H,$,32768]}(),I=o.context;this.gridBuffer=I.createVertexBuffer(m,s.posAttributes.members),this.gridIndexBuffer=I.createIndexBuffer(b),this.gridSegments=s.SegmentVector.simpleSegment(0,0,m.length,b.length),this.gridNoSkirtSegments=s.SegmentVector.simpleSegment(0,0,m.length,T),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new ne(c.map),this.orthoMatrix=s.create(),s.ortho(this.orthoMatrix,"globe"===this.painter.transform.projection.name?.015:0,s.EXTENT,0,s.EXTENT,0,1);const O=I.gl;this._overlapStencilMode=new s.StencilMode({func:O.GEQUAL,mask:255},0,255,O.KEEP,O.KEEP,O.REPLACE),this._previousZoom=o.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=c,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new P(c.map)}set style(o){o.on("data",this._onStyleDataEvent.bind(this)),o.on("neworder",this._checkRenderCacheEfficiency.bind(this)),this._style=o,this._checkRenderCacheEfficiency(),this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(o,c,m){if(o&&o.terrain){this._style!==o&&(this.style=o),this.enabled=!0;const b=o.terrain.properties;this.sourceCache=0===o.terrain.drapeRenderMode?this._mockSourceCache:o._getSourceCache(b.get("source")),this._exaggeration=b.get("exaggeration");const T=()=>{this.sourceCache.used&&s.warnOnce(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.\nThis leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const I=this.getScaledDemTileSize();this.sourceCache.update(c,I,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,T(),this._initializing=!0),T(),c.updateElevation(!0,m),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(c),this._emptyDEMTextureDirty=!0}else this._disable()}resetTileLookupCache(o){this._findCoveringTileCache[o]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_checkRenderCacheEfficiency(){const o=this.renderCacheEfficiency(this._style);this._style.map._optimizeForTerrain||100!==o.efficiency&&s.warnOnce(`Terrain render cache efficiency is not optimal (${o.efficiency}%) and performance\n                may be affected negatively, consider placing all background, fill and line layers before layer\n                with id '${o.firstUndrapedLayer}' or create a map using optimizeForTerrain: true option.`)}_onStyleDataEvent(o){o.coord&&"source"===o.dataType?this._clearRenderCacheForTile(o.sourceCacheId,o.coord):"style"===o.dataType&&(this._invalidateRenderCache=!0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const o in this._style._sourceCaches)this._style._sourceCaches[o].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this._emptyDepthBufferTexture&&this._emptyDepthBufferTexture.destroy(),this.pool.forEach(o=>o.fb.destroy()),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0)}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const o=2*this.proxySourceCache.getSource().tileSize;return[o,o]}set useVertexMorphing(o){this._useVertexMorphing=o}updateTileBinding(o){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const c=this.proxySourceCache,m=this.painter.transform;this._initializing&&(this._initializing=0===m._centerAltitude&&-1===this.getAtPointOrZero(s.MercatorCoordinate.fromLngLat(m.center),-1),this._emptyDEMTextureDirty=!this._initializing);const b=this.proxyCoords=c.getIds().map(N=>{const H=c.getTileByID(N).tileID;return H.projMatrix=m.calculateProjMatrix(H.toUnwrapped()),H});(function(N,H){const $=H.transform.pointCoordinate(H.transform.getCameraPoint()),ce=new s.Point($.x,$.y);N.sort((Ie,je)=>{if(je.overscaledZ-Ie.overscaledZ)return je.overscaledZ-Ie.overscaledZ;const Ke=new s.Point(Ie.canonical.x+(1<<Ie.canonical.z)*Ie.wrap,Ie.canonical.y),Ye=new s.Point(je.canonical.x+(1<<je.canonical.z)*je.wrap,je.canonical.y),nt=ce.mult(1<<Ie.canonical.z);return nt.x-=.5,nt.y-=.5,nt.distSqr(Ke)-nt.distSqr(Ye)})})(b,this.painter),this._previousZoom=m.zoom;const T=this.proxyToSource||{};this.proxyToSource={},b.forEach(N=>{this.proxyToSource[N.key]={}}),this.terrainTileForTile={};const I=this._style._sourceCaches;for(const N in I){const H=I[N];if(!H.used||(H!==this.sourceCache&&this.resetTileLookupCache(H.id),this._setupProxiedCoordsForOrtho(H,o[N],T),H.usedForTerrain))continue;const $=o[N];H.getSource().reparseOverscaled&&this._assignTerrainTiles($)}this.proxiedCoords[c.id]=b.map(N=>new He(N,N.key,this.orthoMatrix)),this._assignTerrainTiles(b),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(T),this.renderingToTexture=!1,this._updateTimestamp=s.exported.now();const O={};this._visibleDemTiles=[];for(const N of this.proxyCoords){const H=this.terrainTileForTile[N.key];if(!H)continue;const $=H.tileID.key;$ in O||(this._visibleDemTiles.push(H),O[$]=$)}}_assignTerrainTiles(o){this._initializing||o.forEach(c=>{if(this.terrainTileForTile[c.key])return;const m=this._findTileCoveringTileID(c,this.sourceCache);m&&(this.terrainTileForTile[c.key]=m)})}_prepareDEMTextures(){const o=this.painter.context,c=o.gl;for(const m in this.terrainTileForTile){const b=this.terrainTileForTile[m],T=b.dem;!T||b.demTexture&&!b.needsDEMTextureUpload||(o.activeTexture.set(c.TEXTURE1),Wa(this.painter,b,T))}}_prepareDemTileUniforms(o,c,m,b){if(!c||null==c.demTexture)return!1;const T=o.tileID.canonical,I=Math.pow(2,c.tileID.canonical.z-T.z),O=b||"";return m[`u_dem_tl${O}`]=[T.x*I%1,T.y*I%1],m[`u_dem_scale${O}`]=I,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}get emptyDepthBufferTexture(){const o=this.painter.context,c=o.gl;if(!this._emptyDepthBufferTexture){const m=new s.RGBAImage({width:1,height:1},Uint8Array.of(255,255,255,255));this._emptyDepthBufferTexture=new s.Texture(o,m,c.RGBA,{premultiply:!1})}return this._emptyDepthBufferTexture}_getLoadedAreaMinimum(){let o=0;const c=this._visibleDemTiles.reduce((m,b)=>{if(!b.dem)return m;const T=b.dem.tree.minimums[0];return T>0&&o++,m+T},0);return o?c/o:0}_updateEmptyDEMTexture(){const o=this.painter.context,c=o.gl;o.activeTexture.set(c.TEXTURE2);const m=this._getLoadedAreaMinimum(),b=new s.RGBAImage({width:1,height:1},new Uint8Array(s.DEMData.pack(m,this.sourceCache.getSource().encoding)));this._emptyDEMTextureDirty=!1;let T=this._emptyDEMTexture;return T?T.update(b,{premultiply:!1}):T=this._emptyDEMTexture=new s.Texture(o,b,c.RGBA,{premultiply:!1}),T}setupElevationDraw(o,c,m){const b=this.painter.context,T=b.gl,I=(O=this.sourceCache.getSource().encoding,{u_dem:2,u_dem_prev:4,u_dem_unpack:s.DEMData.getUnpackVector(O),u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0});var O;I.u_dem_size=this.sourceCache.getSource().tileSize,I.u_exaggeration=this.exaggeration();let N=null,H=null,$=1;if(m&&m.morphing&&this._useVertexMorphing){const ce=m.morphing.srcDemTile,Ie=m.morphing.dstDemTile;$=m.morphing.phase,ce&&Ie&&(this._prepareDemTileUniforms(o,ce,I,"_prev")&&(H=ce),this._prepareDemTileUniforms(o,Ie,I)&&(N=Ie))}if(H&&N?(b.activeTexture.set(T.TEXTURE2),N.demTexture.bind(T.NEAREST,T.CLAMP_TO_EDGE,T.NEAREST),b.activeTexture.set(T.TEXTURE4),H.demTexture.bind(T.NEAREST,T.CLAMP_TO_EDGE,T.NEAREST),I.u_dem_lerp=$):(N=this.terrainTileForTile[o.tileID.key],b.activeTexture.set(T.TEXTURE2),(this._prepareDemTileUniforms(o,N,I)?N.demTexture:this.emptyDEMTexture).bind(T.NEAREST,T.CLAMP_TO_EDGE)),b.activeTexture.set(T.TEXTURE3),m&&m.useDepthForOcclusion?(this._depthTexture&&this._depthTexture.bind(T.NEAREST,T.CLAMP_TO_EDGE),this._depthFBO&&(I.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height])):(this.emptyDepthBufferTexture.bind(T.NEAREST,T.CLAMP_TO_EDGE),I.u_depth_size_inv=[1,1]),m&&m.useMeterToDem&&N){const ce=(1<<N.tileID.canonical.z)*s.mercatorZfromAltitude(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;I.u_meter_to_dem=ce}if(m&&m.labelPlaneMatrixInv&&(I.u_label_plane_matrix_inv=m.labelPlaneMatrixInv),c.setTerrainUniformValues(b,I),"globe"===this.painter.transform.projection.name){const ce=this.globeUniformValues(this.painter.transform,o.tileID.canonical,m&&m.useDenormalizedUpVectorScale);c.setGlobeUniformValues(b,ce)}}globeUniformValues(o,c,m){const b=o.projection;return{u_tile_tl_up:b.upVector(c,0,0),u_tile_tr_up:b.upVector(c,s.EXTENT,0),u_tile_br_up:b.upVector(c,s.EXTENT,s.EXTENT),u_tile_bl_up:b.upVector(c,0,s.EXTENT),u_tile_up_scale:m?s.globeMetersToEcef(1):b.upVectorScale(c,o.center.lat,o.worldSize).metersToTile}}renderToBackBuffer(o){const c=this.painter,m=this.painter.context;0!==o.length&&(m.bindFramebuffer.set(null),m.viewport.set([0,0,c.width,c.height]),c.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(b,T,I,O,N){if("globe"===b.transform.projection.name)!function(H,$,ce,Ie,je){const Ke=H.context,Ye=Ke.gl;let nt,ue;const $e=H.options.showTerrainWireframe?2:0,pt=H.transform,ht=s.globeUseCustomAntiAliasing(H,Ke,pt),Ot=(jn,cn)=>{if(ue===jn)return;const Mn=[Cr[jn],"PROJECTION_GLOBE_VIEW"];ht&&Mn.push("CUSTOM_ANTIALIASING"),cn&&Mn.push(Cr[$e]),nt=H.useProgram("globeRaster",null,Mn),ue=jn},kt=H.colorModeForRenderPass(),Rt=new s.DepthMode(Ye.LEQUAL,s.DepthMode.ReadWrite,H.depthRangeFor3D);pr.update(je);const Yt=s.calculateGlobeMercatorMatrix(pt),$t=[s.mercatorXfromLng(pt.center.lng),s.mercatorYfromLat(pt.center.lat)],ln=$e?[!1,!0]:[!1],Gn=H.globeSharedBuffers,on=[pt.width*s.exported.devicePixelRatio,pt.height*s.exported.devicePixelRatio],An=Float32Array.from(pt.globeMatrix),hn={useDenormalizedUpVectorScale:!0};if(ln.forEach(jn=>{const cn=H.transform,Mn=Ma(cn.zoom)*$.exaggeration();ue=-1;const Vn=jn?Ye.LINES:Ye.TRIANGLES;for(const Bn of Ie){const qn=ce.getTile(Bn),Ti=s.StencilMode.disabled,Vi=$.prevTerrainTileForTile[Bn.key],_i=$.terrainTileForTile[Bn.key];Ts(Vi,_i)&&pr.newMorphing(Bn.key,Vi,_i,je,250),Ke.activeTexture.set(Ye.TEXTURE0),qn.texture.bind(Ye.LINEAR,Ye.CLAMP_TO_EDGE);const Oi=pr.getMorphValuesForProxy(Bn.key),po=Oi?1:0;Oi&&s.extend$1(hn,{morphing:{srcDemTile:Oi.from,dstDemTile:Oi.to,phase:s.easeCubicInOut(Oi.phase)}});const mo=s.tileCornersToBounds(Bn.canonical),bi=s.getLatitudinalLod(mo.getCenter().lat),Fo=s.getGridMatrix(Bn.canonical,mo,bi,cn.worldSize/cn._pixelsPerMercatorPixel),Bo=s.globeNormalizeECEF(s.globeTileBounds(Bn.canonical)),No=Cs(cn.projMatrix,An,Yt,Bo,s.globeToMercatorTransition(cn.zoom),$t,cn.frustumCorners.TL,cn.frustumCorners.TR,cn.frustumCorners.BR,cn.frustumCorners.BL,cn.globeCenterInViewSpace,cn.globeRadius,on,Mn,Fo);if(Ot(po,jn),$.setupElevationDraw(qn,nt,hn),H.prepareDrawProgram(Ke,nt,Bn.toUnwrapped()),Gn){const[zo,gs,Yr]=jn?Gn.getWirefameBuffers(H.context,bi):Gn.getGridBuffers(bi,0!==Mn);nt.draw(Ke,Vn,Rt,Ti,kt,s.CullFaceMode.backCCW,No,"globe_raster",zo,gs,Yr)}}}),Gn){const jn=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];ht&&jn.push("CUSTOM_ANTIALIASING"),nt=H.useProgram("globeRaster",null,jn);for(const cn of Ie){const{x:Mn,y:Vn,z:Bn}=cn.canonical,qn=0===Vn,Ti=Vn===(1<<Bn)-1,[Vi,_i,Oi,po]=Gn.getPoleBuffers(Bn);if(po&&(qn||Ti)){const mo=ce.getTile(cn);Ke.activeTexture.set(Ye.TEXTURE0),mo.texture.bind(Ye.LINEAR,Ye.CLAMP_TO_EDGE);let bi=s.globePoleMatrixForTile(Bn,Mn,pt);const Fo=s.globeNormalizeECEF(s.globeTileBounds(cn.canonical)),Bo=(No,zo)=>No.draw(Ke,Ye.TRIANGLES,Rt,s.StencilMode.disabled,kt,s.CullFaceMode.disabled,Cs(pt.projMatrix,bi,bi,Fo,0,$t,pt.frustumCorners.TL,pt.frustumCorners.TR,pt.frustumCorners.BR,pt.frustumCorners.BL,pt.globeCenterInViewSpace,pt.globeRadius,on,0),"globe_pole_raster",zo,Oi,po);$.setupElevationDraw(mo,nt,hn),H.prepareDrawProgram(Ke,nt,cn.toUnwrapped()),qn&&Bo(nt,Vi),Ti&&(bi=s.scale(s.create(),bi,[1,-1,1]),Bo(nt,_i))}}}}(b,T,I,O,N);else{const H=b.context,$=H.gl;let ce,Ie;const je=b.options.showTerrainWireframe?2:0,Ke=(pt,ht)=>{if(Ie===pt)return;const Ot=[Cr[pt]];ht&&Ot.push(Cr[je]),ce=b.useProgram("terrainRaster",null,Ot),Ie=pt},Ye=b.colorModeForRenderPass(),nt=new s.DepthMode($.LEQUAL,s.DepthMode.ReadWrite,b.depthRangeFor3D);pr.update(N);const ue=b.transform,$e=Ma(ue.zoom)*T.exaggeration();(je?[!1,!0]:[!1]).forEach(pt=>{Ie=-1;const ht=pt?$.LINES:$.TRIANGLES,[Ot,kt]=pt?T.getWirefameBuffer():[T.gridIndexBuffer,T.gridSegments];for(const Rt of O){const Yt=I.getTile(Rt),$t=s.StencilMode.disabled,ln=T.prevTerrainTileForTile[Rt.key],Gn=T.terrainTileForTile[Rt.key];Ts(ln,Gn)&&pr.newMorphing(Rt.key,ln,Gn,N,250),H.activeTexture.set($.TEXTURE0),Yt.texture.bind($.LINEAR,$.CLAMP_TO_EDGE,$.LINEAR_MIPMAP_NEAREST);const on=pr.getMorphValuesForProxy(Rt.key),An=on?1:0;let hn;on&&(hn={morphing:{srcDemTile:on.from,dstDemTile:on.to,phase:s.easeCubicInOut(on.phase)}});const jn=Gs(Rt.projMatrix,oa(Rt.canonical,ue.renderWorldCopies)?$e/10:$e);Ke(An,pt),T.setupElevationDraw(Yt,ce,hn),b.prepareDrawProgram(H,ce,Rt.toUnwrapped()),ce.draw(H,ht,nt,$t,Ye,s.CullFaceMode.backCCW,jn,"terrain_raster",T.gridBuffer,Ot,kt)}})}}(c,this,this.proxySourceCache,o,this._updateTimestamp),this.renderingToTexture=!0,c.gpuTimingDeferredRenderEnd(),o.splice(0,o.length))}renderBatch(o){if(0===this._drapedRenderBatches.length)return o+1;this.renderingToTexture=!0;const c=this.painter,m=this.painter.context,b=this.proxySourceCache,T=this.proxiedCoords[b.id],I=this._drapedRenderBatches.shift(),O=[],N=c.style.order;let H=0;for(const $ of T){const ce=b.getTileByID($.proxyTileKey),Ie=b.proxyCachedFBO[$.key]?b.proxyCachedFBO[$.key][o]:void 0,je=void 0!==Ie?b.renderCache[Ie]:this.pool[H++],Ke=void 0!==Ie;if(ce.texture=je.tex,Ke&&!je.dirty){O.push(ce.tileID);continue}let Ye;m.bindFramebuffer.set(je.fb.framebuffer),this.renderedToTile=!1,je.dirty&&(m.clear({color:s.Color.transparent,stencil:0}),je.dirty=!1);for(let nt=I.start;nt<=I.end;++nt){const ue=c.style._layers[N[nt]];if(ue.isHidden(c.transform.zoom))continue;const $e=c.style._getLayerSourceCache(ue),pt=$e?this.proxyToSource[$.key][$e.id]:[$];if(!pt)continue;const ht=pt;m.viewport.set([0,0,je.fb.width,je.fb.height]),Ye!==($e?$e.id:null)&&(this._setupStencil(je,pt,ue,$e),Ye=$e?$e.id:null),c.renderLayer(c,$e,ue,ht)}this.renderedToTile?(je.dirty=!0,O.push(ce.tileID)):Ke||--H,5===H&&(H=0,this.renderToBackBuffer(O))}return this.renderToBackBuffer(O),this.renderingToTexture=!1,m.bindFramebuffer.set(null),m.viewport.set([0,0,c.width,c.height]),I.end+1}postRender(){}renderCacheEfficiency(o){const c=o.order.length;if(0===c)return{efficiency:100};let m,b=0,T=0,I=!1;for(let O=0;O<c;++O){const N=o._layers[o.order[O]];this._style.isLayerDraped(N)?(I&&++b,++T):I||(I=!0,m=N.id)}return 0===T?{efficiency:100}:{efficiency:100*(1-b/T),firstUndrapedLayer:m}}getMinElevationBelowMSL(){let o=0;return this._visibleDemTiles.filter(c=>c.dem).forEach(c=>{o=Math.min(o,c.dem.tree.minimums[0])}),0===o?o:(o-30)*this._exaggeration}raycast(o,c,m){if(!this._visibleDemTiles)return null;const b=this._visibleDemTiles.filter(T=>T.dem).map(T=>{const I=T.tileID,O=1<<I.overscaledZ,{x:N,y:H}=I.canonical,$=N/O,ce=(N+1)/O,Ie=H/O,je=(H+1)/O;return{minx:$,miny:Ie,maxx:ce,maxy:je,t:T.dem.tree.raycastRoot($,Ie,ce,je,o,c,m),tile:T}});b.sort((T,I)=>(null!==T.t?T.t:Number.MAX_VALUE)-(null!==I.t?I.t:Number.MAX_VALUE));for(const T of b){if(null==T.t)return null;const I=T.tile.dem.tree.raycast(T.minx,T.miny,T.maxx,T.maxy,o,c,m);if(null!=I)return I}return null}_createFBO(){const o=this.painter.context,c=o.gl,m=this.drapeBufferSize;o.activeTexture.set(c.TEXTURE0);const b=new s.Texture(o,{width:m[0],height:m[1],data:null},c.RGBA);b.bind(c.LINEAR,c.CLAMP_TO_EDGE);const T=o.createFramebuffer(m[0],m[1],!1);return T.colorAttachment.set(b.texture),T.depthAttachment=new Pt(o,T.framebuffer),void 0===this._sharedDepthStencil?(this._sharedDepthStencil=o.createRenderbuffer(o.gl.DEPTH_STENCIL,m[0],m[1]),this._stencilRef=0,T.depthAttachment.set(this._sharedDepthStencil),o.clear({stencil:0})):T.depthAttachment.set(this._sharedDepthStencil),o.extTextureFilterAnisotropic&&!o.extTextureFilterAnisotropicForceOff&&c.texParameterf(c.TEXTURE_2D,o.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,o.extTextureFilterAnisotropicMax),{fb:T,tex:b,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._style.light&&this._style.light.hasTransition())return!0;for(const o in this._style._sourceCaches)if(this._style._sourceCaches[o].hasTransition())return!0;return this._style.order.some(o=>{const c=this._style._layers[o],m=c.isHidden(this.painter.transform.zoom);return"custom"===c.type?!m&&c.shouldRedrape():!m&&c.hasTransition()})}_clearLineLayersFromRenderCache(){let o=!1;for(const m of this._style._getSources())if(m instanceof et){o=!0;break}if(!o)return;const c={};for(let m=0;m<this._style.order.length;++m){const b=this._style._layers[this._style.order[m]],T=this._style._getLayerSourceCache(b);if(T&&!c[T.id]&&!b.isHidden(this.painter.transform.zoom)&&"line"===b.type&&b.widthExpression()instanceof s.ZoomDependentExpression){c[T.id]=!0;for(const I of this.proxyCoords){const O=this.proxyToSource[I.key][T.id];if(O)for(const N of O)this._clearRenderCacheForTile(T.id,N)}}}}_clearRasterLayersFromRenderCache(){let o=!1;for(const m in this._style._sourceCaches)if(this._style._sourceCaches[m]._source instanceof Ue){o=!0;break}if(!o)return;const c={};for(let m=0;m<this._style.order.length;++m){const b=this._style._layers[this._style.order[m]],T=this._style._getLayerSourceCache(b);if(!T||c[T.id]||b.isHidden(this.painter.transform.zoom)||"raster"!==b.type)continue;const I=b.paint.get("raster-fade-duration");for(const O of this.proxyCoords){const N=this.proxyToSource[O.key][T.id];if(N)for(const H of N){const $=re(T.getTile(H),T.findLoadedParent(H,0),T,this.painter.transform,I);(1!==$.opacity||0!==$.mix)&&this._clearRenderCacheForTile(T.id,H)}}}}_setupDrapedRenderBatches(){const o=this._style.order,c=o.length;if(0===c)return;const m=[];let b,T=0,I=this._style._layers[o[T]];for(;!this._style.isLayerDraped(I)&&I.isHidden(this.painter.transform.zoom)&&++T<c;)I=this._style._layers[o[T]];for(;T<c;++T){const O=this._style._layers[o[T]];O.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(O)?void 0===b&&(b=T):void 0!==b&&(m.push({start:b,end:T-1}),b=void 0))}void 0!==b&&m.push({start:b,end:T-1}),this._drapedRenderBatches=m}_setupRenderCache(o){const c=this.proxySourceCache;if(this._shouldDisableRenderCache()||this._invalidateRenderCache){if(this._invalidateRenderCache=!1,c.renderCache.length>c.renderCachePool.length){const I=Object.values(c.proxyCachedFBO);c.proxyCachedFBO={};for(let O=0;O<I.length;++O){const N=Object.values(I[O]);c.renderCachePool.push(...N)}}return}this._clearRasterLayersFromRenderCache();const m=this.proxyCoords,b=this._tilesDirty;for(let I=m.length-1;I>=0;I--){const O=m[I];if(c.getTileByID(O.key),void 0!==c.proxyCachedFBO[O.key]){const N=o[O.key],H=this.proxyToSource[O.key];let $=0;for(const ce in H){const Ie=H[ce],je=N[ce];if(!je||je.length!==Ie.length||Ie.some((Ke,Ye)=>Ke!==je[Ye]||b[ce]&&b[ce].hasOwnProperty(Ke.key))){$=-1;break}++$}for(const ce in c.proxyCachedFBO[O.key])c.renderCache[c.proxyCachedFBO[O.key][ce]].dirty=$<0||$!==Object.values(N).length}}const T=[...this._drapedRenderBatches];T.sort((I,O)=>O.end-O.start-(I.end-I.start));for(const I of T)for(const O of m){if(c.proxyCachedFBO[O.key])continue;let N=c.renderCachePool.pop();void 0===N&&c.renderCache.length<50&&(N=c.renderCache.length,c.renderCache.push(this._createFBO())),void 0!==N&&(c.proxyCachedFBO[O.key]={},c.proxyCachedFBO[O.key][I.start]=N,c.renderCache[N].dirty=!0)}this._tilesDirty={}}_setupStencil(o,c,m,b){if(!b||!this._sourceTilesOverlap[b.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const T=this.painter.context,I=T.gl;if(c.length<=1)return void(this._overlapStencilType=!1);let O;if(m.isTileClipped())O=c.length,this._overlapStencilMode.test={func:I.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(c[0].overscaledZ>c[c.length-1].overscaledZ))return void(this._overlapStencilType=!1);O=1,this._overlapStencilMode.test={func:I.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+O>255&&(T.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=O,this._overlapStencilMode.ref=this._stencilRef,m.isTileClipped()&&this._renderTileClippingMasks(c,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return"Clip"===this._overlapStencilType||"Mask"===this._overlapStencilType}stencilModeForRTTOverlap(o){return this.renderingToTexture&&this._overlapStencilType?("Clip"===this._overlapStencilType&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[o.key]),this._overlapStencilMode):s.StencilMode.disabled}_renderTileClippingMasks(o,c){const m=this.painter,b=this.painter.context,T=b.gl;m._tileClippingMaskIDs={},b.setColorMode(s.ColorMode.disabled),b.setDepthMode(s.DepthMode.disabled);const I=m.useProgram("clippingMask");for(const O of o){const N=m._tileClippingMaskIDs[O.key]=--c;I.draw(b,T.TRIANGLES,s.DepthMode.disabled,new s.StencilMode({func:T.ALWAYS,mask:0},N,255,T.KEEP,T.KEEP,T.REPLACE),s.ColorMode.disabled,s.CullFaceMode.disabled,S(O.projMatrix),"$clipping",m.tileExtentBuffer,m.quadTriangleIndexBuffer,m.tileExtentSegments)}}pointCoordinate(o){const c=this.painter.transform;if(o.x<0||o.x>c.width||o.y<0||o.y>c.height)return null;const m=[o.x,o.y,1,1];s.transformMat4$1(m,m,c.pixelMatrixInverse),s.scale$1(m,m,1/m[3]),m[0]/=c.worldSize,m[1]/=c.worldSize;const b=c._camera.position,T=s.mercatorZfromAltitude(1,c.center.lat),I=[b[0],b[1],b[2]/T,0],O=s.subtract([],m.slice(0,3),I);s.normalize(O,O);const N=this.raycast(I,O,this._exaggeration);return null!==N&&N?(s.scaleAndAdd(I,I,O,N),I[3]=I[2],I[2]*=T,I):null}drawDepth(){const o=this.painter,c=o.context,m=this.proxySourceCache,b=Math.ceil(o.width),T=Math.ceil(o.height);if(!this._depthFBO||this._depthFBO.width===b&&this._depthFBO.height===T||(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),!this._depthFBO){const I=c.gl,O=c.createFramebuffer(b,T,!0);c.activeTexture.set(I.TEXTURE0);const N=new s.Texture(c,{width:b,height:T,data:null},I.RGBA);N.bind(I.NEAREST,I.CLAMP_TO_EDGE),O.colorAttachment.set(N.texture);const H=c.createRenderbuffer(c.gl.DEPTH_COMPONENT16,b,T);O.depthAttachment.set(H),this._depthFBO=O,this._depthTexture=N}c.bindFramebuffer.set(this._depthFBO.framebuffer),c.viewport.set([0,0,b,T]),function(I,O,N,H){if("globe"===I.transform.projection.name)return;const $=I.context,ce=$.gl;$.clear({depth:1});const Ie=I.useProgram("terrainDepth"),je=new s.DepthMode(ce.LESS,s.DepthMode.ReadWrite,I.depthRangeFor3D);for(const Ke of H){const Ye=N.getTile(Ke),nt=Gs(Ke.projMatrix,0);O.setupElevationDraw(Ye,Ie),Ie.draw($,ce.TRIANGLES,je,s.StencilMode.disabled,s.ColorMode.unblended,s.CullFaceMode.backCCW,nt,"terrain_depth",O.gridBuffer,O.gridIndexBuffer,O.gridNoSkirtSegments)}}(o,this,m,this.proxyCoords)}_setupProxiedCoordsForOrtho(o,c,m){if(o.getSource()instanceof me)return this._setupProxiedCoordsForImageSource(o,c,m);this._findCoveringTileCache[o.id]=this._findCoveringTileCache[o.id]||{};const b=this.proxiedCoords[o.id]=[],T=this.proxyCoords;for(let O=0;O<T.length;O++){const N=T[O],H=this._findTileCoveringTileID(N,o);if(H){const $=this._createProxiedId(N,H,m[N.key]&&m[N.key][o.id]);b.push($),this.proxyToSource[N.key][o.id]=[$]}}let I=!1;for(let O=0;O<c.length;O++){const N=o.getTile(c[O]);if(!N||!N.hasData())continue;const H=this._findTileCoveringTileID(N.tileID,this.proxySourceCache);if(H&&H.tileID.canonical.z!==N.tileID.canonical.z){const $=this.proxyToSource[H.tileID.key][o.id],ce=this._createProxiedId(H.tileID,N,m[H.tileID.key]&&m[H.tileID.key][o.id]);$?$.splice($.length-1,0,ce):this.proxyToSource[H.tileID.key][o.id]=[ce],b.push(ce),I=!0}}this._sourceTilesOverlap[o.id]=I}_setupProxiedCoordsForImageSource(o,c,m){if(!o.getSource().loaded())return;const b=this.proxiedCoords[o.id]=[],T=this.proxyCoords,I=o.getSource(),O=new s.Point(I.tileID.x,I.tileID.y)._div(1<<I.tileID.z),N=I.coordinates.map(s.MercatorCoordinate.fromLngLat).reduce(($,ce)=>($.min.x=Math.min($.min.x,ce.x-O.x),$.min.y=Math.min($.min.y,ce.y-O.y),$.max.x=Math.max($.max.x,ce.x-O.x),$.max.y=Math.max($.max.y,ce.y-O.y),$),{min:new s.Point(Number.MAX_VALUE,Number.MAX_VALUE),max:new s.Point(-Number.MAX_VALUE,-Number.MAX_VALUE)}),H=($,ce)=>{const Ie=$.wrap+$.canonical.x/(1<<$.canonical.z),je=$.canonical.y/(1<<$.canonical.z),Ke=s.EXTENT/(1<<$.canonical.z),Ye=ce.wrap+ce.canonical.x/(1<<ce.canonical.z),nt=ce.canonical.y/(1<<ce.canonical.z);return Ie+Ke<Ye+N.min.x||Ie>Ye+N.max.x||je+Ke<nt+N.min.y||je>nt+N.max.y};for(let $=0;$<T.length;$++){const ce=T[$];for(let Ie=0;Ie<c.length;Ie++){const je=o.getTile(c[Ie]);if(!je||!je.hasData()||H(ce,je.tileID))continue;const Ke=this._createProxiedId(ce,je,m[ce.key]&&m[ce.key][o.id]),Ye=this.proxyToSource[ce.key][o.id];Ye?Ye.push(Ke):this.proxyToSource[ce.key][o.id]=[Ke],b.push(Ke)}}}_createProxiedId(o,c,m){let b=this.orthoMatrix;if(m){const T=m.find(I=>I.key===c.tileID.key);if(T)return T}if(c.tileID.key!==o.key){const T=o.canonical.z-c.tileID.canonical.z;let I,O,N;b=s.create();const H=c.tileID.wrap-o.wrap<<o.overscaledZ;T>0?(I=s.EXTENT>>T,O=I*((c.tileID.canonical.x<<T)-o.canonical.x+H),N=I*((c.tileID.canonical.y<<T)-o.canonical.y)):(I=s.EXTENT<<-T,O=s.EXTENT*(c.tileID.canonical.x-(o.canonical.x+H<<-T)),N=s.EXTENT*(c.tileID.canonical.y-(o.canonical.y<<-T))),s.ortho(b,0,I,0,I,0,1),s.translate(b,b,[O,N,0])}return new He(c.tileID,o.key,b)}_findTileCoveringTileID(o,c){let m=c.getTile(o);if(m&&m.hasData())return m;const b=this._findCoveringTileCache[c.id],T=b[o.key];if(m=T?c.getTileByID(T):null,m&&m.hasData()||null===T)return m;let I=m?m.tileID:o,O=I.overscaledZ;const N=c.getSource().minzoom,H=[];if(!T){const ce=c.getSource().maxzoom;if(o.canonical.z>=ce){const Ie=o.canonical.z-ce;c.getSource().reparseOverscaled?(O=Math.max(o.canonical.z+2,c.transform.tileZoom),I=new s.OverscaledTileID(O,o.wrap,ce,o.canonical.x>>Ie,o.canonical.y>>Ie)):0!==Ie&&(O=ce,I=new s.OverscaledTileID(O,o.wrap,ce,o.canonical.x>>Ie,o.canonical.y>>Ie))}I.key!==o.key&&(H.push(I.key),m=c.getTile(I))}const $=ce=>{H.forEach(Ie=>{b[Ie]=ce}),H.length=0};for(O-=1;O>=N&&(!m||!m.hasData());O--){m&&$(m.tileID.key);const ce=I.calculateScaledKey(O);if(m=c.getTileByID(ce),m&&m.hasData())break;const Ie=b[ce];if(null===Ie)break;void 0===Ie?H.push(ce):m=c.getTileByID(Ie)}return $(m?m.tileID.key:null),m&&m.hasData()?m:null}findDEMTileFor(o){return this.enabled?this._findTileCoveringTileID(o,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(o,c){let m=this._tilesDirty[o];m||(m=this._tilesDirty[o]={}),m[c.key]=!0}getWirefameBuffer(){if(!this.wireframeSegments){const o=function(c){let m=0;const b=new s.StructArrayLayout2ui4,T=131;for(let I=1;I<129;I++){for(let O=1;O<129;O++)m=I*T+O,b.emplaceBack(m,m+1),b.emplaceBack(m,m+T),b.emplaceBack(m+1,m+T),128===I&&b.emplaceBack(m+T,m+T+1);b.emplaceBack(m+1,m+1+T)}return b}();this.wireframeIndexBuffer=this.painter.context.createIndexBuffer(o),this.wireframeSegments=s.SegmentVector.simpleSegment(0,0,this.gridBuffer.length,o.length)}return[this.wireframeIndexBuffer,this.wireframeSegments]}}class Kn{static cacheKey(o,c,m,b){let T=`${c}${b?b.cacheKey:""}`;for(const I of m)o.usedDefines.includes(I)&&(T+=`/${I}`);return T}constructor(o,c,m,b,T,I){const O=o.gl;this.program=O.createProgram();const N=function(ue){const $e=[];for(let pt=0;pt<ue.length;pt++){if(null===ue[pt])continue;const ht=ue[pt].split(" ");$e.push(ht.pop())}return $e}(m.staticAttributes),H=b?b.getBinderAttributes():[],$=N.concat(H);let ce=b?b.defines():[];ce=ce.concat(I.map(ue=>`#define ${ue}`));const Ie=o.isWebGL2?"#version 300 es\n":"",je=Ie+ce.concat(o.extStandardDerivatives&&0===Ie.length?"#extension GL_OES_standard_derivatives : enable\n".concat(na):na,na,ds,eo.fragmentSource,Qr.fragmentSource,m.fragmentSource).join("\n"),Ke=Ie+ce.concat("\n#ifdef GL_ES\nprecision highp float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif",ds,eo.vertexSource,Qr.vertexSource,Ar.vertexSource,m.vertexSource).join("\n"),Ye=O.createShader(O.FRAGMENT_SHADER);if(O.isContextLost())return void(this.failedToCreate=!0);O.shaderSource(Ye,je),O.compileShader(Ye),O.attachShader(this.program,Ye);const nt=O.createShader(O.VERTEX_SHADER);if(O.isContextLost())this.failedToCreate=!0;else{O.shaderSource(nt,Ke),O.compileShader(nt),O.attachShader(this.program,nt),this.attributes={},this.numAttributes=$.length;for(let ue=0;ue<this.numAttributes;ue++)$[ue]&&(O.bindAttribLocation(this.program,ue,$[ue]),this.attributes[$[ue]]=ue);O.linkProgram(this.program),O.deleteShader(nt),O.deleteShader(Ye),this.fixedUniforms=T(o),this.binderUniforms=b?b.getUniforms(o):[],I.includes("TERRAIN")&&(this.terrainUniforms={u_dem:new s.Uniform1i(ue=o),u_dem_prev:new s.Uniform1i(ue),u_dem_unpack:new s.Uniform4f(ue),u_dem_tl:new s.Uniform2f(ue),u_dem_scale:new s.Uniform1f(ue),u_dem_tl_prev:new s.Uniform2f(ue),u_dem_scale_prev:new s.Uniform1f(ue),u_dem_size:new s.Uniform1f(ue),u_dem_lerp:new s.Uniform1f(ue),u_exaggeration:new s.Uniform1f(ue),u_depth:new s.Uniform1i(ue),u_depth_size_inv:new s.Uniform2f(ue),u_meter_to_dem:new s.Uniform1f(ue),u_label_plane_matrix_inv:new s.UniformMatrix4f(ue)}),I.includes("GLOBE")&&(this.globeUniforms=(ue=>({u_tile_tl_up:new s.Uniform3f(ue),u_tile_tr_up:new s.Uniform3f(ue),u_tile_br_up:new s.Uniform3f(ue),u_tile_bl_up:new s.Uniform3f(ue),u_tile_up_scale:new s.Uniform1f(ue)}))(o)),I.includes("FOG")&&(this.fogUniforms=(ue=>({u_fog_matrix:new s.UniformMatrix4f(ue),u_fog_range:new s.Uniform2f(ue),u_fog_color:new s.Uniform4f(ue),u_fog_horizon_blend:new s.Uniform1f(ue),u_fog_temporal_offset:new s.Uniform1f(ue),u_frustum_tl:new s.Uniform3f(ue),u_frustum_tr:new s.Uniform3f(ue),u_frustum_br:new s.Uniform3f(ue),u_frustum_bl:new s.Uniform3f(ue),u_globe_pos:new s.Uniform3f(ue),u_globe_radius:new s.Uniform1f(ue),u_globe_transition:new s.Uniform1f(ue),u_is_globe:new s.Uniform1i(ue),u_viewport:new s.Uniform2f(ue)}))(o))}var ue}setTerrainUniformValues(o,c){if(!this.terrainUniforms)return;const m=this.terrainUniforms;if(!this.failedToCreate){o.program.set(this.program);for(const b in c)m[b]&&m[b].set(this.program,b,c[b])}}setGlobeUniformValues(o,c){if(!this.globeUniforms)return;const m=this.globeUniforms;if(!this.failedToCreate){o.program.set(this.program);for(const b in c)m[b]&&m[b].set(this.program,b,c[b])}}setFogUniformValues(o,c){if(!this.fogUniforms)return;const m=this.fogUniforms;if(!this.failedToCreate){o.program.set(this.program);for(const b in c)m[b].set(this.program,b,c[b])}}draw(o,c,m,b,T,I,O,N,H,$,ce,Ie,je,Ke,Ye){const nt=o.gl;if(this.failedToCreate)return;o.program.set(this.program),o.setDepthMode(m),o.setStencilMode(b),o.setColorMode(T),o.setCullFace(I);for(const $e of Object.keys(this.fixedUniforms))this.fixedUniforms[$e].set(this.program,$e,O[$e]);Ke&&Ke.setUniforms(this.program,o,this.binderUniforms,Ie,{zoom:je});const ue={[nt.LINES]:2,[nt.TRIANGLES]:3,[nt.LINE_STRIP]:1}[c];for(const $e of ce.get()){const pt=$e.vaos||($e.vaos={});(pt[N]||(pt[N]=new ia)).bind(o,this,H,Ke?Ke.getPaintVertexBuffers():[],$,$e.vertexOffset,Ye||[]),nt.drawElements(c,$e.primitiveLength*ue,nt.UNSIGNED_SHORT,$e.primitiveOffset*ue*2)}}}function zi(p,o){const c=Math.pow(2,o.tileID.overscaledZ),m=o.tileSize*Math.pow(2,p.transform.tileZoom)/c,b=m*(o.tileID.canonical.x+o.tileID.wrap*c),T=m*o.tileID.canonical.y;return{u_image:0,u_texsize:o.imageAtlasTexture.size,u_tile_units_to_pixels:1/mt(o,1,p.transform.tileZoom),u_pixel_coord_upper:[b>>16,T>>16],u_pixel_coord_lower:[65535&b,65535&T]}}const ee=s.create(),J=(p,o,c,m,b,T,I,O,N,H,$)=>{const ce=o.style.light,Ie=ce.properties.get("position"),je=[Ie.x,Ie.y,Ie.z],Ke=s.create$1();"viewport"===ce.properties.get("anchor")&&(s.fromRotation(Ke,-o.transform.angle),s.transformMat3(je,je,Ke));const Ye=ce.properties.get("color"),nt=o.transform,ue={u_matrix:p,u_lightpos:je,u_lightintensity:ce.properties.get("intensity"),u_lightcolor:[Ye.r,Ye.g,Ye.b],u_vertical_gradient:+c,u_opacity:m,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:ee,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_ao:b,u_edge_radius:T};return"globe"===nt.projection.name&&(ue.u_tile_id=[I.canonical.x,I.canonical.y,1<<I.canonical.z],ue.u_zoom_transition=N,ue.u_inv_rot_matrix=$,ue.u_merc_center=H,ue.u_up_dir=nt.projection.upVector(new s.CanonicalTileID(0,0,0),H[0]*s.EXTENT,H[1]*s.EXTENT),ue.u_height_lift=O),ue},G=(p,o,c,m,b,T,I,O,N,H,$,ce)=>{const Ie=J(p,o,c,m,b,T,I,N,H,$,ce),je={u_height_factor:-Math.pow(2,I.overscaledZ)/O.tileSize/8};return s.extend(Ie,zi(o,O),je)},ke=p=>({u_matrix:p}),bn=(p,o,c)=>s.extend(ke(p),zi(o,c)),hi=(p,o)=>({u_matrix:p,u_world:o}),sr=(p,o,c,m)=>s.extend(bn(p,o,c),{u_world:m}),hs=s.create(),Ws=(p,o,c,m,b,T)=>{const I=p.transform,O="globe"===I.projection.name;let N;if("map"===T.paint.get("circle-pitch-alignment"))if(O){const $=s.globePixelsToTileUnits(I.zoom,o.canonical)*I._pixelsPerMercatorPixel;N=Float32Array.from([$,0,0,$])}else N=I.calculatePixelsToTileUnitsMatrix(c);else N=new Float32Array([I.pixelsToGLUnits[0],0,0,I.pixelsToGLUnits[1]]);const H={u_camera_to_center_distance:I.cameraToCenterDistance,u_matrix:p.translatePosMatrix(o.projMatrix,c,T.paint.get("circle-translate"),T.paint.get("circle-translate-anchor")),u_device_pixel_ratio:s.exported.devicePixelRatio,u_extrude_scale:N,u_inv_rot_matrix:hs,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(O){H.u_inv_rot_matrix=m,H.u_merc_center=b,H.u_tile_id=[o.canonical.x,o.canonical.y,1<<o.canonical.z],H.u_zoom_transition=s.globeToMercatorTransition(I.zoom);const $=b[0]*s.EXTENT,ce=b[1]*s.EXTENT;H.u_up_dir=I.projection.upVector(new s.CanonicalTileID(0,0,0),$,ce)}return H},qa=p=>{const o=[];return"map"===p.paint.get("circle-pitch-alignment")&&o.push("PITCH_WITH_MAP"),"map"===p.paint.get("circle-pitch-scale")&&o.push("SCALE_WITH_MAP"),o},kc=(p,o,c,m)=>{const b=s.EXTENT/c.tileSize;return{u_matrix:p,u_camera_to_center_distance:o.getCameraToCenterDistance(m),u_extrude_scale:[o.pixelsToGLUnits[0]/b,o.pixelsToGLUnits[1]/b]}},Fc=(p,o,c=1)=>({u_matrix:p,u_color:o,u_overlay:0,u_overlay_scale:c}),ua=s.create(),Ll=(p,o,c,m,b,T,I)=>{const O=p.transform,N="globe"===O.projection.name,H=N?s.globePixelsToTileUnits(O.zoom,o.canonical)*O._pixelsPerMercatorPixel:mt(c,1,T),$={u_matrix:o.projMatrix,u_extrude_scale:H,u_intensity:I,u_inv_rot_matrix:ua,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(N){$.u_inv_rot_matrix=m,$.u_merc_center=b,$.u_tile_id=[o.canonical.x,o.canonical.y,1<<o.canonical.z],$.u_zoom_transition=s.globeToMercatorTransition(O.zoom);const ce=b[0]*s.EXTENT,Ie=b[1]*s.EXTENT;$.u_up_dir=O.projection.upVector(new s.CanonicalTileID(0,0,0),ce,Ie)}return $},rc=(p,o,c,m,b,T,I)=>{const O=p.transform,N=O.calculatePixelsToTileUnitsMatrix(o);return{u_matrix:kl(p,o,c,m),u_pixels_to_tile_units:N,u_device_pixel_ratio:T,u_units_to_pixels:[1/O.pixelsToGLUnits[0],1/O.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:b,u_texsize:Ya(c)?o.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:da(o,p.transform),u_alpha_discard_threshold:0,u_trim_offset:I}},Os=(p,o,c,m,b)=>{const T=p.transform;return{u_matrix:kl(p,o,c,m),u_texsize:o.imageAtlasTexture.size,u_pixels_to_tile_units:T.calculatePixelsToTileUnitsMatrix(o),u_device_pixel_ratio:b,u_image:0,u_tile_units_to_pixels:da(o,T),u_units_to_pixels:[1/T.pixelsToGLUnits[0],1/T.pixelsToGLUnits[1]],u_alpha_discard_threshold:0}};function da(p,o){return 1/mt(p,1,o.tileZoom)}function kl(p,o,c,m){return p.translatePosMatrix(m||o.tileID.projMatrix,o,c.paint.get("line-translate"),c.paint.get("line-translate-anchor"))}function Ya(p){const o=p.paint.get("line-dasharray").value;return o.value||"constant"!==o.kind}const Ja=(p,o,c,m,b,T)=>{return{u_matrix:p,u_tl_parent:o,u_scale_parent:c,u_fade_t:m.mix,u_opacity:m.opacity*b.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:b.paint.get("raster-brightness-min"),u_brightness_high:b.paint.get("raster-brightness-max"),u_saturation_factor:(O=b.paint.get("raster-saturation"),O>0?1-1/(1.001-O):-O),u_contrast_factor:(I=b.paint.get("raster-contrast"),I>0?1/(1-I):1+I),u_spin_weights:ps(b.paint.get("raster-hue-rotate")),u_perspective_transform:T};var I,O};function ps(p){p*=Math.PI/180;const o=Math.sin(p),c=Math.cos(p);return[(2*c+1)/3,(-Math.sqrt(3)*o-c+1)/3,(Math.sqrt(3)*o-c+1)/3]}const Fl=s.create(),Rs=(p,o,c,m,b,T,I,O,N,H,$,ce,Ie,je,Ke,Ye)=>{const nt=b.transform,ue={u_is_size_zoom_constant:+("constant"===p||"source"===p),u_is_size_feature_constant:+("constant"===p||"camera"===p),u_size_t:o?o.uSizeT:0,u_size:o?o.uSize:0,u_camera_to_center_distance:nt.cameraToCenterDistance,u_rotate_symbol:+c,u_aspect_ratio:nt.width/nt.height,u_fade_change:b.options.fadeDuration?b.symbolFadeChange:1,u_matrix:T,u_label_plane_matrix:I,u_coord_matrix:O,u_is_text:+N,u_pitch_with_map:+m,u_texsize:H,u_texture:0,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Fl,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:Fl,u_up_vector:[0,-1,0]};return"globe"===Ye.name&&(ue.u_tile_id=[$.canonical.x,$.canonical.y,1<<$.canonical.z],ue.u_zoom_transition=ce,ue.u_inv_rot_matrix=je,ue.u_merc_center=Ie,ue.u_camera_forward=nt._camera.forward(),ue.u_ecef_origin=s.globeECEFOrigin(nt.globeMatrix,$.toUnwrapped()),ue.u_tile_matrix=Float32Array.from(nt.globeMatrix),ue.u_up_vector=Ke),ue},ha=(p,o,c,m,b,T,I,O,N,H,$,ce,Ie,je,Ke,Ye,nt)=>s.extend(Rs(p,o,c,m,b,T,I,O,N,H,ce,Ie,je,Ke,Ye,nt),{u_gamma_scale:m?b.transform.cameraToCenterDistance*Math.cos(b.terrain?0:b.transform._pitch):1,u_device_pixel_ratio:s.exported.devicePixelRatio,u_is_halo:+$}),Or=(p,o,c,m,b,T,I,O,N,H,$,ce,Ie,je,Ke,Ye)=>s.extend(ha(p,o,c,m,b,T,I,O,!0,N,!0,$,ce,Ie,je,Ke,Ye),{u_texsize_icon:H,u_texture_icon:1}),pl=(p,o,c)=>({u_matrix:p,u_opacity:o,u_color:c}),fd=(p,o,c,m,b)=>s.extend(function(T,I,O){const N=I.imageManager.getPattern(T.toString()),{width:H,height:$}=I.imageManager.getPixelSize(),ce=Math.pow(2,O.tileID.overscaledZ),Ie=O.tileSize*Math.pow(2,I.transform.tileZoom)/ce,je=Ie*(O.tileID.canonical.x+O.tileID.wrap*ce),Ke=Ie*O.tileID.canonical.y;return{u_image:0,u_pattern_tl:N.tl,u_pattern_br:N.br,u_texsize:[H,$],u_pattern_size:N.displaySize,u_tile_units_to_pixels:1/mt(O,1,I.transform.tileZoom),u_pixel_coord_upper:[je>>16,Ke>>16],u_pixel_coord_lower:[65535&je,65535&Ke]}}(m,c,b),{u_matrix:p,u_opacity:o}),pa={fillExtrusion:p=>({u_matrix:new s.UniformMatrix4f(p),u_lightpos:new s.Uniform3f(p),u_lightintensity:new s.Uniform1f(p),u_lightcolor:new s.Uniform3f(p),u_vertical_gradient:new s.Uniform1f(p),u_opacity:new s.Uniform1f(p),u_edge_radius:new s.Uniform1f(p),u_ao:new s.Uniform2f(p),u_tile_id:new s.Uniform3f(p),u_zoom_transition:new s.Uniform1f(p),u_inv_rot_matrix:new s.UniformMatrix4f(p),u_merc_center:new s.Uniform2f(p),u_up_dir:new s.Uniform3f(p),u_height_lift:new s.Uniform1f(p)}),fillExtrusionPattern:p=>({u_matrix:new s.UniformMatrix4f(p),u_lightpos:new s.Uniform3f(p),u_lightintensity:new s.Uniform1f(p),u_lightcolor:new s.Uniform3f(p),u_vertical_gradient:new s.Uniform1f(p),u_height_factor:new s.Uniform1f(p),u_edge_radius:new s.Uniform1f(p),u_ao:new s.Uniform2f(p),u_tile_id:new s.Uniform3f(p),u_zoom_transition:new s.Uniform1f(p),u_inv_rot_matrix:new s.UniformMatrix4f(p),u_merc_center:new s.Uniform2f(p),u_up_dir:new s.Uniform3f(p),u_height_lift:new s.Uniform1f(p),u_image:new s.Uniform1i(p),u_texsize:new s.Uniform2f(p),u_pixel_coord_upper:new s.Uniform2f(p),u_pixel_coord_lower:new s.Uniform2f(p),u_tile_units_to_pixels:new s.Uniform1f(p),u_opacity:new s.Uniform1f(p)}),fill:p=>({u_matrix:new s.UniformMatrix4f(p)}),fillPattern:p=>({u_matrix:new s.UniformMatrix4f(p),u_image:new s.Uniform1i(p),u_texsize:new s.Uniform2f(p),u_pixel_coord_upper:new s.Uniform2f(p),u_pixel_coord_lower:new s.Uniform2f(p),u_tile_units_to_pixels:new s.Uniform1f(p)}),fillOutline:p=>({u_matrix:new s.UniformMatrix4f(p),u_world:new s.Uniform2f(p)}),fillOutlinePattern:p=>({u_matrix:new s.UniformMatrix4f(p),u_world:new s.Uniform2f(p),u_image:new s.Uniform1i(p),u_texsize:new s.Uniform2f(p),u_pixel_coord_upper:new s.Uniform2f(p),u_pixel_coord_lower:new s.Uniform2f(p),u_tile_units_to_pixels:new s.Uniform1f(p)}),circle:p=>({u_camera_to_center_distance:new s.Uniform1f(p),u_extrude_scale:new s.UniformMatrix2f(p),u_device_pixel_ratio:new s.Uniform1f(p),u_matrix:new s.UniformMatrix4f(p),u_inv_rot_matrix:new s.UniformMatrix4f(p),u_merc_center:new s.Uniform2f(p),u_tile_id:new s.Uniform3f(p),u_zoom_transition:new s.Uniform1f(p),u_up_dir:new s.Uniform3f(p)}),collisionBox:p=>({u_matrix:new s.UniformMatrix4f(p),u_camera_to_center_distance:new s.Uniform1f(p),u_extrude_scale:new s.Uniform2f(p)}),collisionCircle:p=>({u_matrix:new s.UniformMatrix4f(p),u_inv_matrix:new s.UniformMatrix4f(p),u_camera_to_center_distance:new s.Uniform1f(p),u_viewport_size:new s.Uniform2f(p)}),debug:p=>({u_color:new s.UniformColor(p),u_matrix:new s.UniformMatrix4f(p),u_overlay:new s.Uniform1i(p),u_overlay_scale:new s.Uniform1f(p)}),clippingMask:p=>({u_matrix:new s.UniformMatrix4f(p)}),heatmap:p=>({u_extrude_scale:new s.Uniform1f(p),u_intensity:new s.Uniform1f(p),u_matrix:new s.UniformMatrix4f(p),u_inv_rot_matrix:new s.UniformMatrix4f(p),u_merc_center:new s.Uniform2f(p),u_tile_id:new s.Uniform3f(p),u_zoom_transition:new s.Uniform1f(p),u_up_dir:new s.Uniform3f(p)}),heatmapTexture:p=>({u_image:new s.Uniform1i(p),u_color_ramp:new s.Uniform1i(p),u_opacity:new s.Uniform1f(p)}),hillshade:p=>({u_matrix:new s.UniformMatrix4f(p),u_image:new s.Uniform1i(p),u_latrange:new s.Uniform2f(p),u_light:new s.Uniform2f(p),u_shadow:new s.UniformColor(p),u_highlight:new s.UniformColor(p),u_accent:new s.UniformColor(p)}),hillshadePrepare:p=>({u_matrix:new s.UniformMatrix4f(p),u_image:new s.Uniform1i(p),u_dimension:new s.Uniform2f(p),u_zoom:new s.Uniform1f(p),u_unpack:new s.Uniform4f(p)}),line:p=>({u_matrix:new s.UniformMatrix4f(p),u_pixels_to_tile_units:new s.UniformMatrix2f(p),u_device_pixel_ratio:new s.Uniform1f(p),u_units_to_pixels:new s.Uniform2f(p),u_dash_image:new s.Uniform1i(p),u_gradient_image:new s.Uniform1i(p),u_image_height:new s.Uniform1f(p),u_texsize:new s.Uniform2f(p),u_tile_units_to_pixels:new s.Uniform1f(p),u_alpha_discard_threshold:new s.Uniform1f(p),u_trim_offset:new s.Uniform2f(p)}),linePattern:p=>({u_matrix:new s.UniformMatrix4f(p),u_texsize:new s.Uniform2f(p),u_pixels_to_tile_units:new s.UniformMatrix2f(p),u_device_pixel_ratio:new s.Uniform1f(p),u_image:new s.Uniform1i(p),u_units_to_pixels:new s.Uniform2f(p),u_tile_units_to_pixels:new s.Uniform1f(p),u_alpha_discard_threshold:new s.Uniform1f(p)}),raster:p=>({u_matrix:new s.UniformMatrix4f(p),u_tl_parent:new s.Uniform2f(p),u_scale_parent:new s.Uniform1f(p),u_fade_t:new s.Uniform1f(p),u_opacity:new s.Uniform1f(p),u_image0:new s.Uniform1i(p),u_image1:new s.Uniform1i(p),u_brightness_low:new s.Uniform1f(p),u_brightness_high:new s.Uniform1f(p),u_saturation_factor:new s.Uniform1f(p),u_contrast_factor:new s.Uniform1f(p),u_spin_weights:new s.Uniform3f(p),u_perspective_transform:new s.Uniform2f(p)}),symbolIcon:p=>({u_is_size_zoom_constant:new s.Uniform1i(p),u_is_size_feature_constant:new s.Uniform1i(p),u_size_t:new s.Uniform1f(p),u_size:new s.Uniform1f(p),u_camera_to_center_distance:new s.Uniform1f(p),u_rotate_symbol:new s.Uniform1i(p),u_aspect_ratio:new s.Uniform1f(p),u_fade_change:new s.Uniform1f(p),u_matrix:new s.UniformMatrix4f(p),u_label_plane_matrix:new s.UniformMatrix4f(p),u_coord_matrix:new s.UniformMatrix4f(p),u_is_text:new s.Uniform1i(p),u_pitch_with_map:new s.Uniform1i(p),u_texsize:new s.Uniform2f(p),u_tile_id:new s.Uniform3f(p),u_zoom_transition:new s.Uniform1f(p),u_inv_rot_matrix:new s.UniformMatrix4f(p),u_merc_center:new s.Uniform2f(p),u_camera_forward:new s.Uniform3f(p),u_tile_matrix:new s.UniformMatrix4f(p),u_up_vector:new s.Uniform3f(p),u_ecef_origin:new s.Uniform3f(p),u_texture:new s.Uniform1i(p)}),symbolSDF:p=>({u_is_size_zoom_constant:new s.Uniform1i(p),u_is_size_feature_constant:new s.Uniform1i(p),u_size_t:new s.Uniform1f(p),u_size:new s.Uniform1f(p),u_camera_to_center_distance:new s.Uniform1f(p),u_rotate_symbol:new s.Uniform1i(p),u_aspect_ratio:new s.Uniform1f(p),u_fade_change:new s.Uniform1f(p),u_matrix:new s.UniformMatrix4f(p),u_label_plane_matrix:new s.UniformMatrix4f(p),u_coord_matrix:new s.UniformMatrix4f(p),u_is_text:new s.Uniform1i(p),u_pitch_with_map:new s.Uniform1i(p),u_texsize:new s.Uniform2f(p),u_texture:new s.Uniform1i(p),u_gamma_scale:new s.Uniform1f(p),u_device_pixel_ratio:new s.Uniform1f(p),u_tile_id:new s.Uniform3f(p),u_zoom_transition:new s.Uniform1f(p),u_inv_rot_matrix:new s.UniformMatrix4f(p),u_merc_center:new s.Uniform2f(p),u_camera_forward:new s.Uniform3f(p),u_tile_matrix:new s.UniformMatrix4f(p),u_up_vector:new s.Uniform3f(p),u_ecef_origin:new s.Uniform3f(p),u_is_halo:new s.Uniform1i(p)}),symbolTextAndIcon:p=>({u_is_size_zoom_constant:new s.Uniform1i(p),u_is_size_feature_constant:new s.Uniform1i(p),u_size_t:new s.Uniform1f(p),u_size:new s.Uniform1f(p),u_camera_to_center_distance:new s.Uniform1f(p),u_rotate_symbol:new s.Uniform1i(p),u_aspect_ratio:new s.Uniform1f(p),u_fade_change:new s.Uniform1f(p),u_matrix:new s.UniformMatrix4f(p),u_label_plane_matrix:new s.UniformMatrix4f(p),u_coord_matrix:new s.UniformMatrix4f(p),u_is_text:new s.Uniform1i(p),u_pitch_with_map:new s.Uniform1i(p),u_texsize:new s.Uniform2f(p),u_texsize_icon:new s.Uniform2f(p),u_texture:new s.Uniform1i(p),u_texture_icon:new s.Uniform1i(p),u_gamma_scale:new s.Uniform1f(p),u_device_pixel_ratio:new s.Uniform1f(p),u_is_halo:new s.Uniform1i(p)}),background:p=>({u_matrix:new s.UniformMatrix4f(p),u_opacity:new s.Uniform1f(p),u_color:new s.UniformColor(p)}),backgroundPattern:p=>({u_matrix:new s.UniformMatrix4f(p),u_opacity:new s.Uniform1f(p),u_image:new s.Uniform1i(p),u_pattern_tl:new s.Uniform2f(p),u_pattern_br:new s.Uniform2f(p),u_texsize:new s.Uniform2f(p),u_pattern_size:new s.Uniform2f(p),u_pixel_coord_upper:new s.Uniform2f(p),u_pixel_coord_lower:new s.Uniform2f(p),u_tile_units_to_pixels:new s.Uniform1f(p)}),terrainRaster:Nr,terrainDepth:Nr,skybox:p=>({u_matrix:new s.UniformMatrix4f(p),u_sun_direction:new s.Uniform3f(p),u_cubemap:new s.Uniform1i(p),u_opacity:new s.Uniform1f(p),u_temporal_offset:new s.Uniform1f(p)}),skyboxGradient:p=>({u_matrix:new s.UniformMatrix4f(p),u_color_ramp:new s.Uniform1i(p),u_center_direction:new s.Uniform3f(p),u_radius:new s.Uniform1f(p),u_opacity:new s.Uniform1f(p),u_temporal_offset:new s.Uniform1f(p)}),skyboxCapture:p=>({u_matrix_3f:new s.UniformMatrix3f(p),u_sun_direction:new s.Uniform3f(p),u_sun_intensity:new s.Uniform1f(p),u_color_tint_r:new s.Uniform4f(p),u_color_tint_m:new s.Uniform4f(p),u_luminance:new s.Uniform1f(p)}),globeRaster:p=>({u_proj_matrix:new s.UniformMatrix4f(p),u_globe_matrix:new s.UniformMatrix4f(p),u_normalize_matrix:new s.UniformMatrix4f(p),u_merc_matrix:new s.UniformMatrix4f(p),u_zoom_transition:new s.Uniform1f(p),u_merc_center:new s.Uniform2f(p),u_image0:new s.Uniform1i(p),u_grid_matrix:new s.UniformMatrix3f(p),u_skirt_height:new s.Uniform1f(p),u_frustum_tl:new s.Uniform3f(p),u_frustum_tr:new s.Uniform3f(p),u_frustum_br:new s.Uniform3f(p),u_frustum_bl:new s.Uniform3f(p),u_globe_pos:new s.Uniform3f(p),u_globe_radius:new s.Uniform1f(p),u_viewport:new s.Uniform2f(p)}),globeAtmosphere:p=>({u_frustum_tl:new s.Uniform3f(p),u_frustum_tr:new s.Uniform3f(p),u_frustum_br:new s.Uniform3f(p),u_frustum_bl:new s.Uniform3f(p),u_horizon:new s.Uniform1f(p),u_transition:new s.Uniform1f(p),u_fadeout_range:new s.Uniform1f(p),u_color:new s.Uniform4f(p),u_high_color:new s.Uniform4f(p),u_space_color:new s.Uniform4f(p),u_star_intensity:new s.Uniform1f(p),u_star_density:new s.Uniform1f(p),u_star_size:new s.Uniform1f(p),u_temporal_offset:new s.Uniform1f(p),u_horizon_angle:new s.Uniform1f(p),u_rotation_matrix:new s.UniformMatrix4f(p)})};let fa;function Es(p,o,c,m,b,T,I){const O=p.context,N=O.gl,H=p.transform,$=p.useProgram("collisionBox"),ce=[];let Ie=0,je=0;for(let ht=0;ht<m.length;ht++){const Ot=m[ht],kt=o.getTile(Ot),Rt=kt.getBucket(c);if(!Rt)continue;const Yt=Cn(Ot,Rt,H);let $t=Yt;0===b[0]&&0===b[1]||($t=p.translatePosMatrix(Yt,kt,b,T));const ln=I?Rt.textCollisionBox:Rt.iconCollisionBox,Gn=Rt.collisionCircleArray;if(Gn.length>0){const on=s.create(),An=$t;s.mul(on,Rt.placementInvProjMatrix,H.glCoordMatrix),s.mul(on,on,Rt.placementViewportMatrix),ce.push({circleArray:Gn,circleOffset:je,transform:An,invTransform:on,projection:Rt.getProjection()}),Ie+=Gn.length/4,je=Ie}ln&&(p.terrain&&p.terrain.setupElevationDraw(kt,$),$.draw(O,N.LINES,s.DepthMode.disabled,s.StencilMode.disabled,p.colorModeForRenderPass(),s.CullFaceMode.disabled,kc($t,H,kt,Rt.getProjection()),c.id,ln.layoutVertexBuffer,ln.indexBuffer,ln.segments,null,H.zoom,null,[ln.collisionVertexBuffer,ln.collisionVertexBufferExt]))}if(!I||!ce.length)return;const Ke=p.useProgram("collisionCircle"),Ye=new s.StructArrayLayout2f1f2i16;Ye.resize(4*Ie),Ye._trim();let nt=0;for(const ht of ce)for(let Ot=0;Ot<ht.circleArray.length/4;Ot++){const kt=4*Ot,Rt=ht.circleArray[kt+0],Yt=ht.circleArray[kt+1],$t=ht.circleArray[kt+2],ln=ht.circleArray[kt+3];Ye.emplace(nt++,Rt,Yt,$t,ln,0),Ye.emplace(nt++,Rt,Yt,$t,ln,1),Ye.emplace(nt++,Rt,Yt,$t,ln,2),Ye.emplace(nt++,Rt,Yt,$t,ln,3)}(!fa||fa.length<2*Ie)&&(fa=function(ht){const Ot=2*ht,kt=new s.StructArrayLayout3ui6;kt.resize(Ot),kt._trim();for(let Rt=0;Rt<Ot;Rt++){const Yt=6*Rt;kt.uint16[Yt+0]=4*Rt+0,kt.uint16[Yt+1]=4*Rt+1,kt.uint16[Yt+2]=4*Rt+2,kt.uint16[Yt+3]=4*Rt+2,kt.uint16[Yt+4]=4*Rt+3,kt.uint16[Yt+5]=4*Rt+0}return kt}(Ie));const ue=O.createIndexBuffer(fa,!0),$e=O.createVertexBuffer(Ye,s.collisionCircleLayout.members,!0);for(const ht of ce){const Ot={u_matrix:ht.transform,u_inv_matrix:ht.invTransform,u_camera_to_center_distance:(pt=H).getCameraToCenterDistance(ht.projection),u_viewport_size:[pt.width,pt.height]};Ke.draw(O,N.TRIANGLES,s.DepthMode.disabled,s.StencilMode.disabled,p.colorModeForRenderPass(),s.CullFaceMode.disabled,Ot,c.id,$e,ue,s.SegmentVector.simpleSegment(0,2*ht.circleOffset,ht.circleArray.length,ht.circleArray.length/2),null,H.zoom)}var pt;$e.destroy(),ue.destroy()}const sc=s.create();function Bc({width:p,height:o,anchor:c,textOffset:m,textScale:b},T){const{horizontalAlign:I,verticalAlign:O}=s.getAnchorAlignment(c),N=-(I-.5)*p,H=-(O-.5)*o,$=s.evaluateVariableOffset(c,m);return new s.Point((N/b+$[0])*T,(H/b+$[1])*T)}function Nc(p,o,c,m,b,T,I,O,N,H,$){const ce=p.text.placedSymbolArray,Ie=p.text.dynamicLayoutVertexArray,je=p.icon.dynamicLayoutVertexArray,Ke={},Ye=p.getProjection(),nt=vn(O,Ye,T),ue=T.elevation,$e=Ye.upVectorScale(O.canonical,T.center.lat,T.worldSize).metersToTile;Ie.clear();for(let pt=0;pt<ce.length;pt++){const ht=ce.get(pt),{tileAnchorX:Ot,tileAnchorY:kt,numGlyphs:Rt}=ht,Yt=ht.hidden||!ht.crossTileID||p.allowVerticalPlacement&&!ht.placedOrientation?null:m[ht.crossTileID];if(Yt){let $t=0,ln=0,Gn=0;if(ue){const qn=ue?ue.getAtTileOffset(O,Ot,kt):0,[Ti,Vi,_i]=Ye.upVector(O.canonical,Ot,kt);$t=qn*Ti*$e,ln=qn*Vi*$e,Gn=qn*_i*$e}let[on,An,hn,jn]=Ki(ht.projectedAnchorX+$t,ht.projectedAnchorY+ln,ht.projectedAnchorZ+Gn,c?nt:I);const cn=gr(T.getCameraToCenterDistance(Ye),jn);let Mn=b.evaluateSizeForFeature(p.textSizeData,H,ht)*cn/s.ONE_EM;c&&(Mn*=p.tilePixelRatio/N);const Vn=Bc(Yt,Mn);c?(({x:on,y:An,z:hn}=Ye.projectTilePoint(Ot+Vn.x,kt+Vn.y,O.canonical)),[on,An,hn]=Ki(on+$t,An+ln,hn+Gn,I)):(o&&Vn._rotate(-T.angle),on+=Vn.x,An+=Vn.y,hn=0);const Bn=p.allowVerticalPlacement&&ht.placedOrientation===s.WritingMode.vertical?Math.PI/2:0;for(let qn=0;qn<Rt;qn++)s.addDynamicAttributes(Ie,on,An,hn,Bn);$&&ht.associatedIconIndex>=0&&(Ke[ht.associatedIconIndex]={x:on,y:An,z:hn,angle:Bn})}else Le(Rt,Ie)}if($){je.clear();const pt=p.icon.placedSymbolArray;for(let ht=0;ht<pt.length;ht++){const Ot=pt.get(ht),{numGlyphs:kt}=Ot,Rt=Ke[ht];if(Ot.hidden||!Rt)Le(kt,je);else{const{x:Yt,y:$t,z:ln,angle:Gn}=Rt;for(let on=0;on<kt;on++)s.addDynamicAttributes(je,Yt,$t,ln,Gn)}}p.icon.dynamicLayoutVertexBuffer.updateData(je)}p.text.dynamicLayoutVertexBuffer.updateData(Ie)}function fl(p,o,c){return c.iconsInText&&o?"symbolTextAndIcon":p?"symbolSDF":"symbolIcon"}function Bl(p,o,c,m,b,T,I,O,N,H,$,ce){const Ie=p.context,je=Ie.gl,Ke=p.transform,Ye="map"===O,nt="map"===N,ue=Ye&&"point"!==c.layout.get("symbol-placement"),$e=Ye&&!nt&&!ue,pt=void 0!==c.layout.get("symbol-sort-key").constantOr(1);let ht=!1;const Ot=p.depthModeForSublayer(0,s.DepthMode.ReadOnly),kt=[s.mercatorXfromLng(Ke.center.lng),s.mercatorYfromLat(Ke.center.lat)],Rt=c.layout.get("text-variable-anchor"),Yt="globe"===Ke.projection.name,$t=[],ln=[0,-1,0];let Gn=ln;!Yt&&!Ke.mercatorFromTransition||Ye||(Gn=function(on){const An=on._camera.getWorldToCamera(on.worldSize,1),hn=s.multiply([],An,on.globeMatrix);s.invert(hn,hn);const jn=[0,0,0],cn=[0,1,0,0];return s.transformMat4$1(cn,cn,hn),jn[0]=cn[0],jn[1]=cn[1],jn[2]=cn[2],s.normalize(jn,jn),jn}(Ke));for(const on of m){const An=o.getTile(on),hn=An.getBucket(c);if(!hn||"mercator"===hn.projection.name&&Yt)continue;const jn=b?hn.text:hn.icon;if(!jn||hn.fullyClipped||!jn.segments.get().length)continue;const cn=jn.programConfigurations.get(c.id),Mn=b||hn.sdfIcons,Vn=b?hn.textSizeData:hn.iconSizeData,Bn=nt||0!==Ke.pitch,qn=s.evaluateSizeForZoom(Vn,Ke.zoom);let Ti,Vi,_i,Oi,po=[0,0],mo=null;if(b)Vi=An.glyphAtlasTexture,_i=je.LINEAR,Ti=An.glyphAtlasTexture.size,hn.iconsInText&&(po=An.imageAtlasTexture.size,mo=An.imageAtlasTexture,Oi=Bn||p.options.rotating||p.options.zooming||"composite"===Vn.kind||"camera"===Vn.kind?je.LINEAR:je.NEAREST);else{const mr=1!==c.layout.get("icon-size").constantOr(0)||hn.iconsNeedLinear;Vi=An.imageAtlasTexture,_i=Mn||p.options.rotating||p.options.zooming||mr||Bn?je.LINEAR:je.NEAREST,Ti=An.imageAtlasTexture.size}const bi="globe"===hn.projection.name,Fo=bi?Gn:ln,Bo=bi?s.globeToMercatorTransition(Ke.zoom):0,No=vn(on,hn.getProjection(),Ke),zo=Ke.calculatePixelsToTileUnitsMatrix(An),gs=tn(No,An.tileID.canonical,nt,Ye,Ke,hn.getProjection(),zo),Yr=p.terrain&&nt&&ue?s.invert(s.create(),gs):sc,_s=xo(No,An.tileID.canonical,nt,Ye,Ke,hn.getProjection(),zo),Qa=Rt&&hn.hasTextData(),yr="none"!==c.layout.get("icon-text-fit")&&Qa&&hn.hasIconData();if(ue){const mr=Ke.elevation,bl=mr?mr.getAtTileOffsetFunc(on,Ke.center.lat,Ke.worldSize,hn.getProjection()):null,Sa=Qo(No,An.tileID.canonical,nt,Ye,Ke,hn.getProjection(),zo);Zr(hn,No,p,b,Sa,_s,nt,H,bl,on)}const ar=ue||b&&Rt||yr,Uo=p.translatePosMatrix(No,An,T,I),Jr=ar?sc:gs,Ys=p.translatePosMatrix(_s,An,T,I,!0),vr=hn.getProjection().createInversionMatrix(Ke,on.canonical),la=[];p.terrainRenderModeElevated()&&nt&&la.push("PITCH_WITH_MAP_TERRAIN"),bi&&la.push("PROJECTION_GLOBE_VIEW"),ar&&la.push("PROJECTED_POS_ON_VIEWPORT");const xl=Mn&&0!==c.paint.get(b?"text-halo-width":"icon-halo-width").constantOr(1);let gc;gc=Mn?hn.iconsInText?Or(Vn.kind,qn,$e,nt,p,Uo,Jr,Ys,Ti,po,on,Bo,kt,vr,Fo,hn.getProjection()):ha(Vn.kind,qn,$e,nt,p,Uo,Jr,Ys,b,Ti,!0,on,Bo,kt,vr,Fo,hn.getProjection()):Rs(Vn.kind,qn,$e,nt,p,Uo,Jr,Ys,b,Ti,on,Bo,kt,vr,Fo,hn.getProjection());const bu={program:p.useProgram(fl(Mn,b,hn),cn,la),buffers:jn,uniformValues:gc,atlasTexture:Vi,atlasTextureIcon:mo,atlasInterpolation:_i,atlasInterpolationIcon:Oi,isSDF:Mn,hasHalo:xl,tile:An,labelPlaneMatrixInv:Yr};if(pt&&hn.canOverlap){ht=!0;const mr=jn.segments.get();for(const bl of mr)$t.push({segments:new s.SegmentVector([bl]),sortKey:bl.sortKey,state:bu})}else $t.push({segments:jn.segments,sortKey:0,state:bu})}ht&&$t.sort((on,An)=>on.sortKey-An.sortKey);for(const on of $t){const An=on.state;if(p.terrain&&p.terrain.setupElevationDraw(An.tile,An.program,{useDepthForOcclusion:!Yt,labelPlaneMatrixInv:An.labelPlaneMatrixInv}),Ie.activeTexture.set(je.TEXTURE0),An.atlasTexture.bind(An.atlasInterpolation,je.CLAMP_TO_EDGE),An.atlasTextureIcon&&(Ie.activeTexture.set(je.TEXTURE1),An.atlasTextureIcon&&An.atlasTextureIcon.bind(An.atlasInterpolationIcon,je.CLAMP_TO_EDGE)),An.isSDF){const hn=An.uniformValues;An.hasHalo&&(hn.u_is_halo=1,Ia(An.buffers,on.segments,c,p,An.program,Ot,$,ce,hn)),hn.u_is_halo=0}Ia(An.buffers,on.segments,c,p,An.program,Ot,$,ce,An.uniformValues)}}function Ia(p,o,c,m,b,T,I,O,N){const H=m.context,$=[p.dynamicLayoutVertexBuffer,p.opacityVertexBuffer,p.globeExtVertexBuffer];b.draw(H,H.gl.TRIANGLES,T,I,O,s.CullFaceMode.disabled,N,c.id,p.layoutVertexBuffer,p.indexBuffer,o,c.paint,m.transform.zoom,p.programConfigurations.get(c.id),$)}function Nl(p,o,c,m,b,T,I){const O=p.context.gl,N=c.paint.get("fill-pattern"),H=N&&N.constantOr(1);let $,ce,Ie,je,Ke;I?(ce=H&&!c.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",$=O.LINES):(ce=H?"fillPattern":"fill",$=O.TRIANGLES);for(const Ye of m){const nt=o.getTile(Ye);if(H&&!nt.patternsLoaded())continue;const ue=nt.getBucket(c);if(!ue)continue;p.prepareDrawTile();const $e=ue.programConfigurations.get(c.id),pt=p.useProgram(ce,$e);H&&(p.context.activeTexture.set(O.TEXTURE0),nt.imageAtlasTexture.bind(O.LINEAR,O.CLAMP_TO_EDGE),$e.updatePaintBuffers());const ht=N.constantOr(null);if(ht&&nt.imageAtlas){const kt=nt.imageAtlas.patternPositions[ht.toString()];kt&&$e.setConstantPatternPositions(kt)}const Ot=p.translatePosMatrix(Ye.projMatrix,nt,c.paint.get("fill-translate"),c.paint.get("fill-translate-anchor"));if(I){je=ue.indexBuffer2,Ke=ue.segments2;const kt=p.terrain&&p.terrain.renderingToTexture?p.terrain.drapeBufferSize:[O.drawingBufferWidth,O.drawingBufferHeight];Ie="fillOutlinePattern"===ce&&H?sr(Ot,p,nt,kt):hi(Ot,kt)}else je=ue.indexBuffer,Ke=ue.segments,Ie=H?bn(Ot,p,nt):ke(Ot);p.prepareDrawProgram(p.context,pt,Ye.toUnwrapped()),pt.draw(p.context,$,b,p.stencilModeForClipping(Ye),T,s.CullFaceMode.disabled,Ie,c.id,ue.layoutVertexBuffer,je,Ke,c.paint,p.transform.zoom,$e)}}function ml(p,o,c,m,b,T,I){const O=p.context,N=O.gl,H=p.transform,$=c.paint.get("fill-extrusion-pattern"),ce=$.constantOr(1),Ie=c.paint.get("fill-extrusion-opacity"),je=[c.paint.get("fill-extrusion-ambient-occlusion-intensity"),c.paint.get("fill-extrusion-ambient-occlusion-radius")],Ke=c.layout.get("fill-extrusion-edge-radius"),Ye=Ke>0&&!c.paint.get("fill-extrusion-rounded-roof"),nt=Ye?0:Ke,ue="globe"===H.projection.name?s.fillExtrusionHeightLift():0,$e="globe"===H.projection.name,pt=$e?s.globeToMercatorTransition(H.zoom):0,ht=[s.mercatorXfromLng(H.center.lng),s.mercatorYfromLat(H.center.lat)],Ot=[];$e&&Ot.push("PROJECTION_GLOBE_VIEW"),je[0]>0&&Ot.push("FAUX_AO"),Ye&&Ot.push("ZERO_ROOF_RADIUS");for(const kt of m){const Rt=o.getTile(kt),Yt=Rt.getBucket(c);if(!Yt||Yt.projection.name!==H.projection.name)continue;const $t=Yt.programConfigurations.get(c.id),ln=p.useProgram(ce?"fillExtrusionPattern":"fillExtrusion",$t,Ot);if(p.terrain){const Mn=p.terrain;if(p.style.terrainSetForDrapingOnly())Mn.setupElevationDraw(Rt,ln,{useMeterToDem:!0});else{if(!Yt.enableTerrain)continue;if(Mn.setupElevationDraw(Rt,ln,{useMeterToDem:!0}),fu(O,o,kt,Yt,c,Mn),!Yt.centroidVertexBuffer){const Vn=ln.attributes.a_centroid_pos;void 0!==Vn&&N.vertexAttrib2f(Vn,0,0)}}}ce&&(p.context.activeTexture.set(N.TEXTURE0),Rt.imageAtlasTexture.bind(N.LINEAR,N.CLAMP_TO_EDGE),$t.updatePaintBuffers());const Gn=$.constantOr(null);if(Gn&&Rt.imageAtlas){const Mn=Rt.imageAtlas.patternPositions[Gn.toString()];Mn&&$t.setConstantPatternPositions(Mn)}const on=p.translatePosMatrix(kt.projMatrix,Rt,c.paint.get("fill-extrusion-translate"),c.paint.get("fill-extrusion-translate-anchor")),An=H.projection.createInversionMatrix(H,kt.canonical),hn=c.paint.get("fill-extrusion-vertical-gradient"),jn=ce?G(on,p,hn,Ie,je,nt,kt,Rt,ue,pt,ht,An):J(on,p,hn,Ie,je,nt,kt,ue,pt,ht,An);p.prepareDrawProgram(O,ln,kt.toUnwrapped());const cn=[];p.terrain&&cn.push(Yt.centroidVertexBuffer),$e&&cn.push(Yt.layoutVertexExtBuffer),ln.draw(O,O.gl.TRIANGLES,b,T,I,s.CullFaceMode.backCCW,jn,c.id,Yt.layoutVertexBuffer,Yt.indexBuffer,Yt.segments,c.paint,p.transform.zoom,$t,cn)}}function fu(p,o,c,m,b,T){const I=[ue=>{let $e=ue.canonical.x-1,pt=ue.wrap;return $e<0&&($e=(1<<ue.canonical.z)-1,pt--),new s.OverscaledTileID(ue.overscaledZ,pt,ue.canonical.z,$e,ue.canonical.y)},ue=>{let $e=ue.canonical.x+1,pt=ue.wrap;return $e===1<<ue.canonical.z&&($e=0,pt++),new s.OverscaledTileID(ue.overscaledZ,pt,ue.canonical.z,$e,ue.canonical.y)},ue=>new s.OverscaledTileID(ue.overscaledZ,ue.wrap,ue.canonical.z,ue.canonical.x,(0===ue.canonical.y?1<<ue.canonical.z:ue.canonical.y)-1),ue=>new s.OverscaledTileID(ue.overscaledZ,ue.wrap,ue.canonical.z,ue.canonical.x,ue.canonical.y===(1<<ue.canonical.z)-1?0:ue.canonical.y+1)],O=ue=>{const $e=o.getSource().minzoom,pt=Ot=>{const kt=o.getTileByID(Ot);if(kt&&kt.hasData())return kt.getBucket(b)},ht=[0,-1,1];for(const Ot of ht){if(ue.overscaledZ+Ot<$e)continue;const kt=pt(ue.calculateScaledKey(ue.overscaledZ+Ot));if(kt)return kt}},N=[0,0,0],H=(ue,$e)=>(N[0]=Math.min(ue.min.y,$e.min.y),N[1]=Math.max(ue.max.y,$e.max.y),N[2]=s.EXTENT-$e.min.x>ue.max.x?$e.min.x-s.EXTENT:ue.max.x,N),$=(ue,$e)=>(N[0]=Math.min(ue.min.x,$e.min.x),N[1]=Math.max(ue.max.x,$e.max.x),N[2]=s.EXTENT-$e.min.y>ue.max.y?$e.min.y-s.EXTENT:ue.max.y,N),ce=[(ue,$e)=>H(ue,$e),(ue,$e)=>H($e,ue),(ue,$e)=>$(ue,$e),(ue,$e)=>$($e,ue)],Ie=new s.Point(0,0);let je,Ke,Ye;const nt=(ue,$e,pt,ht,Ot)=>{const kt=[[ht?pt:ue,ht?ue:pt,0],[ht?pt:$e,ht?$e:pt,0]],Rt=Ot<0?s.EXTENT+Ot:Ot,Yt=[ht?Rt:(ue+$e)/2,ht?(ue+$e)/2:Rt,0];return 0===pt&&Ot<0||0!==pt&&Ot>0?T.getForTilePoints(Ye,[Yt],!0,Ke):kt.push(Yt),T.getForTilePoints(c,kt,!0,je),Math.max(kt[0][2],kt[1][2],Yt[2])/T.exaggeration()};for(let ue=0;ue<4;ue++){const $e=(ue<2?1:5)-ue,pt=m.borders[ue];if(0===pt.length)continue;const ht=Ye=I[ue](c),Ot=O(ht);if(!(Ot&&Ot instanceof s.FillExtrusionBucket&&Ot.enableTerrain)||m.borderDoneWithNeighborZ[ue]===Ot.canonical.z&&Ot.borderDoneWithNeighborZ[$e]===m.canonical.z||(Ke=T.findDEMTileFor(ht),!Ke||!Ke.dem))continue;if(!je){const $t=T.findDEMTileFor(c);if(!$t||!$t.dem)return;je=$t}const kt=Ot.borders[$e];let Rt=0;const Yt=Ot.borderDoneWithNeighborZ[$e]!==m.canonical.z;if(m.canonical.z===Ot.canonical.z){for(let $t=0;$t<pt.length;$t++){const ln=m.featuresOnBorder[pt[$t]],Gn=ln.borders[ue];let on;for(;Rt<kt.length&&(on=Ot.featuresOnBorder[kt[Rt]],!(on.borders[$e][1]>Gn[0]+3));)Yt&&Ot.encodeCentroid(void 0,on,!1),Rt++;if(on&&Rt<kt.length){const An=Rt;let hn=0;for(;!(on.borders[$e][0]>Gn[1]-3)&&(hn++,++Rt!==kt.length);)on=Ot.featuresOnBorder[kt[Rt]];if(on=Ot.featuresOnBorder[kt[An]],ln.intersectsCount()>1||on.intersectsCount()>1||1!==hn){1!==hn&&(Rt=An),m.encodeCentroid(void 0,ln,!1),Yt&&Ot.encodeCentroid(void 0,on,!1);continue}const jn=ce[ue](ln,on),cn=ue%2?s.EXTENT-1:0;Ie.x=nt(jn[0],Math.min(s.EXTENT-1,jn[1]),cn,ue<2,jn[2]),Ie.y=0,m.encodeCentroid(Ie,ln,!1),Yt&&Ot.encodeCentroid(Ie,on,!1)}else m.encodeCentroid(void 0,ln,!1)}m.borderDoneWithNeighborZ[ue]=Ot.canonical.z,m.needsCentroidUpdate=!0,Yt&&(Ot.borderDoneWithNeighborZ[$e]=m.canonical.z,Ot.needsCentroidUpdate=!0)}else{for(const $t of pt)m.encodeCentroid(void 0,m.featuresOnBorder[$t],!1);if(Yt){for(const $t of kt)Ot.encodeCentroid(void 0,Ot.featuresOnBorder[$t],!1);Ot.borderDoneWithNeighborZ[$e]=m.canonical.z,Ot.needsCentroidUpdate=!0}m.borderDoneWithNeighborZ[ue]=Ot.canonical.z,m.needsCentroidUpdate=!0}}(m.needsCentroidUpdate||!m.centroidVertexBuffer&&0!==m.centroidVertexArray.length)&&m.uploadCentroid(p)}const Ba=new s.Color(1,0,0,1),ac=new s.Color(0,1,0,1),mu=new s.Color(0,0,1,1),zl=new s.Color(1,0,1,1),lc=new s.Color(0,1,1,1);function zc(p,o,c){const m=p.context,b=p.transform,T=m.gl,I="globe"===b.projection.name,O=I?["PROJECTION_GLOBE_VIEW"]:null;let N=c.projMatrix;if(I&&s.globeToMercatorTransition(b.zoom)>0){const ln=s.transitionTileAABBinECEF(c.canonical,b),Gn=s.globeDenormalizeECEF(ln);N=s.multiply(new Float32Array(16),b.globeMatrix,Gn),s.multiply(N,b.projMatrix,N)}const H=p.useProgram("debug",null,O),$=o.getTileByID(c.key);p.terrain&&p.terrain.setupElevationDraw($,H);const ce=s.DepthMode.disabled,Ie=s.StencilMode.disabled,je=p.colorModeForRenderPass();m.activeTexture.set(T.TEXTURE0),p.emptyTexture.bind(T.LINEAR,T.CLAMP_TO_EDGE),I?$._makeGlobeTileDebugBuffers(p.context,b):$._makeDebugTileBoundsBuffers(p.context,b.projection);const Ye=$._tileDebugBuffer||p.debugBuffer,nt=$._tileDebugIndexBuffer||p.debugIndexBuffer,ue=$._tileDebugSegments||p.debugSegments;H.draw(m,T.LINE_STRIP,ce,Ie,je,s.CullFaceMode.disabled,Fc(N,s.Color.red),"$debug",Ye,nt,ue,null,null,null,[$._globeTileDebugBorderBuffer]);const $e=$.latestRawTileData,pt=Math.floor(($e&&$e.byteLength||0)/1024),ht=o.getTile(c).tileSize,Ot=512/Math.min(ht,512)*(c.overscaledZ/b.zoom)*.5;let kt=c.canonical.toString();c.overscaledZ!==c.canonical.z&&(kt+=` => ${c.overscaledZ}`),kt+=` ${pt}kb`,function(ln,Gn){ln.initDebugOverlayCanvas();const on=ln.debugOverlayCanvas,An=ln.context.gl,hn=ln.debugOverlayCanvas.getContext("2d");hn.clearRect(0,0,on.width,on.height),hn.shadowColor="white",hn.shadowBlur=2,hn.lineWidth=1.5,hn.strokeStyle="white",hn.textBaseline="top",hn.font="bold 36px Open Sans, sans-serif",hn.fillText(Gn,5,5),hn.strokeText(Gn,5,5),ln.debugOverlayTexture.update(on),ln.debugOverlayTexture.bind(An.LINEAR,An.CLAMP_TO_EDGE)}(p,kt);const Rt=$._tileDebugTextBuffer||p.debugBuffer,Yt=$._tileDebugTextIndexBuffer||p.quadTriangleIndexBuffer,$t=$._tileDebugTextSegments||p.debugSegments;H.draw(m,T.TRIANGLES,ce,Ie,s.ColorMode.alphaBlended,s.CullFaceMode.disabled,Fc(N,s.Color.transparent,Ot),"$debug",Rt,Yt,$t,null,null,null,[$._globeTileDebugTextBuffer])}function Uc(p,o,c,m){Na(p,0,o+c/2,p.transform.width,c,m)}function Ul(p,o,c,m){Na(p,o-c/2,0,c,p.transform.height,m)}function Na(p,o,c,m,b,T){const I=p.context,O=I.gl;O.enable(O.SCISSOR_TEST),O.scissor(o*s.exported.devicePixelRatio,c*s.exported.devicePixelRatio,m*s.exported.devicePixelRatio,b*s.exported.devicePixelRatio),I.clear({color:T}),O.disable(O.SCISSOR_TEST)}const cc=s.createLayout([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:uc}=cc;function ra(p,o,c,m){p.emplaceBack(o,c,m)}class ma{constructor(o){this.vertexArray=new s.StructArrayLayout3f12,this.indices=new s.StructArrayLayout3ui6,ra(this.vertexArray,-1,-1,1),ra(this.vertexArray,1,-1,1),ra(this.vertexArray,-1,1,1),ra(this.vertexArray,1,1,1),ra(this.vertexArray,-1,-1,-1),ra(this.vertexArray,1,-1,-1),ra(this.vertexArray,-1,1,-1),ra(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=o.createVertexBuffer(this.vertexArray,uc),this.indexBuffer=o.createIndexBuffer(this.indices),this.segment=s.SegmentVector.simpleSegment(0,0,36,12)}}function Z(p,o,c,m,b,T){const I=p.gl,O=o.paint.get("sky-atmosphere-color"),N=o.paint.get("sky-atmosphere-halo-color"),H=o.paint.get("sky-atmosphere-sun-intensity"),$={u_matrix_3f:s.fromMat4(s.create$1(),m),u_sun_direction:b,u_sun_intensity:H,u_color_tint_r:[(Ke=O).r,Ke.g,Ke.b,Ke.a],u_color_tint_m:[(Ye=N).r,Ye.g,Ye.b,Ye.a],u_luminance:5e-5};var Ke,Ye;I.framebufferTexture2D(I.FRAMEBUFFER,I.COLOR_ATTACHMENT0,I.TEXTURE_CUBE_MAP_POSITIVE_X+T,o.skyboxTexture,0),c.draw(p,I.TRIANGLES,s.DepthMode.disabled,s.StencilMode.disabled,s.ColorMode.unblended,s.CullFaceMode.frontCW,$,"skyboxCapture",o.skyboxGeometry.vertexBuffer,o.skyboxGeometry.indexBuffer,o.skyboxGeometry.segment)}const de=s.createLayout([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class W{constructor(o){const c=new s.StructArrayLayout5f20;c.emplaceBack(-1,1,1,0,0),c.emplaceBack(1,1,1,1,0),c.emplaceBack(1,-1,1,1,1),c.emplaceBack(-1,-1,1,0,1);const m=new s.StructArrayLayout3ui6;m.emplaceBack(0,1,2),m.emplaceBack(2,3,0),this.vertexBuffer=o.createVertexBuffer(c,de.members),this.indexBuffer=o.createIndexBuffer(m),this.segments=s.SegmentVector.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const Ce={symbol:function(p,o,c,m,b){if("translucent"!==p.renderPass)return;const T=s.StencilMode.disabled,I=p.colorModeForRenderPass();c.layout.get("text-variable-anchor")&&function(O,N,H,$,ce,Ie,je){const Ke=N.transform,Ye="map"===ce,nt="map"===Ie;for(const ue of O){const $e=$.getTile(ue),pt=$e.getBucket(H);if(!pt||!pt.text||!pt.text.segments.get().length)continue;const ht=s.evaluateSizeForZoom(pt.textSizeData,Ke.zoom),Ot=vn(ue,pt.getProjection(),Ke),kt=Ke.calculatePixelsToTileUnitsMatrix($e),Rt=tn(Ot,$e.tileID.canonical,nt,Ye,Ke,pt.getProjection(),kt),Yt="none"!==H.layout.get("icon-text-fit")&&pt.hasIconData();if(ht){const $t=Math.pow(2,Ke.zoom-$e.tileID.overscaledZ);Nc(pt,Ye,nt,je,s.symbolSize,Ke,Rt,ue,$t,ht,Yt)}}}(m,p,c,o,c.layout.get("text-rotation-alignment"),c.layout.get("text-pitch-alignment"),b),0!==c.paint.get("icon-opacity").constantOr(1)&&Bl(p,o,c,m,!1,c.paint.get("icon-translate"),c.paint.get("icon-translate-anchor"),c.layout.get("icon-rotation-alignment"),c.layout.get("icon-pitch-alignment"),c.layout.get("icon-keep-upright"),T,I),0!==c.paint.get("text-opacity").constantOr(1)&&Bl(p,o,c,m,!0,c.paint.get("text-translate"),c.paint.get("text-translate-anchor"),c.layout.get("text-rotation-alignment"),c.layout.get("text-pitch-alignment"),c.layout.get("text-keep-upright"),T,I),o.map.showCollisionBoxes&&(Es(p,o,c,m,c.paint.get("text-translate"),c.paint.get("text-translate-anchor"),!0),Es(p,o,c,m,c.paint.get("icon-translate"),c.paint.get("icon-translate-anchor"),!1))},circle:function(p,o,c,m){if("translucent"!==p.renderPass)return;const b=c.paint.get("circle-opacity"),T=c.paint.get("circle-stroke-width"),I=c.paint.get("circle-stroke-opacity"),O=void 0!==c.layout.get("circle-sort-key").constantOr(1);if(0===b.constantOr(1)&&(0===T.constantOr(1)||0===I.constantOr(1)))return;const N=p.context,H=N.gl,$=p.transform,ce=p.depthModeForSublayer(0,s.DepthMode.ReadOnly),Ie=s.StencilMode.disabled,je=p.colorModeForRenderPass(),Ke="globe"===$.projection.name,Ye=[s.mercatorXfromLng($.center.lng),s.mercatorYfromLat($.center.lat)],nt=[];for(let $e=0;$e<m.length;$e++){const pt=m[$e],ht=o.getTile(pt),Ot=ht.getBucket(c);if(!Ot||Ot.projection.name!==$.projection.name)continue;const kt=Ot.programConfigurations.get(c.id),Rt=qa(c);Ke&&Rt.push("PROJECTION_GLOBE_VIEW");const Yt=p.useProgram("circle",kt,Rt),$t=Ot.layoutVertexBuffer,ln=Ot.globeExtVertexBuffer,Gn=Ot.indexBuffer,on=$.projection.createInversionMatrix($,pt.canonical),An={programConfiguration:kt,program:Yt,layoutVertexBuffer:$t,globeExtVertexBuffer:ln,indexBuffer:Gn,uniformValues:Ws(p,pt,ht,on,Ye,c),tile:ht};if(O){const hn=Ot.segments.get();for(const jn of hn)nt.push({segments:new s.SegmentVector([jn]),sortKey:jn.sortKey,state:An})}else nt.push({segments:Ot.segments,sortKey:0,state:An})}O&&nt.sort(($e,pt)=>$e.sortKey-pt.sortKey);const ue={useDepthForOcclusion:!Ke};for(const $e of nt){const{programConfiguration:pt,program:ht,layoutVertexBuffer:Ot,globeExtVertexBuffer:kt,indexBuffer:Rt,uniformValues:Yt,tile:$t}=$e.state,ln=$e.segments;p.terrain&&p.terrain.setupElevationDraw($t,ht,ue),p.prepareDrawProgram(N,ht,$t.tileID.toUnwrapped()),ht.draw(N,H.TRIANGLES,ce,Ie,je,s.CullFaceMode.disabled,Yt,c.id,Ot,Rt,ln,c.paint,$.zoom,pt,[kt])}},heatmap:function(p,o,c,m){if(0!==c.paint.get("heatmap-opacity"))if("offscreen"===p.renderPass){const b=p.context,T=b.gl,I=s.StencilMode.disabled,O=new s.ColorMode([T.ONE,T.ONE],s.Color.transparent,[!0,!0,!0,!0]);(function(je,Ke,Ye,nt){const ue=je.gl,$e=Ke.width*nt,pt=Ke.height*nt;je.activeTexture.set(ue.TEXTURE1),je.viewport.set([0,0,$e,pt]);let ht=Ye.heatmapFbo;if(!ht||ht&&(ht.width!==$e||ht.height!==pt)){ht&&ht.destroy();const Ot=ue.createTexture();ue.bindTexture(ue.TEXTURE_2D,Ot),ue.texParameteri(ue.TEXTURE_2D,ue.TEXTURE_WRAP_S,ue.CLAMP_TO_EDGE),ue.texParameteri(ue.TEXTURE_2D,ue.TEXTURE_WRAP_T,ue.CLAMP_TO_EDGE),ue.texParameteri(ue.TEXTURE_2D,ue.TEXTURE_MIN_FILTER,ue.LINEAR),ue.texParameteri(ue.TEXTURE_2D,ue.TEXTURE_MAG_FILTER,ue.LINEAR),ht=Ye.heatmapFbo=je.createFramebuffer($e,pt,!1),function(kt,Rt,Yt,$t,ln,Gn){const on=kt.gl;on.texImage2D(on.TEXTURE_2D,0,kt.isWebGL2&&kt.extRenderToTextureHalfFloat?on.RGBA16F:on.RGBA,ln,Gn,0,on.RGBA,kt.extRenderToTextureHalfFloat?kt.isWebGL2?on.HALF_FLOAT:kt.extTextureHalfFloat.HALF_FLOAT_OES:on.UNSIGNED_BYTE,null),$t.colorAttachment.set(Yt)}(je,0,Ot,ht,$e,pt)}else ue.bindTexture(ue.TEXTURE_2D,ht.colorAttachment.get()),je.bindFramebuffer.set(ht.framebuffer)})(b,p,c,"globe"===p.transform.projection.name?.5:.25),b.clear({color:s.Color.transparent});const N=p.transform,H="globe"===N.projection.name,$=H?["PROJECTION_GLOBE_VIEW"]:null,ce=H?s.CullFaceMode.frontCCW:s.CullFaceMode.disabled,Ie=[s.mercatorXfromLng(N.center.lng),s.mercatorYfromLat(N.center.lat)];for(let je=0;je<m.length;je++){const Ke=m[je];if(o.hasRenderableParent(Ke))continue;const Ye=o.getTile(Ke),nt=Ye.getBucket(c);if(!nt||nt.projection.name!==N.projection.name)continue;const ue=nt.programConfigurations.get(c.id),$e=p.useProgram("heatmap",ue,$),{zoom:pt}=p.transform;p.terrain&&p.terrain.setupElevationDraw(Ye,$e),p.prepareDrawProgram(b,$e,Ke.toUnwrapped());const ht=N.projection.createInversionMatrix(N,Ke.canonical);$e.draw(b,T.TRIANGLES,s.DepthMode.disabled,I,O,ce,Ll(p,Ke,Ye,ht,Ie,pt,c.paint.get("heatmap-intensity")),c.id,nt.layoutVertexBuffer,nt.indexBuffer,nt.segments,c.paint,p.transform.zoom,ue,H?[nt.globeExtVertexBuffer]:null)}b.viewport.set([0,0,p.width,p.height])}else"translucent"===p.renderPass&&(p.context.setColorMode(p.colorModeForRenderPass()),function(b,T){const I=b.context,O=I.gl,N=T.heatmapFbo;if(!N)return;I.activeTexture.set(O.TEXTURE0),O.bindTexture(O.TEXTURE_2D,N.colorAttachment.get()),I.activeTexture.set(O.TEXTURE1);let H=T.colorRampTexture;H||(H=T.colorRampTexture=new s.Texture(I,T.colorRamp,O.RGBA)),H.bind(O.LINEAR,O.CLAMP_TO_EDGE),b.useProgram("heatmapTexture").draw(I,O.TRIANGLES,s.DepthMode.disabled,s.StencilMode.disabled,b.colorModeForRenderPass(),s.CullFaceMode.disabled,{u_image:0,u_color_ramp:1,u_opacity:T.paint.get("heatmap-opacity")},T.id,b.viewportBuffer,b.quadTriangleIndexBuffer,b.viewportSegments,T.paint,b.transform.zoom)}(p,c))},line:function(p,o,c,m){if("translucent"!==p.renderPass)return;const b=c.paint.get("line-opacity"),T=c.paint.get("line-width");if(0===b.constantOr(1)||0===T.constantOr(1))return;const I=p.depthModeForSublayer(0,s.DepthMode.ReadOnly),O=p.colorModeForRenderPass(),N=p.terrain&&p.terrain.renderingToTexture?1:s.exported.devicePixelRatio,H=c.paint.get("line-dasharray"),$=H.constantOr(1),ce=c.layout.get("line-cap"),Ie=c.paint.get("line-pattern"),je=Ie.constantOr(1),Ke=c.paint.get("line-gradient"),Ye=je?"linePattern":"line",nt=p.context,ue=nt.gl,$e=(ht=>{const Ot=[];Ya(ht)&&Ot.push("RENDER_LINE_DASH"),ht.paint.get("line-gradient")&&Ot.push("RENDER_LINE_GRADIENT");const kt=ht.paint.get("line-trim-offset");0===kt[0]&&0===kt[1]||Ot.push("RENDER_LINE_TRIM_OFFSET");const Rt=ht.paint.get("line-pattern").constantOr(1),Yt=1!==ht.paint.get("line-opacity").constantOr(1);return!Rt&&Yt&&Ot.push("RENDER_LINE_ALPHA_DISCARD"),Ot})(c);let pt=$e.includes("RENDER_LINE_ALPHA_DISCARD");p.terrain&&p.terrain.clipOrMaskOverlapStencilType()&&(pt=!1);for(const ht of m){const Ot=o.getTile(ht);if(je&&!Ot.patternsLoaded())continue;const kt=Ot.getBucket(c);if(!kt)continue;p.prepareDrawTile();const Rt=kt.programConfigurations.get(c.id),Yt=p.useProgram(Ye,Rt,$e),$t=Ie.constantOr(null);if($t&&Ot.imageAtlas){const Mn=Ot.imageAtlas.patternPositions[$t.toString()];Mn&&Rt.setConstantPatternPositions(Mn)}const ln=H.constantOr(null),Gn=ce.constantOr(null);if(!je&&ln&&Gn&&Ot.lineAtlas){const Mn=Ot.lineAtlas.getDash(ln,Gn);Mn&&Rt.setConstantPatternPositions(Mn)}let[on,An]=c.paint.get("line-trim-offset");("round"===Gn||"square"===Gn)&&on!==An&&(0===on&&(on-=1),1===An&&(An+=1));const hn=p.terrain?ht.projMatrix:null,jn=je?Os(p,Ot,c,hn,N):rc(p,Ot,c,hn,kt.lineClipsArray.length,N,[on,An]);if(Ke){const Mn=kt.gradients[c.id];let Vn=Mn.texture;if(c.gradientVersion!==Mn.version){let Bn=256;if(c.stepInterpolant){const qn=o.getSource().maxzoom,Ti=ht.canonical.z===qn?Math.ceil(1<<p.transform.maxZoom-ht.canonical.z):1;Bn=s.clamp(s.nextPowerOfTwo(kt.maxLineLength/s.EXTENT*1024*Ti),256,nt.maxTextureSize)}Mn.gradient=s.renderColorRamp({expression:c.gradientExpression(),evaluationKey:"lineProgress",resolution:Bn,image:Mn.gradient||void 0,clips:kt.lineClipsArray}),Mn.texture?Mn.texture.update(Mn.gradient):Mn.texture=new s.Texture(nt,Mn.gradient,ue.RGBA),Mn.version=c.gradientVersion,Vn=Mn.texture}nt.activeTexture.set(ue.TEXTURE1),Vn.bind(c.stepInterpolant?ue.NEAREST:ue.LINEAR,ue.CLAMP_TO_EDGE)}$&&(nt.activeTexture.set(ue.TEXTURE0),Ot.lineAtlasTexture.bind(ue.LINEAR,ue.REPEAT),Rt.updatePaintBuffers()),je&&(nt.activeTexture.set(ue.TEXTURE0),Ot.imageAtlasTexture.bind(ue.LINEAR,ue.CLAMP_TO_EDGE),Rt.updatePaintBuffers()),p.prepareDrawProgram(nt,Yt,ht.toUnwrapped());const cn=Mn=>{Yt.draw(nt,ue.TRIANGLES,I,Mn,O,s.CullFaceMode.disabled,jn,c.id,kt.layoutVertexBuffer,kt.indexBuffer,kt.segments,c.paint,p.transform.zoom,Rt,[kt.layoutVertexBuffer2])};if(pt){const Mn=p.stencilModeForClipping(ht).ref;0===Mn&&p.terrain&&nt.clear({stencil:0});const Vn={func:ue.EQUAL,mask:255};jn.u_alpha_discard_threshold=.8,cn(new s.StencilMode(Vn,Mn,255,ue.KEEP,ue.KEEP,ue.INVERT)),jn.u_alpha_discard_threshold=0,cn(new s.StencilMode(Vn,Mn,255,ue.KEEP,ue.KEEP,ue.KEEP))}else cn(p.stencilModeForClipping(ht))}pt&&(p.resetStencilClippingMasks(),p.terrain&&nt.clear({stencil:0}))},fill:function(p,o,c,m){const b=c.paint.get("fill-color"),T=c.paint.get("fill-opacity");if(0===T.constantOr(1))return;const I=p.colorModeForRenderPass(),O=c.paint.get("fill-pattern"),N=p.opaquePassEnabledForLayer()&&!O.constantOr(1)&&1===b.constantOr(s.Color.transparent).a&&1===T.constantOr(0)?"opaque":"translucent";if(p.renderPass===N){const H=p.depthModeForSublayer(1,"opaque"===p.renderPass?s.DepthMode.ReadWrite:s.DepthMode.ReadOnly);Nl(p,o,c,m,H,I,!1)}if("translucent"===p.renderPass&&c.paint.get("fill-antialias")){const H=p.depthModeForSublayer(c.getPaintProperty("fill-outline-color")?2:0,s.DepthMode.ReadOnly);Nl(p,o,c,m,H,I,!0)}},"fill-extrusion":function(p,o,c,m){const b=c.paint.get("fill-extrusion-opacity");if(0!==b&&"translucent"===p.renderPass){const T=new s.DepthMode(p.context.gl.LEQUAL,s.DepthMode.ReadWrite,p.depthRangeFor3D);if(1!==b||c.paint.get("fill-extrusion-pattern").constantOr(1))ml(p,o,c,m,T,s.StencilMode.disabled,s.ColorMode.disabled),ml(p,o,c,m,T,p.stencilModeFor3D(),p.colorModeForRenderPass()),p.resetStencilClippingMasks();else{const I=p.colorModeForRenderPass();ml(p,o,c,m,T,s.StencilMode.disabled,I)}}},hillshade:function(p,o,c,m){if("offscreen"!==p.renderPass&&"translucent"!==p.renderPass)return;const b=p.context,T=p.depthModeForSublayer(0,s.DepthMode.ReadOnly),I=p.colorModeForRenderPass(),O=p.terrain&&p.terrain.renderingToTexture,[N,H]="translucent"!==p.renderPass||O?[{},m]:p.stencilConfigForOverlap(m);for(const $ of H){const ce=o.getTile($);if(ce.needsHillshadePrepare&&"offscreen"===p.renderPass)Pr(p,ce,c,T,s.StencilMode.disabled,I);else if("translucent"===p.renderPass){const Ie=O&&p.terrain?p.terrain.stencilModeForRTTOverlap($):N[$.overscaledZ];wr(p,$,ce,c,T,Ie,I)}}b.viewport.set([0,0,p.width,p.height]),p.resetStencilClippingMasks()},raster:function(p,o,c,m,b,T){if("translucent"!==p.renderPass||0===c.paint.get("raster-opacity")||!m.length)return;const I=p.context,O=I.gl,N=o.getSource(),H=p.useProgram("raster"),$=p.colorModeForRenderPass(),ce=p.terrain&&p.terrain.renderingToTexture,[Ie,je]=N instanceof me||ce?[{},m]:p.stencilConfigForOverlap(m),Ke=je[je.length-1].overscaledZ,Ye=!p.options.moving;for(const nt of je){const ue=ce?s.DepthMode.disabled:p.depthModeForSublayer(nt.overscaledZ-Ke,1===c.paint.get("raster-opacity")?s.DepthMode.ReadWrite:s.DepthMode.ReadOnly,O.LESS),$e=nt.toUnwrapped(),pt=o.getTile(nt);if(ce&&(!pt||!pt.hasData()))continue;const ht=ce?nt.projMatrix:p.transform.calculateProjMatrix($e,Ye),Ot=p.terrain&&ce?p.terrain.stencilModeForRTTOverlap(nt):Ie[nt.overscaledZ],kt=T?0:c.paint.get("raster-fade-duration");pt.registerFadeDuration(kt);const Rt=o.findLoadedParent(nt,0),Yt=re(pt,Rt,o,p.transform,kt);let $t,ln;p.terrain&&p.terrain.prepareDrawTile();const Gn="nearest"===c.paint.get("raster-resampling")?O.NEAREST:O.LINEAR;I.activeTexture.set(O.TEXTURE0),pt.texture.bind(Gn,O.CLAMP_TO_EDGE),I.activeTexture.set(O.TEXTURE1),Rt?(Rt.texture.bind(Gn,O.CLAMP_TO_EDGE),$t=Math.pow(2,Rt.tileID.overscaledZ-pt.tileID.overscaledZ),ln=[pt.tileID.canonical.x*$t%1,pt.tileID.canonical.y*$t%1]):pt.texture.bind(Gn,O.CLAMP_TO_EDGE),pt.texture.useMipmap&&I.extTextureFilterAnisotropic&&p.transform.pitch>20&&O.texParameterf(O.TEXTURE_2D,I.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,I.extTextureFilterAnisotropicMax);const on=Ja(ht,ln||[0,0],$t||1,Yt,c,N instanceof me?N.perspectiveTransform:[0,0]);if(p.prepareDrawProgram(I,H,$e),N instanceof me)N.boundsBuffer&&N.boundsSegments&&H.draw(I,O.TRIANGLES,ue,s.StencilMode.disabled,$,s.CullFaceMode.disabled,on,c.id,N.boundsBuffer,p.quadTriangleIndexBuffer,N.boundsSegments);else{const{tileBoundsBuffer:An,tileBoundsIndexBuffer:hn,tileBoundsSegments:jn}=p.getTileBoundsBuffers(pt);H.draw(I,O.TRIANGLES,ue,Ot,$,s.CullFaceMode.disabled,on,c.id,An,hn,jn)}}p.resetStencilClippingMasks()},background:function(p,o,c,m){const b=c.paint.get("background-color"),T=c.paint.get("background-opacity");if(0===T)return;const I=p.context,O=I.gl,N=p.transform,H=N.tileSize,$=c.paint.get("background-pattern");if(p.isPatternMissing($))return;const ce=!$&&1===b.a&&1===T&&p.opaquePassEnabledForLayer()?"opaque":"translucent";if(p.renderPass!==ce)return;const Ie=s.StencilMode.disabled,je=p.depthModeForSublayer(0,"opaque"===ce?s.DepthMode.ReadWrite:s.DepthMode.ReadOnly),Ke=p.colorModeForRenderPass(),Ye=p.useProgram($?"backgroundPattern":"background");let nt,ue=m;ue||(nt=p.getBackgroundTiles(),ue=Object.values(nt).map($e=>$e.tileID)),$&&(I.activeTexture.set(O.TEXTURE0),p.imageManager.bind(p.context));for(const $e of ue){const pt=$e.toUnwrapped(),ht=m?$e.projMatrix:p.transform.calculateProjMatrix(pt);p.prepareDrawTile();const Ot=o?o.getTile($e):nt?nt[$e.key]:new s.Tile($e,H,N.zoom,p),kt=$?fd(ht,T,p,$,{tileID:$e,tileSize:H}):pl(ht,T,b);p.prepareDrawProgram(I,Ye,pt);const{tileBoundsBuffer:Rt,tileBoundsIndexBuffer:Yt,tileBoundsSegments:$t}=p.getTileBoundsBuffers(Ot);Ye.draw(I,O.TRIANGLES,je,Ie,Ke,s.CullFaceMode.disabled,kt,c.id,Rt,Yt,$t)}},sky:function(p,o,c){const m=p.transform,b="mercator"===m.projection.name||"globe"===m.projection.name?1:s.smoothstep(7,8,m.zoom),T=c.paint.get("sky-opacity")*b;if(0===T)return;const I=p.context,O=c.paint.get("sky-type"),N=new s.DepthMode(I.gl.LEQUAL,s.DepthMode.ReadOnly,[0,1]),H=p.frameCounter/1e3%1;"atmosphere"===O?"offscreen"===p.renderPass?c.needsSkyboxCapture(p)&&(function($,ce,Ie,je){const Ke=$.context,Ye=Ke.gl;let nt=ce.skyboxFbo;if(!nt){nt=ce.skyboxFbo=Ke.createFramebuffer(32,32,!1),ce.skyboxGeometry=new ma(Ke),ce.skyboxTexture=Ke.gl.createTexture(),Ye.bindTexture(Ye.TEXTURE_CUBE_MAP,ce.skyboxTexture),Ye.texParameteri(Ye.TEXTURE_CUBE_MAP,Ye.TEXTURE_WRAP_S,Ye.CLAMP_TO_EDGE),Ye.texParameteri(Ye.TEXTURE_CUBE_MAP,Ye.TEXTURE_WRAP_T,Ye.CLAMP_TO_EDGE),Ye.texParameteri(Ye.TEXTURE_CUBE_MAP,Ye.TEXTURE_MIN_FILTER,Ye.LINEAR),Ye.texParameteri(Ye.TEXTURE_CUBE_MAP,Ye.TEXTURE_MAG_FILTER,Ye.LINEAR);for(let ht=0;ht<6;++ht)Ye.texImage2D(Ye.TEXTURE_CUBE_MAP_POSITIVE_X+ht,0,Ye.RGBA,32,32,0,Ye.RGBA,Ye.UNSIGNED_BYTE,null)}Ke.bindFramebuffer.set(nt.framebuffer),Ke.viewport.set([0,0,32,32]);const ue=ce.getCenter($,!0),$e=$.useProgram("skyboxCapture"),pt=new Float64Array(16);s.identity(pt),s.rotateY(pt,pt,.5*-Math.PI),Z(Ke,ce,$e,pt,ue,0),s.identity(pt),s.rotateY(pt,pt,.5*Math.PI),Z(Ke,ce,$e,pt,ue,1),s.identity(pt),s.rotateX(pt,pt,.5*-Math.PI),Z(Ke,ce,$e,pt,ue,2),s.identity(pt),s.rotateX(pt,pt,.5*Math.PI),Z(Ke,ce,$e,pt,ue,3),s.identity(pt),Z(Ke,ce,$e,pt,ue,4),s.identity(pt),s.rotateY(pt,pt,Math.PI),Z(Ke,ce,$e,pt,ue,5),Ke.viewport.set([0,0,$.width,$.height])}(p,c),c.markSkyboxValid(p)):"sky"===p.renderPass&&function($,ce,Ie,je,Ke){const Ye=$.context,nt=Ye.gl,ue=$.transform,$e=$.useProgram("skybox");Ye.activeTexture.set(nt.TEXTURE0),nt.bindTexture(nt.TEXTURE_CUBE_MAP,ce.skyboxTexture);const pt={u_matrix:ue.skyboxMatrix,u_sun_direction:ce.getCenter($,!1),u_cubemap:0,u_opacity:je,u_temporal_offset:Ke};$.prepareDrawProgram(Ye,$e),$e.draw(Ye,nt.TRIANGLES,Ie,s.StencilMode.disabled,$.colorModeForRenderPass(),s.CullFaceMode.backCW,pt,"skybox",ce.skyboxGeometry.vertexBuffer,ce.skyboxGeometry.indexBuffer,ce.skyboxGeometry.segment)}(p,c,N,T,H):"gradient"===O&&"sky"===p.renderPass&&function($,ce,Ie,je,Ke){const Ye=$.context,nt=Ye.gl,ue=$.transform,$e=$.useProgram("skyboxGradient");ce.skyboxGeometry||(ce.skyboxGeometry=new ma(Ye)),Ye.activeTexture.set(nt.TEXTURE0);let pt=ce.colorRampTexture;pt||(pt=ce.colorRampTexture=new s.Texture(Ye,ce.colorRamp,nt.RGBA)),pt.bind(nt.LINEAR,nt.CLAMP_TO_EDGE);const ht=(Ot=ue.skyboxMatrix,kt=ce.getCenter($,!1),Rt=ce.paint.get("sky-gradient-radius"),Yt=je,$t=Ke,{u_matrix:Ot,u_color_ramp:0,u_center_direction:kt,u_radius:s.degToRad(Rt),u_opacity:Yt,u_temporal_offset:$t});var Ot,kt,Rt,Yt,$t;$.prepareDrawProgram(Ye,$e),$e.draw(Ye,nt.TRIANGLES,Ie,s.StencilMode.disabled,$.colorModeForRenderPass(),s.CullFaceMode.backCW,ht,"skyboxGradient",ce.skyboxGeometry.vertexBuffer,ce.skyboxGeometry.indexBuffer,ce.skyboxGeometry.segment)}(p,c,N,T,H)},debug:function(p,o,c){for(let m=0;m<c.length;m++)zc(p,o,c[m])},custom:function(p,o,c,m){const b=p.context,T=c.implementation;if(!p.transform.projection.unsupportedLayers||!p.transform.projection.unsupportedLayers.includes("custom")||p.terrain&&(p.terrain.renderingToTexture||"offscreen"===p.renderPass)&&c.isLayerDraped()){if("offscreen"===p.renderPass){const I=T.prerender;if(I){if(p.setCustomLayerDefaults(),b.setColorMode(p.colorModeForRenderPass()),"globe"===p.transform.projection.name){const O=p.transform.pointMerc;I.call(T,b.gl,p.transform.customLayerMatrix(),p.transform.getProjection(),p.transform.globeToMercatorMatrix(),s.globeToMercatorTransition(p.transform.zoom),[O.x,O.y],p.transform.pixelsPerMeterRatio)}else I.call(T,b.gl,p.transform.customLayerMatrix());b.setDirty(),p.setBaseState()}}else if("translucent"===p.renderPass){if(p.terrain&&p.terrain.renderingToTexture){const O=T.renderToTile;if(O){const N=m[0].canonical,H=new s.MercatorCoordinate(N.x+m[0].wrap*(1<<N.z),N.y,N.z);b.setDepthMode(s.DepthMode.disabled),b.setStencilMode(s.StencilMode.disabled),b.setColorMode(p.colorModeForRenderPass()),p.setCustomLayerDefaults(),O.call(T,b.gl,H),b.setDirty(),p.setBaseState()}return}p.setCustomLayerDefaults(),b.setColorMode(p.colorModeForRenderPass()),b.setStencilMode(s.StencilMode.disabled);const I="3d"===T.renderingMode?new s.DepthMode(p.context.gl.LEQUAL,s.DepthMode.ReadWrite,p.depthRangeFor3D):p.depthModeForSublayer(0,s.DepthMode.ReadOnly);if(b.setDepthMode(I),"globe"===p.transform.projection.name){const O=p.transform.pointMerc;T.render(b.gl,p.transform.customLayerMatrix(),p.transform.getProjection(),p.transform.globeToMercatorMatrix(),s.globeToMercatorTransition(p.transform.zoom),[O.x,O.y],p.transform.pixelsPerMeterRatio)}else T.render(b.gl,p.transform.customLayerMatrix());b.setDirty(),p.setBaseState(),b.bindFramebuffer.set(null)}}else s.warnOnce("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")}};class Tt{constructor(o,c,m=!1){this.context=new In(o,m),this.transform=c,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=s.SourceCache.maxUnderzooming+s.SourceCache.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={}}updateTerrain(o,c){const m=!!o&&!!o.terrain&&this.transform.projection.supportsTerrain;if(!(m||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new Ln(this,o));const b=this._terrain;this.transform.elevation=m?b:null,b.update(o,this.transform,c)}_updateFog(o){const c=o.fog;if(!c||"globe"===this.transform.projection.name||c.getOpacity(this.transform.pitch)<1||c.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[m,b]=c.getFovAdjustedRange(this.transform._fov);if(m>b)return void(this.transform.fogCullDistSq=null);const T=m+.78*(b-m);this.transform.fogCullDistSq=T*T}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled?this._terrain:null}resize(o,c){if(this.width=o*s.exported.devicePixelRatio,this.height=c*s.exported.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const m of this.style.order)this.style._layers[m].resize()}setup(){const o=this.context,c=new s.StructArrayLayout2i4;c.emplaceBack(0,0),c.emplaceBack(s.EXTENT,0),c.emplaceBack(0,s.EXTENT),c.emplaceBack(s.EXTENT,s.EXTENT),this.tileExtentBuffer=o.createVertexBuffer(c,s.posAttributes.members),this.tileExtentSegments=s.SegmentVector.simpleSegment(0,0,4,2);const m=new s.StructArrayLayout2i4;m.emplaceBack(0,0),m.emplaceBack(s.EXTENT,0),m.emplaceBack(0,s.EXTENT),m.emplaceBack(s.EXTENT,s.EXTENT),this.debugBuffer=o.createVertexBuffer(m,s.posAttributes.members),this.debugSegments=s.SegmentVector.simpleSegment(0,0,4,5);const b=new s.StructArrayLayout2i4;b.emplaceBack(-1,-1),b.emplaceBack(1,-1),b.emplaceBack(-1,1),b.emplaceBack(1,1),this.viewportBuffer=o.createVertexBuffer(b,s.posAttributes.members),this.viewportSegments=s.SegmentVector.simpleSegment(0,0,4,2);const T=new s.StructArrayLayout4i8;T.emplaceBack(0,0,0,0),T.emplaceBack(s.EXTENT,0,s.EXTENT,0),T.emplaceBack(0,s.EXTENT,0,s.EXTENT),T.emplaceBack(s.EXTENT,s.EXTENT,s.EXTENT,s.EXTENT),this.mercatorBoundsBuffer=o.createVertexBuffer(T,s.boundsAttributes.members),this.mercatorBoundsSegments=s.SegmentVector.simpleSegment(0,0,4,2);const I=new s.StructArrayLayout3ui6;I.emplaceBack(0,1,2),I.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=o.createIndexBuffer(I);const O=new s.StructArrayLayout1ui2;for(const H of[0,1,3,2,0])O.emplaceBack(H);this.debugIndexBuffer=o.createIndexBuffer(O),this.emptyTexture=new s.Texture(o,new s.RGBAImage({width:1,height:1},Uint8Array.of(0,0,0,0)),o.gl.RGBA),this.identityMat=s.create();const N=this.context.gl;this.stencilClearMode=new s.StencilMode({func:N.ALWAYS,mask:0},0,255,N.ZERO,N.ZERO,N.ZERO),this.loadTimeStamps.push(s.window.performance.now()),this.atmosphereBuffer=new W(this.context)}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(o){return o._makeTileBoundsBuffers(this.context,this.transform.projection),o._tileBoundsBuffer?{tileBoundsBuffer:o._tileBoundsBuffer,tileBoundsIndexBuffer:o._tileBoundsIndexBuffer,tileBoundsSegments:o._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const o=this.context,c=o.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.useProgram("clippingMask").draw(o,c.TRIANGLES,s.DepthMode.disabled,this.stencilClearMode,s.ColorMode.disabled,s.CullFaceMode.disabled,S(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(o,c,m){if(!c||this.currentStencilSource===c.id||!o.isTileClipped()||!m||0===m.length)return;if(this._tileClippingMaskIDs&&!this.terrain){let O=!1;for(const N of m)if(void 0===this._tileClippingMaskIDs[N.key]){O=!0;break}if(!O)return}this.currentStencilSource=c.id;const b=this.context,T=b.gl;this.nextStencilID+m.length>256&&this.clearStencil(),b.setColorMode(s.ColorMode.disabled),b.setDepthMode(s.DepthMode.disabled);const I=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const O of m){const N=c.getTile(O),H=this._tileClippingMaskIDs[O.key]=this.nextStencilID++,{tileBoundsBuffer:$,tileBoundsIndexBuffer:ce,tileBoundsSegments:Ie}=this.getTileBoundsBuffers(N);I.draw(b,T.TRIANGLES,s.DepthMode.disabled,new s.StencilMode({func:T.ALWAYS,mask:0},H,255,T.KEEP,T.KEEP,T.REPLACE),s.ColorMode.disabled,s.CullFaceMode.disabled,S(O.projMatrix),"$clipping",$,ce,Ie)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const o=this.nextStencilID++,c=this.context.gl;return new s.StencilMode({func:c.NOTEQUAL,mask:255},o,255,c.KEEP,c.KEEP,c.REPLACE)}stencilModeForClipping(o){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(o);const c=this.context.gl;return new s.StencilMode({func:c.EQUAL,mask:255},this._tileClippingMaskIDs[o.key],0,c.KEEP,c.KEEP,c.REPLACE)}stencilConfigForOverlap(o){const c=this.context.gl,m=o.sort((I,O)=>O.overscaledZ-I.overscaledZ),b=m[m.length-1].overscaledZ,T=m[0].overscaledZ-b+1;if(T>1){this.currentStencilSource=void 0,this.nextStencilID+T>256&&this.clearStencil();const I={};for(let O=0;O<T;O++)I[O+b]=new s.StencilMode({func:c.GEQUAL,mask:255},O+this.nextStencilID,255,c.KEEP,c.KEEP,c.REPLACE);return this.nextStencilID+=T,[I,m]}return[{[b]:s.StencilMode.disabled},m]}colorModeForRenderPass(){const o=this.context.gl;return this._showOverdrawInspector?new s.ColorMode([o.CONSTANT_COLOR,o.ONE],new s.Color(.125,.125,.125,0),[!0,!0,!0,!0]):"opaque"===this.renderPass?s.ColorMode.unblended:s.ColorMode.alphaBlended}depthModeForSublayer(o,c,m){if(!this.opaquePassEnabledForLayer())return s.DepthMode.disabled;const b=1-((1+this.currentLayer)*this.numSublayers+o)*this.depthEpsilon;return new s.DepthMode(m||this.context.gl.LEQUAL,c,[b,b])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(o,c){this.style=o,this.options=c,this.imageManager=o.imageManager,this.glyphManager=o.glyphManager,this.symbolFadeChange=o.placement.symbolFadeChange(s.exported.now()),this.imageManager.beginFrame();const m=this.style.order,b=this.style._sourceCaches;for(const H in b){const $=b[H];$.used&&$.prepare(this.context)}const T={},I={},O={};for(const H in b){const $=b[H];T[H]=$.getVisibleCoordinates(),I[H]=T[H].slice().reverse(),O[H]=$.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let H=0;H<m.length;H++)if(this.style._layers[m[H]].is3D()){this.opaquePassCutoff=H;break}if(this.terrain&&(this.terrain.updateTileBinding(O),this.opaquePassCutoff=0),"globe"!==this.transform.projection.name||this.globeSharedBuffers||(this.globeSharedBuffers=new s.GlobeSharedBuffers(this.context)),!s.isMapAuthenticated(this.context.gl))return;this.renderPass="offscreen";for(const H of m){const $=this.style._layers[H],ce=o._getLayerSourceCache($);if(!$.hasOffscreenPass()||$.isHidden(this.transform.zoom))continue;const Ie=ce?I[ce.id]:void 0;("custom"===$.type||$.isSky()||Ie&&Ie.length)&&this.renderLayer(this,ce,$,Ie)}this.depthRangeFor3D=[0,1-(o.order.length+2)*this.numSublayers*this.depthEpsilon];const N=this.terrain;if(N&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&N.drawDepth(),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]),this.context.clear({color:c.showOverdrawInspector?s.Color.black:s.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=c.showOverdrawInspector,this.renderPass="opaque",!this.terrain)for(this.currentLayer=m.length-1;this.currentLayer>=0;this.currentLayer--){const H=this.style._layers[m[this.currentLayer]],$=o._getLayerSourceCache(H);if(H.isSky())continue;const ce=$?I[$.id]:void 0;this._renderTileClippingMasks(H,$,ce),this.renderLayer(this,$,H,ce)}if(this.style.fog&&this.transform.projection.supportsFog&&function(H,$){const ce=H.context,Ie=ce.gl,je=H.transform,Ke=new s.DepthMode(Ie.LEQUAL,s.DepthMode.ReadOnly,[0,1]),Ye=H.useProgram("globeAtmosphere",null,"globe"===je.projection.name?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"]),nt=s.globeToMercatorTransition(je.zoom),ue=$.properties.get("color").toArray01(),$e=$.properties.get("high-color").toArray01(),pt=$.properties.get("space-color").toArray01PremultipliedAlpha(),ht=s.identity$1([]);s.rotateY$1(ht,ht,-s.degToRad(je._center.lng)),s.rotateX$1(ht,ht,s.degToRad(je._center.lat)),s.rotateZ$1(ht,ht,je.angle),s.rotateX$1(ht,ht,-je._pitch);const Ot=s.fromQuat(new Float32Array(16),ht),kt=s.mapValue($.properties.get("star-intensity"),0,1,0,.25),Yt=s.mapValue($.properties.get("horizon-blend"),0,1,5e-4,.25),$t=s.globeUseCustomAntiAliasing(H,ce,je)&&5e-4===Yt?je.worldSize/(2*Math.PI*1.025)-1:je.globeRadius,ln=H.frameCounter/1e3%1,Gn=s.length(je.globeCenterInViewSpace),on=Math.sqrt(Math.pow(Gn,2)-Math.pow($t,2)),An=Math.acos(on/Gn),hn={u_frustum_tl:je.frustumCorners.TL,u_frustum_tr:je.frustumCorners.TR,u_frustum_br:je.frustumCorners.BR,u_frustum_bl:je.frustumCorners.BL,u_horizon:je.frustumCorners.horizon,u_transition:nt,u_fadeout_range:Yt,u_color:ue,u_high_color:$e,u_space_color:pt,u_star_intensity:kt,u_star_size:5*s.exported.devicePixelRatio,u_star_density:0,u_temporal_offset:ln,u_horizon_angle:An,u_rotation_matrix:Ot};H.prepareDrawProgram(ce,Ye);const jn=H.atmosphereBuffer;jn&&Ye.draw(ce,Ie.TRIANGLES,Ke,s.StencilMode.disabled,s.ColorMode.alphaBlended,s.CullFaceMode.backCW,hn,"skybox",jn.vertexBuffer,jn.indexBuffer,jn.segments)}(this,this.style.fog),this.renderPass="sky",(s.globeToMercatorTransition(this.transform.zoom)>0||"globe"!==this.transform.projection.name)&&this.transform.isHorizonVisible())for(this.currentLayer=0;this.currentLayer<m.length;this.currentLayer++){const H=this.style._layers[m[this.currentLayer]],$=o._getLayerSourceCache(H);H.isSky()&&this.renderLayer(this,$,H,$?I[$.id]:void 0)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<m.length;){const H=this.style._layers[m[this.currentLayer]],$=o._getLayerSourceCache(H);if(H.isSky()){++this.currentLayer;continue}if(this.terrain&&this.style.isLayerDraped(H)){if(H.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer);continue}const ce=$?("symbol"===H.type?O:I)[$.id]:void 0;this._renderTileClippingMasks(H,$,$?T[$.id]:void 0),this.renderLayer(this,$,H,ce),++this.currentLayer}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let H=null;s.values(this.style._layers).forEach($=>{const ce=o._getLayerSourceCache($);ce&&!$.isHidden(this.transform.zoom)&&(!H||H.getSource().maxzoom<ce.getSource().maxzoom)&&(H=ce)}),H&&this.options.showTileBoundaries&&Ce.debug(this,H,H.getVisibleCoordinates())}this.options.showPadding&&function(H){const $=H.transform.padding;Uc(H,H.transform.height-($.top||0),3,Ba),Uc(H,$.bottom||0,3,ac),Ul(H,$.left||0,3,mu),Ul(H,H.transform.width-($.right||0),3,zl);const ce=H.transform.centerPoint;var Ie,je,Ke,Ye;Na(Ie=H,(je=ce.x)-1,(Ke=H.transform.height-ce.y)-10,2,20,Ye=lc),Na(Ie,je-10,Ke-1,20,2,Ye)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(s.window.performance.now()),this.saveCanvasCopy())}renderLayer(o,c,m,b){m.isHidden(this.transform.zoom)||("background"===m.type||"sky"===m.type||"custom"===m.type||b&&b.length)&&(this.id=m.id,this.gpuTimingStart(m),(!o.transform.projection.unsupportedLayers||!o.transform.projection.unsupportedLayers.includes(m.type)||o.terrain&&"custom"===m.type)&&Ce[m.type](o,c,m,b,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(o){if(!this.options.gpuTiming)return;const c=this.context.extTimerQuery;let m=this.gpuTimers[o.id];m||(m=this.gpuTimers[o.id]={calls:0,cpuTime:0,query:c.createQueryEXT()}),m.calls++,c.beginQueryEXT(c.TIME_ELAPSED_EXT,m.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const o=this.context.extTimerQuery,c=o.createQueryEXT();this.deferredRenderGpuTimeQueries.push(c),o.beginQueryEXT(o.TIME_ELAPSED_EXT,c)}}gpuTimingDeferredRenderEnd(){if(!this.options.gpuTimingDeferredRender)return;const o=this.context.extTimerQuery;o.endQueryEXT(o.TIME_ELAPSED_EXT)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const o=this.context.extTimerQuery;o.endQueryEXT(o.TIME_ELAPSED_EXT)}collectGpuTimers(){const o=this.gpuTimers;return this.gpuTimers={},o}collectDeferredRenderGpuQueries(){const o=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],o}queryGpuTimers(o){const c={};for(const m in o){const b=o[m],T=this.context.extTimerQuery,I=T.getQueryObjectEXT(b.query,T.QUERY_RESULT_EXT)/1e6;T.deleteQueryEXT(b.query),c[m]=I}return c}queryGpuTimeDeferredRender(o){if(!this.options.gpuTimingDeferredRender)return 0;const c=this.context.extTimerQuery;let m=0;for(const b of o)m+=c.getQueryObjectEXT(b,c.QUERY_RESULT_EXT)/1e6,c.deleteQueryEXT(b);return m}translatePosMatrix(o,c,m,b,T){if(!m[0]&&!m[1])return o;const I=T?"map"===b?this.transform.angle:0:"viewport"===b?-this.transform.angle:0;if(I){const H=Math.sin(I),$=Math.cos(I);m=[m[0]*$-m[1]*H,m[0]*H+m[1]*$]}const O=[T?m[0]:mt(c,m[0],this.transform.zoom),T?m[1]:mt(c,m[1],this.transform.zoom),0],N=new Float32Array(16);return s.translate(N,o,O),N}saveTileTexture(o){const c=this._tileTextures[o.size[0]];c?c.push(o):this._tileTextures[o.size[0]]=[o]}getTileTexture(o){const c=this._tileTextures[o];return c&&c.length>0?c.pop():null}isPatternMissing(o){return null===o||void 0!==o&&!this.imageManager.getPattern(o.toString())}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture}currentGlobalDefines(){const o=this.terrain&&this.terrain.renderingToTexture,c=this.terrain&&0===this.terrain.exaggeration(),m=this.style&&this.style.fog,b=[];return this.terrainRenderModeElevated()&&b.push("TERRAIN"),"globe"===this.transform.projection.name&&b.push("GLOBE"),c&&b.push("ZERO_EXAGGERATION"),m&&!o&&0!==m.getOpacity(this.transform.pitch)&&b.push("FOG"),o&&b.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&b.push("OVERDRAW_INSPECTOR"),b}useProgram(o,c,m){this.cache=this.cache||{};const b=m||[],T=this.currentGlobalDefines().concat(b),I=Kn.cacheKey(Ss[o],o,T,c);return this.cache[I]||(this.cache[I]=new Kn(this.context,o,Ss[o],c,pa[o],T)),this.cache[I]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const o=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(o.FUNC_ADD)}initDebugOverlayCanvas(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=s.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new s.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this.atmosphereBuffer&&this.atmosphereBuffer.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}prepareDrawProgram(o,c,m){if(this.terrain&&this.terrain.renderingToTexture)return;const b=this.style.fog;if(b){const T=b.getOpacity(this.transform.pitch),I=((O,N,H,$,ce,Ie,je,Ke,Ye,nt,ue)=>{const $e=O.transform,pt=N.properties.get("color").toArray01();pt[3]=$;const ht=O.frameCounter/1e3%1;return{u_fog_matrix:H?$e.calculateFogTileMatrix(H):O.identityMat,u_fog_range:N.getFovAdjustedRange($e._fov),u_fog_color:pt,u_fog_horizon_blend:N.properties.get("horizon-blend"),u_fog_temporal_offset:ht,u_frustum_tl:ce,u_frustum_tr:Ie,u_frustum_br:je,u_frustum_bl:Ke,u_globe_pos:Ye,u_globe_radius:nt,u_viewport:ue,u_globe_transition:s.globeToMercatorTransition($e.zoom),u_is_globe:+("globe"===$e.projection.name)}})(this,b,m,T,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*s.exported.devicePixelRatio,this.transform.height*s.exported.devicePixelRatio]);c.setFogUniformValues(o,I)}}setTileLoadedFlag(o){this.tileLoaded=o}saveCanvasCopy(){const o=this.canvasCopy();o&&(this.frameCopies.push(o),this.tileLoaded=!1)}canvasCopy(){const o=this.context.gl,c=o.createTexture();return o.bindTexture(o.TEXTURE_2D,c),o.copyTexImage2D(o.TEXTURE_2D,0,o.RGBA,0,0,o.drawingBufferWidth,o.drawingBufferHeight,0),c}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const o=this.style&&this.style.fog;return!!o&&0!==o.getOpacity(this.transform.pitch)}getBackgroundTiles(){const o=this._backgroundTiles,c=this._backgroundTiles={},m=this.transform.coveringTiles({tileSize:512});for(const b of m)c[b.key]=o[b.key]||new s.Tile(b,512,this.transform.tileZoom,this);return c}clearBackgroundTiles(){this._backgroundTiles={}}}class yn{constructor(o=0,c=0,m=0,b=0){if(isNaN(o)||o<0||isNaN(c)||c<0||isNaN(m)||m<0||isNaN(b)||b<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=o,this.bottom=c,this.left=m,this.right=b}interpolate(o,c,m){return null!=c.top&&null!=o.top&&(this.top=s.number(o.top,c.top,m)),null!=c.bottom&&null!=o.bottom&&(this.bottom=s.number(o.bottom,c.bottom,m)),null!=c.left&&null!=o.left&&(this.left=s.number(o.left,c.left,m)),null!=c.right&&null!=o.right&&(this.right=s.number(o.right,c.right,m)),this}getCenter(o,c){const m=s.clamp((this.left+o-this.right)/2,0,o),b=s.clamp((this.top+c-this.bottom)/2,0,c);return new s.Point(m,b)}equals(o){return this.top===o.top&&this.bottom===o.bottom&&this.left===o.left&&this.right===o.right}clone(){return new yn(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function Dn(p,o){const c=s.getColumn(p,3);s.fromQuat(p,o),s.setColumn(p,3,c)}function Xn(p,o){const c=s.identity$1([]);return s.rotateZ$1(c,c,-o),s.rotateX$1(c,c,-p),c}function Eo(p,o){const c=[p[0],p[1],0],m=[o[0],o[1],0];if(s.length(c)>=1e-15){const I=s.normalize([],c);s.scale$2(m,I,s.dot(m,I)),o[0]=m[0],o[1]=m[1]}const b=s.cross([],o,p);if(s.len(b)<1e-15)return null;const T=Math.atan2(-b[1],b[0]);return Xn(Math.atan2(Math.sqrt(p[0]*p[0]+p[1]*p[1]),-p[2]),T)}class yo{constructor(o,c){this.position=o,this.orientation=c}get position(){return this._position}set position(o){if(o){const c=o instanceof s.MercatorCoordinate?o:new s.MercatorCoordinate(o[0],o[1],o[2]);this._renderWorldCopies&&(c.x=s.wrap(c.x,0,1)),this._position=c}else this._position=null}lookAtPoint(o,c){if(this.orientation=null,!this.position)return;const m=this.position,b=this._elevation?this._elevation.getAtPointOrZero(s.MercatorCoordinate.fromLngLat(o)):0,T=s.MercatorCoordinate.fromLngLat(o,b),I=[T.x-m.x,T.y-m.y,T.z-m.z];c||(c=[0,0,1]),c[2]=Math.abs(c[2]),this.orientation=Eo(I,c)}setPitchBearing(o,c){this.orientation=Xn(s.degToRad(o),s.degToRad(-c))}}class Xi{constructor(o,c){this._transform=s.identity([]),this.orientation=c,this.position=o}get mercatorPosition(){const o=this.position;return new s.MercatorCoordinate(o[0],o[1],o[2])}get position(){const o=s.getColumn(this._transform,3);return[o[0],o[1],o[2]]}set position(o){var c;o&&s.setColumn(this._transform,3,[(c=o)[0],c[1],c[2],1])}get orientation(){return this._orientation}set orientation(o){this._orientation=o||s.identity$1([]),o&&Dn(this._transform,this._orientation)}getPitchBearing(){const o=this.forward(),c=this.right();return{bearing:Math.atan2(-c[1],c[0]),pitch:Math.atan2(Math.sqrt(o[0]*o[0]+o[1]*o[1]),-o[2])}}setPitchBearing(o,c){this._orientation=Xn(o,c),Dn(this._transform,this._orientation)}forward(){const o=s.getColumn(this._transform,2);return[-o[0],-o[1],-o[2]]}up(){const o=s.getColumn(this._transform,1);return[-o[0],-o[1],-o[2]]}right(){const o=s.getColumn(this._transform,0);return[o[0],o[1],o[2]]}getCameraToWorld(o,c){const m=new Float64Array(16);return s.invert(m,this.getWorldToCamera(o,c)),m}getWorldToCameraPosition(o,c,m){const b=this.position;s.scale$2(b,b,-o);const T=new Float64Array(16);return s.fromScaling(T,[m,m,m]),s.translate(T,T,b),T[10]*=c,T}getWorldToCamera(o,c){const m=new Float64Array(16),b=new Float64Array(4),T=this.position;return s.conjugate(b,this._orientation),s.scale$2(T,T,-o),s.fromQuat(m,b),s.translate(m,m,T),m[1]*=-1,m[5]*=-1,m[9]*=-1,m[13]*=-1,m[8]*=c,m[9]*=c,m[10]*=c,m[11]*=c,m}getCameraToClipPerspective(o,c,m,b){const T=new Float64Array(16);return s.perspective(T,o,c,m,b),T}getDistanceToElevation(o,c=!1){const m=0===o?0:s.mercatorZfromAltitude(o,c?s.latFromMercatorY(this.position[1]):this.position[1]),b=this.forward();return(m-this.position[2])/b[2]}clone(){return new Xi([...this.position],[...this.orientation])}}function co(p,o){const c=Ro(p.projection,p.zoom,p.width,p.height),m=function(T,I,O,N,H){const $=new s.LngLat(O.lng-180*Do,O.lat),ce=new s.LngLat(O.lng+180*Do,O.lat),Ie=T.project($.lng,$.lat),je=T.project(ce.lng,ce.lat),Ke=-Math.atan2(je.y-Ie.y,je.x-Ie.x),Ye=s.MercatorCoordinate.fromLngLat(O);Ye.y=s.clamp(Ye.y,-1+Do,1-Do);const nt=Ye.toLngLat(),ue=T.project(nt.lng,nt.lat),$e=s.MercatorCoordinate.fromLngLat(nt);$e.x+=Do;const pt=$e.toLngLat(),ht=T.project(pt.lng,pt.lat),Ot=Ds(ht.x-ue.x,ht.y-ue.y,Ke),kt=s.MercatorCoordinate.fromLngLat(nt);kt.y+=Do;const Rt=kt.toLngLat(),Yt=T.project(Rt.lng,Rt.lat),$t=Ds(Yt.x-ue.x,Yt.y-ue.y,Ke),ln=Math.abs(Ot.x)/Math.abs($t.y),Gn=s.identity([]);s.rotateZ(Gn,Gn,-Ke*(1-(H?0:N)));const on=s.identity([]);return s.scale(on,on,[1,1-(1-ln)*N,1]),on[4]=-$t.x/$t.y*N,s.rotateZ(on,on,Ke),s.multiply(on,Gn,on),on}(p.projection,0,p.center,c,o),b=fr(p);return s.scale(m,m,[b,b,1]),m}function fr(p){const o=p.projection,c=Ro(p.projection,p.zoom,p.width,p.height),m=Ls(o,p.center),b=Ls(o,s.LngLat.convert(o.center));return Math.pow(2,m*c+(1-c)*b)}function Ro(p,o,c,m,b=1/0){const T=p.range;if(!T)return 0;const I=Math.min(b,Math.max(c,m)),O=Math.log(I/1024)/Math.LN2;return s.smoothstep(T[0]+O,T[1]+O,o)}const Do=1/4e4;function Ls(p,o){const c=s.clamp(o.lat,-s.MAX_MERCATOR_LATITUDE,s.MAX_MERCATOR_LATITUDE),m=new s.LngLat(o.lng-180*Do,c),b=new s.LngLat(o.lng+180*Do,c),T=p.project(m.lng,c),I=p.project(b.lng,c),O=s.MercatorCoordinate.fromLngLat(m),N=s.MercatorCoordinate.fromLngLat(b),H=I.x-T.x,$=I.y-T.y,ce=N.x-O.x,Ie=N.y-O.y,je=Math.sqrt((ce*ce+Ie*Ie)/(H*H+$*$));return Math.log(je)/Math.LN2}function Ds(p,o,c){const m=Math.cos(c),b=Math.sin(c);return{x:p*m-o*b,y:p*b+o*m}}class fs{constructor(o,c,m,b,T,I,O){this.tileSize=512,this._renderWorldCopies=void 0===T||T,this._minZoom=o||0,this._maxZoom=c||22,this._minPitch=m??0,this._maxPitch=b??60,this.setProjection(I),this.setMaxBounds(O),this.width=0,this.height=0,this._center=new s.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new yn,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._distanceTileDataCache={},this._camera=new Xi,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._horizonShift=.1}clone(){const o=new fs(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return o._elevation=this._elevation,o._centerAltitude=this._centerAltitude,o._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,o.tileSize=this.tileSize,o.mercatorFromTransition=this.mercatorFromTransition,o.width=this.width,o.height=this.height,o.cameraElevationReference=this.cameraElevationReference,o._center=this._center,o._setZoom(this.zoom),o._seaLevelZoom=this._seaLevelZoom,o.angle=this.angle,o._fov=this._fov,o._pitch=this._pitch,o._nearZ=this._nearZ,o._farZ=this._farZ,o._averageElevation=this._averageElevation,o._unmodified=this._unmodified,o._edgeInsets=this._edgeInsets.clone(),o._camera=this._camera.clone(),o._calcMatrices(),o.freezeTileCoverage=this.freezeTileCoverage,o.frustumCorners=this.frustumCorners,o}get elevation(){return this._elevation}set elevation(o){this._elevation!==o&&(this._elevation=o,this._updateCameraOnTerrain(),this._calcMatrices())}updateElevation(o,c=!1){const m=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(null==this._seaLevelZoom||m)&&this._updateCameraOnTerrain(),(o||m)&&this._constrainCamera(c),this._calcMatrices()}getProjection(){return s.pick(this.projection,["name","center","parallels"])}setProjection(o){this.projectionOptions=o||{name:"mercator"};const c=this.projection?this.getProjection():void 0;this.projection=s.getProjection(this.projectionOptions);const m=!Q(c,this.getProjection());return m&&this._calcMatrices(),this.mercatorFromTransition=!1,m}setMercatorFromTransition(){const o=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=s.getProjection({name:"mercator"});const c=o!==this.projection.name;return c&&this._calcMatrices(),c}get minZoom(){return this._minZoom}set minZoom(o){this._minZoom!==o&&(this._minZoom=o,this.zoom=Math.max(this.zoom,o))}get maxZoom(){return this._maxZoom}set maxZoom(o){this._maxZoom!==o&&(this._maxZoom=o,this.zoom=Math.min(this.zoom,o))}get minPitch(){return this._minPitch}set minPitch(o){this._minPitch!==o&&(this._minPitch=o,this.pitch=Math.max(this.pitch,o))}get maxPitch(){return this._maxPitch}set maxPitch(o){this._maxPitch!==o&&(this._maxPitch=o,this.pitch=Math.min(this.pitch,o))}get renderWorldCopies(){return this._renderWorldCopies&&!0===this.projection.supportsWorldCopies}set renderWorldCopies(o){void 0===o?o=!0:null===o&&(o=!1),this._renderWorldCopies=o}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const o=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(o))}get cameraWorldSize(){const o=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(o))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return s.mercatorZfromAltitude(this.center.lat,this.cameraWorldSizeForFog)}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new s.Point(this.width,this.height)}get bearing(){return s.wrap(this.rotation,-180,180)}set bearing(o){this.rotation=o}get rotation(){return-this.angle/Math.PI*180}set rotation(o){const c=-o*Math.PI/180;var m,b,T,I,O,N,H,$,ce,Ie;this.angle!==c&&(this._unmodified=!1,this.angle=c,this._calcMatrices(),this.rotationMatrix=(m=new s.ARRAY_TYPE(4),s.ARRAY_TYPE!=Float32Array&&(m[1]=0,m[2]=0),m[0]=1,m[3]=1,m),b=this.rotationMatrix,I=this.angle,O=(T=this.rotationMatrix)[0],N=T[1],H=T[2],$=T[3],ce=Math.sin(I),Ie=Math.cos(I),b[0]=O*Ie+H*ce,b[1]=N*Ie+$*ce,b[2]=O*-ce+H*Ie,b[3]=N*-ce+$*Ie)}get pitch(){return this._pitch/Math.PI*180}set pitch(o){const c=s.clamp(o,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==c&&(this._unmodified=!1,this._pitch=c,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}get fovX(){return this._fov}get fovY(){const o=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/o)}set fov(o){o=Math.max(.01,Math.min(60,o)),this._fov!==o&&(this._unmodified=!1,this._fov=s.degToRad(o),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(o){this._averageElevation=o,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(o){const c=Math.min(Math.max(o,this.minZoom),this.maxZoom);this._zoom!==c&&(this._unmodified=!1,this._setZoom(c),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(o){this._zoom=o,this.scale=this.zoomScale(o),this.tileZoom=Math.floor(o),this.zoomFraction=o-this.tileZoom}_updateCameraOnTerrain(){if(!this._elevation||!this._elevation.isDataAvailableAtPoint(this.locationCoordinate(this.center)))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const o=this._elevation;this._centerAltitude=o.getAtPointOrZero(this.locationCoordinate(this.center)),this._centerAltitudeValidForExaggeration=o.exaggeration(),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){void 0!==this._centerAltitudeValidForExaggeration&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const o=this._elevation,c=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],m=this.horizonLineFromTop();let b=0,T=0;for(let I=0;I<c.length;I++){const O=new s.Point(c[I][0]*this.width,m+c[I][1]*(this.height-m)),N=o.pointCoordinate(O);if(!N)continue;const H=1/Math.hypot(N[0]-this._camera.position[0],N[1]-this._camera.position[1]);b+=N[3]*H,T+=H}return 0===T?NaN:b/T}get center(){return this._center}set center(o){o.lat===this._center.lat&&o.lng===this._center.lng||(this._unmodified=!1,this._center=o,this._terrainEnabled()&&("ground"===this.cameraElevationReference?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(null==this._seaLevelZoom||!this._elevation)return;const o=this._seaLevelZoom,c=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),m=this.pixelsPerMeter/this.worldSize*c,b=this._mercatorZfromZoom(o),T=this._mercatorZfromZoom(this._maxZoom),I=Math.max(b-m,T);this._setZoom(this._zoomFromMercatorZ(I))}get padding(){return this._edgeInsets.toJSON()}set padding(o){this._edgeInsets.equals(o)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,o,1),this._calcMatrices())}computeZoomRelativeTo(o){const c=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,o.toAltitude()));let m;m=o.z<this._camera.position[2]?[c.x,c.y,c.z]:[o.x,o.y,o.z];const b=s.length(s.sub([],this._camera.position,m));return s.clamp(this._zoomFromMercatorZ(b),this._minZoom,this._maxZoom)}setFreeCameraOptions(o){if(!this.height||!o.position&&!o.orientation)return;this._updateCameraState();let c=!1;if(o.orientation&&!s.exactEquals(o.orientation,this._camera.orientation)&&(c=this._setCameraOrientation(o.orientation)),o.position){const m=[o.position.x,o.position.y,o.position.z];s.exactEquals$1(m,this._camera.position)||(this._setCameraPosition(m),c=!0)}c&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const o=this._camera.position,c=new yo;return c.position=new s.MercatorCoordinate(o[0],o[1],o[2]),c.orientation=this._camera.orientation,c._elevation=this.elevation,c._renderWorldCopies=this.renderWorldCopies,c}_setCameraOrientation(o){if(!s.length$1(o))return!1;s.normalize$1(o,o);const c=s.transformQuat([],[0,0,-1],o),m=s.transformQuat([],[0,-1,0],o);if(m[2]<0)return!1;const b=Eo(c,m);return!!b&&(this._camera.orientation=b,!0)}_setCameraPosition(o){const c=this.zoomScale(this.minZoom)*this.tileSize,m=this.zoomScale(this.maxZoom)*this.tileSize,b=this.cameraToCenterDistance;o[2]=s.clamp(o[2],b/m,b/c),this._camera.position=o}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(o){return this._edgeInsets.equals(o)}interpolatePadding(o,c,m){this._unmodified=!1,this._edgeInsets.interpolate(o,c,m),this._constrain(),this._calcMatrices()}coveringZoomLevel(o){const c=(o.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/o.tileSize));return Math.max(0,c)}getVisibleUnwrappedCoordinates(o){const c=[new s.UnwrappedTileID(0,o)];if(this.renderWorldCopies){const m=this.pointCoordinate(new s.Point(0,0)),b=this.pointCoordinate(new s.Point(this.width,0)),T=this.pointCoordinate(new s.Point(this.width,this.height)),I=this.pointCoordinate(new s.Point(0,this.height)),O=Math.floor(Math.min(m.x,b.x,T.x,I.x)),N=Math.floor(Math.max(m.x,b.x,T.x,I.x)),H=1;for(let $=O-H;$<=N+H;$++)0!==$&&c.push(new s.UnwrappedTileID($,o))}return c}coveringTiles(o){let c=this.coveringZoomLevel(o);const m=c,b=this.elevation&&!o.isTerrainDEM,T="mercator"===this.projection.name;if(void 0!==o.minzoom&&c<o.minzoom)return[];void 0!==o.maxzoom&&c>o.maxzoom&&(c=o.maxzoom);const I=this.locationCoordinate(this.center),O=this.center.lat,N=1<<c,H=[N*I.x,N*I.y,0],$="globe"===this.projection.name,ce=!$,Ie=s.Frustum.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,c,ce),je=$?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),Ke=N*s.mercatorZfromAltitude(1,this.center.lat),Ye=this._camera.position[2]/s.mercatorZfromAltitude(1,this.center.lat),nt=[N*je.x,N*je.y,Ye*(ce?1:Ke)],ue=this.cameraToCenterDistance/o.tileSize*(o.roundZoom?1:.502),$e=this.pitch<=60&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace?c:0,pt=o.isTerrainDEM&&this._elevation?1e4*this._elevation.exaggeration():this._centerAltitude,ht=o.isTerrainDEM?-pt:this._elevation?this._elevation.getMinElevationBelowMSL():0,Ot=this.projection.isReprojectedInTileSpace?fr(this):1,kt=cn=>{const Vn=new s.MercatorCoordinate(cn.x+25e-6,cn.y,cn.z),Bn=new s.MercatorCoordinate(cn.x,cn.y+25e-6,cn.z),qn=cn.toLngLat(),Ti=Vn.toLngLat(),Vi=Bn.toLngLat(),_i=this.locationCoordinate(qn),Oi=this.locationCoordinate(Ti),po=this.locationCoordinate(Vi),mo=Math.hypot(Oi.x-_i.x,Oi.y-_i.y),bi=Math.hypot(po.x-_i.x,po.y-_i.y);return Math.sqrt(mo*bi)*Ot/25e-6},Rt=cn=>{const Mn=pt,Vn=ht;return{aabb:s.tileAABB(this,N,0,0,0,cn,Vn,Mn,this.projection),zoom:0,x:0,y:0,minZ:Vn,maxZ:Mn,wrap:cn,fullyVisible:!1}},Yt=[];let $t=[];const ln=c,Gn=o.reparseOverscaled?m:c,on=cn=>cn*cn,An=on((Ye-this._centerAltitude)*Ke),hn=cn=>{if(!this._elevation||!cn.tileID||!T)return;const Mn=this._elevation.getMinMaxForTile(cn.tileID),Vn=cn.aabb;Mn?(Vn.min[2]=Mn.min,Vn.max[2]=Mn.max,Vn.center[2]=(Vn.min[2]+Vn.max[2])/2):(cn.shouldSplit=jn(cn),cn.shouldSplit||(Vn.min[2]=Vn.max[2]=Vn.center[2]=this._centerAltitude))},jn=cn=>{if(cn.zoom<$e)return!0;if(cn.zoom===ln)return!1;if(null!=cn.shouldSplit)return cn.shouldSplit;const Mn=cn.aabb.distanceX(nt),Vn=cn.aabb.distanceY(nt);let Bn=An,qn=1;if($){Bn=on(cn.aabb.distanceZ(nt));const _i=Math.pow(2,cn.zoom),Oi=s.latFromMercatorY((cn.y+1)/_i),po=s.latFromMercatorY(cn.y/_i),mo=Math.min(Math.max(O,Oi),po),bi=s.circumferenceAtLatitude(mo)/s.circumferenceAtLatitude(O);if(qn=mo===O?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,bi/this._mercatorScaleRatio),this.zoom<=s.GLOBE_ZOOM_THRESHOLD_MIN&&cn.zoom===ln-1&&bi>=.9)return!0}else if(b&&(Bn=on(cn.aabb.distanceZ(nt)*Ke)),this.projection.isReprojectedInTileSpace&&m<=5){const _i=Math.pow(2,cn.zoom),Oi=kt(new s.MercatorCoordinate((cn.x+.5)/_i,(cn.y+.5)/_i));qn=Oi>.85?1:Oi}const Ti=Mn*Mn+Vn*Vn+Bn;return Ti<on((1<<ln-cn.zoom)*ue*qn*((_i,Oi)=>{if(Oi*on(.707)<_i)return 1;const po=Math.sqrt(Oi/_i);return po/(1.4144271570014144+(Math.pow(1.1,po-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(Bn,An),Ti))};if(this.renderWorldCopies)for(let cn=1;cn<=3;cn++)Yt.push(Rt(-cn)),Yt.push(Rt(cn));for(Yt.push(Rt(0));Yt.length>0;){const cn=Yt.pop(),Mn=cn.x,Vn=cn.y;let Bn=cn.fullyVisible;if(!Bn){const qn=cn.aabb.intersects(Ie);if(0===qn)continue;Bn=2===qn}if(cn.zoom!==ln&&jn(cn))for(let qn=0;qn<4;qn++){const Ti=(Mn<<1)+qn%2,Vi=(Vn<<1)+(qn>>1),_i={aabb:T?cn.aabb.quadrant(qn):s.tileAABB(this,N,cn.zoom+1,Ti,Vi,cn.wrap,cn.minZ,cn.maxZ,this.projection),zoom:cn.zoom+1,x:Ti,y:Vi,wrap:cn.wrap,fullyVisible:Bn,tileID:void 0,shouldSplit:void 0,minZ:cn.minZ,maxZ:cn.maxZ};b&&!$&&(_i.tileID=new s.OverscaledTileID(cn.zoom+1===ln?Gn:cn.zoom+1,cn.wrap,cn.zoom+1,Ti,Vi),hn(_i)),Yt.push(_i)}else{const qn=cn.zoom===ln?Gn:cn.zoom;if(o.minzoom&&o.minzoom>qn)continue;const Ti=H[0]-(.5+Mn+(cn.wrap<<cn.zoom))*(1<<c-cn.zoom),Vi=H[1]-.5-Vn,_i=cn.tileID?cn.tileID:new s.OverscaledTileID(qn,cn.wrap,cn.zoom,Mn,Vn);$t.push({tileID:_i,distanceSq:Ti*Ti+Vi*Vi})}}if(this.fogCullDistSq){const cn=this.fogCullDistSq,Mn=this.horizonLineFromTop();$t=$t.filter(Vn=>{const Bn=[0,0,0,1],qn=[s.EXTENT,s.EXTENT,0,1],Ti=this.calculateFogTileMatrix(Vn.tileID.toUnwrapped());s.transformMat4$1(Bn,Bn,Ti),s.transformMat4$1(qn,qn,Ti);const Vi=s.getAABBPointSquareDist(Bn,qn);if(0===Vi)return!0;let _i=!1;const Oi=this._elevation;if(Oi&&Vi>cn&&0!==Mn){const po=this.calculateProjMatrix(Vn.tileID.toUnwrapped());let mo;o.isTerrainDEM||(mo=Oi.getMinMaxForTile(Vn.tileID)),mo||(mo={min:ht,max:pt});const bi=s.furthestTileCorner(this.rotation),Fo=[bi[0]*s.EXTENT,bi[1]*s.EXTENT,mo.max];s.transformMat4(Fo,Fo,po),_i=(1-Fo[1])*this.height*.5<Mn}return Vi<cn||_i})}return $t.sort((cn,Mn)=>cn.distanceSq-Mn.distanceSq).map(cn=>cn.tileID)}resize(o,c){this.width=o,this.height=c,this.pixelsToGLUnits=[2/o,-2/c],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(o){return Math.pow(2,o)}scaleZoom(o){return Math.log(o)/Math.LN2}project(o){const c=s.clamp(o.lat,-s.MAX_MERCATOR_LATITUDE,s.MAX_MERCATOR_LATITUDE),m=this.projection.project(o.lng,c);return new s.Point(m.x*this.worldSize,m.y*this.worldSize)}unproject(o){return this.projection.unproject(o.x/this.worldSize,o.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/s.mercatorZfromAltitude(1,this.center.lat)/this.worldSize}setLocationAtPoint(o,c){let m,b;const T=this.centerPoint;if("globe"===this.projection.name){const O=this.worldSize;m=(c.x-T.x)/O,b=(c.y-T.y)/O}else{const O=this.pointCoordinate(c),N=this.pointCoordinate(T);m=O.x-N.x,b=O.y-N.y}const I=this.locationCoordinate(o);this.setLocation(new s.MercatorCoordinate(I.x-m,I.y-b))}setLocation(o){this.center=this.coordinateLocation(o),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(o){return this.projection.locationPoint(this,o)}locationPoint3D(o){return this.projection.locationPoint(this,o,!0)}pointLocation(o){return this.coordinateLocation(this.pointCoordinate(o))}pointLocation3D(o){return this.coordinateLocation(this.pointCoordinate3D(o))}locationCoordinate(o,c){const m=c?s.mercatorZfromAltitude(c,o.lat):void 0,b=this.projection.project(o.lng,o.lat);return new s.MercatorCoordinate(b.x,b.y,m)}coordinateLocation(o){return this.projection.unproject(o.x,o.y)}pointRayIntersection(o,c){const m=c??this._centerAltitude,b=[o.x,o.y,0,1],T=[o.x,o.y,1,1];s.transformMat4$1(b,b,this.pixelMatrixInverse),s.transformMat4$1(T,T,this.pixelMatrixInverse);const I=T[3];s.scale$1(b,b,1/b[3]),s.scale$1(T,T,1/I);const O=b[2],N=T[2];return{p0:b,p1:T,t:O===N?0:(m-O)/(N-O)}}screenPointToMercatorRay(o){const c=[o.x,o.y,0,1],m=[o.x,o.y,1,1];return s.transformMat4$1(c,c,this.pixelMatrixInverse),s.transformMat4$1(m,m,this.pixelMatrixInverse),s.scale$1(c,c,1/c[3]),s.scale$1(m,m,1/m[3]),c[2]=s.mercatorZfromAltitude(c[2],this._center.lat)*this.worldSize,m[2]=s.mercatorZfromAltitude(m[2],this._center.lat)*this.worldSize,s.scale$1(c,c,1/this.worldSize),s.scale$1(m,m,1/this.worldSize),new s.Ray([c[0],c[1],c[2]],s.normalize([],s.sub([],m,c)))}rayIntersectionCoordinate(o){const{p0:c,p1:m,t:b}=o,T=s.mercatorZfromAltitude(c[2],this._center.lat),I=s.mercatorZfromAltitude(m[2],this._center.lat);return new s.MercatorCoordinate(s.number(c[0],m[0],b)/this.worldSize,s.number(c[1],m[1],b)/this.worldSize,s.number(T,I,b))}pointCoordinate(o,c=this._centerAltitude){return this.projection.pointCoordinate(this,o.x,o.y,c)}pointCoordinate3D(o){if(!this.elevation)return this.pointCoordinate(o);let c=this.projection.pointCoordinate3D(this,o.x,o.y);if(c)return new s.MercatorCoordinate(c[0],c[1],c[2]);let m=0,b=this.horizonLineFromTop();if(o.y>b)return this.pointCoordinate(o);const T=.02*b,I=o.clone();for(let O=0;O<10&&b-m>T;O++){I.y=s.number(m,b,.66);const N=this.projection.pointCoordinate3D(this,I.x,I.y);N?(b=I.y,c=N):m=I.y}return c?new s.MercatorCoordinate(c[0],c[1],c[2]):this.pointCoordinate(o)}isPointAboveHorizon(o){return this.projection.isPointAboveHorizon(this,o)}isPointOnSurface(o){if(o.y<0||o.y>this.height||o.x<0||o.x>this.width)return!1;if(this.elevation||this.zoom>=s.GLOBE_ZOOM_THRESHOLD_MAX)return!this.isPointAboveHorizon(o);const c=this.pointCoordinate(o);return c.y>=0&&c.y<=1}_coordinatePoint(o,c){const m=c&&this.elevation?this.elevation.getAtPointOrZero(o,this._centerAltitude):this._centerAltitude,b=[o.x*this.worldSize,o.y*this.worldSize,m+o.toAltitude(),1];return s.transformMat4$1(b,b,this.pixelMatrix),b[3]>0?new s.Point(b[0]/b[3],b[1]/b[3]):new s.Point(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:o,left:c}=this._edgeInsets,m=this.height-this._edgeInsets.bottom,b=this.width-this._edgeInsets.right,T=this.pointLocation3D(new s.Point(c,o)),I=this.pointLocation3D(new s.Point(b,o)),O=this.pointLocation3D(new s.Point(b,m)),N=this.pointLocation3D(new s.Point(c,m));let H=Math.min(T.lng,I.lng,O.lng,N.lng),$=Math.max(T.lng,I.lng,O.lng,N.lng),ce=Math.min(T.lat,I.lat,O.lat,N.lat),Ie=Math.max(T.lat,I.lat,O.lat,N.lat);const je=Math.pow(2,-this.zoom)/16*270,Ke="globe"===this.projection.name?1:4,Ye=(nt,ue,$e,pt,ht)=>{const Ot=(nt+$e)/2,kt=(ue+pt)/2,Rt=new s.Point(Ot,kt),{lng:Yt,lat:$t}=this.pointLocation3D(Rt),ln=Math.max(0,H-Yt,ce-$t,Yt-$,$t-Ie);H=Math.min(H,Yt),$=Math.max($,Yt),ce=Math.min(ce,$t),Ie=Math.max(Ie,$t),(ht<Ke||ln>je)&&(Ye(nt,ue,Ot,kt,ht+1),Ye(Ot,kt,$e,pt,ht+1))};if(Ye(c,o,b,o,1),Ye(b,o,b,m,1),Ye(b,m,c,m,1),Ye(c,m,c,o,1),"globe"===this.projection.name){const[nt,ue]=s.polesInViewport(this);nt?(Ie=90,$=180,H=-180):ue&&(ce=-90,$=180,H=-180)}return new s.LngLatBounds(new s.LngLat(H,ce),new s.LngLat($,Ie))}_getBoundsRectangular(o,c){const{top:m,left:b}=this._edgeInsets,T=this.height-this._edgeInsets.bottom,I=this.width-this._edgeInsets.right,O=new s.Point(b,m),N=new s.Point(I,m),H=new s.Point(I,T),$=new s.Point(b,T);let ce=this.pointCoordinate(O,o),Ie=this.pointCoordinate(N,o);const je=this.pointCoordinate(H,c),Ke=this.pointCoordinate($,c),Ye=(nt,ue)=>(ue.y-nt.y)/(ue.x-nt.x);return ce.y>1&&Ie.y>=0?ce=new s.MercatorCoordinate((1-Ke.y)/Ye(Ke,ce)+Ke.x,1):ce.y<0&&Ie.y<=1&&(ce=new s.MercatorCoordinate(-Ke.y/Ye(Ke,ce)+Ke.x,0)),Ie.y>1&&ce.y>=0?Ie=new s.MercatorCoordinate((1-je.y)/Ye(je,Ie)+je.x,1):Ie.y<0&&ce.y<=1&&(Ie=new s.MercatorCoordinate(-je.y/Ye(je,Ie)+je.x,0)),(new s.LngLatBounds).extend(this.coordinateLocation(ce)).extend(this.coordinateLocation(Ie)).extend(this.coordinateLocation(Ke)).extend(this.coordinateLocation(je))}_getBoundsRectangularTerrain(){const o=this.elevation;if(!o.visibleDemTiles.length||o.isUsingMockSource())return this._getBoundsRectangular(0,0);const c=o.visibleDemTiles.reduce((m,b)=>{if(b.dem){const T=b.dem.tree;m.min=Math.min(m.min,T.minimums[0]),m.max=Math.max(m.max,T.maximums[0])}return m},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(c.min*o.exaggeration(),c.max*o.exaggeration())}getBounds(){return"mercator"===this.projection.name||"equirectangular"===this.projection.name?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(o=!0){const c=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))+this.centerOffset.y,m=this.height/2-c*(1-this._horizonShift);return o?Math.max(0,m):m}getMaxBounds(){return this.maxBounds}setMaxBounds(o){this.maxBounds=o,this.minLat=-s.MAX_MERCATOR_LATITUDE,this.maxLat=s.MAX_MERCATOR_LATITUDE,this.minLng=-180,this.maxLng=180,o&&(this.minLat=o.getSouth(),this.maxLat=o.getNorth(),this.minLng=o.getWest(),this.maxLng=o.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=s.mercatorXfromLng(this.minLng)*this.tileSize,this.worldMaxX=s.mercatorXfromLng(this.maxLng)*this.tileSize,this.worldMinY=s.mercatorYfromLat(this.maxLat)*this.tileSize,this.worldMaxY=s.mercatorYfromLat(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(o,c){return this.projection.createTileMatrix(this,c,o)}calculateDistanceTileData(o){const c=o.key,m=this._distanceTileDataCache;if(m[c])return m[c];const b=o.canonical,T=1/this.height,I=this.cameraWorldSize,O=I/this.zoomScale(b.z),N=(b.x+Math.pow(2,b.z)*o.wrap)*O,H=b.y*O,$=this.point;$.x*=I/this.worldSize,$.y*=I/this.worldSize;const ce=this.angle,Ie=Math.sin(-ce),je=-Math.cos(-ce);return m[c]={bearing:[Ie,je],center:[($.x-N)*T,($.y-H)*T],scale:O/s.EXTENT*T},m[c]}calculateFogTileMatrix(o){const c=o.key,m=this._fogTileMatrixCache;if(m[c])return m[c];const b=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,o);return s.multiply(b,this.worldToFogMatrix,b),m[c]=new Float32Array(b),m[c]}calculateProjMatrix(o,c=!1){const m=o.key,b=c?this._alignedProjMatrixCache:this._projMatrixCache;if(b[m])return b[m];const T=this.calculatePosMatrix(o,this.worldSize);return s.multiply(T,this.projection.isReprojectedInTileSpace?this.mercatorMatrix:c?this.alignedProjMatrix:this.projMatrix,T),b[m]=new Float32Array(T),b[m]}calculatePixelsToTileUnitsMatrix(o){const c=o.tileID.key,m=this._pixelsToTileUnitsCache;if(m[c])return m[c];const b=function(T,I){const{scale:O}=T.tileTransform,N=O*s.EXTENT/(T.tileSize*Math.pow(2,I.zoom-T.tileID.overscaledZ+T.tileID.canonical.z));return H=new Float32Array(4),Ie=($=I.inverseAdjustmentMatrix)[1],je=$[2],Ke=$[3],nt=(ce=[N,N])[1],H[0]=$[0]*(Ye=ce[0]),H[1]=Ie*Ye,H[2]=je*nt,H[3]=Ke*nt,H;var H,$,ce,Ie,je,Ke,Ye,nt}(o,this);return m[c]=b,m[c]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if("globe"===this.projection.name){const o=1/this.worldSize,c=s.fromScaling([],[o,o,o]);return s.multiply(c,c,this.globeMatrix),c}}recenterOnTerrain(){if(!this._elevation||"globe"===this.projection.name)return;const o=this._elevation;this._updateCameraState();const c=s.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,m=this._computeCameraPosition(c),b=this._camera.forward(),T=s.mercatorZfromAltitude(1,this._center.lat);m[2]/=T,b[2]/=T,s.normalize(b,b);const I=o.raycast(m,b,o.exaggeration());if(I){const O=s.scaleAndAdd([],m,b,I),N=new s.MercatorCoordinate(O[0],O[1],s.mercatorZfromAltitude(O[2],s.latFromMercatorY(O[1]))),H=(N.z+s.length([N.x-m[0],N.y-m[1],N.z-m[2]*T]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(H),this._centerAltitude=N.toAltitude(),this._center=this.coordinateLocation(N),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(o=!1){if(!this._elevation)return;const c=this._elevation,m=s.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,b=this._computeCameraPosition(m),T=c.getAtPointOrZero(new s.MercatorCoordinate(...b)),I=this.pixelsPerMeter/this.worldSize*T,O=this._minimumHeightOverTerrain(),N=b[2]-I;if(N<=O)if(N<0||o){const H=this.locationCoordinate(this._center,this._centerAltitude),$=[b[0],b[1],H.z-b[2]],ce=s.length($);$[2]-=(O-N)/this._pixelsPerMercatorPixel;const Ie=s.length($);if(0===Ie)return;s.scale$2($,$,ce/Ie*this._pixelsPerMercatorPixel),this._camera.position=[b[0],b[1],H.z*this._pixelsPerMercatorPixel-$[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const o="globe"===this.projection.name||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||o){const Ie=this.center;return Ie.lat=s.clamp(Ie.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!o)&&(Ie.lng=s.clamp(Ie.lng,this.minLng,this.maxLng)),this.center=Ie,void(this._constraining=!1)}const c=this._unmodified,{x:m,y:b}=this.point;let T=0,I=m,O=b;const N=this.width/2,H=this.height/2,$=this.worldMinY*this.scale,ce=this.worldMaxY*this.scale;if(b-H<$&&(O=$+H),b+H>ce&&(O=ce-H),ce-$<this.height&&(T=Math.max(T,this.height/(ce-$)),O=(ce+$)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const Ie=this.worldMinX*this.scale,je=this.worldMaxX*this.scale,Ke=this.worldSize/2-(Ie+je)/2;I=(m+Ke+this.worldSize)%this.worldSize-Ke,I-N<Ie&&(I=Ie+N),I+N>je&&(I=je-N),je-Ie<this.width&&(T=Math.max(T,this.width/(je-Ie)),I=(je+Ie)/2)}I===m&&O===b||(this.center=this.unproject(new s.Point(I,O))),T&&(this.zoom+=this.scaleZoom(T)),this._constrainCamera(),this._unmodified=c,this._constraining=!1}_minZoomForBounds(){let o=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(o=Math.max(o,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),o}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const o=this.centerOffset,c=this.pixelsPerMeter;"globe"===this.projection.name&&(this._mercatorScaleRatio=s.mercatorZfromAltitude(1,this.center.lat)/s.mercatorZfromAltitude(1,s.GLOBE_SCALE_MATCH_LATITUDE));const m=Ro(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,m),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const b="meters"===this.projection.zAxisUnit?c:1,T=this._camera.getWorldToCamera(this.worldSize,b),I=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);I[8]=2*-o.x/this.width,I[9]=2*o.y/this.height;let O=s.mul([],I,T);if(this.projection.isReprojectedInTileSpace){const kt=this.locationCoordinate(this.center),Rt=s.identity([]);s.translate(Rt,Rt,[kt.x*this.worldSize,kt.y*this.worldSize,0]),s.multiply(Rt,Rt,co(this)),s.translate(Rt,Rt,[-kt.x*this.worldSize,-kt.y*this.worldSize,0]),s.multiply(O,O,Rt),this.inverseAdjustmentMatrix=function(Yt){const $t=co(Yt,!0);return Me([],[$t[0],$t[1],$t[4],$t[5]])}(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];this.mercatorMatrix=s.scale([],O,[this.worldSize,this.worldSize,this.worldSize/b,1]),this.projMatrix=O,this.invProjMatrix=s.invert(new Float64Array(16),this.projMatrix);const N=s.invert([],I);this.frustumCorners=s.FrustumCorners.fromInvProjectionMatrix(N,this.horizonLineFromTop(),this.height);const H=new Float32Array(16);s.identity(H),s.scale(H,H,[1,-1,1]),s.rotateX(H,H,this._pitch),s.rotateZ(H,H,this.angle);const $=s.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ),ce=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;$[8]=2*-o.x/this.width,$[9]=2*(o.y+ce)/this.height,this.skyboxMatrix=s.multiply(H,$,H);const Ie=this.point,je=Ie.x,Ke=Ie.y,Ye=this.width%2/2,nt=this.height%2/2,ue=Math.cos(this.angle),$e=Math.sin(this.angle),pt=je-Math.round(je)+ue*Ye+$e*nt,ht=Ke-Math.round(Ke)+ue*nt+$e*Ye,Ot=new Float64Array(O);if(s.translate(Ot,Ot,[pt>.5?pt-1:pt,ht>.5?ht-1:ht,0]),this.alignedProjMatrix=Ot,O=s.create(),s.scale(O,O,[this.width/2,-this.height/2,1]),s.translate(O,O,[1,-1,0]),this.labelPlaneMatrix=O,O=s.create(),s.scale(O,O,[1,-1,1]),s.translate(O,O,[-1,-1,0]),s.scale(O,O,[2/this.width,2/this.height,1]),this.glCoordMatrix=O,this.pixelMatrix=s.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),this._calcFogMatrices(),this._distanceTileDataCache={},O=s.invert(new Float64Array(16),this.pixelMatrix),!O)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=O,"globe"===this.projection.name||this.mercatorFromTransition){this.globeMatrix=s.calculateGlobeMatrix(this);const kt=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=s.transformMat4(kt,kt,T),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=O;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const o=this.cameraWorldSizeForFog,c=this.cameraPixelsPerMeter,m=this._camera.position,b=1/this.height/this._pixelsPerMercatorPixel,T=[o,o,c];s.scale$2(T,T,b),s.scale$2(m,m,-1),s.multiply$2(m,m,T);const I=s.create();s.translate(I,I,m),s.scale(I,I,T),this.mercatorFogMatrix=I,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(o,c,b)}_computeCameraPosition(o){const c=(o=o||this.pixelsPerMeter)/this.pixelsPerMeter,m=this._camera.forward(),b=this.point,T=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*c-o/this.worldSize*this._centerAltitude;return[b.x/this.worldSize-m[0]*T,b.y/this.worldSize-m[1]*T,o/this.worldSize*this._centerAltitude-m[2]*T]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(o){const c=this._maxCameraBoundsDistance()*Math.cos(this._pitch),m=this._camera.position[2],b=o[2];let T=1;this.projection.wrap&&(this.center=this.center.wrap()),b>0&&(T=Math.min((c-m)/b,1)),this._camera.position=s.scaleAndAdd([],this._camera.position,o,T),this._updateStateFromCamera()}_updateStateFromCamera(){const o=this._camera.position,c=this._camera.forward(),{pitch:m,bearing:b}=this._camera.getPitchBearing(),T=s.mercatorZfromAltitude(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,I=this._mercatorZfromZoom(this._maxZoom)*Math.cos(s.degToRad(this._maxPitch)),O=Math.max((o[2]-T)/Math.cos(m),I),N=this._zoomFromMercatorZ(O);s.scaleAndAdd(o,o,c,O),this._pitch=s.clamp(m,s.degToRad(this.minPitch),s.degToRad(this.maxPitch)),this.angle=s.wrap(b,-Math.PI,Math.PI),this._setZoom(s.clamp(N,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new s.MercatorCoordinate(o[0],o[1],o[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(o){return Math.pow(2,o)*this.tileSize}_mercatorZfromZoom(o){return this.cameraToCenterDistance/this._worldSizeFromZoom(o)}_minimumHeightOverTerrain(){const o=Math.min((null!=this._seaLevelZoom?this._seaLevelZoom:this._zoom)+4,this._maxZoom);return this._mercatorZfromZoom(o)}_zoomFromMercatorZ(o){return this.scaleZoom(this.cameraToCenterDistance/(o*this.tileSize))}zoomFromMercatorZAdjusted(o){let c=0,m=s.GLOBE_ZOOM_THRESHOLD_MAX,b=0,T=1/0;for(;m-c>1e-6&&m>c;){const I=c+.5*(m-c),O=this.tileSize*Math.pow(2,I),N=this.getCameraToCenterDistance(this.projection,I,O),H=this.scaleZoom(N/(o*this.tileSize)),$=Math.abs(I-H);$<T&&(T=$,b=I),I<H?c=I:m=I}return b}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(s.warnOnce("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(o,c){const m=Math.min(o.x,c.x),b=Math.max(o.x,c.x),T=Math.min(o.y,c.y),I=Math.max(o.y,c.y);if(T<this.horizonLineFromTop(!1))return!0;if("mercator"!==this.projection.name)return!1;const O=[new s.Point(m,T),new s.Point(b,I),new s.Point(m,I),new s.Point(b,T)],N=this.renderWorldCopies?-3:0,H=this.renderWorldCopies?4:1;for(const $ of O){const ce=this.pointRayIntersection($);if(ce.t<0)return!0;const Ie=this.rayIntersectionCoordinate(ce);if(Ie.x<N||Ie.y<0||Ie.x>H||Ie.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+s.radToDeg(this.fovAboveCenter)>88||this.anyCornerOffEdge(new s.Point(0,0),new s.Point(this.width,this.height))}zoomDeltaToMovement(o,c){const m=s.length(s.sub([],this._camera.position,o)),b=this._zoomFromMercatorZ(m)+c;return m-this._mercatorZfromZoom(b)}getCameraPoint(){if("globe"===this.projection.name){const o=function([c,m,b],T){const I=[c,m,b,1];s.transformMat4$1(I,I,T);const O=I[3]=Math.max(I[3],1e-6);return I[0]/=O,I[1]/=O,I[2]/=O,I}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new s.Point(o[0],o[1])}{const o=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new s.Point(0,o))}}getCameraToCenterDistance(o,c=this.zoom,m=this.worldSize){const b=Ro(o,c,this.width,this.height,1024),T=o.pixelSpaceConversion(this.center.lat,m,b);return.5/Math.tan(.5*this._fov)*this.height*T}getWorldToCameraMatrix(){const o=this._camera.getWorldToCamera(this.worldSize,"meters"===this.projection.zAxisUnit?this.pixelsPerMeter:1);return"globe"===this.projection.name&&s.multiply(o,o,this.globeMatrix),o}}function Vr(p,o){let c=!1,m=null;const b=()=>{m=null,c&&(p(),m=setTimeout(b,o),c=!1)};return()=>(c=!0,m||b(),m)}class qs{constructor(o){this._hashName=o&&encodeURIComponent(o),s.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=Vr(this._updateHashUnthrottled.bind(this),300)}addTo(o){return this._map=o,s.window.addEventListener("hashchange",this._onHashChange,!1),o.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),s.window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const o=this._map;if(!o)return"";const c=os(o);if(this._hashName){const m=this._hashName;let b=!1;const T=s.window.location.hash.slice(1).split("&").map(I=>{const O=I.split("=")[0];return O===m?(b=!0,`${O}=${c}`):I}).filter(I=>I);return b||T.push(`${m}=${c}`),`#${T.join("&")}`}return`#${c}`}_getCurrentHash(){const o=s.window.location.hash.replace("#","");if(this._hashName){let c;return o.split("&").map(m=>m.split("=")).forEach(m=>{m[0]===this._hashName&&(c=m)}),(c&&c[1]||"").split("/")}return o.split("/")}_onHashChange(){const o=this._map;if(!o)return!1;const c=this._getCurrentHash();if(c.length>=3&&!c.some(m=>isNaN(m))){const m=o.dragRotate.isEnabled()&&o.touchZoomRotate.isEnabled()?+(c[3]||0):o.getBearing();return o.jumpTo({center:[+c[2],+c[1]],zoom:+c[0],bearing:m,pitch:+(c[4]||0)}),!0}return!1}_updateHashUnthrottled(){const o=s.window.location.href.replace(/(#.+)?$/,this.getHashString());s.window.history.replaceState(s.window.history.state,null,o)}}function os(p,o){const c=p.getCenter(),m=Math.round(100*p.getZoom())/100,b=Math.ceil((m*Math.LN2+Math.log(512/360/.5))/Math.LN10),T=Math.pow(10,b),I=Math.round(c.lng*T)/T,O=Math.round(c.lat*T)/T,N=p.getBearing(),H=p.getPitch();let $=o?`/${I}/${O}/${m}`:`${m}/${O}/${I}`;return(N||H)&&($+="/"+Math.round(10*N)/10),H&&($+=`/${Math.round(H)}`),$}const ki={linearity:.3,easing:s.bezier(0,0,.3,1)},Zl=s.extend({deceleration:2500,maxSpeed:1400},ki),ms=s.extend({deceleration:20,maxSpeed:1400},ki),ci=s.extend({deceleration:1e3,maxSpeed:360},ki),sa=s.extend({deceleration:1e3,maxSpeed:90},ki);class gu{constructor(o){this._map=o,this.clear()}clear(){this._inertiaBuffer=[]}record(o){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:s.exported.now(),settings:o})}_drainInertiaBuffer(){const o=this._inertiaBuffer,c=s.exported.now();for(;o.length>0&&c-o[0].time>160;)o.shift()}_onMoveEnd(o){if(this._map._prefersReducedMotion()||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;const c={zoom:0,bearing:0,pitch:0,pan:new s.Point(0,0),pinchAround:void 0,around:void 0};for(const{settings:T}of this._inertiaBuffer)c.zoom+=T.zoomDelta||0,c.bearing+=T.bearingDelta||0,c.pitch+=T.pitchDelta||0,T.panDelta&&c.pan._add(T.panDelta),T.around&&(c.around=T.around),T.pinchAround&&(c.pinchAround=T.pinchAround);const m=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,b={};if(c.pan.mag()){const T=ga(c.pan.mag(),m,s.extend({},Zl,o||{}));b.offset=c.pan.mult(T.amount/c.pan.mag()),b.center=this._map.transform.center,gl(b,T)}if(c.zoom){const T=ga(c.zoom,m,ms);b.zoom=this._map.transform.zoom+T.amount,gl(b,T)}if(c.bearing){const T=ga(c.bearing,m,ci);b.bearing=this._map.transform.bearing+s.clamp(T.amount,-179,179),gl(b,T)}if(c.pitch){const T=ga(c.pitch,m,sa);b.pitch=this._map.transform.pitch+T.amount,gl(b,T)}if(b.zoom||b.bearing){const T=void 0===c.pinchAround?c.around:c.pinchAround;b.around=T?this._map.unproject(T):this._map.getCenter()}return this.clear(),b.noMoveStart=!0,b}}function gl(p,o){(!p.duration||p.duration<o.duration)&&(p.duration=o.duration,p.easing=o.easing)}function ga(p,o,c){const{maxSpeed:m,linearity:b,deceleration:T}=c,I=s.clamp(p*b/(o/1e3),-m,m),O=Math.abs(I)/(T*b);return{easing:c.easing,duration:1e3*O,amount:I*(O/2)}}class qo extends s.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,c,m,b={}){const T=Ne(c.getCanvasContainer(),m),I=c.unproject(T);super(o,s.extend({point:T,lngLat:I,originalEvent:m},b)),this._defaultPrevented=!1,this.target=c}}class Vl extends s.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,c,m){const b="touchend"===o?m.changedTouches:m.touches,T=qe(c.getCanvasContainer(),b),I=T.map(N=>c.unproject(N)),O=T.reduce((N,H,$,ce)=>N.add(H.div(ce.length)),new s.Point(0,0));super(o,{points:T,point:O,lngLats:I,lngLat:c.unproject(O),originalEvent:m}),this._defaultPrevented=!1}}class Ka extends s.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,c,m){super(o,{originalEvent:m}),this._defaultPrevented=!1}}class Zc{constructor(o,c){this._map=o,this._clickTolerance=c.clickTolerance}reset(){this._mousedownPos=void 0}wheel(o){return this._firePreventable(new Ka(o.type,this._map,o))}mousedown(o,c){return this._mousedownPos=c,this._firePreventable(new qo(o.type,this._map,o))}mouseup(o){this._map.fire(new qo(o.type,this._map,o))}preclick(o){const c=s.extend({},o);c.type="preclick",this._map.fire(new qo(c.type,this._map,c))}click(o,c){this._mousedownPos&&this._mousedownPos.dist(c)>=this._clickTolerance||(this.preclick(o),this._map.fire(new qo(o.type,this._map,o)))}dblclick(o){return this._firePreventable(new qo(o.type,this._map,o))}mouseover(o){this._map.fire(new qo(o.type,this._map,o))}mouseout(o){this._map.fire(new qo(o.type,this._map,o))}touchstart(o){return this._firePreventable(new Vl(o.type,this._map,o))}touchmove(o){this._map.fire(new Vl(o.type,this._map,o))}touchend(o){this._map.fire(new Vl(o.type,this._map,o))}touchcancel(o){this._map.fire(new Vl(o.type,this._map,o))}_firePreventable(o){if(this._map.fire(o),o.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class dc{constructor(o){this._map=o}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(o){this._map.fire(new qo(o.type,this._map,o))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new qo("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(o){this._delayContextMenu?this._contextMenuEvent=o:this._map.fire(new qo(o.type,this._map,o)),this._map.listens("contextmenu")&&o.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Hn{constructor(o,c){this._map=o,this._el=o.getCanvasContainer(),this._container=o.getContainer(),this._clickTolerance=c.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(o,c){this.isEnabled()&&o.shiftKey&&0===o.button&&(Ee(),this._startPos=this._lastPos=c,this._active=!0)}mousemoveWindow(o,c){if(!this._active)return;const m=c,b=this._startPos,T=this._lastPos;if(!b||!T||T.equals(m)||!this._box&&m.dist(b)<this._clickTolerance)return;this._lastPos=m,this._box||(this._box=fe("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",o));const I=Math.min(b.x,m.x),O=Math.max(b.x,m.x),N=Math.min(b.y,m.y),H=Math.max(b.y,m.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${I}px,${N}px)`,this._box.style.width=O-I+"px",this._box.style.height=H-N+"px")})}mouseupWindow(o,c){if(!this._active)return;const m=this._startPos,b=c;if(m&&0===o.button){if(this.reset(),Re(),m.x!==b.x||m.y!==b.y)return this._map.fire(new s.Event("boxzoomend",{originalEvent:o})),{cameraAnimation:T=>T.fitScreenCoordinates(m,b,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",o)}}keydown(o){this._active&&27===o.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",o))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),_e(),delete this._startPos,delete this._lastPos}_fireEvent(o,c){return this._map.fire(new s.Event(o,{originalEvent:c}))}}function Mo(p,o){const c={};for(let m=0;m<p.length;m++)c[p[m].identifier]=o[m];return c}class _l{constructor(o){this.reset(),this.numTouches=o.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(o,c,m){(this.centroid||m.length>this.numTouches)&&(this.aborted=!0),this.aborted||(0===this.startTime&&(this.startTime=o.timeStamp),m.length===this.numTouches&&(this.centroid=function(b){const T=new s.Point(0,0);for(const I of b)T._add(I);return T.div(b.length)}(c),this.touches=Mo(m,c)))}touchmove(o,c,m){if(this.aborted||!this.centroid)return;const b=Mo(m,c);for(const T in this.touches){const I=b[T];(!I||I.dist(this.touches[T])>30)&&(this.aborted=!0)}}touchend(o,c,m){if((!this.centroid||o.timeStamp-this.startTime>500)&&(this.aborted=!0),0===m.length){const b=!this.aborted&&this.centroid;if(this.reset(),b)return b}}}class hc{constructor(o){this.singleTap=new _l(o),this.numTaps=o.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(o,c,m){this.singleTap.touchstart(o,c,m)}touchmove(o,c,m){this.singleTap.touchmove(o,c,m)}touchend(o,c,m){const b=this.singleTap.touchend(o,c,m);if(b){const T=o.timeStamp-this.lastTime<500,I=!this.lastTap||this.lastTap.dist(b)<30;if(T&&I||this.reset(),this.count++,this.lastTime=o.timeStamp,this.lastTap=b,this.count===this.numTaps)return this.reset(),b}}}class jr{constructor(){this._zoomIn=new hc({numTouches:1,numTaps:2}),this._zoomOut=new hc({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(o,c,m){this._zoomIn.touchstart(o,c,m),this._zoomOut.touchstart(o,c,m)}touchmove(o,c,m){this._zoomIn.touchmove(o,c,m),this._zoomOut.touchmove(o,c,m)}touchend(o,c,m){const b=this._zoomIn.touchend(o,c,m),T=this._zoomOut.touchend(o,c,m);return b?(this._active=!0,o.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:I=>I.easeTo({duration:300,zoom:I.getZoom()+1,around:I.unproject(b)},{originalEvent:o})}):T?(this._active=!0,o.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:I=>I.easeTo({duration:300,zoom:I.getZoom()-1,around:I.unproject(T)},{originalEvent:o})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const pc={0:1,2:2};class Aa{constructor(o){this.reset(),this._clickTolerance=o.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(o,c){return!1}_move(o,c){return{}}mousedown(o,c){if(this._lastPoint)return;const m=_t(o);this._correctButton(o,m)&&(this._lastPoint=c,this._eventButton=m)}mousemoveWindow(o,c){const m=this._lastPoint;if(m)if(o.preventDefault(),null!=this._eventButton&&function(b,T){const I=pc[T];return void 0===b.buttons||(b.buttons&I)!==I}(o,this._eventButton))this.reset();else if(this._moved||!(c.dist(m)<this._clickTolerance))return this._moved=!0,this._lastPoint=c,this._move(m,c)}mouseupWindow(o){this._lastPoint&&_t(o)===this._eventButton&&(this._moved&&Re(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class ks extends Aa{mousedown(o,c){super.mousedown(o,c),this._lastPoint&&(this._active=!0)}_correctButton(o,c){return 0===c&&!o.ctrlKey}_move(o,c){return{around:c,panDelta:c.sub(o)}}}class Fs extends Aa{_correctButton(o,c){return 0===c&&o.ctrlKey||2===c}_move(o,c){const m=.8*(c.x-o.x);if(m)return this._active=!0,{bearingDelta:m}}contextmenu(o){o.preventDefault()}}class jl extends Aa{_correctButton(o,c){return 0===c&&o.ctrlKey||2===c}_move(o,c){const m=-.5*(c.y-o.y);if(m)return this._active=!0,{pitchDelta:m}}contextmenu(o){o.preventDefault()}}class Vc{constructor(o,c){this._map=o,this._el=o.getCanvasContainer(),this._minTouches=1,this._clickTolerance=c.clickTolerance||1,this.reset(),s.bindAll(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new s.Point(0,0)}touchstart(o,c,m){return this._calculateTransform(o,c,m)}touchmove(o,c,m){if(this._active&&!(m.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(1===m.length&&!s.isFullscreen())return void this._showTouchPanBlockerAlert();"hidden"!==this._alertContainer.style.visibility&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return o.cancelable&&o.preventDefault(),this._calculateTransform(o,c,m)}}touchend(o,c,m){this._calculateTransform(o,c,m),this._active&&m.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(o,c,m){m.length>0&&(this._active=!0);const b=Mo(m,c),T=new s.Point(0,0),I=new s.Point(0,0);let O=0;for(const H in b){const $=b[H],ce=this._touches[H];ce&&(T._add($),I._add($.sub(ce)),O++,b[H]=$)}if(this._touches=b,O<this._minTouches||!I.mag())return;const N=I.div(O);return this._sum._add(N),this._sum.mag()<this._clickTolerance?void 0:{around:T.div(O),panDelta:N}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=fe("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","null")},500)}}class jc{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(o){}_move(o,c,m){return{}}touchstart(o,c,m){this._firstTwoTouches||m.length<2||(this._firstTwoTouches=[m[0].identifier,m[1].identifier],this._start([c[0],c[1]]))}touchmove(o,c,m){const b=this._firstTwoTouches;if(!b)return;o.preventDefault();const[T,I]=b,O=$l(m,c,T),N=$l(m,c,I);if(!O||!N)return;const H=this._aroundCenter?null:O.add(N).div(2);return this._move([O,N],H,o)}touchend(o,c,m){if(!this._firstTwoTouches)return;const[b,T]=this._firstTwoTouches,I=$l(m,c,b),O=$l(m,c,T);I&&O||(this._active&&Re(),this.reset())}touchcancel(){this.reset()}enable(o){this._enabled=!0,this._aroundCenter=!!o&&"center"===o.around}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function $l(p,o,c){for(let m=0;m<p.length;m++)if(p[m].identifier===c)return o[m]}function Wr(p,o){return Math.log(p/o)/Math.LN2}class aa extends jc{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(o){this._startDistance=this._distance=o[0].dist(o[1])}_move(o,c){const m=this._distance;if(this._distance=o[0].dist(o[1]),this._active||!(Math.abs(Wr(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Wr(this._distance,m),pinchAround:c}}}function yl(p,o){return 180*p.angleWith(o)/Math.PI}class Xa extends jc{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(o){this._startVector=this._vector=o[0].sub(o[1]),this._minDiameter=o[0].dist(o[1])}_move(o,c){const m=this._vector;if(this._vector=o[0].sub(o[1]),m&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:yl(this._vector,m),pinchAround:c}}_isBelowThreshold(o){this._minDiameter=Math.min(this._minDiameter,o.mag());const c=25/(Math.PI*this._minDiameter)*360,m=this._startVector;if(!m)return!1;const b=yl(o,m);return Math.abs(b)<c}}function rs(p){return Math.abs(p.y)>Math.abs(p.x)}class md extends jc{constructor(o){super(),this._map=o}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(o){this._lastPoints=o,rs(o[0].sub(o[1]))&&(this._valid=!1)}_move(o,c,m){const b=this._lastPoints;if(!b)return;const T=o[0].sub(b[0]),I=o[1].sub(b[1]);return this._map._cooperativeGestures&&!s.isFullscreen()&&m.touches.length<3||(this._valid=this.gestureBeginsVertically(T,I,m.timeStamp),!this._valid)?void 0:(this._lastPoints=o,this._active=!0,{pitchDelta:(T.y+I.y)/2*-.5})}gestureBeginsVertically(o,c,m){if(void 0!==this._valid)return this._valid;const b=o.mag()>=2,T=c.mag()>=2;if(!b&&!T)return;if(!b||!T)return null==this._firstMove&&(this._firstMove=m),m-this._firstMove<100&&void 0;const I=o.y>0==c.y>0;return rs(o)&&rs(c)&&I}}const fc={panStep:100,bearingStep:15,pitchStep:10};class gd{constructor(){const o=fc;this._panStep=o.panStep,this._bearingStep=o.bearingStep,this._pitchStep=o.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(o){if(o.altKey||o.ctrlKey||o.metaKey)return;let c=0,m=0,b=0,T=0,I=0;switch(o.keyCode){case 61:case 107:case 171:case 187:c=1;break;case 189:case 109:case 173:c=-1;break;case 37:o.shiftKey?m=-1:(o.preventDefault(),T=-1);break;case 39:o.shiftKey?m=1:(o.preventDefault(),T=1);break;case 38:o.shiftKey?b=1:(o.preventDefault(),I=-1);break;case 40:o.shiftKey?b=-1:(o.preventDefault(),I=1);break;default:return}return this._rotationDisabled&&(m=0,b=0),{cameraAnimation:O=>{const N=O.getZoom();O.easeTo({duration:300,easeId:"keyboardHandler",easing:_d,zoom:c?Math.round(N)+c*(o.shiftKey?2:1):N,bearing:O.getBearing()+m*this._bearingStep,pitch:O.getPitch()+b*this._pitchStep,offset:[-T*this._panStep,-I*this._panStep],center:O.getCenter()},{originalEvent:o})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function _d(p){return p*(2-p)}const mc=4.000244140625;class $c{constructor(o,c){this._map=o,this._el=o.getCanvasContainer(),this._handler=c,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,s.bindAll(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(o){this._defaultZoomRate=o}setWheelZoomRate(o){this._wheelZoomRate=o}isEnabled(){return!!this._enabled}isActive(){return this._active||void 0!==this._finishTimeout}isZooming(){return!!this._zooming}enable(o){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!o&&"center"===o.around,this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(o){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(o.ctrlKey||o.metaKey||this.isZooming()||s.isFullscreen()))return void this._showBlockerAlert();"hidden"!==this._alertContainer.style.visibility&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let c=o.deltaMode===s.window.WheelEvent.DOM_DELTA_LINE?40*o.deltaY:o.deltaY;const m=s.exported.now(),b=m-(this._lastWheelEventTime||0);this._lastWheelEventTime=m,0!==c&&c%mc==0?this._type="wheel":0!==c&&Math.abs(c)<4?this._type="trackpad":b>400?(this._type=null,this._lastValue=c,this._timeout=setTimeout(this._onTimeout,40,o)):this._type||(this._type=Math.abs(b*c)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,c+=this._lastValue)),o.shiftKey&&c&&(c/=4),this._type&&(this._lastWheelEvent=o,this._delta-=c,this._active||this._start(o)),o.preventDefault()}_onTimeout(o){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(o)}_start(o){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const c=Ne(this._el,o);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:c,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const o=this._map.transform;"wheel"===this._type&&o.projection.wrap&&(o._center.lng>=180||o._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const c=()=>o._terrainEnabled()&&this._aroundCoord?o.computeZoomRelativeTo(this._aroundCoord):o.zoom;if(0!==this._delta){const N="wheel"===this._type&&Math.abs(this._delta)>mc?this._wheelZoomRate:this._defaultZoomRate;let H=2/(1+Math.exp(-Math.abs(this._delta*N)));this._delta<0&&0!==H&&(H=1/H);const $=c(),ce=Math.pow(2,$),Ie="number"==typeof this._targetZoom?o.zoomScale(this._targetZoom):ce;this._targetZoom=Math.min(o.maxZoom,Math.max(o.minZoom,o.scaleZoom(Ie*H))),"wheel"===this._type&&(this._startZoom=$,this._easing=this._smoothOutEasing(200)),this._delta=0}const m="number"==typeof this._targetZoom?this._targetZoom:c(),b=this._startZoom,T=this._easing;let I,O=!1;if("wheel"===this._type&&b&&T){const N=Math.min((s.exported.now()-this._lastWheelEventTime)/200,1),H=T(N);I=s.number(b,m,H),N<1?this._frameId||(this._frameId=!0):O=!0}else I=m,O=!0;return this._active=!0,O&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!O,zoomDelta:I-c(),around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(o){let c=s.ease;if(this._prevEase){const m=this._prevEase,b=(s.exported.now()-m.start)/m.duration,T=m.easing(b+.01)-m.easing(b),I=.27/Math.sqrt(T*T+1e-4)*.01,O=Math.sqrt(.0729-I*I);c=s.bezier(I,O,.25,1)}return this._prevEase={start:s.exported.now(),duration:o,easing:c},c}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=fe("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(s.window.navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","null")},200)}}class Hc{constructor(o,c){this._clickZoom=o,this._tapZoom=c}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class es{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(o,c){return o.preventDefault(),{cameraAnimation:m=>{m.easeTo({duration:300,zoom:m.getZoom()+(o.shiftKey?-1:1),around:m.unproject(c)},{originalEvent:o})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class _u{constructor(){this._tap=new hc({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(o,c,m){this._swipePoint||(this._tapTime&&o.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?m.length>0&&(this._swipePoint=c[0],this._swipeTouch=m[0].identifier):this._tap.touchstart(o,c,m))}touchmove(o,c,m){if(this._tapTime){if(this._swipePoint){if(m[0].identifier!==this._swipeTouch)return;const b=c[0],T=b.y-this._swipePoint.y;return this._swipePoint=b,o.preventDefault(),this._active=!0,{zoomDelta:T/128}}}else this._tap.touchmove(o,c,m)}touchend(o,c,m){this._tapTime?this._swipePoint&&0===m.length&&this.reset():this._tap.touchend(o,c,m)&&(this._tapTime=o.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Gc{constructor(o,c,m){this._el=o,this._mousePan=c,this._touchPan=m}enable(o){this._inertiaOptions=o||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Wc{constructor(o,c,m){this._pitchWithRotate=o.pitchWithRotate,this._mouseRotate=c,this._mousePitch=m}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class yu{constructor(o,c,m,b){this._el=o,this._touchZoom=c,this._touchRotate=m,this._tapDragZoom=b,this._rotationDisabled=!1,this._enabled=!0}enable(o){this._touchZoom.enable(o),this._rotationDisabled||this._touchRotate.enable(o),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Bs=p=>p.zoom||p.drag||p.pitch||p.rotate;class qc extends s.Event{}class vu{constructor(){this.constants=[1,1,.01],this.radius=0}setup(o,c){const m=s.sub([],c,o);this.radius=s.length(m[2]<0?s.div([],m,this.constants):[m[0],m[1],0])}projectRay(o){s.div(o,o,this.constants),s.normalize(o,o),s.mul$1(o,o,this.constants);const c=s.scale$2([],o,this.radius);if(c[2]>0){const m=s.scale$2([],[0,0,1],s.dot(c,[0,0,1])),b=s.scale$2([],s.normalize([],[c[0],c[1],0]),this.radius),T=s.add([],c,s.scale$2([],s.sub([],s.add([],b,m),c),2));c[0]=T[0],c[1]=T[1]}return c}}function Ns(p){return p.panDelta&&p.panDelta.mag()||p.zoomDelta||p.bearingDelta||p.pitchDelta}class _a{constructor(o,c){this._map=o,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new gu(o),this._bearingSnap=c.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new vu,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(c),s.bindAll(["handleEvent","handleWindowEvent"],this);const m=this._el;this._listeners=[[m,"touchstart",{passive:!0}],[m,"touchmove",{passive:!1}],[m,"touchend",void 0],[m,"touchcancel",void 0],[m,"mousedown",void 0],[m,"mousemove",void 0],[m,"mouseup",void 0],[s.window.document,"mousemove",{capture:!0}],[s.window.document,"mouseup",void 0],[m,"mouseover",void 0],[m,"mouseout",void 0],[m,"dblclick",void 0],[m,"click",void 0],[m,"keydown",{capture:!1}],[m,"keyup",void 0],[m,"wheel",{passive:!1}],[m,"contextmenu",void 0],[s.window,"blur",void 0]];for(const[b,T,I]of this._listeners)b.addEventListener(T,b===s.window.document?this.handleWindowEvent:this.handleEvent,I)}destroy(){for(const[o,c,m]of this._listeners)o.removeEventListener(c,o===s.window.document?this.handleWindowEvent:this.handleEvent,m)}_addDefaultHandlers(o){const c=this._map,m=c.getCanvasContainer();this._add("mapEvent",new Zc(c,o));const b=c.boxZoom=new Hn(c,o);this._add("boxZoom",b);const T=new jr,I=new es;c.doubleClickZoom=new Hc(I,T),this._add("tapZoom",T),this._add("clickZoom",I);const O=new _u;this._add("tapDragZoom",O);const N=c.touchPitch=new md(c);this._add("touchPitch",N);const H=new Fs(o),$=new jl(o);c.dragRotate=new Wc(o,H,$),this._add("mouseRotate",H,["mousePitch"]),this._add("mousePitch",$,["mouseRotate"]);const ce=new ks(o),Ie=new Vc(c,o);c.dragPan=new Gc(m,ce,Ie),this._add("mousePan",ce),this._add("touchPan",Ie,["touchZoom","touchRotate"]);const je=new Xa,Ke=new aa;c.touchZoomRotate=new yu(m,Ke,je,O),this._add("touchRotate",je,["touchPan","touchZoom"]),this._add("touchZoom",Ke,["touchPan","touchRotate"]),this._add("blockableMapEvent",new dc(c));const Ye=c.scrollZoom=new $c(c,this);this._add("scrollZoom",Ye,["mousePan"]);const nt=c.keyboard=new gd;this._add("keyboard",nt);for(const ue of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])o.interactive&&o[ue]&&c[ue].enable(o[ue])}_add(o,c,m){this._handlers.push({handlerName:o,handler:c,allowed:m}),this._handlersById[o]=c}stop(o){if(!this._updatingCamera){for(const{handler:c}of this._handlers)c.reset();this._inertia.clear(),this._fireEvents({},{},o),this._changes=[]}}isActive(){for(const{handler:o}of this._handlers)if(o.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Bs(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(o,c,m){for(const b in o)if(b!==m&&(!c||c.indexOf(b)<0))return!0;return!1}handleWindowEvent(o){this.handleEvent(o,`${o.type}Window`)}_getMapTouches(o){const c=[];for(const m of o)this._el.contains(m.target)&&c.push(m);return c}handleEvent(o,c){this._updatingCamera=!0;const m="renderFrame"===o.type,b=m?void 0:o,T={needsRenderFrame:!1},I={},O={},N=o.touches?this._getMapTouches(o.touches):void 0,H=N?qe(this._el,N):m?void 0:Ne(this._el,o);for(const{handlerName:Ie,handler:je,allowed:Ke}of this._handlers){if(!je.isEnabled())continue;let Ye;this._blockedByActive(O,Ke,Ie)?je.reset():je[c||o.type]&&(Ye=je[c||o.type](o,H,N),this.mergeHandlerResult(T,I,Ye,Ie,b),Ye&&Ye.needsRenderFrame&&this._triggerRenderFrame()),(Ye||je.isActive())&&(O[Ie]=je)}const $={};for(const Ie in this._previousActiveHandlers)O[Ie]||($[Ie]=b);this._previousActiveHandlers=O,(Object.keys($).length||Ns(T))&&(this._changes.push([T,I,$]),this._triggerRenderFrame()),(Object.keys(O).length||Ns(T))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:ce}=T;ce&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],ce(this._map))}mergeHandlerResult(o,c,m,b,T){if(!m)return;s.extend(o,m);const I={handlerName:b,originalEvent:m.originalEvent||T};void 0!==m.zoomDelta&&(c.zoom=I),void 0!==m.panDelta&&(c.drag=I),void 0!==m.pitchDelta&&(c.pitch=I),void 0!==m.bearingDelta&&(c.rotate=I)}_applyChanges(){const o={},c={},m={};for(const[b,T,I]of this._changes)b.panDelta&&(o.panDelta=(o.panDelta||new s.Point(0,0))._add(b.panDelta)),b.zoomDelta&&(o.zoomDelta=(o.zoomDelta||0)+b.zoomDelta),b.bearingDelta&&(o.bearingDelta=(o.bearingDelta||0)+b.bearingDelta),b.pitchDelta&&(o.pitchDelta=(o.pitchDelta||0)+b.pitchDelta),void 0!==b.around&&(o.around=b.around),void 0!==b.aroundCoord&&(o.aroundCoord=b.aroundCoord),void 0!==b.pinchAround&&(o.pinchAround=b.pinchAround),b.noInertia&&(o.noInertia=b.noInertia),s.extend(c,T),s.extend(m,I);this._updateMapTransform(o,c,m),this._changes=[]}_updateMapTransform(o,c,m){const b=this._map,T=b.transform,I=$e=>[$e.x,$e.y,$e.z];if(($e=>{const pt=this._eventsInProgress.drag;return pt&&!this._handlersById[pt.handlerName].isActive()})()&&!Ns(o)){const $e=T.zoom;T.cameraElevationReference="sea",T.recenterOnTerrain(),T.cameraElevationReference="ground",$e!==T.zoom&&this._map._update(!0)}if(T._isCameraConstrained&&b._stop(!0),!Ns(o))return void this._fireEvents(c,m,!0);let{panDelta:O,zoomDelta:N,bearingDelta:H,pitchDelta:$,around:ce,aroundCoord:Ie,pinchAround:je}=o;T._isCameraConstrained&&(N>0&&(N=0),T._isCameraConstrained=!1),void 0!==je&&(ce=je),(N||($e=>c.drag&&!this._eventsInProgress.drag)())&&ce&&(this._dragOrigin=I(T.pointCoordinate3D(ce)),this._trackingEllipsoid.setup(T._camera.position,this._dragOrigin)),T.cameraElevationReference="sea",b._stop(!0),ce=ce||b.transform.centerPoint,H&&(T.bearing+=H),$&&(T.pitch+=$),T._updateCameraState();const Ke=[0,0,0];if(O)if("mercator"===T.projection.name){const $e=this._trackingEllipsoid.projectRay(T.screenPointToMercatorRay(ce).dir),pt=this._trackingEllipsoid.projectRay(T.screenPointToMercatorRay(ce.sub(O)).dir);Ke[0]=pt[0]-$e[0],Ke[1]=pt[1]-$e[1]}else{const $e=T.pointCoordinate(ce);if("globe"===T.projection.name){O=O.rotate(-T.angle);const pt=T._pixelsPerMercatorPixel/T.worldSize;Ke[0]=-O.x*s.mercatorScale(s.latFromMercatorY($e.y))*pt,Ke[1]=-O.y*s.mercatorScale(T.center.lat)*pt}else{const pt=T.pointCoordinate(ce.sub(O));$e&&pt&&(Ke[0]=pt.x-$e.x,Ke[1]=pt.y-$e.y)}}const Ye=T.zoom,nt=[0,0,0];if(N){const $e=I(Ie||T.pointCoordinate3D(ce)),pt={dir:s.normalize([],s.sub([],$e,T._camera.position))};if(pt.dir[2]<0){const ht=T.zoomDeltaToMovement($e,N);s.scale$2(nt,pt.dir,ht)}}const ue=s.add(Ke,Ke,nt);T._translateCameraConstrained(ue),N&&Math.abs(T.zoom-Ye)>1e-4&&T.recenterOnTerrain(),T.cameraElevationReference="ground",this._map._update(),o.noInertia||this._inertia.record(o),this._fireEvents(c,m,!0)}_fireEvents(o,c,m){const b=Bs(this._eventsInProgress),T=Bs(o),I={};for(const $ in o){const{originalEvent:ce}=o[$];this._eventsInProgress[$]||(I[`${$}start`]=ce),this._eventsInProgress[$]=o[$]}!b&&T&&this._fireEvent("movestart",T.originalEvent);for(const $ in I)this._fireEvent($,I[$]);T&&this._fireEvent("move",T.originalEvent);for(const $ in o){const{originalEvent:ce}=o[$];this._fireEvent($,ce)}const O={};let N;for(const $ in this._eventsInProgress){const{handlerName:ce,originalEvent:Ie}=this._eventsInProgress[$];this._handlersById[ce].isActive()||(delete this._eventsInProgress[$],N=c[ce]||Ie,O[`${$}end`]=N)}for(const $ in O)this._fireEvent($,O[$]);const H=Bs(this._eventsInProgress);if(m&&(b||T)&&!H){this._updatingCamera=!0;const $=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),ce=Ie=>0!==Ie&&-this._bearingSnap<Ie&&Ie<this._bearingSnap;$?(ce($.bearing||this._map.getBearing())&&($.bearing=0),this._map.easeTo($,{originalEvent:N})):(this._map.fire(new s.Event("moveend",{originalEvent:N})),ce(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(o,c){this._map.fire(new s.Event(o,c?{originalEvent:c}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(o=>{this._frameId=void 0,this.handleEvent(new qc("renderFrame",{timeStamp:o})),this._applyChanges()})}_triggerRenderFrame(){void 0===this._frameId&&(this._frameId=this._requestFrame())}}const za="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class qr extends s.Evented{constructor(o,c){super(),this._moving=!1,this._zooming=!1,this.transform=o,this._bearingSnap=c.bearingSnap,this._respectPrefersReducedMotion=!1!==c.respectPrefersReducedMotion,s.bindAll(["_renderFrameCallback"],this)}getCenter(){return new s.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(o,c){return this.jumpTo({center:o},c)}panBy(o,c,m){return o=s.Point.convert(o).mult(-1),this.panTo(this.transform.center,s.extend({offset:o},c),m)}panTo(o,c,m){return this.easeTo(s.extend({center:o},c),m)}getZoom(){return this.transform.zoom}setZoom(o,c){return this.jumpTo({zoom:o},c),this}zoomTo(o,c,m){return this.easeTo(s.extend({zoom:o},c),m)}zoomIn(o,c){return this.zoomTo(this.getZoom()+1,o,c),this}zoomOut(o,c){return this.zoomTo(this.getZoom()-1,o,c),this}getBearing(){return this.transform.bearing}setBearing(o,c){return this.jumpTo({bearing:o},c),this}getPadding(){return this.transform.padding}setPadding(o,c){return this.jumpTo({padding:o},c),this}rotateTo(o,c,m){return this.easeTo(s.extend({bearing:o},c),m)}resetNorth(o,c){return this.rotateTo(0,s.extend({duration:1e3},o),c),this}resetNorthPitch(o,c){return this.easeTo(s.extend({bearing:0,pitch:0,duration:1e3},o),c),this}snapToNorth(o,c){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(o,c):this}getPitch(){return this.transform.pitch}setPitch(o,c){return this.jumpTo({pitch:o},c),this}cameraForBounds(o,c){o=s.LngLatBounds.convert(o);const m=c&&c.bearing||0,b=c&&c.pitch||0,T=o.getNorthWest(),I=o.getSouthEast();return this._cameraForBounds(this.transform,T,I,m,b,c)}_extendCameraOptions(o){const c={top:0,bottom:0,right:0,left:0};if("number"==typeof(o=s.extend({padding:c,offset:[0,0],maxZoom:this.transform.maxZoom},o)).padding){const m=o.padding;o.padding={top:m,bottom:m,right:m,left:m}}return o.padding=s.extend(c,o.padding),o}_minimumAABBFrustumDistance(o,c){const m=c.max[0]-c.min[0],b=c.max[1]-c.min[1];return m/b>o.aspect?m/(2*Math.tan(.5*o.fovX)*o.aspect):b/(2*Math.tan(.5*o.fovY)*o.aspect)}_cameraForBoundsOnGlobe(o,c,m,b,T,I){const O=o.clone(),N=this._extendCameraOptions(I);O.bearing=b,O.pitch=T;const H=s.LngLat.convert(c),$=s.LngLat.convert(m),ce=.5*(H.lat+$.lat),Ie=.5*(H.lng+$.lng),je=s.latLngToECEF(ce,Ie),Ke=s.normalize([],je),Ye=s.normalize([],s.cross([],Ke,[0,1,0])),nt=s.cross([],Ye,Ke),ue=[Ye[0],Ye[1],Ye[2],0,nt[0],nt[1],nt[2],0,Ke[0],Ke[1],Ke[2],0,0,0,0,1],$e=[je,s.latLngToECEF(H.lat,H.lng),s.latLngToECEF($.lat,H.lng),s.latLngToECEF($.lat,$.lng),s.latLngToECEF(H.lat,$.lng),s.latLngToECEF(ce,H.lng),s.latLngToECEF(ce,$.lng),s.latLngToECEF(H.lat,Ie),s.latLngToECEF($.lat,Ie)];let pt=s.Aabb.fromPoints($e.map(Bn=>[s.dot(Ye,Bn),s.dot(nt,Bn),s.dot(Ke,Bn)]));const ht=s.transformMat4([],pt.center,ue);0===s.squaredLength(ht)&&s.set(ht,0,0,1),s.normalize(ht,ht),s.scale$2(ht,ht,s.GLOBE_RADIUS),O.center=s.ecefToLatLng(ht);const Ot=O.getWorldToCameraMatrix(),kt=s.invert(new Float64Array(16),Ot);pt=s.Aabb.applyTransform(pt,s.multiply([],Ot,ue)),s.transformMat4(ht,ht,Ot);const Rt=.5*(pt.max[2]-pt.min[2]),Yt=this._minimumAABBFrustumDistance(O,pt),$t=s.scale$2([],[0,0,1],Rt),ln=s.add($t,ht,$t),Gn=Yt+(0===O.pitch?0:s.distance(ht,ln)),on=O.globeCenterInViewSpace,An=s.sub([],ht,[on[0],on[1],on[2]]);s.normalize(An,An),s.scale$2(An,An,Gn);const hn=s.add([],ht,An);s.transformMat4(hn,hn,kt);const jn=s.earthRadius/s.GLOBE_RADIUS,cn=s.length(hn),Mn=s.mercatorZfromAltitude(Math.max(cn*jn-s.earthRadius,Number.EPSILON),0),Vn=Math.min(O.zoomFromMercatorZAdjusted(Mn),N.maxZoom);return Vn>.5*(s.GLOBE_ZOOM_THRESHOLD_MIN+s.GLOBE_ZOOM_THRESHOLD_MAX)?(O.setProjection({name:"mercator"}),O.zoom=Vn,this._cameraForBounds(O,c,m,b,T,I)):{center:O.center,zoom:Vn,bearing:b,pitch:T}}queryTerrainElevation(o,c){const m=this.transform.elevation;return m?(c=s.extend({},{exaggerated:!0},c),m.getAtPoint(s.MercatorCoordinate.fromLngLat(o),null,c.exaggerated)):null}_cameraForBounds(o,c,m,b,T,I){if("globe"===o.projection.name)return this._cameraForBoundsOnGlobe(o,c,m,b,T,I);const O=o.clone(),N=this._extendCameraOptions(I),H=O.padding;O.bearing=b,O.pitch=T;const $=s.LngLat.convert(c),ce=s.LngLat.convert(m),Ie=new s.LngLat($.lng,ce.lat),je=new s.LngLat(ce.lng,$.lat),Ke=O.project($),Ye=O.project(ce),nt=this.queryTerrainElevation($),ue=this.queryTerrainElevation(ce),$e=this.queryTerrainElevation(Ie),pt=this.queryTerrainElevation(je),ht=[[Ke.x,Ke.y,Math.min(nt||0,ue||0,$e||0,pt||0)],[Ye.x,Ye.y,Math.max(nt||0,ue||0,$e||0,pt||0)]];let Ot=s.Aabb.fromPoints(ht);const kt=O.getWorldToCameraMatrix(),Rt=s.invert(new Float64Array(16),kt);Ot=s.Aabb.applyTransform(Ot,kt);const Yt=s.sub([],Ot.max,Ot.min),$t=H.left||0,ln=H.right||0,Gn=H.bottom||0,on=H.top||0,{left:An,right:hn,top:jn,bottom:cn}=N.padding,Mn=.5*($t+ln),Vn=.5*(on+Gn),Bn=Math.min(O.scaleZoom(O.scale*Math.min((O.width-($t+ln+An+hn))/Yt[0],(O.height-(Gn+on+cn+jn))/Yt[1])),N.maxZoom),qn=O.scale/O.zoomScale(Bn);Ot=new s.Aabb([Ot.min[0]-(An+Mn)*qn,Ot.min[1]-(cn+Vn)*qn,Ot.min[2]],[Ot.max[0]+(hn+Mn)*qn,Ot.max[1]+(jn+Vn)*qn,Ot.max[2]]);const Ti=.5*Yt[2],Vi=this._minimumAABBFrustumDistance(O,Ot),_i=[0,0,1,0];s.transformMat4$1(_i,_i,kt),s.normalize$2(_i,_i);const Oi=s.scale$2([],_i,Vi+Ti),po=s.add([],Ot.center,Oi),mo=("number"==typeof N.offset.x&&"number"==typeof N.offset.y?new s.Point(N.offset.x,N.offset.y):s.Point.convert(N.offset)).rotate(-s.degToRad(b));Ot.center[0]-=mo.x*qn,Ot.center[1]+=mo.y*qn,s.transformMat4(Ot.center,Ot.center,Rt),s.transformMat4(po,po,Rt);const bi=[Ot.center[0],Ot.center[1],po[2]*O.pixelsPerMeter];s.scale$2(bi,bi,1/O.worldSize);const Fo=s.lngFromMercatorX(bi[0]),Bo=s.latFromMercatorY(bi[1]),No=Math.min(O._zoomFromMercatorZ(bi[2]),N.maxZoom),zo=new s.LngLat(Fo,Bo);return O.mercatorFromTransition&&No<.5*(s.GLOBE_ZOOM_THRESHOLD_MIN+s.GLOBE_ZOOM_THRESHOLD_MAX)?(O.setProjection({name:"globe"}),O.zoom=No,this._cameraForBounds(O,c,m,b,T,I)):{center:zo,zoom:No,bearing:b,pitch:T}}fitBounds(o,c,m){const b=this.cameraForBounds(o,c);return this._fitInternal(b,c,m)}fitScreenCoordinates(o,c,m,b,T){const I=s.Point.convert(o),O=s.Point.convert(c),N=new s.Point(Math.min(I.x,O.x),Math.min(I.y,O.y)),H=new s.Point(Math.max(I.x,O.x),Math.max(I.y,O.y));if("mercator"===this.transform.projection.name&&this.transform.anyCornerOffEdge(I,O))return this;const $=this.transform.pointLocation3D(N),ce=this.transform.pointLocation3D(H),Ie=this.transform.pointLocation3D(new s.Point(N.x,H.y)),je=this.transform.pointLocation3D(new s.Point(H.x,N.y)),Ke=[Math.min($.lng,ce.lng,Ie.lng,je.lng),Math.min($.lat,ce.lat,Ie.lat,je.lat)],Ye=[Math.max($.lng,ce.lng,Ie.lng,je.lng),Math.max($.lat,ce.lat,Ie.lat,je.lat)],nt=b&&b.pitch?b.pitch:this.getPitch(),ue=this._cameraForBounds(this.transform,Ke,Ye,m,nt,b);return this._fitInternal(ue,b,T)}_fitInternal(o,c,m){return o?(delete(c=s.extend(o,c)).padding,c.linear?this.easeTo(c,m):this.flyTo(c,m)):this}jumpTo(o,c){this.stop();const m=o.preloadOnly?this.transform.clone():this.transform;let b=!1,T=!1,I=!1;return"zoom"in o&&m.zoom!==+o.zoom&&(b=!0,m.zoom=+o.zoom),void 0!==o.center&&(m.center=s.LngLat.convert(o.center)),"bearing"in o&&m.bearing!==+o.bearing&&(T=!0,m.bearing=+o.bearing),"pitch"in o&&m.pitch!==+o.pitch&&(I=!0,m.pitch=+o.pitch),null==o.padding||m.isPaddingEqual(o.padding)||(m.padding=o.padding),o.preloadOnly?(this._preloadTiles(m),this):(this.fire(new s.Event("movestart",c)).fire(new s.Event("move",c)),b&&this.fire(new s.Event("zoomstart",c)).fire(new s.Event("zoom",c)).fire(new s.Event("zoomend",c)),T&&this.fire(new s.Event("rotatestart",c)).fire(new s.Event("rotate",c)).fire(new s.Event("rotateend",c)),I&&this.fire(new s.Event("pitchstart",c)).fire(new s.Event("pitch",c)).fire(new s.Event("pitchend",c)),this.fire(new s.Event("moveend",c)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||s.warnOnce(za),this.transform.getFreeCameraOptions()}setFreeCameraOptions(o,c){const m=this.transform;if(!m.projection.supportsFreeCamera)return s.warnOnce(za),this;this.stop();const b=m.zoom,T=m.pitch,I=m.bearing;m.setFreeCameraOptions(o);const O=b!==m.zoom,N=T!==m.pitch,H=I!==m.bearing;return this.fire(new s.Event("movestart",c)).fire(new s.Event("move",c)),O&&this.fire(new s.Event("zoomstart",c)).fire(new s.Event("zoom",c)).fire(new s.Event("zoomend",c)),H&&this.fire(new s.Event("rotatestart",c)).fire(new s.Event("rotate",c)).fire(new s.Event("rotateend",c)),N&&this.fire(new s.Event("pitchstart",c)).fire(new s.Event("pitch",c)).fire(new s.Event("pitchend",c)),this.fire(new s.Event("moveend",c)),this}easeTo(o,c){this._stop(!1,o.easeId),(!1===(o=s.extend({offset:[0,0],duration:500,easing:s.ease},o)).animate||this._prefersReducedMotion(o))&&(o.duration=0);const m=this.transform,b=this.getZoom(),T=this.getBearing(),I=this.getPitch(),O=this.getPadding(),N="zoom"in o?+o.zoom:b,H="bearing"in o?this._normalizeBearing(o.bearing,T):T,$="pitch"in o?+o.pitch:I,ce="padding"in o?o.padding:m.padding,Ie=s.Point.convert(o.offset);let je,Ke,Ye;if("globe"===m.projection.name){const $t=s.MercatorCoordinate.fromLngLat(m.center),ln=Ie.rotate(-m.angle);$t.x+=ln.x/m.worldSize,$t.y+=ln.y/m.worldSize;const Gn=$t.toLngLat(),on=s.LngLat.convert(o.center||Gn);this._normalizeCenter(on),je=m.centerPoint.add(ln),Ke=new s.Point($t.x,$t.y).mult(m.worldSize),Ye=new s.Point(s.mercatorXfromLng(on.lng),s.mercatorYfromLat(on.lat)).mult(m.worldSize).sub(Ke)}else{je=m.centerPoint.add(Ie);const $t=m.pointLocation(je),ln=s.LngLat.convert(o.center||$t);this._normalizeCenter(ln),Ke=m.project($t),Ye=m.project(ln).sub(Ke)}const nt=m.zoomScale(N-b);let ue,$e;o.around&&(ue=s.LngLat.convert(o.around),$e=m.locationPoint(ue));const pt=this._zooming||N!==b,ht=this._rotating||T!==H,Ot=this._pitching||$!==I,kt=!m.isPaddingEqual(ce),Rt=$t=>ln=>{if(pt&&($t.zoom=s.number(b,N,ln)),ht&&($t.bearing=s.number(T,H,ln)),Ot&&($t.pitch=s.number(I,$,ln)),kt&&($t.interpolatePadding(O,ce,ln),je=$t.centerPoint.add(Ie)),ue)$t.setLocationAtPoint(ue,$e);else{const Gn=$t.zoomScale($t.zoom-b),on=N>b?Math.min(2,nt):Math.max(.5,nt),An=Math.pow(on,1-ln),hn=$t.unproject(Ke.add(Ye.mult(ln*An)).mult(Gn));$t.setLocationAtPoint($t.renderWorldCopies?hn.wrap():hn,je)}return o.preloadOnly||this._fireMoveEvents(c),$t};if(o.preloadOnly){const $t=this._emulate(Rt,o.duration,m);return this._preloadTiles($t),this}const Yt={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=pt,this._rotating=ht,this._pitching=Ot,this._padding=kt,this._easeId=o.easeId,this._prepareEase(c,o.noMoveStart,Yt),this._ease(Rt(m),$t=>{m.recenterOnTerrain(),this._afterEase(c,$t)},o),this}_prepareEase(o,c,m={}){this._moving=!0,this.transform.cameraElevationReference="sea",c||m.moving||this.fire(new s.Event("movestart",o)),this._zooming&&!m.zooming&&this.fire(new s.Event("zoomstart",o)),this._rotating&&!m.rotating&&this.fire(new s.Event("rotatestart",o)),this._pitching&&!m.pitching&&this.fire(new s.Event("pitchstart",o))}_fireMoveEvents(o){this.fire(new s.Event("move",o)),this._zooming&&this.fire(new s.Event("zoom",o)),this._rotating&&this.fire(new s.Event("rotate",o)),this._pitching&&this.fire(new s.Event("pitch",o))}_afterEase(o,c){if(this._easeId&&c&&this._easeId===c)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const m=this._zooming,b=this._rotating,T=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,m&&this.fire(new s.Event("zoomend",o)),b&&this.fire(new s.Event("rotateend",o)),T&&this.fire(new s.Event("pitchend",o)),this.fire(new s.Event("moveend",o))}flyTo(o,c){if(this._prefersReducedMotion(o)){const Bn=s.pick(o,["center","zoom","bearing","pitch","around"]);return this.jumpTo(Bn,c)}this.stop(),o=s.extend({offset:[0,0],speed:1.2,curve:1.42,easing:s.ease},o);const m=this.transform,b=this.getZoom(),T=this.getBearing(),I=this.getPitch(),O=this.getPadding(),N="zoom"in o?s.clamp(+o.zoom,m.minZoom,m.maxZoom):b,H="bearing"in o?this._normalizeBearing(o.bearing,T):T,$="pitch"in o?+o.pitch:I,ce="padding"in o?o.padding:m.padding,Ie=m.zoomScale(N-b),je=s.Point.convert(o.offset);let Ke=m.centerPoint.add(je);const Ye=m.pointLocation(Ke),nt=s.LngLat.convert(o.center||Ye);this._normalizeCenter(nt);const ue=m.project(Ye),$e=m.project(nt).sub(ue);let pt=o.curve;const ht=Math.max(m.width,m.height),Ot=ht/Ie,kt=$e.mag();if("minZoom"in o){const Bn=s.clamp(Math.min(o.minZoom,b,N),m.minZoom,m.maxZoom),qn=ht/m.zoomScale(Bn-b);pt=Math.sqrt(qn/kt*2)}const Rt=pt*pt;function Yt(Bn){const qn=(Ot*Ot-ht*ht+(Bn?-1:1)*Rt*Rt*kt*kt)/(2*(Bn?Ot:ht)*Rt*kt);return Math.log(Math.sqrt(qn*qn+1)-qn)}function $t(Bn){return(Math.exp(Bn)-Math.exp(-Bn))/2}function ln(Bn){return(Math.exp(Bn)+Math.exp(-Bn))/2}const Gn=Yt(0);let on=function(Bn){return ln(Gn)/ln(Gn+pt*Bn)},An=function(Bn){return ht*((ln(Gn)*($t(qn=Gn+pt*Bn)/ln(qn))-$t(Gn))/Rt)/kt;var qn},hn=(Yt(1)-Gn)/pt;if(Math.abs(kt)<1e-6||!isFinite(hn)){if(Math.abs(ht-Ot)<1e-6)return this.easeTo(o,c);const Bn=Ot<ht?-1:1;hn=Math.abs(Math.log(Ot/ht))/pt,An=function(){return 0},on=function(qn){return Math.exp(Bn*pt*qn)}}o.duration="duration"in o?+o.duration:1e3*hn/("screenSpeed"in o?+o.screenSpeed/pt:+o.speed),o.maxDuration&&o.duration>o.maxDuration&&(o.duration=0);const jn=T!==H,cn=$!==I,Mn=!m.isPaddingEqual(ce),Vn=Bn=>qn=>{const Ti=qn*hn,Vi=1/on(Ti);Bn.zoom=1===qn?N:b+Bn.scaleZoom(Vi),jn&&(Bn.bearing=s.number(T,H,qn)),cn&&(Bn.pitch=s.number(I,$,qn)),Mn&&(Bn.interpolatePadding(O,ce,qn),Ke=Bn.centerPoint.add(je));const _i=1===qn?nt:Bn.unproject(ue.add($e.mult(An(Ti))).mult(Vi));return Bn.setLocationAtPoint(Bn.renderWorldCopies?_i.wrap():_i,Ke),Bn._updateCameraOnTerrain(),o.preloadOnly||this._fireMoveEvents(c),Bn};if(o.preloadOnly){const Bn=this._emulate(Vn,o.duration,m);return this._preloadTiles(Bn),this}return this._zooming=!0,this._rotating=jn,this._pitching=cn,this._padding=Mn,this._prepareEase(c,!1),this._ease(Vn(m),()=>this._afterEase(c),o),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(o,c){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const m=this._onEaseEnd;this._onEaseEnd=void 0,m.call(this,c)}if(!o){const m=this.handlers;m&&m.stop(!1)}return this}_ease(o,c,m){!1===m.animate||0===m.duration?(o(1),c()):(this._easeStart=s.exported.now(),this._easeOptions=m,this._onEaseFrame=o,this._onEaseEnd=c,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const o=Math.min((s.exported.now()-this._easeStart)/this._easeOptions.duration,1),c=this._onEaseFrame;c&&c(this._easeOptions.easing(o)),o<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(o,c){o=s.wrap(o,-180,180);const m=Math.abs(o-c);return Math.abs(o-360-c)<m&&(o-=360),Math.abs(o+360-c)<m&&(o+=360),o}_normalizeCenter(o){const c=this.transform;if(!c.renderWorldCopies||c.maxBounds)return;const m=o.lng-c.center.lng;o.lng+=m>180?-360:m<-180?360:0}_prefersReducedMotion(o){return this._respectPrefersReducedMotion&&s.exported.prefersReducedMotion&&!(o&&o.essential)}_emulate(o,c,m){const b=Math.ceil(15*c/1e3),T=[],I=o(m.clone());for(let O=0;O<=b;O++){const N=I(O/b);T.push(N.clone())}return T}}class ui{constructor(o={}){this.options=o,s.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(o){const c=this.options&&this.options.compact;return this._map=o,this._container=fe("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=fe("button","mapboxgl-ctrl-attrib-button",this._container),fe("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden","true"),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=fe("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),c&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),void 0===c&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(o,c){const m=this._map._getUIString(`AttributionControl.${c}`);o.setAttribute("aria-label",m),o.removeAttribute("title"),o.firstElementChild&&o.firstElementChild.setAttribute("title",m)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let o=this._editLink;o||(o=this._editLink=this._container.querySelector(".mapbox-improve-map"));const c=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||s.config.ACCESS_TOKEN}];if(o){const m=c.reduce((b,T,I)=>(T.value&&(b+=`${T.key}=${T.value}${I<c.length-1?"&":""}`),b),"?");o.href=`${s.config.FEEDBACK_URL}/${m}#${os(this._map,!0)}`,o.rel="noopener nofollow",this._setElementTitle(o,"MapFeedback")}}_updateData(o){!o||"metadata"!==o.sourceDataType&&"visibility"!==o.sourceDataType&&"style"!==o.dataType||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let o=[];if(this._map.style.stylesheet){const b=this._map.style.stylesheet;this.styleOwner=b.owner,this.styleId=b.id}const c=this._map.style._sourceCaches;for(const b in c){const T=c[b];if(T.used){const I=T.getSource();I.attribution&&o.indexOf(I.attribution)<0&&o.push(I.attribution)}}o.sort((b,T)=>b.length-T.length),o=o.filter((b,T)=>{for(let I=T+1;I<o.length;I++)if(o[I].indexOf(b)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?o=[...this.options.customAttribution,...o]:o.unshift(this.options.customAttribution));const m=o.join(" | ");m!==this._attribHTML&&(this._attribHTML=m,o.length?(this._innerContainer.innerHTML=m,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class _r{constructor(){s.bindAll(["_updateLogo","_updateCompact"],this)}onAdd(o){this._map=o,this._container=fe("div","mapboxgl-ctrl");const c=fe("a","mapboxgl-ctrl-logo");return c.target="_blank",c.rel="noopener nofollow",c.href="https://www.mapbox.com/",c.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),c.setAttribute("rel","noopener nofollow"),this._container.appendChild(c),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(o){o&&"metadata"!==o.sourceDataType||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const o=this._map.style._sourceCaches;if(0===Object.entries(o).length)return!0;for(const c in o){const m=o[c].getSource();if(m.hasOwnProperty("mapbox_logo")&&!m.mapbox_logo)return!1}return!0}_updateCompact(){const o=this._container.children;if(o.length){const c=o[0];this._map.getCanvasContainer().offsetWidth<250?c.classList.add("mapboxgl-compact"):c.classList.remove("mapboxgl-compact")}}}class xu{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(o){const c=++this._id;return this._queue.push({callback:o,id:c,cancelled:!1}),c}remove(o){const c=this._currentlyRunning,m=c?this._queue.concat(c):this._queue;for(const b of m)if(b.id===o)return void(b.cancelled=!0)}run(o=0){const c=this._currentlyRunning=this._queue;this._queue=[];for(const m of c)if(!m.cancelled&&(m.callback(o),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function Hl(p,o,c){if(p=new s.LngLat(p.lng,p.lat),o){const m=new s.LngLat(p.lng-360,p.lat),b=new s.LngLat(p.lng+360,p.lat),T=360*Math.ceil(Math.abs(p.lng-c.center.lng)/360),I=c.locationPoint(p).distSqr(o),O=o.x<0||o.y<0||o.x>c.width||o.y>c.height;c.locationPoint(m).distSqr(o)<I&&(O||Math.abs(m.lng-c.center.lng)<T)?p=m:c.locationPoint(b).distSqr(o)<I&&(O||Math.abs(b.lng-c.center.lng)<T)&&(p=b)}for(;Math.abs(p.lng-c.center.lng)>180;){const m=c.locationPoint(p);if(m.x>=0&&m.y>=0&&m.x<=c.width&&m.y<=c.height)break;p.lng>c.center.lng?p.lng-=360:p.lng+=360}return p}const vl={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class ai extends s.Evented{constructor(o,c){if(super(),(o instanceof s.window.HTMLElement||c)&&(o=s.extend({element:o},c)),s.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=o&&o.anchor||"center",this._color=o&&o.color||"#3FB1CE",this._scale=o&&o.scale||1,this._draggable=o&&o.draggable||!1,this._clickTolerance=o&&o.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=o&&o.rotation||0,this._rotationAlignment=o&&o.rotationAlignment||"auto",this._pitchAlignment=o&&o.pitchAlignment&&o.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=o&&o.occludedOpacity||.2,o&&o.element)this._element=o.element,this._offset=s.Point.convert(o&&o.offset||[0,0]);else{this._defaultMarker=!0,this._element=fe("div");const b=41,T=27,I=Se("svg",{display:"block",height:b*this._scale+"px",width:T*this._scale+"px",viewBox:`0 0 ${T} ${b}`},this._element),O=Se("radialGradient",{id:"shadowGradient"},Se("defs",{},I));Se("stop",{offset:"10%","stop-opacity":.4},O),Se("stop",{offset:"100%","stop-opacity":.05},O),Se("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},I),Se("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},I),Se("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},I),Se("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},I),this._offset=s.Point.convert(o&&o.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",b=>{b.preventDefault()}),this._element.addEventListener("mousedown",b=>{b.preventDefault()});const m=this._element.classList;for(const b in vl)m.remove(`mapboxgl-marker-anchor-${b}`);m.add(`mapboxgl-marker-anchor-${this._anchor}`),this._popup=null}addTo(o){return o===this._map||(this.remove(),this._map=o,o.getCanvasContainer().appendChild(this._element),o.on("move",this._updateMoving),o.on("moveend",this._update),o.on("remove",this._clearFadeTimer),o._addMarker(this),this.setDraggable(this._draggable),this._update(),o.on("click",this._onMapClick)),this}remove(){const o=this._map;return o&&(o.off("click",this._onMapClick),o.off("move",this._updateMoving),o.off("moveend",this._update),o.off("mousedown",this._addDragHandler),o.off("touchstart",this._addDragHandler),o.off("mouseup",this._onUp),o.off("touchend",this._onUp),o.off("mousemove",this._onMove),o.off("touchmove",this._onMove),o.off("remove",this._clearFadeTimer),o._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(o){return this._lngLat=s.LngLat.convert(o),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(o){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),o){if(!("offset"in o.options)){const b=Math.sqrt(Math.pow(13.5,2)/2);o.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[b,-1*(24.6+b)],"bottom-right":[-b,-1*(24.6+b)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=o,o._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(o){const c=o.code,m=o.charCode||o.keyCode;"Space"!==c&&"Enter"!==c&&32!==m&&13!==m||this.togglePopup()}_onMapClick(o){const c=o.originalEvent.target,m=this._element;this._popup&&(c===m||m.contains(c))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const o=this._popup;return o?(o.isOpen()?(o.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(o.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const o=this._map,c=this._pos;if(!o||!c)return!1;const m=o.unproject(c),b=o.getFreeCameraOptions();if(!b.position)return!1;const T=b.position.toLngLat();return T.distanceTo(m)<.9*T.distanceTo(this._lngLat)}_evaluateOpacity(){const o=this._map;if(!o)return;const c=this._pos;if(!c||c.x<0||c.x>o.transform.width||c.y<0||c.y>o.transform.height)return void this._clearFadeTimer();const m=o.unproject(c);let b;o._showingGlobe()&&s.isLngLatBehindGlobe(o.transform,this._lngLat)?b=0:(b=1-o._queryFogOpacity(m),o.transform._terrainEnabled()&&o.getTerrain()&&this._behindTerrain()&&(b*=this._occludedOpacity)),this._element.style.opacity=`${b}`,this._element.style.pointerEvents=b>0?"auto":"none",this._popup&&this._popup._setOpacity(b),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const o=this._pos;if(!o||!this._map)return;const c=this._offset.mult(this._scale);this._element.style.transform=`\n            translate(${o.x}px,${o.y}px)\n            ${vl[this._anchor]}\n            ${this._calculateXYTransform()} ${this._calculateZTransform()}\n            translate(${c.x}px,${c.y}px)\n        `}_calculateXYTransform(){const o=this._pos,c=this._map,m=this.getPitchAlignment();if(!c||!o||"map"!==m)return"";if(!c._showingGlobe()){const N=c.getPitch();return N?`rotateX(${N}deg)`:""}const b=s.radToDeg(s.globeTiltAtLngLat(c.transform,this._lngLat)),T=o.sub(s.globeCenterToScreenPoint(c.transform)),I=Math.abs(T.x)+Math.abs(T.y);if(0===I)return"";const O=b/I;return`rotateX(${-T.y*O}deg) rotateY(${T.x*O}deg)`}_calculateZTransform(){const o=this._pos,c=this._map;if(!c||!o)return"";let m=0;const b=this.getRotationAlignment();if("map"===b)if(c._showingGlobe()){const T=c.project(new s.LngLat(this._lngLat.lng,this._lngLat.lat+.001)),I=c.project(new s.LngLat(this._lngLat.lng,this._lngLat.lat-.001)).sub(T);m=s.radToDeg(Math.atan2(I.y,I.x))-90}else m=-c.getBearing();else if("horizon"===b){const T=s.smoothstep(4,6,c.getZoom()),I=s.globeCenterToScreenPoint(c.transform);I.y+=T*c.transform.height;const O=o.sub(I),N=s.radToDeg(Math.atan2(O.y,O.x));m=(N>90?N-270:N+90)*(1-T)}return m+=this._rotation,m?`rotateZ(${m}deg)`:""}_update(o){s.window.cancelAnimationFrame(this._updateFrameId);const c=this._map;c&&(c.transform.renderWorldCopies&&(this._lngLat=Hl(this._lngLat,this._pos,c.transform)),this._pos=c.project(this._lngLat),!0===o?this._updateFrameId=s.window.requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),c._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(c._showingGlobe()||c.getTerrain()||c.getFog())&&!this._fadeTimer&&(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(o){return this._offset=s.Point.convert(o),this._update(),this}_onMove(o){const c=this._map;if(!c)return;const m=this._pointerdownPos,b=this._positionDelta;if(m&&b){if(!this._isDragging){const T=this._clickTolerance||c._clickTolerance;if(o.point.dist(m)<T)return;this._isDragging=!0}this._pos=o.point.sub(b),this._lngLat=c.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new s.Event("dragstart"))),this.fire(new s.Event("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const o=this._map;o&&(o.off("mousemove",this._onMove),o.off("touchmove",this._onMove)),"active"===this._state&&this.fire(new s.Event("dragend")),this._state="inactive"}_addDragHandler(o){const c=this._map,m=this._pos;c&&m&&this._element.contains(o.originalEvent.target)&&(o.preventDefault(),this._positionDelta=o.point.sub(m),this._pointerdownPos=o.point,this._state="pending",c.on("mousemove",this._onMove),c.on("touchmove",this._onMove),c.once("mouseup",this._onUp),c.once("touchend",this._onUp))}setDraggable(o){this._draggable=!!o;const c=this._map;return c&&(o?(c.on("mousedown",this._addDragHandler),c.on("touchstart",this._addDragHandler)):(c.off("mousedown",this._addDragHandler),c.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(o){return this._rotation=o||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(o){return this._rotationAlignment=o||"auto",this._update(),this}getRotationAlignment(){return"auto"===this._rotationAlignment||"horizon"===this._rotationAlignment&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(o){return this._pitchAlignment=o||"auto",this._update(),this}getPitchAlignment(){return"auto"===this._pitchAlignment?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(o){return this._occludedOpacity=o||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const L={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},B=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function A(p=new s.Point(0,0),o="bottom"){if("number"==typeof p){const c=Math.round(Math.sqrt(.5*Math.pow(p,2)));switch(o){case"top":return new s.Point(0,p);case"top-left":return new s.Point(c,c);case"top-right":return new s.Point(-c,c);case"bottom":return new s.Point(0,-p);case"bottom-left":return new s.Point(c,-c);case"bottom-right":return new s.Point(-c,-c);case"left":return new s.Point(p,0);case"right":return new s.Point(-p,0)}return new s.Point(0,0)}return p instanceof s.Point||Array.isArray(p)?s.Point.convert(p):s.Point.convert(p[o]||[0,0])}class U{constructor(o){this.jumpTo(o)}getValue(o){if(o<=this._startTime)return this._start;if(o>=this._endTime)return this._end;const c=s.easeCubicInOut((o-this._startTime)/(this._endTime-this._startTime));return this._start*(1-c)+this._end*c}isEasing(o){return o>=this._startTime&&o<=this._endTime}jumpTo(o){this._startTime=-1/0,this._endTime=-1/0,this._start=o,this._end=o}easeTo(o,c,m){this._start=this.getValue(c),this._end=o,this._startTime=c,this._endTime=c+m}}const le={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use \u2318 + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},Fe={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,optimizeForTerrain:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0},We={showCompass:!0,showZoom:!0,visualizePitch:!1};class Jt{constructor(o,c,m=!1){this._clickTolerance=10,this.element=c,this.mouseRotate=new Fs({clickTolerance:o.dragRotate._mouseRotate._clickTolerance}),this.map=o,m&&(this.mousePitch=new jl({clickTolerance:o.dragRotate._mousePitch._clickTolerance})),s.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),c.addEventListener("mousedown",this.mousedown),c.addEventListener("touchstart",this.touchstart,{passive:!1}),c.addEventListener("touchmove",this.touchmove),c.addEventListener("touchend",this.touchend),c.addEventListener("touchcancel",this.reset)}down(o,c){this.mouseRotate.mousedown(o,c),this.mousePitch&&this.mousePitch.mousedown(o,c),Ee()}move(o,c){const m=this.map,b=this.mouseRotate.mousemoveWindow(o,c),T=b&&b.bearingDelta;if(T&&m.setBearing(m.getBearing()+T),this.mousePitch){const I=this.mousePitch.mousemoveWindow(o,c),O=I&&I.pitchDelta;O&&m.setPitch(m.getPitch()+O)}}off(){const o=this.element;o.removeEventListener("mousedown",this.mousedown),o.removeEventListener("touchstart",this.touchstart,{passive:!1}),o.removeEventListener("touchmove",this.touchmove),o.removeEventListener("touchend",this.touchend),o.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){_e(),s.window.removeEventListener("mousemove",this.mousemove),s.window.removeEventListener("mouseup",this.mouseup)}mousedown(o){this.down(s.extend({},o,{ctrlKey:!0,preventDefault:()=>o.preventDefault()}),Ne(this.element,o)),s.window.addEventListener("mousemove",this.mousemove),s.window.addEventListener("mouseup",this.mouseup)}mousemove(o){this.move(o,Ne(this.element,o))}mouseup(o){this.mouseRotate.mouseupWindow(o),this.mousePitch&&this.mousePitch.mouseupWindow(o),this.offTemp()}touchstart(o){1!==o.targetTouches.length?this.reset():(this._startPos=this._lastPos=qe(this.element,o.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>o.preventDefault()},this._startPos))}touchmove(o){1!==o.targetTouches.length?this.reset():(this._lastPos=qe(this.element,o.targetTouches)[0],this.move({preventDefault:()=>o.preventDefault()},this._lastPos))}touchend(o){0===o.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const Rn={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},fi={maxWidth:100,unit:"metric"},Mi={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"},Io={version:s.version,supported:ie,setRTLTextPlugin:s.setRTLTextPlugin,getRTLTextPluginStatus:s.getRTLTextPluginStatus,Map:class extends qr{constructor(p){if(s.LivePerformanceUtils.mark(s.PerformanceMarkers.create),null!=(p=s.extend({},Fe,p)).minZoom&&null!=p.maxZoom&&p.minZoom>p.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=p.minPitch&&null!=p.maxPitch&&p.minPitch>p.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=p.minPitch&&p.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(null!=p.maxPitch&&p.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(p.antialias&&s.isSafariWithAntialiasingBug(s.window)&&(p.antialias=!1,s.warnOnce("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new fs(p.minZoom,p.maxZoom,p.minPitch,p.maxPitch,p.renderWorldCopies),p),this._interactive=p.interactive,this._minTileCacheSize=p.minTileCacheSize,this._maxTileCacheSize=p.maxTileCacheSize,this._failIfMajorPerformanceCaveat=p.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=p.preserveDrawingBuffer,this._antialias=p.antialias,this._useWebGL2=p.useWebGL2,this._trackResize=p.trackResize,this._bearingSnap=p.bearingSnap,this._refreshExpiredTiles=p.refreshExpiredTiles,this._fadeDuration=p.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=p.crossSourceCollisions,this._collectResourceTiming=p.collectResourceTiming,this._optimizeForTerrain=p.optimizeForTerrain,this._language=this._parseLanguage(p.language),this._worldview=p.worldview,this._renderTaskQueue=new xu,this._domRenderTaskQueue=new xu,this._controls=[],this._markers=[],this._popups=[],this._mapId=s.uniqueId(),this._locale=s.extend({},le,p.locale),this._clickTolerance=p.clickTolerance,this._cooperativeGestures=p.cooperativeGestures,this._performanceMetricsCollection=p.performanceMetricsCollection,this._containerWidth=0,this._containerHeight=0,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new U(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._requestManager=new s.RequestManager(p.transformRequest,p.accessToken,p.testMode),this._silenceAuthErrors=!!p.testMode,"string"==typeof p.container){if(this._container=s.window.document.getElementById(p.container),!this._container)throw new Error(`Container '${p.container}' not found.`)}else{if(!(p.container instanceof s.window.HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=p.container}if(this._container.childNodes.length>0&&s.warnOnce("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),p.maxBounds&&this.setMaxBounds(p.maxBounds),s.bindAll(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),void 0===this.painter)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),void 0!==s.window&&(s.window.addEventListener("online",this._onWindowOnline,!1),s.window.addEventListener("resize",this._onWindowResize,!1),s.window.addEventListener("orientationchange",this._onWindowResize,!1),s.window.addEventListener("webkitfullscreenchange",this._onWindowResize,!1),s.window.addEventListener("visibilitychange",this._onVisibilityChange,!1)),this.handlers=new _a(this,p),this._localFontFamily=p.localFontFamily,this._localIdeographFontFamily=p.localIdeographFontFamily,p.style&&this.setStyle(p.style,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),p.projection&&this.setProjection(p.projection),this._hash=p.hash&&new qs("string"==typeof p.hash&&p.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:p.center,zoom:p.zoom,bearing:p.bearing,pitch:p.pitch}),p.bounds&&(this.resize(),this.fitBounds(p.bounds,s.extend({},p.fitBoundsOptions,{duration:0})))),this.resize(),p.attributionControl&&this.addControl(new ui({customAttribution:p.customAttribution})),this._logoControl=new _r,this.addControl(this._logoControl,p.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",o=>{this._update("style"===o.dataType),this.fire(new s.Event(`${o.dataType}data`,o))}),this.on("dataloading",o=>{this.fire(new s.Event(`${o.dataType}dataloading`,o))})}_getMapId(){return this._mapId}addControl(p,o){if(void 0===o&&(o=p.getDefaultPosition?p.getDefaultPosition():"top-right"),!p||!p.onAdd)return this.fire(new s.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const c=p.onAdd(this);this._controls.push(p);const m=this._controlPositions[o];return-1!==o.indexOf("bottom")?m.insertBefore(c,m.firstChild):m.appendChild(c),this}removeControl(p){if(!p||!p.onRemove)return this.fire(new s.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const o=this._controls.indexOf(p);return o>-1&&this._controls.splice(o,1),p.onRemove(this),this}hasControl(p){return this._controls.indexOf(p)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(p){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const o=!this._moving;return o&&this.fire(new s.Event("movestart",p)).fire(new s.Event("move",p)),this.fire(new s.Event("resize",p)),o&&this.fire(new s.Event("moveend",p)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(p){return this.transform.setMaxBounds(s.LngLatBounds.convert(p)),this._update()}setMinZoom(p){if((p=p??-2)>=-2&&p<=this.transform.maxZoom)return this.transform.minZoom=p,this._update(),this.getZoom()<p?this.setZoom(p):this.fire(new s.Event("zoomstart")).fire(new s.Event("zoom")).fire(new s.Event("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(p){if((p=p??22)>=this.transform.minZoom)return this.transform.maxZoom=p,this._update(),this.getZoom()>p?this.setZoom(p):this.fire(new s.Event("zoomstart")).fire(new s.Event("zoom")).fire(new s.Event("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(p){if((p=p??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(p>=0&&p<=this.transform.maxPitch)return this.transform.minPitch=p,this._update(),this.getPitch()<p?this.setPitch(p):this.fire(new s.Event("pitchstart")).fire(new s.Event("pitch")).fire(new s.Event("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(p){if((p=p??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(p>=this.transform.minPitch)return this.transform.maxPitch=p,this._update(),this.getPitch()>p?this.setPitch(p):this.fire(new s.Event("pitchstart")).fire(new s.Event("pitch")).fire(new s.Event("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(p){return this.transform.renderWorldCopies=p,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(p){return"auto"===p?s.window.navigator.language:Array.isArray(p)?0===p.length?void 0:p.map(o=>"auto"===o?s.window.navigator.language:o):p}setLanguage(p){const o=this._parseLanguage(p);if(!this.style||o===this._language)return this;this._language=o,this.style._reloadSources();for(const c of this._controls)c._setLanguage&&c._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(p){return this.style&&p!==this._worldview?(this._worldview=p,this.style._reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return"globe"===this.transform.projection.name}setProjection(p){return this._lazyInitEmptyStyle(),p?"string"==typeof p&&(p={name:p}):p=null,this._useExplicitProjection=!!p,this._prioritizeAndUpdateProjection(p,this.style.stylesheet?this.style.stylesheet.projection:null)}_updateProjectionTransition(){if("globe"!==this.getProjection().name)return;const p=this.transform,o=p.projection.name;let c;"globe"===o&&p.zoom>=s.GLOBE_ZOOM_THRESHOLD_MAX?(p.setMercatorFromTransition(),c=!0):"mercator"===o&&p.zoom<s.GLOBE_ZOOM_THRESHOLD_MAX&&(p.setProjection({name:"globe"}),c=!0),c&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(p,o){return this._updateProjection(p||o||{name:"mercator"})}_updateProjection(p){let o;if(o="globe"===p.name&&this.transform.zoom>=s.GLOBE_ZOOM_THRESHOLD_MAX?this.transform.setMercatorFromTransition():this.transform.setProjection(p),this.style.applyProjectionUpdate(),o){this.painter.clearBackgroundTiles();for(const c in this.style._sourceCaches)this.style._sourceCaches[c].clearTiles();this._update(!0),this._forceMarkerAndPopupUpdate(!0)}return this}project(p){return this.transform.locationPoint3D(s.LngLat.convert(p))}unproject(p){return this.transform.pointLocation3D(s.Point.convert(p))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(p,o,c){if("mouseenter"===p||"mouseover"===p){let m=!1;const b=I=>{const O=o.filter(H=>this.getLayer(H)),N=O.length?this.queryRenderedFeatures(I.point,{layers:O}):[];N.length?m||(m=!0,c.call(this,new qo(p,this,I.originalEvent,{features:N}))):m=!1},T=()=>{m=!1};return{layers:new Set(o),listener:c,delegates:{mousemove:b,mouseout:T}}}if("mouseleave"===p||"mouseout"===p){let m=!1;const b=I=>{const O=o.filter(N=>this.getLayer(N));(O.length?this.queryRenderedFeatures(I.point,{layers:O}):[]).length?m=!0:m&&(m=!1,c.call(this,new qo(p,this,I.originalEvent)))},T=I=>{m&&(m=!1,c.call(this,new qo(p,this,I.originalEvent)))};return{layers:new Set(o),listener:c,delegates:{mousemove:b,mouseout:T}}}{const m=b=>{const T=o.filter(O=>this.getLayer(O)),I=T.length?this.queryRenderedFeatures(b.point,{layers:T}):[];I.length&&(b.features=I,c.call(this,b),delete b.features)};return{layers:new Set(o),listener:c,delegates:{[p]:m}}}}on(p,o,c){if(void 0===c)return super.on(p,o);Array.isArray(o)||(o=[o]);const m=this._createDelegatedListener(p,o,c);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[p]=this._delegatedListeners[p]||[],this._delegatedListeners[p].push(m);for(const b in m.delegates)this.on(b,m.delegates[b]);return this}once(p,o,c){if(void 0===c)return super.once(p,o);Array.isArray(o)||(o=[o]);const m=this._createDelegatedListener(p,o,c);for(const b in m.delegates)this.once(b,m.delegates[b]);return this}off(p,o,c){if(void 0===c)return super.off(p,o);o=new Set(Array.isArray(o)?o:[o]);const m=(T,I)=>{if(T.size!==I.size)return!1;for(const O of T)if(!I.has(O))return!1;return!0},b=this._delegatedListeners?this._delegatedListeners[p]:void 0;return b&&(T=>{for(let I=0;I<T.length;I++){const O=T[I];if(O.listener===c&&m(O.layers,o)){for(const N in O.delegates)this.off(N,O.delegates[N]);return T.splice(I,1),this}}})(b),this}queryRenderedFeatures(p,o){return this.style?(void 0!==o||void 0===p||p instanceof s.Point||Array.isArray(p)||(o=p,p=void 0),this.style.queryRenderedFeatures(p=p||[[0,0],[this.transform.width,this.transform.height]],o=o||{},this.transform)):[]}querySourceFeatures(p,o){return this.style.querySourceFeatures(p,o)}isPointOnSurface(p){const{name:o}=this.transform.projection;return"globe"!==o&&"mercator"!==o&&s.warnOnce(`${o} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(s.Point.convert(p))}setStyle(p,o){return!1!==(o=s.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},o)).diff&&o.localIdeographFontFamily===this._localIdeographFontFamily&&o.localFontFamily===this._localFontFamily&&this.style&&p?(this._diffStyle(p,o),this):(this._localIdeographFontFamily=o.localIdeographFontFamily,this._localFontFamily=o.localFontFamily,this._updateStyle(p,o))}_getUIString(p){const o=this._locale[p];if(null==o)throw new Error(`Missing UI string '${p}'`);return o}_updateStyle(p,o){return this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),p&&(this.style=new Ir(this,o||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof p?this.style.loadURL(p):this.style.loadJSON(p)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new Ir(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(p,o){if("string"==typeof p){const c=this._requestManager.normalizeStyleURL(p),m=this._requestManager.transformRequest(c,s.ResourceType.Style);s.getJSON(m,(b,T)=>{b?this.fire(new s.ErrorEvent(b)):T&&this._updateDiff(T,o)})}else"object"==typeof p&&this._updateDiff(p,o)}_updateDiff(p,o){try{this.style.setState(p)&&this._update(!0)}catch(c){s.warnOnce(`Unable to perform style diff: ${c.message||c.error||c}.  Rebuilding the style from scratch.`),this._updateStyle(p,o)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(s.warnOnce("There is no style added to the map."),!1)}addSource(p,o){return this._lazyInitEmptyStyle(),this.style.addSource(p,o),this._update(!0)}isSourceLoaded(p){return!!this.style&&this.style._isSourceCacheLoaded(p)}areTilesLoaded(){const p=this.style&&this.style._sourceCaches;for(const o in p){const c=p[o]._tiles;for(const m in c){const b=c[m];if("loaded"!==b.state&&"errored"!==b.state)return!1}}return!0}addSourceType(p,o,c){this._lazyInitEmptyStyle(),this.style.addSourceType(p,o,c)}removeSource(p){return this.style.removeSource(p),this._updateTerrain(),this._update(!0)}getSource(p){return this.style.getSource(p)}addImage(p,o,{pixelRatio:c=1,sdf:m=!1,stretchX:b,stretchY:T,content:I}={}){if(this._lazyInitEmptyStyle(),o instanceof s.window.HTMLImageElement||s.window.ImageBitmap&&o instanceof s.window.ImageBitmap){const{width:O,height:N,data:H}=s.exported.getImageData(o);this.style.addImage(p,{data:new s.RGBAImage({width:O,height:N},H),pixelRatio:c,stretchX:b,stretchY:T,content:I,sdf:m,version:0})}else if(void 0===o.width||void 0===o.height)this.fire(new s.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:O,height:N}=o,H=o;this.style.addImage(p,{data:new s.RGBAImage({width:O,height:N},new Uint8Array(H.data)),pixelRatio:c,stretchX:b,stretchY:T,content:I,sdf:m,version:0,userImage:H}),H.onAdd&&H.onAdd(this,p)}}updateImage(p,o){const c=this.style.getImage(p);if(!c)return void this.fire(new s.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const m=o instanceof s.window.HTMLImageElement||s.window.ImageBitmap&&o instanceof s.window.ImageBitmap?s.exported.getImageData(o):o,{width:b,height:T}=m;void 0!==b&&void 0!==T?b===c.data.width&&T===c.data.height?(c.data.replace(m.data,!(o instanceof s.window.HTMLImageElement||s.window.ImageBitmap&&o instanceof s.window.ImageBitmap)),this.style.updateImage(p,c)):this.fire(new s.ErrorEvent(new Error(`The width and height of the updated image (${b}, ${T})\n                must be that same as the previous version of the image\n                (${c.data.width}, ${c.data.height})`))):this.fire(new s.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")))}hasImage(p){return p?!!this.style.getImage(p):(this.fire(new s.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(p){this.style.removeImage(p)}loadImage(p,o){s.getImage(this._requestManager.transformRequest(p,s.ResourceType.Image),(c,m)=>{o(c,m instanceof s.window.HTMLImageElement?s.exported.getImageData(m):m)})}listImages(){return this.style.listImages()}addLayer(p,o){return this._lazyInitEmptyStyle(),this.style.addLayer(p,o),this._update(!0)}moveLayer(p,o){return this.style.moveLayer(p,o),this._update(!0)}removeLayer(p){return this.style.removeLayer(p),this._update(!0)}getLayer(p){return this.style.getLayer(p)}setLayerZoomRange(p,o,c){return this.style.setLayerZoomRange(p,o,c),this._update(!0)}setFilter(p,o,c={}){return this.style.setFilter(p,o,c),this._update(!0)}getFilter(p){return this.style.getFilter(p)}setPaintProperty(p,o,c,m={}){return this.style.setPaintProperty(p,o,c,m),this._update(!0)}getPaintProperty(p,o){return this.style.getPaintProperty(p,o)}setLayoutProperty(p,o,c,m={}){return this.style.setLayoutProperty(p,o,c,m),this._update(!0)}getLayoutProperty(p,o){return this.style.getLayoutProperty(p,o)}setLight(p,o={}){return this._lazyInitEmptyStyle(),this.style.setLight(p,o),this._update(!0)}getLight(){return this.style.getLight()}setTerrain(p){return this._lazyInitEmptyStyle(),!p&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(p),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(p){return this._lazyInitEmptyStyle(),this.style.setFog(p),this._update(!0)}getFog(){return this.style?this.style.getFog():null}_queryFogOpacity(p){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(s.LngLat.convert(p),this.transform):0}setFeatureState(p,o){return this.style.setFeatureState(p,o),this._update()}removeFeatureState(p,o){return this.style.removeFeatureState(p,o),this._update()}getFeatureState(p){return this.style.getFeatureState(p)}_updateContainerDimensions(){if(!this._container)return;const p=this._container.getBoundingClientRect().width||400,o=this._container.getBoundingClientRect().height||300;let c,m,b,T=this._container;for(;T&&(!m||!b);){const I=s.window.getComputedStyle(T).transform;I&&"none"!==I&&(c=I.match(/matrix.*\((.+)\)/)[1].split(", "),c[0]&&"0"!==c[0]&&"1"!==c[0]&&(m=c[0]),c[3]&&"0"!==c[3]&&"1"!==c[3]&&(b=c[3])),T=T.parentElement}this._containerWidth=m?Math.abs(p/m):p,this._containerHeight=b?Math.abs(o/b):o}_detectMissingCSS(){"rgb(250, 128, 114)"!==s.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")&&s.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const p=this._container;p.classList.add("mapboxgl-map"),(this._missingCSSCanary=fe("div","mapboxgl-canary",p)).style.visibility="hidden",this._detectMissingCSS();const o=this._canvasContainer=fe("div","mapboxgl-canvas-container",p);this._interactive&&o.classList.add("mapboxgl-interactive"),this._canvas=fe("canvas","mapboxgl-canvas",o),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const c=this._controlContainer=fe("div","mapboxgl-control-container",p),m=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(b=>{m[b]=fe("div",`mapboxgl-ctrl-${b}`,c)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(p,o){const c=s.exported.devicePixelRatio||1;this._canvas.width=c*Math.ceil(p),this._canvas.height=c*Math.ceil(o),this._canvas.style.width=`${p}px`,this._canvas.style.height=`${o}px`}_addMarker(p){this._markers.push(p)}_removeMarker(p){const o=this._markers.indexOf(p);-1!==o&&this._markers.splice(o,1)}_addPopup(p){this._popups.push(p)}_removePopup(p){const o=this._popups.indexOf(p);-1!==o&&this._popups.splice(o,1)}_setupPainter(){const p=s.extend({},ie.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),o=this._useWebGL2&&this._canvas.getContext("webgl2",p),c=o||this._canvas.getContext("webgl",p)||this._canvas.getContext("experimental-webgl",p);c?(this._useWebGL2&&!o&&s.warnOnce("Failed to create WebGL 2 context. Using WebGL 1."),s.storeAuthState(c,!0),this.painter=new Tt(c,this.transform,!!o),this.on("data",m=>{"source"===m.dataType&&this.painter.setTileLoadedFlag(!0)}),s.exported$1.testSupport(c)):this.fire(new s.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(p){p.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new s.Event("webglcontextlost",{originalEvent:p}))}_contextRestored(p){this._setupPainter(),this.resize(),this._update(),this.fire(new s.Event("webglcontextrestored",{originalEvent:p}))}_onMapScroll(p){if(p.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(p){return this.style?(this._styleDirty=this._styleDirty||p,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(p){return this._update(),this._renderTaskQueue.add(p)}_cancelRenderFrame(p){this._renderTaskQueue.remove(p)}_requestDomTask(p){!this.loaded()||this.loaded()&&!this.isMoving()?p():this._domRenderTaskQueue.add(p)}_render(p){let o;const c=this.painter.context.extTimerQuery,m=s.exported.now();if(this.listens("gpu-timing-frame")&&(o=c.createQueryEXT(),c.beginQueryEXT(c.TIME_ELAPSED_EXT,o)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],s.window.performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],s.window.performance.now())),this._renderTaskQueue.run(p),this._domRenderTaskQueue.run(p),this._removed)return;this._updateProjectionTransition();const b=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const O=this.transform.zoom,N=this.transform.pitch,H=s.exported.now(),$=new s.EvaluationParameters(O,{now:H,fadeDuration:b,pitch:N,transition:this.style.getTransition()});this.style.update($)}this.style&&this.style.fog&&this.style.fog.hasTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let T=!1;if(this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),T=this._updateAverageElevation(m),this.style._updateSources(this.transform),this._forceMarkerAndPopupUpdate()):T=this._updateAverageElevation(m),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,b,this._crossSourceCollisions),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showTerrainWireframe:this.showTerrainWireframe,showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:b,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new s.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new s.Event("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),o){const O=s.exported.now()-m;c.endQueryEXT(c.TIME_ELAPSED_EXT,o),setTimeout(()=>{const N=c.getQueryObjectEXT(o,c.QUERY_RESULT_EXT)/1e6;c.deleteQueryEXT(o),this.fire(new s.Event("gpu-timing-frame",{cpuTime:O,gpuTime:N})),s.window.performance.mark("frame-gpu",{startTime:m,detail:{gpuTime:N}})},50)}if(this.listens("gpu-timing-layer")){const O=this.painter.collectGpuTimers();setTimeout(()=>{const N=this.painter.queryGpuTimers(O);this.fire(new s.Event("gpu-timing-layer",{layerTimes:N}))},50)}if(this.listens("gpu-timing-deferred-render")){const O=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const N=this.painter.queryGpuTimeDeferredRender(O);this.fire(new s.Event("gpu-timing-deferred-render",{gpuTime:N}))},50)}const I=this._sourcesDirty||this._styleDirty||this._placementDirty||T;if(I||this._repaint)this.triggerRepaint();else{const O=!this.isMoving()&&this.loaded();if(O&&(T=this._updateAverageElevation(m,!0)),T)this.triggerRepaint();else if(this._triggerFrame(!1),O&&(this.fire(new s.Event("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const N=this._calculateSpeedIndex();this.fire(new s.Event("speedindexcompleted",{speedIndex:N})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||I||(this._fullyLoaded=!0,s.LivePerformanceUtils.mark(s.PerformanceMarkers.fullLoad),this._performanceMetricsCollection&&s.postPerformanceEvent(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(p){for(const o of this._markers)p&&!this.getRenderWorldCopies()&&(o._lngLat=o._lngLat.wrap()),o._update();for(const o of this._popups)!p||this.getRenderWorldCopies()||o._trackPointer||(o._lngLat=o._lngLat.wrap()),o._update()}_updateAverageElevation(p,o=!1){const c=m=>(this.transform.averageElevation=m,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return 0!==this.transform.averageElevation&&c(0);if((o||p-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(p)){const m=this.transform.averageElevation;let b=this.transform.sampleAverageElevation(),T=!1;this.transform.elevation&&(T=this.transform.elevation.exaggeration()!==this._averageElevationExaggeration,this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(b)?b=0:this._averageElevationLastSampledAt=p;const I=Math.abs(m-b);if(I>1){if(this._isInitialLoad||T)return this._averageElevation.jumpTo(b),c(b);this._averageElevation.easeTo(b,p,300)}else if(I>1e-4)return this._averageElevation.jumpTo(b),c(b)}return!!this._averageElevation.isEasing(p)&&c(this._averageElevation.getValue(p))}_authenticate(){s.getMapSessionAPI(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,p=>{if(p&&(p.message===s.AUTH_ERR_MSG||401===p.status)){const o=this.painter.context.gl;s.storeAuthState(o,!1),this._logoControl instanceof _r&&this._logoControl._updateLogo(),o&&o.clear(o.DEPTH_BUFFER_BIT|o.COLOR_BUFFER_BIT|o.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new s.ErrorEvent(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),s.postMapLoadEvent(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_updateTerrain(){const p=this._isDragging();this.painter.updateTerrain(this.style,p)}_calculateSpeedIndex(){const p=this.painter.canvasCopy(),o=this.painter.getCanvasCopiesAndTimestamps();o.timeStamps.push(performance.now());const c=this.painter.context.gl,m=c.createFramebuffer();function b(T){c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,T,0);const I=new Uint8Array(c.drawingBufferWidth*c.drawingBufferHeight*4);return c.readPixels(0,0,c.drawingBufferWidth,c.drawingBufferHeight,c.RGBA,c.UNSIGNED_BYTE,I),I}return c.bindFramebuffer(c.FRAMEBUFFER,m),this._canvasPixelComparison(b(p),o.canvasCopies.map(b),o.timeStamps)}_canvasPixelComparison(p,o,c){let m=c[1]-c[0];const b=p.length/4;for(let T=0;T<o.length;T++){const I=o[T];let O=0;for(let N=0;N<I.length;N+=4)I[N]===p[N]&&I[N+1]===p[N+1]&&I[N+2]===p[N+2]&&I[N+3]===p[N+3]&&(O+=1);m+=(c[T+2]-c[T+1])*(1-O/b)}return m}remove(){this._hash&&this._hash.remove();for(const o of this._controls)o.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),void 0!==s.window&&(s.window.removeEventListener("resize",this._onWindowResize,!1),s.window.removeEventListener("orientationchange",this._onWindowResize,!1),s.window.removeEventListener("webkitfullscreenchange",this._onWindowResize,!1),s.window.removeEventListener("online",this._onWindowOnline,!1),s.window.removeEventListener("visibilitychange",this._onVisibilityChange,!1));const p=this.painter.context.gl.getExtension("WEBGL_lose_context");p&&p.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),s.removeAuthState(this.painter.context.gl),this._removed=!0,this.fire(new s.Event("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(p){this._renderNextFrame=this._renderNextFrame||p,this.style&&!this._frame&&(this._frame=s.exported.frame(o=>{const c=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,c&&this._render(o)}))}_preloadTiles(p){const o=this.style?Object.values(this.style._sourceCaches):[];return s.asyncAll(o,(c,m)=>c._preloadTiles(p,m),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(p){this._trackResize&&this.resize({originalEvent:p})._update()}_onVisibilityChange(){"hidden"===s.window.document.visibilityState&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(p){this._showTileBoundaries!==p&&(this._showTileBoundaries=p,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(p){this._showTerrainWireframe!==p&&(this._showTerrainWireframe=p,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(p){this._speedIndexTiming!==p&&(this._speedIndexTiming=p,this._update())}get showPadding(){return!!this._showPadding}set showPadding(p){this._showPadding!==p&&(this._showPadding=p,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(p){this._showCollisionBoxes!==p&&(this._showCollisionBoxes=p,p?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(p){this._showOverdrawInspector!==p&&(this._showOverdrawInspector=p,this._update())}get repaint(){return!!this._repaint}set repaint(p){this._repaint!==p&&(this._repaint=p,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(p){this._vertices=p,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(p){this._showTileAABBs!==p&&(this._showTileAABBs=p,p&&this._update())}_setCacheLimits(p,o){s.setCacheLimits(p,o)}get version(){return s.version}},NavigationControl:class{constructor(p){this.options=s.extend({},We,p),this._container=fe("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",o=>o.preventDefault()),this.options.showZoom&&(s.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",o=>{this._map&&this._map.zoomIn({},{originalEvent:o})}),fe("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",o=>{this._map&&this._map.zoomOut({},{originalEvent:o})}),fe("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(s.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",o=>{const c=this._map;c&&(this.options.visualizePitch?c.resetNorthPitch({},{originalEvent:o}):c.resetNorth({},{originalEvent:o}))}),this._compassIcon=fe("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const p=this._map;if(!p)return;const o=p.getZoom(),c=o===p.getMaxZoom(),m=o===p.getMinZoom();this._zoomInButton.disabled=c,this._zoomOutButton.disabled=m,this._zoomInButton.setAttribute("aria-disabled",c.toString()),this._zoomOutButton.setAttribute("aria-disabled",m.toString())}_rotateCompassArrow(){const p=this._map;if(!p)return;const o=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(p.transform.pitch*(Math.PI/180)),.5)}) rotateX(${p.transform.pitch}deg) rotateZ(${p.transform.angle*(180/Math.PI)}deg)`:`rotate(${p.transform.angle*(180/Math.PI)}deg)`;p._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=o)})}onAdd(p){return this._map=p,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),p.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&p.on("pitch",this._rotateCompassArrow),p.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Jt(p,this._compass,this.options.visualizePitch)),this._container}onRemove(){const p=this._map;p&&(this._container.remove(),this.options.showZoom&&p.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&p.off("pitch",this._rotateCompassArrow),p.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(p,o){const c=fe("button",p,this._container);return c.type="button",c.addEventListener("click",o),c}_setButtonTitle(p,o){if(!this._map)return;const c=this._map._getUIString(`NavigationControl.${o}`);p.setAttribute("aria-label",c),p.firstElementChild&&p.firstElementChild.setAttribute("title",c)}},GeolocateControl:class extends s.Evented{constructor(p){super(),this.options=s.extend({geolocation:s.window.navigator.geolocation},Rn,p),s.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=Vr(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(p){return this._map=p,this._container=fe("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){void 0!==this._geolocationWatchID&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(p){const o=(c=!!this.options.geolocation)=>{this._supportsGeolocation=c,p(c)};void 0!==this._supportsGeolocation?p(this._supportsGeolocation):void 0!==s.window.navigator.permissions?s.window.navigator.permissions.query({name:"geolocation"}).then(c=>o("denied"!==c.state)).catch(()=>o()):o()}_isOutOfMapMaxBounds(p){const o=this._map.getMaxBounds(),c=p.coords;return!!o&&(c.longitude<o.getWest()||c.longitude>o.getEast()||c.latitude<o.getSouth()||c.latitude>o.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(p){if(this._map){if(this._isOutOfMapMaxBounds(p))return this._setErrorState(),this.fire(new s.Event("outofmaxbounds",p)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=p,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(p),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(p),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new s.Event("geolocate",p)),this._finish()}}_updateCamera(p){const o=new s.LngLat(p.coords.longitude,p.coords.latitude),c=p.coords.accuracy,m=this._map.getBearing(),b=s.extend({bearing:m},this.options.fitBoundsOptions);this._map.fitBounds(o.toBounds(c),b,{geolocateSource:!0})}_updateMarker(p){if(p){const o=new s.LngLat(p.coords.longitude,p.coords.latitude);this._accuracyCircleMarker.setLngLat(o).addTo(this._map),this._userLocationDotMarker.setLngLat(o).addTo(this._map),this._accuracy=p.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const p=this._map.transform,o=s.mercatorZfromAltitude(1,p._center.lat)*p.worldSize,c=Math.ceil(2*this._accuracy*o);this._circleElement.style.width=`${c}px`,this._circleElement.style.height=`${c}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&"number"==typeof this._heading?(this._userLocationDotMarker.setRotation(this._heading),this._dotElement.classList.add("mapboxgl-user-location-show-heading")):(this._dotElement.classList.remove("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(p){if(this._map){if(this.options.trackUserLocation)if(1===p.code){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const o=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",o),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",o),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===p.code&&this._noTimeout)return;this._setErrorState()}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new s.Event("error",p)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(p){if(void 0!==this._map){if(this._container.addEventListener("contextmenu",o=>o.preventDefault()),this._geolocateButton=fe("button","mapboxgl-ctrl-geolocate",this._container),fe("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",!1===p){s.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const o=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",o),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",o)}else{const o=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",o),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",o)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=fe("div","mapboxgl-user-location"),this._dotElement.appendChild(fe("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(fe("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new ai({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=fe("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new ai({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",o=>{o.geolocateSource||"ACTIVE_LOCK"!==this._watchState||o.originalEvent&&"resize"===o.originalEvent.type||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new s.Event("trackuserlocationend")))})}}_onDeviceOrientation(p){this._userLocationDotMarker&&(p.webkitCompassHeading?this._heading=p.webkitCompassHeading:!0===p.absolute&&(this._heading=-1*p.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return s.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new s.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new s.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new s.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){let p;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(p={maximumAge:6e5,timeout:0},this._noTimeout=!0):(p=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,p),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const p=()=>{s.window.addEventListener("ondeviceorientationabsolute"in s.window?"deviceorientationabsolute":"deviceorientation",this._onDeviceOrientation)};void 0!==s.window.DeviceMotionEvent&&"function"==typeof s.window.DeviceMotionEvent.requestPermission?DeviceOrientationEvent.requestPermission().then(o=>{"granted"===o&&p()}).catch(console.error):p()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),s.window.removeEventListener("deviceorientation",this._onDeviceOrientation),s.window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:ui,ScaleControl:class{constructor(p){this.options=s.extend({},fi,p),this._isNumberFormatSupported=function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch{return!1}}(),s.bindAll(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const p=this.options.maxWidth||100,o=this._map,c=o._containerHeight/2,m=o._containerWidth/2-p/2,b=o.unproject([m,c]),T=o.unproject([m+p,c]),I=b.distanceTo(T);if("imperial"===this.options.unit){const O=3.2808*I;O>5280?this._setScale(p,O/5280,"mile"):this._setScale(p,O,"foot")}else"nautical"===this.options.unit?this._setScale(p,I/1852,"nautical-mile"):I>=1e3?this._setScale(p,I/1e3,"kilometer"):this._setScale(p,I,"meter")}_setScale(p,o,c){this._map._requestDomTask(()=>{const m=function(T){const I=Math.pow(10,`${Math.floor(T)}`.length-1);let O=T/I;return O=O>=10?10:O>=5?5:O>=3?3:O>=2?2:O>=1?1:function(N){const H=Math.pow(10,Math.ceil(-Math.log(N)/Math.LN10));return Math.round(N*H)/H}(O),I*O}(o),b=m/o;this._container.innerHTML=this._isNumberFormatSupported&&"nautical-mile"!==c?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:c}).format(m):`${m}&nbsp;${Mi[c]}`,this._container.style.width=p*b+"px"})}onAdd(p){return this._map=p,this._language=p.getLanguage(),this._container=fe("div","mapboxgl-ctrl mapboxgl-ctrl-scale",p.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(p){this._language=p,this._update()}setUnit(p){this.options.unit=p,this._update()}},FullscreenControl:class{constructor(p){this._fullscreen=!1,p&&p.container&&(p.container instanceof s.window.HTMLElement?this._container=p.container:s.warnOnce("Full screen control 'container' must be a DOM element.")),s.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in s.window.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in s.window.document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(p){return this._map=p,this._container||(this._container=this._map.getContainer()),this._controlContainer=fe("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",s.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,s.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!s.window.document.fullscreenEnabled&&!s.window.document.webkitFullscreenEnabled)}_setupUI(){const p=this._fullscreenButton=fe("button","mapboxgl-ctrl-fullscreen",this._controlContainer);fe("span","mapboxgl-ctrl-icon",p).setAttribute("aria-hidden","true"),p.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),s.window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const p=this._getTitle();this._fullscreenButton.setAttribute("aria-label",p),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",p)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(s.window.document.fullscreenElement||s.window.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?s.window.document.exitFullscreen?s.window.document.exitFullscreen():s.window.document.webkitCancelFullScreen&&s.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends s.Evented{constructor(p){super(),this.options=s.extend(Object.create(L),p),s.bindAll(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(p&&p.className?p.className.trim().split(/\s+/):[])}addTo(p){return this._map&&this.remove(),this._map=p,this.options.closeOnClick&&p.on("preclick",this._onClose),this.options.closeOnMove&&p.on("move",this._onClose),p.on("remove",this.remove),this._update(),p._addPopup(this),this._focusFirstElement(),this._trackPointer?(p.on("mousemove",this._onMouseEvent),p.on("mouseup",this._onMouseEvent),p._canvasContainer.classList.add("mapboxgl-track-pointer")):p.on("move",this._update),this.fire(new s.Event("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const p=this._map;return p&&(p.off("move",this._update),p.off("move",this._onClose),p.off("preclick",this._onClose),p.off("click",this._onClose),p.off("remove",this.remove),p.off("mousemove",this._onMouseEvent),p.off("mouseup",this._onMouseEvent),p.off("drag",this._onMouseEvent),p._canvasContainer&&p._canvasContainer.classList.remove("mapboxgl-track-pointer"),p._removePopup(this),this._map=void 0),this.fire(new s.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(p){this._lngLat=s.LngLat.convert(p),this._pos=null,this._trackPointer=!1,this._update();const o=this._map;return o&&(o.on("move",this._update),o.off("mousemove",this._onMouseEvent),o._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const p=this._map;return p&&(p.off("move",this._update),p.on("mousemove",this._onMouseEvent),p.on("drag",this._onMouseEvent),p._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(p){return this.setDOMContent(s.window.document.createTextNode(p))}setHTML(p){const o=s.window.document.createDocumentFragment(),c=s.window.document.createElement("body");let m;for(c.innerHTML=p;m=c.firstChild,m;)o.appendChild(m);return this.setDOMContent(o)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(p){return this.options.maxWidth=p,this._update(),this}setDOMContent(p){let o=this._content;if(o)for(;o.hasChildNodes();)o.firstChild&&o.removeChild(o.firstChild);else o=this._content=fe("div","mapboxgl-popup-content",this._container||void 0);if(o.appendChild(p),this.options.closeButton){const c=this._closeButton=fe("button","mapboxgl-popup-close-button",o);c.type="button",c.setAttribute("aria-label","Close popup"),c.setAttribute("aria-hidden","true"),c.innerHTML="&#215;",c.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(p){return this._classList.add(p),this._updateClassList(),this}removeClassName(p){return this._classList.delete(p),this._updateClassList(),this}setOffset(p){return this.options.offset=p,this._update(),this}toggleClassName(p){let o;return this._classList.delete(p)?o=!1:(this._classList.add(p),o=!0),this._updateClassList(),o}_onMouseEvent(p){this._update(p.point)}_getAnchor(p){if(this.options.anchor)return this.options.anchor;const o=this._map,c=this._container,m=this._pos;if(!o||!c||!m)return"bottom";const b=c.offsetWidth,T=c.offsetHeight,I=m.x<b/2,O=m.x>o.transform.width-b/2;if(m.y+p<T)return I?"top-left":O?"top-right":"top";if(m.y>o.transform.height-T){if(I)return"bottom-left";if(O)return"bottom-right"}return I?"left":O?"right":"bottom"}_updateClassList(){const p=this._container;if(!p)return;const o=[...this._classList];o.push("mapboxgl-popup"),this._anchor&&o.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&o.push("mapboxgl-popup-track-pointer"),p.className=o.join(" ")}_update(p){const o=this._map,c=this._content;if(!o||!this._lngLat&&!this._trackPointer||!c)return;let m=this._container;if(m||(m=this._container=fe("div","mapboxgl-popup",o.getContainer()),this._tip=fe("div","mapboxgl-popup-tip",m),m.appendChild(c)),this.options.maxWidth&&m.style.maxWidth!==this.options.maxWidth&&(m.style.maxWidth=this.options.maxWidth),o.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Hl(this._lngLat,this._pos,o.transform)),!this._trackPointer||p){const b=this._pos=this._trackPointer&&p?p:o.project(this._lngLat),T=A(this.options.offset),I=this._anchor=this._getAnchor(T.y),O=A(this.options.offset,I),N=b.add(O).round();o._requestDomTask(()=>{this._container&&I&&(this._container.style.transform=`${vl[I]} translate(${N.x}px,${N.y}px)`)})}if(!this._marker&&o._showingGlobe()){const b=s.isLngLatBehindGlobe(o.transform,this._lngLat)?0:1;this._setOpacity(b)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const p=this._container.querySelector(B);p&&p.focus()}_onClose(){this.remove()}_setOpacity(p){this._container&&(this._container.style.opacity=`${p}`),this._content&&(this._content.style.pointerEvents=p?"auto":"none")}},Marker:ai,Style:Ir,LngLat:s.LngLat,LngLatBounds:s.LngLatBounds,Point:s.Point,MercatorCoordinate:s.MercatorCoordinate,FreeCameraOptions:yo,Evented:s.Evented,config:s.config,prewarm:function(){bt().acquire(fo)},clearPrewarmedResources:function(){const p=nn;p&&(p.isPreloaded()&&1===p.numActive()?(p.release(fo),nn=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return s.config.ACCESS_TOKEN},set accessToken(p){s.config.ACCESS_TOKEN=p},get baseApiUrl(){return s.config.API_URL},set baseApiUrl(p){s.config.API_URL=p},get workerCount(){return to.workerCount},set workerCount(p){to.workerCount=p},get maxParallelImageRequests(){return s.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(p){s.config.MAX_PARALLEL_IMAGE_REQUESTS=p},clearStorage(p){s.clearTileCache(p)},workerUrl:"",workerClass:null,setNow:s.exported.setNow,restoreNow:s.exported.restoreNow};return Io}),x}()},5619:(zn,Dt,R)=>{"use strict";R.d(Dt,{X:()=>d});var x=R(8645);class d extends x.x{constructor(s){super(),this._value=s}get value(){return this.getValue()}_subscribe(s){const Q=super._subscribe(s);return!Q.closed&&s.next(this._value),Q}getValue(){const{hasError:s,thrownError:Q,_value:ie}=this;if(s)throw Q;return this._throwIfClosed(),ie}next(s){super.next(this._value=s)}}},5592:(zn,Dt,R)=>{"use strict";R.d(Dt,{y:()=>y});var x=R(1887),d=R(7394),v=R(4850),s=R(8407),Q=R(2653),ie=R(4674),q=R(1441);let y=(()=>{class X{constructor(Ee){Ee&&(this._subscribe=Ee)}lift(Ee){const _e=new X;return _e.source=this,_e.operator=Ee,_e}subscribe(Ee,_e,be){const Re=function De(X){return X&&X instanceof x.Lv||function Se(X){return X&&(0,ie.m)(X.next)&&(0,ie.m)(X.error)&&(0,ie.m)(X.complete)}(X)&&(0,d.Nn)(X)}(Ee)?Ee:new x.Hp(Ee,_e,be);return(0,q.x)(()=>{const{operator:Ne,source:qe}=this;Re.add(Ne?Ne.call(Re,qe):qe?this._subscribe(Re):this._trySubscribe(Re))}),Re}_trySubscribe(Ee){try{return this._subscribe(Ee)}catch(_e){Ee.error(_e)}}forEach(Ee,_e){return new(_e=fe(_e))((be,Re)=>{const Ne=new x.Hp({next:qe=>{try{Ee(qe)}catch(_t){Re(_t),Ne.unsubscribe()}},error:Re,complete:be});this.subscribe(Ne)})}_subscribe(Ee){var _e;return null===(_e=this.source)||void 0===_e?void 0:_e.subscribe(Ee)}[v.L](){return this}pipe(...Ee){return(0,s.U)(Ee)(this)}toPromise(Ee){return new(Ee=fe(Ee))((_e,be)=>{let Re;this.subscribe(Ne=>Re=Ne,Ne=>be(Ne),()=>_e(Re))})}}return X.create=se=>new X(se),X})();function fe(X){var se;return null!==(se=X??Q.config.Promise)&&void 0!==se?se:Promise}},8645:(zn,Dt,R)=>{"use strict";R.d(Dt,{x:()=>q});var x=R(5592),d=R(7394);const s=(0,R(2306).d)(fe=>function(){fe(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var Q=R(9039),ie=R(1441);let q=(()=>{class fe extends x.y{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(De){const X=new y(this,this);return X.operator=De,X}_throwIfClosed(){if(this.closed)throw new s}next(De){(0,ie.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const X of this.currentObservers)X.next(De)}})}error(De){(0,ie.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=De;const{observers:X}=this;for(;X.length;)X.shift().error(De)}})}complete(){(0,ie.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:De}=this;for(;De.length;)De.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var De;return(null===(De=this.observers)||void 0===De?void 0:De.length)>0}_trySubscribe(De){return this._throwIfClosed(),super._trySubscribe(De)}_subscribe(De){return this._throwIfClosed(),this._checkFinalizedStatuses(De),this._innerSubscribe(De)}_innerSubscribe(De){const{hasError:X,isStopped:se,observers:Ee}=this;return X||se?d.Lc:(this.currentObservers=null,Ee.push(De),new d.w0(()=>{this.currentObservers=null,(0,Q.P)(Ee,De)}))}_checkFinalizedStatuses(De){const{hasError:X,thrownError:se,isStopped:Ee}=this;X?De.error(se):Ee&&De.complete()}asObservable(){const De=new x.y;return De.source=this,De}}return fe.create=(Se,De)=>new y(Se,De),fe})();class y extends q{constructor(Se,De){super(),this.destination=Se,this.source=De}next(Se){var De,X;null===(X=null===(De=this.destination)||void 0===De?void 0:De.next)||void 0===X||X.call(De,Se)}error(Se){var De,X;null===(X=null===(De=this.destination)||void 0===De?void 0:De.error)||void 0===X||X.call(De,Se)}complete(){var Se,De;null===(De=null===(Se=this.destination)||void 0===Se?void 0:Se.complete)||void 0===De||De.call(Se)}_subscribe(Se){var De,X;return null!==(X=null===(De=this.source)||void 0===De?void 0:De.subscribe(Se))&&void 0!==X?X:d.Lc}}},1887:(zn,Dt,R)=>{"use strict";R.d(Dt,{Hp:()=>be,Lv:()=>X});var x=R(4674),d=R(7394),v=R(2653),s=R(3894);function Q(){}const ie=fe("C",void 0,void 0);function fe(Je,Me,it){return{kind:Je,value:Me,error:it}}var Se=R(7599),De=R(1441);class X extends d.w0{constructor(Me){super(),this.isStopped=!1,Me?(this.destination=Me,(0,d.Nn)(Me)&&Me.add(this)):this.destination=_t}static create(Me,it,Xe){return new be(Me,it,Xe)}next(Me){this.isStopped?qe(function y(Je){return fe("N",Je,void 0)}(Me),this):this._next(Me)}error(Me){this.isStopped?qe(function q(Je){return fe("E",void 0,Je)}(Me),this):(this.isStopped=!0,this._error(Me))}complete(){this.isStopped?qe(ie,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(Me){this.destination.next(Me)}_error(Me){try{this.destination.error(Me)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const se=Function.prototype.bind;function Ee(Je,Me){return se.call(Je,Me)}class _e{constructor(Me){this.partialObserver=Me}next(Me){const{partialObserver:it}=this;if(it.next)try{it.next(Me)}catch(Xe){Re(Xe)}}error(Me){const{partialObserver:it}=this;if(it.error)try{it.error(Me)}catch(Xe){Re(Xe)}else Re(Me)}complete(){const{partialObserver:Me}=this;if(Me.complete)try{Me.complete()}catch(it){Re(it)}}}class be extends X{constructor(Me,it,Xe){let Te;if(super(),(0,x.m)(Me)||!Me)Te={next:Me??void 0,error:it??void 0,complete:Xe??void 0};else{let ae;this&&v.config.useDeprecatedNextContext?(ae=Object.create(Me),ae.unsubscribe=()=>this.unsubscribe(),Te={next:Me.next&&Ee(Me.next,ae),error:Me.error&&Ee(Me.error,ae),complete:Me.complete&&Ee(Me.complete,ae)}):Te=Me}this.destination=new _e(Te)}}function Re(Je){v.config.useDeprecatedSynchronousErrorHandling?(0,De.O)(Je):(0,s.h)(Je)}function qe(Je,Me){const{onStoppedNotification:it}=v.config;it&&Se.z.setTimeout(()=>it(Je,Me))}const _t={closed:!0,next:Q,error:function Ne(Je){throw Je},complete:Q}},7394:(zn,Dt,R)=>{"use strict";R.d(Dt,{Lc:()=>ie,w0:()=>Q,Nn:()=>q});var x=R(4674);const v=(0,R(2306).d)(fe=>function(De){fe(this),this.message=De?`${De.length} errors occurred during unsubscription:\n${De.map((X,se)=>`${se+1}) ${X.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=De});var s=R(9039);class Q{constructor(Se){this.initialTeardown=Se,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let Se;if(!this.closed){this.closed=!0;const{_parentage:De}=this;if(De)if(this._parentage=null,Array.isArray(De))for(const Ee of De)Ee.remove(this);else De.remove(this);const{initialTeardown:X}=this;if((0,x.m)(X))try{X()}catch(Ee){Se=Ee instanceof v?Ee.errors:[Ee]}const{_finalizers:se}=this;if(se){this._finalizers=null;for(const Ee of se)try{y(Ee)}catch(_e){Se=Se??[],_e instanceof v?Se=[...Se,..._e.errors]:Se.push(_e)}}if(Se)throw new v(Se)}}add(Se){var De;if(Se&&Se!==this)if(this.closed)y(Se);else{if(Se instanceof Q){if(Se.closed||Se._hasParent(this))return;Se._addParent(this)}(this._finalizers=null!==(De=this._finalizers)&&void 0!==De?De:[]).push(Se)}}_hasParent(Se){const{_parentage:De}=this;return De===Se||Array.isArray(De)&&De.includes(Se)}_addParent(Se){const{_parentage:De}=this;this._parentage=Array.isArray(De)?(De.push(Se),De):De?[De,Se]:Se}_removeParent(Se){const{_parentage:De}=this;De===Se?this._parentage=null:Array.isArray(De)&&(0,s.P)(De,Se)}remove(Se){const{_finalizers:De}=this;De&&(0,s.P)(De,Se),Se instanceof Q&&Se._removeParent(this)}}Q.EMPTY=(()=>{const fe=new Q;return fe.closed=!0,fe})();const ie=Q.EMPTY;function q(fe){return fe instanceof Q||fe&&"closed"in fe&&(0,x.m)(fe.remove)&&(0,x.m)(fe.add)&&(0,x.m)(fe.unsubscribe)}function y(fe){(0,x.m)(fe)?fe():fe.unsubscribe()}},2653:(zn,Dt,R)=>{"use strict";R.d(Dt,{config:()=>x});const x={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1}},5211:(zn,Dt,R)=>{"use strict";R.d(Dt,{z:()=>Q});var x=R(7537),v=R(4564),s=R(7715);function Q(...ie){return function d(){return(0,x.J)(1)}()((0,s.D)(ie,(0,v.yG)(ie)))}},4911:(zn,Dt,R)=>{"use strict";R.d(Dt,{P:()=>v});var x=R(5592),d=R(4829);function v(s){return new x.y(Q=>{(0,d.Xf)(s()).subscribe(Q)})}},6232:(zn,Dt,R)=>{"use strict";R.d(Dt,{E:()=>d});const d=new(R(5592).y)(Q=>Q.complete())},9315:(zn,Dt,R)=>{"use strict";R.d(Dt,{D:()=>y});var x=R(5592),d=R(7453),v=R(4829),s=R(4564),Q=R(8251),ie=R(7400),q=R(2714);function y(...fe){const Se=(0,s.jO)(fe),{args:De,keys:X}=(0,d.D)(fe),se=new x.y(Ee=>{const{length:_e}=De;if(!_e)return void Ee.complete();const be=new Array(_e);let Re=_e,Ne=_e;for(let qe=0;qe<_e;qe++){let _t=!1;(0,v.Xf)(De[qe]).subscribe((0,Q.x)(Ee,Je=>{_t||(_t=!0,Ne--),be[qe]=Je},()=>Re--,void 0,()=>{(!Re||!_t)&&(Ne||Ee.next(X?(0,q.n)(X,be):be),Ee.complete())}))}});return Se?se.pipe((0,ie.Z)(Se)):se}},7715:(zn,Dt,R)=>{"use strict";R.d(Dt,{D:()=>Xe});var x=R(4829),d=R(7103),v=R(9360),s=R(8251);function Q(Te,ae=0){return(0,v.e)((yt,we)=>{yt.subscribe((0,s.x)(we,Ze=>(0,d.f)(we,Te,()=>we.next(Ze),ae),()=>(0,d.f)(we,Te,()=>we.complete(),ae),Ze=>(0,d.f)(we,Te,()=>we.error(Ze),ae)))})}function ie(Te,ae=0){return(0,v.e)((yt,we)=>{we.add(Te.schedule(()=>yt.subscribe(we),ae))})}var fe=R(5592),De=R(4971),X=R(4674);function Ee(Te,ae){if(!Te)throw new Error("Iterable cannot be null");return new fe.y(yt=>{(0,d.f)(yt,ae,()=>{const we=Te[Symbol.asyncIterator]();(0,d.f)(yt,ae,()=>{we.next().then(Ze=>{Ze.done?yt.complete():yt.next(Ze.value)})},0,!0)})})}var _e=R(8382),be=R(4026),Re=R(4266),Ne=R(3664),qe=R(5726),_t=R(9853),Je=R(541);function Xe(Te,ae){return ae?function it(Te,ae){if(null!=Te){if((0,_e.c)(Te))return function q(Te,ae){return(0,x.Xf)(Te).pipe(ie(ae),Q(ae))}(Te,ae);if((0,Re.z)(Te))return function Se(Te,ae){return new fe.y(yt=>{let we=0;return ae.schedule(function(){we===Te.length?yt.complete():(yt.next(Te[we++]),yt.closed||this.schedule())})})}(Te,ae);if((0,be.t)(Te))return function y(Te,ae){return(0,x.Xf)(Te).pipe(ie(ae),Q(ae))}(Te,ae);if((0,qe.D)(Te))return Ee(Te,ae);if((0,Ne.T)(Te))return function se(Te,ae){return new fe.y(yt=>{let we;return(0,d.f)(yt,ae,()=>{we=Te[De.h](),(0,d.f)(yt,ae,()=>{let Ze,Ae;try{({value:Ze,done:Ae}=we.next())}catch(ve){return void yt.error(ve)}Ae?yt.complete():yt.next(Ze)},0,!0)}),()=>(0,X.m)(we?.return)&&we.return()})}(Te,ae);if((0,Je.L)(Te))return function Me(Te,ae){return Ee((0,Je.Q)(Te),ae)}(Te,ae)}throw(0,_t.z)(Te)}(Te,ae):(0,x.Xf)(Te)}},2438:(zn,Dt,R)=>{"use strict";R.d(Dt,{R:()=>Se});var x=R(4829),d=R(5592),v=R(1631),s=R(4266),Q=R(4674),ie=R(7400);const q=["addListener","removeListener"],y=["addEventListener","removeEventListener"],fe=["on","off"];function Se(_e,be,Re,Ne){if((0,Q.m)(Re)&&(Ne=Re,Re=void 0),Ne)return Se(_e,be,Re).pipe((0,ie.Z)(Ne));const[qe,_t]=function Ee(_e){return(0,Q.m)(_e.addEventListener)&&(0,Q.m)(_e.removeEventListener)}(_e)?y.map(Je=>Me=>_e[Je](be,Me,Re)):function X(_e){return(0,Q.m)(_e.addListener)&&(0,Q.m)(_e.removeListener)}(_e)?q.map(De(_e,be)):function se(_e){return(0,Q.m)(_e.on)&&(0,Q.m)(_e.off)}(_e)?fe.map(De(_e,be)):[];if(!qe&&(0,s.z)(_e))return(0,v.z)(Je=>Se(Je,be,Re))((0,x.Xf)(_e));if(!qe)throw new TypeError("Invalid event target");return new d.y(Je=>{const Me=(...it)=>Je.next(1<it.length?it:it[0]);return qe(Me),()=>_t(Me)})}function De(_e,be){return Re=>Ne=>_e[Re](be,Ne)}},4829:(zn,Dt,R)=>{"use strict";R.d(Dt,{Xf:()=>se});var x=R(7582),d=R(4266),v=R(4026),s=R(5592),Q=R(8382),ie=R(5726),q=R(9853),y=R(3664),fe=R(541),Se=R(4674),De=R(3894),X=R(4850);function se(Je){if(Je instanceof s.y)return Je;if(null!=Je){if((0,Q.c)(Je))return function Ee(Je){return new s.y(Me=>{const it=Je[X.L]();if((0,Se.m)(it.subscribe))return it.subscribe(Me);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(Je);if((0,d.z)(Je))return function _e(Je){return new s.y(Me=>{for(let it=0;it<Je.length&&!Me.closed;it++)Me.next(Je[it]);Me.complete()})}(Je);if((0,v.t)(Je))return function be(Je){return new s.y(Me=>{Je.then(it=>{Me.closed||(Me.next(it),Me.complete())},it=>Me.error(it)).then(null,De.h)})}(Je);if((0,ie.D)(Je))return Ne(Je);if((0,y.T)(Je))return function Re(Je){return new s.y(Me=>{for(const it of Je)if(Me.next(it),Me.closed)return;Me.complete()})}(Je);if((0,fe.L)(Je))return function qe(Je){return Ne((0,fe.Q)(Je))}(Je)}throw(0,q.z)(Je)}function Ne(Je){return new s.y(Me=>{(function _t(Je,Me){var it,Xe,Te,ae;return(0,x.mG)(this,void 0,void 0,function*(){try{for(it=(0,x.KL)(Je);!(Xe=yield it.next()).done;)if(Me.next(Xe.value),Me.closed)return}catch(yt){Te={error:yt}}finally{try{Xe&&!Xe.done&&(ae=it.return)&&(yield ae.call(it))}finally{if(Te)throw Te.error}}Me.complete()})})(Je,Me).catch(it=>Me.error(it))})}},2096:(zn,Dt,R)=>{"use strict";R.d(Dt,{of:()=>v});var x=R(4564),d=R(7715);function v(...s){const Q=(0,x.yG)(s);return(0,d.D)(s,Q)}},8251:(zn,Dt,R)=>{"use strict";R.d(Dt,{x:()=>d});var x=R(1887);function d(s,Q,ie,q,y){return new v(s,Q,ie,q,y)}class v extends x.Lv{constructor(Q,ie,q,y,fe,Se){super(Q),this.onFinalize=fe,this.shouldUnsubscribe=Se,this._next=ie?function(De){try{ie(De)}catch(X){Q.error(X)}}:super._next,this._error=y?function(De){try{y(De)}catch(X){Q.error(X)}finally{this.unsubscribe()}}:super._error,this._complete=q?function(){try{q()}catch(De){Q.error(De)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var Q;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:ie}=this;super.unsubscribe(),!ie&&(null===(Q=this.onFinalize)||void 0===Q||Q.call(this))}}}},6328:(zn,Dt,R)=>{"use strict";R.d(Dt,{b:()=>v});var x=R(1631),d=R(4674);function v(s,Q){return(0,d.m)(Q)?(0,x.z)(s,Q,1):(0,x.z)(s,1)}},3997:(zn,Dt,R)=>{"use strict";R.d(Dt,{x:()=>s});var x=R(2737),d=R(9360),v=R(8251);function s(ie,q=x.y){return ie=ie??Q,(0,d.e)((y,fe)=>{let Se,De=!0;y.subscribe((0,v.x)(fe,X=>{const se=q(X);(De||!ie(Se,se))&&(De=!1,Se=se,fe.next(X))}))})}function Q(ie,q){return ie===q}},2181:(zn,Dt,R)=>{"use strict";R.d(Dt,{h:()=>v});var x=R(9360),d=R(8251);function v(s,Q){return(0,x.e)((ie,q)=>{let y=0;ie.subscribe((0,d.x)(q,fe=>s.call(Q,fe,y++)&&q.next(fe)))})}},4716:(zn,Dt,R)=>{"use strict";R.d(Dt,{x:()=>d});var x=R(9360);function d(v){return(0,x.e)((s,Q)=>{try{s.subscribe(Q)}finally{Q.add(v)}})}},7398:(zn,Dt,R)=>{"use strict";R.d(Dt,{U:()=>v});var x=R(9360),d=R(8251);function v(s,Q){return(0,x.e)((ie,q)=>{let y=0;ie.subscribe((0,d.x)(q,fe=>{q.next(s.call(Q,fe,y++))}))})}},7537:(zn,Dt,R)=>{"use strict";R.d(Dt,{J:()=>v});var x=R(1631),d=R(2737);function v(s=1/0){return(0,x.z)(d.y,s)}},1631:(zn,Dt,R)=>{"use strict";R.d(Dt,{z:()=>y});var x=R(7398),d=R(4829),v=R(9360),s=R(7103),Q=R(8251),q=R(4674);function y(fe,Se,De=1/0){return(0,q.m)(Se)?y((X,se)=>(0,x.U)((Ee,_e)=>Se(X,Ee,se,_e))((0,d.Xf)(fe(X,se))),De):("number"==typeof Se&&(De=Se),(0,v.e)((X,se)=>function ie(fe,Se,De,X,se,Ee,_e,be){const Re=[];let Ne=0,qe=0,_t=!1;const Je=()=>{_t&&!Re.length&&!Ne&&Se.complete()},Me=Xe=>Ne<X?it(Xe):Re.push(Xe),it=Xe=>{Ee&&Se.next(Xe),Ne++;let Te=!1;(0,d.Xf)(De(Xe,qe++)).subscribe((0,Q.x)(Se,ae=>{se?.(ae),Ee?Me(ae):Se.next(ae)},()=>{Te=!0},void 0,()=>{if(Te)try{for(Ne--;Re.length&&Ne<X;){const ae=Re.shift();_e?(0,s.f)(Se,_e,()=>it(ae)):it(ae)}Je()}catch(ae){Se.error(ae)}}))};return fe.subscribe((0,Q.x)(Se,Me,()=>{_t=!0,Je()})),()=>{be?.()}}(X,se,fe,De)))}},3020:(zn,Dt,R)=>{"use strict";R.d(Dt,{B:()=>Q});var x=R(4829),d=R(8645),v=R(1887),s=R(9360);function Q(q={}){const{connector:y=(()=>new d.x),resetOnError:fe=!0,resetOnComplete:Se=!0,resetOnRefCountZero:De=!0}=q;return X=>{let se,Ee,_e,be=0,Re=!1,Ne=!1;const qe=()=>{Ee?.unsubscribe(),Ee=void 0},_t=()=>{qe(),se=_e=void 0,Re=Ne=!1},Je=()=>{const Me=se;_t(),Me?.unsubscribe()};return(0,s.e)((Me,it)=>{be++,!Ne&&!Re&&qe();const Xe=_e=_e??y();it.add(()=>{be--,0===be&&!Ne&&!Re&&(Ee=ie(Je,De))}),Xe.subscribe(it),!se&&be>0&&(se=new v.Hp({next:Te=>Xe.next(Te),error:Te=>{Ne=!0,qe(),Ee=ie(_t,fe,Te),Xe.error(Te)},complete:()=>{Re=!0,qe(),Ee=ie(_t,Se),Xe.complete()}}),(0,x.Xf)(Me).subscribe(se))})(X)}}function ie(q,y,...fe){if(!0===y)return void q();if(!1===y)return;const Se=new v.Hp({next:()=>{Se.unsubscribe(),q()}});return(0,x.Xf)(y(...fe)).subscribe(Se)}},4664:(zn,Dt,R)=>{"use strict";R.d(Dt,{w:()=>s});var x=R(4829),d=R(9360),v=R(8251);function s(Q,ie){return(0,d.e)((q,y)=>{let fe=null,Se=0,De=!1;const X=()=>De&&!fe&&y.complete();q.subscribe((0,v.x)(y,se=>{fe?.unsubscribe();let Ee=0;const _e=Se++;(0,x.Xf)(Q(se,_e)).subscribe(fe=(0,v.x)(y,be=>y.next(ie?ie(se,be,_e,Ee++):be),()=>{fe=null,X()}))},()=>{De=!0,X()}))})}},8180:(zn,Dt,R)=>{"use strict";R.d(Dt,{q:()=>s});var x=R(6232),d=R(9360),v=R(8251);function s(Q){return Q<=0?()=>x.E:(0,d.e)((ie,q)=>{let y=0;ie.subscribe((0,v.x)(q,fe=>{++y<=Q&&(q.next(fe),Q<=y&&q.complete())}))})}},4552:(zn,Dt,R)=>{"use strict";R.d(Dt,{l:()=>x});const x={now:()=>(x.delegate||Date).now(),delegate:void 0}},7599:(zn,Dt,R)=>{"use strict";R.d(Dt,{z:()=>x});const x={setTimeout(d,v,...s){const{delegate:Q}=x;return Q?.setTimeout?Q.setTimeout(d,v,...s):setTimeout(d,v,...s)},clearTimeout(d){const{delegate:v}=x;return(v?.clearTimeout||clearTimeout)(d)},delegate:void 0}},4971:(zn,Dt,R)=>{"use strict";R.d(Dt,{h:()=>d});const d=function x(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}()},4850:(zn,Dt,R)=>{"use strict";R.d(Dt,{L:()=>x});const x="function"==typeof Symbol&&Symbol.observable||"@@observable"},4564:(zn,Dt,R)=>{"use strict";R.d(Dt,{_6:()=>ie,jO:()=>s,yG:()=>Q});var x=R(4674);function v(q){return q[q.length-1]}function s(q){return(0,x.m)(v(q))?q.pop():void 0}function Q(q){return function d(q){return q&&(0,x.m)(q.schedule)}(v(q))?q.pop():void 0}function ie(q,y){return"number"==typeof v(q)?q.pop():y}},7453:(zn,Dt,R)=>{"use strict";R.d(Dt,{D:()=>Q});const{isArray:x}=Array,{getPrototypeOf:d,prototype:v,keys:s}=Object;function Q(q){if(1===q.length){const y=q[0];if(x(y))return{args:y,keys:null};if(function ie(q){return q&&"object"==typeof q&&d(q)===v}(y)){const fe=s(y);return{args:fe.map(Se=>y[Se]),keys:fe}}}return{args:q,keys:null}}},9039:(zn,Dt,R)=>{"use strict";function x(d,v){if(d){const s=d.indexOf(v);0<=s&&d.splice(s,1)}}R.d(Dt,{P:()=>x})},2306:(zn,Dt,R)=>{"use strict";function x(d){const s=d(Q=>{Error.call(Q),Q.stack=(new Error).stack});return s.prototype=Object.create(Error.prototype),s.prototype.constructor=s,s}R.d(Dt,{d:()=>x})},2714:(zn,Dt,R)=>{"use strict";function x(d,v){return d.reduce((s,Q,ie)=>(s[Q]=v[ie],s),{})}R.d(Dt,{n:()=>x})},1441:(zn,Dt,R)=>{"use strict";R.d(Dt,{O:()=>s,x:()=>v});var x=R(2653);let d=null;function v(Q){if(x.config.useDeprecatedSynchronousErrorHandling){const ie=!d;if(ie&&(d={errorThrown:!1,error:null}),Q(),ie){const{errorThrown:q,error:y}=d;if(d=null,q)throw y}}else Q()}function s(Q){x.config.useDeprecatedSynchronousErrorHandling&&d&&(d.errorThrown=!0,d.error=Q)}},7103:(zn,Dt,R)=>{"use strict";function x(d,v,s,Q=0,ie=!1){const q=v.schedule(function(){s(),ie?d.add(this.schedule(null,Q)):this.unsubscribe()},Q);if(d.add(q),!ie)return q}R.d(Dt,{f:()=>x})},2737:(zn,Dt,R)=>{"use strict";function x(d){return d}R.d(Dt,{y:()=>x})},4266:(zn,Dt,R)=>{"use strict";R.d(Dt,{z:()=>x});const x=d=>d&&"number"==typeof d.length&&"function"!=typeof d},5726:(zn,Dt,R)=>{"use strict";R.d(Dt,{D:()=>d});var x=R(4674);function d(v){return Symbol.asyncIterator&&(0,x.m)(v?.[Symbol.asyncIterator])}},4674:(zn,Dt,R)=>{"use strict";function x(d){return"function"==typeof d}R.d(Dt,{m:()=>x})},8382:(zn,Dt,R)=>{"use strict";R.d(Dt,{c:()=>v});var x=R(4850),d=R(4674);function v(s){return(0,d.m)(s[x.L])}},3664:(zn,Dt,R)=>{"use strict";R.d(Dt,{T:()=>v});var x=R(4971),d=R(4674);function v(s){return(0,d.m)(s?.[x.h])}},2664:(zn,Dt,R)=>{"use strict";R.d(Dt,{b:()=>v});var x=R(5592),d=R(4674);function v(s){return!!s&&(s instanceof x.y||(0,d.m)(s.lift)&&(0,d.m)(s.subscribe))}},4026:(zn,Dt,R)=>{"use strict";R.d(Dt,{t:()=>d});var x=R(4674);function d(v){return(0,x.m)(v?.then)}},541:(zn,Dt,R)=>{"use strict";R.d(Dt,{L:()=>s,Q:()=>v});var x=R(7582),d=R(4674);function v(Q){return(0,x.FC)(this,arguments,function*(){const q=Q.getReader();try{for(;;){const{value:y,done:fe}=yield(0,x.qq)(q.read());if(fe)return yield(0,x.qq)(void 0);yield yield(0,x.qq)(y)}}finally{q.releaseLock()}})}function s(Q){return(0,d.m)(Q?.getReader)}},9360:(zn,Dt,R)=>{"use strict";R.d(Dt,{A:()=>d,e:()=>v});var x=R(4674);function d(s){return(0,x.m)(s?.lift)}function v(s){return Q=>{if(d(Q))return Q.lift(function(ie){try{return s(ie,this)}catch(q){this.error(q)}});throw new TypeError("Unable to lift unknown Observable type")}}},7400:(zn,Dt,R)=>{"use strict";R.d(Dt,{Z:()=>s});var x=R(7398);const{isArray:d}=Array;function s(Q){return(0,x.U)(ie=>function v(Q,ie){return d(ie)?Q(...ie):Q(ie)}(Q,ie))}},8407:(zn,Dt,R)=>{"use strict";R.d(Dt,{U:()=>v,z:()=>d});var x=R(2737);function d(...s){return v(s)}function v(s){return 0===s.length?x.y:1===s.length?s[0]:function(ie){return s.reduce((q,y)=>y(q),ie)}}},3894:(zn,Dt,R)=>{"use strict";R.d(Dt,{h:()=>v});var x=R(2653),d=R(7599);function v(s){d.z.setTimeout(()=>{const{onUnhandledError:Q}=x.config;if(!Q)throw s;Q(s)})}},9853:(zn,Dt,R)=>{"use strict";function x(d){return new TypeError(`You provided ${null!==d&&"object"==typeof d?"an invalid object":`'${d}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}R.d(Dt,{z:()=>x})},863:(zn,Dt,R)=>{var x={"./ion-accordion_2.entry.js":[8484,8592,8484],"./ion-action-sheet.entry.js":[9882,8592,9882],"./ion-alert.entry.js":[6304,8592,6304],"./ion-app_8.entry.js":[5860,8592,5860],"./ion-avatar_3.entry.js":[3544,3544],"./ion-back-button.entry.js":[505,8592,505],"./ion-backdrop.entry.js":[469,469],"./ion-breadcrumb_2.entry.js":[9857,8592,9857],"./ion-button_2.entry.js":[1372,1372],"./ion-card_5.entry.js":[3150,3150],"./ion-checkbox.entry.js":[7635,8592,7635],"./ion-chip.entry.js":[6673,6673],"./ion-col_3.entry.js":[1315,1315],"./ion-datetime-button.entry.js":[433,3591,433],"./ion-datetime_3.entry.js":[7059,3591,8592,7059],"./ion-fab_3.entry.js":[4087,8592,4087],"./ion-img.entry.js":[1745,1745],"./ion-infinite-scroll_2.entry.js":[9352,8592,9352],"./ion-input.entry.js":[4530,8592,4530],"./ion-item-option_3.entry.js":[8633,8592,8633],"./ion-item_8.entry.js":[5962,8592,5962],"./ion-loading.entry.js":[3483,3483],"./ion-menu_3.entry.js":[2939,8592,8382],"./ion-modal.entry.js":[8577,8592,8577],"./ion-nav_2.entry.js":[5675,8592,5675],"./ion-picker-column-internal.entry.js":[9992,8592,9992],"./ion-picker-internal.entry.js":[9820,9820],"./ion-popover.entry.js":[185,185],"./ion-progress-bar.entry.js":[5454,5454],"./ion-radio_2.entry.js":[4458,8592,4458],"./ion-range.entry.js":[7666,8592,7666],"./ion-refresher_2.entry.js":[7219,8592,7219],"./ion-reorder_2.entry.js":[2975,8592,2975],"./ion-ripple-effect.entry.js":[7465,7465],"./ion-route_4.entry.js":[4764,4764],"./ion-searchbar.entry.js":[3998,8592,3998],"./ion-segment_2.entry.js":[3672,8592,3672],"./ion-select_3.entry.js":[6754,8592,6754],"./ion-spinner.entry.js":[9588,8592,9588],"./ion-split-pane.entry.js":[9793,9793],"./ion-tab-bar_2.entry.js":[4090,8592,4090],"./ion-tab_2.entry.js":[2841,2841],"./ion-text.entry.js":[8811,8811],"./ion-textarea.entry.js":[3734,8592,3734],"./ion-toast.entry.js":[6642,6642],"./ion-toggle.entry.js":[8866,8592,8866]};function d(v){if(!R.o(x,v))return Promise.resolve().then(()=>{var ie=new Error("Cannot find module '"+v+"'");throw ie.code="MODULE_NOT_FOUND",ie});var s=x[v],Q=s[0];return Promise.all(s.slice(1).map(R.e)).then(()=>R(Q))}d.keys=()=>Object.keys(x),d.id=863,zn.exports=d},6814:(zn,Dt,R)=>{"use strict";R.d(Dt,{Do:()=>be,EM:()=>Qr,HT:()=>s,JF:()=>Ss,JJ:()=>jo,K0:()=>ie,Mx:()=>oo,O5:()=>Mr,PM:()=>br,S$:()=>se,V_:()=>y,Ye:()=>Re,b0:()=>_e,bD:()=>Xr,ez:()=>ta,q:()=>v,sg:()=>gr,tP:()=>Cn,uU:()=>ea,w_:()=>Q});var x=R(2029);let d=null;function v(){return d}function s(Z){d||(d=Z)}class Q{}const ie=new x.OlP("DocumentToken");let q=(()=>{class Z{historyGo(W){throw new Error("Not implemented")}}return Z.\u0275fac=function(W){return new(W||Z)},Z.\u0275prov=x.Yz7({token:Z,factory:function(){return(0,x.f3M)(fe)},providedIn:"platform"}),Z})();const y=new x.OlP("Location Initialized");let fe=(()=>{class Z extends q{constructor(){super(),this._doc=(0,x.f3M)(ie),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return v().getBaseHref(this._doc)}onPopState(W){const Ce=v().getGlobalEventTarget(this._doc,"window");return Ce.addEventListener("popstate",W,!1),()=>Ce.removeEventListener("popstate",W)}onHashChange(W){const Ce=v().getGlobalEventTarget(this._doc,"window");return Ce.addEventListener("hashchange",W,!1),()=>Ce.removeEventListener("hashchange",W)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(W){this._location.pathname=W}pushState(W,Ce,Tt){this._history.pushState(W,Ce,Tt)}replaceState(W,Ce,Tt){this._history.replaceState(W,Ce,Tt)}forward(){this._history.forward()}back(){this._history.back()}historyGo(W=0){this._history.go(W)}getState(){return this._history.state}}return Z.\u0275fac=function(W){return new(W||Z)},Z.\u0275prov=x.Yz7({token:Z,factory:function(){return new Z},providedIn:"platform"}),Z})();function Se(Z,de){if(0==Z.length)return de;if(0==de.length)return Z;let W=0;return Z.endsWith("/")&&W++,de.startsWith("/")&&W++,2==W?Z+de.substring(1):1==W?Z+de:Z+"/"+de}function De(Z){const de=Z.match(/#|\?|$/),W=de&&de.index||Z.length;return Z.slice(0,W-("/"===Z[W-1]?1:0))+Z.slice(W)}function X(Z){return Z&&"?"!==Z[0]?"?"+Z:Z}let se=(()=>{class Z{historyGo(W){throw new Error("Not implemented")}}return Z.\u0275fac=function(W){return new(W||Z)},Z.\u0275prov=x.Yz7({token:Z,factory:function(){return(0,x.f3M)(_e)},providedIn:"root"}),Z})();const Ee=new x.OlP("appBaseHref");let _e=(()=>{class Z extends se{constructor(W,Ce){super(),this._platformLocation=W,this._removeListenerFns=[],this._baseHref=Ce??this._platformLocation.getBaseHrefFromDOM()??(0,x.f3M)(ie).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(W){this._removeListenerFns.push(this._platformLocation.onPopState(W),this._platformLocation.onHashChange(W))}getBaseHref(){return this._baseHref}prepareExternalUrl(W){return Se(this._baseHref,W)}path(W=!1){const Ce=this._platformLocation.pathname+X(this._platformLocation.search),Tt=this._platformLocation.hash;return Tt&&W?`${Ce}${Tt}`:Ce}pushState(W,Ce,Tt,yn){const Dn=this.prepareExternalUrl(Tt+X(yn));this._platformLocation.pushState(W,Ce,Dn)}replaceState(W,Ce,Tt,yn){const Dn=this.prepareExternalUrl(Tt+X(yn));this._platformLocation.replaceState(W,Ce,Dn)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(W=0){this._platformLocation.historyGo?.(W)}}return Z.\u0275fac=function(W){return new(W||Z)(x.LFG(q),x.LFG(Ee,8))},Z.\u0275prov=x.Yz7({token:Z,factory:Z.\u0275fac,providedIn:"root"}),Z})(),be=(()=>{class Z extends se{constructor(W,Ce){super(),this._platformLocation=W,this._baseHref="",this._removeListenerFns=[],null!=Ce&&(this._baseHref=Ce)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(W){this._removeListenerFns.push(this._platformLocation.onPopState(W),this._platformLocation.onHashChange(W))}getBaseHref(){return this._baseHref}path(W=!1){let Ce=this._platformLocation.hash;return null==Ce&&(Ce="#"),Ce.length>0?Ce.substring(1):Ce}prepareExternalUrl(W){const Ce=Se(this._baseHref,W);return Ce.length>0?"#"+Ce:Ce}pushState(W,Ce,Tt,yn){let Dn=this.prepareExternalUrl(Tt+X(yn));0==Dn.length&&(Dn=this._platformLocation.pathname),this._platformLocation.pushState(W,Ce,Dn)}replaceState(W,Ce,Tt,yn){let Dn=this.prepareExternalUrl(Tt+X(yn));0==Dn.length&&(Dn=this._platformLocation.pathname),this._platformLocation.replaceState(W,Ce,Dn)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(W=0){this._platformLocation.historyGo?.(W)}}return Z.\u0275fac=function(W){return new(W||Z)(x.LFG(q),x.LFG(Ee,8))},Z.\u0275prov=x.Yz7({token:Z,factory:Z.\u0275fac}),Z})(),Re=(()=>{class Z{constructor(W){this._subject=new x.vpe,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=W;const Ce=this._locationStrategy.getBaseHref();this._basePath=function Je(Z){if(new RegExp("^(https?:)?//").test(Z)){const[,W]=Z.split(/\/\/[^\/]+/);return W}return Z}(De(_t(Ce))),this._locationStrategy.onPopState(Tt=>{this._subject.emit({url:this.path(!0),pop:!0,state:Tt.state,type:Tt.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(W=!1){return this.normalize(this._locationStrategy.path(W))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(W,Ce=""){return this.path()==this.normalize(W+X(Ce))}normalize(W){return Z.stripTrailingSlash(function qe(Z,de){if(!Z||!de.startsWith(Z))return de;const W=de.substring(Z.length);return""===W||["/",";","?","#"].includes(W[0])?W:de}(this._basePath,_t(W)))}prepareExternalUrl(W){return W&&"/"!==W[0]&&(W="/"+W),this._locationStrategy.prepareExternalUrl(W)}go(W,Ce="",Tt=null){this._locationStrategy.pushState(Tt,"",W,Ce),this._notifyUrlChangeListeners(this.prepareExternalUrl(W+X(Ce)),Tt)}replaceState(W,Ce="",Tt=null){this._locationStrategy.replaceState(Tt,"",W,Ce),this._notifyUrlChangeListeners(this.prepareExternalUrl(W+X(Ce)),Tt)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(W=0){this._locationStrategy.historyGo?.(W)}onUrlChange(W){return this._urlChangeListeners.push(W),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(Ce=>{this._notifyUrlChangeListeners(Ce.url,Ce.state)})),()=>{const Ce=this._urlChangeListeners.indexOf(W);this._urlChangeListeners.splice(Ce,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(W="",Ce){this._urlChangeListeners.forEach(Tt=>Tt(W,Ce))}subscribe(W,Ce,Tt){return this._subject.subscribe({next:W,error:Ce,complete:Tt})}}return Z.normalizeQueryParams=X,Z.joinWithSlash=Se,Z.stripTrailingSlash=De,Z.\u0275fac=function(W){return new(W||Z)(x.LFG(se))},Z.\u0275prov=x.Yz7({token:Z,factory:function(){return function Ne(){return new Re((0,x.LFG)(se))}()},providedIn:"root"}),Z})();function _t(Z){return Z.replace(/\/index.html$/,"")}var it=(()=>((it=it||{})[it.Decimal=0]="Decimal",it[it.Percent=1]="Percent",it[it.Currency=2]="Currency",it[it.Scientific=3]="Scientific",it))(),Te=(()=>((Te=Te||{})[Te.Format=0]="Format",Te[Te.Standalone=1]="Standalone",Te))(),ae=(()=>((ae=ae||{})[ae.Narrow=0]="Narrow",ae[ae.Abbreviated=1]="Abbreviated",ae[ae.Wide=2]="Wide",ae[ae.Short=3]="Short",ae))(),yt=(()=>((yt=yt||{})[yt.Short=0]="Short",yt[yt.Medium=1]="Medium",yt[yt.Long=2]="Long",yt[yt.Full=3]="Full",yt))(),we=(()=>((we=we||{})[we.Decimal=0]="Decimal",we[we.Group=1]="Group",we[we.List=2]="List",we[we.PercentSign=3]="PercentSign",we[we.PlusSign=4]="PlusSign",we[we.MinusSign=5]="MinusSign",we[we.Exponential=6]="Exponential",we[we.SuperscriptingExponent=7]="SuperscriptingExponent",we[we.PerMille=8]="PerMille",we[we.Infinity=9]="Infinity",we[we.NaN=10]="NaN",we[we.TimeSeparator=11]="TimeSeparator",we[we.CurrencyDecimal=12]="CurrencyDecimal",we[we.CurrencyGroup=13]="CurrencyGroup",we))();function xt(Z,de){return dn((0,x.cg1)(Z)[x.wAp.DateFormat],de)}function Ve(Z,de){return dn((0,x.cg1)(Z)[x.wAp.TimeFormat],de)}function gt(Z,de){return dn((0,x.cg1)(Z)[x.wAp.DateTimeFormat],de)}function Be(Z,de){const W=(0,x.cg1)(Z),Ce=W[x.wAp.NumberSymbols][de];if(typeof Ce>"u"){if(de===we.CurrencyDecimal)return W[x.wAp.NumberSymbols][we.Decimal];if(de===we.CurrencyGroup)return W[x.wAp.NumberSymbols][we.Group]}return Ce}function Vt(Z){if(!Z[x.wAp.ExtraData])throw new Error(`Missing extra locale data for the locale "${Z[x.wAp.LocaleId]}". Use "registerLocaleData" to load new data. See the "I18n guide" on angular.io to know more.`)}function dn(Z,de){for(let W=de;W>-1;W--)if(typeof Z[W]<"u")return Z[W];throw new Error("Locale data API: locale data undefined")}function Sn(Z){const[de,W]=Z.split(":");return{hours:+de,minutes:+W}}const Ci=/^(\d{4,})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,Ji={},Hi=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/;var Fi=(()=>((Fi=Fi||{})[Fi.Short=0]="Short",Fi[Fi.ShortGMT=1]="ShortGMT",Fi[Fi.Long=2]="Long",Fi[Fi.Extended=3]="Extended",Fi))(),ii=(()=>((ii=ii||{})[ii.FullYear=0]="FullYear",ii[ii.Month=1]="Month",ii[ii.Date=2]="Date",ii[ii.Hours=3]="Hours",ii[ii.Minutes=4]="Minutes",ii[ii.Seconds=5]="Seconds",ii[ii.FractionalSeconds=6]="FractionalSeconds",ii[ii.Day=7]="Day",ii))(),mi=(()=>((mi=mi||{})[mi.DayPeriods=0]="DayPeriods",mi[mi.Days=1]="Days",mi[mi.Months=2]="Months",mi[mi.Eras=3]="Eras",mi))();function xn(Z,de,W,Ce){let Tt=function Ue(Z){if(me(Z))return Z;if("number"==typeof Z&&!isNaN(Z))return new Date(Z);if("string"==typeof Z){if(Z=Z.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(Z)){const[Tt,yn=1,Dn=1]=Z.split("-").map(Xn=>+Xn);return Qt(Tt,yn-1,Dn)}const W=parseFloat(Z);if(!isNaN(Z-W))return new Date(W);let Ce;if(Ce=Z.match(Ci))return function Y(Z){const de=new Date(0);let W=0,Ce=0;const Tt=Z[8]?de.setUTCFullYear:de.setFullYear,yn=Z[8]?de.setUTCHours:de.setHours;Z[9]&&(W=Number(Z[9]+Z[10]),Ce=Number(Z[9]+Z[11])),Tt.call(de,Number(Z[1]),Number(Z[2])-1,Number(Z[3]));const Dn=Number(Z[4]||0)-W,Xn=Number(Z[5]||0)-Ce,Eo=Number(Z[6]||0),yo=Math.floor(1e3*parseFloat("0."+(Z[7]||0)));return yn.call(de,Dn,Xn,Eo,yo),de}(Ce)}const de=new Date(Z);if(!me(de))throw new Error(`Unable to convert "${Z}" into a date`);return de}(Z);de=Mt(W,de)||de;let Xn,Dn=[];for(;de;){if(Xn=Hi.exec(de),!Xn){Dn.push(de);break}{Dn=Dn.concat(Xn.slice(1));const Xi=Dn.pop();if(!Xi)break;de=Xi}}let Eo=Tt.getTimezoneOffset();Ce&&(Eo=Kt(Ce,Eo),Tt=function et(Z,de,W){const Ce=W?-1:1,Tt=Z.getTimezoneOffset();return function In(Z,de){return(Z=new Date(Z.getTime())).setMinutes(Z.getMinutes()+de),Z}(Z,Ce*(Kt(de,Tt)-Tt))}(Tt,Ce,!0));let yo="";return Dn.forEach(Xi=>{const co=function Pt(Z){if(jt[Z])return jt[Z];let de;switch(Z){case"G":case"GG":case"GGG":de=ri(mi.Eras,ae.Abbreviated);break;case"GGGG":de=ri(mi.Eras,ae.Wide);break;case"GGGGG":de=ri(mi.Eras,ae.Narrow);break;case"y":de=pn(ii.FullYear,1,0,!1,!0);break;case"yy":de=pn(ii.FullYear,2,0,!0,!0);break;case"yyy":de=pn(ii.FullYear,3,0,!1,!0);break;case"yyyy":de=pn(ii.FullYear,4,0,!1,!0);break;case"Y":de=Zt(1);break;case"YY":de=Zt(2,!0);break;case"YYY":de=Zt(3);break;case"YYYY":de=Zt(4);break;case"M":case"L":de=pn(ii.Month,1,1);break;case"MM":case"LL":de=pn(ii.Month,2,1);break;case"MMM":de=ri(mi.Months,ae.Abbreviated);break;case"MMMM":de=ri(mi.Months,ae.Wide);break;case"MMMMM":de=ri(mi.Months,ae.Narrow);break;case"LLL":de=ri(mi.Months,ae.Abbreviated,Te.Standalone);break;case"LLLL":de=ri(mi.Months,ae.Wide,Te.Standalone);break;case"LLLLL":de=ri(mi.Months,ae.Narrow,Te.Standalone);break;case"w":de=Lt(1);break;case"ww":de=Lt(2);break;case"W":de=Lt(1,!0);break;case"d":de=pn(ii.Date,1);break;case"dd":de=pn(ii.Date,2);break;case"c":case"cc":de=pn(ii.Day,1);break;case"ccc":de=ri(mi.Days,ae.Abbreviated,Te.Standalone);break;case"cccc":de=ri(mi.Days,ae.Wide,Te.Standalone);break;case"ccccc":de=ri(mi.Days,ae.Narrow,Te.Standalone);break;case"cccccc":de=ri(mi.Days,ae.Short,Te.Standalone);break;case"E":case"EE":case"EEE":de=ri(mi.Days,ae.Abbreviated);break;case"EEEE":de=ri(mi.Days,ae.Wide);break;case"EEEEE":de=ri(mi.Days,ae.Narrow);break;case"EEEEEE":de=ri(mi.Days,ae.Short);break;case"a":case"aa":case"aaa":de=ri(mi.DayPeriods,ae.Abbreviated);break;case"aaaa":de=ri(mi.DayPeriods,ae.Wide);break;case"aaaaa":de=ri(mi.DayPeriods,ae.Narrow);break;case"b":case"bb":case"bbb":de=ri(mi.DayPeriods,ae.Abbreviated,Te.Standalone,!0);break;case"bbbb":de=ri(mi.DayPeriods,ae.Wide,Te.Standalone,!0);break;case"bbbbb":de=ri(mi.DayPeriods,ae.Narrow,Te.Standalone,!0);break;case"B":case"BB":case"BBB":de=ri(mi.DayPeriods,ae.Abbreviated,Te.Format,!0);break;case"BBBB":de=ri(mi.DayPeriods,ae.Wide,Te.Format,!0);break;case"BBBBB":de=ri(mi.DayPeriods,ae.Narrow,Te.Format,!0);break;case"h":de=pn(ii.Hours,1,-12);break;case"hh":de=pn(ii.Hours,2,-12);break;case"H":de=pn(ii.Hours,1);break;case"HH":de=pn(ii.Hours,2);break;case"m":de=pn(ii.Minutes,1);break;case"mm":de=pn(ii.Minutes,2);break;case"s":de=pn(ii.Seconds,1);break;case"ss":de=pn(ii.Seconds,2);break;case"S":de=pn(ii.FractionalSeconds,1);break;case"SS":de=pn(ii.FractionalSeconds,2);break;case"SSS":de=pn(ii.FractionalSeconds,3);break;case"Z":case"ZZ":case"ZZZ":de=ut(Fi.Short);break;case"ZZZZZ":de=ut(Fi.Extended);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":de=ut(Fi.ShortGMT);break;case"OOOO":case"ZZZZ":case"zzzz":de=ut(Fi.Long);break;default:return null}return jt[Z]=de,de}(Xi);yo+=co?co(Tt,W,Eo):"''"===Xi?"'":Xi.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),yo}function Qt(Z,de,W){const Ce=new Date(0);return Ce.setFullYear(Z,de,W),Ce.setHours(0,0,0),Ce}function Mt(Z,de){const W=function Ae(Z){return(0,x.cg1)(Z)[x.wAp.LocaleId]}(Z);if(Ji[W]=Ji[W]||{},Ji[W][de])return Ji[W][de];let Ce="";switch(de){case"shortDate":Ce=xt(Z,yt.Short);break;case"mediumDate":Ce=xt(Z,yt.Medium);break;case"longDate":Ce=xt(Z,yt.Long);break;case"fullDate":Ce=xt(Z,yt.Full);break;case"shortTime":Ce=Ve(Z,yt.Short);break;case"mediumTime":Ce=Ve(Z,yt.Medium);break;case"longTime":Ce=Ve(Z,yt.Long);break;case"fullTime":Ce=Ve(Z,yt.Full);break;case"short":const Tt=Mt(Z,"shortTime"),yn=Mt(Z,"shortDate");Ce=ge(gt(Z,yt.Short),[Tt,yn]);break;case"medium":const Dn=Mt(Z,"mediumTime"),Xn=Mt(Z,"mediumDate");Ce=ge(gt(Z,yt.Medium),[Dn,Xn]);break;case"long":const Eo=Mt(Z,"longTime"),yo=Mt(Z,"longDate");Ce=ge(gt(Z,yt.Long),[Eo,yo]);break;case"full":const Xi=Mt(Z,"fullTime"),co=Mt(Z,"fullDate");Ce=ge(gt(Z,yt.Full),[Xi,co])}return Ce&&(Ji[W][de]=Ce),Ce}function ge(Z,de){return de&&(Z=Z.replace(/\{([^}]+)}/g,function(W,Ce){return null!=de&&Ce in de?de[Ce]:W})),Z}function ct(Z,de,W="-",Ce,Tt){let yn="";(Z<0||Tt&&Z<=0)&&(Tt?Z=1-Z:(Z=-Z,yn=W));let Dn=String(Z);for(;Dn.length<de;)Dn="0"+Dn;return Ce&&(Dn=Dn.slice(Dn.length-de)),yn+Dn}function pn(Z,de,W=0,Ce=!1,Tt=!1){return function(yn,Dn){let Xn=function Gi(Z,de){switch(Z){case ii.FullYear:return de.getFullYear();case ii.Month:return de.getMonth();case ii.Date:return de.getDate();case ii.Hours:return de.getHours();case ii.Minutes:return de.getMinutes();case ii.Seconds:return de.getSeconds();case ii.FractionalSeconds:return de.getMilliseconds();case ii.Day:return de.getDay();default:throw new Error(`Unknown DateType value "${Z}".`)}}(Z,yn);if((W>0||Xn>-W)&&(Xn+=W),Z===ii.Hours)0===Xn&&-12===W&&(Xn=12);else if(Z===ii.FractionalSeconds)return function Gt(Z,de){return ct(Z,3).substring(0,de)}(Xn,de);const Eo=Be(Dn,we.MinusSign);return ct(Xn,de,Eo,Ce,Tt)}}function ri(Z,de,W=Te.Format,Ce=!1){return function(Tt,yn){return function Vo(Z,de,W,Ce,Tt,yn){switch(W){case mi.Months:return function dt(Z,de,W){const Ce=(0,x.cg1)(Z),yn=dn([Ce[x.wAp.MonthsFormat],Ce[x.wAp.MonthsStandalone]],de);return dn(yn,W)}(de,Tt,Ce)[Z.getMonth()];case mi.Days:return function en(Z,de,W){const Ce=(0,x.cg1)(Z),yn=dn([Ce[x.wAp.DaysFormat],Ce[x.wAp.DaysStandalone]],de);return dn(yn,W)}(de,Tt,Ce)[Z.getDay()];case mi.DayPeriods:const Dn=Z.getHours(),Xn=Z.getMinutes();if(yn){const yo=function St(Z){const de=(0,x.cg1)(Z);return Vt(de),(de[x.wAp.ExtraData][2]||[]).map(Ce=>"string"==typeof Ce?Sn(Ce):[Sn(Ce[0]),Sn(Ce[1])])}(de),Xi=function st(Z,de,W){const Ce=(0,x.cg1)(Z);Vt(Ce);const yn=dn([Ce[x.wAp.ExtraData][0],Ce[x.wAp.ExtraData][1]],de)||[];return dn(yn,W)||[]}(de,Tt,Ce),co=yo.findIndex(fr=>{if(Array.isArray(fr)){const[Ro,Do]=fr,Ls=Dn>=Ro.hours&&Xn>=Ro.minutes,Ds=Dn<Do.hours||Dn===Do.hours&&Xn<Do.minutes;if(Ro.hours<Do.hours){if(Ls&&Ds)return!0}else if(Ls||Ds)return!0}else if(fr.hours===Dn&&fr.minutes===Xn)return!0;return!1});if(-1!==co)return Xi[co]}return function ve(Z,de,W){const Ce=(0,x.cg1)(Z),yn=dn([Ce[x.wAp.DayPeriodsFormat],Ce[x.wAp.DayPeriodsStandalone]],de);return dn(yn,W)}(de,Tt,Ce)[Dn<12?0:1];case mi.Eras:return function mt(Z,de){return dn((0,x.cg1)(Z)[x.wAp.Eras],de)}(de,Ce)[Z.getFullYear()<=0?0:1];default:throw new Error(`unexpected translation type ${W}`)}}(Tt,yn,Z,de,W,Ce)}}function ut(Z){return function(de,W,Ce){const Tt=-1*Ce,yn=Be(W,we.MinusSign),Dn=Tt>0?Math.floor(Tt/60):Math.ceil(Tt/60);switch(Z){case Fi.Short:return(Tt>=0?"+":"")+ct(Dn,2,yn)+ct(Math.abs(Tt%60),2,yn);case Fi.ShortGMT:return"GMT"+(Tt>=0?"+":"")+ct(Dn,1,yn);case Fi.Long:return"GMT"+(Tt>=0?"+":"")+ct(Dn,2,yn)+":"+ct(Math.abs(Tt%60),2,yn);case Fi.Extended:return 0===Ce?"Z":(Tt>=0?"+":"")+ct(Dn,2,yn)+":"+ct(Math.abs(Tt%60),2,yn);default:throw new Error(`Unknown zone width "${Z}"`)}}}const pe=0,xe=4;function vt(Z){return Qt(Z.getFullYear(),Z.getMonth(),Z.getDate()+(xe-Z.getDay()))}function Lt(Z,de=!1){return function(W,Ce){let Tt;if(de){const yn=new Date(W.getFullYear(),W.getMonth(),1).getDay()-1,Dn=W.getDate();Tt=1+Math.floor((Dn+yn)/7)}else{const yn=vt(W),Dn=function Qe(Z){const de=Qt(Z,pe,1).getDay();return Qt(Z,0,1+(de<=xe?xe:xe+7)-de)}(yn.getFullYear()),Xn=yn.getTime()-Dn.getTime();Tt=1+Math.round(Xn/6048e5)}return ct(Tt,Z,Be(Ce,we.MinusSign))}}function Zt(Z,de=!1){return function(W,Ce){return ct(vt(W).getFullYear(),Z,Be(Ce,we.MinusSign),de)}}const jt={};function Kt(Z,de){Z=Z.replace(/:/g,"");const W=Date.parse("Jan 01, 1970 00:00:00 "+Z)/6e4;return isNaN(W)?de:W}function me(Z){return Z instanceof Date&&!isNaN(Z.valueOf())}const Ge=/^(\d+)?\.((\d+)(-(\d+))?)?$/;function xi(Z){const de=parseInt(Z);if(isNaN(de))throw new Error("Invalid integer literal when parsing "+Z);return de}function oo(Z,de){de=encodeURIComponent(de);for(const W of Z.split(";")){const Ce=W.indexOf("="),[Tt,yn]=-1==Ce?[W,""]:[W.slice(0,Ce),W.slice(Ce+1)];if(Tt.trim()===de)return decodeURIComponent(yn)}return null}class Ki{constructor(de,W,Ce,Tt){this.$implicit=de,this.ngForOf=W,this.index=Ce,this.count=Tt}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let gr=(()=>{class Z{set ngForOf(W){this._ngForOf=W,this._ngForOfDirty=!0}set ngForTrackBy(W){this._trackByFn=W}get ngForTrackBy(){return this._trackByFn}constructor(W,Ce,Tt){this._viewContainer=W,this._template=Ce,this._differs=Tt,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(W){W&&(this._template=W)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const W=this._ngForOf;!this._differ&&W&&(this._differ=this._differs.find(W).create(this.ngForTrackBy))}if(this._differ){const W=this._differ.diff(this._ngForOf);W&&this._applyChanges(W)}}_applyChanges(W){const Ce=this._viewContainer;W.forEachOperation((Tt,yn,Dn)=>{if(null==Tt.previousIndex)Ce.createEmbeddedView(this._template,new Ki(Tt.item,this._ngForOf,-1,-1),null===Dn?void 0:Dn);else if(null==Dn)Ce.remove(null===yn?void 0:yn);else if(null!==yn){const Xn=Ce.get(yn);Ce.move(Xn,Dn),bo(Xn,Tt)}});for(let Tt=0,yn=Ce.length;Tt<yn;Tt++){const Xn=Ce.get(Tt).context;Xn.index=Tt,Xn.count=yn,Xn.ngForOf=this._ngForOf}W.forEachIdentityChange(Tt=>{bo(Ce.get(Tt.currentIndex),Tt)})}static ngTemplateContextGuard(W,Ce){return!0}}return Z.\u0275fac=function(W){return new(W||Z)(x.Y36(x.s_b),x.Y36(x.Rgc),x.Y36(x.ZZ4))},Z.\u0275dir=x.lG2({type:Z,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0}),Z})();function bo(Z,de){Z.context.$implicit=de.item}let Mr=(()=>{class Z{constructor(W,Ce){this._viewContainer=W,this._context=new kr,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=Ce}set ngIf(W){this._context.$implicit=this._context.ngIf=W,this._updateView()}set ngIfThen(W){Qn("ngIfThen",W),this._thenTemplateRef=W,this._thenViewRef=null,this._updateView()}set ngIfElse(W){Qn("ngIfElse",W),this._elseTemplateRef=W,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(W,Ce){return!0}}return Z.\u0275fac=function(W){return new(W||Z)(x.Y36(x.s_b),x.Y36(x.Rgc))},Z.\u0275dir=x.lG2({type:Z,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0}),Z})();class kr{constructor(){this.$implicit=null,this.ngIf=null}}function Qn(Z,de){if(de&&!de.createEmbeddedView)throw new Error(`${Z} must be a TemplateRef, but received '${(0,x.AaK)(de)}'.`)}let Cn=(()=>{class Z{constructor(W){this._viewContainerRef=W,this._viewRef=null,this.ngTemplateOutletContext=null,this.ngTemplateOutlet=null,this.ngTemplateOutletInjector=null}ngOnChanges(W){if(W.ngTemplateOutlet||W.ngTemplateOutletInjector){const Ce=this._viewContainerRef;if(this._viewRef&&Ce.remove(Ce.indexOf(this._viewRef)),this.ngTemplateOutlet){const{ngTemplateOutlet:Tt,ngTemplateOutletContext:yn,ngTemplateOutletInjector:Dn}=this;this._viewRef=Ce.createEmbeddedView(Tt,yn,Dn?{injector:Dn}:void 0)}else this._viewRef=null}else this._viewRef&&W.ngTemplateOutletContext&&this.ngTemplateOutletContext&&(this._viewRef.context=this.ngTemplateOutletContext)}}return Z.\u0275fac=function(W){return new(W||Z)(x.Y36(x.s_b))},Z.\u0275dir=x.lG2({type:Z,selectors:[["","ngTemplateOutlet",""]],inputs:{ngTemplateOutletContext:"ngTemplateOutletContext",ngTemplateOutlet:"ngTemplateOutlet",ngTemplateOutletInjector:"ngTemplateOutletInjector"},standalone:!0,features:[x.TTD]}),Z})();function On(Z,de){return new x.vHH(2100,!1)}const Co=new x.OlP("DATE_PIPE_DEFAULT_TIMEZONE"),xs=new x.OlP("DATE_PIPE_DEFAULT_OPTIONS");let ea=(()=>{class Z{constructor(W,Ce,Tt){this.locale=W,this.defaultTimezone=Ce,this.defaultOptions=Tt}transform(W,Ce,Tt,yn){if(null==W||""===W||W!=W)return null;try{return xn(W,Ce??this.defaultOptions?.dateFormat??"mediumDate",yn||this.locale,Tt??this.defaultOptions?.timezone??this.defaultTimezone??void 0)}catch(Dn){throw On()}}}return Z.\u0275fac=function(W){return new(W||Z)(x.Y36(x.soG,16),x.Y36(Co,24),x.Y36(xs,24))},Z.\u0275pipe=x.Yjl({name:"date",type:Z,pure:!0,standalone:!0}),Z})(),jo=(()=>{class Z{constructor(W){this._locale=W}transform(W,Ce,Tt){if(!function Ur(Z){return!(null==Z||""===Z||Z!=Z)}(W))return null;Tt=Tt||this._locale;try{return function Nn(Z,de,W){return function nn(Z,de,W,Ce,Tt,yn,Dn=!1){let Xn="",Eo=!1;if(isFinite(Z)){let yo=function ti(Z){let Ce,Tt,yn,Dn,Xn,de=Math.abs(Z)+"",W=0;for((Tt=de.indexOf("."))>-1&&(de=de.replace(".","")),(yn=de.search(/e/i))>0?(Tt<0&&(Tt=yn),Tt+=+de.slice(yn+1),de=de.substring(0,yn)):Tt<0&&(Tt=de.length),yn=0;"0"===de.charAt(yn);yn++);if(yn===(Xn=de.length))Ce=[0],Tt=1;else{for(Xn--;"0"===de.charAt(Xn);)Xn--;for(Tt-=yn,Ce=[],Dn=0;yn<=Xn;yn++,Dn++)Ce[Dn]=Number(de.charAt(yn))}return Tt>22&&(Ce=Ce.splice(0,21),W=Tt-1,Tt=1),{digits:Ce,exponent:W,integerLen:Tt}}(Z);Dn&&(yo=function oi(Z){if(0===Z.digits[0])return Z;const de=Z.digits.length-Z.integerLen;return Z.exponent?Z.exponent+=2:(0===de?Z.digits.push(0,0):1===de&&Z.digits.push(0),Z.integerLen+=2),Z}(yo));let Xi=de.minInt,co=de.minFrac,fr=de.maxFrac;if(yn){const Vr=yn.match(Ge);if(null===Vr)throw new Error(`${yn} is not a valid digit info`);const qs=Vr[1],os=Vr[3],ki=Vr[5];null!=qs&&(Xi=xi(qs)),null!=os&&(co=xi(os)),null!=ki?fr=xi(ki):null!=os&&co>fr&&(fr=co)}!function qi(Z,de,W){if(de>W)throw new Error(`The minimum number of digits after fraction (${de}) is higher than the maximum (${W}).`);let Ce=Z.digits,Tt=Ce.length-Z.integerLen;const yn=Math.min(Math.max(de,Tt),W);let Dn=yn+Z.integerLen,Xn=Ce[Dn];if(Dn>0){Ce.splice(Math.max(Z.integerLen,Dn));for(let co=Dn;co<Ce.length;co++)Ce[co]=0}else{Tt=Math.max(0,Tt),Z.integerLen=1,Ce.length=Math.max(1,Dn=yn+1),Ce[0]=0;for(let co=1;co<Dn;co++)Ce[co]=0}if(Xn>=5)if(Dn-1<0){for(let co=0;co>Dn;co--)Ce.unshift(0),Z.integerLen++;Ce.unshift(1),Z.integerLen++}else Ce[Dn-1]++;for(;Tt<Math.max(0,yn);Tt++)Ce.push(0);let Eo=0!==yn;const yo=de+Z.integerLen,Xi=Ce.reduceRight(function(co,fr,Ro,Do){return Do[Ro]=(fr+=co)<10?fr:fr-10,Eo&&(0===Do[Ro]&&Ro>=yo?Do.pop():Eo=!1),fr>=10?1:0},0);Xi&&(Ce.unshift(Xi),Z.integerLen++)}(yo,co,fr);let Ro=yo.digits,Do=yo.integerLen;const Ls=yo.exponent;let Ds=[];for(Eo=Ro.every(Vr=>!Vr);Do<Xi;Do++)Ro.unshift(0);for(;Do<0;Do++)Ro.unshift(0);Do>0?Ds=Ro.splice(Do,Ro.length):(Ds=Ro,Ro=[0]);const fs=[];for(Ro.length>=de.lgSize&&fs.unshift(Ro.splice(-de.lgSize,Ro.length).join(""));Ro.length>de.gSize;)fs.unshift(Ro.splice(-de.gSize,Ro.length).join(""));Ro.length&&fs.unshift(Ro.join("")),Xn=fs.join(Be(W,Ce)),Ds.length&&(Xn+=Be(W,Tt)+Ds.join("")),Ls&&(Xn+=Be(W,we.Exponential)+"+"+Ls)}else Xn=Be(W,we.Infinity);return Xn=Z<0&&!Eo?de.negPre+Xn+de.negSuf:de.posPre+Xn+de.posSuf,Xn}(Z,function Pn(Z,de="-"){const W={minInt:1,minFrac:0,maxFrac:0,posPre:"",posSuf:"",negPre:"",negSuf:"",gSize:0,lgSize:0},Ce=Z.split(";"),Tt=Ce[0],yn=Ce[1],Dn=-1!==Tt.indexOf(".")?Tt.split("."):[Tt.substring(0,Tt.lastIndexOf("0")+1),Tt.substring(Tt.lastIndexOf("0")+1)],Xn=Dn[0],Eo=Dn[1]||"";W.posPre=Xn.substring(0,Xn.indexOf("#"));for(let Xi=0;Xi<Eo.length;Xi++){const co=Eo.charAt(Xi);"0"===co?W.minFrac=W.maxFrac=Xi+1:"#"===co?W.maxFrac=Xi+1:W.posSuf+=co}const yo=Xn.split(",");if(W.gSize=yo[1]?yo[1].length:0,W.lgSize=yo[2]||yo[1]?(yo[2]||yo[1]).length:0,yn){const Xi=Tt.length-W.posPre.length-W.posSuf.length,co=yn.indexOf("#");W.negPre=yn.substring(0,co).replace(/'/g,""),W.negSuf=yn.slice(co+Xi).replace(/'/g,"")}else W.negPre=de+W.posPre,W.negSuf=W.posSuf;return W}(function Bt(Z,de){return(0,x.cg1)(Z)[x.wAp.NumberFormats][de]}(de,it.Decimal),Be(de,we.MinusSign)),de,we.Group,we.Decimal,W)}(function xr(Z){if("string"==typeof Z&&!isNaN(Number(Z)-parseFloat(Z)))return Number(Z);if("number"!=typeof Z)throw new Error(`${Z} is not a number`);return Z}(W),Tt,Ce)}catch(yn){throw On()}}}return Z.\u0275fac=function(W){return new(W||Z)(x.Y36(x.soG,16))},Z.\u0275pipe=x.Yjl({name:"number",type:Z,pure:!0,standalone:!0}),Z})();let ta=(()=>{class Z{}return Z.\u0275fac=function(W){return new(W||Z)},Z.\u0275mod=x.oAB({type:Z}),Z.\u0275inj=x.cJS({}),Z})();const Xr="browser",ko="server";function br(Z){return Z===ko}let Qr=(()=>{class Z{}return Z.\u0275prov=(0,x.Yz7)({token:Z,providedIn:"root",factory:()=>new ws((0,x.LFG)(ie),window)}),Z})();class ws{constructor(de,W){this.document=de,this.window=W,this.offset=()=>[0,0]}setOffset(de){this.offset=Array.isArray(de)?()=>de:de}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(de){this.supportsScrolling()&&this.window.scrollTo(de[0],de[1])}scrollToAnchor(de){if(!this.supportsScrolling())return;const W=function ds(Z,de){const W=Z.getElementById(de)||Z.getElementsByName(de)[0];if(W)return W;if("function"==typeof Z.createTreeWalker&&Z.body&&"function"==typeof Z.body.attachShadow){const Ce=Z.createTreeWalker(Z.body,NodeFilter.SHOW_ELEMENT);let Tt=Ce.currentNode;for(;Tt;){const yn=Tt.shadowRoot;if(yn){const Dn=yn.getElementById(de)||yn.querySelector(`[name="${de}"]`);if(Dn)return Dn}Tt=Ce.nextNode()}}return null}(this.document,de);W&&(this.scrollToElement(W),W.focus())}setHistoryScrollRestoration(de){if(this.supportScrollRestoration()){const W=this.window.history;W&&W.scrollRestoration&&(W.scrollRestoration=de)}}scrollToElement(de){const W=de.getBoundingClientRect(),Ce=W.left+this.window.pageXOffset,Tt=W.top+this.window.pageYOffset,yn=this.offset();this.window.scrollTo(Ce-yn[0],Tt-yn[1])}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const de=eo(this.window.history)||eo(Object.getPrototypeOf(this.window.history));return!(!de||!de.writable&&!de.set)}catch{return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch{return!1}}}function eo(Z){return Object.getOwnPropertyDescriptor(Z,"scrollRestoration")}class Ss{}},9862:(zn,Dt,R)=>{"use strict";R.d(Dt,{JF:()=>Ge,TP:()=>Vt,WM:()=>se,eN:()=>ze});var x=R(2029),d=R(2096),v=R(7715),s=R(5592),Q=R(6328),ie=R(2181),q=R(7398),y=R(4716),fe=R(4664),Se=R(6814);class De{}class X{}class se{constructor(bt){this.normalizedNames=new Map,this.lazyUpdate=null,bt?"string"==typeof bt?this.lazyInit=()=>{this.headers=new Map,bt.split("\n").forEach(Et=>{const Nn=Et.indexOf(":");if(Nn>0){const Pn=Et.slice(0,Nn),oi=Pn.toLowerCase(),ti=Et.slice(Nn+1).trim();this.maybeSetNormalizedName(Pn,oi),this.headers.has(oi)?this.headers.get(oi).push(ti):this.headers.set(oi,[ti])}})}:typeof Headers<"u"&&bt instanceof Headers?(this.headers=new Map,bt.forEach((Et,Nn)=>{this.setHeaderEntries(Nn,Et)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(bt).forEach(([Et,Nn])=>{this.setHeaderEntries(Et,Nn)})}:this.headers=new Map}has(bt){return this.init(),this.headers.has(bt.toLowerCase())}get(bt){this.init();const Et=this.headers.get(bt.toLowerCase());return Et&&Et.length>0?Et[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(bt){return this.init(),this.headers.get(bt.toLowerCase())||null}append(bt,Et){return this.clone({name:bt,value:Et,op:"a"})}set(bt,Et){return this.clone({name:bt,value:Et,op:"s"})}delete(bt,Et){return this.clone({name:bt,value:Et,op:"d"})}maybeSetNormalizedName(bt,Et){this.normalizedNames.has(Et)||this.normalizedNames.set(Et,bt)}init(){this.lazyInit&&(this.lazyInit instanceof se?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(bt=>this.applyUpdate(bt)),this.lazyUpdate=null))}copyFrom(bt){bt.init(),Array.from(bt.headers.keys()).forEach(Et=>{this.headers.set(Et,bt.headers.get(Et)),this.normalizedNames.set(Et,bt.normalizedNames.get(Et))})}clone(bt){const Et=new se;return Et.lazyInit=this.lazyInit&&this.lazyInit instanceof se?this.lazyInit:this,Et.lazyUpdate=(this.lazyUpdate||[]).concat([bt]),Et}applyUpdate(bt){const Et=bt.name.toLowerCase();switch(bt.op){case"a":case"s":let Nn=bt.value;if("string"==typeof Nn&&(Nn=[Nn]),0===Nn.length)return;this.maybeSetNormalizedName(bt.name,Et);const Pn=("a"===bt.op?this.headers.get(Et):void 0)||[];Pn.push(...Nn),this.headers.set(Et,Pn);break;case"d":const oi=bt.value;if(oi){let ti=this.headers.get(Et);if(!ti)return;ti=ti.filter(qi=>-1===oi.indexOf(qi)),0===ti.length?(this.headers.delete(Et),this.normalizedNames.delete(Et)):this.headers.set(Et,ti)}else this.headers.delete(Et),this.normalizedNames.delete(Et)}}setHeaderEntries(bt,Et){const Nn=(Array.isArray(Et)?Et:[Et]).map(oi=>oi.toString()),Pn=bt.toLowerCase();this.headers.set(Pn,Nn),this.maybeSetNormalizedName(bt,Pn)}forEach(bt){this.init(),Array.from(this.normalizedNames.keys()).forEach(Et=>bt(this.normalizedNames.get(Et),this.headers.get(Et)))}}class _e{encodeKey(bt){return qe(bt)}encodeValue(bt){return qe(bt)}decodeKey(bt){return decodeURIComponent(bt)}decodeValue(bt){return decodeURIComponent(bt)}}const Re=/%(\d[a-f0-9])/gi,Ne={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function qe(nn){return encodeURIComponent(nn).replace(Re,(bt,Et)=>Ne[Et]??bt)}function _t(nn){return`${nn}`}class Je{constructor(bt={}){if(this.updates=null,this.cloneFrom=null,this.encoder=bt.encoder||new _e,bt.fromString){if(bt.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function be(nn,bt){const Et=new Map;return nn.length>0&&nn.replace(/^\?/,"").split("&").forEach(Pn=>{const oi=Pn.indexOf("="),[ti,qi]=-1==oi?[bt.decodeKey(Pn),""]:[bt.decodeKey(Pn.slice(0,oi)),bt.decodeValue(Pn.slice(oi+1))],xi=Et.get(ti)||[];xi.push(qi),Et.set(ti,xi)}),Et}(bt.fromString,this.encoder)}else bt.fromObject?(this.map=new Map,Object.keys(bt.fromObject).forEach(Et=>{const Nn=bt.fromObject[Et],Pn=Array.isArray(Nn)?Nn.map(_t):[_t(Nn)];this.map.set(Et,Pn)})):this.map=null}has(bt){return this.init(),this.map.has(bt)}get(bt){this.init();const Et=this.map.get(bt);return Et?Et[0]:null}getAll(bt){return this.init(),this.map.get(bt)||null}keys(){return this.init(),Array.from(this.map.keys())}append(bt,Et){return this.clone({param:bt,value:Et,op:"a"})}appendAll(bt){const Et=[];return Object.keys(bt).forEach(Nn=>{const Pn=bt[Nn];Array.isArray(Pn)?Pn.forEach(oi=>{Et.push({param:Nn,value:oi,op:"a"})}):Et.push({param:Nn,value:Pn,op:"a"})}),this.clone(Et)}set(bt,Et){return this.clone({param:bt,value:Et,op:"s"})}delete(bt,Et){return this.clone({param:bt,value:Et,op:"d"})}toString(){return this.init(),this.keys().map(bt=>{const Et=this.encoder.encodeKey(bt);return this.map.get(bt).map(Nn=>Et+"="+this.encoder.encodeValue(Nn)).join("&")}).filter(bt=>""!==bt).join("&")}clone(bt){const Et=new Je({encoder:this.encoder});return Et.cloneFrom=this.cloneFrom||this,Et.updates=(this.updates||[]).concat(bt),Et}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(bt=>this.map.set(bt,this.cloneFrom.map.get(bt))),this.updates.forEach(bt=>{switch(bt.op){case"a":case"s":const Et=("a"===bt.op?this.map.get(bt.param):void 0)||[];Et.push(_t(bt.value)),this.map.set(bt.param,Et);break;case"d":if(void 0===bt.value){this.map.delete(bt.param);break}{let Nn=this.map.get(bt.param)||[];const Pn=Nn.indexOf(_t(bt.value));-1!==Pn&&Nn.splice(Pn,1),Nn.length>0?this.map.set(bt.param,Nn):this.map.delete(bt.param)}}}),this.cloneFrom=this.updates=null)}}class it{constructor(){this.map=new Map}set(bt,Et){return this.map.set(bt,Et),this}get(bt){return this.map.has(bt)||this.map.set(bt,bt.defaultValue()),this.map.get(bt)}delete(bt){return this.map.delete(bt),this}has(bt){return this.map.has(bt)}keys(){return this.map.keys()}}function Te(nn){return typeof ArrayBuffer<"u"&&nn instanceof ArrayBuffer}function ae(nn){return typeof Blob<"u"&&nn instanceof Blob}function yt(nn){return typeof FormData<"u"&&nn instanceof FormData}class Ze{constructor(bt,Et,Nn,Pn){let oi;if(this.url=Et,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=bt.toUpperCase(),function Xe(nn){switch(nn){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||Pn?(this.body=void 0!==Nn?Nn:null,oi=Pn):oi=Nn,oi&&(this.reportProgress=!!oi.reportProgress,this.withCredentials=!!oi.withCredentials,oi.responseType&&(this.responseType=oi.responseType),oi.headers&&(this.headers=oi.headers),oi.context&&(this.context=oi.context),oi.params&&(this.params=oi.params)),this.headers||(this.headers=new se),this.context||(this.context=new it),this.params){const ti=this.params.toString();if(0===ti.length)this.urlWithParams=Et;else{const qi=Et.indexOf("?");this.urlWithParams=Et+(-1===qi?"?":qi<Et.length-1?"&":"")+ti}}else this.params=new Je,this.urlWithParams=Et}serializeBody(){return null===this.body?null:Te(this.body)||ae(this.body)||yt(this.body)||function we(nn){return typeof URLSearchParams<"u"&&nn instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof Je?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||yt(this.body)?null:ae(this.body)?this.body.type||null:Te(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof Je?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(bt={}){const Et=bt.method||this.method,Nn=bt.url||this.url,Pn=bt.responseType||this.responseType,oi=void 0!==bt.body?bt.body:this.body,ti=void 0!==bt.withCredentials?bt.withCredentials:this.withCredentials,qi=void 0!==bt.reportProgress?bt.reportProgress:this.reportProgress;let xi=bt.headers||this.headers,go=bt.params||this.params;const So=bt.context??this.context;return void 0!==bt.setHeaders&&(xi=Object.keys(bt.setHeaders).reduce((Go,uo)=>Go.set(uo,bt.setHeaders[uo]),xi)),bt.setParams&&(go=Object.keys(bt.setParams).reduce((Go,uo)=>Go.set(uo,bt.setParams[uo]),go)),new Ze(Et,Nn,oi,{params:go,headers:xi,context:So,reportProgress:qi,responseType:Pn,withCredentials:ti})}}var Ae=(()=>((Ae=Ae||{})[Ae.Sent=0]="Sent",Ae[Ae.UploadProgress=1]="UploadProgress",Ae[Ae.ResponseHeader=2]="ResponseHeader",Ae[Ae.DownloadProgress=3]="DownloadProgress",Ae[Ae.Response=4]="Response",Ae[Ae.User=5]="User",Ae))();class ve{constructor(bt,Et=200,Nn="OK"){this.headers=bt.headers||new se,this.status=void 0!==bt.status?bt.status:Et,this.statusText=bt.statusText||Nn,this.url=bt.url||null,this.ok=this.status>=200&&this.status<300}}class en extends ve{constructor(bt={}){super(bt),this.type=Ae.ResponseHeader}clone(bt={}){return new en({headers:bt.headers||this.headers,status:void 0!==bt.status?bt.status:this.status,statusText:bt.statusText||this.statusText,url:bt.url||this.url||void 0})}}class dt extends ve{constructor(bt={}){super(bt),this.type=Ae.Response,this.body=void 0!==bt.body?bt.body:null}clone(bt={}){return new dt({body:void 0!==bt.body?bt.body:this.body,headers:bt.headers||this.headers,status:void 0!==bt.status?bt.status:this.status,statusText:bt.statusText||this.statusText,url:bt.url||this.url||void 0})}}class mt extends ve{constructor(bt){super(bt,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${bt.url||"(unknown url)"}`:`Http failure response for ${bt.url||"(unknown url)"}: ${bt.status} ${bt.statusText}`,this.error=bt.error||null}}function lt(nn,bt){return{body:bt,headers:nn.headers,context:nn.context,observe:nn.observe,params:nn.params,reportProgress:nn.reportProgress,responseType:nn.responseType,withCredentials:nn.withCredentials}}let ze=(()=>{class nn{constructor(Et){this.handler=Et}request(Et,Nn,Pn={}){let oi;if(Et instanceof Ze)oi=Et;else{let xi,go;xi=Pn.headers instanceof se?Pn.headers:new se(Pn.headers),Pn.params&&(go=Pn.params instanceof Je?Pn.params:new Je({fromObject:Pn.params})),oi=new Ze(Et,Nn,void 0!==Pn.body?Pn.body:null,{headers:xi,context:Pn.context,params:go,reportProgress:Pn.reportProgress,responseType:Pn.responseType||"json",withCredentials:Pn.withCredentials})}const ti=(0,d.of)(oi).pipe((0,Q.b)(xi=>this.handler.handle(xi)));if(Et instanceof Ze||"events"===Pn.observe)return ti;const qi=ti.pipe((0,ie.h)(xi=>xi instanceof dt));switch(Pn.observe||"body"){case"body":switch(oi.responseType){case"arraybuffer":return qi.pipe((0,q.U)(xi=>{if(null!==xi.body&&!(xi.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return xi.body}));case"blob":return qi.pipe((0,q.U)(xi=>{if(null!==xi.body&&!(xi.body instanceof Blob))throw new Error("Response is not a Blob.");return xi.body}));case"text":return qi.pipe((0,q.U)(xi=>{if(null!==xi.body&&"string"!=typeof xi.body)throw new Error("Response is not a string.");return xi.body}));default:return qi.pipe((0,q.U)(xi=>xi.body))}case"response":return qi;default:throw new Error(`Unreachable: unhandled observe type ${Pn.observe}}`)}}delete(Et,Nn={}){return this.request("DELETE",Et,Nn)}get(Et,Nn={}){return this.request("GET",Et,Nn)}head(Et,Nn={}){return this.request("HEAD",Et,Nn)}jsonp(Et,Nn){return this.request("JSONP",Et,{params:(new Je).append(Nn,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(Et,Nn={}){return this.request("OPTIONS",Et,Nn)}patch(Et,Nn,Pn={}){return this.request("PATCH",Et,lt(Pn,Nn))}post(Et,Nn,Pn={}){return this.request("POST",Et,lt(Pn,Nn))}put(Et,Nn,Pn={}){return this.request("PUT",Et,lt(Pn,Nn))}}return nn.\u0275fac=function(Et){return new(Et||nn)(x.LFG(De))},nn.\u0275prov=x.Yz7({token:nn,factory:nn.\u0275fac}),nn})();function Xt(nn,bt){return bt(nn)}function mn(nn,bt){return(Et,Nn)=>bt.intercept(Et,{handle:Pn=>nn(Pn,Nn)})}const Vt=new x.OlP(""),St=new x.OlP(""),st=new x.OlP("");function qt(){let nn=null;return(bt,Et)=>{null===nn&&(nn=((0,x.f3M)(Vt,{optional:!0})??[]).reduceRight(mn,Xt));const Nn=(0,x.f3M)(x.HDt),Pn=Nn.add();return nn(bt,Et).pipe((0,y.x)(()=>Nn.remove(Pn)))}}let dn=(()=>{class nn extends De{constructor(Et,Nn){super(),this.backend=Et,this.injector=Nn,this.chain=null,this.pendingTasks=(0,x.f3M)(x.HDt)}handle(Et){if(null===this.chain){const Pn=Array.from(new Set([...this.injector.get(St),...this.injector.get(st,[])]));this.chain=Pn.reduceRight((oi,ti)=>function an(nn,bt,Et){return(Nn,Pn)=>Et.runInContext(()=>bt(Nn,oi=>nn(oi,Pn)))}(oi,ti,this.injector),Xt)}const Nn=this.pendingTasks.add();return this.chain(Et,Pn=>this.backend.handle(Pn)).pipe((0,y.x)(()=>this.pendingTasks.remove(Nn)))}}return nn.\u0275fac=function(Et){return new(Et||nn)(x.LFG(X),x.LFG(x.lqb))},nn.\u0275prov=x.Yz7({token:nn,factory:nn.\u0275fac}),nn})();const Qt=/^\)\]\}',?\n/;let ge=(()=>{class nn{constructor(Et){this.xhrFactory=Et}handle(Et){if("JSONP"===Et.method)throw new x.vHH(-2800,!1);const Nn=this.xhrFactory;return(Nn.\u0275loadImpl?(0,v.D)(Nn.\u0275loadImpl()):(0,d.of)(null)).pipe((0,fe.w)(()=>new s.y(oi=>{const ti=Nn.build();if(ti.open(Et.method,Et.urlWithParams),Et.withCredentials&&(ti.withCredentials=!0),Et.headers.forEach((ho,tn)=>ti.setRequestHeader(ho,tn.join(","))),Et.headers.has("Accept")||ti.setRequestHeader("Accept","application/json, text/plain, */*"),!Et.headers.has("Content-Type")){const ho=Et.detectContentTypeHeader();null!==ho&&ti.setRequestHeader("Content-Type",ho)}if(Et.responseType){const ho=Et.responseType.toLowerCase();ti.responseType="json"!==ho?ho:"text"}const qi=Et.serializeBody();let xi=null;const go=()=>{if(null!==xi)return xi;const ho=ti.statusText||"OK",tn=new se(ti.getAllResponseHeaders()),Qo=function Mt(nn){return"responseURL"in nn&&nn.responseURL?nn.responseURL:/^X-Request-URL:/m.test(nn.getAllResponseHeaders())?nn.getResponseHeader("X-Request-URL"):null}(ti)||Et.url;return xi=new en({headers:tn,status:ti.status,statusText:ho,url:Qo}),xi},So=()=>{let{headers:ho,status:tn,statusText:Qo,url:xo}=go(),Ki=null;204!==tn&&(Ki=typeof ti.response>"u"?ti.responseText:ti.response),0===tn&&(tn=Ki?200:0);let gr=tn>=200&&tn<300;if("json"===Et.responseType&&"string"==typeof Ki){const bo=Ki;Ki=Ki.replace(Qt,"");try{Ki=""!==Ki?JSON.parse(Ki):null}catch(Zr){Ki=bo,gr&&(gr=!1,Ki={error:Zr,text:Ki})}}gr?(oi.next(new dt({body:Ki,headers:ho,status:tn,statusText:Qo,url:xo||void 0})),oi.complete()):oi.error(new mt({error:Ki,headers:ho,status:tn,statusText:Qo,url:xo||void 0}))},Go=ho=>{const{url:tn}=go(),Qo=new mt({error:ho,status:ti.status||0,statusText:ti.statusText||"Unknown Error",url:tn||void 0});oi.error(Qo)};let uo=!1;const oo=ho=>{uo||(oi.next(go()),uo=!0);let tn={type:Ae.DownloadProgress,loaded:ho.loaded};ho.lengthComputable&&(tn.total=ho.total),"text"===Et.responseType&&ti.responseText&&(tn.partialText=ti.responseText),oi.next(tn)},Ai=ho=>{let tn={type:Ae.UploadProgress,loaded:ho.loaded};ho.lengthComputable&&(tn.total=ho.total),oi.next(tn)};return ti.addEventListener("load",So),ti.addEventListener("error",Go),ti.addEventListener("timeout",Go),ti.addEventListener("abort",Go),Et.reportProgress&&(ti.addEventListener("progress",oo),null!==qi&&ti.upload&&ti.upload.addEventListener("progress",Ai)),ti.send(qi),oi.next({type:Ae.Sent}),()=>{ti.removeEventListener("error",Go),ti.removeEventListener("abort",Go),ti.removeEventListener("load",So),ti.removeEventListener("timeout",Go),Et.reportProgress&&(ti.removeEventListener("progress",oo),null!==qi&&ti.upload&&ti.upload.removeEventListener("progress",Ai)),ti.readyState!==ti.DONE&&ti.abort()}})))}}return nn.\u0275fac=function(Et){return new(Et||nn)(x.LFG(Se.JF))},nn.\u0275prov=x.Yz7({token:nn,factory:nn.\u0275fac}),nn})();const ct=new x.OlP("XSRF_ENABLED"),pn=new x.OlP("XSRF_COOKIE_NAME",{providedIn:"root",factory:()=>"XSRF-TOKEN"}),ri=new x.OlP("XSRF_HEADER_NAME",{providedIn:"root",factory:()=>"X-XSRF-TOKEN"});class Vo{}let ut=(()=>{class nn{constructor(Et,Nn,Pn){this.doc=Et,this.platform=Nn,this.cookieName=Pn,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const Et=this.doc.cookie||"";return Et!==this.lastCookieString&&(this.parseCount++,this.lastToken=(0,Se.Mx)(Et,this.cookieName),this.lastCookieString=Et),this.lastToken}}return nn.\u0275fac=function(Et){return new(Et||nn)(x.LFG(Se.K0),x.LFG(x.Lbi),x.LFG(pn))},nn.\u0275prov=x.Yz7({token:nn,factory:nn.\u0275fac}),nn})();function pe(nn,bt){const Et=nn.url.toLowerCase();if(!(0,x.f3M)(ct)||"GET"===nn.method||"HEAD"===nn.method||Et.startsWith("http://")||Et.startsWith("https://"))return bt(nn);const Nn=(0,x.f3M)(Vo).getToken(),Pn=(0,x.f3M)(ri);return null!=Nn&&!nn.headers.has(Pn)&&(nn=nn.clone({headers:nn.headers.set(Pn,Nn)})),bt(nn)}var Qe=(()=>((Qe=Qe||{})[Qe.Interceptors=0]="Interceptors",Qe[Qe.LegacyInterceptors=1]="LegacyInterceptors",Qe[Qe.CustomXsrfConfiguration=2]="CustomXsrfConfiguration",Qe[Qe.NoXsrfProtection=3]="NoXsrfProtection",Qe[Qe.JsonpSupport=4]="JsonpSupport",Qe[Qe.RequestsMadeViaParent=5]="RequestsMadeViaParent",Qe[Qe.Fetch=6]="Fetch",Qe))();function vt(nn,bt){return{\u0275kind:nn,\u0275providers:bt}}function Lt(...nn){const bt=[ze,ge,dn,{provide:De,useExisting:dn},{provide:X,useExisting:ge},{provide:St,useValue:pe,multi:!0},{provide:ct,useValue:!0},{provide:Vo,useClass:ut}];for(const Et of nn)bt.push(...Et.\u0275providers);return(0,x.MR2)(bt)}const jt=new x.OlP("LEGACY_INTERCEPTOR_FN");let Ge=(()=>{class nn{}return nn.\u0275fac=function(Et){return new(Et||nn)},nn.\u0275mod=x.oAB({type:nn}),nn.\u0275inj=x.cJS({providers:[Lt(vt(Qe.LegacyInterceptors,[{provide:jt,useFactory:qt},{provide:St,useExisting:jt,multi:!0}]))]}),nn})()},2029:(zn,Dt,R)=>{"use strict";R.d(Dt,{tb:()=>iv,AFp:()=>Nu,ip1:()=>Gx,hGG:()=>wT,z2F:()=>Np,Ojb:()=>N_,sBO:()=>sT,Sil:()=>zC,EJc:()=>BC,Xts:()=>ku,SBq:()=>Kd,lqb:()=>Cc,qLn:()=>Tc,vpe:()=>Lc,XFs:()=>Mt,OlP:()=>lr,zs3:()=>Ec,ZZ4:()=>cv,aQg:()=>uv,soG:()=>t_,YKP:()=>q0,h0i:()=>kp,PXZ:()=>KC,R0b:()=>Fa,FiY:()=>nl,Lbi:()=>Gh,g9A:()=>Uu,Qsj:()=>Gu,FYo:()=>Xd,JOm:()=>sl,tp0:()=>yh,Rgc:()=>_m,dDg:()=>WC,eoX:()=>o1,GfV:()=>op,s_b:()=>Qg,ifc:()=>nn,VuI:()=>PT,LMc:()=>RT,MMx:()=>J0,Lck:()=>Cw,eFA:()=>l1,G48:()=>rT,Gpc:()=>_t,f3M:()=>Ge,$WT:()=>or,MR2:()=>Tf,_c5:()=>bT,qFp:()=>LT,rg0:()=>Ba,c2e:()=>Wx,zSh:()=>Vh,HDt:()=>qx,wAp:()=>so,vHH:()=>ae,lri:()=>n1,rWj:()=>i1,cg1:()=>Iy,kL8:()=>v0,dqk:()=>ri,Z0I:()=>Ci,eJc:()=>Wy,QGY:()=>pu,F4k:()=>Sp,RDi:()=>D_,AaK:()=>Re,qOj:()=>wp,Xq5:()=>Ep,TTD:()=>lc,_Bn:()=>W0,jDz:()=>K0,xp6:()=>Yu,uIk:()=>w,ekj:()=>wy,Suo:()=>Ex,Xpm:()=>Ut,lG2:()=>Bi,Yz7:()=>Sn,cJS:()=>gi,oAB:()=>On,Yjl:()=>Lo,Y36:()=>Xu,_UZ:()=>fh,GkF:()=>Rl,BQk:()=>dd,ynx:()=>ud,qZA:()=>ph,TgZ:()=>hh,EpF:()=>ca,n5z:()=>Oi,LFG:()=>Y,$8M:()=>Fo,$Z:()=>lu,NdJ:()=>Pp,CRH:()=>Dx,oxw:()=>Sv,ALo:()=>ux,lcZ:()=>dx,xi3:()=>hx,Hsn:()=>Ov,F$t:()=>Pv,Q6J:()=>du,s9C:()=>gy,DdM:()=>ox,iGM:()=>Cx,MAs:()=>cd,KtG:()=>hc,CHM:()=>_l,LSH:()=>jd,P3R:()=>Gm,Udp:()=>by,YNc:()=>as,_uU:()=>e0,Oqu:()=>Ty,hij:()=>Wg,AsE:()=>Ey,lnq:()=>Dy,HOy:()=>My,Gf:()=>Tx});var x=R(8645),d=R(7394),v=R(5619),s=R(5592),Q=R(7537),ie=R(4829),q=R(6232),y=R(4564),fe=R(7715),De=R(2096),X=R(3020),se=R(4664),Ee=R(3997);function _e(n){for(let r in n)if(n[r]===_e)return r;throw Error("Could not find renamed property on target object.")}function be(n,r){for(const l in r)r.hasOwnProperty(l)&&!n.hasOwnProperty(l)&&(n[l]=r[l])}function Re(n){if("string"==typeof n)return n;if(Array.isArray(n))return"["+n.map(Re).join(", ")+"]";if(null==n)return""+n;if(n.overriddenName)return`${n.overriddenName}`;if(n.name)return`${n.name}`;const r=n.toString();if(null==r)return""+r;const l=r.indexOf("\n");return-1===l?r:r.substring(0,l)}function Ne(n,r){return null==n||""===n?null===r?"":r:null==r||""===r?n:n+" "+r}const qe=_e({__forward_ref__:_e});function _t(n){return n.__forward_ref__=_t,n.toString=function(){return Re(this())},n}function Je(n){return Me(n)?n():n}function Me(n){return"function"==typeof n&&n.hasOwnProperty(qe)&&n.__forward_ref__===_t}function it(n){return n&&!!n.\u0275providers}const Te="https://g.co/ng/security#xss";class ae extends Error{constructor(r,l){super(function yt(n,r){return`NG0${Math.abs(n)}${r?": "+r:""}`}(r,l)),this.code=r}}function we(n){return"string"==typeof n?n:null==n?"":String(n)}function dt(n,r){throw new ae(-201,!1)}function Vt(n,r){null==n&&function St(n,r,l,h){throw new Error(`ASSERTION ERROR: ${n}`+(null==h?"":` [Expected=> ${l} ${h} ${r} <=Actual]`))}(r,n,null,"!=")}function Sn(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function gi(n){return{providers:n.providers||[],imports:n.imports||[]}}function $i(n){return Ji(n,ii)||Ji(n,xn)}function Ci(n){return null!==$i(n)}function Ji(n,r){return n.hasOwnProperty(r)?n[r]:null}function Fi(n){return n&&(n.hasOwnProperty(mi)||n.hasOwnProperty(Qt))?n[mi]:null}const ii=_e({\u0275prov:_e}),mi=_e({\u0275inj:_e}),xn=_e({ngInjectableDef:_e}),Qt=_e({ngInjectorDef:_e});var Mt=(()=>((Mt=Mt||{})[Mt.Default=0]="Default",Mt[Mt.Host=1]="Host",Mt[Mt.Self=2]="Self",Mt[Mt.SkipSelf=4]="SkipSelf",Mt[Mt.Optional=8]="Optional",Mt))();let ge;function Gt(n){const r=ge;return ge=n,r}function pn(n,r,l){const h=$i(n);return h&&"root"==h.providedIn?void 0===h.value?h.value=h.factory():h.value:l&Mt.Optional?null:void 0!==r?r:void dt(Re(n))}const ri=(()=>typeof globalThis<"u"&&globalThis||typeof global<"u"&&global||typeof window<"u"&&window||typeof self<"u"&&typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&self)(),xe={},Qe="__NG_DI_FLAG__",vt="ngTempTokenPath",Zt=/\n/gm,Pt="__source";let Kt;function et(n){const r=Kt;return Kt=n,r}function Ue(n,r=Mt.Default){if(void 0===Kt)throw new ae(-203,!1);return null===Kt?pn(n,void 0,r):Kt.get(n,r&Mt.Optional?null:void 0,r)}function Y(n,r=Mt.Default){return(function ct(){return ge}()||Ue)(Je(n),r)}function Ge(n,r=Mt.Default){return Y(n,Ft(r))}function Ft(n){return typeof n>"u"||"number"==typeof n?n:0|(n.optional&&8)|(n.host&&1)|(n.self&&2)|(n.skipSelf&&4)}function gn(n){const r=[];for(let l=0;l<n.length;l++){const h=Je(n[l]);if(Array.isArray(h)){if(0===h.length)throw new ae(900,!1);let g,C=Mt.Default;for(let M=0;M<h.length;M++){const F=h[M],V=wi(F);"number"==typeof V?-1===V?g=F.token:C|=V:g=F}r.push(Y(g,C))}else r.push(Y(h))}return r}function ei(n,r){return n[Qe]=r,n.prototype[Qe]=r,n}function wi(n){return n[Qe]}function fo(n){return{toString:n}.toString()}var to=(()=>((to=to||{})[to.OnPush=0]="OnPush",to[to.Default=1]="Default",to))(),nn=(()=>{return(n=nn||(nn={}))[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",nn;var n})();const bt={},Et=[],Nn=_e({\u0275cmp:_e}),Pn=_e({\u0275dir:_e}),oi=_e({\u0275pipe:_e}),ti=_e({\u0275mod:_e}),qi=_e({\u0275fac:_e}),xi=_e({__NG_ELEMENT_ID__:_e}),go=_e({__NG_ENV_ID__:_e});function So(n,r,l){let h=n.length;for(;;){const g=n.indexOf(r,l);if(-1===g)return g;if(0===g||n.charCodeAt(g-1)<=32){const C=r.length;if(g+C===h||n.charCodeAt(g+C)<=32)return g}l=g+1}}function Go(n,r,l){let h=0;for(;h<l.length;){const g=l[h];if("number"==typeof g){if(0!==g)break;h++;const C=l[h++],M=l[h++],F=l[h++];n.setAttribute(r,M,F,C)}else{const C=g,M=l[++h];oo(C)?n.setProperty(r,C,M):n.setAttribute(r,C,M),h++}}return h}function uo(n){return 3===n||4===n||6===n}function oo(n){return 64===n.charCodeAt(0)}function Ai(n,r){if(null!==r&&0!==r.length)if(null===n||0===n.length)n=r.slice();else{let l=-1;for(let h=0;h<r.length;h++){const g=r[h];"number"==typeof g?l=g:0===l||ho(n,l,g,null,-1===l||2===l?r[++h]:null)}}return n}function ho(n,r,l,h,g){let C=0,M=n.length;if(-1===r)M=-1;else for(;C<n.length;){const F=n[C++];if("number"==typeof F){if(F===r){M=-1;break}if(F>r){M=C-1;break}}}for(;C<n.length;){const F=n[C];if("number"==typeof F)break;if(F===l){if(null===h)return void(null!==g&&(n[C+1]=g));if(h===n[C+1])return void(n[C+2]=g)}C++,null!==h&&C++,null!==g&&C++}-1!==M&&(n.splice(M,0,r),C=M+1),n.splice(C++,0,l),null!==h&&n.splice(C++,0,h),null!==g&&n.splice(C++,0,g)}const tn="ng-template";function Qo(n,r,l){let h=0,g=!0;for(;h<n.length;){let C=n[h++];if("string"==typeof C&&g){const M=n[h++];if(l&&"class"===C&&-1!==So(M.toLowerCase(),r,0))return!0}else{if(1===C){for(;h<n.length&&"string"==typeof(C=n[h++]);)if(C.toLowerCase()===r)return!0;return!1}"number"==typeof C&&(g=!1)}}return!1}function xo(n){return 4===n.type&&n.value!==tn}function Ki(n,r,l){return r===(4!==n.type||l?n.value:tn)}function gr(n,r,l){let h=4;const g=n.attrs||[],C=function Qn(n){for(let r=0;r<n.length;r++)if(uo(n[r]))return r;return n.length}(g);let M=!1;for(let F=0;F<r.length;F++){const V=r[F];if("number"!=typeof V){if(!M)if(4&h){if(h=2|1&h,""!==V&&!Ki(n,V,l)||""===V&&1===r.length){if(bo(h))return!1;M=!0}}else{const oe=8&h?V:r[++F];if(8&h&&null!==n.attrs){if(!Qo(n.attrs,oe,l)){if(bo(h))return!1;M=!0}continue}const ft=Zr(8&h?"class":V,g,xo(n),l);if(-1===ft){if(bo(h))return!1;M=!0;continue}if(""!==oe){let Ht;Ht=ft>C?"":g[ft+1].toLowerCase();const sn=8&h?Ht:null;if(sn&&-1!==So(sn,oe,0)||2&h&&oe!==Ht){if(bo(h))return!1;M=!0}}}}else{if(!M&&!bo(h)&&!bo(V))return!1;if(M&&bo(V))continue;M=!1,h=V|1&h}}return bo(h)||M}function bo(n){return 0==(1&n)}function Zr(n,r,l,h){if(null===r)return-1;let g=0;if(h||!l){let C=!1;for(;g<r.length;){const M=r[g];if(M===n)return g;if(3===M||6===M)C=!0;else{if(1===M||2===M){let F=r[++g];for(;"string"==typeof F;)F=r[++g];continue}if(4===M)break;if(0===M){g+=4;continue}}g+=C?1:2}return-1}return function Ui(n,r){let l=n.indexOf(4);if(l>-1)for(l++;l<n.length;){const h=n[l];if("number"==typeof h)return-1;if(h===r)return l;l++}return-1}(r,n)}function Mr(n,r,l=!1){for(let h=0;h<r.length;h++)if(gr(n,r[h],l))return!0;return!1}function ye(n,r){e:for(let l=0;l<r.length;l++){const h=r[l];if(n.length===h.length){for(let g=0;g<n.length;g++)if(n[g]!==h[g])continue e;return!0}}return!1}function rt(n,r){return n?":not("+r.trim()+")":r}function Le(n){let r=n[0],l=1,h=2,g="",C=!1;for(;l<n.length;){let M=n[l];if("string"==typeof M)if(2&h){const F=n[++l];g+="["+M+(F.length>0?'="'+F+'"':"")+"]"}else 8&h?g+="."+M:4&h&&(g+=" "+M);else""!==g&&!bo(M)&&(r+=rt(C,g),g=""),h=M,C=C||!bo(h);l++}return""!==g&&(r+=rt(C,g)),r}function Ut(n){return fo(()=>{const r=dr(n),l={...r,decls:n.decls,vars:n.vars,template:n.template,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,onPush:n.changeDetection===to.OnPush,directiveDefs:null,pipeDefs:null,dependencies:r.standalone&&n.dependencies||null,getStandaloneInjector:null,signals:n.signals??!1,data:n.data||{},encapsulation:n.encapsulation||nn.Emulated,styles:n.styles||Et,_:null,schemas:n.schemas||null,tView:null,id:""};Co(l);const h=n.dependencies;return l.directiveDefs=xs(h,!1),l.pipeDefs=xs(h,!0),l.id=function hr(n){let r=0;const l=[n.selectors,n.ngContentSelectors,n.hostVars,n.hostAttrs,n.consts,n.vars,n.decls,n.encapsulation,n.standalone,n.signals,n.exportAs,JSON.stringify(n.inputs),JSON.stringify(n.outputs),Object.getOwnPropertyNames(n.type.prototype),!!n.contentQueries,!!n.viewQuery].join("|");for(const g of l)r=Math.imul(31,r)+g.charCodeAt(0)<<0;return r+=2147483648,"c"+r}(l),l})}function Cn(n){return Qi(n)||ao(n)}function vn(n){return null!==n}function On(n){return fo(()=>({type:n.type,bootstrap:n.bootstrap||Et,declarations:n.declarations||Et,imports:n.imports||Et,exports:n.exports||Et,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function Di(n,r){if(null==n)return bt;const l={};for(const h in n)if(n.hasOwnProperty(h)){let g=n[h],C=g;Array.isArray(g)&&(C=g[1],g=g[0]),l[g]=h,r&&(r[g]=C)}return l}function Bi(n){return fo(()=>{const r=dr(n);return Co(r),r})}function Lo(n){return{type:n.type,name:n.name,factory:null,pure:!1!==n.pure,standalone:!0===n.standalone,onDestroy:n.type.prototype.ngOnDestroy||null}}function Qi(n){return n[Nn]||null}function ao(n){return n[Pn]||null}function To(n){return n[oi]||null}function or(n){const r=Qi(n)||ao(n)||To(n);return null!==r&&r.standalone}function Wo(n,r){const l=n[ti]||null;if(!l&&!0===r)throw new Error(`Type ${Re(n)} does not have '\u0275mod' property.`);return l}function dr(n){const r={};return{type:n.type,providersResolver:null,factory:null,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:r,inputTransforms:null,inputConfig:n.inputs||bt,exportAs:n.exportAs||null,standalone:!0===n.standalone,signals:!0===n.signals,selectors:n.selectors||Et,viewQuery:n.viewQuery||null,features:n.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:Di(n.inputs,r),outputs:Di(n.outputs)}}function Co(n){n.features?.forEach(r=>r(n))}function xs(n,r){if(!n)return null;const l=r?To:Cn;return()=>("function"==typeof n?n():n).map(h=>l(h)).filter(vn)}const wo=0,pi=1,Ri=2,Li=3,er=4,is=5,jo=6,Jo=7,Oo=8,Ur=9,xr=10,Si=11,us=12,ta=13,Xr=14,ko=15,Ir=16,Fr=17,Br=18,br=19,bs=20,rr=21,Ar=22,Qr=23,ws=24,eo=25,na=1,Ss=2,Sr=7,ia=9,wr=11;function Pr(n){return Array.isArray(n)&&"object"==typeof n[na]}function Nr(n){return Array.isArray(n)&&!0===n[na]}function Gs(n){return 0!=(4&n.flags)}function Cs(n){return n.componentOffset>-1}function Ts(n){return 1==(1&n.flags)}function pr(n){return!!n.template}function Cr(n){return 0!=(512&n[Ri])}function ua(n,r){return n.hasOwnProperty(qi)?n[qi]:null}let Ya=ri.WeakRef??class kl{constructor(r){this.ref=r}deref(){return this.ref}},Fl=0,Rs=null,ha=!1;function Or(n){const r=Rs;return Rs=n,r}class pl{constructor(){this.id=Fl++,this.ref=function Ja(n){return new Ya(n)}(this),this.producers=new Map,this.consumers=new Map,this.trackingVersion=0,this.valueVersion=0}consumerPollProducersForChange(){for(const[r,l]of this.producers){const h=l.producerNode.deref();if(void 0!==h&&l.atTrackingVersion===this.trackingVersion){if(h.producerPollStatus(l.seenValueVersion))return!0}else this.producers.delete(r),h?.consumers.delete(this.id)}return!1}producerMayHaveChanged(){const r=ha;ha=!0;try{for(const[l,h]of this.consumers){const g=h.consumerNode.deref();void 0!==g&&g.trackingVersion===h.atTrackingVersion?g.onConsumerDependencyMayHaveChanged():(this.consumers.delete(l),g?.producers.delete(this.id))}}finally{ha=r}}producerAccessed(){if(ha)throw new Error("");if(null===Rs)return;let r=Rs.producers.get(this.id);void 0===r?(r={consumerNode:Rs.ref,producerNode:this.ref,seenValueVersion:this.valueVersion,atTrackingVersion:Rs.trackingVersion},Rs.producers.set(this.id,r),this.consumers.set(Rs.id,r)):(r.seenValueVersion=this.valueVersion,r.atTrackingVersion=Rs.trackingVersion)}get hasProducers(){return this.producers.size>0}get producerUpdatesAllowed(){return!1!==Rs?.consumerAllowSignalWrites}producerPollStatus(r){return this.valueVersion!==r||(this.onProducerUpdateValueVersion(),this.valueVersion!==r)}}let Nc=null;function Ba(n){const r=Or(null);try{return n()}finally{Or(r)}}const ac=()=>{};class mu extends pl{constructor(r,l,h){super(),this.watch=r,this.schedule=l,this.dirty=!1,this.cleanupFn=ac,this.registerOnCleanup=g=>{this.cleanupFn=g},this.consumerAllowSignalWrites=h}notify(){this.dirty||this.schedule(this),this.dirty=!0}onConsumerDependencyMayHaveChanged(){this.notify()}onProducerUpdateValueVersion(){}run(){if(this.dirty=!1,0!==this.trackingVersion&&!this.consumerPollProducersForChange())return;const r=Or(this);this.trackingVersion++;try{this.cleanupFn(),this.cleanupFn=ac,this.watch(this.registerOnCleanup)}finally{Or(r)}}cleanup(){this.cleanupFn()}}class zl{constructor(r,l,h){this.previousValue=r,this.currentValue=l,this.firstChange=h}isFirstChange(){return this.firstChange}}function lc(){return zc}function zc(n){return n.type.prototype.ngOnChanges&&(n.setInput=Ul),Uc}function Uc(){const n=cc(this),r=n?.current;if(r){const l=n.previous;if(l===bt)n.previous=r;else for(let h in r)l[h]=r[h];n.current=null,this.ngOnChanges(r)}}function Ul(n,r,l,h){const g=this.declaredInputs[l],C=cc(n)||function uc(n,r){return n[Na]=r}(n,{previous:bt,current:null}),M=C.current||(C.current={}),F=C.previous,V=F[g];M[g]=new zl(V&&V.currentValue,r,F===bt),n[h]=r}lc.ngInherit=!0;const Na="__ngSimpleChanges__";function cc(n){return n[Na]||null}const Z=function(n,r,l){};function Ce(n){for(;Array.isArray(n);)n=n[wo];return n}function yn(n,r){return Ce(r[n])}function Dn(n,r){return Ce(r[n.index])}function Eo(n,r){return n.data[r]}function yo(n,r){return n[r]}function Xi(n,r){const l=r[n];return Pr(l)?l:l[wo]}function Do(n,r){return null==r?null:n[r]}function Ls(n){n[Fr]=0}function Ds(n){1024&n[Ri]||(n[Ri]|=1024,Vr(n,1))}function fs(n){1024&n[Ri]&&(n[Ri]&=-1025,Vr(n,-1))}function Vr(n,r){let l=n[Li];if(null===l)return;l[is]+=r;let h=l;for(l=l[Li];null!==l&&(1===r&&1===h[is]||-1===r&&0===h[is]);)l[is]+=r,h=l,l=l[Li]}const ki={lFrame:Bs(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function gl(){return ki.bindingsEnabled}function ga(){return null!==ki.skipHydrationRootTNode}function Hn(){return ki.lFrame.lView}function Mo(){return ki.lFrame.tView}function _l(n){return ki.lFrame.contextLView=n,n[Oo]}function hc(n){return ki.lFrame.contextLView=null,n}function jr(){let n=pc();for(;null!==n&&64===n.type;)n=n.parent;return n}function pc(){return ki.lFrame.currentTNode}function ks(n,r){const l=ki.lFrame;l.currentTNode=n,l.isParent=r}function Fs(){return ki.lFrame.isParent}function jl(){ki.lFrame.isParent=!1}function Wr(){const n=ki.lFrame;let r=n.bindingRootIndex;return-1===r&&(r=n.bindingRootIndex=n.tView.bindingStartIndex),r}function aa(){return ki.lFrame.bindingIndex}function Xa(){return ki.lFrame.bindingIndex++}function rs(n){const r=ki.lFrame,l=r.bindingIndex;return r.bindingIndex=r.bindingIndex+n,l}function gd(n,r){const l=ki.lFrame;l.bindingIndex=l.bindingRootIndex=n,mc(r)}function mc(n){ki.lFrame.currentDirectiveIndex=n}function Hc(){return ki.lFrame.currentQueryIndex}function es(n){ki.lFrame.currentQueryIndex=n}function _u(n){const r=n[pi];return 2===r.type?r.declTNode:1===r.type?n[jo]:null}function Gc(n,r,l){if(l&Mt.SkipSelf){let g=r,C=n;for(;!(g=g.parent,null!==g||l&Mt.Host||(g=_u(C),null===g||(C=C[Xr],10&g.type))););if(null===g)return!1;r=g,n=C}const h=ki.lFrame=yu();return h.currentTNode=r,h.lView=n,!0}function Wc(n){const r=yu(),l=n[pi];ki.lFrame=r,r.currentTNode=l.firstChild,r.lView=n,r.tView=l,r.contextLView=n,r.bindingIndex=l.bindingStartIndex,r.inI18n=!1}function yu(){const n=ki.lFrame,r=null===n?null:n.child;return null===r?Bs(n):r}function Bs(n){const r={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return null!==n&&(n.child=r),r}function qc(){const n=ki.lFrame;return ki.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}const vu=qc;function Ns(){const n=qc();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function qr(){return ki.lFrame.selectedIndex}function ui(n){ki.lFrame.selectedIndex=n}function _r(){const n=ki.lFrame;return Eo(n.tView,n.selectedIndex)}let B=!0;function A(){return B}function U(n){B=n}function Fe(n,r){for(let l=r.directiveStart,h=r.directiveEnd;l<h;l++){const C=n.data[l].type.prototype,{ngAfterContentInit:M,ngAfterContentChecked:F,ngAfterViewInit:V,ngAfterViewChecked:oe,ngOnDestroy:Pe}=C;M&&(n.contentHooks??=[]).push(-l,M),F&&((n.contentHooks??=[]).push(l,F),(n.contentCheckHooks??=[]).push(l,F)),V&&(n.viewHooks??=[]).push(-l,V),oe&&((n.viewHooks??=[]).push(l,oe),(n.viewCheckHooks??=[]).push(l,oe)),null!=Pe&&(n.destroyHooks??=[]).push(l,Pe)}}function We(n,r,l){fi(n,r,3,l)}function Jt(n,r,l,h){(3&n[Ri])===l&&fi(n,r,l,h)}function Rn(n,r){let l=n[Ri];(3&l)===r&&(l&=8191,l+=1,n[Ri]=l)}function fi(n,r,l,h){const C=h??-1,M=r.length-1;let F=0;for(let V=void 0!==h?65535&n[Fr]:0;V<M;V++)if("number"==typeof r[V+1]){if(F=r[V],null!=h&&F>=h)break}else r[V]<0&&(n[Fr]+=65536),(F<C||-1==C)&&(Io(n,l,r,V),n[Fr]=(4294901760&n[Fr])+V+2),V++}function Mi(n,r){Z(4,n,r);const l=Or(null);try{r.call(n)}finally{Or(l),Z(5,n,r)}}function Io(n,r,l,h){const g=l[h]<0,C=l[h+1],F=n[g?-l[h]:l[h]];g?n[Ri]>>13<n[Fr]>>16&&(3&n[Ri])===r&&(n[Ri]+=8192,Mi(F,C)):Mi(F,C)}const p=-1;class o{constructor(r,l,h){this.factory=r,this.resolving=!1,this.canSeeViewProviders=l,this.injectImpl=h}}function $(n){return n!==p}function ce(n){return 32767&n}function je(n,r){let l=function Ie(n){return n>>16}(n),h=r;for(;l>0;)h=h[Xr],l--;return h}let Ke=!0;function Ye(n){const r=Ke;return Ke=n,r}const ue=255,$e=5;let pt=0;const ht={};function kt(n,r){const l=Yt(n,r);if(-1!==l)return l;const h=r[pi];h.firstCreatePass&&(n.injectorIndex=r.length,Rt(h.data,n),Rt(r,null),Rt(h.blueprint,null));const g=$t(n,r),C=n.injectorIndex;if($(g)){const M=ce(g),F=je(g,r),V=F[pi].data;for(let oe=0;oe<8;oe++)r[C+oe]=F[M+oe]|V[M+oe]}return r[C+8]=g,C}function Rt(n,r){n.push(0,0,0,0,0,0,0,0,r)}function Yt(n,r){return-1===n.injectorIndex||n.parent&&n.parent.injectorIndex===n.injectorIndex||null===r[n.injectorIndex+8]?-1:n.injectorIndex}function $t(n,r){if(n.parent&&-1!==n.parent.injectorIndex)return n.parent.injectorIndex;let l=0,h=null,g=r;for(;null!==g;){if(h=bi(g),null===h)return p;if(l++,g=g[Xr],-1!==h.injectorIndex)return h.injectorIndex|l<<16}return p}function ln(n,r,l){!function Ot(n,r,l){let h;"string"==typeof l?h=l.charCodeAt(0)||0:l.hasOwnProperty(xi)&&(h=l[xi]),null==h&&(h=l[xi]=pt++);const g=h&ue;r.data[n+(g>>$e)]|=1<<g}(n,r,l)}function on(n,r,l){if(l&Mt.Optional||void 0!==n)return n;dt()}function An(n,r,l,h){if(l&Mt.Optional&&void 0===h&&(h=null),!(l&(Mt.Self|Mt.Host))){const g=n[Ur],C=Gt(void 0);try{return g?g.get(r,h,l&Mt.Optional):pn(r,h,l&Mt.Optional)}finally{Gt(C)}}return on(h,0,l)}function hn(n,r,l,h=Mt.Default,g){if(null!==n){if(2048&r[Ri]&&!(h&Mt.Self)){const M=function mo(n,r,l,h,g){let C=n,M=r;for(;null!==C&&null!==M&&2048&M[Ri]&&!(512&M[Ri]);){const F=jn(C,M,l,h|Mt.Self,ht);if(F!==ht)return F;let V=C.parent;if(!V){const oe=M[bs];if(oe){const Pe=oe.get(l,ht,h);if(Pe!==ht)return Pe}V=bi(M),M=M[Xr]}C=V}return g}(n,r,l,h,ht);if(M!==ht)return M}const C=jn(n,r,l,h,ht);if(C!==ht)return C}return An(r,l,h,g)}function jn(n,r,l,h,g){const C=function Bn(n){if("string"==typeof n)return n.charCodeAt(0)||0;const r=n.hasOwnProperty(xi)?n[xi]:void 0;return"number"==typeof r?r>=0?r&ue:_i:r}(l);if("function"==typeof C){if(!Gc(r,n,h))return h&Mt.Host?on(g,0,h):An(r,l,h,g);try{const M=C(h);if(null!=M||h&Mt.Optional)return M;dt()}finally{vu()}}else if("number"==typeof C){let M=null,F=Yt(n,r),V=p,oe=h&Mt.Host?r[ko][jo]:null;for((-1===F||h&Mt.SkipSelf)&&(V=-1===F?$t(n,r):r[F+8],V!==p&&Ti(h,!1)?(M=r[pi],F=ce(V),r=je(V,r)):F=-1);-1!==F;){const Pe=r[pi];if(qn(C,F,Pe.data)){const ft=cn(F,r,l,M,h,oe);if(ft!==ht)return ft}V=r[F+8],V!==p&&Ti(h,r[pi].data[F+8]===oe)&&qn(C,F,r)?(M=Pe,F=ce(V),r=je(V,r)):F=-1}}return g}function cn(n,r,l,h,g,C){const M=r[pi],F=M.data[n+8],Pe=Mn(F,M,l,null==h?Cs(F)&&Ke:h!=M&&0!=(3&F.type),g&Mt.Host&&C===F);return null!==Pe?Vn(r,M,Pe,F):ht}function Mn(n,r,l,h,g){const C=n.providerIndexes,M=r.data,F=1048575&C,V=n.directiveStart,Pe=C>>20,Ht=g?F+Pe:n.directiveEnd;for(let sn=h?F:F+Pe;sn<Ht;sn++){const Un=M[sn];if(sn<V&&l===Un||sn>=V&&Un.type===l)return sn}if(g){const sn=M[V];if(sn&&pr(sn)&&sn.type===l)return V}return null}function Vn(n,r,l,h){let g=n[l];const C=r.data;if(function c(n){return n instanceof o}(g)){const M=g;M.resolving&&function Ae(n,r){const l=r?`. Dependency path: ${r.join(" > ")} > ${n}`:"";throw new ae(-200,`Circular dependency in DI detected for ${n}${l}`)}(function Ze(n){return"function"==typeof n?n.name||n.toString():"object"==typeof n&&null!=n&&"function"==typeof n.type?n.type.name||n.type.toString():we(n)}(C[l]));const F=Ye(M.canSeeViewProviders);M.resolving=!0;const V=M.injectImpl?Gt(M.injectImpl):null;Gc(n,h,Mt.Default);try{g=n[l]=M.factory(void 0,C,n,h),r.firstCreatePass&&l>=h.directiveStart&&function le(n,r,l){const{ngOnChanges:h,ngOnInit:g,ngDoCheck:C}=r.type.prototype;if(h){const M=zc(r);(l.preOrderHooks??=[]).push(n,M),(l.preOrderCheckHooks??=[]).push(n,M)}g&&(l.preOrderHooks??=[]).push(0-n,g),C&&((l.preOrderHooks??=[]).push(n,C),(l.preOrderCheckHooks??=[]).push(n,C))}(l,C[l],r)}finally{null!==V&&Gt(V),Ye(F),M.resolving=!1,vu()}}return g}function qn(n,r,l){return!!(l[r+(n>>$e)]&1<<n)}function Ti(n,r){return!(n&Mt.Self||n&Mt.Host&&r)}class Vi{constructor(r,l){this._tNode=r,this._lView=l}get(r,l,h){return hn(this._tNode,this._lView,r,Ft(h),l)}}function _i(){return new Vi(jr(),Hn())}function Oi(n){return fo(()=>{const r=n.prototype.constructor,l=r[qi]||po(r),h=Object.prototype;let g=Object.getPrototypeOf(n.prototype).constructor;for(;g&&g!==h;){const C=g[qi]||po(g);if(C&&C!==l)return C;g=Object.getPrototypeOf(g)}return C=>new C})}function po(n){return Me(n)?()=>{const r=po(Je(n));return r&&r()}:ua(n)}function bi(n){const r=n[pi],l=r.type;return 2===l?r.declTNode:1===l?n[jo]:null}function Fo(n){return function Gn(n,r){if("class"===r)return n.classes;if("style"===r)return n.styles;const l=n.attrs;if(l){const h=l.length;let g=0;for(;g<h;){const C=l[g];if(uo(C))break;if(0===C)g+=2;else if("number"==typeof C)for(g++;g<h&&"string"==typeof l[g];)g++;else{if(C===r)return l[g+1];g+=2}}}return null}(jr(),n)}const No="__parameters__";function _s(n,r,l){return fo(()=>{const h=function Yr(n){return function(...l){if(n){const h=n(...l);for(const g in h)this[g]=h[g]}}}(r);function g(...C){if(this instanceof g)return h.apply(this,C),this;const M=new g(...C);return F.annotation=M,F;function F(V,oe,Pe){const ft=V.hasOwnProperty(No)?V[No]:Object.defineProperty(V,No,{value:[]})[No];for(;ft.length<=Pe;)ft.push(null);return(ft[Pe]=ft[Pe]||[]).push(M),V}}return l&&(g.prototype=Object.create(l.prototype)),g.prototype.ngMetadataName=n,g.annotationCls=g,g})}function Gl(n,r){n.forEach(l=>Array.isArray(l)?Gl(l,r):r(l))}function zp(n,r,l){r>=n.length?n.push(l):n.splice(r,0,l)}function yd(n,r){return r>=n.length-1?n.pop():n.splice(r,1)[0]}function vd(n,r){const l=[];for(let h=0;h<n;h++)l.push(r);return l}function Js(n,r,l){let h=Wl(n,r);return h>=0?n[1|h]=l:(h=~h,function vm(n,r,l,h){let g=n.length;if(g==r)n.push(l,h);else if(1===g)n.push(h,n[0]),n[0]=l;else{for(g--,n.push(n[g-1],n[g]);g>r;)n[g]=n[g-2],g--;n[r]=l,n[r+1]=h}}(n,h,r,l)),h}function el(n,r){const l=Wl(n,r);if(l>=0)return n[1|l]}function Wl(n,r){return function Vp(n,r,l){let h=0,g=n.length>>l;for(;g!==h;){const C=h+(g-h>>1),M=n[C<<l];if(r===M)return C<<l;M>r?g=C:h=C+1}return~(g<<l)}(n,r,1)}const nl=ei(_s("Optional"),8),yh=ei(_s("SkipSelf"),4);function Eh(n){return 128==(128&n.flags)}var sl=(()=>((sl=sl||{})[sl.Important=1]="Important",sl[sl.DashCase=2]="DashCase",sl))();const Xc=/^>|^->|<!--|-->|--!>|<!-$/g,Em=/(<|>)/,Dm="\u200b$1\u200b";const Dh=new Map;let __=0;const Id="__ngContext__";function Us(n,r){Pr(r)?(n[Id]=r[br],function Mm(n){Dh.set(n[br],n)}(r)):n[Id]=r}let ja;function ql(n,r){return ja(n,r)}function Du(n){const r=n[Li];return Nr(r)?r[Li]:r}function Ah(n){return eu(n[us])}function Qc(n){return eu(n[er])}function eu(n){for(;null!==n&&!Nr(n);)n=n[er];return n}function Tl(n,r,l,h,g){if(null!=h){let C,M=!1;Nr(h)?C=h:Pr(h)&&(M=!0,h=h[wo]);const F=Ce(h);0===n&&null!==l?null==g?wa(r,l,F):Zs(r,l,F,g||null,!0):1===n&&null!==l?Zs(r,l,F,g||null,!0):2===n?function ou(n,r,l){const h=Sd(n,r);h&&function km(n,r,l,h){n.removeChild(r,l,h)}(n,h,r,l)}(r,F,M):3===n&&r.destroyNode(F),null!=C&&function C_(n,r,l,h,g){const C=l[Sr];C!==Ce(l)&&Tl(r,n,h,C,g);for(let F=wr;F<l.length;F++){const V=l[F];Su(V[pi],V,n,r,h,C)}}(r,n,C,l,g)}}function nu(n,r){return n.createComment(function Kp(n){return n.replace(Xc,r=>r.replace(Em,Dm))}(r))}function Mu(n,r,l){return n.createElement(r,l)}function Lm(n,r){const l=n[ia],h=l.indexOf(r);fs(r),l.splice(h,1)}function iu(n,r){if(n.length<=wr)return;const l=wr+r,h=n[l];if(h){const g=h[Ir];null!==g&&g!==n&&Lm(g,h),r>0&&(n[l-1][er]=h[er]);const C=yd(n,wr+r);!function Pm(n,r){Su(n,r,r[Si],2,null,null),r[wo]=null,r[jo]=null}(h[pi],h);const M=C[Br];null!==M&&M.detachView(C[pi]),h[Li]=null,h[er]=null,h[Ri]&=-129}return h}function sf(n,r){if(!(256&r[Ri])){const l=r[Si];r[Qr]?.destroy(),r[ws]?.destroy(),l.destroyNode&&Su(n,r,l,3,null,null),function rf(n){let r=n[us];if(!r)return El(n[pi],n);for(;r;){let l=null;if(Pr(r))l=r[us];else{const h=r[wr];h&&(l=h)}if(!l){for(;r&&!r[er]&&r!==n;)Pr(r)&&El(r[pi],r),r=r[Li];null===r&&(r=n),Pr(r)&&El(r[pi],r),l=r&&r[er]}r=l}}(r)}}function El(n,r){if(!(256&r[Ri])){r[Ri]&=-129,r[Ri]|=256,function af(n,r){let l;if(null!=n&&null!=(l=n.destroyHooks))for(let h=0;h<l.length;h+=2){const g=r[l[h]];if(!(g instanceof o)){const C=l[h+1];if(Array.isArray(C))for(let M=0;M<C.length;M+=2){const F=g[C[M]],V=C[M+1];Z(4,F,V);try{V.call(F)}finally{Z(5,F,V)}}else{Z(4,g,C);try{C.call(g)}finally{Z(5,g,C)}}}}}(n,r),function tr(n,r){const l=n.cleanup,h=r[Jo];if(null!==l)for(let C=0;C<l.length-1;C+=2)if("string"==typeof l[C]){const M=l[C+3];M>=0?h[M]():h[-M].unsubscribe(),C+=2}else l[C].call(h[l[C+1]]);null!==h&&(r[Jo]=null);const g=r[rr];if(null!==g){r[rr]=null;for(let C=0;C<g.length;C++)(0,g[C])()}}(n,r),1===r[pi].type&&r[Si].destroy();const l=r[Ir];if(null!==l&&Nr(r[Li])){l!==r[Li]&&Lm(l,r);const h=r[Br];null!==h&&h.detachView(n)}!function Dd(n){Dh.delete(n[br])}(r)}}function $a(n,r,l){return function al(n,r,l){let h=r;for(;null!==h&&40&h.type;)h=(r=h).parent;if(null===h)return l[wo];{const{componentOffset:g}=h;if(g>-1){const{encapsulation:C}=n.data[h.directiveStart+g];if(C===nn.None||C===nn.Emulated)return null}return Dn(h,l)}}(n,r.parent,l)}function Zs(n,r,l,h,g){n.insertBefore(r,l,h,g)}function wa(n,r,l){n.appendChild(r,l)}function vs(n,r,l,h,g){null!==h?Zs(n,r,l,h,g):wa(n,r,l)}function Sd(n,r){return n.parentNode(r)}function Sh(n,r,l){return Ph(n,r,l)}let cf,Lh,Bd,Ph=function lf(n,r,l){return 40&n.type?Dn(n,l):null};function Pd(n,r,l,h){const g=$a(n,h,r),C=r[Si],F=Sh(h.parent||r[jo],h,r);if(null!=g)if(Array.isArray(l))for(let V=0;V<l.length;V++)vs(C,g,l[V],F,!1);else vs(C,g,l,F,!1);void 0!==cf&&cf(C,h,r,l,g)}function Od(n,r){if(null!==r){const l=r.type;if(3&l)return Dn(r,n);if(4&l)return Yl(-1,n[r.index]);if(8&l){const h=r.child;if(null!==h)return Od(n,h);{const g=n[r.index];return Nr(g)?Yl(-1,g):Ce(g)}}if(32&l)return ql(r,n)()||Ce(n[r.index]);{const h=Dl(n,r);return null!==h?Array.isArray(h)?h[0]:Od(Du(n[ko]),h):Od(n,r.next)}}return null}function Dl(n,r){return null!==r?n[ko][jo].projection[r.projection]:null}function Yl(n,r){const l=wr+n+1;if(l<r.length){const h=r[l],g=h[pi].firstChild;if(null!==g)return Od(h,g)}return r[Sr]}function Ld(n,r,l,h,g,C,M){for(;null!=l;){const F=h[l.index],V=l.type;if(M&&0===r&&(F&&Us(Ce(F),h),l.flags|=2),32!=(32&l.flags))if(8&V)Ld(n,r,l.child,h,g,C,!1),Tl(r,n,g,F,C);else if(32&V){const oe=ql(l,h);let Pe;for(;Pe=oe();)Tl(r,n,g,Pe,C);Tl(r,n,g,F,C)}else 16&V?uf(n,r,h,l,g,C):Tl(r,n,g,F,C);l=M?l.projectionNext:l.next}}function Su(n,r,l,h,g,C){Ld(l,h,n.firstChild,r,g,C,!1)}function uf(n,r,l,h,g,C){const M=l[ko],V=M[jo].projection[h.projection];if(Array.isArray(V))for(let oe=0;oe<V.length;oe++)Tl(r,n,g,V[oe],C);else{let oe=V;const Pe=M[Li];Eh(h)&&(oe.flags|=128),Ld(n,r,oe,Pe,g,C,!0)}}function Rh(n,r,l){""===l?n.removeAttribute(r,"class"):n.setAttribute(r,"class",l)}function hf(n,r,l){const{mergedAttrs:h,classes:g,styles:C}=l;null!==h&&Go(n,r,h),null!==g&&Rh(n,r,g),null!==C&&function T_(n,r,l){n.setAttribute(r,"style",l)}(n,r,C)}function D_(n){Lh=n}function Nm(n){return function ff(){if(void 0===Bd&&(Bd=null,ri.trustedTypes))try{Bd=ri.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:n=>n,createScript:n=>n,createScriptURL:n=>n})}catch{}return Bd}()?.createScriptURL(n)||n}class gf{constructor(r){this.changingThisBreaksApplicationSecurity=r}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${Te})`}}function vc(n){return n instanceof gf?n.changingThisBreaksApplicationSecurity:n}function su(n,r){const l=function M_(n){return n instanceof gf&&n.getTypeName()||null}(n);if(null!=l&&l!==r){if("ResourceURL"===l&&"URL"===r)return!0;throw new Error(`Required a safe ${r}, got a ${l} (see ${Te})`)}return l===r}const P_=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;var ss=(()=>((ss=ss||{})[ss.NONE=0]="NONE",ss[ss.HTML=1]="HTML",ss[ss.STYLE=2]="STYLE",ss[ss.SCRIPT=3]="SCRIPT",ss[ss.URL=4]="URL",ss[ss.RESOURCE_URL=5]="RESOURCE_URL",ss))();function jd(n){const r=bc();return r?r.sanitize(ss.URL,n)||"":su(n,"URL")?vc(n):function vf(n){return(n=String(n)).match(P_)?n:"unsafe:"+n}(we(n))}function zh(n){const r=bc();if(r)return Nm(r.sanitize(ss.RESOURCE_URL,n)||"");if(su(n,"ResourceURL"))return Nm(vc(n));throw new ae(904,!1)}function Gm(n,r,l){return function F_(n,r){return"src"===r&&("embed"===n||"frame"===n||"iframe"===n||"media"===n||"script"===n)||"href"===r&&("base"===n||"link"===n)?zh:jd}(r,l)(n)}function bc(){const n=Hn();return n&&n[xr].sanitizer}class lr{constructor(r,l){this._desc=r,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof l?this.__NG_ELEMENT_ID__=l:void 0!==l&&(this.\u0275prov=Sn({token:this,providedIn:l.providedIn||"root",factory:l.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}const ku=new lr("ENVIRONMENT_INITIALIZER"),au=new lr("INJECTOR",-1),Wm=new lr("INJECTOR_DEF_TYPES");class qm{get(r,l=xe){if(l===xe){const h=new Error(`NullInjectorError: No provider for ${Re(r)}!`);throw h.name="NullInjectorError",h}return l}}function Tf(n){return{\u0275providers:n}}function Ym(...n){return{\u0275providers:Ef(0,n),\u0275fromNgModule:!0}}function Ef(n,...r){const l=[],h=new Set;let g;return Gl(r,C=>{const M=C;Df(M,l,[],h)&&(g||=[],g.push(M))}),void 0!==g&&Jm(g,l),l}function Jm(n,r){for(let l=0;l<n.length;l++){const{providers:g}=n[l];$d(g,C=>{r.push(C)})}}function Df(n,r,l,h){if(!(n=Je(n)))return!1;let g=null,C=Fi(n);const M=!C&&Qi(n);if(C||M){if(M&&!M.standalone)return!1;g=n}else{const V=n.ngModule;if(C=Fi(V),!C)return!1;g=V}const F=h.has(g);if(M){if(F)return!1;if(h.add(g),M.dependencies){const V="function"==typeof M.dependencies?M.dependencies():M.dependencies;for(const oe of V)Df(oe,r,l,h)}}else{if(!C)return!1;{if(null!=C.imports&&!F){let oe;h.add(g);try{Gl(C.imports,Pe=>{Df(Pe,r,l,h)&&(oe||=[],oe.push(Pe))})}finally{}void 0!==oe&&Jm(oe,r)}if(!F){const oe=ua(g)||(()=>new g);r.push({provide:g,useFactory:oe,deps:Et},{provide:Wm,useValue:g,multi:!0},{provide:ku,useValue:()=>Y(g),multi:!0})}const V=C.providers;null==V||F||$d(V,Pe=>{r.push(Pe)})}}return g!==n&&void 0!==n.providers}function $d(n,r){for(let l of n)it(l)&&(l=l.\u0275providers),Array.isArray(l)?$d(l,r):r(l)}const Zh=_e({provide:String,useValue:_e});function Fu(n){return null!==n&&"object"==typeof n&&Zh in n}function ll(n){return"function"==typeof n}const Vh=new lr("Set Injector scope."),wc={},Qm={};let Mf;function Gd(){return void 0===Mf&&(Mf=new qm),Mf}class Cc{}class jh extends Cc{get destroyed(){return this._destroyed}constructor(r,l,h,g){super(),this.parent=l,this.source=h,this.scopes=g,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,Is(r,M=>this.processProvider(M)),this.records.set(au,Bu(void 0,this)),g.has("environment")&&this.records.set(Cc,Bu(void 0,this));const C=this.records.get(Vh);null!=C&&"string"==typeof C.value&&this.scopes.add(C.value),this.injectorDefTypes=new Set(this.get(Wm.multi,Et,Mt.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const l of this._ngOnDestroyHooks)l.ngOnDestroy();const r=this._onDestroyHooks;this._onDestroyHooks=[];for(const l of r)l()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear()}}onDestroy(r){return this.assertNotDestroyed(),this._onDestroyHooks.push(r),()=>this.removeOnDestroy(r)}runInContext(r){this.assertNotDestroyed();const l=et(this),h=Gt(void 0);try{return r()}finally{et(l),Gt(h)}}get(r,l=xe,h=Mt.Default){if(this.assertNotDestroyed(),r.hasOwnProperty(go))return r[go](this);h=Ft(h);const g=et(this),C=Gt(void 0);try{if(!(h&Mt.SkipSelf)){let F=this.records.get(r);if(void 0===F){const V=function og(n){return"function"==typeof n||"object"==typeof n&&n instanceof lr}(r)&&$i(r);F=V&&this.injectableDefInScope(V)?Bu($h(r),wc):null,this.records.set(r,F)}if(null!=F)return this.hydrate(r,F)}return(h&Mt.Self?Gd():this.parent).get(r,l=h&Mt.Optional&&l===xe?null:l)}catch(M){if("NullInjectorError"===M.name){if((M[vt]=M[vt]||[]).unshift(Re(r)),g)throw M;return function Ii(n,r,l,h){const g=n[vt];throw r[Pt]&&g.unshift(r[Pt]),n.message=function Zi(n,r,l,h=null){n=n&&"\n"===n.charAt(0)&&"\u0275"==n.charAt(1)?n.slice(2):n;let g=Re(r);if(Array.isArray(r))g=r.map(Re).join(" -> ");else if("object"==typeof r){let C=[];for(let M in r)if(r.hasOwnProperty(M)){let F=r[M];C.push(M+":"+("string"==typeof F?JSON.stringify(F):Re(F)))}g=`{${C.join(", ")}}`}return`${l}${h?"("+h+")":""}[${g}]: ${n.replace(Zt,"\n  ")}`}("\n"+n.message,g,l,h),n.ngTokenPath=g,n[vt]=null,n}(M,r,"R3InjectorError",this.source)}throw M}finally{Gt(C),et(g)}}resolveInjectorInitializers(){const r=et(this),l=Gt(void 0);try{const h=this.get(ku.multi,Et,Mt.Self);for(const g of h)g()}finally{et(r),Gt(l)}}toString(){const r=[],l=this.records;for(const h of l.keys())r.push(Re(h));return`R3Injector[${r.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new ae(205,!1)}processProvider(r){let l=ll(r=Je(r))?r:Je(r&&r.provide);const h=function tg(n){return Fu(n)?Bu(void 0,n.useValue):Bu(ng(n),wc)}(r);if(ll(r)||!0!==r.multi)this.records.get(l);else{let g=this.records.get(l);g||(g=Bu(void 0,wc,!0),g.factory=()=>gn(g.multi),this.records.set(l,g)),l=r,g.multi.push(r)}this.records.set(l,h)}hydrate(r,l){return l.value===wc&&(l.value=Qm,l.value=l.factory()),"object"==typeof l.value&&l.value&&function Hh(n){return null!==n&&"object"==typeof n&&"function"==typeof n.ngOnDestroy}(l.value)&&this._ngOnDestroyHooks.add(l.value),l.value}injectableDefInScope(r){if(!r.providedIn)return!1;const l=Je(r.providedIn);return"string"==typeof l?"any"===l||this.scopes.has(l):this.injectorDefTypes.has(l)}removeOnDestroy(r){const l=this._onDestroyHooks.indexOf(r);-1!==l&&this._onDestroyHooks.splice(l,1)}}function $h(n){const r=$i(n),l=null!==r?r.factory:ua(n);if(null!==l)return l;if(n instanceof lr)throw new ae(204,!1);if(n instanceof Function)return function eg(n){const r=n.length;if(r>0)throw vd(r,"?"),new ae(204,!1);const l=function Hi(n){return n&&(n[ii]||n[xn])||null}(n);return null!==l?()=>l.factory(n):()=>new n}(n);throw new ae(204,!1)}function ng(n,r,l){let h;if(ll(n)){const g=Je(n);return ua(g)||$h(g)}if(Fu(n))h=()=>Je(n.useValue);else if(function Xm(n){return!(!n||!n.useFactory)}(n))h=()=>n.useFactory(...gn(n.deps||[]));else if(function Km(n){return!(!n||!n.useExisting)}(n))h=()=>Y(Je(n.useExisting));else{const g=Je(n&&(n.useClass||n.provide));if(!function ig(n){return!!n.deps}(n))return ua(g)||$h(g);h=()=>new g(...gn(n.deps))}return h}function Bu(n,r,l=!1){return{factory:n,value:r,multi:l?[]:void 0}}function Is(n,r){for(const l of n)Array.isArray(l)?Is(l,r):l&&it(l)?Is(l.\u0275providers,r):r(l)}const Nu=new lr("AppId",{providedIn:"root",factory:()=>zu}),zu="ng",Uu=new lr("Platform Initializer"),Gh=new lr("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),N_=new lr("CSP nonce",{providedIn:"root",factory:()=>function Fd(){if(void 0!==Lh)return Lh;if(typeof document<"u")return document;throw new ae(210,!1)}().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});let Jd=(n,r)=>null;function sg(n,r){return Jd(n,r)}class $u{}class Of{}class H_{resolveComponentFactory(r){throw function $_(n){const r=Error(`No component factory found for ${Re(n)}.`);return r.ngComponent=n,r}(r)}}let np=(()=>{class n{}return n.NULL=new H_,n})();function G_(){return Hu(jr(),Hn())}function Hu(n,r){return new Kd(Dn(n,r))}let Kd=(()=>{class n{constructor(l){this.nativeElement=l}}return n.__NG_ELEMENT_ID__=G_,n})();function W_(n){return n instanceof Kd?n.nativeElement:n}class Xd{}let Gu=(()=>{class n{constructor(){this.destroyNode=null}}return n.__NG_ELEMENT_ID__=()=>function cg(){const n=Hn(),l=Xi(jr().index,n);return(Pr(l)?l:n)[Si]}(),n})(),ip=(()=>{class n{}return n.\u0275prov=Sn({token:n,providedIn:"root",factory:()=>null}),n})();class op{constructor(r){this.full=r,this.major=r.split(".")[0],this.minor=r.split(".")[1],this.patch=r.split(".").slice(2).join(".")}}const q_=new op("16.1.3"),Rf={};function Qd(n){for(;n;){n[Ri]|=64;const r=Du(n);if(Cr(n)&&!r)return n;n=r}return null}function js(n){return n.ngOriginalError}class Tc{constructor(){this._console=console}handleError(r){const l=this._findOriginalError(r);this._console.error("ERROR",r),l&&this._console.error("ORIGINAL ERROR",l)}_findOriginalError(r){let l=r&&js(r);for(;l&&js(l);)l=js(l);return l||null}}const kf=new lr("",{providedIn:"root",factory:()=>!1});function Ml(n){return n instanceof Function?n():n}class Uf extends pl{constructor(){super(...arguments),this.consumerAllowSignalWrites=!1,this._lView=null}set lView(r){this._lView=r}onConsumerDependencyMayHaveChanged(){Qd(this._lView)}onProducerUpdateValueVersion(){}get hasReadASignal(){return this.hasProducers}runInContext(r,l,h){const g=Or(this);this.trackingVersion++;try{r(l,h)}finally{Or(g)}}destroy(){this.trackingVersion++}}let nh=null;function fg(){return nh??=new Uf,nh}function mg(n,r){return n[r]??fg()}function Zf(n,r){const l=fg();l.hasReadASignal&&(n[r]=nh,l.lView=n,nh=new Uf)}const _o={};function Yu(n){Vf(Mo(),Hn(),qr()+n,!1)}function Vf(n,r,l,h){if(!h)if(3==(3&r[Ri])){const C=n.preOrderCheckHooks;null!==C&&We(r,C,l)}else{const C=n.preOrderHooks;null!==C&&Jt(r,C,0,l)}ui(l)}function gg(n,r=null,l=null,h){const g=_g(n,r,l,h);return g.resolveInjectorInitializers(),g}function _g(n,r=null,l=null,h,g=new Set){const C=[l||Et,Ym(n)];return h=h||("object"==typeof n?void 0:Re(n)),new jh(C,r||Gd(),h||null,g)}let Ec=(()=>{class n{static create(l,h){if(Array.isArray(l))return gg({name:""},h,l,"");{const g=l.name??"";return gg({name:g},l.parent,l.providers,g)}}}return n.THROW_IF_NOT_FOUND=xe,n.NULL=new qm,n.\u0275prov=Sn({token:n,providedIn:"any",factory:()=>Y(au)}),n.__NG_ELEMENT_ID__=-1,n})();function Xu(n,r=Mt.Default){const l=Hn();return null===l?Y(n,r):hn(jr(),l,Je(n),r)}function lu(){throw new Error("invalid")}function ed(n,r,l,h,g,C,M,F,V,oe,Pe){const ft=r.blueprint.slice();return ft[wo]=g,ft[Ri]=140|h,(null!==oe||n&&2048&n[Ri])&&(ft[Ri]|=2048),Ls(ft),ft[Li]=ft[Xr]=n,ft[Oo]=l,ft[xr]=M||n&&n[xr],ft[Si]=F||n&&n[Si],ft[Ur]=V||n&&n[Ur]||null,ft[jo]=C,ft[br]=function y_(){return __++}(),ft[Ar]=Pe,ft[bs]=oe,ft[ko]=2==r.type?n[ko]:ft,ft}function td(n,r,l,h,g){let C=n.data[r];if(null===C)C=function up(n,r,l,h,g){const C=pc(),M=Fs(),V=n.data[r]=function ty(n,r,l,h,g,C){let M=r?r.injectorIndex:-1,F=0;return ga()&&(F|=128),{type:l,index:h,insertBeforeIndex:null,injectorIndex:M,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:F,providerIndexes:0,value:g,attrs:C,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:r,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,M?C:C&&C.parent,l,r,h,g);return null===n.firstChild&&(n.firstChild=V),null!==C&&(M?null==C.child&&null!==V.parent&&(C.child=V):null===C.next&&(C.next=V,V.prev=C)),V}(n,r,l,h,g),function md(){return ki.lFrame.inI18n}()&&(C.flags|=32);else if(64&C.type){C.type=l,C.value=h,C.attrs=g;const M=function Aa(){const n=ki.lFrame,r=n.currentTNode;return n.isParent?r:r.parent}();C.injectorIndex=null===M?-1:M.injectorIndex}return ks(C,!0),C}function ih(n,r,l,h){if(0===l)return-1;const g=r.length;for(let C=0;C<l;C++)r.push(h),n.blueprint.push(h),n.data.push(null);return g}function dp(n,r,l,h,g){const C=mg(r,Qr),M=qr(),F=2&h;try{if(ui(-1),F&&r.length>eo&&Vf(n,r,eo,!1),Z(F?2:0,g),F)C.runInContext(l,h,g);else{const oe=Or(null);try{l(h,g)}finally{Or(oe)}}}finally{F&&null===r[Qr]&&Zf(r,Qr),ui(M),Z(F?3:1,g)}}function Hf(n,r,l){if(Gs(r)){const h=Or(null);try{const C=r.directiveEnd;for(let M=r.directiveStart;M<C;M++){const F=n.data[M];F.contentQueries&&F.contentQueries(1,l[M],M)}}finally{Or(h)}}}function cu(n,r,l){gl()&&(function oy(n,r,l,h){const g=l.directiveStart,C=l.directiveEnd;Cs(l)&&function mp(n,r,l){const h=Dn(r,n),g=Gf(l);let M=16;l.signals?M=4096:l.onPush&&(M=64);const F=ah(n,ed(n,g,null,M,h,r,null,n[xr].rendererFactory.createRenderer(h,l),null,null,null));n[r.index]=F}(r,l,n.data[g+l.componentOffset]),n.firstCreatePass||kt(l,r),Us(h,r);const M=l.initialInputs;for(let F=g;F<C;F++){const V=n.data[F],oe=Vn(r,n,F,l);Us(oe,r),null!==M&&Xf(0,F-g,oe,V,0,M),pr(V)&&(Xi(l.index,r)[Oo]=Vn(r,n,F,l))}}(n,r,l,Dn(l,r)),64==(64&l.flags)&&Yf(n,r,l))}function Al(n,r,l=Dn){const h=r.localNames;if(null!==h){let g=r.index+1;for(let C=0;C<h.length;C+=2){const M=h[C+1],F=-1===M?l(r,n):n[M];n[g++]=F}}}function Gf(n){const r=n.tView;return null===r||r.incompleteFirstPass?n.tView=hp(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts,n.id):r}function hp(n,r,l,h,g,C,M,F,V,oe,Pe){const ft=eo+h,Ht=ft+g,sn=function pp(n,r){const l=[];for(let h=0;h<r;h++)l.push(h<n?null:_o);return l}(ft,Ht),Un="function"==typeof oe?oe():oe;return sn[pi]={type:n,blueprint:sn,template:l,queries:null,viewQuery:F,declTNode:r,data:sn.slice().fill(null,ft),bindingStartIndex:ft,expandoStartIndex:Ht,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof C?C():C,pipeRegistry:"function"==typeof M?M():M,firstChild:null,schemas:V,consts:Un,incompleteFirstPass:!1,ssrId:Pe}}let qf=n=>null;function nd(n,r,l,h){for(let g in n)if(n.hasOwnProperty(g)){l=null===l?{}:l;const C=n[g];null===h?id(l,r,g,C):h.hasOwnProperty(g)&&id(l,r,h[g],C)}return l}function id(n,r,l,h){n.hasOwnProperty(l)?n[l].push(r,h):n[l]=[r,h]}function Xs(n,r,l,h,g,C,M,F){const V=Dn(r,l);let Pe,oe=r.inputs;!F&&null!=oe&&(Pe=oe[h])?(Qf(n,l,Pe,h,g),Cs(r)&&function ny(n,r){const l=Xi(r,n);16&l[Ri]||(l[Ri]|=64)}(l,r.index)):3&r.type&&(h=function rh(n){return"class"===n?"className":"for"===n?"htmlFor":"formaction"===n?"formAction":"innerHtml"===n?"innerHTML":"readonly"===n?"readOnly":"tabindex"===n?"tabIndex":n}(h),g=null!=M?M(g,r.value||"",h):g,C.setProperty(V,h,g))}function od(n,r,l,h){if(gl()){const g=null===h?null:{"":-1},C=function bg(n,r){const l=n.directiveRegistry;let h=null,g=null;if(l)for(let C=0;C<l.length;C++){const M=l[C];if(Mr(r,M.selectors,!1))if(h||(h=[]),pr(M))if(null!==M.findHostDirectiveDefs){const F=[];g=g||new Map,M.findHostDirectiveDefs(M,F,g),h.unshift(...F,M),Jf(n,r,F.length)}else h.unshift(M),Jf(n,r,0);else g=g||new Map,M.findHostDirectiveDefs?.(M,h,g),h.push(M)}return null===h?null:[h,g]}(n,l);let M,F;null===C?M=F=null:[M,F]=C,null!==M&&yg(n,r,l,M,g,F),g&&function wg(n,r,l){if(r){const h=n.localNames=[];for(let g=0;g<r.length;g+=2){const C=l[r[g+1]];if(null==C)throw new ae(-301,!1);h.push(r[g],C)}}}(l,h,g)}l.mergedAttrs=Ai(l.mergedAttrs,l.attrs)}function yg(n,r,l,h,g,C){for(let oe=0;oe<h.length;oe++)ln(kt(l,r),n,h[oe].type);!function ay(n,r,l){n.flags|=1,n.directiveStart=r,n.directiveEnd=r+l,n.providerIndexes=r}(l,n.data.length,h.length);for(let oe=0;oe<h.length;oe++){const Pe=h[oe];Pe.providersResolver&&Pe.providersResolver(Pe)}let M=!1,F=!1,V=ih(n,r,h.length,null);for(let oe=0;oe<h.length;oe++){const Pe=h[oe];l.mergedAttrs=Ai(l.mergedAttrs,Pe.hostAttrs),fp(n,l,r,V,Pe),sy(V,Pe,g),null!==Pe.contentQueries&&(l.flags|=4),(null!==Pe.hostBindings||null!==Pe.hostAttrs||0!==Pe.hostVars)&&(l.flags|=64);const ft=Pe.type.prototype;!M&&(ft.ngOnChanges||ft.ngOnInit||ft.ngDoCheck)&&((n.preOrderHooks??=[]).push(l.index),M=!0),!F&&(ft.ngOnChanges||ft.ngDoCheck)&&((n.preOrderCheckHooks??=[]).push(l.index),F=!0),V++}!function oh(n,r,l){const g=r.directiveEnd,C=n.data,M=r.attrs,F=[];let V=null,oe=null;for(let Pe=r.directiveStart;Pe<g;Pe++){const ft=C[Pe],Ht=l?l.get(ft):null,Un=Ht?Ht.outputs:null;V=nd(ft.inputs,Pe,V,Ht?Ht.inputs:null),oe=nd(ft.outputs,Pe,oe,Un);const ni=null===V||null===M||xo(r)?null:Mc(V,Pe,M);F.push(ni)}null!==V&&(V.hasOwnProperty("class")&&(r.flags|=8),V.hasOwnProperty("style")&&(r.flags|=16)),r.initialInputs=F,r.inputs=V,r.outputs=oe}(n,l,C)}function Yf(n,r,l){const h=l.directiveStart,g=l.directiveEnd,C=l.index,M=function _d(){return ki.lFrame.currentDirectiveIndex}();try{ui(C);for(let F=h;F<g;F++){const V=n.data[F],oe=r[F];mc(F),(null!==V.hostBindings||0!==V.hostVars||null!==V.hostAttrs)&&ry(V,oe)}}finally{ui(-1),mc(M)}}function ry(n,r){null!==n.hostBindings&&n.hostBindings(1,r)}function Jf(n,r,l){r.componentOffset=l,(n.components??=[]).push(r.index)}function sy(n,r,l){if(l){if(r.exportAs)for(let h=0;h<r.exportAs.length;h++)l[r.exportAs[h]]=n;pr(r)&&(l[""]=n)}}function fp(n,r,l,h,g){n.data[h]=g;const C=g.factory||(g.factory=ua(g.type)),M=new o(C,pr(g),Xu);n.blueprint[h]=M,l[h]=M,function vg(n,r,l,h,g){const C=g.hostBindings;if(C){let M=n.hostBindingOpCodes;null===M&&(M=n.hostBindingOpCodes=[]);const F=~r.index;(function xg(n){let r=n.length;for(;r>0;){const l=n[--r];if("number"==typeof l&&l<0)return l}return 0})(M)!=F&&M.push(F),M.push(l,h,C)}}(n,r,h,ih(n,l,g.hostVars,_o),g)}function Ra(n,r,l,h,g,C){const M=Dn(n,r);!function Kf(n,r,l,h,g,C,M){if(null==C)n.removeAttribute(r,g,l);else{const F=null==M?we(C):M(C,h||"",g);n.setAttribute(r,g,F,l)}}(r[Si],M,C,n.value,l,h,g)}function Xf(n,r,l,h,g,C){const M=C[r];if(null!==M)for(let F=0;F<M.length;)gp(h,l,M[F++],M[F++],M[F++])}function gp(n,r,l,h,g){const C=Or(null);try{const M=n.inputTransforms;null!==M&&M.hasOwnProperty(h)&&(g=M[h].call(r,g)),null!==n.setInput?n.setInput(r,g,l,h):r[h]=g}finally{Or(C)}}function Mc(n,r,l){let h=null,g=0;for(;g<l.length;){const C=l[g];if(0!==C)if(5!==C){if("number"==typeof C)break;if(n.hasOwnProperty(C)){null===h&&(h=[]);const M=n[C];for(let F=0;F<M.length;F+=2)if(M[F]===r){h.push(C,M[F+1],l[g+1]);break}}g+=2}else g+=2;else g+=4}return h}function Cg(n,r,l,h){return[n,!0,!1,r,null,0,h,l,null,null,null]}function _p(n,r){const l=n.contentQueries;if(null!==l)for(let h=0;h<l.length;h+=2){const C=l[h+1];if(-1!==C){const M=n.data[C];es(l[h]),M.contentQueries(2,r[C],C)}}}function ah(n,r){return n[us]?n[ta][er]=r:n[us]=r,n[ta]=r,r}function rd(n,r,l){es(0);const h=Or(null);try{r(n,l)}finally{Or(h)}}function Tg(n){return n[Jo]||(n[Jo]=[])}function Eg(n){return n.cleanup||(n.cleanup=[])}function yp(n,r){const l=n[Ur],h=l?l.get(Tc,null):null;h&&h.handleError(r)}function Qf(n,r,l,h,g){for(let C=0;C<l.length;){const M=l[C++],F=l[C++];gp(n.data[M],r[M],h,F,g)}}function La(n,r,l){const h=yn(r,n);!function nf(n,r,l){n.setValue(r,l)}(n[Si],h,l)}function ly(n,r){const l=Xi(r,n),h=l[pi];!function cy(n,r){for(let l=r.length;l<n.blueprint.length;l++)r.push(n.blueprint[l])}(h,l);const g=l[wo];null!==g&&null===l[Ar]&&(l[Ar]=sg(g,l[Ur])),vp(h,l,l[Oo])}function vp(n,r,l){Wc(r);try{const h=n.viewQuery;null!==h&&rd(1,h,l);const g=n.template;null!==g&&dp(n,r,g,1,l),n.firstCreatePass&&(n.firstCreatePass=!1),n.staticContentQueries&&_p(n,r),n.staticViewQueries&&rd(2,n.viewQuery,l);const C=n.components;null!==C&&function uy(n,r){for(let l=0;l<r.length;l++)ly(n,r[l])}(r,C)}catch(h){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),h}finally{r[Ri]&=-5,Ns()}}let ec=(()=>{class n{constructor(){this.all=new Set,this.queue=new Map}create(l,h,g){const C=typeof Zone>"u"?null:Zone.current,M=new mu(l,oe=>{this.all.has(oe)&&this.queue.set(oe,C)},g);let F;this.all.add(M),M.notify();const V=()=>{M.cleanup(),F?.(),this.all.delete(M),this.queue.delete(M)};return F=h?.onDestroy(V),{destroy:V}}flush(){if(0!==this.queue.size)for(const[l,h]of this.queue)this.queue.delete(l),h?h.run(()=>l.run()):l.run()}get isQueueEmpty(){return 0===this.queue.size}}return n.\u0275prov=Sn({token:n,providedIn:"root",factory:()=>new n}),n})();function ul(n,r,l){let h=l?n.styles:null,g=l?n.classes:null,C=0;if(null!==r)for(let M=0;M<r.length;M++){const F=r[M];"number"==typeof F?C=F:1==C?g=Ne(g,F):2==C&&(h=Ne(h,F+": "+r[++M]+";"))}l?n.styles=h:n.stylesWithoutHost=h,l?n.classes=g:n.classesWithoutHost=g}function Ic(n,r,l,h,g=!1){for(;null!==l;){const C=r[l.index];if(null!==C&&h.push(Ce(C)),Nr(C)){for(let F=wr;F<C.length;F++){const V=C[F],oe=V[pi].firstChild;null!==oe&&Ic(V[pi],V,oe,h)}C[Sr]!==C[wo]&&h.push(C[Sr])}const M=l.type;if(8&M)Ic(n,r,l.child,h);else if(32&M){const F=ql(l,r);let V;for(;V=F();)h.push(V)}else if(16&M){const F=Dl(r,l);if(Array.isArray(F))h.push(...F);else{const V=Du(r[ko]);Ic(V[pi],V,F,h,!0)}}l=g?l.projectionNext:l.next}return h}function lh(n,r,l,h=!0){const g=r[xr].rendererFactory;g.begin&&g.begin();try{xp(n,r,n.template,l)}catch(M){throw h&&yp(r,M),M}finally{g.end&&g.end(),r[xr].effectManager?.flush()}}function xp(n,r,l,h){const g=r[Ri];if(256!=(256&g)){r[xr].effectManager?.flush(),Wc(r);try{Ls(r),function yl(n){return ki.lFrame.bindingIndex=n}(n.bindingStartIndex),null!==l&&dp(n,r,l,2,h);const M=3==(3&g);if(M){const oe=n.preOrderCheckHooks;null!==oe&&We(r,oe,null)}else{const oe=n.preOrderHooks;null!==oe&&Jt(r,oe,0,null),Rn(r,0)}if(function Sg(n){for(let r=Ah(n);null!==r;r=Qc(r)){if(!r[Ss])continue;const l=r[ia];for(let h=0;h<l.length;h++){Ds(l[h])}}}(r),Ag(r,2),null!==n.contentQueries&&_p(n,r),M){const oe=n.contentCheckHooks;null!==oe&&We(r,oe)}else{const oe=n.contentHooks;null!==oe&&Jt(r,oe,1),Rn(r,1)}!function Qu(n,r){const l=n.hostBindingOpCodes;if(null===l)return;const h=mg(r,ws);try{for(let g=0;g<l.length;g++){const C=l[g];if(C<0)ui(~C);else{const M=C,F=l[++g],V=l[++g];gd(F,M),h.runInContext(V,2,r[M])}}}finally{null===r[ws]&&Zf(r,ws),ui(-1)}}(n,r);const F=n.components;null!==F&&tm(r,F,0);const V=n.viewQuery;if(null!==V&&rd(2,V,h),M){const oe=n.viewCheckHooks;null!==oe&&We(r,oe)}else{const oe=n.viewHooks;null!==oe&&Jt(r,oe,2),Rn(r,2)}!0===n.firstUpdatePass&&(n.firstUpdatePass=!1),r[Ri]&=-73,fs(r)}finally{Ns()}}}function Ag(n,r){for(let l=Ah(n);null!==l;l=Qc(l))for(let h=wr;h<l.length;h++)em(l[h],r)}function Pg(n,r,l){em(Xi(r,n),l)}function em(n,r){if(!function fr(n){return 128==(128&n[Ri])}(n))return;const l=n[pi];if(80&n[Ri]&&0===r||1024&n[Ri]||2===r)xp(l,n,l.template,n[Oo]);else if(n[is]>0){Ag(n,1);const g=n[pi].components;null!==g&&tm(n,g,1)}}function tm(n,r,l){for(let h=0;h<r.length;h++)Pg(n,r[h],l)}class sd{get rootNodes(){const r=this._lView,l=r[pi];return Ic(l,r,l.firstChild,[])}constructor(r,l){this._lView=r,this._cdRefInjectingView=l,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[Oo]}set context(r){this._lView[Oo]=r}get destroyed(){return 256==(256&this._lView[Ri])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const r=this._lView[Li];if(Nr(r)){const l=r[8],h=l?l.indexOf(this):-1;h>-1&&(iu(r,h),yd(l,h))}this._attachedToViewContainer=!1}sf(this._lView[pi],this._lView)}onDestroy(r){!function qs(n,r){if(256==(256&n[Ri]))throw new ae(911,!1);null===n[rr]&&(n[rr]=[]),n[rr].push(r)}(this._lView,r)}markForCheck(){Qd(this._cdRefInjectingView||this._lView)}detach(){this._lView[Ri]&=-129}reattach(){this._lView[Ri]|=128}detectChanges(){lh(this._lView[pi],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new ae(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function Om(n,r){Su(n,r,r[Si],2,null,null)}(this._lView[pi],this._lView)}attachToAppRef(r){if(this._attachedToViewContainer)throw new ae(902,!1);this._appRef=r}}class Og extends sd{constructor(r){super(r),this._view=r}detectChanges(){const r=this._view;lh(r[pi],r,r[Oo],!1)}checkNoChanges(){}get context(){return null}}class nm extends np{constructor(r){super(),this.ngModule=r}resolveComponentFactory(r){const l=Qi(r);return new ch(l,this.ngModule)}}function tc(n){const r=[];for(let l in n)n.hasOwnProperty(l)&&r.push({propName:n[l],templateName:l});return r}class hy{constructor(r,l){this.injector=r,this.parentInjector=l}get(r,l,h){h=Ft(h);const g=this.injector.get(r,Rf,h);return g!==Rf||l===Rf?g:this.parentInjector.get(r,l,h)}}class ch extends Of{get inputs(){const r=this.componentDef,l=r.inputTransforms,h=tc(r.inputs);if(null!==l)for(const g of h)l.hasOwnProperty(g.propName)&&(g.transform=l[g.propName]);return h}get outputs(){return tc(this.componentDef.outputs)}constructor(r,l){super(),this.componentDef=r,this.ngModule=l,this.componentType=r.type,this.selector=function tt(n){return n.map(Le).join(",")}(r.selectors),this.ngContentSelectors=r.ngContentSelectors?r.ngContentSelectors:[],this.isBoundToModule=!!l}create(r,l,h,g){let C=(g=g||this.ngModule)instanceof Cc?g:g?.injector;C&&null!==this.componentDef.getStandaloneInjector&&(C=this.componentDef.getStandaloneInjector(C)||C);const M=C?new hy(r,C):r,F=M.get(Xd,null);if(null===F)throw new ae(407,!1);const Pe={rendererFactory:F,sanitizer:M.get(ip,null),effectManager:M.get(ec,null)},ft=F.createRenderer(null,this.componentDef),Ht=this.componentDef.selectors[0][0]||"div",sn=h?function Wf(n,r,l,h){const C=h.get(kf,!1)||l===nn.ShadowDom,M=n.selectRootElement(r,C);return function Q_(n){qf(n)}(M),M}(ft,h,this.componentDef.encapsulation,M):Mu(ft,Ht,function Rg(n){const r=n.toLowerCase();return"svg"===r?"svg":"math"===r?"math":null}(Ht)),vi=this.componentDef.signals?4608:this.componentDef.onPush?576:528,ji=hp(0,null,null,1,0,null,null,null,null,null,null),Wn=ed(null,ji,null,vi,null,null,Pe,ft,M,null,null);let vo,Ho;Wc(Wn);try{const Xo=this.componentDef;let Da,s_=null;Xo.findHostDirectiveDefs?(Da=[],s_=new Map,Xo.findHostDirectiveDefs(Xo,Da,s_),Da.push(Xo)):Da=[Xo];const kT=function ad(n,r){const l=n[pi],h=eo;return n[h]=r,td(l,h,2,"#host",null)}(Wn,sn),FT=function im(n,r,l,h,g,C,M){const F=g[pi];!function om(n,r,l,h){for(const g of n)r.mergedAttrs=Ai(r.mergedAttrs,g.hostAttrs);null!==r.mergedAttrs&&(ul(r,r.mergedAttrs,!0),null!==l&&hf(h,l,r))}(h,n,r,M);let V=null;null!==r&&(V=sg(r,g[Ur]));const oe=C.rendererFactory.createRenderer(r,l);let Pe=16;l.signals?Pe=4096:l.onPush&&(Pe=64);const ft=ed(g,Gf(l),null,Pe,g[n.index],n,C,oe,null,null,V);return F.firstCreatePass&&Jf(F,n,h.length-1),ah(g,ft),g[n.index]=ft}(kT,sn,Xo,Da,Wn,Pe,ft);Ho=Eo(ji,eo),sn&&function rm(n,r,l,h){if(h)Go(n,l,["ng-version",q_.full]);else{const{attrs:g,classes:C}=function Nt(n){const r=[],l=[];let h=1,g=2;for(;h<n.length;){let C=n[h];if("string"==typeof C)2===g?""!==C&&r.push(C,n[++h]):8===g&&l.push(C);else{if(!bo(g))break;g=C}h++}return{attrs:r,classes:l}}(r.selectors[0]);g&&Go(n,l,g),C&&C.length>0&&Rh(n,l,C.join(" "))}}(ft,Xo,sn,h),void 0!==l&&function sm(n,r,l){const h=n.projection=[];for(let g=0;g<r.length;g++){const C=l[g];h.push(null!=C?Array.from(C):null)}}(Ho,this.ngContentSelectors,l),vo=function Pl(n,r,l,h,g,C){const M=jr(),F=g[pi],V=Dn(M,g);yg(F,g,M,l,null,h);for(let Pe=0;Pe<l.length;Pe++)Us(Vn(g,F,M.directiveStart+Pe,M),g);Yf(F,g,M),V&&Us(V,g);const oe=Vn(g,F,M.directiveStart+M.componentOffset,M);if(n[Oo]=g[Oo]=oe,null!==C)for(const Pe of C)Pe(oe,r);return Hf(F,M,n),oe}(FT,Xo,Da,s_,Wn,[dl]),vp(ji,Wn,null)}finally{Ns()}return new bp(this.componentType,vo,Hu(Ho,Wn),Wn,Ho)}}class bp extends $u{constructor(r,l,h,g,C){super(),this.location=h,this._rootLView=g,this._tNode=C,this.previousInputValues=null,this.instance=l,this.hostView=this.changeDetectorRef=new Og(g),this.componentType=r}setInput(r,l){const h=this._tNode.inputs;let g;if(null!==h&&(g=h[r])){if(this.previousInputValues??=new Map,this.previousInputValues.has(r)&&Object.is(this.previousInputValues.get(r),l))return;const C=this._rootLView;Qf(C[pi],C,g,r,l),this.previousInputValues.set(r,l),Qd(Xi(this._tNode.index,C))}}get injector(){return new Vi(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(r){this.hostView.onDestroy(r)}}function dl(){const n=jr();Fe(Hn()[pi],n)}function wp(n){let r=function Ac(n){return Object.getPrototypeOf(n.prototype).constructor}(n.type),l=!0;const h=[n];for(;r;){let g;if(pr(n))g=r.\u0275cmp||r.\u0275dir;else{if(r.\u0275cmp)throw new ae(903,!1);g=r.\u0275dir}if(g){if(l){h.push(g);const M=n;M.inputs=Sc(n.inputs),M.inputTransforms=Sc(n.inputTransforms),M.declaredInputs=Sc(n.declaredInputs),M.outputs=Sc(n.outputs);const F=g.hostBindings;F&&Fg(n,F);const V=g.viewQuery,oe=g.contentQueries;if(V&&Cp(n,V),oe&&kg(n,oe),be(n.inputs,g.inputs),be(n.declaredInputs,g.declaredInputs),be(n.outputs,g.outputs),null!==g.inputTransforms&&(null===M.inputTransforms&&(M.inputTransforms={}),be(M.inputTransforms,g.inputTransforms)),pr(g)&&g.data.animation){const Pe=n.data;Pe.animation=(Pe.animation||[]).concat(g.data.animation)}}const C=g.features;if(C)for(let M=0;M<C.length;M++){const F=C[M];F&&F.ngInherit&&F(n),F===wp&&(l=!1)}}r=Object.getPrototypeOf(r)}!function Lg(n){let r=0,l=null;for(let h=n.length-1;h>=0;h--){const g=n[h];g.hostVars=r+=g.hostVars,g.hostAttrs=Ai(g.hostAttrs,l=Ai(l,g.hostAttrs))}}(h)}function Sc(n){return n===bt?{}:n===Et?[]:n}function Cp(n,r){const l=n.viewQuery;n.viewQuery=l?(h,g)=>{r(h,g),l(h,g)}:r}function kg(n,r){const l=n.contentQueries;n.contentQueries=l?(h,g,C)=>{r(h,g,C),l(h,g,C)}:r}function Fg(n,r){const l=n.hostBindings;n.hostBindings=l?(h,g)=>{r(h,g),l(h,g)}:r}function Ep(n){const r=n.inputConfig,l={};for(const h in r)if(r.hasOwnProperty(h)){const g=r[h];Array.isArray(g)&&g[2]&&(l[h]=g[2])}n.inputTransforms=l}function uh(n){return!!Dp(n)&&(Array.isArray(n)||!(n instanceof Map)&&Symbol.iterator in n)}function Dp(n){return null!==n&&("function"==typeof n||"object"==typeof n)}function e(n,r,l){return n[r]=l}function a(n,r,l){return!Object.is(n[r],l)&&(n[r]=l,!0)}function u(n,r,l,h){const g=a(n,r,l);return a(n,r+1,h)||g}function w(n,r,l,h){const g=Hn();return a(g,Xa(),r)&&(Mo(),Ra(_r(),g,n,r,l,h)),w}function D(n,r,l,h){return a(n,Xa(),l)?r+we(l)+h:_o}function z(n,r,l,h,g,C,M,F){const oe=function f(n,r,l,h,g){const C=u(n,r,l,h);return a(n,r+2,g)||C}(n,aa(),l,g,M);return rs(3),oe?r+we(l)+h+we(g)+C+we(M)+F:_o}function j(n,r,l,h,g,C,M,F,V,oe){const ft=function _(n,r,l,h,g,C){const M=u(n,r,l,h);return u(n,r+2,g,C)||M}(n,aa(),l,g,M,V);return rs(4),ft?r+we(l)+h+we(g)+C+we(M)+F+we(V)+oe:_o}function as(n,r,l,h,g,C,M,F){const V=Hn(),oe=Mo(),Pe=n+eo,ft=oe.firstCreatePass?function Gr(n,r,l,h,g,C,M,F,V){const oe=r.consts,Pe=td(r,n,4,M||null,Do(oe,F));od(r,l,Pe,Do(oe,V)),Fe(r,Pe);const ft=Pe.tView=hp(2,Pe,h,g,C,r.directiveRegistry,r.pipeRegistry,null,r.schemas,oe,null);return null!==r.queries&&(r.queries.template(r,Pe),ft.queries=r.queries.embeddedTView(Pe)),Pe}(Pe,oe,V,r,l,h,g,C,M):oe.data[Pe];ks(ft,!1);const Ht=ns(oe,V,ft,n);A()&&Pd(oe,V,Ht,ft),Us(Ht,V),ah(V,V[Pe]=Cg(Ht,V,Ht,ft)),Ts(ft)&&cu(oe,V,ft),null!=M&&Al(V,ft,F)}let ns=function $s(n,r,l,h){return U(!0),r[Si].createComment("")};function cd(n){return yo(function Vc(){return ki.lFrame.contextLView}(),eo+n)}function du(n,r,l){const h=Hn();return a(h,Xa(),r)&&Xs(Mo(),_r(),h,n,r,h[Si],l,!1),du}function Mp(n,r,l,h,g){const M=g?"class":"style";Qf(n,l,r.inputs[M],M,h)}function hh(n,r,l,h){const g=Hn(),C=Mo(),M=eo+n,F=g[Si],V=C.firstCreatePass?function jg(n,r,l,h,g,C){const M=r.consts,V=td(r,n,2,h,Do(M,g));return od(r,l,V,Do(M,C)),null!==V.attrs&&ul(V,V.attrs,!1),null!==V.mergedAttrs&&ul(V,V.mergedAttrs,!0),null!==r.queries&&r.queries.elementStart(r,V),V}(M,C,g,r,l,h):C.data[M],oe=Ip(C,g,V,F,r,n);g[M]=oe;const Pe=Ts(V);return ks(V,!0),hf(F,oe,V),32!=(32&V.flags)&&A()&&Pd(C,g,oe,V),0===function ci(){return ki.lFrame.elementDepthCount}()&&Us(oe,g),function sa(){ki.lFrame.elementDepthCount++}(),Pe&&(cu(C,g,V),Hf(C,V,g)),null!==h&&Al(g,V),hh}function ph(){let n=jr();Fs()?jl():(n=n.parent,ks(n,!1));const r=n;(function qo(n){return ki.skipHydrationRootTNode===n})(r)&&function dc(){ki.skipHydrationRootTNode=null}(),function gu(){ki.lFrame.elementDepthCount--}();const l=Mo();return l.firstCreatePass&&(Fe(l,n),Gs(n)&&l.queries.elementEnd(n)),null!=r.classesWithoutHost&&function I(n){return 0!=(8&n.flags)}(r)&&Mp(l,r,Hn(),r.classesWithoutHost,!0),null!=r.stylesWithoutHost&&function O(n){return 0!=(16&n.flags)}(r)&&Mp(l,r,Hn(),r.stylesWithoutHost,!1),ph}function fh(n,r,l,h){return hh(n,r,l,h),ph(),fh}let Ip=(n,r,l,h,g,C)=>(U(!0),Mu(h,g,function L(){return ki.lFrame.currentNamespace}()));function ud(n,r,l){const h=Hn(),g=Mo(),C=n+eo,M=g.firstCreatePass?function hu(n,r,l,h,g){const C=r.consts,M=Do(C,h),F=td(r,n,8,"ng-container",M);return null!==M&&ul(F,M,!0),od(r,l,F,Do(C,g)),null!==r.queries&&r.queries.elementStart(r,F),F}(C,g,h,r,l):g.data[C];ks(M,!0);const F=Ap(g,h,M,n);return h[C]=F,A()&&Pd(g,h,F,M),Us(F,h),Ts(M)&&(cu(g,h,M),Hf(g,M,h)),null!=l&&Al(h,M),ud}function dd(){let n=jr();const r=Mo();return Fs()?jl():(n=n.parent,ks(n,!1)),r.firstCreatePass&&(Fe(r,n),Gs(n)&&r.queries.elementEnd(n)),dd}function Rl(n,r,l){return ud(n,r,l),dd(),Rl}let Ap=(n,r,l,h)=>(U(!0),nu(r[Si],""));function ca(){return Hn()}function pu(n){return!!n&&"function"==typeof n.then}function Sp(n){return!!n&&"function"==typeof n.subscribe}function Pp(n,r,l,h){const g=Hn(),C=Mo(),M=jr();return function Mv(n,r,l,h,g,C,M){const F=Ts(h),oe=n.firstCreatePass&&Eg(n),Pe=r[Oo],ft=Tg(r);let Ht=!0;if(3&h.type||M){const ni=Dn(h,r),vi=M?M(ni):ni,ji=ft.length,Wn=M?Ho=>M(Ce(Ho[h.index])):h.index;let vo=null;if(!M&&F&&(vo=function R1(n,r,l,h){const g=n.cleanup;if(null!=g)for(let C=0;C<g.length-1;C+=2){const M=g[C];if(M===l&&g[C+1]===h){const F=r[Jo],V=g[C+2];return F.length>V?F[V]:null}"string"==typeof M&&(C+=2)}return null}(n,r,g,h.index)),null!==vo)(vo.__ngLastListenerFn__||vo).__ngNextListenerFn__=C,vo.__ngLastListenerFn__=C,Ht=!1;else{C=Av(h,r,Pe,C,!1);const Ho=l.listen(vi,g,C);ft.push(C,Ho),oe&&oe.push(g,Wn,ji,ji+1)}}else C=Av(h,r,Pe,C,!1);const sn=h.outputs;let Un;if(Ht&&null!==sn&&(Un=sn[g])){const ni=Un.length;if(ni)for(let vi=0;vi<ni;vi+=2){const Xo=r[Un[vi]][Un[vi+1]].subscribe(C),Da=ft.length;ft.push(C,Xo),oe&&oe.push(g,h.index,Da,-(Da+1))}}}(C,g,g[Si],M,n,r,h),Pp}function Iv(n,r,l,h){try{return Z(6,r,l),!1!==l(h)}catch(g){return yp(n,g),!1}finally{Z(7,r,l)}}function Av(n,r,l,h,g){return function C(M){if(M===Function)return h;Qd(n.componentOffset>-1?Xi(n.index,r):r);let V=Iv(r,l,h,M),oe=C.__ngNextListenerFn__;for(;oe;)V=Iv(r,l,oe,M)&&V,oe=oe.__ngNextListenerFn__;return g&&!1===V&&M.preventDefault(),V}}function Sv(n=1){return function _a(n){return(ki.lFrame.contextLView=function za(n,r){for(;n>0;)r=r[Xr],n--;return r}(n,ki.lFrame.contextLView))[Oo]}(n)}function L1(n,r){let l=null;const h=function kr(n){const r=n.attrs;if(null!=r){const l=r.indexOf(5);if(!(1&l))return r[l+1]}return null}(n);for(let g=0;g<r.length;g++){const C=r[g];if("*"!==C){if(null===h?Mr(n,C,!0):ye(h,C))return g}else l=g}return l}function Pv(n){const r=Hn()[ko][jo];if(!r.projection){const h=r.projection=vd(n?n.length:1,null),g=h.slice();let C=r.child;for(;null!==C;){const M=n?L1(C,n):0;null!==M&&(g[M]?g[M].projectionNext=C:h[M]=C,g[M]=C),C=C.next}}}function Ov(n,r=0,l){const h=Hn(),g=Mo(),C=td(g,eo+n,16,null,l||null);null===C.projection&&(C.projection=r),jl(),(!h[Ar]||ga())&&32!=(32&C.flags)&&function w_(n,r,l){uf(r[Si],0,r,l,$a(n,l,r),Sh(l.parent||r[jo],l,r))}(g,h,C)}function gy(n,r,l){return _y(n,"",r,"",l),gy}function _y(n,r,l,h,g){const C=Hn(),M=D(C,r,l,h);return M!==_o&&Xs(Mo(),_r(),C,n,M,C[Si],g,!1),_y}function Hg(n,r){return n<<17|r<<2}function hd(n){return n>>17&32767}function yy(n){return 2|n}function mh(n){return(131068&n)>>2}function vy(n,r){return-131069&n|r<<2}function xy(n){return 1|n}function Zv(n,r,l,h,g){const C=n[l+1],M=null===r;let F=h?hd(C):mh(C),V=!1;for(;0!==F&&(!1===V||M);){const Pe=n[F+1];U1(n[F],r)&&(V=!0,n[F+1]=h?xy(Pe):yy(Pe)),F=h?hd(Pe):mh(Pe)}V&&(n[l+1]=h?yy(C):xy(C))}function U1(n,r){return null===n||null==r||(Array.isArray(n)?n[1]:n)===r||!(!Array.isArray(n)||"string"!=typeof r)&&Wl(n,r)>=0}function by(n,r,l){return nc(n,r,l,!1),by}function wy(n,r){return nc(n,r,null,!0),wy}function nc(n,r,l,h){const g=Hn(),C=Mo(),M=rs(2);C.firstUpdatePass&&function Yv(n,r,l,h){const g=n.data;if(null===g[l+1]){const C=g[qr()],M=function qv(n,r){return r>=n.expandoStartIndex}(n,l);(function Qv(n,r){return 0!=(n.flags&(r?8:16))})(C,h)&&null===r&&!M&&(r=!1),r=function Y1(n,r,l,h){const g=function $c(n){const r=ki.lFrame.currentDirectiveIndex;return-1===r?null:n[r]}(n);let C=h?r.residualClasses:r.residualStyles;if(null===g)0===(h?r.classBindings:r.styleBindings)&&(l=cm(l=Cy(null,n,r,l,h),r.attrs,h),C=null);else{const M=r.directiveStylingLast;if(-1===M||n[M]!==g)if(l=Cy(g,n,r,l,h),null===C){let V=function J1(n,r,l){const h=l?r.classBindings:r.styleBindings;if(0!==mh(h))return n[hd(h)]}(n,r,h);void 0!==V&&Array.isArray(V)&&(V=Cy(null,n,r,V[1],h),V=cm(V,r.attrs,h),function K1(n,r,l,h){n[hd(l?r.classBindings:r.styleBindings)]=h}(n,r,h,V))}else C=function X1(n,r,l){let h;const g=r.directiveEnd;for(let C=1+r.directiveStylingLast;C<g;C++)h=cm(h,n[C].hostAttrs,l);return cm(h,r.attrs,l)}(n,r,h)}return void 0!==C&&(h?r.residualClasses=C:r.residualStyles=C),l}(g,C,r,h),function N1(n,r,l,h,g,C){let M=C?r.classBindings:r.styleBindings,F=hd(M),V=mh(M);n[h]=l;let Pe,oe=!1;if(Array.isArray(l)?(Pe=l[1],(null===Pe||Wl(l,Pe)>0)&&(oe=!0)):Pe=l,g)if(0!==V){const Ht=hd(n[F+1]);n[h+1]=Hg(Ht,F),0!==Ht&&(n[Ht+1]=vy(n[Ht+1],h)),n[F+1]=function F1(n,r){return 131071&n|r<<17}(n[F+1],h)}else n[h+1]=Hg(F,0),0!==F&&(n[F+1]=vy(n[F+1],h)),F=h;else n[h+1]=Hg(V,0),0===F?F=h:n[V+1]=vy(n[V+1],h),V=h;oe&&(n[h+1]=yy(n[h+1])),Zv(n,Pe,h,!0),Zv(n,Pe,h,!1),function z1(n,r,l,h,g){const C=g?n.residualClasses:n.residualStyles;null!=C&&"string"==typeof r&&Wl(C,r)>=0&&(l[h+1]=xy(l[h+1]))}(r,Pe,n,h,C),M=Hg(F,V),C?r.classBindings=M:r.styleBindings=M}(g,C,r,l,M,h)}}(C,n,M,h),r!==_o&&a(g,M,r)&&function Kv(n,r,l,h,g,C,M,F){if(!(3&r.type))return;const V=n.data,oe=V[F+1],Pe=function B1(n){return 1==(1&n)}(oe)?Xv(V,r,l,g,mh(oe),M):void 0;Gg(Pe)||(Gg(C)||function k1(n){return 2==(2&n)}(oe)&&(C=Xv(V,null,l,g,F,M)),function df(n,r,l,h,g){if(r)g?n.addClass(l,h):n.removeClass(l,h);else{let C=-1===h.indexOf("-")?void 0:sl.DashCase;null==g?n.removeStyle(l,h,C):("string"==typeof g&&g.endsWith("!important")&&(g=g.slice(0,-10),C|=sl.Important),n.setStyle(l,h,g,C))}}(h,M,yn(qr(),l),g,C))}(C,C.data[qr()],g,g[Si],n,g[M+1]=function nb(n,r){return null==n||""===n||("string"==typeof r?n+=r:"object"==typeof n&&(n=Re(vc(n)))),n}(r,l),h,M)}function Cy(n,r,l,h,g){let C=null;const M=l.directiveEnd;let F=l.directiveStylingLast;for(-1===F?F=l.directiveStart:F++;F<M&&(C=r[F],h=cm(h,C.hostAttrs,g),C!==n);)F++;return null!==n&&(l.directiveStylingLast=F),h}function cm(n,r,l){const h=l?1:2;let g=-1;if(null!==r)for(let C=0;C<r.length;C++){const M=r[C];"number"==typeof M?g=M:g===h&&(Array.isArray(n)||(n=void 0===n?[]:["",n]),Js(n,M,!!l||r[++C]))}return void 0===n?null:n}function Xv(n,r,l,h,g,C){const M=null===r;let F;for(;g>0;){const V=n[g],oe=Array.isArray(V),Pe=oe?V[1]:V,ft=null===Pe;let Ht=l[g+1];Ht===_o&&(Ht=ft?Et:void 0);let sn=ft?el(Ht,h):Pe===h?Ht:void 0;if(oe&&!Gg(sn)&&(sn=el(V,h)),Gg(sn)&&(F=sn,M))return F;const Un=n[g+1];g=M?hd(Un):mh(Un)}if(null!==r){let V=C?r.residualClasses:r.residualStyles;null!=V&&(F=el(V,h))}return F}function Gg(n){return void 0!==n}function e0(n,r=""){const l=Hn(),h=Mo(),g=n+eo,C=h.firstCreatePass?td(h,g,1,r,null):h.data[g],M=t0(h,l,C,r,n);l[g]=M,A()&&Pd(h,l,M,C),ks(C,!1)}let t0=(n,r,l,h,g)=>(U(!0),function tu(n,r){return n.createText(r)}(r[Si],h));function Ty(n){return Wg("",n,""),Ty}function Wg(n,r,l){const h=Hn(),g=D(h,n,r,l);return g!==_o&&La(h,qr(),g),Wg}function Ey(n,r,l,h,g){const C=Hn(),M=function k(n,r,l,h,g,C){const F=u(n,aa(),l,g);return rs(2),F?r+we(l)+h+we(g)+C:_o}(C,n,r,l,h,g);return M!==_o&&La(C,qr(),M),Ey}function Dy(n,r,l,h,g,C,M){const F=Hn(),V=z(F,n,r,l,h,g,C,M);return V!==_o&&La(F,qr(),V),Dy}function My(n,r,l,h,g,C,M,F,V){const oe=Hn(),Pe=j(oe,n,r,l,h,g,C,M,F,V);return Pe!==_o&&La(oe,qr(),Pe),My}const gh=void 0;var Tb=["en",[["a","p"],["AM","PM"],gh],[["AM","PM"],gh,gh],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],gh,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],gh,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",gh,"{1} 'at' {0}",gh],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function Cb(n){const l=Math.floor(Math.abs(n)),h=n.toString().replace(/^[^.]*\.?/,"").length;return 1===l&&0===h?1:5}];let Rp={};function Iy(n){const r=function Eb(n){return n.toLowerCase().replace(/_/g,"-")}(n);let l=x0(r);if(l)return l;const h=r.split("-")[0];if(l=x0(h),l)return l;if("en"===h)return Tb;throw new ae(701,!1)}function v0(n){return Iy(n)[so.PluralCase]}function x0(n){return n in Rp||(Rp[n]=ri.ng&&ri.ng.common&&ri.ng.common.locales&&ri.ng.common.locales[n]),Rp[n]}var so=(()=>((so=so||{})[so.LocaleId=0]="LocaleId",so[so.DayPeriodsFormat=1]="DayPeriodsFormat",so[so.DayPeriodsStandalone=2]="DayPeriodsStandalone",so[so.DaysFormat=3]="DaysFormat",so[so.DaysStandalone=4]="DaysStandalone",so[so.MonthsFormat=5]="MonthsFormat",so[so.MonthsStandalone=6]="MonthsStandalone",so[so.Eras=7]="Eras",so[so.FirstDayOfWeek=8]="FirstDayOfWeek",so[so.WeekendRange=9]="WeekendRange",so[so.DateFormat=10]="DateFormat",so[so.TimeFormat=11]="TimeFormat",so[so.DateTimeFormat=12]="DateTimeFormat",so[so.NumberSymbols=13]="NumberSymbols",so[so.NumberFormats=14]="NumberFormats",so[so.CurrencyCode=15]="CurrencyCode",so[so.CurrencySymbol=16]="CurrencySymbol",so[so.CurrencyName=17]="CurrencyName",so[so.Currencies=18]="Currencies",so[so.Directionality=19]="Directionality",so[so.PluralCase=20]="PluralCase",so[so.ExtraData=21]="ExtraData",so))();const Lp="en-US";let b0=Lp;function Py(n,r,l,h,g){if(n=Je(n),Array.isArray(n))for(let C=0;C<n.length;C++)Py(n[C],r,l,h,g);else{const C=Mo(),M=Hn();let F=ll(n)?n:Je(n.provide),V=ng(n);const oe=jr(),Pe=1048575&oe.providerIndexes,ft=oe.directiveStart,Ht=oe.providerIndexes>>20;if(ll(n)||!n.multi){const sn=new o(V,g,Xu),Un=Ry(F,r,g?Pe:Pe+Ht,ft);-1===Un?(ln(kt(oe,M),C,F),Oy(C,n,r.length),r.push(F),oe.directiveStart++,oe.directiveEnd++,g&&(oe.providerIndexes+=1048576),l.push(sn),M.push(sn)):(l[Un]=sn,M[Un]=sn)}else{const sn=Ry(F,r,Pe+Ht,ft),Un=Ry(F,r,Pe,Pe+Ht),vi=Un>=0&&l[Un];if(g&&!vi||!g&&!(sn>=0&&l[sn])){ln(kt(oe,M),C,F);const ji=function ww(n,r,l,h,g){const C=new o(n,l,Xu);return C.multi=[],C.index=r,C.componentProviders=0,G0(C,g,h&&!l),C}(g?bw:xw,l.length,g,h,V);!g&&vi&&(l[Un].providerFactory=ji),Oy(C,n,r.length,0),r.push(F),oe.directiveStart++,oe.directiveEnd++,g&&(oe.providerIndexes+=1048576),l.push(ji),M.push(ji)}else Oy(C,n,sn>-1?sn:Un,G0(l[g?Un:sn],V,!g&&h));!g&&h&&vi&&l[Un].componentProviders++}}}function Oy(n,r,l,h){const g=ll(r),C=function Hd(n){return!!n.useClass}(r);if(g||C){const V=(C?Je(r.useClass):r).prototype.ngOnDestroy;if(V){const oe=n.destroyHooks||(n.destroyHooks=[]);if(!g&&r.multi){const Pe=oe.indexOf(l);-1===Pe?oe.push(l,[h,V]):oe[Pe+1].push(h,V)}else oe.push(l,V)}}}function G0(n,r,l){return l&&n.componentProviders++,n.multi.push(r)-1}function Ry(n,r,l,h){for(let g=l;g<h;g++)if(r[g]===n)return g;return-1}function xw(n,r,l,h){return Ly(this.multi,[])}function bw(n,r,l,h){const g=this.multi;let C;if(this.providerFactory){const M=this.providerFactory.componentProviders,F=Vn(l,l[pi],this.providerFactory.index,h);C=F.slice(0,M),Ly(g,C);for(let V=M;V<F.length;V++)C.push(F[V])}else C=[],Ly(g,C);return C}function Ly(n,r){for(let l=0;l<n.length;l++)r.push((0,n[l])());return r}function W0(n,r=[]){return l=>{l.providersResolver=(h,g)=>function vw(n,r,l){const h=Mo();if(h.firstCreatePass){const g=pr(n);Py(l,h.data,h.blueprint,g,!0),Py(r,h.data,h.blueprint,g,!1)}}(h,g?g(n):n,r)}}class kp{}class q0{}function Cw(n,r){return new ky(n,r??null,[])}class ky extends kp{constructor(r,l,h){super(),this._parent=l,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new nm(this);const g=Wo(r);this._bootstrapComponents=Ml(g.bootstrap),this._r3Injector=_g(r,l,[{provide:kp,useValue:this},{provide:np,useValue:this.componentFactoryResolver},...h],Re(r),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(r)}get injector(){return this._r3Injector}destroy(){const r=this._r3Injector;!r.destroyed&&r.destroy(),this.destroyCbs.forEach(l=>l()),this.destroyCbs=null}onDestroy(r){this.destroyCbs.push(r)}}class Fy extends q0{constructor(r){super(),this.moduleType=r}create(r){return new ky(this.moduleType,r,[])}}class Y0 extends kp{constructor(r){super(),this.componentFactoryResolver=new nm(this),this.instance=null;const l=new jh([...r.providers,{provide:kp,useValue:this},{provide:np,useValue:this.componentFactoryResolver}],r.parent||Gd(),r.debugName,new Set(["environment"]));this.injector=l,r.runEnvironmentInitializers&&l.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(r){this.injector.onDestroy(r)}}function J0(n,r,l=null){return new Y0({providers:n,parent:r,debugName:l,runEnvironmentInitializers:!0}).injector}let Ew=(()=>{class n{constructor(l){this._injector=l,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(l){if(!l.standalone)return null;if(!this.cachedInjectors.has(l.id)){const h=Ef(0,l.type),g=h.length>0?J0([h],this._injector,`Standalone[${l.type.name}]`):null;this.cachedInjectors.set(l.id,g)}return this.cachedInjectors.get(l.id)}ngOnDestroy(){try{for(const l of this.cachedInjectors.values())null!==l&&l.destroy()}finally{this.cachedInjectors.clear()}}}return n.\u0275prov=Sn({token:n,providedIn:"environment",factory:()=>new n(Y(Cc))}),n})();function K0(n){n.getStandaloneInjector=r=>r.get(Ew).getOrCreateStandaloneInjector(n)}function ox(n,r,l){const h=Wr()+n,g=Hn();return g[h]===_o?e(g,h,l?r.call(l):r()):function i(n,r){return n[r]}(g,h)}function mm(n,r){const l=n[r];return l===_o?void 0:l}function ux(n,r){const l=Mo();let h;const g=n+eo;l.firstCreatePass?(h=function jw(n,r){if(r)for(let l=r.length-1;l>=0;l--){const h=r[l];if(n===h.name)return h}}(r,l.pipeRegistry),l.data[g]=h,h.onDestroy&&(l.destroyHooks??=[]).push(g,h.onDestroy)):h=l.data[g];const C=h.factory||(h.factory=ua(h.type)),M=Gt(Xu);try{const F=Ye(!1),V=C();return Ye(F),function ld(n,r,l,h){l>=n.data.length&&(n.data[l]=null,n.blueprint[l]=null),r[l]=h}(l,Hn(),g,V),V}finally{Gt(M)}}function dx(n,r,l){const h=n+eo,g=Hn(),C=yo(g,h);return gm(g,h)?function rx(n,r,l,h,g,C){const M=r+l;return a(n,M,g)?e(n,M+1,C?h.call(C,g):h(g)):mm(n,M+1)}(g,Wr(),r,C.transform,l,C):C.transform(l)}function hx(n,r,l,h){const g=n+eo,C=Hn(),M=yo(C,g);return gm(C,g)?function sx(n,r,l,h,g,C,M){const F=r+l;return u(n,F,g,C)?e(n,F+2,M?h.call(M,g,C):h(g,C)):mm(n,F+2)}(C,Wr(),r,M.transform,l,h,M):M.transform(l,h)}function gm(n,r){return n[pi].data[r].pure}function Ny(n){return r=>{setTimeout(n,void 0,r)}}const Lc=class Ww extends x.x{constructor(r=!1){super(),this.__isAsync=r}emit(r){super.next(r)}subscribe(r,l,h){let g=r,C=l||(()=>null),M=h;if(r&&"object"==typeof r){const V=r;g=V.next?.bind(V),C=V.error?.bind(V),M=V.complete?.bind(V)}this.__isAsync&&(C=Ny(C),g&&(g=Ny(g)),M&&(M=Ny(M)));const F=super.subscribe({next:g,error:C,complete:M});return r instanceof d.w0&&r.add(F),F}};function qw(){return this._results[Symbol.iterator]()}class zy{get changes(){return this._changes||(this._changes=new Lc)}constructor(r=!1){this._emitDistinctChangesOnly=r,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const l=zy.prototype;l[Symbol.iterator]||(l[Symbol.iterator]=qw)}get(r){return this._results[r]}map(r){return this._results.map(r)}filter(r){return this._results.filter(r)}find(r){return this._results.find(r)}reduce(r,l){return this._results.reduce(r,l)}forEach(r){this._results.forEach(r)}some(r){return this._results.some(r)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(r,l){const h=this;h.dirty=!1;const g=function Ms(n){return n.flat(Number.POSITIVE_INFINITY)}(r);(this._changesDetected=!function wu(n,r,l){if(n.length!==r.length)return!1;for(let h=0;h<n.length;h++){let g=n[h],C=r[h];if(l&&(g=l(g),C=l(C)),C!==g)return!1}return!0}(h._results,g,l))&&(h._results=g,h.length=g.length,h.last=g[this.length-1],h.first=g[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}let _m=(()=>{class n{}return n.__NG_ELEMENT_ID__=Kw,n})();const Yw=_m,Jw=class extends Yw{constructor(r,l,h){super(),this._declarationLView=r,this._declarationTContainer=l,this.elementRef=h}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(r,l){return this.createEmbeddedViewImpl(r,l,null)}createEmbeddedViewImpl(r,l,h){const M=this._declarationTContainer.tView,F=ed(this._declarationLView,M,r,4096&this._declarationLView[Ri]?4096:16,null,M.declTNode,null,null,null,l||null,h||null);F[Ir]=this._declarationLView[this._declarationTContainer.index];const oe=this._declarationLView[Br];return null!==oe&&(F[Br]=oe.createEmbeddedView(M)),vp(M,F,r),new sd(F)}};function Kw(){return Xg(jr(),Hn())}function Xg(n,r){return 4&n.type?new Jw(r,n,Hu(n,r)):null}let Qg=(()=>{class n{}return n.__NG_ELEMENT_ID__=oC,n})();function oC(){return yx(jr(),Hn())}const rC=Qg,gx=class extends rC{constructor(r,l,h){super(),this._lContainer=r,this._hostTNode=l,this._hostLView=h}get element(){return Hu(this._hostTNode,this._hostLView)}get injector(){return new Vi(this._hostTNode,this._hostLView)}get parentInjector(){const r=$t(this._hostTNode,this._hostLView);if($(r)){const l=je(r,this._hostLView),h=ce(r);return new Vi(l[pi].data[h+8],l)}return new Vi(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(r){const l=_x(this._lContainer);return null!==l&&l[r]||null}get length(){return this._lContainer.length-wr}createEmbeddedView(r,l,h){let g,C;"number"==typeof h?g=h:null!=h&&(g=h.index,C=h.injector);const F=r.createEmbeddedViewImpl(l||{},C,null);return this.insertImpl(F,g,false),F}createComponent(r,l,h,g,C){const M=r&&!function Sa(n){return"function"==typeof n}(r);let F;if(M)F=l;else{const ni=l||{};F=ni.index,h=ni.injector,g=ni.projectableNodes,C=ni.environmentInjector||ni.ngModuleRef}const V=M?r:new ch(Qi(r)),oe=h||this.parentInjector;if(!C&&null==V.ngModule){const vi=(M?oe:this.parentInjector).get(Cc,null);vi&&(C=vi)}Qi(V.componentType??{});const sn=V.create(oe,g,null,C);return this.insertImpl(sn.hostView,F,false),sn}insert(r,l){return this.insertImpl(r,l,!1)}insertImpl(r,l,h){const g=r._lView,C=g[pi];if(function Ro(n){return Nr(n[Li])}(g)){const V=this.indexOf(r);if(-1!==V)this.detach(V);else{const oe=g[Li],Pe=new gx(oe,oe[jo],oe[Li]);Pe.detach(Pe.indexOf(r))}}const M=this._adjustIndex(l),F=this._lContainer;if(function Rm(n,r,l,h){const g=wr+h,C=l.length;h>0&&(l[g-1][er]=r),h<C-wr?(r[er]=l[g],zp(l,wr+h,r)):(l.push(r),r[er]=null),r[Li]=l;const M=r[Ir];null!==M&&l!==M&&function b_(n,r){const l=n[ia];r[ko]!==r[Li][Li][ko]&&(n[Ss]=!0),null===l?n[ia]=[r]:l.push(r)}(M,r);const F=r[Br];null!==F&&F.insertView(n),r[Ri]|=128}(C,g,F,M),!h){const V=Yl(M,F),oe=g[Si],Pe=Sd(oe,F[Sr]);null!==Pe&&function Iu(n,r,l,h,g,C){h[wo]=g,h[jo]=r,Su(n,h,l,1,g,C)}(C,F[jo],oe,g,Pe,V)}return r.attachToViewContainerRef(),zp(Zy(F),M,r),r}move(r,l){return this.insert(r,l)}indexOf(r){const l=_x(this._lContainer);return null!==l?l.indexOf(r):-1}remove(r){const l=this._adjustIndex(r,-1),h=iu(this._lContainer,l);h&&(yd(Zy(this._lContainer),l),sf(h[pi],h))}detach(r){const l=this._adjustIndex(r,-1),h=iu(this._lContainer,l);return h&&null!=yd(Zy(this._lContainer),l)?new sd(h):null}_adjustIndex(r,l=0){return r??this.length+l}};function _x(n){return n[8]}function Zy(n){return n[8]||(n[8]=[])}function yx(n,r){let l;const h=r[n.index];return Nr(h)?l=h:(l=Cg(h,r,null,n),r[n.index]=l,ah(r,l)),vx(l,r,n,h),new gx(l,n,r)}let vx=function xx(n,r,l,h){if(n[Sr])return;let g;g=8&l.type?Ce(h):function sC(n,r){const l=n[Si],h=l.createComment(""),g=Dn(r,n);return Zs(l,Sd(l,g),h,function Au(n,r){return n.nextSibling(r)}(l,g),!1),h}(r,l),n[Sr]=g};class Vy{constructor(r){this.queryList=r,this.matches=null}clone(){return new Vy(this.queryList)}setDirty(){this.queryList.setDirty()}}class jy{constructor(r=[]){this.queries=r}createEmbeddedView(r){const l=r.queries;if(null!==l){const h=null!==r.contentQueries?r.contentQueries[0]:l.length,g=[];for(let C=0;C<h;C++){const M=l.getByIndex(C);g.push(this.queries[M.indexInDeclarationView].clone())}return new jy(g)}return null}insertView(r){this.dirtyQueriesWithMatches(r)}detachView(r){this.dirtyQueriesWithMatches(r)}dirtyQueriesWithMatches(r){for(let l=0;l<this.queries.length;l++)null!==Ax(r,l).matches&&this.queries[l].setDirty()}}class bx{constructor(r,l,h=null){this.predicate=r,this.flags=l,this.read=h}}class $y{constructor(r=[]){this.queries=r}elementStart(r,l){for(let h=0;h<this.queries.length;h++)this.queries[h].elementStart(r,l)}elementEnd(r){for(let l=0;l<this.queries.length;l++)this.queries[l].elementEnd(r)}embeddedTView(r){let l=null;for(let h=0;h<this.length;h++){const g=null!==l?l.length:0,C=this.getByIndex(h).embeddedTView(r,g);C&&(C.indexInDeclarationView=h,null!==l?l.push(C):l=[C])}return null!==l?new $y(l):null}template(r,l){for(let h=0;h<this.queries.length;h++)this.queries[h].template(r,l)}getByIndex(r){return this.queries[r]}get length(){return this.queries.length}track(r){this.queries.push(r)}}class Hy{constructor(r,l=-1){this.metadata=r,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=l}elementStart(r,l){this.isApplyingToNode(l)&&this.matchTNode(r,l)}elementEnd(r){this._declarationNodeIndex===r.index&&(this._appliesToNextNode=!1)}template(r,l){this.elementStart(r,l)}embeddedTView(r,l){return this.isApplyingToNode(r)?(this.crossesNgTemplate=!0,this.addMatch(-r.index,l),new Hy(this.metadata)):null}isApplyingToNode(r){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const l=this._declarationNodeIndex;let h=r.parent;for(;null!==h&&8&h.type&&h.index!==l;)h=h.parent;return l===(null!==h?h.index:-1)}return this._appliesToNextNode}matchTNode(r,l){const h=this.metadata.predicate;if(Array.isArray(h))for(let g=0;g<h.length;g++){const C=h[g];this.matchTNodeWithReadOption(r,l,cC(l,C)),this.matchTNodeWithReadOption(r,l,Mn(l,r,C,!1,!1))}else h===_m?4&l.type&&this.matchTNodeWithReadOption(r,l,-1):this.matchTNodeWithReadOption(r,l,Mn(l,r,h,!1,!1))}matchTNodeWithReadOption(r,l,h){if(null!==h){const g=this.metadata.read;if(null!==g)if(g===Kd||g===Qg||g===_m&&4&l.type)this.addMatch(l.index,-2);else{const C=Mn(l,r,g,!1,!1);null!==C&&this.addMatch(l.index,C)}else this.addMatch(l.index,h)}}addMatch(r,l){null===this.matches?this.matches=[r,l]:this.matches.push(r,l)}}function cC(n,r){const l=n.localNames;if(null!==l)for(let h=0;h<l.length;h+=2)if(l[h]===r)return l[h+1];return null}function dC(n,r,l,h){return-1===l?function uC(n,r){return 11&n.type?Hu(n,r):4&n.type?Xg(n,r):null}(r,n):-2===l?function hC(n,r,l){return l===Kd?Hu(r,n):l===_m?Xg(r,n):l===Qg?yx(r,n):void 0}(n,r,h):Vn(n,n[pi],l,r)}function wx(n,r,l,h){const g=r[Br].queries[h];if(null===g.matches){const C=n.data,M=l.matches,F=[];for(let V=0;V<M.length;V+=2){const oe=M[V];F.push(oe<0?null:dC(r,C[oe],M[V+1],l.metadata.read))}g.matches=F}return g.matches}function Gy(n,r,l,h){const g=n.queries.getByIndex(l),C=g.matches;if(null!==C){const M=wx(n,r,g,l);for(let F=0;F<C.length;F+=2){const V=C[F];if(V>0)h.push(M[F/2]);else{const oe=C[F+1],Pe=r[-V];for(let ft=wr;ft<Pe.length;ft++){const Ht=Pe[ft];Ht[Ir]===Ht[Li]&&Gy(Ht[pi],Ht,oe,h)}if(null!==Pe[ia]){const ft=Pe[ia];for(let Ht=0;Ht<ft.length;Ht++){const sn=ft[Ht];Gy(sn[pi],sn,oe,h)}}}}}return h}function Cx(n){const r=Hn(),l=Mo(),h=Hc();es(h+1);const g=Ax(l,h);if(n.dirty&&function co(n){return 4==(4&n[Ri])}(r)===(2==(2&g.metadata.flags))){if(null===g.matches)n.reset([]);else{const C=g.crossesNgTemplate?Gy(l,r,h,[]):wx(l,r,g,h);n.reset(C,W_),n.notifyOnChanges()}return!0}return!1}function Tx(n,r,l){const h=Mo();h.firstCreatePass&&(Ix(h,new bx(n,r,l),-1),2==(2&r)&&(h.staticViewQueries=!0)),Mx(h,Hn(),r)}function Ex(n,r,l,h){const g=Mo();if(g.firstCreatePass){const C=jr();Ix(g,new bx(r,l,h),C.index),function fC(n,r){const l=n.contentQueries||(n.contentQueries=[]);r!==(l.length?l[l.length-1]:-1)&&l.push(n.queries.length-1,r)}(g,n),2==(2&l)&&(g.staticContentQueries=!0)}Mx(g,Hn(),l)}function Dx(){return function pC(n,r){return n[Br].queries[r].queryList}(Hn(),Hc())}function Mx(n,r,l){const h=new zy(4==(4&l));(function Dc(n,r,l,h){const g=Tg(r);g.push(l),n.firstCreatePass&&Eg(n).push(h,g.length-1)})(n,r,h,h.destroy),null===r[Br]&&(r[Br]=new jy),r[Br].queries.push(new Vy(h))}function Ix(n,r,l){null===n.queries&&(n.queries=new $y),n.queries.track(new Hy(r,l))}function Ax(n,r){return n.queries.getByIndex(r)}function Wy(n){return!!Wo(n)}const Gx=new lr("Application Initializer");let Xy=(()=>{class n{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((l,h)=>{this.resolve=l,this.reject=h}),this.appInits=Ge(Gx,{optional:!0})??[]}runInitializers(){if(this.initialized)return;const l=[];for(const g of this.appInits){const C=g();if(pu(C))l.push(C);else if(Sp(C)){const M=new Promise((F,V)=>{C.subscribe({complete:F,error:V})});l.push(M)}}const h=()=>{this.done=!0,this.resolve()};Promise.all(l).then(()=>{h()}).catch(g=>{this.reject(g)}),0===l.length&&h(),this.initialized=!0}}return n.\u0275fac=function(l){return new(l||n)},n.\u0275prov=Sn({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),Wx=(()=>{class n{log(l){console.log(l)}warn(l){console.warn(l)}}return n.\u0275fac=function(l){return new(l||n)},n.\u0275prov=Sn({token:n,factory:n.\u0275fac,providedIn:"platform"}),n})();const t_=new lr("LocaleId",{providedIn:"root",factory:()=>Ge(t_,Mt.Optional|Mt.SkipSelf)||function FC(){return typeof $localize<"u"&&$localize.locale||Lp}()}),BC=new lr("DefaultCurrencyCode",{providedIn:"root",factory:()=>"USD"});let qx=(()=>{class n{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new v.X(!1)}add(){this.hasPendingTasks.next(!0);const l=this.taskId++;return this.pendingTasks.add(l),l}remove(l){this.pendingTasks.delete(l),0===this.pendingTasks.size&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this.hasPendingTasks.next(!1)}}return n.\u0275fac=function(l){return new(l||n)},n.\u0275prov=Sn({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class NC{constructor(r,l){this.ngModuleFactory=r,this.componentFactories=l}}let zC=(()=>{class n{compileModuleSync(l){return new Fy(l)}compileModuleAsync(l){return Promise.resolve(this.compileModuleSync(l))}compileModuleAndAllComponentsSync(l){const h=this.compileModuleSync(l),C=Ml(Wo(l).declarations).reduce((M,F)=>{const V=Qi(F);return V&&M.push(new ch(V)),M},[]);return new NC(h,C)}compileModuleAndAllComponentsAsync(l){return Promise.resolve(this.compileModuleAndAllComponentsSync(l))}clearCache(){}clearCacheFor(l){}getModuleId(l){}}return n.\u0275fac=function(l){return new(l||n)},n.\u0275prov=Sn({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function Kx(...n){}class Fa{constructor({enableLongStackTrace:r=!1,shouldCoalesceEventChangeDetection:l=!1,shouldCoalesceRunChangeDetection:h=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Lc(!1),this.onMicrotaskEmpty=new Lc(!1),this.onStable=new Lc(!1),this.onError=new Lc(!1),typeof Zone>"u")throw new ae(908,!1);Zone.assertZonePatched();const g=this;g._nesting=0,g._outer=g._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(g._inner=g._inner.fork(new Zone.TaskTrackingZoneSpec)),r&&Zone.longStackTraceZoneSpec&&(g._inner=g._inner.fork(Zone.longStackTraceZoneSpec)),g.shouldCoalesceEventChangeDetection=!h&&l,g.shouldCoalesceRunChangeDetection=h,g.lastRequestAnimationFrameId=-1,g.nativeRequestAnimationFrame=function VC(){let n=ri.requestAnimationFrame,r=ri.cancelAnimationFrame;if(typeof Zone<"u"&&n&&r){const l=n[Zone.__symbol__("OriginalDelegate")];l&&(n=l);const h=r[Zone.__symbol__("OriginalDelegate")];h&&(r=h)}return{nativeRequestAnimationFrame:n,nativeCancelAnimationFrame:r}}().nativeRequestAnimationFrame,function HC(n){const r=()=>{!function $C(n){n.isCheckStableRunning||-1!==n.lastRequestAnimationFrameId||(n.lastRequestAnimationFrameId=n.nativeRequestAnimationFrame.call(ri,()=>{n.fakeTopEventTask||(n.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{n.lastRequestAnimationFrameId=-1,ev(n),n.isCheckStableRunning=!0,Qy(n),n.isCheckStableRunning=!1},void 0,()=>{},()=>{})),n.fakeTopEventTask.invoke()}),ev(n))}(n)};n._inner=n._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(l,h,g,C,M,F)=>{try{return Xx(n),l.invokeTask(g,C,M,F)}finally{(n.shouldCoalesceEventChangeDetection&&"eventTask"===C.type||n.shouldCoalesceRunChangeDetection)&&r(),Qx(n)}},onInvoke:(l,h,g,C,M,F,V)=>{try{return Xx(n),l.invoke(g,C,M,F,V)}finally{n.shouldCoalesceRunChangeDetection&&r(),Qx(n)}},onHasTask:(l,h,g,C)=>{l.hasTask(g,C),h===g&&("microTask"==C.change?(n._hasPendingMicrotasks=C.microTask,ev(n),Qy(n)):"macroTask"==C.change&&(n.hasPendingMacrotasks=C.macroTask))},onHandleError:(l,h,g,C)=>(l.handleError(g,C),n.runOutsideAngular(()=>n.onError.emit(C)),!1)})}(g)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!Fa.isInAngularZone())throw new ae(909,!1)}static assertNotInAngularZone(){if(Fa.isInAngularZone())throw new ae(909,!1)}run(r,l,h){return this._inner.run(r,l,h)}runTask(r,l,h,g){const C=this._inner,M=C.scheduleEventTask("NgZoneEvent: "+g,r,jC,Kx,Kx);try{return C.runTask(M,l,h)}finally{C.cancelTask(M)}}runGuarded(r,l,h){return this._inner.runGuarded(r,l,h)}runOutsideAngular(r){return this._outer.run(r)}}const jC={};function Qy(n){if(0==n._nesting&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function ev(n){n.hasPendingMicrotasks=!!(n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&-1!==n.lastRequestAnimationFrameId)}function Xx(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function Qx(n){n._nesting--,Qy(n)}class GC{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Lc,this.onMicrotaskEmpty=new Lc,this.onStable=new Lc,this.onError=new Lc}run(r,l,h){return r.apply(l,h)}runGuarded(r,l,h){return r.apply(l,h)}runOutsideAngular(r){return r()}runTask(r,l,h,g){return r.apply(l,h)}}const e1=new lr("",{providedIn:"root",factory:t1});function t1(){const n=Ge(Fa);let r=!0;return function Se(...n){const r=(0,y.yG)(n),l=(0,y._6)(n,1/0),h=n;return h.length?1===h.length?(0,ie.Xf)(h[0]):(0,Q.J)(l)((0,fe.D)(h,r)):q.E}(new s.y(g=>{r=n.isStable&&!n.hasPendingMacrotasks&&!n.hasPendingMicrotasks,n.runOutsideAngular(()=>{g.next(r),g.complete()})}),new s.y(g=>{let C;n.runOutsideAngular(()=>{C=n.onStable.subscribe(()=>{Fa.assertNotInAngularZone(),queueMicrotask(()=>{!r&&!n.hasPendingMacrotasks&&!n.hasPendingMicrotasks&&(r=!0,g.next(!0))})})});const M=n.onUnstable.subscribe(()=>{Fa.assertInAngularZone(),r&&(r=!1,n.runOutsideAngular(()=>{g.next(!1)}))});return()=>{C.unsubscribe(),M.unsubscribe()}}).pipe((0,X.B)()))}const n1=new lr(""),i1=new lr("");let tv,WC=(()=>{class n{constructor(l,h,g){this._ngZone=l,this.registry=h,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,tv||(function qC(n){tv=n}(g),g.addToWindow(h)),this._watchAngularEvents(),l.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{Fa.assertNotInAngularZone(),queueMicrotask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())queueMicrotask(()=>{for(;0!==this._callbacks.length;){let l=this._callbacks.pop();clearTimeout(l.timeoutId),l.doneCb(this._didWork)}this._didWork=!1});else{let l=this.getPendingTasks();this._callbacks=this._callbacks.filter(h=>!h.updateCb||!h.updateCb(l)||(clearTimeout(h.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(l=>({source:l.source,creationLocation:l.creationLocation,data:l.data})):[]}addCallback(l,h,g){let C=-1;h&&h>0&&(C=setTimeout(()=>{this._callbacks=this._callbacks.filter(M=>M.timeoutId!==C),l(this._didWork,this.getPendingTasks())},h)),this._callbacks.push({doneCb:l,timeoutId:C,updateCb:g})}whenStable(l,h,g){if(g&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(l,h,g),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(l){this.registry.registerApplication(l,this)}unregisterApplication(l){this.registry.unregisterApplication(l)}findProviders(l,h,g){return[]}}return n.\u0275fac=function(l){return new(l||n)(Y(Fa),Y(o1),Y(i1))},n.\u0275prov=Sn({token:n,factory:n.\u0275fac}),n})(),o1=(()=>{class n{constructor(){this._applications=new Map}registerApplication(l,h){this._applications.set(l,h)}unregisterApplication(l){this._applications.delete(l)}unregisterAllApplications(){this._applications.clear()}getTestability(l){return this._applications.get(l)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(l,h=!0){return tv?.findTestabilityInTree(this,l,h)??null}}return n.\u0275fac=function(l){return new(l||n)},n.\u0275prov=Sn({token:n,factory:n.\u0275fac,providedIn:"platform"}),n})(),pd=null;const r1=new lr("AllowMultipleToken"),nv=new lr("PlatformDestroyListeners"),iv=new lr("appBootstrapListener");class KC{constructor(r,l){this.name=r,this.token=l}}function l1(n,r,l=[]){const h=`Platform: ${r}`,g=new lr(h);return(C=[])=>{let M=ov();if(!M||M.injector.get(r1,!1)){const F=[...l,...C,{provide:g,useValue:!0}];n?n(F):function XC(n){if(pd&&!pd.get(r1,!1))throw new ae(400,!1);(function s1(){!function Bl(n){Nc=n}(()=>{throw new ae(600,!1)})})(),pd=n;const r=n.get(u1);(function a1(n){n.get(Uu,null)?.forEach(l=>l())})(n)}(function c1(n=[],r){return Ec.create({name:r,providers:[{provide:Vh,useValue:"platform"},{provide:nv,useValue:new Set([()=>pd=null])},...n]})}(F,h))}return function eT(n){const r=ov();if(!r)throw new ae(401,!1);return r}()}}function ov(){return pd?.get(u1)??null}let u1=(()=>{class n{constructor(l){this._injector=l,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(l,h){const g=function tT(n="zone.js",r){return"noop"===n?new GC:"zone.js"===n?new Fa(r):n}(h?.ngZone,function d1(n){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:n?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:n?.runCoalescing??!1}}({eventCoalescing:h?.ngZoneEventCoalescing,runCoalescing:h?.ngZoneRunCoalescing}));return g.run(()=>{const C=function Tw(n,r,l){return new ky(n,r,l)}(l.moduleType,this.injector,function g1(n){return[{provide:Fa,useFactory:n},{provide:ku,multi:!0,useFactory:()=>{const r=Ge(iT,{optional:!0});return()=>r.initialize()}},{provide:m1,useFactory:nT},{provide:e1,useFactory:t1}]}(()=>g)),M=C.injector.get(Tc,null);return g.runOutsideAngular(()=>{const F=g.onError.subscribe({next:V=>{M.handleError(V)}});C.onDestroy(()=>{n_(this._modules,C),F.unsubscribe()})}),function h1(n,r,l){try{const h=l();return pu(h)?h.catch(g=>{throw r.runOutsideAngular(()=>n.handleError(g)),g}):h}catch(h){throw r.runOutsideAngular(()=>n.handleError(h)),h}}(M,g,()=>{const F=C.injector.get(Xy);return F.runInitializers(),F.donePromise.then(()=>(function w0(n){Vt(n,"Expected localeId to be defined"),"string"==typeof n&&(b0=n.toLowerCase().replace(/_/g,"-"))}(C.injector.get(t_,Lp)||Lp),this._moduleDoBootstrap(C),C))})})}bootstrapModule(l,h=[]){const g=p1({},h);return function YC(n,r,l){const h=new Fy(l);return Promise.resolve(h)}(0,0,l).then(C=>this.bootstrapModuleFactory(C,g))}_moduleDoBootstrap(l){const h=l.injector.get(Np);if(l._bootstrapComponents.length>0)l._bootstrapComponents.forEach(g=>h.bootstrap(g));else{if(!l.instance.ngDoBootstrap)throw new ae(-403,!1);l.instance.ngDoBootstrap(h)}this._modules.push(l)}onDestroy(l){this._destroyListeners.push(l)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new ae(404,!1);this._modules.slice().forEach(h=>h.destroy()),this._destroyListeners.forEach(h=>h());const l=this._injector.get(nv,null);l&&(l.forEach(h=>h()),l.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}}return n.\u0275fac=function(l){return new(l||n)(Y(Ec))},n.\u0275prov=Sn({token:n,factory:n.\u0275fac,providedIn:"platform"}),n})();function p1(n,r){return Array.isArray(r)?r.reduce(p1,n):{...n,...r}}let Np=(()=>{class n{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=Ge(m1),this.zoneIsStable=Ge(e1),this.componentTypes=[],this.components=[],this.isStable=Ge(qx).hasPendingTasks.pipe((0,se.w)(l=>l?(0,De.of)(!1):this.zoneIsStable),(0,Ee.x)(),(0,X.B)()),this._injector=Ge(Cc)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(l,h){const g=l instanceof Of;if(!this._injector.get(Xy).done)throw!g&&or(l),new ae(405,!1);let M;M=g?l:this._injector.get(np).resolveComponentFactory(l),this.componentTypes.push(M.componentType);const F=function JC(n){return n.isBoundToModule}(M)?void 0:this._injector.get(kp),oe=M.create(Ec.NULL,[],h||M.selector,F),Pe=oe.location.nativeElement,ft=oe.injector.get(n1,null);return ft?.registerApplication(Pe),oe.onDestroy(()=>{this.detachView(oe.hostView),n_(this.components,oe),ft?.unregisterApplication(Pe)}),this._loadComponent(oe),oe}tick(){if(this._runningTick)throw new ae(101,!1);try{this._runningTick=!0;for(let l of this._views)l.detectChanges()}catch(l){this.internalErrorHandler(l)}finally{this._runningTick=!1}}attachView(l){const h=l;this._views.push(h),h.attachToAppRef(this)}detachView(l){const h=l;n_(this._views,h),h.detachFromAppRef()}_loadComponent(l){this.attachView(l.hostView),this.tick(),this.components.push(l);const h=this._injector.get(iv,[]);h.push(...this._bootstrapListeners),h.forEach(g=>g(l))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(l=>l()),this._views.slice().forEach(l=>l.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(l){return this._destroyListeners.push(l),()=>n_(this._destroyListeners,l)}destroy(){if(this._destroyed)throw new ae(406,!1);const l=this._injector;l.destroy&&!l.destroyed&&l.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}}return n.\u0275fac=function(l){return new(l||n)},n.\u0275prov=Sn({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function n_(n,r){const l=n.indexOf(r);l>-1&&n.splice(l,1)}const m1=new lr("",{providedIn:"root",factory:()=>Ge(Tc).handleError.bind(void 0)});function nT(){const n=Ge(Fa),r=Ge(Tc);return l=>n.runOutsideAngular(()=>r.handleError(l))}let iT=(()=>{class n{constructor(){this.zone=Ge(Fa),this.applicationRef=Ge(Np)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}}return n.\u0275fac=function(l){return new(l||n)},n.\u0275prov=Sn({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function rT(){}let sT=(()=>{class n{}return n.__NG_ELEMENT_ID__=aT,n})();function aT(n){return function lT(n,r,l){if(Cs(n)&&!l){const h=Xi(n.index,r);return new sd(h,h)}return 47&n.type?new sd(r[ko],r):null}(jr(),Hn(),16==(16&n))}class x1{constructor(){}supports(r){return uh(r)}create(r){return new fT(r)}}const pT=(n,r)=>r;class fT{constructor(r){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=r||pT}forEachItem(r){let l;for(l=this._itHead;null!==l;l=l._next)r(l)}forEachOperation(r){let l=this._itHead,h=this._removalsHead,g=0,C=null;for(;l||h;){const M=!h||l&&l.currentIndex<w1(h,g,C)?l:h,F=w1(M,g,C),V=M.currentIndex;if(M===h)g--,h=h._nextRemoved;else if(l=l._next,null==M.previousIndex)g++;else{C||(C=[]);const oe=F-g,Pe=V-g;if(oe!=Pe){for(let Ht=0;Ht<oe;Ht++){const sn=Ht<C.length?C[Ht]:C[Ht]=0,Un=sn+Ht;Pe<=Un&&Un<oe&&(C[Ht]=sn+1)}C[M.previousIndex]=Pe-oe}}F!==V&&r(M,F,V)}}forEachPreviousItem(r){let l;for(l=this._previousItHead;null!==l;l=l._nextPrevious)r(l)}forEachAddedItem(r){let l;for(l=this._additionsHead;null!==l;l=l._nextAdded)r(l)}forEachMovedItem(r){let l;for(l=this._movesHead;null!==l;l=l._nextMoved)r(l)}forEachRemovedItem(r){let l;for(l=this._removalsHead;null!==l;l=l._nextRemoved)r(l)}forEachIdentityChange(r){let l;for(l=this._identityChangesHead;null!==l;l=l._nextIdentityChange)r(l)}diff(r){if(null==r&&(r=[]),!uh(r))throw new ae(900,!1);return this.check(r)?this:null}onDestroy(){}check(r){this._reset();let g,C,M,l=this._itHead,h=!1;if(Array.isArray(r)){this.length=r.length;for(let F=0;F<this.length;F++)C=r[F],M=this._trackByFn(F,C),null!==l&&Object.is(l.trackById,M)?(h&&(l=this._verifyReinsertion(l,C,M,F)),Object.is(l.item,C)||this._addIdentityChange(l,C)):(l=this._mismatch(l,C,M,F),h=!0),l=l._next}else g=0,function lm(n,r){if(Array.isArray(n))for(let l=0;l<n.length;l++)r(n[l]);else{const l=n[Symbol.iterator]();let h;for(;!(h=l.next()).done;)r(h.value)}}(r,F=>{M=this._trackByFn(g,F),null!==l&&Object.is(l.trackById,M)?(h&&(l=this._verifyReinsertion(l,F,M,g)),Object.is(l.item,F)||this._addIdentityChange(l,F)):(l=this._mismatch(l,F,M,g),h=!0),l=l._next,g++}),this.length=g;return this._truncate(l),this.collection=r,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let r;for(r=this._previousItHead=this._itHead;null!==r;r=r._next)r._nextPrevious=r._next;for(r=this._additionsHead;null!==r;r=r._nextAdded)r.previousIndex=r.currentIndex;for(this._additionsHead=this._additionsTail=null,r=this._movesHead;null!==r;r=r._nextMoved)r.previousIndex=r.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(r,l,h,g){let C;return null===r?C=this._itTail:(C=r._prev,this._remove(r)),null!==(r=null===this._unlinkedRecords?null:this._unlinkedRecords.get(h,null))?(Object.is(r.item,l)||this._addIdentityChange(r,l),this._reinsertAfter(r,C,g)):null!==(r=null===this._linkedRecords?null:this._linkedRecords.get(h,g))?(Object.is(r.item,l)||this._addIdentityChange(r,l),this._moveAfter(r,C,g)):r=this._addAfter(new mT(l,h),C,g),r}_verifyReinsertion(r,l,h,g){let C=null===this._unlinkedRecords?null:this._unlinkedRecords.get(h,null);return null!==C?r=this._reinsertAfter(C,r._prev,g):r.currentIndex!=g&&(r.currentIndex=g,this._addToMoves(r,g)),r}_truncate(r){for(;null!==r;){const l=r._next;this._addToRemovals(this._unlink(r)),r=l}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(r,l,h){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(r);const g=r._prevRemoved,C=r._nextRemoved;return null===g?this._removalsHead=C:g._nextRemoved=C,null===C?this._removalsTail=g:C._prevRemoved=g,this._insertAfter(r,l,h),this._addToMoves(r,h),r}_moveAfter(r,l,h){return this._unlink(r),this._insertAfter(r,l,h),this._addToMoves(r,h),r}_addAfter(r,l,h){return this._insertAfter(r,l,h),this._additionsTail=null===this._additionsTail?this._additionsHead=r:this._additionsTail._nextAdded=r,r}_insertAfter(r,l,h){const g=null===l?this._itHead:l._next;return r._next=g,r._prev=l,null===g?this._itTail=r:g._prev=r,null===l?this._itHead=r:l._next=r,null===this._linkedRecords&&(this._linkedRecords=new b1),this._linkedRecords.put(r),r.currentIndex=h,r}_remove(r){return this._addToRemovals(this._unlink(r))}_unlink(r){null!==this._linkedRecords&&this._linkedRecords.remove(r);const l=r._prev,h=r._next;return null===l?this._itHead=h:l._next=h,null===h?this._itTail=l:h._prev=l,r}_addToMoves(r,l){return r.previousIndex===l||(this._movesTail=null===this._movesTail?this._movesHead=r:this._movesTail._nextMoved=r),r}_addToRemovals(r){return null===this._unlinkedRecords&&(this._unlinkedRecords=new b1),this._unlinkedRecords.put(r),r.currentIndex=null,r._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=r,r._prevRemoved=null):(r._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=r),r}_addIdentityChange(r,l){return r.item=l,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=r:this._identityChangesTail._nextIdentityChange=r,r}}class mT{constructor(r,l){this.item=r,this.trackById=l,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class gT{constructor(){this._head=null,this._tail=null}add(r){null===this._head?(this._head=this._tail=r,r._nextDup=null,r._prevDup=null):(this._tail._nextDup=r,r._prevDup=this._tail,r._nextDup=null,this._tail=r)}get(r,l){let h;for(h=this._head;null!==h;h=h._nextDup)if((null===l||l<=h.currentIndex)&&Object.is(h.trackById,r))return h;return null}remove(r){const l=r._prevDup,h=r._nextDup;return null===l?this._head=h:l._nextDup=h,null===h?this._tail=l:h._prevDup=l,null===this._head}}class b1{constructor(){this.map=new Map}put(r){const l=r.trackById;let h=this.map.get(l);h||(h=new gT,this.map.set(l,h)),h.add(r)}get(r,l){const g=this.map.get(r);return g?g.get(r,l):null}remove(r){const l=r.trackById;return this.map.get(l).remove(r)&&this.map.delete(l),r}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function w1(n,r,l){const h=n.previousIndex;if(null===h)return h;let g=0;return l&&h<l.length&&(g=l[h]),h+r+g}class C1{constructor(){}supports(r){return r instanceof Map||Dp(r)}create(){return new _T}}class _T{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(r){let l;for(l=this._mapHead;null!==l;l=l._next)r(l)}forEachPreviousItem(r){let l;for(l=this._previousMapHead;null!==l;l=l._nextPrevious)r(l)}forEachChangedItem(r){let l;for(l=this._changesHead;null!==l;l=l._nextChanged)r(l)}forEachAddedItem(r){let l;for(l=this._additionsHead;null!==l;l=l._nextAdded)r(l)}forEachRemovedItem(r){let l;for(l=this._removalsHead;null!==l;l=l._nextRemoved)r(l)}diff(r){if(r){if(!(r instanceof Map||Dp(r)))throw new ae(900,!1)}else r=new Map;return this.check(r)?this:null}onDestroy(){}check(r){this._reset();let l=this._mapHead;if(this._appendAfter=null,this._forEach(r,(h,g)=>{if(l&&l.key===g)this._maybeAddToChanges(l,h),this._appendAfter=l,l=l._next;else{const C=this._getOrCreateRecordForKey(g,h);l=this._insertBeforeOrAppend(l,C)}}),l){l._prev&&(l._prev._next=null),this._removalsHead=l;for(let h=l;null!==h;h=h._nextRemoved)h===this._mapHead&&(this._mapHead=null),this._records.delete(h.key),h._nextRemoved=h._next,h.previousValue=h.currentValue,h.currentValue=null,h._prev=null,h._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(r,l){if(r){const h=r._prev;return l._next=r,l._prev=h,r._prev=l,h&&(h._next=l),r===this._mapHead&&(this._mapHead=l),this._appendAfter=r,r}return this._appendAfter?(this._appendAfter._next=l,l._prev=this._appendAfter):this._mapHead=l,this._appendAfter=l,null}_getOrCreateRecordForKey(r,l){if(this._records.has(r)){const g=this._records.get(r);this._maybeAddToChanges(g,l);const C=g._prev,M=g._next;return C&&(C._next=M),M&&(M._prev=C),g._next=null,g._prev=null,g}const h=new yT(r);return this._records.set(r,h),h.currentValue=l,this._addToAdditions(h),h}_reset(){if(this.isDirty){let r;for(this._previousMapHead=this._mapHead,r=this._previousMapHead;null!==r;r=r._next)r._nextPrevious=r._next;for(r=this._changesHead;null!==r;r=r._nextChanged)r.previousValue=r.currentValue;for(r=this._additionsHead;null!=r;r=r._nextAdded)r.previousValue=r.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(r,l){Object.is(l,r.currentValue)||(r.previousValue=r.currentValue,r.currentValue=l,this._addToChanges(r))}_addToAdditions(r){null===this._additionsHead?this._additionsHead=this._additionsTail=r:(this._additionsTail._nextAdded=r,this._additionsTail=r)}_addToChanges(r){null===this._changesHead?this._changesHead=this._changesTail=r:(this._changesTail._nextChanged=r,this._changesTail=r)}_forEach(r,l){r instanceof Map?r.forEach(l):Object.keys(r).forEach(h=>l(r[h],h))}}class yT{constructor(r){this.key=r,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function T1(){return new cv([new x1])}let cv=(()=>{class n{constructor(l){this.factories=l}static create(l,h){if(null!=h){const g=h.factories.slice();l=l.concat(g)}return new n(l)}static extend(l){return{provide:n,useFactory:h=>n.create(l,h||T1()),deps:[[n,new yh,new nl]]}}find(l){const h=this.factories.find(g=>g.supports(l));if(null!=h)return h;throw new ae(901,!1)}}return n.\u0275prov=Sn({token:n,providedIn:"root",factory:T1}),n})();function E1(){return new uv([new C1])}let uv=(()=>{class n{constructor(l){this.factories=l}static create(l,h){if(h){const g=h.factories.slice();l=l.concat(g)}return new n(l)}static extend(l){return{provide:n,useFactory:h=>n.create(l,h||E1()),deps:[[n,new yh,new nl]]}}find(l){const h=this.factories.find(g=>g.supports(l));if(h)return h;throw new ae(901,!1)}}return n.\u0275prov=Sn({token:n,providedIn:"root",factory:E1}),n})();const bT=l1(null,"core",[]);let wT=(()=>{class n{constructor(l){}}return n.\u0275fac=function(l){return new(l||n)(Y(Np))},n.\u0275mod=On({type:n}),n.\u0275inj=gi({}),n})();function PT(n){return"boolean"==typeof n?n:null!=n&&"false"!==n}function RT(n,r){const l=Qi(n),h=r.elementInjector||Gd();return new ch(l).create(h,r.projectableNodes,r.hostElement,r.environmentInjector)}function LT(n){const r=Qi(n);if(!r)return null;const l=new ch(r);return{get selector(){return l.selector},get type(){return l.componentType},get inputs(){return l.inputs},get outputs(){return l.outputs},get ngContentSelectors(){return l.ngContentSelectors},get isStandalone(){return r.standalone},get isSignal(){return r.signals}}}},6223:(zn,Dt,R)=>{"use strict";R.d(Dt,{Fd:()=>Qr,Fj:()=>Ee,JJ:()=>zt,JU:()=>y,On:()=>On,a5:()=>st,qQ:()=>eo,u5:()=>Kn,wV:()=>Bi});var x=R(2029),d=R(6814),v=R(7715),s=R(9315),Q=R(7398);let ie=(()=>{class ee{constructor(G,ke){this._renderer=G,this._elementRef=ke,this.onChange=bn=>{},this.onTouched=()=>{}}setProperty(G,ke){this._renderer.setProperty(this._elementRef.nativeElement,G,ke)}registerOnTouched(G){this.onTouched=G}registerOnChange(G){this.onChange=G}setDisabledState(G){this.setProperty("disabled",G)}}return ee.\u0275fac=function(G){return new(G||ee)(x.Y36(x.Qsj),x.Y36(x.SBq))},ee.\u0275dir=x.lG2({type:ee}),ee})(),q=(()=>{class ee extends ie{}return ee.\u0275fac=function(){let J;return function(ke){return(J||(J=x.n5z(ee)))(ke||ee)}}(),ee.\u0275dir=x.lG2({type:ee,features:[x.qOj]}),ee})();const y=new x.OlP("NgValueAccessor"),De={provide:y,useExisting:(0,x.Gpc)(()=>Ee),multi:!0},se=new x.OlP("CompositionEventMode");let Ee=(()=>{class ee extends ie{constructor(G,ke,bn){super(G,ke),this._compositionMode=bn,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function X(){const ee=(0,d.q)()?(0,d.q)().getUserAgent():"";return/android (\d+)/.test(ee.toLowerCase())}())}writeValue(G){this.setProperty("value",G??"")}_handleInput(G){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(G)}_compositionStart(){this._composing=!0}_compositionEnd(G){this._composing=!1,this._compositionMode&&this.onChange(G)}}return ee.\u0275fac=function(G){return new(G||ee)(x.Y36(x.Qsj),x.Y36(x.SBq),x.Y36(se,8))},ee.\u0275dir=x.lG2({type:ee,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(G,ke){1&G&&x.NdJ("input",function(hi){return ke._handleInput(hi.target.value)})("blur",function(){return ke.onTouched()})("compositionstart",function(){return ke._compositionStart()})("compositionend",function(hi){return ke._compositionEnd(hi.target.value)})},features:[x._Bn([De]),x.qOj]}),ee})();function _e(ee){return null==ee||("string"==typeof ee||Array.isArray(ee))&&0===ee.length}const Re=new x.OlP("NgValidators"),Ne=new x.OlP("NgAsyncValidators");function Ze(ee){return null}function Ae(ee){return null!=ee}function ve(ee){return(0,x.QGY)(ee)?(0,v.D)(ee):ee}function en(ee){let J={};return ee.forEach(G=>{J=null!=G?{...J,...G}:J}),0===Object.keys(J).length?null:J}function dt(ee,J){return J.map(G=>G(ee))}function lt(ee){return ee.map(J=>function mt(ee){return!ee.validate}(J)?J:G=>J.validate(G))}function xt(ee){return null!=ee?function ze(ee){if(!ee)return null;const J=ee.filter(Ae);return 0==J.length?null:function(G){return en(dt(G,J))}}(lt(ee)):null}function gt(ee){return null!=ee?function Ve(ee){if(!ee)return null;const J=ee.filter(Ae);return 0==J.length?null:function(G){const ke=dt(G,J).map(ve);return(0,s.D)(ke).pipe((0,Q.U)(en))}}(lt(ee)):null}function Be(ee,J){return null===ee?[J]:Array.isArray(ee)?[...ee,J]:[ee,J]}function wn(ee){return ee?Array.isArray(ee)?ee:[ee]:[]}function Xt(ee,J){return Array.isArray(ee)?ee.includes(J):ee===J}function mn(ee,J){const G=wn(J);return wn(ee).forEach(bn=>{Xt(G,bn)||G.push(bn)}),G}function an(ee,J){return wn(J).filter(G=>!Xt(ee,G))}class Vt{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(J){this._rawValidators=J||[],this._composedValidatorFn=xt(this._rawValidators)}_setAsyncValidators(J){this._rawAsyncValidators=J||[],this._composedAsyncValidatorFn=gt(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(J){this._onDestroyCallbacks.push(J)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(J=>J()),this._onDestroyCallbacks=[]}reset(J=void 0){this.control&&this.control.reset(J)}hasError(J,G){return!!this.control&&this.control.hasError(J,G)}getError(J,G){return this.control?this.control.getError(J,G):null}}class St extends Vt{get formDirective(){return null}get path(){return null}}class st extends Vt{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class qt{constructor(J){this._cd=J}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}}let zt=(()=>{class ee extends qt{constructor(G){super(G)}}return ee.\u0275fac=function(G){return new(G||ee)(x.Y36(st,2))},ee.\u0275dir=x.lG2({type:ee,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(G,ke){2&G&&x.ekj("ng-untouched",ke.isUntouched)("ng-touched",ke.isTouched)("ng-pristine",ke.isPristine)("ng-dirty",ke.isDirty)("ng-valid",ke.isValid)("ng-invalid",ke.isInvalid)("ng-pending",ke.isPending)},features:[x.qOj]}),ee})();const ut="VALID",pe="INVALID",xe="PENDING",Qe="DISABLED";function Pt(ee){return null!=ee&&!Array.isArray(ee)&&"object"==typeof ee}class et{constructor(J,G){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(J),this._assignAsyncValidators(G)}get validator(){return this._composedValidatorFn}set validator(J){this._rawValidators=this._composedValidatorFn=J}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(J){this._rawAsyncValidators=this._composedAsyncValidatorFn=J}get parent(){return this._parent}get valid(){return this.status===ut}get invalid(){return this.status===pe}get pending(){return this.status==xe}get disabled(){return this.status===Qe}get enabled(){return this.status!==Qe}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(J){this._assignValidators(J)}setAsyncValidators(J){this._assignAsyncValidators(J)}addValidators(J){this.setValidators(mn(J,this._rawValidators))}addAsyncValidators(J){this.setAsyncValidators(mn(J,this._rawAsyncValidators))}removeValidators(J){this.setValidators(an(J,this._rawValidators))}removeAsyncValidators(J){this.setAsyncValidators(an(J,this._rawAsyncValidators))}hasValidator(J){return Xt(this._rawValidators,J)}hasAsyncValidator(J){return Xt(this._rawAsyncValidators,J)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(J={}){this.touched=!0,this._parent&&!J.onlySelf&&this._parent.markAsTouched(J)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(J=>J.markAllAsTouched())}markAsUntouched(J={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(G=>{G.markAsUntouched({onlySelf:!0})}),this._parent&&!J.onlySelf&&this._parent._updateTouched(J)}markAsDirty(J={}){this.pristine=!1,this._parent&&!J.onlySelf&&this._parent.markAsDirty(J)}markAsPristine(J={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(G=>{G.markAsPristine({onlySelf:!0})}),this._parent&&!J.onlySelf&&this._parent._updatePristine(J)}markAsPending(J={}){this.status=xe,!1!==J.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!J.onlySelf&&this._parent.markAsPending(J)}disable(J={}){const G=this._parentMarkedDirty(J.onlySelf);this.status=Qe,this.errors=null,this._forEachChild(ke=>{ke.disable({...J,onlySelf:!0})}),this._updateValue(),!1!==J.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors({...J,skipPristineCheck:G}),this._onDisabledChange.forEach(ke=>ke(!0))}enable(J={}){const G=this._parentMarkedDirty(J.onlySelf);this.status=ut,this._forEachChild(ke=>{ke.enable({...J,onlySelf:!0})}),this.updateValueAndValidity({onlySelf:!0,emitEvent:J.emitEvent}),this._updateAncestors({...J,skipPristineCheck:G}),this._onDisabledChange.forEach(ke=>ke(!1))}_updateAncestors(J){this._parent&&!J.onlySelf&&(this._parent.updateValueAndValidity(J),J.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(J){this._parent=J}getRawValue(){return this.value}updateValueAndValidity(J={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===ut||this.status===xe)&&this._runAsyncValidator(J.emitEvent)),!1!==J.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!J.onlySelf&&this._parent.updateValueAndValidity(J)}_updateTreeValidity(J={emitEvent:!0}){this._forEachChild(G=>G._updateTreeValidity(J)),this.updateValueAndValidity({onlySelf:!0,emitEvent:J.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Qe:ut}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(J){if(this.asyncValidator){this.status=xe,this._hasOwnPendingAsyncValidator=!0;const G=ve(this.asyncValidator(this));this._asyncValidationSubscription=G.subscribe(ke=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(ke,{emitEvent:J})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(J,G={}){this.errors=J,this._updateControlsErrors(!1!==G.emitEvent)}get(J){let G=J;return null==G||(Array.isArray(G)||(G=G.split(".")),0===G.length)?null:G.reduce((ke,bn)=>ke&&ke._find(bn),this)}getError(J,G){const ke=G?this.get(G):this;return ke&&ke.errors?ke.errors[J]:null}hasError(J,G){return!!this.getError(J,G)}get root(){let J=this;for(;J._parent;)J=J._parent;return J}_updateControlsErrors(J){this.status=this._calculateStatus(),J&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(J)}_initObservables(){this.valueChanges=new x.vpe,this.statusChanges=new x.vpe}_calculateStatus(){return this._allControlsDisabled()?Qe:this.errors?pe:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(xe)?xe:this._anyControlsHaveStatus(pe)?pe:ut}_anyControlsHaveStatus(J){return this._anyControls(G=>G.status===J)}_anyControlsDirty(){return this._anyControls(J=>J.dirty)}_anyControlsTouched(){return this._anyControls(J=>J.touched)}_updatePristine(J={}){this.pristine=!this._anyControlsDirty(),this._parent&&!J.onlySelf&&this._parent._updatePristine(J)}_updateTouched(J={}){this.touched=this._anyControlsTouched(),this._parent&&!J.onlySelf&&this._parent._updateTouched(J)}_registerOnCollectionChange(J){this._onCollectionChange=J}_setUpdateStrategy(J){Pt(J)&&null!=J.updateOn&&(this._updateOn=J.updateOn)}_parentMarkedDirty(J){return!J&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}_find(J){return null}_assignValidators(J){this._rawValidators=Array.isArray(J)?J.slice():J,this._composedValidatorFn=function Lt(ee){return Array.isArray(ee)?xt(ee):ee||null}(this._rawValidators)}_assignAsyncValidators(J){this._rawAsyncValidators=Array.isArray(J)?J.slice():J,this._composedAsyncValidatorFn=function jt(ee){return Array.isArray(ee)?gt(ee):ee||null}(this._rawAsyncValidators)}}const gn=new x.OlP("CallSetDisabledState",{providedIn:"root",factory:()=>ei}),ei="always";function Ii(ee,J,G=ei){(function nn(ee,J){const G=function Bt(ee){return ee._rawValidators}(ee);null!==J.validator?ee.setValidators(Be(G,J.validator)):"function"==typeof G&&ee.setValidators([G]);const ke=function Wt(ee){return ee._rawAsyncValidators}(ee);null!==J.asyncValidator?ee.setAsyncValidators(Be(ke,J.asyncValidator)):"function"==typeof ke&&ee.setAsyncValidators([ke]);const bn=()=>ee.updateValueAndValidity();fo(J._rawValidators,bn),fo(J._rawAsyncValidators,bn)})(ee,J),J.valueAccessor.writeValue(ee.value),(ee.disabled||"always"===G)&&J.valueAccessor.setDisabledState?.(ee.disabled),function Et(ee,J){J.valueAccessor.registerOnChange(G=>{ee._pendingValue=G,ee._pendingChange=!0,ee._pendingDirty=!0,"change"===ee.updateOn&&Pn(ee,J)})}(ee,J),function oi(ee,J){const G=(ke,bn)=>{J.valueAccessor.writeValue(ke),bn&&J.viewToModelUpdate(ke)};ee.registerOnChange(G),J._registerOnDestroy(()=>{ee._unregisterOnChange(G)})}(ee,J),function Nn(ee,J){J.valueAccessor.registerOnTouched(()=>{ee._pendingTouched=!0,"blur"===ee.updateOn&&ee._pendingChange&&Pn(ee,J),"submit"!==ee.updateOn&&ee.markAsTouched()})}(ee,J),function to(ee,J){if(J.valueAccessor.setDisabledState){const G=ke=>{J.valueAccessor.setDisabledState(ke)};ee.registerOnDisabledChange(G),J._registerOnDestroy(()=>{ee._unregisterOnDisabledChange(G)})}}(ee,J)}function fo(ee,J){ee.forEach(G=>{G.registerOnValidatorChange&&G.registerOnValidatorChange(J)})}function Pn(ee,J){ee._pendingDirty&&ee.markAsDirty(),ee.setValue(ee._pendingValue,{emitModelToViewChange:!1}),J.viewToModelUpdate(ee._pendingValue),ee._pendingChange=!1}function Zr(ee,J){const G=ee.indexOf(J);G>-1&&ee.splice(G,1)}function Mr(ee){return"object"==typeof ee&&null!==ee&&2===Object.keys(ee).length&&"value"in ee&&"disabled"in ee}const kr=class extends et{constructor(J=null,G,ke){super(function vt(ee){return(Pt(ee)?ee.validators:ee)||null}(G),function Zt(ee,J){return(Pt(J)?J.asyncValidators:ee)||null}(ke,G)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(J),this._setUpdateStrategy(G),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),Pt(G)&&(G.nonNullable||G.initialValueIsDefault)&&(this.defaultValue=Mr(J)?J.value:J)}setValue(J,G={}){this.value=this._pendingValue=J,this._onChange.length&&!1!==G.emitModelToViewChange&&this._onChange.forEach(ke=>ke(this.value,!1!==G.emitViewToModelChange)),this.updateValueAndValidity(G)}patchValue(J,G={}){this.setValue(J,G)}reset(J=this.defaultValue,G={}){this._applyFormState(J),this.markAsPristine(G),this.markAsUntouched(G),this.setValue(this.value,G),this._pendingChange=!1}_updateValue(){}_anyControls(J){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(J){this._onChange.push(J)}_unregisterOnChange(J){Zr(this._onChange,J)}registerOnDisabledChange(J){this._onDisabledChange.push(J)}_unregisterOnDisabledChange(J){Zr(this._onDisabledChange,J)}_forEachChild(J){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(J){Mr(J)?(this.value=this._pendingValue=J.value,J.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=J}},Cn={provide:st,useExisting:(0,x.Gpc)(()=>On)},vn=(()=>Promise.resolve())();let On=(()=>{class ee extends st{constructor(G,ke,bn,hi,sr,hs){super(),this._changeDetectorRef=sr,this.callSetDisabledState=hs,this.control=new kr,this._registered=!1,this.name="",this.update=new x.vpe,this._parent=G,this._setValidators(ke),this._setAsyncValidators(bn),this.valueAccessor=function tn(ee,J){if(!J)return null;let G,ke,bn;return Array.isArray(J),J.forEach(hi=>{hi.constructor===Ee?G=hi:function Ai(ee){return Object.getPrototypeOf(ee.constructor)===q}(hi)?ke=hi:bn=hi}),bn||ke||G||null}(0,hi)}ngOnChanges(G){if(this._checkForErrors(),!this._registered||"name"in G){if(this._registered&&(this._checkName(),this.formDirective)){const ke=G.name.previousValue;this.formDirective.removeControl({name:ke,path:this._getPath(ke)})}this._setUpControl()}"isDisabled"in G&&this._updateDisabled(G),function oo(ee,J){if(!ee.hasOwnProperty("model"))return!1;const G=ee.model;return!!G.isFirstChange()||!Object.is(J,G.currentValue)}(G,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(G){this.viewModel=G,this.update.emit(G)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){Ii(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(G){vn.then(()=>{this.control.setValue(G,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(G){const ke=G.isDisabled.currentValue,bn=0!==ke&&(0,x.VuI)(ke);vn.then(()=>{bn&&!this.control.disabled?this.control.disable():!bn&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(G){return this._parent?function wi(ee,J){return[...J.path,ee]}(G,this._parent):[G]}}return ee.\u0275fac=function(G){return new(G||ee)(x.Y36(St,9),x.Y36(Re,10),x.Y36(Ne,10),x.Y36(y,10),x.Y36(x.sBO,8),x.Y36(gn,8))},ee.\u0275dir=x.lG2({type:ee,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[x._Bn([Cn]),x.qOj,x.TTD]}),ee})();const Di={provide:y,useExisting:(0,x.Gpc)(()=>Bi),multi:!0};let Bi=(()=>{class ee extends q{writeValue(G){this.setProperty("value",G??"")}registerOnChange(G){this.onChange=ke=>{G(""==ke?null:parseFloat(ke))}}}return ee.\u0275fac=function(){let J;return function(ke){return(J||(J=x.n5z(ee)))(ke||ee)}}(),ee.\u0275dir=x.lG2({type:ee,selectors:[["input","type","number","formControlName",""],["input","type","number","formControl",""],["input","type","number","ngModel",""]],hostBindings:function(G,ke){1&G&&x.NdJ("input",function(hi){return ke.onChange(hi.target.value)})("blur",function(){return ke.onTouched()})},features:[x._Bn([Di]),x.qOj]}),ee})(),ao=(()=>{class ee{}return ee.\u0275fac=function(G){return new(G||ee)},ee.\u0275mod=x.oAB({type:ee}),ee.\u0275inj=x.cJS({}),ee})();function bs(ee){return"number"==typeof ee?ee:parseFloat(ee)}let rr=(()=>{class ee{constructor(){this._validator=Ze}ngOnChanges(G){if(this.inputName in G){const ke=this.normalizeInput(G[this.inputName].currentValue);this._enabled=this.enabled(ke),this._validator=this._enabled?this.createValidator(ke):Ze,this._onChange&&this._onChange()}}validate(G){return this._validator(G)}registerOnValidatorChange(G){this._onChange=G}enabled(G){return null!=G}}return ee.\u0275fac=function(G){return new(G||ee)},ee.\u0275dir=x.lG2({type:ee,features:[x.TTD]}),ee})();const Ar={provide:Re,useExisting:(0,x.Gpc)(()=>Qr),multi:!0};let Qr=(()=>{class ee extends rr{constructor(){super(...arguments),this.inputName="max",this.normalizeInput=G=>bs(G),this.createValidator=G=>function Me(ee){return J=>{if(_e(J.value)||_e(ee))return null;const G=parseFloat(J.value);return!isNaN(G)&&G>ee?{max:{max:ee,actual:J.value}}:null}}(G)}}return ee.\u0275fac=function(){let J;return function(ke){return(J||(J=x.n5z(ee)))(ke||ee)}}(),ee.\u0275dir=x.lG2({type:ee,selectors:[["input","type","number","max","","formControlName",""],["input","type","number","max","","formControl",""],["input","type","number","max","","ngModel",""]],hostVars:1,hostBindings:function(G,ke){2&G&&x.uIk("max",ke._enabled?ke.max:null)},inputs:{max:"max"},features:[x._Bn([Ar]),x.qOj]}),ee})();const ws={provide:Re,useExisting:(0,x.Gpc)(()=>eo),multi:!0};let eo=(()=>{class ee extends rr{constructor(){super(...arguments),this.inputName="min",this.normalizeInput=G=>bs(G),this.createValidator=G=>function Je(ee){return J=>{if(_e(J.value)||_e(ee))return null;const G=parseFloat(J.value);return!isNaN(G)&&G<ee?{min:{min:ee,actual:J.value}}:null}}(G)}}return ee.\u0275fac=function(){let J;return function(ke){return(J||(J=x.n5z(ee)))(ke||ee)}}(),ee.\u0275dir=x.lG2({type:ee,selectors:[["input","type","number","min","","formControlName",""],["input","type","number","min","","formControl",""],["input","type","number","min","","ngModel",""]],hostVars:1,hostBindings:function(G,ke){2&G&&x.uIk("min",ke._enabled?ke.min:null)},inputs:{min:"min"},features:[x._Bn([ws]),x.qOj]}),ee})(),Cr=(()=>{class ee{}return ee.\u0275fac=function(G){return new(G||ee)},ee.\u0275mod=x.oAB({type:ee}),ee.\u0275inj=x.cJS({imports:[ao]}),ee})(),Kn=(()=>{class ee{static withConfig(G){return{ngModule:ee,providers:[{provide:gn,useValue:G.callSetDisabledState??ei}]}}}return ee.\u0275fac=function(G){return new(G||ee)},ee.\u0275mod=x.oAB({type:ee}),ee.\u0275inj=x.cJS({imports:[Cr]}),ee})()},6593:(zn,Dt,R)=>{"use strict";R.d(Dt,{Dx:()=>Ci,b2:()=>dn,q6:()=>Vt});var x=R(2029),d=R(6814);class v extends d.w_{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class s extends v{static makeCurrent(){(0,d.HT)(new s)}onAndCancel(Y,me,Ge){return Y.addEventListener(me,Ge),()=>{Y.removeEventListener(me,Ge)}}dispatchEvent(Y,me){Y.dispatchEvent(me)}remove(Y){Y.parentNode&&Y.parentNode.removeChild(Y)}createElement(Y,me){return(me=me||this.getDefaultDocument()).createElement(Y)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(Y){return Y.nodeType===Node.ELEMENT_NODE}isShadowRoot(Y){return Y instanceof DocumentFragment}getGlobalEventTarget(Y,me){return"window"===me?window:"document"===me?Y:"body"===me?Y.body:null}getBaseHref(Y){const me=function ie(){return Q=Q||document.querySelector("base"),Q?Q.getAttribute("href"):null}();return null==me?null:function y(Ue){q=q||document.createElement("a"),q.setAttribute("href",Ue);const Y=q.pathname;return"/"===Y.charAt(0)?Y:`/${Y}`}(me)}resetBaseElement(){Q=null}getUserAgent(){return window.navigator.userAgent}getCookie(Y){return(0,d.Mx)(document.cookie,Y)}}let q,Q=null,Se=(()=>{class Ue{build(){return new XMLHttpRequest}}return Ue.\u0275fac=function(me){return new(me||Ue)},Ue.\u0275prov=x.Yz7({token:Ue,factory:Ue.\u0275fac}),Ue})();const De=new x.OlP("EventManagerPlugins");let X=(()=>{class Ue{constructor(me,Ge){this._zone=Ge,this._eventNameToPlugin=new Map,me.forEach(Ft=>{Ft.manager=this}),this._plugins=me.slice().reverse()}addEventListener(me,Ge,Ft){return this._findPluginFor(Ge).addEventListener(me,Ge,Ft)}getZone(){return this._zone}_findPluginFor(me){let Ge=this._eventNameToPlugin.get(me);if(Ge)return Ge;if(Ge=this._plugins.find(gn=>gn.supports(me)),!Ge)throw new x.vHH(5101,!1);return this._eventNameToPlugin.set(me,Ge),Ge}}return Ue.\u0275fac=function(me){return new(me||Ue)(x.LFG(De),x.LFG(x.R0b))},Ue.\u0275prov=x.Yz7({token:Ue,factory:Ue.\u0275fac}),Ue})();class se{constructor(Y){this._doc=Y}}const Ee="ng-app-id";let _e=(()=>{class Ue{constructor(me,Ge,Ft,gn={}){this.doc=me,this.appId=Ge,this.nonce=Ft,this.platformId=gn,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=(0,d.PM)(gn),this.resetHostNodes()}addStyles(me){for(const Ge of me)1===this.changeUsageCount(Ge,1)&&this.onStyleAdded(Ge)}removeStyles(me){for(const Ge of me)this.changeUsageCount(Ge,-1)<=0&&this.onStyleRemoved(Ge)}ngOnDestroy(){const me=this.styleNodesInDOM;me&&(me.forEach(Ge=>Ge.remove()),me.clear());for(const Ge of this.getAllStyles())this.onStyleRemoved(Ge);this.resetHostNodes()}addHost(me){this.hostNodes.add(me);for(const Ge of this.getAllStyles())this.addStyleToHost(me,Ge)}removeHost(me){this.hostNodes.delete(me)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(me){for(const Ge of this.hostNodes)this.addStyleToHost(Ge,me)}onStyleRemoved(me){const Ge=this.styleRef;Ge.get(me)?.elements?.forEach(Ft=>Ft.remove()),Ge.delete(me)}collectServerRenderedStyles(){const me=this.doc.head?.querySelectorAll(`style[${Ee}="${this.appId}"]`);if(me?.length){const Ge=new Map;return me.forEach(Ft=>{null!=Ft.textContent&&Ge.set(Ft.textContent,Ft)}),Ge}return null}changeUsageCount(me,Ge){const Ft=this.styleRef;if(Ft.has(me)){const gn=Ft.get(me);return gn.usage+=Ge,gn.usage}return Ft.set(me,{usage:Ge,elements:[]}),Ge}getStyleElement(me,Ge){const Ft=this.styleNodesInDOM,gn=Ft?.get(Ge);if(gn?.parentNode===me)return Ft.delete(Ge),gn.removeAttribute(Ee),gn;{const ei=this.doc.createElement("style");return this.nonce&&ei.setAttribute("nonce",this.nonce),ei.textContent=Ge,this.platformIsServer&&ei.setAttribute(Ee,this.appId),ei}}addStyleToHost(me,Ge){const Ft=this.getStyleElement(me,Ge);me.appendChild(Ft);const gn=this.styleRef,ei=gn.get(Ge)?.elements;ei?ei.push(Ft):gn.set(Ge,{elements:[Ft],usage:1})}resetHostNodes(){const me=this.hostNodes;me.clear(),me.add(this.doc.head)}}return Ue.\u0275fac=function(me){return new(me||Ue)(x.LFG(d.K0),x.LFG(x.AFp),x.LFG(x.Ojb,8),x.LFG(x.Lbi))},Ue.\u0275prov=x.Yz7({token:Ue,factory:Ue.\u0275fac}),Ue})();const be={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},Re=/%COMP%/g,Me=new x.OlP("RemoveStylesOnCompDestroy",{providedIn:"root",factory:()=>!1});function Te(Ue,Y){return Y.map(me=>me.replace(Re,Ue))}let ae=(()=>{class Ue{constructor(me,Ge,Ft,gn,ei,wi,Ii,Zi=null){this.eventManager=me,this.sharedStylesHost=Ge,this.appId=Ft,this.removeStylesOnCompDestroy=gn,this.doc=ei,this.platformId=wi,this.ngZone=Ii,this.nonce=Zi,this.rendererByCompId=new Map,this.platformIsServer=(0,d.PM)(wi),this.defaultRenderer=new yt(me,ei,Ii,this.platformIsServer)}createRenderer(me,Ge){if(!me||!Ge)return this.defaultRenderer;this.platformIsServer&&Ge.encapsulation===x.ifc.ShadowDom&&(Ge={...Ge,encapsulation:x.ifc.Emulated});const Ft=this.getOrCreateRenderer(me,Ge);return Ft instanceof dt?Ft.applyToHost(me):Ft instanceof en&&Ft.applyStyles(),Ft}getOrCreateRenderer(me,Ge){const Ft=this.rendererByCompId;let gn=Ft.get(Ge.id);if(!gn){const ei=this.doc,wi=this.ngZone,Ii=this.eventManager,Zi=this.sharedStylesHost,fo=this.removeStylesOnCompDestroy,to=this.platformIsServer;switch(Ge.encapsulation){case x.ifc.Emulated:gn=new dt(Ii,Zi,Ge,this.appId,fo,ei,wi,to);break;case x.ifc.ShadowDom:return new ve(Ii,Zi,me,Ge,ei,wi,this.nonce,to);default:gn=new en(Ii,Zi,Ge,fo,ei,wi,to)}gn.onDestroy=()=>Ft.delete(Ge.id),Ft.set(Ge.id,gn)}return gn}ngOnDestroy(){this.rendererByCompId.clear()}}return Ue.\u0275fac=function(me){return new(me||Ue)(x.LFG(X),x.LFG(_e),x.LFG(x.AFp),x.LFG(Me),x.LFG(d.K0),x.LFG(x.Lbi),x.LFG(x.R0b),x.LFG(x.Ojb))},Ue.\u0275prov=x.Yz7({token:Ue,factory:Ue.\u0275fac}),Ue})();class yt{constructor(Y,me,Ge,Ft){this.eventManager=Y,this.doc=me,this.ngZone=Ge,this.platformIsServer=Ft,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(Y,me){return me?this.doc.createElementNS(be[me]||me,Y):this.doc.createElement(Y)}createComment(Y){return this.doc.createComment(Y)}createText(Y){return this.doc.createTextNode(Y)}appendChild(Y,me){(Ae(Y)?Y.content:Y).appendChild(me)}insertBefore(Y,me,Ge){Y&&(Ae(Y)?Y.content:Y).insertBefore(me,Ge)}removeChild(Y,me){Y&&Y.removeChild(me)}selectRootElement(Y,me){let Ge="string"==typeof Y?this.doc.querySelector(Y):Y;if(!Ge)throw new x.vHH(-5104,!1);return me||(Ge.textContent=""),Ge}parentNode(Y){return Y.parentNode}nextSibling(Y){return Y.nextSibling}setAttribute(Y,me,Ge,Ft){if(Ft){me=Ft+":"+me;const gn=be[Ft];gn?Y.setAttributeNS(gn,me,Ge):Y.setAttribute(me,Ge)}else Y.setAttribute(me,Ge)}removeAttribute(Y,me,Ge){if(Ge){const Ft=be[Ge];Ft?Y.removeAttributeNS(Ft,me):Y.removeAttribute(`${Ge}:${me}`)}else Y.removeAttribute(me)}addClass(Y,me){Y.classList.add(me)}removeClass(Y,me){Y.classList.remove(me)}setStyle(Y,me,Ge,Ft){Ft&(x.JOm.DashCase|x.JOm.Important)?Y.style.setProperty(me,Ge,Ft&x.JOm.Important?"important":""):Y.style[me]=Ge}removeStyle(Y,me,Ge){Ge&x.JOm.DashCase?Y.style.removeProperty(me):Y.style[me]=""}setProperty(Y,me,Ge){Y[me]=Ge}setValue(Y,me){Y.nodeValue=me}listen(Y,me,Ge){if("string"==typeof Y&&!(Y=(0,d.q)().getGlobalEventTarget(this.doc,Y)))throw new Error(`Unsupported event target ${Y} for event ${me}`);return this.eventManager.addEventListener(Y,me,this.decoratePreventDefault(Ge))}decoratePreventDefault(Y){return me=>{if("__ngUnwrap__"===me)return Y;!1===(this.platformIsServer?this.ngZone.runGuarded(()=>Y(me)):Y(me))&&me.preventDefault()}}}function Ae(Ue){return"TEMPLATE"===Ue.tagName&&void 0!==Ue.content}class ve extends yt{constructor(Y,me,Ge,Ft,gn,ei,wi,Ii){super(Y,gn,ei,Ii),this.sharedStylesHost=me,this.hostEl=Ge,this.shadowRoot=Ge.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const Zi=Te(Ft.id,Ft.styles);for(const fo of Zi){const to=document.createElement("style");wi&&to.setAttribute("nonce",wi),to.textContent=fo,this.shadowRoot.appendChild(to)}}nodeOrShadowRoot(Y){return Y===this.hostEl?this.shadowRoot:Y}appendChild(Y,me){return super.appendChild(this.nodeOrShadowRoot(Y),me)}insertBefore(Y,me,Ge){return super.insertBefore(this.nodeOrShadowRoot(Y),me,Ge)}removeChild(Y,me){return super.removeChild(this.nodeOrShadowRoot(Y),me)}parentNode(Y){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(Y)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}}class en extends yt{constructor(Y,me,Ge,Ft,gn,ei,wi,Ii){super(Y,gn,ei,wi),this.sharedStylesHost=me,this.removeStylesOnCompDestroy=Ft,this.rendererUsageCount=0,this.styles=Ii?Te(Ii,Ge.styles):Ge.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles),this.rendererUsageCount++}destroy(){this.removeStylesOnCompDestroy&&(this.sharedStylesHost.removeStyles(this.styles),this.rendererUsageCount--,0===this.rendererUsageCount&&this.onDestroy?.())}}class dt extends en{constructor(Y,me,Ge,Ft,gn,ei,wi,Ii){const Zi=Ft+"-"+Ge.id;super(Y,me,Ge,gn,ei,wi,Ii,Zi),this.contentAttr=function it(Ue){return"_ngcontent-%COMP%".replace(Re,Ue)}(Zi),this.hostAttr=function Xe(Ue){return"_nghost-%COMP%".replace(Re,Ue)}(Zi)}applyToHost(Y){this.applyStyles(),this.setAttribute(Y,this.hostAttr,"")}createElement(Y,me){const Ge=super.createElement(Y,me);return super.setAttribute(Ge,this.contentAttr,""),Ge}}let mt=(()=>{class Ue extends se{constructor(me){super(me)}supports(me){return!0}addEventListener(me,Ge,Ft){return me.addEventListener(Ge,Ft,!1),()=>this.removeEventListener(me,Ge,Ft)}removeEventListener(me,Ge,Ft){return me.removeEventListener(Ge,Ft)}}return Ue.\u0275fac=function(me){return new(me||Ue)(x.LFG(d.K0))},Ue.\u0275prov=x.Yz7({token:Ue,factory:Ue.\u0275fac}),Ue})();const lt=["alt","control","meta","shift"],ze={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},xt={alt:Ue=>Ue.altKey,control:Ue=>Ue.ctrlKey,meta:Ue=>Ue.metaKey,shift:Ue=>Ue.shiftKey};let Ve=(()=>{class Ue extends se{constructor(me){super(me)}supports(me){return null!=Ue.parseEventName(me)}addEventListener(me,Ge,Ft){const gn=Ue.parseEventName(Ge),ei=Ue.eventCallback(gn.fullKey,Ft,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>(0,d.q)().onAndCancel(me,gn.domEventName,ei))}static parseEventName(me){const Ge=me.toLowerCase().split("."),Ft=Ge.shift();if(0===Ge.length||"keydown"!==Ft&&"keyup"!==Ft)return null;const gn=Ue._normalizeKey(Ge.pop());let ei="",wi=Ge.indexOf("code");if(wi>-1&&(Ge.splice(wi,1),ei="code."),lt.forEach(Zi=>{const fo=Ge.indexOf(Zi);fo>-1&&(Ge.splice(fo,1),ei+=Zi+".")}),ei+=gn,0!=Ge.length||0===gn.length)return null;const Ii={};return Ii.domEventName=Ft,Ii.fullKey=ei,Ii}static matchEventFullKeyCode(me,Ge){let Ft=ze[me.key]||me.key,gn="";return Ge.indexOf("code.")>-1&&(Ft=me.code,gn="code."),!(null==Ft||!Ft)&&(Ft=Ft.toLowerCase()," "===Ft?Ft="space":"."===Ft&&(Ft="dot"),lt.forEach(ei=>{ei!==Ft&&(0,xt[ei])(me)&&(gn+=ei+".")}),gn+=Ft,gn===Ge)}static eventCallback(me,Ge,Ft){return gn=>{Ue.matchEventFullKeyCode(gn,me)&&Ft.runGuarded(()=>Ge(gn))}}static _normalizeKey(me){return"esc"===me?"escape":me}}return Ue.\u0275fac=function(me){return new(me||Ue)(x.LFG(d.K0))},Ue.\u0275prov=x.Yz7({token:Ue,factory:Ue.\u0275fac}),Ue})();const Vt=(0,x.eFA)(x._c5,"browser",[{provide:x.Lbi,useValue:d.bD},{provide:x.g9A,useValue:function wn(){s.makeCurrent()},multi:!0},{provide:d.K0,useFactory:function mn(){return(0,x.RDi)(document),document},deps:[]}]),St=new x.OlP(""),st=[{provide:x.rWj,useClass:class fe{addToWindow(Y){x.dqk.getAngularTestability=(Ge,Ft=!0)=>{const gn=Y.findTestabilityInTree(Ge,Ft);if(null==gn)throw new x.vHH(5103,!1);return gn},x.dqk.getAllAngularTestabilities=()=>Y.getAllTestabilities(),x.dqk.getAllAngularRootElements=()=>Y.getAllRootElements(),x.dqk.frameworkStabilizers||(x.dqk.frameworkStabilizers=[]),x.dqk.frameworkStabilizers.push(Ge=>{const Ft=x.dqk.getAllAngularTestabilities();let gn=Ft.length,ei=!1;const wi=function(Ii){ei=ei||Ii,gn--,0==gn&&Ge(ei)};Ft.forEach(Ii=>{Ii.whenStable(wi)})})}findTestabilityInTree(Y,me,Ge){return null==me?null:Y.getTestability(me)??(Ge?(0,d.q)().isShadowRoot(me)?this.findTestabilityInTree(Y,me.host,!0):this.findTestabilityInTree(Y,me.parentElement,!0):null)}},deps:[]},{provide:x.lri,useClass:x.dDg,deps:[x.R0b,x.eoX,x.rWj]},{provide:x.dDg,useClass:x.dDg,deps:[x.R0b,x.eoX,x.rWj]}],qt=[{provide:x.zSh,useValue:"root"},{provide:x.qLn,useFactory:function Xt(){return new x.qLn},deps:[]},{provide:De,useClass:mt,multi:!0,deps:[d.K0,x.R0b,x.Lbi]},{provide:De,useClass:Ve,multi:!0,deps:[d.K0]},ae,_e,X,{provide:x.FYo,useExisting:ae},{provide:d.JF,useClass:Se,deps:[]},[]];let dn=(()=>{class Ue{constructor(me){}static withServerTransition(me){return{ngModule:Ue,providers:[{provide:x.AFp,useValue:me.appId}]}}}return Ue.\u0275fac=function(me){return new(me||Ue)(x.LFG(St,12))},Ue.\u0275mod=x.oAB({type:Ue}),Ue.\u0275inj=x.cJS({providers:[...qt,...st],imports:[d.ez,x.hGG]}),Ue})(),Ci=(()=>{class Ue{constructor(me){this._doc=me}getTitle(){return this._doc.title}setTitle(me){this._doc.title=me||""}}return Ue.\u0275fac=function(me){return new(me||Ue)(x.LFG(d.K0))},Ue.\u0275prov=x.Yz7({token:Ue,factory:function(me){let Ge=null;return Ge=me?new me:function $i(){return new Ci((0,x.LFG)(d.K0))}(),Ge},providedIn:"root"}),Ue})();typeof window<"u"&&window},2125:(zn,Dt,R)=>{"use strict";R.d(Dt,{gz:()=>Oo,y6:()=>hr,OD:()=>Nt,eC:()=>zt,wN:()=>fs,F0:()=>qo,rH:()=>Ka,Bz:()=>yu,Hx:()=>Zt});var x=R(2029),d=R(2664),v=R(7715),s=R(2096),Q=R(5619),ie=R(5592),q=R(7453),y=R(2737),fe=R(7400),Se=R(4564),De=R(2714),X=R(8251),se=R(7103);function Ee(...L){const B=(0,Se.yG)(L),A=(0,Se.jO)(L),{args:U,keys:le}=(0,q.D)(L);if(0===U.length)return(0,v.D)([],B);const Fe=new ie.y(function _e(L,B,A=y.y){return U=>{be(B,()=>{const{length:le}=L,Fe=new Array(le);let We=le,Jt=le;for(let Rn=0;Rn<le;Rn++)be(B,()=>{const fi=(0,v.D)(L[Rn],B);let Mi=!1;fi.subscribe((0,X.x)(U,Io=>{Fe[Rn]=Io,Mi||(Mi=!0,Jt--),Jt||U.next(A(Fe.slice()))},()=>{--We||U.complete()}))},U)},U)}}(U,B,le?We=>(0,De.n)(le,We):y.y));return A?Fe.pipe((0,fe.Z)(A)):Fe}function be(L,B,A){L?(0,se.f)(A,L,B):B()}const Ne=(0,R(2306).d)(L=>function(){L(this),this.name="EmptyError",this.message="no elements in sequence"});var qe=R(5211),_t=R(4911),Je=R(8407),Me=R(4674);function it(L,B){const A=(0,Me.m)(L)?L:()=>L,U=le=>le.error(A());return new ie.y(B?le=>B.schedule(U,0,le):U)}var Xe=R(6232),Te=R(7394),ae=R(9360);function yt(){return(0,ae.e)((L,B)=>{let A=null;L._refCount++;const U=(0,X.x)(B,void 0,void 0,void 0,()=>{if(!L||L._refCount<=0||0<--L._refCount)return void(A=null);const le=L._connection,Fe=A;A=null,le&&(!Fe||le===Fe)&&le.unsubscribe(),B.unsubscribe()});L.subscribe(U),U.closed||(A=L.connect())})}class we extends ie.y{constructor(B,A){super(),this.source=B,this.subjectFactory=A,this._subject=null,this._refCount=0,this._connection=null,(0,ae.A)(B)&&(this.lift=B.lift)}_subscribe(B){return this.getSubject().subscribe(B)}getSubject(){const B=this._subject;return(!B||B.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:B}=this;this._subject=this._connection=null,B?.unsubscribe()}connect(){let B=this._connection;if(!B){B=this._connection=new Te.w0;const A=this.getSubject();B.add(this.source.subscribe((0,X.x)(A,void 0,()=>{this._teardown(),A.complete()},U=>{this._teardown(),A.error(U)},()=>this._teardown()))),B.closed&&(this._connection=null,B=Te.w0.EMPTY)}return B}refCount(){return yt()(this)}}var Ze=R(8645),Ae=R(6814),ve=R(7398),en=R(4664),dt=R(8180),lt=R(2181),ze=R(1631);function xt(L){return(0,ae.e)((B,A)=>{let U=!1;B.subscribe((0,X.x)(A,le=>{U=!0,A.next(le)},()=>{U||A.next(L),A.complete()}))})}function Ve(L=gt){return(0,ae.e)((B,A)=>{let U=!1;B.subscribe((0,X.x)(A,le=>{U=!0,A.next(le)},()=>U?A.complete():A.error(L())))})}function gt(){return new Ne}function Be(L,B){const A=arguments.length>=2;return U=>U.pipe(L?(0,lt.h)((le,Fe)=>L(le,Fe,U)):y.y,(0,dt.q)(1),A?xt(B):Ve(()=>new Ne))}var Bt=R(6328);function Wt(L,B,A){const U=(0,Me.m)(L)||B||A?{next:L,error:B,complete:A}:L;return U?(0,ae.e)((le,Fe)=>{var We;null===(We=U.subscribe)||void 0===We||We.call(U);let Jt=!0;le.subscribe((0,X.x)(Fe,Rn=>{var fi;null===(fi=U.next)||void 0===fi||fi.call(U,Rn),Fe.next(Rn)},()=>{var Rn;Jt=!1,null===(Rn=U.complete)||void 0===Rn||Rn.call(U),Fe.complete()},Rn=>{var fi;Jt=!1,null===(fi=U.error)||void 0===fi||fi.call(U,Rn),Fe.error(Rn)},()=>{var Rn,fi;Jt&&(null===(Rn=U.unsubscribe)||void 0===Rn||Rn.call(U)),null===(fi=U.finalize)||void 0===fi||fi.call(U)}))}):y.y}var wn=R(4829);function Xt(L){return(0,ae.e)((B,A)=>{let Fe,U=null,le=!1;U=B.subscribe((0,X.x)(A,void 0,void 0,We=>{Fe=(0,wn.Xf)(L(We,Xt(L)(B))),U?(U.unsubscribe(),U=null,Fe.subscribe(A)):le=!0})),le&&(U.unsubscribe(),U=null,Fe.subscribe(A))})}function Vt(L){return L<=0?()=>Xe.E:(0,ae.e)((B,A)=>{let U=[];B.subscribe((0,X.x)(A,le=>{U.push(le),L<U.length&&U.shift()},()=>{for(const le of U)A.next(le);A.complete()},void 0,()=>{U=null}))})}var qt=R(4716),dn=R(7537),Sn=R(6593);const zt="primary",gi=Symbol("RouteTitle");class $i{constructor(B){this.params=B||{}}has(B){return Object.prototype.hasOwnProperty.call(this.params,B)}get(B){if(this.has(B)){const A=this.params[B];return Array.isArray(A)?A[0]:A}return null}getAll(B){if(this.has(B)){const A=this.params[B];return Array.isArray(A)?A:[A]}return[]}get keys(){return Object.keys(this.params)}}function Ci(L){return new $i(L)}function Ji(L,B,A){const U=A.path.split("/");if(U.length>L.length||"full"===A.pathMatch&&(B.hasChildren()||U.length<L.length))return null;const le={};for(let Fe=0;Fe<U.length;Fe++){const We=U[Fe],Jt=L[Fe];if(We.startsWith(":"))le[We.substring(1)]=Jt;else if(We!==Jt.path)return null}return{consumed:L.slice(0,U.length),posParams:le}}function Fi(L,B){const A=L?Object.keys(L):void 0,U=B?Object.keys(B):void 0;if(!A||!U||A.length!=U.length)return!1;let le;for(let Fe=0;Fe<A.length;Fe++)if(le=A[Fe],!ii(L[le],B[le]))return!1;return!0}function ii(L,B){if(Array.isArray(L)&&Array.isArray(B)){if(L.length!==B.length)return!1;const A=[...L].sort(),U=[...B].sort();return A.every((le,Fe)=>U[Fe]===le)}return L===B}function mi(L){return L.length>0?L[L.length-1]:null}function xn(L){return(0,d.b)(L)?L:(0,x.QGY)(L)?(0,v.D)(Promise.resolve(L)):(0,s.of)(L)}const Qt={exact:function Gt(L,B,A){if(!vt(L.segments,B.segments)||!Vo(L.segments,B.segments,A)||L.numberOfChildren!==B.numberOfChildren)return!1;for(const U in B.children)if(!L.children[U]||!Gt(L.children[U],B.children[U],A))return!1;return!0},subset:Gi},Mt={exact:function ct(L,B){return Fi(L,B)},subset:function pn(L,B){return Object.keys(B).length<=Object.keys(L).length&&Object.keys(B).every(A=>ii(L[A],B[A]))},ignored:()=>!0};function ge(L,B,A){return Qt[A.paths](L.root,B.root,A.matrixParams)&&Mt[A.queryParams](L.queryParams,B.queryParams)&&!("exact"===A.fragment&&L.fragment!==B.fragment)}function Gi(L,B,A){return ri(L,B,B.segments,A)}function ri(L,B,A,U){if(L.segments.length>A.length){const le=L.segments.slice(0,A.length);return!(!vt(le,A)||B.hasChildren()||!Vo(le,A,U))}if(L.segments.length===A.length){if(!vt(L.segments,A)||!Vo(L.segments,A,U))return!1;for(const le in B.children)if(!L.children[le]||!Gi(L.children[le],B.children[le],U))return!1;return!0}{const le=A.slice(0,L.segments.length),Fe=A.slice(L.segments.length);return!!(vt(L.segments,le)&&Vo(L.segments,le,U)&&L.children[zt])&&ri(L.children[zt],B,Fe,U)}}function Vo(L,B,A){return B.every((U,le)=>Mt[A](L[le].parameters,U.parameters))}class ut{constructor(B=new pe([],{}),A={},U=null){this.root=B,this.queryParams=A,this.fragment=U}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=Ci(this.queryParams)),this._queryParamMap}toString(){return Pt.serialize(this)}}class pe{constructor(B,A){this.segments=B,this.children=A,this.parent=null,Object.values(A).forEach(U=>U.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Kt(this)}}class xe{constructor(B,A){this.path=B,this.parameters=A}get parameterMap(){return this._parameterMap||(this._parameterMap=Ci(this.parameters)),this._parameterMap}toString(){return gn(this)}}function vt(L,B){return L.length===B.length&&L.every((A,U)=>A.path===B[U].path)}let Zt=(()=>{class L{}return L.\u0275fac=function(A){return new(A||L)},L.\u0275prov=x.Yz7({token:L,factory:function(){return new jt},providedIn:"root"}),L})();class jt{parse(B){const A=new Pn(B);return new ut(A.parseRootSegment(),A.parseQueryParams(),A.parseFragment())}serialize(B){const A=`/${In(B.root,!0)}`,U=function wi(L){const B=Object.keys(L).map(A=>{const U=L[A];return Array.isArray(U)?U.map(le=>`${Ue(A)}=${Ue(le)}`).join("&"):`${Ue(A)}=${Ue(U)}`}).filter(A=>!!A);return B.length?`?${B.join("&")}`:""}(B.queryParams);return`${A}${U}${"string"==typeof B.fragment?`#${function Y(L){return encodeURI(L)}(B.fragment)}`:""}`}}const Pt=new jt;function Kt(L){return L.segments.map(B=>gn(B)).join("/")}function In(L,B){if(!L.hasChildren())return Kt(L);if(B){const A=L.children[zt]?In(L.children[zt],!1):"",U=[];return Object.entries(L.children).forEach(([le,Fe])=>{le!==zt&&U.push(`${le}:${In(Fe,!1)}`)}),U.length>0?`${A}(${U.join("//")})`:A}{const A=function Lt(L,B){let A=[];return Object.entries(L.children).forEach(([U,le])=>{U===zt&&(A=A.concat(B(le,U)))}),Object.entries(L.children).forEach(([U,le])=>{U!==zt&&(A=A.concat(B(le,U)))}),A}(L,(U,le)=>le===zt?[In(L.children[zt],!1)]:[`${le}:${In(U,!1)}`]);return 1===Object.keys(L.children).length&&null!=L.children[zt]?`${Kt(L)}/${A[0]}`:`${Kt(L)}/(${A.join("//")})`}}function et(L){return encodeURIComponent(L).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Ue(L){return et(L).replace(/%3B/gi,";")}function me(L){return et(L).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Ge(L){return decodeURIComponent(L)}function Ft(L){return Ge(L.replace(/\+/g,"%20"))}function gn(L){return`${me(L.path)}${function ei(L){return Object.keys(L).map(B=>`;${me(B)}=${me(L[B])}`).join("")}(L.parameters)}`}const Ii=/^[^\/()?;#]+/;function Zi(L){const B=L.match(Ii);return B?B[0]:""}const fo=/^[^\/()?;=#]+/,nn=/^[^=?&#]+/,Et=/^[^&#]+/;class Pn{constructor(B){this.url=B,this.remaining=B}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new pe([],{}):new pe([],this.parseChildren())}parseQueryParams(){const B={};if(this.consumeOptional("?"))do{this.parseQueryParam(B)}while(this.consumeOptional("&"));return B}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const B=[];for(this.peekStartsWith("(")||B.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),B.push(this.parseSegment());let A={};this.peekStartsWith("/(")&&(this.capture("/"),A=this.parseParens(!0));let U={};return this.peekStartsWith("(")&&(U=this.parseParens(!1)),(B.length>0||Object.keys(A).length>0)&&(U[zt]=new pe(B,A)),U}parseSegment(){const B=Zi(this.remaining);if(""===B&&this.peekStartsWith(";"))throw new x.vHH(4009,!1);return this.capture(B),new xe(Ge(B),this.parseMatrixParams())}parseMatrixParams(){const B={};for(;this.consumeOptional(";");)this.parseParam(B);return B}parseParam(B){const A=function to(L){const B=L.match(fo);return B?B[0]:""}(this.remaining);if(!A)return;this.capture(A);let U="";if(this.consumeOptional("=")){const le=Zi(this.remaining);le&&(U=le,this.capture(U))}B[Ge(A)]=Ge(U)}parseQueryParam(B){const A=function bt(L){const B=L.match(nn);return B?B[0]:""}(this.remaining);if(!A)return;this.capture(A);let U="";if(this.consumeOptional("=")){const We=function Nn(L){const B=L.match(Et);return B?B[0]:""}(this.remaining);We&&(U=We,this.capture(U))}const le=Ft(A),Fe=Ft(U);if(B.hasOwnProperty(le)){let We=B[le];Array.isArray(We)||(We=[We],B[le]=We),We.push(Fe)}else B[le]=Fe}parseParens(B){const A={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const U=Zi(this.remaining),le=this.remaining[U.length];if("/"!==le&&")"!==le&&";"!==le)throw new x.vHH(4010,!1);let Fe;U.indexOf(":")>-1?(Fe=U.slice(0,U.indexOf(":")),this.capture(Fe),this.capture(":")):B&&(Fe=zt);const We=this.parseChildren();A[Fe]=1===Object.keys(We).length?We[zt]:new pe([],We),this.consumeOptional("//")}return A}peekStartsWith(B){return this.remaining.startsWith(B)}consumeOptional(B){return!!this.peekStartsWith(B)&&(this.remaining=this.remaining.substring(B.length),!0)}capture(B){if(!this.consumeOptional(B))throw new x.vHH(4011,!1)}}function oi(L){return L.segments.length>0?new pe([],{[zt]:L}):L}function ti(L){const B={};for(const U of Object.keys(L.children)){const Fe=ti(L.children[U]);if(U===zt&&0===Fe.segments.length&&Fe.hasChildren())for(const[We,Jt]of Object.entries(Fe.children))B[We]=Jt;else(Fe.segments.length>0||Fe.hasChildren())&&(B[U]=Fe)}return function qi(L){if(1===L.numberOfChildren&&L.children[zt]){const B=L.children[zt];return new pe(L.segments.concat(B.segments),B.children)}return L}(new pe(L.segments,B))}function xi(L){return L instanceof ut}function So(L){let B;const le=oi(function A(Fe){const We={};for(const Rn of Fe.children){const fi=A(Rn);We[Rn.outlet]=fi}const Jt=new pe(Fe.url,We);return Fe===L&&(B=Jt),Jt}(L.root));return B??le}function Go(L,B,A,U){let le=L;for(;le.parent;)le=le.parent;if(0===B.length)return Ai(le,le,le,A,U);const Fe=function Qo(L){if("string"==typeof L[0]&&1===L.length&&"/"===L[0])return new tn(!0,0,L);let B=0,A=!1;const U=L.reduce((le,Fe,We)=>{if("object"==typeof Fe&&null!=Fe){if(Fe.outlets){const Jt={};return Object.entries(Fe.outlets).forEach(([Rn,fi])=>{Jt[Rn]="string"==typeof fi?fi.split("/"):fi}),[...le,{outlets:Jt}]}if(Fe.segmentPath)return[...le,Fe.segmentPath]}return"string"!=typeof Fe?[...le,Fe]:0===We?(Fe.split("/").forEach((Jt,Rn)=>{0==Rn&&"."===Jt||(0==Rn&&""===Jt?A=!0:".."===Jt?B++:""!=Jt&&le.push(Jt))}),le):[...le,Fe]},[]);return new tn(A,B,U)}(B);if(Fe.toRoot())return Ai(le,le,new pe([],{}),A,U);const We=function Ki(L,B,A){if(L.isAbsolute)return new xo(B,!0,0);if(!A)return new xo(B,!1,NaN);if(null===A.parent)return new xo(A,!0,0);const U=uo(L.commands[0])?0:1;return function gr(L,B,A){let U=L,le=B,Fe=A;for(;Fe>le;){if(Fe-=le,U=U.parent,!U)throw new x.vHH(4005,!1);le=U.segments.length}return new xo(U,!1,le-Fe)}(A,A.segments.length-1+U,L.numberOfDoubleDots)}(Fe,le,L),Jt=We.processChildren?Mr(We.segmentGroup,We.index,Fe.commands):Zr(We.segmentGroup,We.index,Fe.commands);return Ai(le,We.segmentGroup,Jt,A,U)}function uo(L){return"object"==typeof L&&null!=L&&!L.outlets&&!L.segmentPath}function oo(L){return"object"==typeof L&&null!=L&&L.outlets}function Ai(L,B,A,U,le){let We,Fe={};U&&Object.entries(U).forEach(([Rn,fi])=>{Fe[Rn]=Array.isArray(fi)?fi.map(Mi=>`${Mi}`):`${fi}`}),We=L===B?A:ho(L,B,A);const Jt=oi(ti(We));return new ut(Jt,Fe,le)}function ho(L,B,A){const U={};return Object.entries(L.children).forEach(([le,Fe])=>{U[le]=Fe===B?A:ho(Fe,B,A)}),new pe(L.segments,U)}class tn{constructor(B,A,U){if(this.isAbsolute=B,this.numberOfDoubleDots=A,this.commands=U,B&&U.length>0&&uo(U[0]))throw new x.vHH(4003,!1);const le=U.find(oo);if(le&&le!==mi(U))throw new x.vHH(4004,!1)}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class xo{constructor(B,A,U){this.segmentGroup=B,this.processChildren=A,this.index=U}}function Zr(L,B,A){if(L||(L=new pe([],{})),0===L.segments.length&&L.hasChildren())return Mr(L,B,A);const U=function kr(L,B,A){let U=0,le=B;const Fe={match:!1,pathIndex:0,commandIndex:0};for(;le<L.segments.length;){if(U>=A.length)return Fe;const We=L.segments[le],Jt=A[U];if(oo(Jt))break;const Rn=`${Jt}`,fi=U<A.length-1?A[U+1]:null;if(le>0&&void 0===Rn)break;if(Rn&&fi&&"object"==typeof fi&&void 0===fi.outlets){if(!rt(Rn,fi,We))return Fe;U+=2}else{if(!rt(Rn,{},We))return Fe;U++}le++}return{match:!0,pathIndex:le,commandIndex:U}}(L,B,A),le=A.slice(U.commandIndex);if(U.match&&U.pathIndex<L.segments.length){const Fe=new pe(L.segments.slice(0,U.pathIndex),{});return Fe.children[zt]=new pe(L.segments.slice(U.pathIndex),L.children),Mr(Fe,0,le)}return U.match&&0===le.length?new pe(L.segments,{}):U.match&&!L.hasChildren()?Qn(L,B,A):U.match?Mr(L,0,le):Qn(L,B,A)}function Mr(L,B,A){if(0===A.length)return new pe(L.segments,{});{const U=function bo(L){return oo(L[0])?L[0].outlets:{[zt]:L}}(A),le={};if(!U[zt]&&L.children[zt]&&1===L.numberOfChildren&&0===L.children[zt].segments.length){const Fe=Mr(L.children[zt],B,A);return new pe(L.segments,Fe.children)}return Object.entries(U).forEach(([Fe,We])=>{"string"==typeof We&&(We=[We]),null!==We&&(le[Fe]=Zr(L.children[Fe],B,We))}),Object.entries(L.children).forEach(([Fe,We])=>{void 0===U[Fe]&&(le[Fe]=We)}),new pe(L.segments,le)}}function Qn(L,B,A){const U=L.segments.slice(0,B);let le=0;for(;le<A.length;){const Fe=A[le];if(oo(Fe)){const Rn=Ui(Fe.outlets);return new pe(U,Rn)}if(0===le&&uo(A[0])){U.push(new xe(L.segments[B].path,ye(A[0]))),le++;continue}const We=oo(Fe)?Fe.outlets[zt]:`${Fe}`,Jt=le<A.length-1?A[le+1]:null;We&&Jt&&uo(Jt)?(U.push(new xe(We,ye(Jt))),le+=2):(U.push(new xe(We,{})),le++)}return new pe(U,{})}function Ui(L){const B={};return Object.entries(L).forEach(([A,U])=>{"string"==typeof U&&(U=[U]),null!==U&&(B[A]=Qn(new pe([],{}),0,U))}),B}function ye(L){const B={};return Object.entries(L).forEach(([A,U])=>B[A]=`${U}`),B}function rt(L,B,A){return L==A.path&&Fi(B,A.parameters)}const Le="imperative";class tt{constructor(B,A){this.id=B,this.url=A}}class Nt extends tt{constructor(B,A,U="imperative",le=null){super(B,A),this.type=0,this.navigationTrigger=U,this.restoredState=le}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class Ut extends tt{constructor(B,A,U){super(B,A),this.urlAfterRedirects=U,this.type=1}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class _n extends tt{constructor(B,A,U,le){super(B,A),this.reason=U,this.code=le,this.type=2}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class Cn extends tt{constructor(B,A,U,le){super(B,A),this.reason=U,this.code=le,this.type=16}}class vn extends tt{constructor(B,A,U,le){super(B,A),this.error=U,this.target=le,this.type=3}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class On extends tt{constructor(B,A,U,le){super(B,A),this.urlAfterRedirects=U,this.state=le,this.type=4}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class di extends tt{constructor(B,A,U,le){super(B,A),this.urlAfterRedirects=U,this.state=le,this.type=7}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Di extends tt{constructor(B,A,U,le,Fe){super(B,A),this.urlAfterRedirects=U,this.state=le,this.shouldActivate=Fe,this.type=8}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class Bi extends tt{constructor(B,A,U,le){super(B,A),this.urlAfterRedirects=U,this.state=le,this.type=5}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Lo extends tt{constructor(B,A,U,le){super(B,A),this.urlAfterRedirects=U,this.state=le,this.type=6}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Qi{constructor(B){this.route=B,this.type=9}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class ao{constructor(B){this.route=B,this.type=10}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class To{constructor(B){this.snapshot=B,this.type=11}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class or{constructor(B){this.snapshot=B,this.type=12}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Wo{constructor(B){this.snapshot=B,this.type=13}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class dr{constructor(B){this.snapshot=B,this.type=14}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Co{constructor(B,A,U){this.routerEvent=B,this.position=A,this.anchor=U,this.type=15}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}class ea{constructor(){this.outlet=null,this.route=null,this.injector=null,this.children=new hr,this.attachRef=null}}let hr=(()=>{class L{constructor(){this.contexts=new Map}onChildOutletCreated(A,U){const le=this.getOrCreateContext(A);le.outlet=U,this.contexts.set(A,le)}onChildOutletDestroyed(A){const U=this.getContext(A);U&&(U.outlet=null,U.attachRef=null)}onOutletDeactivated(){const A=this.contexts;return this.contexts=new Map,A}onOutletReAttached(A){this.contexts=A}getOrCreateContext(A){let U=this.getContext(A);return U||(U=new ea,this.contexts.set(A,U)),U}getContext(A){return this.contexts.get(A)||null}}return L.\u0275fac=function(A){return new(A||L)},L.\u0275prov=x.Yz7({token:L,factory:L.\u0275fac,providedIn:"root"}),L})();class wo{constructor(B){this._root=B}get root(){return this._root.value}parent(B){const A=this.pathFromRoot(B);return A.length>1?A[A.length-2]:null}children(B){const A=pi(B,this._root);return A?A.children.map(U=>U.value):[]}firstChild(B){const A=pi(B,this._root);return A&&A.children.length>0?A.children[0].value:null}siblings(B){const A=Ri(B,this._root);return A.length<2?[]:A[A.length-2].children.map(le=>le.value).filter(le=>le!==B)}pathFromRoot(B){return Ri(B,this._root).map(A=>A.value)}}function pi(L,B){if(L===B.value)return B;for(const A of B.children){const U=pi(L,A);if(U)return U}return null}function Ri(L,B){if(L===B.value)return[B];for(const A of B.children){const U=Ri(L,A);if(U.length)return U.unshift(B),U}return[]}class Li{constructor(B,A){this.value=B,this.children=A}toString(){return`TreeNode(${this.value})`}}function er(L){const B={};return L&&L.children.forEach(A=>B[A.value.outlet]=A),B}class is extends wo{constructor(B,A){super(B),this.snapshot=A,ta(this,B)}toString(){return this.snapshot.toString()}}function jo(L,B){const A=function Jo(L,B){const We=new Si([],{},{},"",{},zt,B,null,{});return new us("",new Li(We,[]))}(0,B),U=new Q.X([new xe("",{})]),le=new Q.X({}),Fe=new Q.X({}),We=new Q.X({}),Jt=new Q.X(""),Rn=new Oo(U,le,We,Jt,Fe,zt,B,A.root);return Rn.snapshot=A.root,new is(new Li(Rn,[]),A)}class Oo{constructor(B,A,U,le,Fe,We,Jt,Rn){this.urlSubject=B,this.paramsSubject=A,this.queryParamsSubject=U,this.fragmentSubject=le,this.dataSubject=Fe,this.outlet=We,this.component=Jt,this._futureSnapshot=Rn,this.title=this.dataSubject?.pipe((0,ve.U)(fi=>fi[gi]))??(0,s.of)(void 0),this.url=B,this.params=A,this.queryParams=U,this.fragment=le,this.data=Fe}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe((0,ve.U)(B=>Ci(B)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe((0,ve.U)(B=>Ci(B)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function Ur(L,B="emptyOnly"){const A=L.pathFromRoot;let U=0;if("always"!==B)for(U=A.length-1;U>=1;){const le=A[U],Fe=A[U-1];if(le.routeConfig&&""===le.routeConfig.path)U--;else{if(Fe.component)break;U--}}return function xr(L){return L.reduce((B,A)=>({params:{...B.params,...A.params},data:{...B.data,...A.data},resolve:{...A.data,...B.resolve,...A.routeConfig?.data,...A._resolvedData}}),{params:{},data:{},resolve:{}})}(A.slice(U))}class Si{get title(){return this.data?.[gi]}constructor(B,A,U,le,Fe,We,Jt,Rn,fi){this.url=B,this.params=A,this.queryParams=U,this.fragment=le,this.data=Fe,this.outlet=We,this.component=Jt,this.routeConfig=Rn,this._resolve=fi}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=Ci(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=Ci(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(U=>U.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class us extends wo{constructor(B,A){super(A),this.url=B,ta(this,A)}toString(){return Xr(this._root)}}function ta(L,B){B.value._routerState=L,B.children.forEach(A=>ta(L,A))}function Xr(L){const B=L.children.length>0?` { ${L.children.map(Xr).join(", ")} } `:"";return`${L.value}${B}`}function ko(L){if(L.snapshot){const B=L.snapshot,A=L._futureSnapshot;L.snapshot=A,Fi(B.queryParams,A.queryParams)||L.queryParamsSubject.next(A.queryParams),B.fragment!==A.fragment&&L.fragmentSubject.next(A.fragment),Fi(B.params,A.params)||L.paramsSubject.next(A.params),function Hi(L,B){if(L.length!==B.length)return!1;for(let A=0;A<L.length;++A)if(!Fi(L[A],B[A]))return!1;return!0}(B.url,A.url)||L.urlSubject.next(A.url),Fi(B.data,A.data)||L.dataSubject.next(A.data)}else L.snapshot=L._futureSnapshot,L.dataSubject.next(L._futureSnapshot.data)}function Ir(L,B){const A=Fi(L.params,B.params)&&function Qe(L,B){return vt(L,B)&&L.every((A,U)=>Fi(A.parameters,B[U].parameters))}(L.url,B.url);return A&&!(!L.parent!=!B.parent)&&(!L.parent||Ir(L.parent,B.parent))}let Fr=(()=>{class L{constructor(){this.activated=null,this._activatedRoute=null,this.name=zt,this.activateEvents=new x.vpe,this.deactivateEvents=new x.vpe,this.attachEvents=new x.vpe,this.detachEvents=new x.vpe,this.parentContexts=(0,x.f3M)(hr),this.location=(0,x.f3M)(x.s_b),this.changeDetector=(0,x.f3M)(x.sBO),this.environmentInjector=(0,x.f3M)(x.lqb),this.inputBinder=(0,x.f3M)(br,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(A){if(A.name){const{firstChange:U,previousValue:le}=A.name;if(U)return;this.isTrackedInParentContexts(le)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(le)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(A){return this.parentContexts.getContext(A)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;const A=this.parentContexts.getContext(this.name);A?.route&&(A.attachRef?this.attach(A.attachRef,A.route):this.activateWith(A.route,A.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new x.vHH(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new x.vHH(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new x.vHH(4012,!1);this.location.detach();const A=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(A.instance),A}attach(A,U){this.activated=A,this._activatedRoute=U,this.location.insert(A.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(A.instance)}deactivate(){if(this.activated){const A=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(A)}}activateWith(A,U){if(this.isActivated)throw new x.vHH(4013,!1);this._activatedRoute=A;const le=this.location,We=A.snapshot.component,Jt=this.parentContexts.getOrCreateContext(this.name).children,Rn=new Br(A,Jt,le.injector);this.activated=le.createComponent(We,{index:le.length,injector:Rn,environmentInjector:U??this.environmentInjector}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}}return L.\u0275fac=function(A){return new(A||L)},L.\u0275dir=x.lG2({type:L,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[x.TTD]}),L})();class Br{constructor(B,A,U){this.route=B,this.childContexts=A,this.parent=U}get(B,A){return B===Oo?this.route:B===hr?this.childContexts:this.parent.get(B,A)}}const br=new x.OlP("");let bs=(()=>{class L{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(A){this.unsubscribeFromRouteData(A),this.subscribeToRouteData(A)}unsubscribeFromRouteData(A){this.outletDataSubscriptions.get(A)?.unsubscribe(),this.outletDataSubscriptions.delete(A)}subscribeToRouteData(A){const{activatedRoute:U}=A,le=Ee([U.queryParams,U.params,U.data]).pipe((0,en.w)(([Fe,We,Jt],Rn)=>(Jt={...Fe,...We,...Jt},0===Rn?(0,s.of)(Jt):Promise.resolve(Jt)))).subscribe(Fe=>{if(!A.isActivated||!A.activatedComponentRef||A.activatedRoute!==U||null===U.component)return void this.unsubscribeFromRouteData(A);const We=(0,x.qFp)(U.component);if(We)for(const{templateName:Jt}of We.inputs)A.activatedComponentRef.setInput(Jt,Fe[Jt]);else this.unsubscribeFromRouteData(A)});this.outletDataSubscriptions.set(A,le)}}return L.\u0275fac=function(A){return new(A||L)},L.\u0275prov=x.Yz7({token:L,factory:L.\u0275fac}),L})();function Ar(L,B,A){if(A&&L.shouldReuseRoute(B.value,A.value.snapshot)){const U=A.value;U._futureSnapshot=B.value;const le=function Qr(L,B,A){return B.children.map(U=>{for(const le of A.children)if(L.shouldReuseRoute(U.value,le.value.snapshot))return Ar(L,U,le);return Ar(L,U)})}(L,B,A);return new Li(U,le)}{if(L.shouldAttach(B.value)){const Fe=L.retrieve(B.value);if(null!==Fe){const We=Fe.route;return We.value._futureSnapshot=B.value,We.children=B.children.map(Jt=>Ar(L,Jt)),We}}const U=function ws(L){return new Oo(new Q.X(L.url),new Q.X(L.params),new Q.X(L.queryParams),new Q.X(L.fragment),new Q.X(L.data),L.outlet,L.component,L)}(B.value),le=B.children.map(Fe=>Ar(L,Fe));return new Li(U,le)}}const eo="ngNavigationCancelingError";function ds(L,B){const{redirectTo:A,navigationBehaviorOptions:U}=xi(B)?{redirectTo:B,navigationBehaviorOptions:void 0}:B,le=na(!1,0,B);return le.url=A,le.navigationBehaviorOptions=U,le}function na(L,B,A){const U=new Error("NavigationCancelingError: "+(L||""));return U[eo]=!0,U.cancellationCode=B,A&&(U.url=A),U}function Ss(L){return Sr(L)&&xi(L.url)}function Sr(L){return L&&L[eo]}let lo=(()=>{class L{}return L.\u0275fac=function(A){return new(A||L)},L.\u0275cmp=x.Xpm({type:L,selectors:[["ng-component"]],standalone:!0,features:[x.jDz],decls:1,vars:0,template:function(A,U){1&A&&x._UZ(0,"router-outlet")},dependencies:[Fr],encapsulation:2}),L})();function pr(L){const B=L.children&&L.children.map(pr),A=B?{...L,children:B}:{...L};return!A.component&&!A.loadComponent&&(B||A.loadChildren)&&A.outlet&&A.outlet!==zt&&(A.component=lo),A}function Cr(L){return L.outlet||zt}function oa(L){if(!L)return null;if(L.routeConfig?._injector)return L.routeConfig._injector;for(let B=L.parent;B;B=B.parent){const A=B.routeConfig;if(A?._loadedInjector)return A._loadedInjector;if(A?._injector)return A._injector}return null}class P{constructor(B,A,U,le,Fe){this.routeReuseStrategy=B,this.futureState=A,this.currState=U,this.forwardEvent=le,this.inputBindingEnabled=Fe}activate(B){const A=this.futureState._root,U=this.currState?this.currState._root:null;this.deactivateChildRoutes(A,U,B),ko(this.futureState.root),this.activateChildRoutes(A,U,B)}deactivateChildRoutes(B,A,U){const le=er(A);B.children.forEach(Fe=>{const We=Fe.value.outlet;this.deactivateRoutes(Fe,le[We],U),delete le[We]}),Object.values(le).forEach(Fe=>{this.deactivateRouteAndItsChildren(Fe,U)})}deactivateRoutes(B,A,U){const le=B.value,Fe=A?A.value:null;if(le===Fe)if(le.component){const We=U.getContext(le.outlet);We&&this.deactivateChildRoutes(B,A,We.children)}else this.deactivateChildRoutes(B,A,U);else Fe&&this.deactivateRouteAndItsChildren(A,U)}deactivateRouteAndItsChildren(B,A){B.value.component&&this.routeReuseStrategy.shouldDetach(B.value.snapshot)?this.detachAndStoreRouteSubtree(B,A):this.deactivateRouteAndOutlet(B,A)}detachAndStoreRouteSubtree(B,A){const U=A.getContext(B.value.outlet),le=U&&B.value.component?U.children:A,Fe=er(B);for(const We of Object.keys(Fe))this.deactivateRouteAndItsChildren(Fe[We],le);if(U&&U.outlet){const We=U.outlet.detach(),Jt=U.children.onOutletDeactivated();this.routeReuseStrategy.store(B.value.snapshot,{componentRef:We,route:B,contexts:Jt})}}deactivateRouteAndOutlet(B,A){const U=A.getContext(B.value.outlet),le=U&&B.value.component?U.children:A,Fe=er(B);for(const We of Object.keys(Fe))this.deactivateRouteAndItsChildren(Fe[We],le);U&&(U.outlet&&(U.outlet.deactivate(),U.children.onOutletDeactivated()),U.attachRef=null,U.route=null)}activateChildRoutes(B,A,U){const le=er(A);B.children.forEach(Fe=>{this.activateRoutes(Fe,le[Fe.value.outlet],U),this.forwardEvent(new dr(Fe.value.snapshot))}),B.children.length&&this.forwardEvent(new or(B.value.snapshot))}activateRoutes(B,A,U){const le=B.value,Fe=A?A.value:null;if(ko(le),le===Fe)if(le.component){const We=U.getOrCreateContext(le.outlet);this.activateChildRoutes(B,A,We.children)}else this.activateChildRoutes(B,A,U);else if(le.component){const We=U.getOrCreateContext(le.outlet);if(this.routeReuseStrategy.shouldAttach(le.snapshot)){const Jt=this.routeReuseStrategy.retrieve(le.snapshot);this.routeReuseStrategy.store(le.snapshot,null),We.children.onOutletReAttached(Jt.contexts),We.attachRef=Jt.componentRef,We.route=Jt.route.value,We.outlet&&We.outlet.attach(Jt.componentRef,Jt.route.value),ko(Jt.route.value),this.activateChildRoutes(B,null,We.children)}else{const Jt=oa(le.snapshot);We.attachRef=null,We.route=le,We.injector=Jt,We.outlet&&We.outlet.activateWith(le,We.injector),this.activateChildRoutes(B,null,We.children)}}else this.activateChildRoutes(B,null,U)}}class ne{constructor(B){this.path=B,this.route=this.path[this.path.length-1]}}class He{constructor(B,A){this.component=B,this.route=A}}function Ln(L,B,A){const U=L._root;return ee(U,B?B._root:null,A,[U.value])}function zi(L,B){const A=Symbol(),U=B.get(L,A);return U===A?"function"!=typeof L||(0,x.Z0I)(L)?B.get(L):L:U}function ee(L,B,A,U,le={canDeactivateChecks:[],canActivateChecks:[]}){const Fe=er(B);return L.children.forEach(We=>{(function J(L,B,A,U,le={canDeactivateChecks:[],canActivateChecks:[]}){const Fe=L.value,We=B?B.value:null,Jt=A?A.getContext(L.value.outlet):null;if(We&&Fe.routeConfig===We.routeConfig){const Rn=function G(L,B,A){if("function"==typeof A)return A(L,B);switch(A){case"pathParamsChange":return!vt(L.url,B.url);case"pathParamsOrQueryParamsChange":return!vt(L.url,B.url)||!Fi(L.queryParams,B.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!Ir(L,B)||!Fi(L.queryParams,B.queryParams);default:return!Ir(L,B)}}(We,Fe,Fe.routeConfig.runGuardsAndResolvers);Rn?le.canActivateChecks.push(new ne(U)):(Fe.data=We.data,Fe._resolvedData=We._resolvedData),ee(L,B,Fe.component?Jt?Jt.children:null:A,U,le),Rn&&Jt&&Jt.outlet&&Jt.outlet.isActivated&&le.canDeactivateChecks.push(new He(Jt.outlet.component,We))}else We&&ke(B,Jt,le),le.canActivateChecks.push(new ne(U)),ee(L,null,Fe.component?Jt?Jt.children:null:A,U,le)})(We,Fe[We.value.outlet],A,U.concat([We.value]),le),delete Fe[We.value.outlet]}),Object.entries(Fe).forEach(([We,Jt])=>ke(Jt,A.getContext(We),le)),le}function ke(L,B,A){const U=er(L),le=L.value;Object.entries(U).forEach(([Fe,We])=>{ke(We,le.component?B?B.children.getContext(Fe):null:B,A)}),A.canDeactivateChecks.push(new He(le.component&&B&&B.outlet&&B.outlet.isActivated?B.outlet.component:null,le))}function bn(L){return"function"==typeof L}function Ll(L){return L instanceof Ne||"EmptyError"===L?.name}const rc=Symbol("INITIAL_VALUE");function Os(){return(0,en.w)(L=>Ee(L.map(B=>B.pipe((0,dt.q)(1),function mt(...L){const B=(0,Se.yG)(L);return(0,ae.e)((A,U)=>{(B?(0,qe.z)(L,A,B):(0,qe.z)(L,A)).subscribe(U)})}(rc)))).pipe((0,ve.U)(B=>{for(const A of B)if(!0!==A){if(A===rc)return rc;if(!1===A||A instanceof ut)return A}return!0}),(0,lt.h)(B=>B!==rc),(0,dt.q)(1)))}function pl(L){return(0,Je.z)(Wt(B=>{if(xi(B))throw ds(0,B)}),(0,ve.U)(B=>!0===B))}class pa{constructor(B){this.segmentGroup=B||null}}class fa{constructor(B){this.urlTree=B}}function Es(L){return it(new pa(L))}function sc(L){return it(new fa(L))}class fl{constructor(B,A){this.urlSerializer=B,this.urlTree=A}noMatchError(B){return new x.vHH(4002,!1)}lineralizeSegments(B,A){let U=[],le=A.root;for(;;){if(U=U.concat(le.segments),0===le.numberOfChildren)return(0,s.of)(U);if(le.numberOfChildren>1||!le.children[zt])return it(new x.vHH(4e3,!1));le=le.children[zt]}}applyRedirectCommands(B,A,U){return this.applyRedirectCreateUrlTree(A,this.urlSerializer.parse(A),B,U)}applyRedirectCreateUrlTree(B,A,U,le){const Fe=this.createSegmentGroup(B,A.root,U,le);return new ut(Fe,this.createQueryParams(A.queryParams,this.urlTree.queryParams),A.fragment)}createQueryParams(B,A){const U={};return Object.entries(B).forEach(([le,Fe])=>{if("string"==typeof Fe&&Fe.startsWith(":")){const Jt=Fe.substring(1);U[le]=A[Jt]}else U[le]=Fe}),U}createSegmentGroup(B,A,U,le){const Fe=this.createSegments(B,A.segments,U,le);let We={};return Object.entries(A.children).forEach(([Jt,Rn])=>{We[Jt]=this.createSegmentGroup(B,Rn,U,le)}),new pe(Fe,We)}createSegments(B,A,U,le){return A.map(Fe=>Fe.path.startsWith(":")?this.findPosParam(B,Fe,le):this.findOrReturn(Fe,U))}findPosParam(B,A,U){const le=U[A.path.substring(1)];if(!le)throw new x.vHH(4001,!1);return le}findOrReturn(B,A){let U=0;for(const le of A){if(le.path===B.path)return A.splice(U),le;U++}return B}}const Bl={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function Ia(L,B,A,U,le){const Fe=Nl(L,B,A);return Fe.matched?(U=function ia(L,B){return L.providers&&!L._injector&&(L._injector=(0,x.MMx)(L.providers,B,`Route: ${L.path}`)),L._injector??B}(B,U),function fd(L,B,A,U){const le=B.canMatch;if(!le||0===le.length)return(0,s.of)(!0);const Fe=le.map(We=>{const Jt=zi(We,L);return xn(function kc(L){return L&&bn(L.canMatch)}(Jt)?Jt.canMatch(B,A):L.runInContext(()=>Jt(B,A)))});return(0,s.of)(Fe).pipe(Os(),pl())}(U,B,A).pipe((0,ve.U)(We=>!0===We?Fe:{...Bl}))):(0,s.of)(Fe)}function Nl(L,B,A){if(""===B.path)return"full"===B.pathMatch&&(L.hasChildren()||A.length>0)?{...Bl}:{matched:!0,consumedSegments:[],remainingSegments:A,parameters:{},positionalParamSegments:{}};const le=(B.matcher||Ji)(A,L,B);if(!le)return{...Bl};const Fe={};Object.entries(le.posParams??{}).forEach(([Jt,Rn])=>{Fe[Jt]=Rn.path});const We=le.consumed.length>0?{...Fe,...le.consumed[le.consumed.length-1].parameters}:Fe;return{matched:!0,consumedSegments:le.consumed,remainingSegments:A.slice(le.consumed.length),parameters:We,positionalParamSegments:le.posParams??{}}}function ml(L,B,A,U){return A.length>0&&function ac(L,B,A){return A.some(U=>zl(L,B,U)&&Cr(U)!==zt)}(L,A,U)?{segmentGroup:new pe(B,Ba(U,new pe(A,L.children))),slicedSegments:[]}:0===A.length&&function mu(L,B,A){return A.some(U=>zl(L,B,U))}(L,A,U)?{segmentGroup:new pe(L.segments,fu(L,0,A,U,L.children)),slicedSegments:A}:{segmentGroup:new pe(L.segments,L.children),slicedSegments:A}}function fu(L,B,A,U,le){const Fe={};for(const We of U)if(zl(L,A,We)&&!le[Cr(We)]){const Jt=new pe([],{});Fe[Cr(We)]=Jt}return{...le,...Fe}}function Ba(L,B){const A={};A[zt]=B;for(const U of L)if(""===U.path&&Cr(U)!==zt){const le=new pe([],{});A[Cr(U)]=le}return A}function zl(L,B,A){return(!(L.hasChildren()||B.length>0)||"full"!==A.pathMatch)&&""===A.path}class Ul{constructor(B,A,U,le,Fe,We,Jt){this.injector=B,this.configLoader=A,this.rootComponentType=U,this.config=le,this.urlTree=Fe,this.paramsInheritanceStrategy=We,this.urlSerializer=Jt,this.allowRedirects=!0,this.applyRedirects=new fl(this.urlSerializer,this.urlTree)}noMatchError(B){return new x.vHH(4002,!1)}recognize(){const B=ml(this.urlTree.root,[],[],this.config).segmentGroup;return this.processSegmentGroup(this.injector,this.config,B,zt).pipe(Xt(A=>{if(A instanceof fa)return this.allowRedirects=!1,this.urlTree=A.urlTree,this.match(A.urlTree);throw A instanceof pa?this.noMatchError(A):A}),(0,ve.U)(A=>{const U=new Si([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},zt,this.rootComponentType,null,{}),le=new Li(U,A),Fe=new us("",le),We=function go(L,B,A=null,U=null){return Go(So(L),B,A,U)}(U,[],this.urlTree.queryParams,this.urlTree.fragment);return We.queryParams=this.urlTree.queryParams,Fe.url=this.urlSerializer.serialize(We),this.inheritParamsAndData(Fe._root),{state:Fe,tree:We}}))}match(B){return this.processSegmentGroup(this.injector,this.config,B.root,zt).pipe(Xt(U=>{throw U instanceof pa?this.noMatchError(U):U}))}inheritParamsAndData(B){const A=B.value,U=Ur(A,this.paramsInheritanceStrategy);A.params=Object.freeze(U.params),A.data=Object.freeze(U.data),B.children.forEach(le=>this.inheritParamsAndData(le))}processSegmentGroup(B,A,U,le){return 0===U.segments.length&&U.hasChildren()?this.processChildren(B,A,U):this.processSegment(B,A,U,U.segments,le,!0)}processChildren(B,A,U){const le=[];for(const Fe of Object.keys(U.children))"primary"===Fe?le.unshift(Fe):le.push(Fe);return(0,v.D)(le).pipe((0,Bt.b)(Fe=>{const We=U.children[Fe],Jt=function Ma(L,B){const A=L.filter(U=>Cr(U)===B);return A.push(...L.filter(U=>Cr(U)!==B)),A}(A,Fe);return this.processSegmentGroup(B,Jt,We,Fe)}),function an(L,B){return(0,ae.e)(function mn(L,B,A,U,le){return(Fe,We)=>{let Jt=A,Rn=B,fi=0;Fe.subscribe((0,X.x)(We,Mi=>{const Io=fi++;Rn=Jt?L(Rn,Mi,Io):(Jt=!0,Mi),U&&We.next(Rn)},le&&(()=>{Jt&&We.next(Rn),We.complete()})))}}(L,B,arguments.length>=2,!0))}((Fe,We)=>(Fe.push(...We),Fe)),xt(null),function St(L,B){const A=arguments.length>=2;return U=>U.pipe(L?(0,lt.h)((le,Fe)=>L(le,Fe,U)):y.y,Vt(1),A?xt(B):Ve(()=>new Ne))}(),(0,ze.z)(Fe=>{if(null===Fe)return Es(U);const We=uc(Fe);return function Na(L){L.sort((B,A)=>B.value.outlet===zt?-1:A.value.outlet===zt?1:B.value.outlet.localeCompare(A.value.outlet))}(We),(0,s.of)(We)}))}processSegment(B,A,U,le,Fe,We){return(0,v.D)(A).pipe((0,Bt.b)(Jt=>this.processSegmentAgainstRoute(Jt._injector??B,A,Jt,U,le,Fe,We).pipe(Xt(Rn=>{if(Rn instanceof pa)return(0,s.of)(null);throw Rn}))),Be(Jt=>!!Jt),Xt(Jt=>{if(Ll(Jt))return function zc(L,B,A){return 0===B.length&&!L.children[A]}(U,le,Fe)?(0,s.of)([]):Es(U);throw Jt}))}processSegmentAgainstRoute(B,A,U,le,Fe,We,Jt){return function lc(L,B,A,U){return!!(Cr(L)===U||U!==zt&&zl(B,A,L))&&("**"===L.path||Nl(B,L,A).matched)}(U,le,Fe,We)?void 0===U.redirectTo?this.matchSegmentAgainstRoute(B,le,U,Fe,We,Jt):Jt&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(B,le,A,U,Fe,We):Es(le):Es(le)}expandSegmentAgainstRouteUsingRedirect(B,A,U,le,Fe,We){return"**"===le.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(B,U,le,We):this.expandRegularSegmentAgainstRouteUsingRedirect(B,A,U,le,Fe,We)}expandWildCardWithParamsAgainstRouteUsingRedirect(B,A,U,le){const Fe=this.applyRedirects.applyRedirectCommands([],U.redirectTo,{});return U.redirectTo.startsWith("/")?sc(Fe):this.applyRedirects.lineralizeSegments(U,Fe).pipe((0,ze.z)(We=>{const Jt=new pe(We,{});return this.processSegment(B,A,Jt,We,le,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(B,A,U,le,Fe,We){const{matched:Jt,consumedSegments:Rn,remainingSegments:fi,positionalParamSegments:Mi}=Nl(A,le,Fe);if(!Jt)return Es(A);const Io=this.applyRedirects.applyRedirectCommands(Rn,le.redirectTo,Mi);return le.redirectTo.startsWith("/")?sc(Io):this.applyRedirects.lineralizeSegments(le,Io).pipe((0,ze.z)(p=>this.processSegment(B,U,A,p.concat(fi),We,!1)))}matchSegmentAgainstRoute(B,A,U,le,Fe,We){let Jt;if("**"===U.path){const Rn=le.length>0?mi(le).parameters:{},fi=new Si(le,Rn,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,ma(U),Cr(U),U.component??U._loadedComponent??null,U,Z(U));Jt=(0,s.of)({snapshot:fi,consumedSegments:[],remainingSegments:[]}),A.children={}}else Jt=Ia(A,U,le,B).pipe((0,ve.U)(({matched:Rn,consumedSegments:fi,remainingSegments:Mi,parameters:Io})=>Rn?{snapshot:new Si(fi,Io,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,ma(U),Cr(U),U.component??U._loadedComponent??null,U,Z(U)),consumedSegments:fi,remainingSegments:Mi}:null));return Jt.pipe((0,en.w)(Rn=>null===Rn?Es(A):this.getChildConfig(B=U._injector??B,U,le).pipe((0,en.w)(({routes:fi})=>{const Mi=U._loadedInjector??B,{snapshot:Io,consumedSegments:p,remainingSegments:o}=Rn,{segmentGroup:c,slicedSegments:m}=ml(A,p,o,fi);if(0===m.length&&c.hasChildren())return this.processChildren(Mi,fi,c).pipe((0,ve.U)(T=>null===T?null:[new Li(Io,T)]));if(0===fi.length&&0===m.length)return(0,s.of)([new Li(Io,[])]);const b=Cr(U)===Fe;return this.processSegment(Mi,fi,c,m,b?zt:Fe,!0).pipe((0,ve.U)(T=>[new Li(Io,T)]))}))))}getChildConfig(B,A,U){return A.children?(0,s.of)({routes:A.children,injector:B}):A.loadChildren?void 0!==A._loadedRoutes?(0,s.of)({routes:A._loadedRoutes,injector:A._loadedInjector}):function Or(L,B,A,U){const le=B.canLoad;if(void 0===le||0===le.length)return(0,s.of)(!0);const Fe=le.map(We=>{const Jt=zi(We,L);return xn(function sr(L){return L&&bn(L.canLoad)}(Jt)?Jt.canLoad(B,A):L.runInContext(()=>Jt(B,A)))});return(0,s.of)(Fe).pipe(Os(),pl())}(B,A,U).pipe((0,ze.z)(le=>le?this.configLoader.loadChildren(B,A).pipe(Wt(Fe=>{A._loadedRoutes=Fe.routes,A._loadedInjector=Fe.injector})):function Nc(L){return it(na(!1,3))}())):(0,s.of)({routes:[],injector:B})}}function cc(L){const B=L.value.routeConfig;return B&&""===B.path}function uc(L){const B=[],A=new Set;for(const U of L){if(!cc(U)){B.push(U);continue}const le=B.find(Fe=>U.value.routeConfig===Fe.value.routeConfig);void 0!==le?(le.children.push(...U.children),A.add(le)):B.push(U)}for(const U of A){const le=uc(U.children);B.push(new Li(U.value,le))}return B.filter(U=>!A.has(U))}function ma(L){return L.data||{}}function Z(L){return L.resolve||{}}function Xn(L){return"string"==typeof L.title||null===L.title}function Eo(L){return(0,en.w)(B=>{const A=L(B);return A?(0,v.D)(A).pipe((0,ve.U)(()=>B)):(0,s.of)(B)})}const yo=new x.OlP("ROUTES");let Xi=(()=>{class L{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=(0,x.f3M)(x.Sil)}loadComponent(A){if(this.componentLoaders.get(A))return this.componentLoaders.get(A);if(A._loadedComponent)return(0,s.of)(A._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(A);const U=xn(A.loadComponent()).pipe((0,ve.U)(fr),Wt(Fe=>{this.onLoadEndListener&&this.onLoadEndListener(A),A._loadedComponent=Fe}),(0,qt.x)(()=>{this.componentLoaders.delete(A)})),le=new we(U,()=>new Ze.x).pipe(yt());return this.componentLoaders.set(A,le),le}loadChildren(A,U){if(this.childrenLoaders.get(U))return this.childrenLoaders.get(U);if(U._loadedRoutes)return(0,s.of)({routes:U._loadedRoutes,injector:U._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(U);const Fe=this.loadModuleFactoryOrRoutes(U.loadChildren).pipe((0,ve.U)(Jt=>{this.onLoadEndListener&&this.onLoadEndListener(U);let Rn,fi;return Array.isArray(Jt)?fi=Jt:(Rn=Jt.create(A).injector,fi=Rn.get(yo,[],x.XFs.Self|x.XFs.Optional).flat()),{routes:fi.map(pr),injector:Rn}}),(0,qt.x)(()=>{this.childrenLoaders.delete(U)})),We=new we(Fe,()=>new Ze.x).pipe(yt());return this.childrenLoaders.set(U,We),We}loadModuleFactoryOrRoutes(A){return xn(A()).pipe((0,ve.U)(fr),(0,ze.z)(U=>U instanceof x.YKP||Array.isArray(U)?(0,s.of)(U):(0,v.D)(this.compiler.compileModuleAsync(U))))}}return L.\u0275fac=function(A){return new(A||L)},L.\u0275prov=x.Yz7({token:L,factory:L.\u0275fac,providedIn:"root"}),L})();function fr(L){return function co(L){return L&&"object"==typeof L&&"default"in L}(L)?L.default:L}let Ro=(()=>{class L{get hasRequestedNavigation(){return 0!==this.navigationId}constructor(){this.currentNavigation=null,this.lastSuccessfulNavigation=null,this.events=new Ze.x,this.configLoader=(0,x.f3M)(Xi),this.environmentInjector=(0,x.f3M)(x.lqb),this.urlSerializer=(0,x.f3M)(Zt),this.rootContexts=(0,x.f3M)(hr),this.inputBindingEnabled=null!==(0,x.f3M)(br,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>(0,s.of)(void 0),this.rootComponentType=null,this.configLoader.onLoadEndListener=le=>this.events.next(new ao(le)),this.configLoader.onLoadStartListener=le=>this.events.next(new Qi(le))}complete(){this.transitions?.complete()}handleNavigationRequest(A){const U=++this.navigationId;this.transitions?.next({...this.transitions.value,...A,id:U})}setupNavigations(A){return this.transitions=new Q.X({id:0,currentUrlTree:A.currentUrlTree,currentRawUrl:A.currentUrlTree,extractedUrl:A.urlHandlingStrategy.extract(A.currentUrlTree),urlAfterRedirects:A.urlHandlingStrategy.extract(A.currentUrlTree),rawUrl:A.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:Le,restoredState:null,currentSnapshot:A.routerState.snapshot,targetSnapshot:null,currentRouterState:A.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe((0,lt.h)(U=>0!==U.id),(0,ve.U)(U=>({...U,extractedUrl:A.urlHandlingStrategy.extract(U.rawUrl)})),(0,en.w)(U=>{let le=!1,Fe=!1;return(0,s.of)(U).pipe(Wt(We=>{this.currentNavigation={id:We.id,initialUrl:We.rawUrl,extractedUrl:We.extractedUrl,trigger:We.source,extras:We.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null}}),(0,en.w)(We=>{const Jt=A.browserUrlTree.toString(),Rn=!A.navigated||We.extractedUrl.toString()!==Jt||Jt!==A.currentUrlTree.toString();if(!Rn&&"reload"!==(We.extras.onSameUrlNavigation??A.onSameUrlNavigation)){const Mi="";return this.events.next(new Cn(We.id,A.serializeUrl(U.rawUrl),Mi,0)),A.rawUrlTree=We.rawUrl,We.resolve(null),Xe.E}if(A.urlHandlingStrategy.shouldProcessUrl(We.rawUrl))return Do(We.source)&&(A.browserUrlTree=We.extractedUrl),(0,s.of)(We).pipe((0,en.w)(Mi=>{const Io=this.transitions?.getValue();return this.events.next(new Nt(Mi.id,this.urlSerializer.serialize(Mi.extractedUrl),Mi.source,Mi.restoredState)),Io!==this.transitions?.getValue()?Xe.E:Promise.resolve(Mi)}),function de(L,B,A,U,le,Fe){return(0,ze.z)(We=>function Uc(L,B,A,U,le,Fe,We="emptyOnly"){return new Ul(L,B,A,U,le,We,Fe).recognize()}(L,B,A,U,We.extractedUrl,le,Fe).pipe((0,ve.U)(({state:Jt,tree:Rn})=>({...We,targetSnapshot:Jt,urlAfterRedirects:Rn}))))}(this.environmentInjector,this.configLoader,this.rootComponentType,A.config,this.urlSerializer,A.paramsInheritanceStrategy),Wt(Mi=>{if(U.targetSnapshot=Mi.targetSnapshot,U.urlAfterRedirects=Mi.urlAfterRedirects,this.currentNavigation={...this.currentNavigation,finalUrl:Mi.urlAfterRedirects},"eager"===A.urlUpdateStrategy){if(!Mi.extras.skipLocationChange){const p=A.urlHandlingStrategy.merge(Mi.urlAfterRedirects,Mi.rawUrl);A.setBrowserUrl(p,Mi)}A.browserUrlTree=Mi.urlAfterRedirects}const Io=new On(Mi.id,this.urlSerializer.serialize(Mi.extractedUrl),this.urlSerializer.serialize(Mi.urlAfterRedirects),Mi.targetSnapshot);this.events.next(Io)}));if(Rn&&A.urlHandlingStrategy.shouldProcessUrl(A.rawUrlTree)){const{id:Mi,extractedUrl:Io,source:p,restoredState:o,extras:c}=We,m=new Nt(Mi,this.urlSerializer.serialize(Io),p,o);this.events.next(m);const b=jo(0,this.rootComponentType).snapshot;return U={...We,targetSnapshot:b,urlAfterRedirects:Io,extras:{...c,skipLocationChange:!1,replaceUrl:!1}},(0,s.of)(U)}{const Mi="";return this.events.next(new Cn(We.id,A.serializeUrl(U.extractedUrl),Mi,1)),A.rawUrlTree=We.rawUrl,We.resolve(null),Xe.E}}),Wt(We=>{const Jt=new di(We.id,this.urlSerializer.serialize(We.extractedUrl),this.urlSerializer.serialize(We.urlAfterRedirects),We.targetSnapshot);this.events.next(Jt)}),(0,ve.U)(We=>U={...We,guards:Ln(We.targetSnapshot,We.currentSnapshot,this.rootContexts)}),function da(L,B){return(0,ze.z)(A=>{const{targetSnapshot:U,currentSnapshot:le,guards:{canActivateChecks:Fe,canDeactivateChecks:We}}=A;return 0===We.length&&0===Fe.length?(0,s.of)({...A,guardsResult:!0}):function kl(L,B,A,U){return(0,v.D)(L).pipe((0,ze.z)(le=>function ha(L,B,A,U,le){const Fe=B&&B.routeConfig?B.routeConfig.canDeactivate:null;if(!Fe||0===Fe.length)return(0,s.of)(!0);const We=Fe.map(Jt=>{const Rn=oa(B)??le,fi=zi(Jt,Rn);return xn(function qa(L){return L&&bn(L.canDeactivate)}(fi)?fi.canDeactivate(L,B,A,U):Rn.runInContext(()=>fi(L,B,A,U))).pipe(Be())});return(0,s.of)(We).pipe(Os())}(le.component,le.route,A,B,U)),Be(le=>!0!==le,!0))}(We,U,le,L).pipe((0,ze.z)(Jt=>Jt&&function hi(L){return"boolean"==typeof L}(Jt)?function Ya(L,B,A,U){return(0,v.D)(B).pipe((0,Bt.b)(le=>(0,qe.z)(function ps(L,B){return null!==L&&B&&B(new To(L)),(0,s.of)(!0)}(le.route.parent,U),function Ja(L,B){return null!==L&&B&&B(new Wo(L)),(0,s.of)(!0)}(le.route,U),function Rs(L,B,A){const U=B[B.length-1],Fe=B.slice(0,B.length-1).reverse().map(We=>function Kn(L){const B=L.routeConfig?L.routeConfig.canActivateChild:null;return B&&0!==B.length?{node:L,guards:B}:null}(We)).filter(We=>null!==We).map(We=>(0,_t.P)(()=>{const Jt=We.guards.map(Rn=>{const fi=oa(We.node)??A,Mi=zi(Rn,fi);return xn(function Ws(L){return L&&bn(L.canActivateChild)}(Mi)?Mi.canActivateChild(U,L):fi.runInContext(()=>Mi(U,L))).pipe(Be())});return(0,s.of)(Jt).pipe(Os())}));return(0,s.of)(Fe).pipe(Os())}(L,le.path,A),function Fl(L,B,A){const U=B.routeConfig?B.routeConfig.canActivate:null;if(!U||0===U.length)return(0,s.of)(!0);const le=U.map(Fe=>(0,_t.P)(()=>{const We=oa(B)??A,Jt=zi(Fe,We);return xn(function hs(L){return L&&bn(L.canActivate)}(Jt)?Jt.canActivate(B,L):We.runInContext(()=>Jt(B,L))).pipe(Be())}));return(0,s.of)(le).pipe(Os())}(L,le.route,A))),Be(le=>!0!==le,!0))}(U,Fe,L,B):(0,s.of)(Jt)),(0,ve.U)(Jt=>({...A,guardsResult:Jt})))})}(this.environmentInjector,We=>this.events.next(We)),Wt(We=>{if(U.guardsResult=We.guardsResult,xi(We.guardsResult))throw ds(0,We.guardsResult);const Jt=new Di(We.id,this.urlSerializer.serialize(We.extractedUrl),this.urlSerializer.serialize(We.urlAfterRedirects),We.targetSnapshot,!!We.guardsResult);this.events.next(Jt)}),(0,lt.h)(We=>!!We.guardsResult||(A.restoreHistory(We),this.cancelNavigationTransition(We,"",3),!1)),Eo(We=>{if(We.guards.canActivateChecks.length)return(0,s.of)(We).pipe(Wt(Jt=>{const Rn=new Bi(Jt.id,this.urlSerializer.serialize(Jt.extractedUrl),this.urlSerializer.serialize(Jt.urlAfterRedirects),Jt.targetSnapshot);this.events.next(Rn)}),(0,en.w)(Jt=>{let Rn=!1;return(0,s.of)(Jt).pipe(function W(L,B){return(0,ze.z)(A=>{const{targetSnapshot:U,guards:{canActivateChecks:le}}=A;if(!le.length)return(0,s.of)(A);let Fe=0;return(0,v.D)(le).pipe((0,Bt.b)(We=>function Ce(L,B,A,U){const le=L.routeConfig,Fe=L._resolve;return void 0!==le?.title&&!Xn(le)&&(Fe[gi]=le.title),function Tt(L,B,A,U){const le=function yn(L){return[...Object.keys(L),...Object.getOwnPropertySymbols(L)]}(L);if(0===le.length)return(0,s.of)({});const Fe={};return(0,v.D)(le).pipe((0,ze.z)(We=>function Dn(L,B,A,U){const le=oa(B)??U,Fe=zi(L,le);return xn(Fe.resolve?Fe.resolve(B,A):le.runInContext(()=>Fe(B,A)))}(L[We],B,A,U).pipe(Be(),Wt(Jt=>{Fe[We]=Jt}))),Vt(1),function st(L){return(0,ve.U)(()=>L)}(Fe),Xt(We=>Ll(We)?Xe.E:it(We)))}(Fe,L,B,U).pipe((0,ve.U)(We=>(L._resolvedData=We,L.data=Ur(L,A).resolve,le&&Xn(le)&&(L.data[gi]=le.title),null)))}(We.route,U,L,B)),Wt(()=>Fe++),Vt(1),(0,ze.z)(We=>Fe===le.length?(0,s.of)(A):Xe.E))})}(A.paramsInheritanceStrategy,this.environmentInjector),Wt({next:()=>Rn=!0,complete:()=>{Rn||(A.restoreHistory(Jt),this.cancelNavigationTransition(Jt,"",2))}}))}),Wt(Jt=>{const Rn=new Lo(Jt.id,this.urlSerializer.serialize(Jt.extractedUrl),this.urlSerializer.serialize(Jt.urlAfterRedirects),Jt.targetSnapshot);this.events.next(Rn)}))}),Eo(We=>{const Jt=Rn=>{const fi=[];Rn.routeConfig?.loadComponent&&!Rn.routeConfig._loadedComponent&&fi.push(this.configLoader.loadComponent(Rn.routeConfig).pipe(Wt(Mi=>{Rn.component=Mi}),(0,ve.U)(()=>{})));for(const Mi of Rn.children)fi.push(...Jt(Mi));return fi};return Ee(Jt(We.targetSnapshot.root)).pipe(xt(),(0,dt.q)(1))}),Eo(()=>this.afterPreactivation()),(0,ve.U)(We=>{const Jt=function rr(L,B,A){const U=Ar(L,B._root,A?A._root:void 0);return new is(U,B)}(A.routeReuseStrategy,We.targetSnapshot,We.currentRouterState);return U={...We,targetRouterState:Jt}}),Wt(We=>{A.currentUrlTree=We.urlAfterRedirects,A.rawUrlTree=A.urlHandlingStrategy.merge(We.urlAfterRedirects,We.rawUrl),A.routerState=We.targetRouterState,"deferred"===A.urlUpdateStrategy&&(We.extras.skipLocationChange||A.setBrowserUrl(A.rawUrlTree,We),A.browserUrlTree=We.urlAfterRedirects)}),((L,B,A,U)=>(0,ve.U)(le=>(new P(B,le.targetRouterState,le.currentRouterState,A,U).activate(L),le)))(this.rootContexts,A.routeReuseStrategy,We=>this.events.next(We),this.inputBindingEnabled),(0,dt.q)(1),Wt({next:We=>{le=!0,this.lastSuccessfulNavigation=this.currentNavigation,A.navigated=!0,this.events.next(new Ut(We.id,this.urlSerializer.serialize(We.extractedUrl),this.urlSerializer.serialize(A.currentUrlTree))),A.titleStrategy?.updateTitle(We.targetRouterState.snapshot),We.resolve(!0)},complete:()=>{le=!0}}),(0,qt.x)(()=>{le||Fe||this.cancelNavigationTransition(U,"",1),this.currentNavigation?.id===U.id&&(this.currentNavigation=null)}),Xt(We=>{if(Fe=!0,Sr(We)){Ss(We)||(A.navigated=!0,A.restoreHistory(U,!0));const Jt=new _n(U.id,this.urlSerializer.serialize(U.extractedUrl),We.message,We.cancellationCode);if(this.events.next(Jt),Ss(We)){const Rn=A.urlHandlingStrategy.merge(We.url,A.rawUrlTree),fi={skipLocationChange:U.extras.skipLocationChange,replaceUrl:"eager"===A.urlUpdateStrategy||Do(U.source)};A.scheduleNavigation(Rn,Le,null,fi,{resolve:U.resolve,reject:U.reject,promise:U.promise})}else U.resolve(!1)}else{A.restoreHistory(U,!0);const Jt=new vn(U.id,this.urlSerializer.serialize(U.extractedUrl),We,U.targetSnapshot??void 0);this.events.next(Jt);try{U.resolve(A.errorHandler(We))}catch(Rn){U.reject(Rn)}}return Xe.E}))}))}cancelNavigationTransition(A,U,le){const Fe=new _n(A.id,this.urlSerializer.serialize(A.extractedUrl),U,le);this.events.next(Fe),A.resolve(!1)}}return L.\u0275fac=function(A){return new(A||L)},L.\u0275prov=x.Yz7({token:L,factory:L.\u0275fac,providedIn:"root"}),L})();function Do(L){return L!==Le}let Ls=(()=>{class L{buildTitle(A){let U,le=A.root;for(;void 0!==le;)U=this.getResolvedTitleForRoute(le)??U,le=le.children.find(Fe=>Fe.outlet===zt);return U}getResolvedTitleForRoute(A){return A.data[gi]}}return L.\u0275fac=function(A){return new(A||L)},L.\u0275prov=x.Yz7({token:L,factory:function(){return(0,x.f3M)(Ds)},providedIn:"root"}),L})(),Ds=(()=>{class L extends Ls{constructor(A){super(),this.title=A}updateTitle(A){const U=this.buildTitle(A);void 0!==U&&this.title.setTitle(U)}}return L.\u0275fac=function(A){return new(A||L)(x.LFG(Sn.Dx))},L.\u0275prov=x.Yz7({token:L,factory:L.\u0275fac,providedIn:"root"}),L})(),fs=(()=>{class L{}return L.\u0275fac=function(A){return new(A||L)},L.\u0275prov=x.Yz7({token:L,factory:function(){return(0,x.f3M)(qs)},providedIn:"root"}),L})();class Vr{shouldDetach(B){return!1}store(B,A){}shouldAttach(B){return!1}retrieve(B){return null}shouldReuseRoute(B,A){return B.routeConfig===A.routeConfig}}let qs=(()=>{class L extends Vr{}return L.\u0275fac=function(){let B;return function(U){return(B||(B=x.n5z(L)))(U||L)}}(),L.\u0275prov=x.Yz7({token:L,factory:L.\u0275fac,providedIn:"root"}),L})();const os=new x.OlP("",{providedIn:"root",factory:()=>({})});let ki=(()=>{class L{}return L.\u0275fac=function(A){return new(A||L)},L.\u0275prov=x.Yz7({token:L,factory:function(){return(0,x.f3M)(Zl)},providedIn:"root"}),L})(),Zl=(()=>{class L{shouldProcessUrl(A){return!0}extract(A){return A}merge(A,U){return A}}return L.\u0275fac=function(A){return new(A||L)},L.\u0275prov=x.Yz7({token:L,factory:L.\u0275fac,providedIn:"root"}),L})();var ms=(()=>((ms=ms||{})[ms.COMPLETE=0]="COMPLETE",ms[ms.FAILED=1]="FAILED",ms[ms.REDIRECTING=2]="REDIRECTING",ms))();function ci(L,B){L.events.pipe((0,lt.h)(A=>A instanceof Ut||A instanceof _n||A instanceof vn||A instanceof Cn),(0,ve.U)(A=>A instanceof Ut||A instanceof Cn?ms.COMPLETE:A instanceof _n&&(0===A.code||1===A.code)?ms.REDIRECTING:ms.FAILED),(0,lt.h)(A=>A!==ms.REDIRECTING),(0,dt.q)(1)).subscribe(()=>{B()})}function sa(L){throw L}function gu(L,B,A){return B.parse("/")}const gl={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},ga={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let qo=(()=>{class L{get navigationId(){return this.navigationTransitions.navigationId}get browserPageId(){if("computed"===this.canceledNavigationResolution)return this.location.getState()?.\u0275routerPageId}get events(){return this.navigationTransitions.events}constructor(){this.disposed=!1,this.currentPageId=0,this.console=(0,x.f3M)(x.c2e),this.isNgZoneEnabled=!1,this.options=(0,x.f3M)(os,{optional:!0})||{},this.pendingTasks=(0,x.f3M)(x.HDt),this.errorHandler=this.options.errorHandler||sa,this.malformedUriErrorHandler=this.options.malformedUriErrorHandler||gu,this.navigated=!1,this.lastSuccessfulId=-1,this.urlHandlingStrategy=(0,x.f3M)(ki),this.routeReuseStrategy=(0,x.f3M)(fs),this.titleStrategy=(0,x.f3M)(Ls),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.config=(0,x.f3M)(yo,{optional:!0})?.flat()??[],this.navigationTransitions=(0,x.f3M)(Ro),this.urlSerializer=(0,x.f3M)(Zt),this.location=(0,x.f3M)(Ae.Ye),this.componentInputBindingEnabled=!!(0,x.f3M)(br,{optional:!0}),this.isNgZoneEnabled=(0,x.f3M)(x.R0b)instanceof x.R0b&&x.R0b.isInAngularZone(),this.resetConfig(this.config),this.currentUrlTree=new ut,this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.routerState=jo(0,null),this.navigationTransitions.setupNavigations(this).subscribe(A=>{this.lastSuccessfulId=A.id,this.currentPageId=this.browserPageId??0},A=>{this.console.warn(`Unhandled Navigation Error: ${A}`)})}resetRootComponentType(A){this.routerState.root.component=A,this.navigationTransitions.rootComponentType=A}initialNavigation(){if(this.setUpLocationChangeListener(),!this.navigationTransitions.hasRequestedNavigation){const A=this.location.getState();this.navigateToSyncWithBrowser(this.location.path(!0),Le,A)}}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(A=>{const U="popstate"===A.type?"popstate":"hashchange";"popstate"===U&&setTimeout(()=>{this.navigateToSyncWithBrowser(A.url,U,A.state)},0)}))}navigateToSyncWithBrowser(A,U,le){const Fe={replaceUrl:!0},We=le?.navigationId?le:null;if(le){const Rn={...le};delete Rn.navigationId,delete Rn.\u0275routerPageId,0!==Object.keys(Rn).length&&(Fe.state=Rn)}const Jt=this.parseUrl(A);this.scheduleNavigation(Jt,U,We,Fe)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(A){this.config=A.map(pr),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(A,U={}){const{relativeTo:le,queryParams:Fe,fragment:We,queryParamsHandling:Jt,preserveFragment:Rn}=U,fi=Rn?this.currentUrlTree.fragment:We;let Io,Mi=null;switch(Jt){case"merge":Mi={...this.currentUrlTree.queryParams,...Fe};break;case"preserve":Mi=this.currentUrlTree.queryParams;break;default:Mi=Fe||null}null!==Mi&&(Mi=this.removeEmptyProps(Mi));try{Io=So(le?le.snapshot:this.routerState.snapshot.root)}catch{("string"!=typeof A[0]||!A[0].startsWith("/"))&&(A=[]),Io=this.currentUrlTree.root}return Go(Io,A,Mi,fi??null)}navigateByUrl(A,U={skipLocationChange:!1}){const le=xi(A)?A:this.parseUrl(A),Fe=this.urlHandlingStrategy.merge(le,this.rawUrlTree);return this.scheduleNavigation(Fe,Le,null,U)}navigate(A,U={skipLocationChange:!1}){return function Vl(L){for(let B=0;B<L.length;B++)if(null==L[B])throw new x.vHH(4008,!1)}(A),this.navigateByUrl(this.createUrlTree(A,U),U)}serializeUrl(A){return this.urlSerializer.serialize(A)}parseUrl(A){let U;try{U=this.urlSerializer.parse(A)}catch(le){U=this.malformedUriErrorHandler(le,this.urlSerializer,A)}return U}isActive(A,U){let le;if(le=!0===U?{...gl}:!1===U?{...ga}:U,xi(A))return ge(this.currentUrlTree,A,le);const Fe=this.parseUrl(A);return ge(this.currentUrlTree,Fe,le)}removeEmptyProps(A){return Object.keys(A).reduce((U,le)=>{const Fe=A[le];return null!=Fe&&(U[le]=Fe),U},{})}scheduleNavigation(A,U,le,Fe,We){if(this.disposed)return Promise.resolve(!1);let Jt,Rn,fi;We?(Jt=We.resolve,Rn=We.reject,fi=We.promise):fi=new Promise((Io,p)=>{Jt=Io,Rn=p});const Mi=this.pendingTasks.add();return ci(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(Mi))}),this.navigationTransitions.handleNavigationRequest({source:U,restoredState:le,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:A,extras:Fe,resolve:Jt,reject:Rn,promise:fi,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),fi.catch(Io=>Promise.reject(Io))}setBrowserUrl(A,U){const le=this.urlSerializer.serialize(A);if(this.location.isCurrentPathEqualTo(le)||U.extras.replaceUrl){const We={...U.extras.state,...this.generateNgRouterState(U.id,this.browserPageId)};this.location.replaceState(le,"",We)}else{const Fe={...U.extras.state,...this.generateNgRouterState(U.id,(this.browserPageId??0)+1)};this.location.go(le,"",Fe)}}restoreHistory(A,U=!1){if("computed"===this.canceledNavigationResolution){const Fe=this.currentPageId-(this.browserPageId??this.currentPageId);0!==Fe?this.location.historyGo(Fe):this.currentUrlTree===this.getCurrentNavigation()?.finalUrl&&0===Fe&&(this.resetState(A),this.browserUrlTree=A.currentUrlTree,this.resetUrlToCurrentUrlTree())}else"replace"===this.canceledNavigationResolution&&(U&&this.resetState(A),this.resetUrlToCurrentUrlTree())}resetState(A){this.routerState=A.currentRouterState,this.currentUrlTree=A.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,A.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(A,U){return"computed"===this.canceledNavigationResolution?{navigationId:A,\u0275routerPageId:U}:{navigationId:A}}}return L.\u0275fac=function(A){return new(A||L)},L.\u0275prov=x.Yz7({token:L,factory:L.\u0275fac,providedIn:"root"}),L})(),Ka=(()=>{class L{constructor(A,U,le,Fe,We,Jt){this.router=A,this.route=U,this.tabIndexAttribute=le,this.renderer=Fe,this.el=We,this.locationStrategy=Jt,this.href=null,this.commands=null,this.onChanges=new Ze.x,this.preserveFragment=!1,this.skipLocationChange=!1,this.replaceUrl=!1;const Rn=We.nativeElement.tagName?.toLowerCase();this.isAnchorElement="a"===Rn||"area"===Rn,this.isAnchorElement?this.subscription=A.events.subscribe(fi=>{fi instanceof Ut&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}setTabIndexIfNotOnNativeEl(A){null!=this.tabIndexAttribute||this.isAnchorElement||this.applyAttributeValue("tabindex",A)}ngOnChanges(A){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}set routerLink(A){null!=A?(this.commands=Array.isArray(A)?A:[A],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(A,U,le,Fe,We){return!!(null===this.urlTree||this.isAnchorElement&&(0!==A||U||le||Fe||We||"string"==typeof this.target&&"_self"!=this.target))||(this.router.navigateByUrl(this.urlTree,{skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state}),!this.isAnchorElement)}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){this.href=null!==this.urlTree&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(this.urlTree)):null;const A=null===this.href?null:(0,x.P3R)(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",A)}applyAttributeValue(A,U){const le=this.renderer,Fe=this.el.nativeElement;null!==U?le.setAttribute(Fe,A,U):le.removeAttribute(Fe,A)}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}}return L.\u0275fac=function(A){return new(A||L)(x.Y36(qo),x.Y36(Oo),x.$8M("tabindex"),x.Y36(x.Qsj),x.Y36(x.SBq),x.Y36(Ae.S$))},L.\u0275dir=x.lG2({type:L,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(A,U){1&A&&x.NdJ("click",function(Fe){return U.onClick(Fe.button,Fe.ctrlKey,Fe.shiftKey,Fe.altKey,Fe.metaKey)}),2&A&&x.uIk("target",U.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",relativeTo:"relativeTo",preserveFragment:["preserveFragment","preserveFragment",x.VuI],skipLocationChange:["skipLocationChange","skipLocationChange",x.VuI],replaceUrl:["replaceUrl","replaceUrl",x.VuI],routerLink:"routerLink"},standalone:!0,features:[x.Xq5,x.TTD]}),L})();class Hn{}let hc=(()=>{class L{constructor(A,U,le,Fe,We){this.router=A,this.injector=le,this.preloadingStrategy=Fe,this.loader=We}setUpPreloading(){this.subscription=this.router.events.pipe((0,lt.h)(A=>A instanceof Ut),(0,Bt.b)(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(A,U){const le=[];for(const Fe of U){Fe.providers&&!Fe._injector&&(Fe._injector=(0,x.MMx)(Fe.providers,A,`Route: ${Fe.path}`));const We=Fe._injector??A,Jt=Fe._loadedInjector??We;(Fe.loadChildren&&!Fe._loadedRoutes&&void 0===Fe.canLoad||Fe.loadComponent&&!Fe._loadedComponent)&&le.push(this.preloadConfig(We,Fe)),(Fe.children||Fe._loadedRoutes)&&le.push(this.processRoutes(Jt,Fe.children??Fe._loadedRoutes))}return(0,v.D)(le).pipe((0,dn.J)())}preloadConfig(A,U){return this.preloadingStrategy.preload(U,()=>{let le;le=U.loadChildren&&void 0===U.canLoad?this.loader.loadChildren(A,U):(0,s.of)(null);const Fe=le.pipe((0,ze.z)(We=>null===We?(0,s.of)(void 0):(U._loadedRoutes=We.routes,U._loadedInjector=We.injector,this.processRoutes(We.injector??A,We.routes))));if(U.loadComponent&&!U._loadedComponent){const We=this.loader.loadComponent(U);return(0,v.D)([Fe,We]).pipe((0,dn.J)())}return Fe})}}return L.\u0275fac=function(A){return new(A||L)(x.LFG(qo),x.LFG(x.Sil),x.LFG(x.lqb),x.LFG(Hn),x.LFG(Xi))},L.\u0275prov=x.Yz7({token:L,factory:L.\u0275fac,providedIn:"root"}),L})();const jr=new x.OlP("");let pc=(()=>{class L{constructor(A,U,le,Fe,We={}){this.urlSerializer=A,this.transitions=U,this.viewportScroller=le,this.zone=Fe,this.options=We,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},We.scrollPositionRestoration=We.scrollPositionRestoration||"disabled",We.anchorScrolling=We.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(A=>{A instanceof Nt?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=A.navigationTrigger,this.restoredId=A.restoredState?A.restoredState.navigationId:0):A instanceof Ut?(this.lastId=A.id,this.scheduleScrollEvent(A,this.urlSerializer.parse(A.urlAfterRedirects).fragment)):A instanceof Cn&&0===A.code&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(A,this.urlSerializer.parse(A.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(A=>{A instanceof Co&&(A.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(A.position):A.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(A.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(A,U){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new Co(A,"popstate"===this.lastSource?this.store[this.restoredId]:null,U))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}}return L.\u0275fac=function(A){x.$Z()},L.\u0275prov=x.Yz7({token:L,factory:L.\u0275fac}),L})();function Fs(L,B){return{\u0275kind:L,\u0275providers:B}}function Wr(){const L=(0,x.f3M)(x.zs3);return B=>{const A=L.get(x.z2F);if(B!==A.components[0])return;const U=L.get(qo),le=L.get(aa);1===L.get(yl)&&U.initialNavigation(),L.get(fc,null,x.XFs.Optional)?.setUpPreloading(),L.get(jr,null,x.XFs.Optional)?.init(),U.resetRootComponentType(A.componentTypes[0]),le.closed||(le.next(),le.complete(),le.unsubscribe())}}const aa=new x.OlP("",{factory:()=>new Ze.x}),yl=new x.OlP("",{providedIn:"root",factory:()=>1}),fc=new x.OlP("");function gd(L){return Fs(0,[{provide:fc,useExisting:hc},{provide:Hn,useExisting:L}])}const _u=new x.OlP("ROUTER_FORROOT_GUARD"),Gc=[Ae.Ye,{provide:Zt,useClass:jt},qo,hr,{provide:Oo,useFactory:function ks(L){return L.routerState.root},deps:[qo]},Xi,[]];function Wc(){return new x.PXZ("Router",qo)}let yu=(()=>{class L{constructor(A){}static forRoot(A,U){return{ngModule:L,providers:[Gc,[],{provide:yo,multi:!0,useValue:A},{provide:_u,useFactory:Ns,deps:[[qo,new x.FiY,new x.tp0]]},{provide:os,useValue:U||{}},U?.useHash?{provide:Ae.S$,useClass:Ae.Do}:{provide:Ae.S$,useClass:Ae.b0},{provide:jr,useFactory:()=>{const L=(0,x.f3M)(Ae.EM),B=(0,x.f3M)(x.R0b),A=(0,x.f3M)(os),U=(0,x.f3M)(Ro),le=(0,x.f3M)(Zt);return A.scrollOffset&&L.setOffset(A.scrollOffset),new pc(le,U,L,B,A)}},U?.preloadingStrategy?gd(U.preloadingStrategy).\u0275providers:[],{provide:x.PXZ,multi:!0,useFactory:Wc},U?.initialNavigation?_a(U):[],U?.bindToComponentInputs?Fs(8,[bs,{provide:br,useExisting:bs}]).\u0275providers:[],[{provide:za,useFactory:Wr},{provide:x.tb,multi:!0,useExisting:za}]]}}static forChild(A){return{ngModule:L,providers:[{provide:yo,multi:!0,useValue:A}]}}}return L.\u0275fac=function(A){return new(A||L)(x.LFG(_u,8))},L.\u0275mod=x.oAB({type:L}),L.\u0275inj=x.cJS({}),L})();function Ns(L){return"guarded"}function _a(L){return["disabled"===L.initialNavigation?Fs(3,[{provide:x.ip1,multi:!0,useFactory:()=>{const B=(0,x.f3M)(qo);return()=>{B.setUpLocationChangeListener()}}},{provide:yl,useValue:2}]).\u0275providers:[],"enabledBlocking"===L.initialNavigation?Fs(2,[{provide:yl,useValue:0},{provide:x.ip1,multi:!0,deps:[x.zs3],useFactory:B=>{const A=B.get(Ae.V_,Promise.resolve());return()=>A.then(()=>new Promise(U=>{const le=B.get(qo),Fe=B.get(aa);ci(le,()=>{U(!0)}),B.get(Ro).afterPreactivation=()=>(U(!0),Fe.closed?(0,s.of)(void 0):Fe),le.initialNavigation()}))}}]).\u0275providers:[]]}const za=new x.OlP("")},7852:(zn,Dt,R)=>{"use strict";R.d(Dt,{BX:()=>na,Br:()=>Ss,w:()=>Xt,dr:()=>Hi,BJ:()=>Fi,oU:()=>ii,cs:()=>bs,yp:()=>xn,YG:()=>ge,Sm:()=>ct,PM:()=>Gt,FN:()=>pn,Zi:()=>Gi,wI:()=>xe,W2:()=>Qe,IJ:()=>Zt,W4:()=>jt,zq:()=>Pt,fr:()=>Kt,jY:()=>In,Gu:()=>et,gu:()=>Ue,pK:()=>Ft,Ie:()=>gn,Q$:()=>to,q_:()=>nn,yh:()=>bt,z0:()=>Nn,fG:()=>Pn,zc:()=>oi,uN:()=>xi,I_:()=>oo,nJ:()=>Ai,Wo:()=>ho,jP:()=>Fr,Nd:()=>Ki,VI:()=>gr,cJ:()=>bo,GO:()=>Zr,t9:()=>Mr,n0:()=>kr,PQ:()=>Ui,jI:()=>ye,g2:()=>Nt,Bs:()=>Ut,wd:()=>_n,ho:()=>vn,sr:()=>On,Pc:()=>oa,r4:()=>Ts,HT:()=>Sr,IN:()=>Ps,SH:()=>To,X1:()=>Co,as:()=>mn,t4:()=>Lo,YI:()=>Ar,QI:()=>Vt,j9:()=>St,yF:()=>Wa});var x=R(5861),d=R(2029),v=R(6223),s=R(7582),Q=R(2438),ie=R(8645),q=R(5619),y=R(2125),se=(R(6506),R(8899),R(5298),R(8077),R(7876)),Ee=R(544),_e=R(1273),be=R(8354),Ne=(R(1767),R(645)),Je=(R(7643),R(4587),R(6953)),it=R(2181),Xe=R(4664),Te=R(3997),ae=R(6814);const we=se.i,ve=["*"],Ve=S=>"function"==typeof __zone_symbol__requestAnimationFrame?__zone_symbol__requestAnimationFrame(S):"function"==typeof requestAnimationFrame?requestAnimationFrame(S):setTimeout(S);let gt=(()=>{class S{constructor(P,ne){this.injector=P,this.el=ne,this.onChange=()=>{},this.onTouched=()=>{}}writeValue(P){this.el.nativeElement.value=this.lastValue=P,Be(this.el)}handleValueChange(P,ne){P===this.el.nativeElement&&(ne!==this.lastValue&&(this.lastValue=ne,this.onChange(ne)),Be(this.el))}_handleBlurEvent(P){P===this.el.nativeElement&&(this.onTouched(),Be(this.el))}registerOnChange(P){this.onChange=P}registerOnTouched(P){this.onTouched=P}setDisabledState(P){this.el.nativeElement.disabled=P}ngOnDestroy(){this.statusChanges&&this.statusChanges.unsubscribe()}ngAfterViewInit(){let P;try{P=this.injector.get(v.a5)}catch{}if(!P)return;P.statusChanges&&(this.statusChanges=P.statusChanges.subscribe(()=>Be(this.el)));const ne=P.control;ne&&["markAsTouched","markAllAsTouched","markAsUntouched","markAsDirty","markAsPristine"].forEach(Ln=>{if(typeof ne[Ln]<"u"){const Kn=ne[Ln].bind(ne);ne[Ln]=(...zi)=>{Kn(...zi),Be(this.el)}}})}}return S.\u0275fac=function(P){return new(P||S)(d.Y36(d.zs3),d.Y36(d.SBq))},S.\u0275dir=d.lG2({type:S,hostBindings:function(P,ne){1&P&&d.NdJ("ionBlur",function(Ln){return ne._handleBlurEvent(Ln.target)})}}),S})();const Be=S=>{Ve(()=>{const re=S.nativeElement,P=null!=re.value&&re.value.toString().length>0,ne=Bt(re);Wt(re,ne);const He=re.closest("ion-item");He&&Wt(He,P?[...ne,"item-has-value"]:ne)})},Bt=S=>{const re=S.classList,P=[];for(let ne=0;ne<re.length;ne++){const He=re.item(ne);null!==He&&wn(He,"ng-")&&P.push(`ion-${He.substring(3)}`)}return P},Wt=(S,re)=>{const P=S.classList;P.remove("ion-valid","ion-invalid","ion-touched","ion-untouched","ion-dirty","ion-pristine"),P.add(...re)},wn=(S,re)=>S.substring(0,re.length)===re;let Xt=(()=>{class S extends gt{constructor(P,ne){super(P,ne)}writeValue(P){this.el.nativeElement.checked=this.lastValue=P,Be(this.el)}_handleIonChange(P){this.handleValueChange(P,P.checked)}}return S.\u0275fac=function(P){return new(P||S)(d.Y36(d.zs3),d.Y36(d.SBq))},S.\u0275dir=d.lG2({type:S,selectors:[["ion-checkbox"],["ion-toggle"]],hostBindings:function(P,ne){1&P&&d.NdJ("ionChange",function(Ln){return ne._handleIonChange(Ln.target)})},features:[d._Bn([{provide:v.JU,useExisting:S,multi:!0}]),d.qOj]}),S})(),mn=(()=>{class S extends gt{constructor(P,ne){super(P,ne)}handleInputEvent(P){this.handleValueChange(P,P.value)}registerOnChange(P){super.registerOnChange(ne=>{P(""===ne?null:parseFloat(ne))})}}return S.\u0275fac=function(P){return new(P||S)(d.Y36(d.zs3),d.Y36(d.SBq))},S.\u0275dir=d.lG2({type:S,selectors:[["ion-input","type","number"]],hostBindings:function(P,ne){1&P&&d.NdJ("ionInput",function(Ln){return ne.handleInputEvent(Ln.target)})},features:[d._Bn([{provide:v.JU,useExisting:S,multi:!0}]),d.qOj]}),S})(),Vt=(()=>{class S extends gt{constructor(P,ne){super(P,ne)}_handleChangeEvent(P){this.handleValueChange(P,P.value)}}return S.\u0275fac=function(P){return new(P||S)(d.Y36(d.zs3),d.Y36(d.SBq))},S.\u0275dir=d.lG2({type:S,selectors:[["ion-range"],["ion-select"],["ion-radio-group"],["ion-segment"],["ion-datetime"]],hostBindings:function(P,ne){1&P&&d.NdJ("ionChange",function(Ln){return ne._handleChangeEvent(Ln.target)})},features:[d._Bn([{provide:v.JU,useExisting:S,multi:!0}]),d.qOj]}),S})(),St=(()=>{class S extends gt{constructor(P,ne){super(P,ne)}_handleInputEvent(P){this.handleValueChange(P,P.value)}}return S.\u0275fac=function(P){return new(P||S)(d.Y36(d.zs3),d.Y36(d.SBq))},S.\u0275dir=d.lG2({type:S,selectors:[["ion-input",3,"type","number"],["ion-textarea"],["ion-searchbar"]],hostBindings:function(P,ne){1&P&&d.NdJ("ionInput",function(Ln){return ne._handleInputEvent(Ln.target)})},features:[d._Bn([{provide:v.JU,useExisting:S,multi:!0}]),d.qOj]}),S})();const st=(S,re)=>{const P=S.prototype;re.forEach(ne=>{Object.defineProperty(P,ne,{get(){return this.el[ne]},set(He){this.z.runOutsideAngular(()=>this.el[ne]=He)}})})},qt=(S,re)=>{const P=S.prototype;re.forEach(ne=>{P[ne]=function(){const He=arguments;return this.z.runOutsideAngular(()=>this.el[ne].apply(this.el,He))}})},dn=(S,re,P)=>{P.forEach(ne=>S[ne]=(0,Q.R)(re,ne))};function zt(S){return function(P){const{defineCustomElementFn:ne,inputs:He,methods:Ln}=S;return void 0!==ne&&ne(),He&&st(P,He),Ln&&qt(P,Ln),P}}let Hi=(()=>{let S=class{constructor(P,ne,He){this.z=He,P.detach(),this.el=ne.nativeElement}};return S.\u0275fac=function(P){return new(P||S)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},S.\u0275cmp=d.Xpm({type:S,selectors:[["ion-app"]],ngContentSelectors:ve,decls:1,vars:0,template:function(P,ne){1&P&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),S=(0,s.gn)([zt({})],S),S})(),Fi=(()=>{let S=class{constructor(P,ne,He){this.z=He,P.detach(),this.el=ne.nativeElement}};return S.\u0275fac=function(P){return new(P||S)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},S.\u0275cmp=d.Xpm({type:S,selectors:[["ion-avatar"]],ngContentSelectors:ve,decls:1,vars:0,template:function(P,ne){1&P&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),S=(0,s.gn)([zt({})],S),S})(),ii=(()=>{let S=class{constructor(P,ne,He){this.z=He,P.detach(),this.el=ne.nativeElement}};return S.\u0275fac=function(P){return new(P||S)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},S.\u0275cmp=d.Xpm({type:S,selectors:[["ion-back-button"]],inputs:{color:"color",defaultHref:"defaultHref",disabled:"disabled",icon:"icon",mode:"mode",routerAnimation:"routerAnimation",text:"text",type:"type"},ngContentSelectors:ve,decls:1,vars:0,template:function(P,ne){1&P&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),S=(0,s.gn)([zt({inputs:["color","defaultHref","disabled","icon","mode","routerAnimation","text","type"]})],S),S})(),xn=(()=>{let S=class{constructor(P,ne,He){this.z=He,P.detach(),this.el=ne.nativeElement}};return S.\u0275fac=function(P){return new(P||S)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},S.\u0275cmp=d.Xpm({type:S,selectors:[["ion-badge"]],inputs:{color:"color",mode:"mode"},ngContentSelectors:ve,decls:1,vars:0,template:function(P,ne){1&P&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),S=(0,s.gn)([zt({inputs:["color","mode"]})],S),S})(),ge=(()=>{let S=class{constructor(P,ne,He){this.z=He,P.detach(),this.el=ne.nativeElement,dn(this,this.el,["ionFocus","ionBlur"])}};return S.\u0275fac=function(P){return new(P||S)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},S.\u0275cmp=d.Xpm({type:S,selectors:[["ion-button"]],inputs:{buttonType:"buttonType",color:"color",disabled:"disabled",download:"download",expand:"expand",fill:"fill",form:"form",href:"href",mode:"mode",rel:"rel",routerAnimation:"routerAnimation",routerDirection:"routerDirection",shape:"shape",size:"size",strong:"strong",target:"target",type:"type"},ngContentSelectors:ve,decls:1,vars:0,template:function(P,ne){1&P&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),S=(0,s.gn)([zt({inputs:["buttonType","color","disabled","download","expand","fill","form","href","mode","rel","routerAnimation","routerDirection","shape","size","strong","target","type"]})],S),S})(),ct=(()=>{let S=class{constructor(P,ne,He){this.z=He,P.detach(),this.el=ne.nativeElement}};return S.\u0275fac=function(P){return new(P||S)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},S.\u0275cmp=d.Xpm({type:S,selectors:[["ion-buttons"]],inputs:{collapse:"collapse"},ngContentSelectors:ve,decls:1,vars:0,template:function(P,ne){1&P&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),S=(0,s.gn)([zt({inputs:["collapse"]})],S),S})(),Gt=(()=>{let S=class{constructor(P,ne,He){this.z=He,P.detach(),this.el=ne.nativeElement}};return S.\u0275fac=function(P){return new(P||S)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},S.\u0275cmp=d.Xpm({type:S,selectors:[["ion-card"]],inputs:{button:"button",color:"color",disabled:"disabled",download:"download",href:"href",mode:"mode",rel:"rel",routerAnimation:"routerAnimation",routerDirection:"routerDirection",target:"target",type:"type"},ngContentSelectors:ve,decls:1,vars:0,template:function(P,ne){1&P&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),S=(0,s.gn)([zt({inputs:["button","color","disabled","download","href","mode","rel","routerAnimation","routerDirection","target","type"]})],S),S})(),pn=(()=>{let S=class{constructor(P,ne,He){this.z=He,P.detach(),this.el=ne.nativeElement}};return S.\u0275fac=function(P){return new(P||S)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},S.\u0275cmp=d.Xpm({type:S,selectors:[["ion-card-content"]],inputs:{mode:"mode"},ngContentSelectors:ve,decls:1,vars:0,template:function(P,ne){1&P&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),S=(0,s.gn)([zt({inputs:["mode"]})],S),S})(),Gi=(()=>{let S=class{constructor(P,ne,He){this.z=He,P.detach(),this.el=ne.nativeElement}};return S.\u0275fac=function(P){return new(P||S)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},S.\u0275cmp=d.Xpm({type:S,selectors:[["ion-card-header"]],inputs:{color:"color",mode:"mode",translucent:"translucent"},ngContentSelectors:ve,decls:1,vars:0,template:function(P,ne){1&P&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),S=(0,s.gn)([zt({inputs:["color","mode","translucent"]})],S),S})(),xe=(()=>{let S=class{constructor(P,ne,He){this.z=He,P.detach(),this.el=ne.nativeElement}};return S.\u0275fac=function(P){return new(P||S)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},S.\u0275cmp=d.Xpm({type:S,selectors:[["ion-col"]],inputs:{offset:"offset",offsetLg:"offsetLg",offsetMd:"offsetMd",offsetSm:"offsetSm",offsetXl:"offsetXl",offsetXs:"offsetXs",pull:"pull",pullLg:"pullLg",pullMd:"pullMd",pullSm:"pullSm",pullXl:"pullXl",pullXs:"pullXs",push:"push",pushLg:"pushLg",pushMd:"pushMd",pushSm:"pushSm",pushXl:"pushXl",pushXs:"pushXs",size:"size",sizeLg:"sizeLg",sizeMd:"sizeMd",sizeSm:"sizeSm",sizeXl:"sizeXl",sizeXs:"sizeXs"},ngContentSelectors:ve,decls:1,vars:0,template:function(P,ne){1&P&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),S=(0,s.gn)([zt({inputs:["offset","offsetLg","offsetMd","offsetSm","offsetXl","offsetXs","pull","pullLg","pullMd","pullSm","pullXl","pullXs","push","pushLg","pushMd","pushSm","pushXl","pushXs","size","sizeLg","sizeMd","sizeSm","sizeXl","sizeXs"]})],S),S})(),Qe=(()=>{let S=class{constructor(P,ne,He){this.z=He,P.detach(),this.el=ne.nativeElement,dn(this,this.el,["ionScrollStart","ionScroll","ionScrollEnd"])}};return S.\u0275fac=function(P){return new(P||S)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},S.\u0275cmp=d.Xpm({type:S,selectors:[["ion-content"]],inputs:{color:"color",forceOverscroll:"forceOverscroll",fullscreen:"fullscreen",scrollEvents:"scrollEvents",scrollX:"scrollX",scrollY:"scrollY"},ngContentSelectors:ve,decls:1,vars:0,template:function(P,ne){1&P&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),S=(0,s.gn)([zt({inputs:["color","forceOverscroll","fullscreen","scrollEvents","scrollX","scrollY"],methods:["getScrollElement","scrollToTop","scrollToBottom","scrollByPoint","scrollToPoint"]})],S),S})(),Zt=(()=>{let S=class{constructor(P,ne,He){this.z=He,P.detach(),this.el=ne.nativeElement}};return S.\u0275fac=function(P){return new(P||S)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},S.\u0275cmp=d.Xpm({type:S,selectors:[["ion-fab"]],inputs:{activated:"activated",edge:"edge",horizontal:"horizontal",vertical:"vertical"},ngContentSelectors:ve,decls:1,vars:0,template:function(P,ne){1&P&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),S=(0,s.gn)([zt({inputs:["activated","edge","horizontal","vertical"],methods:["close"]})],S),S})(),jt=(()=>{let S=class{constructor(P,ne,He){this.z=He,P.detach(),this.el=ne.nativeElement,dn(this,this.el,["ionFocus","ionBlur"])}};return S.\u0275fac=function(P){return new(P||S)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},S.\u0275cmp=d.Xpm({type:S,selectors:[["ion-fab-button"]],inputs:{activated:"activated",closeIcon:"closeIcon",color:"color",disabled:"disabled",download:"download",href:"href",mode:"mode",rel:"rel",routerAnimation:"routerAnimation",routerDirection:"routerDirection",show:"show",size:"size",target:"target",translucent:"translucent",type:"type"},ngContentSelectors:ve,decls:1,vars:0,template:function(P,ne){1&P&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),S=(0,s.gn)([zt({inputs:["activated","closeIcon","color","disabled","download","href","mode","rel","routerAnimation","routerDirection","show","size","target","translucent","type"]})],S),S})(),Pt=(()=>{let S=class{constructor(P,ne,He){this.z=He,P.detach(),this.el=ne.nativeElement}};return S.\u0275fac=function(P){return new(P||S)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},S.\u0275cmp=d.Xpm({type:S,selectors:[["ion-fab-list"]],inputs:{activated:"activated",side:"side"},ngContentSelectors:ve,decls:1,vars:0,template:function(P,ne){1&P&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),S=(0,s.gn)([zt({inputs:["activated","side"]})],S),S})(),Kt=(()=>{let S=class{constructor(P,ne,He){this.z=He,P.detach(),this.el=ne.nativeElement}};return S.\u0275fac=function(P){return new(P||S)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},S.\u0275cmp=d.Xpm({type:S,selectors:[["ion-footer"]],inputs:{collapse:"collapse",mode:"mode",translucent:"translucent"},ngContentSelectors:ve,decls:1,vars:0,template:function(P,ne){1&P&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),S=(0,s.gn)([zt({inputs:["collapse","mode","translucent"]})],S),S})(),In=(()=>{let S=class{constructor(P,ne,He){this.z=He,P.detach(),this.el=ne.nativeElement}};return S.\u0275fac=function(P){return new(P||S)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},S.\u0275cmp=d.Xpm({type:S,selectors:[["ion-grid"]],inputs:{fixed:"fixed"},ngContentSelectors:ve,decls:1,vars:0,template:function(P,ne){1&P&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),S=(0,s.gn)([zt({inputs:["fixed"]})],S),S})(),et=(()=>{let S=class{constructor(P,ne,He){this.z=He,P.detach(),this.el=ne.nativeElement}};return S.\u0275fac=function(P){return new(P||S)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},S.\u0275cmp=d.Xpm({type:S,selectors:[["ion-header"]],inputs:{collapse:"collapse",mode:"mode",translucent:"translucent"},ngContentSelectors:ve,decls:1,vars:0,template:function(P,ne){1&P&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),S=(0,s.gn)([zt({inputs:["collapse","mode","translucent"]})],S),S})(),Ue=(()=>{let S=class{constructor(P,ne,He){this.z=He,P.detach(),this.el=ne.nativeElement}};return S.\u0275fac=function(P){return new(P||S)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},S.\u0275cmp=d.Xpm({type:S,selectors:[["ion-icon"]],inputs:{color:"color",flipRtl:"flipRtl",icon:"icon",ios:"ios",lazy:"lazy",md:"md",mode:"mode",name:"name",sanitize:"sanitize",size:"size",src:"src"},ngContentSelectors:ve,decls:1,vars:0,template:function(P,ne){1&P&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),S=(0,s.gn)([zt({inputs:["color","flipRtl","icon","ios","lazy","md","mode","name","sanitize","size","src"]})],S),S})(),Ft=(()=>{let S=class{constructor(P,ne,He){this.z=He,P.detach(),this.el=ne.nativeElement,dn(this,this.el,["ionInput","ionChange","ionBlur","ionFocus"])}};return S.\u0275fac=function(P){return new(P||S)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},S.\u0275cmp=d.Xpm({type:S,selectors:[["ion-input"]],inputs:{accept:"accept",autocapitalize:"autocapitalize",autocomplete:"autocomplete",autocorrect:"autocorrect",autofocus:"autofocus",clearInput:"clearInput",clearOnEdit:"clearOnEdit",color:"color",counter:"counter",counterFormatter:"counterFormatter",debounce:"debounce",disabled:"disabled",enterkeyhint:"enterkeyhint",errorText:"errorText",fill:"fill",helperText:"helperText",inputmode:"inputmode",label:"label",labelPlacement:"labelPlacement",legacy:"legacy",max:"max",maxlength:"maxlength",min:"min",minlength:"minlength",mode:"mode",multiple:"multiple",name:"name",pattern:"pattern",placeholder:"placeholder",readonly:"readonly",required:"required",shape:"shape",size:"size",spellcheck:"spellcheck",step:"step",type:"type",value:"value"},ngContentSelectors:ve,decls:1,vars:0,template:function(P,ne){1&P&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),S=(0,s.gn)([zt({inputs:["accept","autocapitalize","autocomplete","autocorrect","autofocus","clearInput","clearOnEdit","color","counter","counterFormatter","debounce","disabled","enterkeyhint","errorText","fill","helperText","inputmode","label","labelPlacement","legacy","max","maxlength","min","minlength","mode","multiple","name","pattern","placeholder","readonly","required","shape","size","spellcheck","step","type","value"],methods:["setFocus","getInputElement"]})],S),S})(),gn=(()=>{let S=class{constructor(P,ne,He){this.z=He,P.detach(),this.el=ne.nativeElement}};return S.\u0275fac=function(P){return new(P||S)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},S.\u0275cmp=d.Xpm({type:S,selectors:[["ion-item"]],inputs:{button:"button",color:"color",counter:"counter",counterFormatter:"counterFormatter",detail:"detail",detailIcon:"detailIcon",disabled:"disabled",download:"download",fill:"fill",href:"href",lines:"lines",mode:"mode",rel:"rel",routerAnimation:"routerAnimation",routerDirection:"routerDirection",shape:"shape",target:"target",type:"type"},ngContentSelectors:ve,decls:1,vars:0,template:function(P,ne){1&P&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),S=(0,s.gn)([zt({inputs:["button","color","counter","counterFormatter","detail","detailIcon","disabled","download","fill","href","lines","mode","rel","routerAnimation","routerDirection","shape","target","type"]})],S),S})(),to=(()=>{let S=class{constructor(P,ne,He){this.z=He,P.detach(),this.el=ne.nativeElement}};return S.\u0275fac=function(P){return new(P||S)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},S.\u0275cmp=d.Xpm({type:S,selectors:[["ion-label"]],inputs:{color:"color",mode:"mode",position:"position"},ngContentSelectors:ve,decls:1,vars:0,template:function(P,ne){1&P&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),S=(0,s.gn)([zt({inputs:["color","mode","position"]})],S),S})(),nn=(()=>{let S=class{constructor(P,ne,He){this.z=He,P.detach(),this.el=ne.nativeElement}};return S.\u0275fac=function(P){return new(P||S)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},S.\u0275cmp=d.Xpm({type:S,selectors:[["ion-list"]],inputs:{inset:"inset",lines:"lines",mode:"mode"},ngContentSelectors:ve,decls:1,vars:0,template:function(P,ne){1&P&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),S=(0,s.gn)([zt({inputs:["inset","lines","mode"],methods:["closeSlidingItems"]})],S),S})(),bt=(()=>{let S=class{constructor(P,ne,He){this.z=He,P.detach(),this.el=ne.nativeElement}};return S.\u0275fac=function(P){return new(P||S)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},S.\u0275cmp=d.Xpm({type:S,selectors:[["ion-list-header"]],inputs:{color:"color",lines:"lines",mode:"mode"},ngContentSelectors:ve,decls:1,vars:0,template:function(P,ne){1&P&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),S=(0,s.gn)([zt({inputs:["color","lines","mode"]})],S),S})(),Nn=(()=>{let S=class{constructor(P,ne,He){this.z=He,P.detach(),this.el=ne.nativeElement,dn(this,this.el,["ionWillOpen","ionWillClose","ionDidOpen","ionDidClose"])}};return S.\u0275fac=function(P){return new(P||S)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},S.\u0275cmp=d.Xpm({type:S,selectors:[["ion-menu"]],inputs:{contentId:"contentId",disabled:"disabled",maxEdgeStart:"maxEdgeStart",menuId:"menuId",side:"side",swipeGesture:"swipeGesture",type:"type"},ngContentSelectors:ve,decls:1,vars:0,template:function(P,ne){1&P&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),S=(0,s.gn)([zt({inputs:["contentId","disabled","maxEdgeStart","menuId","side","swipeGesture","type"],methods:["isOpen","isActive","open","close","toggle","setOpen"]})],S),S})(),Pn=(()=>{let S=class{constructor(P,ne,He){this.z=He,P.detach(),this.el=ne.nativeElement}};return S.\u0275fac=function(P){return new(P||S)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},S.\u0275cmp=d.Xpm({type:S,selectors:[["ion-menu-button"]],inputs:{autoHide:"autoHide",color:"color",disabled:"disabled",menu:"menu",mode:"mode",type:"type"},ngContentSelectors:ve,decls:1,vars:0,template:function(P,ne){1&P&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),S=(0,s.gn)([zt({inputs:["autoHide","color","disabled","menu","mode","type"]})],S),S})(),oi=(()=>{let S=class{constructor(P,ne,He){this.z=He,P.detach(),this.el=ne.nativeElement}};return S.\u0275fac=function(P){return new(P||S)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},S.\u0275cmp=d.Xpm({type:S,selectors:[["ion-menu-toggle"]],inputs:{autoHide:"autoHide",menu:"menu"},ngContentSelectors:ve,decls:1,vars:0,template:function(P,ne){1&P&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),S=(0,s.gn)([zt({inputs:["autoHide","menu"]})],S),S})(),xi=(()=>{let S=class{constructor(P,ne,He){this.z=He,P.detach(),this.el=ne.nativeElement}};return S.\u0275fac=function(P){return new(P||S)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},S.\u0275cmp=d.Xpm({type:S,selectors:[["ion-note"]],inputs:{color:"color",mode:"mode"},ngContentSelectors:ve,decls:1,vars:0,template:function(P,ne){1&P&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),S=(0,s.gn)([zt({inputs:["color","mode"]})],S),S})(),oo=(()=>{let S=class{constructor(P,ne,He){this.z=He,P.detach(),this.el=ne.nativeElement,dn(this,this.el,["ionChange","ionInput","ionFocus","ionBlur","ionKnobMoveStart","ionKnobMoveEnd"])}};return S.\u0275fac=function(P){return new(P||S)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},S.\u0275cmp=d.Xpm({type:S,selectors:[["ion-range"]],inputs:{activeBarStart:"activeBarStart",color:"color",debounce:"debounce",disabled:"disabled",dualKnobs:"dualKnobs",label:"label",labelPlacement:"labelPlacement",legacy:"legacy",max:"max",min:"min",mode:"mode",name:"name",pin:"pin",pinFormatter:"pinFormatter",snaps:"snaps",step:"step",ticks:"ticks",value:"value"},ngContentSelectors:ve,decls:1,vars:0,template:function(P,ne){1&P&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),S=(0,s.gn)([zt({inputs:["activeBarStart","color","debounce","disabled","dualKnobs","label","labelPlacement","legacy","max","min","mode","name","pin","pinFormatter","snaps","step","ticks","value"]})],S),S})(),Ai=(()=>{let S=class{constructor(P,ne,He){this.z=He,P.detach(),this.el=ne.nativeElement,dn(this,this.el,["ionRefresh","ionPull","ionStart"])}};return S.\u0275fac=function(P){return new(P||S)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},S.\u0275cmp=d.Xpm({type:S,selectors:[["ion-refresher"]],inputs:{closeDuration:"closeDuration",disabled:"disabled",pullFactor:"pullFactor",pullMax:"pullMax",pullMin:"pullMin",snapbackDuration:"snapbackDuration"},ngContentSelectors:ve,decls:1,vars:0,template:function(P,ne){1&P&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),S=(0,s.gn)([zt({inputs:["closeDuration","disabled","pullFactor","pullMax","pullMin","snapbackDuration"],methods:["complete","cancel","getProgress"]})],S),S})(),ho=(()=>{let S=class{constructor(P,ne,He){this.z=He,P.detach(),this.el=ne.nativeElement}};return S.\u0275fac=function(P){return new(P||S)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},S.\u0275cmp=d.Xpm({type:S,selectors:[["ion-refresher-content"]],inputs:{pullingIcon:"pullingIcon",pullingText:"pullingText",refreshingSpinner:"refreshingSpinner",refreshingText:"refreshingText"},ngContentSelectors:ve,decls:1,vars:0,template:function(P,ne){1&P&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),S=(0,s.gn)([zt({inputs:["pullingIcon","pullingText","refreshingSpinner","refreshingText"]})],S),S})(),Ki=(()=>{let S=class{constructor(P,ne,He){this.z=He,P.detach(),this.el=ne.nativeElement}};return S.\u0275fac=function(P){return new(P||S)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},S.\u0275cmp=d.Xpm({type:S,selectors:[["ion-row"]],ngContentSelectors:ve,decls:1,vars:0,template:function(P,ne){1&P&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),S=(0,s.gn)([zt({})],S),S})(),gr=(()=>{let S=class{constructor(P,ne,He){this.z=He,P.detach(),this.el=ne.nativeElement,dn(this,this.el,["ionInput","ionChange","ionCancel","ionClear","ionBlur","ionFocus"])}};return S.\u0275fac=function(P){return new(P||S)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},S.\u0275cmp=d.Xpm({type:S,selectors:[["ion-searchbar"]],inputs:{animated:"animated",autocomplete:"autocomplete",autocorrect:"autocorrect",cancelButtonIcon:"cancelButtonIcon",cancelButtonText:"cancelButtonText",clearIcon:"clearIcon",color:"color",debounce:"debounce",disabled:"disabled",enterkeyhint:"enterkeyhint",inputmode:"inputmode",mode:"mode",placeholder:"placeholder",searchIcon:"searchIcon",showCancelButton:"showCancelButton",showClearButton:"showClearButton",spellcheck:"spellcheck",type:"type",value:"value"},ngContentSelectors:ve,decls:1,vars:0,template:function(P,ne){1&P&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),S=(0,s.gn)([zt({inputs:["animated","autocomplete","autocorrect","cancelButtonIcon","cancelButtonText","clearIcon","color","debounce","disabled","enterkeyhint","inputmode","mode","placeholder","searchIcon","showCancelButton","showClearButton","spellcheck","type","value"],methods:["setFocus","getInputElement"]})],S),S})(),bo=(()=>{let S=class{constructor(P,ne,He){this.z=He,P.detach(),this.el=ne.nativeElement,dn(this,this.el,["ionChange"])}};return S.\u0275fac=function(P){return new(P||S)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},S.\u0275cmp=d.Xpm({type:S,selectors:[["ion-segment"]],inputs:{color:"color",disabled:"disabled",mode:"mode",scrollable:"scrollable",selectOnFocus:"selectOnFocus",swipeGesture:"swipeGesture",value:"value"},ngContentSelectors:ve,decls:1,vars:0,template:function(P,ne){1&P&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),S=(0,s.gn)([zt({inputs:["color","disabled","mode","scrollable","selectOnFocus","swipeGesture","value"]})],S),S})(),Zr=(()=>{let S=class{constructor(P,ne,He){this.z=He,P.detach(),this.el=ne.nativeElement}};return S.\u0275fac=function(P){return new(P||S)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},S.\u0275cmp=d.Xpm({type:S,selectors:[["ion-segment-button"]],inputs:{disabled:"disabled",layout:"layout",mode:"mode",type:"type",value:"value"},ngContentSelectors:ve,decls:1,vars:0,template:function(P,ne){1&P&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),S=(0,s.gn)([zt({inputs:["disabled","layout","mode","type","value"]})],S),S})(),Mr=(()=>{let S=class{constructor(P,ne,He){this.z=He,P.detach(),this.el=ne.nativeElement,dn(this,this.el,["ionChange","ionCancel","ionDismiss","ionFocus","ionBlur"])}};return S.\u0275fac=function(P){return new(P||S)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},S.\u0275cmp=d.Xpm({type:S,selectors:[["ion-select"]],inputs:{cancelText:"cancelText",color:"color",compareWith:"compareWith",disabled:"disabled",expandedIcon:"expandedIcon",fill:"fill",interface:"interface",interfaceOptions:"interfaceOptions",justify:"justify",label:"label",labelPlacement:"labelPlacement",legacy:"legacy",mode:"mode",multiple:"multiple",name:"name",okText:"okText",placeholder:"placeholder",selectedText:"selectedText",shape:"shape",toggleIcon:"toggleIcon",value:"value"},ngContentSelectors:ve,decls:1,vars:0,template:function(P,ne){1&P&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),S=(0,s.gn)([zt({inputs:["cancelText","color","compareWith","disabled","expandedIcon","fill","interface","interfaceOptions","justify","label","labelPlacement","legacy","mode","multiple","name","okText","placeholder","selectedText","shape","toggleIcon","value"],methods:["open"]})],S),S})(),kr=(()=>{let S=class{constructor(P,ne,He){this.z=He,P.detach(),this.el=ne.nativeElement}};return S.\u0275fac=function(P){return new(P||S)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},S.\u0275cmp=d.Xpm({type:S,selectors:[["ion-select-option"]],inputs:{disabled:"disabled",value:"value"},ngContentSelectors:ve,decls:1,vars:0,template:function(P,ne){1&P&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),S=(0,s.gn)([zt({inputs:["disabled","value"]})],S),S})(),Ui=(()=>{let S=class{constructor(P,ne,He){this.z=He,P.detach(),this.el=ne.nativeElement}};return S.\u0275fac=function(P){return new(P||S)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},S.\u0275cmp=d.Xpm({type:S,selectors:[["ion-spinner"]],inputs:{color:"color",duration:"duration",name:"name",paused:"paused"},ngContentSelectors:ve,decls:1,vars:0,template:function(P,ne){1&P&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),S=(0,s.gn)([zt({inputs:["color","duration","name","paused"]})],S),S})(),ye=(()=>{let S=class{constructor(P,ne,He){this.z=He,P.detach(),this.el=ne.nativeElement,dn(this,this.el,["ionSplitPaneVisible"])}};return S.\u0275fac=function(P){return new(P||S)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},S.\u0275cmp=d.Xpm({type:S,selectors:[["ion-split-pane"]],inputs:{contentId:"contentId",disabled:"disabled",when:"when"},ngContentSelectors:ve,decls:1,vars:0,template:function(P,ne){1&P&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),S=(0,s.gn)([zt({inputs:["contentId","disabled","when"]})],S),S})(),Nt=(()=>{let S=class{constructor(P,ne,He){this.z=He,P.detach(),this.el=ne.nativeElement,dn(this,this.el,["ionChange","ionInput","ionBlur","ionFocus"])}};return S.\u0275fac=function(P){return new(P||S)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},S.\u0275cmp=d.Xpm({type:S,selectors:[["ion-textarea"]],inputs:{autoGrow:"autoGrow",autocapitalize:"autocapitalize",autofocus:"autofocus",clearOnEdit:"clearOnEdit",color:"color",cols:"cols",counter:"counter",counterFormatter:"counterFormatter",debounce:"debounce",disabled:"disabled",enterkeyhint:"enterkeyhint",errorText:"errorText",fill:"fill",helperText:"helperText",inputmode:"inputmode",label:"label",labelPlacement:"labelPlacement",legacy:"legacy",maxlength:"maxlength",minlength:"minlength",mode:"mode",name:"name",placeholder:"placeholder",readonly:"readonly",required:"required",rows:"rows",shape:"shape",spellcheck:"spellcheck",value:"value",wrap:"wrap"},ngContentSelectors:ve,decls:1,vars:0,template:function(P,ne){1&P&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),S=(0,s.gn)([zt({inputs:["autoGrow","autocapitalize","autofocus","clearOnEdit","color","cols","counter","counterFormatter","debounce","disabled","enterkeyhint","errorText","fill","helperText","inputmode","label","labelPlacement","legacy","maxlength","minlength","mode","name","placeholder","readonly","required","rows","shape","spellcheck","value","wrap"],methods:["setFocus","getInputElement"]})],S),S})(),Ut=(()=>{let S=class{constructor(P,ne,He){this.z=He,P.detach(),this.el=ne.nativeElement}};return S.\u0275fac=function(P){return new(P||S)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},S.\u0275cmp=d.Xpm({type:S,selectors:[["ion-thumbnail"]],ngContentSelectors:ve,decls:1,vars:0,template:function(P,ne){1&P&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),S=(0,s.gn)([zt({})],S),S})(),_n=(()=>{let S=class{constructor(P,ne,He){this.z=He,P.detach(),this.el=ne.nativeElement}};return S.\u0275fac=function(P){return new(P||S)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},S.\u0275cmp=d.Xpm({type:S,selectors:[["ion-title"]],inputs:{color:"color",size:"size"},ngContentSelectors:ve,decls:1,vars:0,template:function(P,ne){1&P&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),S=(0,s.gn)([zt({inputs:["color","size"]})],S),S})(),vn=(()=>{let S=class{constructor(P,ne,He){this.z=He,P.detach(),this.el=ne.nativeElement,dn(this,this.el,["ionChange","ionFocus","ionBlur"])}};return S.\u0275fac=function(P){return new(P||S)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},S.\u0275cmp=d.Xpm({type:S,selectors:[["ion-toggle"]],inputs:{checked:"checked",color:"color",disabled:"disabled",enableOnOffLabels:"enableOnOffLabels",justify:"justify",labelPlacement:"labelPlacement",legacy:"legacy",mode:"mode",name:"name",value:"value"},ngContentSelectors:ve,decls:1,vars:0,template:function(P,ne){1&P&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),S=(0,s.gn)([zt({inputs:["checked","color","disabled","enableOnOffLabels","justify","labelPlacement","legacy","mode","name","value"]})],S),S})(),On=(()=>{let S=class{constructor(P,ne,He){this.z=He,P.detach(),this.el=ne.nativeElement}};return S.\u0275fac=function(P){return new(P||S)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},S.\u0275cmp=d.Xpm({type:S,selectors:[["ion-toolbar"]],inputs:{color:"color",mode:"mode"},ngContentSelectors:ve,decls:1,vars:0,template:function(P,ne){1&P&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),S=(0,s.gn)([zt({inputs:["color","mode"]})],S),S})(),di=(()=>{class S{get(P,ne){const He=Bi();return He?He.get(P,ne):null}getBoolean(P,ne){const He=Bi();return!!He&&He.getBoolean(P,ne)}getNumber(P,ne){const He=Bi();return He?He.getNumber(P,ne):0}}return S.\u0275fac=function(P){return new(P||S)},S.\u0275prov=d.Yz7({token:S,factory:S.\u0275fac,providedIn:"root"}),S})();const Di=new d.OlP("USERCONFIG"),Bi=()=>{if(typeof window<"u"){const S=window.Ionic;if(S?.config)return S.config}return null};let Lo=(()=>{class S{constructor(P,ne){this.doc=P,this.backButton=new ie.x,this.keyboardDidShow=new ie.x,this.keyboardDidHide=new ie.x,this.pause=new ie.x,this.resume=new ie.x,this.resize=new ie.x,ne.run(()=>{let He;this.win=P.defaultView,this.backButton.subscribeWithPriority=function(Ln,Kn){return this.subscribe(zi=>zi.register(Ln,ee=>ne.run(()=>Kn(ee))))},ao(this.pause,P,"pause"),ao(this.resume,P,"resume"),ao(this.backButton,P,"ionBackButton"),ao(this.resize,this.win,"resize"),ao(this.keyboardDidShow,this.win,"ionKeyboardDidShow"),ao(this.keyboardDidHide,this.win,"ionKeyboardDidHide"),this._readyPromise=new Promise(Ln=>{He=Ln}),this.win?.cordova?P.addEventListener("deviceready",()=>{He("cordova")},{once:!0}):He("dom")})}is(P){return(0,se.a)(this.win,P)}platforms(){return(0,se.g)(this.win)}ready(){return this._readyPromise}get isRTL(){return"rtl"===this.doc.dir}getQueryParam(P){return Qi(this.win.location.href,P)}isLandscape(){return!this.isPortrait()}isPortrait(){return this.win.matchMedia?.("(orientation: portrait)").matches}testUserAgent(P){const ne=this.win.navigator;return!!(ne?.userAgent&&ne.userAgent.indexOf(P)>=0)}url(){return this.win.location.href}width(){return this.win.innerWidth}height(){return this.win.innerHeight}}return S.\u0275fac=function(P){return new(P||S)(d.LFG(ae.K0),d.LFG(d.R0b))},S.\u0275prov=d.Yz7({token:S,factory:S.\u0275fac,providedIn:"root"}),S})();const Qi=(S,re)=>{re=re.replace(/[[\]\\]/g,"\\$&");const ne=new RegExp("[\\?&]"+re+"=([^&#]*)").exec(S);return ne?decodeURIComponent(ne[1].replace(/\+/g," ")):null},ao=(S,re,P)=>{re&&re.addEventListener(P,ne=>{const He=ne?.detail;S.next(He)})};let To=(()=>{class S{constructor(P,ne,He,Ln){this.location=ne,this.serializer=He,this.router=Ln,this.direction=Wo,this.animated=dr,this.guessDirection="forward",this.lastNavId=-1,Ln&&Ln.events.subscribe(Kn=>{if(Kn instanceof y.OD){const zi=Kn.restoredState?Kn.restoredState.navigationId:Kn.id;this.guessDirection=zi<this.lastNavId?"back":"forward",this.guessAnimation=Kn.restoredState?void 0:this.guessDirection,this.lastNavId="forward"===this.guessDirection?Kn.id:zi}}),P.backButton.subscribeWithPriority(0,Kn=>{this.pop(),Kn()})}navigateForward(P,ne={}){return this.setDirection("forward",ne.animated,ne.animationDirection,ne.animation),this.navigate(P,ne)}navigateBack(P,ne={}){return this.setDirection("back",ne.animated,ne.animationDirection,ne.animation),this.navigate(P,ne)}navigateRoot(P,ne={}){return this.setDirection("root",ne.animated,ne.animationDirection,ne.animation),this.navigate(P,ne)}back(P={animated:!0,animationDirection:"back"}){return this.setDirection("back",P.animated,P.animationDirection,P.animation),this.location.back()}pop(){var P=this;return(0,x.Z)(function*(){let ne=P.topOutlet;for(;ne;){if(yield ne.pop())return!0;ne=ne.parentOutlet}return!1})()}setDirection(P,ne,He,Ln){this.direction=P,this.animated=or(P,ne,He),this.animationBuilder=Ln}setTopOutlet(P){this.topOutlet=P}consumeTransition(){let ne,P="root";const He=this.animationBuilder;return"auto"===this.direction?(P=this.guessDirection,ne=this.guessAnimation):(ne=this.animated,P=this.direction),this.direction=Wo,this.animated=dr,this.animationBuilder=void 0,{direction:P,animation:ne,animationBuilder:He}}navigate(P,ne){if(Array.isArray(P))return this.router.navigate(P,ne);{const He=this.serializer.parse(P.toString());return void 0!==ne.queryParams&&(He.queryParams={...ne.queryParams}),void 0!==ne.fragment&&(He.fragment=ne.fragment),this.router.navigateByUrl(He,ne)}}}return S.\u0275fac=function(P){return new(P||S)(d.LFG(Lo),d.LFG(ae.Ye),d.LFG(y.Hx),d.LFG(y.F0,8))},S.\u0275prov=d.Yz7({token:S,factory:S.\u0275fac,providedIn:"root"}),S})();const or=(S,re,P)=>{if(!1!==re){if(void 0!==P)return P;if("forward"===S||"back"===S)return S;if("root"===S&&!0===re)return"forward"}},Wo="auto",dr=void 0;class Co{constructor(re={}){this.data=re}get(re){return this.data[re]}}let xs=(()=>{class S{constructor(){this.zone=(0,d.f3M)(d.R0b),this.applicationRef=(0,d.f3M)(d.z2F)}create(P,ne,He){return new ea(P,ne,this.applicationRef,this.zone,He)}}return S.\u0275fac=function(P){return new(P||S)},S.\u0275prov=d.Yz7({token:S,factory:S.\u0275fac}),S})();class ea{constructor(re,P,ne,He,Ln){this.environmentInjector=re,this.injector=P,this.applicationRef=ne,this.zone=He,this.elementReferenceKey=Ln,this.elRefMap=new WeakMap,this.elEventsMap=new WeakMap}attachViewToDom(re,P,ne,He){return this.zone.run(()=>new Promise(Ln=>{const Kn={...ne};void 0!==this.elementReferenceKey&&(Kn[this.elementReferenceKey]=re),Ln(hr(this.zone,this.environmentInjector,this.injector,this.applicationRef,this.elRefMap,this.elEventsMap,re,P,Kn,He,this.elementReferenceKey))}))}removeViewFromDom(re,P){return this.zone.run(()=>new Promise(ne=>{const He=this.elRefMap.get(P);if(He){He.destroy(),this.elRefMap.delete(P);const Ln=this.elEventsMap.get(P);Ln&&(Ln(),this.elEventsMap.delete(P))}ne()}))}}const hr=(S,re,P,ne,He,Ln,Kn,zi,ee,J,G)=>{const ke=d.zs3.create({providers:Li(ee),parent:P}),bn=(0,d.LMc)(zi,{environmentInjector:re,elementInjector:ke}),hi=bn.instance,sr=bn.location.nativeElement;if(ee&&(G&&void 0!==hi[G]&&console.error(`[Ionic Error]: ${G} is a reserved property when using ${Kn.tagName.toLowerCase()}. Rename or remove the "${G}" property from ${zi.name}.`),Object.assign(hi,ee)),J)for(const Ws of J)sr.classList.add(Ws);const hs=pi(S,hi,sr);return Kn.appendChild(sr),ne.attachView(bn.hostView),He.set(sr,bn),Ln.set(sr,hs),sr},wo=[be.L,be.a,be.b,be.c,be.d],pi=(S,re,P)=>S.run(()=>{const ne=wo.filter(He=>"function"==typeof re[He]).map(He=>{const Ln=Kn=>re[He](Kn.detail);return P.addEventListener(He,Ln),()=>P.removeEventListener(He,Ln)});return()=>ne.forEach(He=>He())}),Ri=new d.OlP("NavParamsToken"),Li=S=>[{provide:Ri,useValue:S},{provide:Co,useFactory:er,deps:[Ri]}],er=S=>new Co(S),jo=(S,re)=>((S=S.filter(P=>P.stackId!==re.stackId)).push(re),S),Ur=(S,re)=>{const P=S.createUrlTree(["."],{relativeTo:re});return S.serializeUrl(P)},Si=(S,re)=>{if(!S)return;const P=us(re);for(let ne=0;ne<P.length;ne++){if(ne>=S.length)return P[ne];if(P[ne]!==S[ne])return}},us=S=>S.split("/").map(re=>re.trim()).filter(re=>""!==re),ta=S=>{S&&(S.ref.destroy(),S.unlistenEvents())};class Xr{constructor(re,P,ne,He,Ln,Kn){this.containerEl=P,this.router=ne,this.navCtrl=He,this.zone=Ln,this.location=Kn,this.views=[],this.skipTransition=!1,this.nextId=0,this.tabsPrefix=void 0!==re?us(re):void 0}createView(re,P){const ne=Ur(this.router,P),He=re?.location?.nativeElement,Ln=pi(this.zone,re.instance,He);return{id:this.nextId++,stackId:Si(this.tabsPrefix,ne),unlistenEvents:Ln,element:He,ref:re,url:ne}}getExistingView(re){const P=Ur(this.router,re),ne=this.views.find(He=>He.url===P);return ne&&ne.ref.changeDetectorRef.reattach(),ne}setActive(re){const P=this.navCtrl.consumeTransition();let{direction:ne,animation:He,animationBuilder:Ln}=P;const Kn=this.activeView,zi=((S,re)=>!re||S.stackId!==re.stackId)(re,Kn);zi&&(ne="back",He=void 0);const ee=this.views.slice();let J;const G=this.router;G.getCurrentNavigation?J=G.getCurrentNavigation():G.navigations?.value&&(J=G.navigations.value),J?.extras?.replaceUrl&&this.views.length>0&&this.views.splice(-1,1);const ke=this.views.includes(re),bn=this.insertView(re,ne);ke||re.ref.changeDetectorRef.detectChanges();const hi=re.animationBuilder;return void 0===Ln&&"back"===ne&&!zi&&void 0!==hi&&(Ln=hi),Kn&&(Kn.animationBuilder=Ln),this.zone.runOutsideAngular(()=>this.wait(()=>(Kn&&Kn.ref.changeDetectorRef.detach(),re.ref.changeDetectorRef.reattach(),this.transition(re,Kn,He,this.canGoBack(1),!1,Ln).then(()=>ko(re,bn,ee,this.location,this.zone)).then(()=>({enteringView:re,direction:ne,animation:He,tabSwitch:zi})))))}canGoBack(re,P=this.getActiveStackId()){return this.getStack(P).length>re}pop(re,P=this.getActiveStackId()){return this.zone.run(()=>{const ne=this.getStack(P);if(ne.length<=re)return Promise.resolve(!1);const He=ne[ne.length-re-1];let Ln=He.url;const Kn=He.savedData;if(Kn){const ee=Kn.get("primary");ee?.route?._routerState?.snapshot.url&&(Ln=ee.route._routerState.snapshot.url)}const{animationBuilder:zi}=this.navCtrl.consumeTransition();return this.navCtrl.navigateBack(Ln,{...He.savedExtras,animation:zi}).then(()=>!0)})}startBackTransition(){const re=this.activeView;if(re){const P=this.getStack(re.stackId),ne=P[P.length-2],He=ne.animationBuilder;return this.wait(()=>this.transition(ne,re,"back",this.canGoBack(2),!0,He))}return Promise.resolve()}endBackTransition(re){re?(this.skipTransition=!0,this.pop(1)):this.activeView&&Ir(this.activeView,this.views,this.views,this.location,this.zone)}getLastUrl(re){const P=this.getStack(re);return P.length>0?P[P.length-1]:void 0}getRootUrl(re){const P=this.getStack(re);return P.length>0?P[0]:void 0}getActiveStackId(){return this.activeView?this.activeView.stackId:void 0}hasRunningTask(){return void 0!==this.runningTask}destroy(){this.containerEl=void 0,this.views.forEach(ta),this.activeView=void 0,this.views=[]}getStack(re){return this.views.filter(P=>P.stackId===re)}insertView(re,P){return this.activeView=re,this.views=((S,re,P)=>"root"===P?jo(S,re):"forward"===P?((S,re)=>(S.indexOf(re)>=0?S=S.filter(ne=>ne.stackId!==re.stackId||ne.id<=re.id):S.push(re),S))(S,re):((S,re)=>S.indexOf(re)>=0?S.filter(ne=>ne.stackId!==re.stackId||ne.id<=re.id):jo(S,re))(S,re))(this.views,re,P),this.views.slice()}transition(re,P,ne,He,Ln,Kn){if(this.skipTransition)return this.skipTransition=!1,Promise.resolve(!1);if(P===re)return Promise.resolve(!1);const zi=re?re.element:void 0,ee=P?P.element:void 0,J=this.containerEl;return zi&&zi!==ee&&(zi.classList.add("ion-page"),zi.classList.add("ion-page-invisible"),zi.parentElement!==J&&J.appendChild(zi),J.commit)?J.commit(zi,ee,{duration:void 0===ne?0:void 0,direction:ne,showGoBack:He,progressAnimation:Ln,animationBuilder:Kn}):Promise.resolve(!1)}wait(re){var P=this;return(0,x.Z)(function*(){void 0!==P.runningTask&&(yield P.runningTask,P.runningTask=void 0);const ne=P.runningTask=re();return ne.finally(()=>P.runningTask=void 0),ne})()}}const ko=(S,re,P,ne,He)=>"function"==typeof requestAnimationFrame?new Promise(Ln=>{requestAnimationFrame(()=>{Ir(S,re,P,ne,He),Ln()})}):Promise.resolve(),Ir=(S,re,P,ne,He)=>{He.run(()=>P.filter(Ln=>!re.includes(Ln)).forEach(ta)),re.forEach(Ln=>{const zi=ne.path().split("?")[0].split("#")[0];if(Ln!==S&&Ln.url!==zi){const ee=Ln.element;ee.setAttribute("aria-hidden","true"),ee.classList.add("ion-page-hidden"),Ln.ref.changeDetectorRef.detach()}})};let Fr=(()=>{class S{constructor(P,ne,He,Ln,Kn,zi,ee,J){this.parentOutlet=J,this.activated=null,this.activatedView=null,this._activatedRoute=null,this.proxyMap=new WeakMap,this.currentActivatedRoute$=new q.X(null),this.stackEvents=new d.vpe,this.activateEvents=new d.vpe,this.deactivateEvents=new d.vpe,this.parentContexts=(0,d.f3M)(y.y6),this.location=(0,d.f3M)(d.s_b),this.environmentInjector=(0,d.f3M)(d.lqb),this.config=(0,d.f3M)(di),this.navCtrl=(0,d.f3M)(To),this.nativeEl=Ln.nativeElement,this.name=P||y.eC,this.tabsPrefix="true"===ne?Ur(Kn,ee):void 0,this.stackCtrl=new Xr(this.tabsPrefix,this.nativeEl,Kn,this.navCtrl,zi,He),this.parentContexts.onChildOutletCreated(this.name,this)}set animation(P){this.nativeEl.animation=P}set animated(P){this.nativeEl.animated=P}set swipeGesture(P){this._swipeGesture=P,this.nativeEl.swipeHandler=P?{canStart:()=>this.stackCtrl.canGoBack(1)&&!this.stackCtrl.hasRunningTask(),onStart:()=>this.stackCtrl.startBackTransition(),onEnd:ne=>this.stackCtrl.endBackTransition(ne)}:void 0}ngOnDestroy(){this.stackCtrl.destroy()}getContext(){return this.parentContexts.getContext(this.name)}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(!this.activated){const P=this.getContext();P?.route&&this.activateWith(P.route,P.injector)}new Promise(P=>(0,Ee.c)(this.nativeEl,P)).then(()=>{void 0===this._swipeGesture&&(this.swipeGesture=this.config.getBoolean("swipeBackEnabled","ios"===this.nativeEl.mode))})}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Error("Outlet is not activated");return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Error("Outlet is not activated");return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){throw new Error("incompatible reuse strategy")}attach(P,ne){throw new Error("incompatible reuse strategy")}deactivate(){if(this.activated){if(this.activatedView){const ne=this.getContext();this.activatedView.savedData=new Map(ne.children.contexts);const He=this.activatedView.savedData.get("primary");if(He&&ne.route&&(He.route={...ne.route}),this.activatedView.savedExtras={},ne.route){const Ln=ne.route.snapshot;this.activatedView.savedExtras.queryParams=Ln.queryParams,this.activatedView.savedExtras.fragment=Ln.fragment}}const P=this.component;this.activatedView=null,this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(P)}}activateWith(P,ne){if(this.isActivated)throw new Error("Cannot activate an already activated outlet");this._activatedRoute=P;let He,Ln=this.stackCtrl.getExistingView(P);if(Ln){He=this.activated=Ln.ref;const Kn=Ln.savedData;Kn&&(this.getContext().children.contexts=Kn),this.updateActivatedRouteProxy(He.instance,P)}else{const Kn=P._futureSnapshot,zi=this.parentContexts.getOrCreateContext(this.name).children,ee=new q.X(null),J=this.createActivatedRouteProxy(ee,P),G=new Br(J,zi,this.location.injector);He=this.activated=this.location.createComponent(Kn.routeConfig.component??Kn.component,{index:this.location.length,injector:G,environmentInjector:ne??this.environmentInjector}),ee.next(He.instance),Ln=this.stackCtrl.createView(this.activated,P),this.proxyMap.set(He.instance,J),this.currentActivatedRoute$.next({component:He.instance,activatedRoute:P})}this.activatedView=Ln,this.navCtrl.setTopOutlet(this),this.stackCtrl.setActive(Ln).then(Kn=>{this.activateEvents.emit(He.instance),this.stackEvents.emit(Kn)})}canGoBack(P=1,ne){return this.stackCtrl.canGoBack(P,ne)}pop(P=1,ne){return this.stackCtrl.pop(P,ne)}getLastUrl(P){const ne=this.stackCtrl.getLastUrl(P);return ne?ne.url:void 0}getLastRouteView(P){return this.stackCtrl.getLastUrl(P)}getRootView(P){return this.stackCtrl.getRootUrl(P)}getActiveStackId(){return this.stackCtrl.getActiveStackId()}createActivatedRouteProxy(P,ne){const He=new y.gz;return He._futureSnapshot=ne._futureSnapshot,He._routerState=ne._routerState,He.snapshot=ne.snapshot,He.outlet=ne.outlet,He.component=ne.component,He._paramMap=this.proxyObservable(P,"paramMap"),He._queryParamMap=this.proxyObservable(P,"queryParamMap"),He.url=this.proxyObservable(P,"url"),He.params=this.proxyObservable(P,"params"),He.queryParams=this.proxyObservable(P,"queryParams"),He.fragment=this.proxyObservable(P,"fragment"),He.data=this.proxyObservable(P,"data"),He}proxyObservable(P,ne){return P.pipe((0,it.h)(He=>!!He),(0,Xe.w)(He=>this.currentActivatedRoute$.pipe((0,it.h)(Ln=>null!==Ln&&Ln.component===He),(0,Xe.w)(Ln=>Ln&&Ln.activatedRoute[ne]),(0,Te.x)())))}updateActivatedRouteProxy(P,ne){const He=this.proxyMap.get(P);if(!He)throw new Error("Could not find activated route proxy for view");He._futureSnapshot=ne._futureSnapshot,He._routerState=ne._routerState,He.snapshot=ne.snapshot,He.outlet=ne.outlet,He.component=ne.component,this.currentActivatedRoute$.next({component:P,activatedRoute:ne})}}return S.\u0275fac=function(P){return new(P||S)(d.$8M("name"),d.$8M("tabs"),d.Y36(ae.Ye),d.Y36(d.SBq),d.Y36(y.F0),d.Y36(d.R0b),d.Y36(y.gz),d.Y36(S,12))},S.\u0275dir=d.lG2({type:S,selectors:[["ion-router-outlet"]],inputs:{animated:"animated",animation:"animation",mode:"mode",swipeGesture:"swipeGesture"},outputs:{stackEvents:"stackEvents",activateEvents:"activate",deactivateEvents:"deactivate"},exportAs:["outlet"]}),S})();class Br{constructor(re,P,ne){this.route=re,this.childContexts=P,this.parent=ne}get(re,P){return re===y.gz?this.route:re===y.y6?this.childContexts:this.parent.get(re,P)}}let bs=(()=>{class S{constructor(P,ne,He){this.routerOutlet=P,this.navCtrl=ne,this.config=He}onClick(P){const ne=this.defaultHref||this.config.get("backButtonDefaultHref");this.routerOutlet?.canGoBack()?(this.navCtrl.setDirection("back",void 0,void 0,this.routerAnimation),this.routerOutlet.pop(),P.preventDefault()):null!=ne&&(this.navCtrl.navigateBack(ne,{animation:this.routerAnimation}),P.preventDefault())}}return S.\u0275fac=function(P){return new(P||S)(d.Y36(Fr,8),d.Y36(To),d.Y36(di))},S.\u0275dir=d.lG2({type:S,selectors:[["ion-back-button"]],hostBindings:function(P,ne){1&P&&d.NdJ("click",function(Ln){return ne.onClick(Ln)})},inputs:{defaultHref:"defaultHref",routerAnimation:"routerAnimation"}}),S})(),Ar=(()=>{class S{constructor(P,ne,He,Ln,Kn){this.locationStrategy=P,this.navCtrl=ne,this.elementRef=He,this.router=Ln,this.routerLink=Kn,this.routerDirection="forward"}ngOnInit(){this.updateTargetUrlAndHref()}ngOnChanges(){this.updateTargetUrlAndHref()}updateTargetUrlAndHref(){if(this.routerLink?.urlTree){const P=this.locationStrategy.prepareExternalUrl(this.router.serializeUrl(this.routerLink.urlTree));this.elementRef.nativeElement.href=P}}onClick(P){this.navCtrl.setDirection(this.routerDirection,void 0,void 0,this.routerAnimation),P.preventDefault()}}return S.\u0275fac=function(P){return new(P||S)(d.Y36(ae.S$),d.Y36(To),d.Y36(d.SBq),d.Y36(y.F0),d.Y36(y.rH,8))},S.\u0275dir=d.lG2({type:S,selectors:[["","routerLink","",5,"a",5,"area"]],hostBindings:function(P,ne){1&P&&d.NdJ("click",function(Ln){return ne.onClick(Ln)})},inputs:{routerDirection:"routerDirection",routerAnimation:"routerAnimation"},features:[d.TTD]}),S})();class ds{constructor(re){this.ctrl=re}create(re){return this.ctrl.create(re||{})}dismiss(re,P,ne){return this.ctrl.dismiss(re,P,ne)}getTop(){return this.ctrl.getTop()}}let na=(()=>{class S extends ds{constructor(){super(Ne.b)}}return S.\u0275fac=function(P){return new(P||S)},S.\u0275prov=d.Yz7({token:S,factory:S.\u0275fac,providedIn:"root"}),S})(),Ss=(()=>{class S extends ds{constructor(){super(Ne.a)}}return S.\u0275fac=function(P){return new(P||S)},S.\u0275prov=d.Yz7({token:S,factory:S.\u0275fac,providedIn:"root"}),S})(),Sr=(()=>{class S extends ds{constructor(){super(Ne.l)}}return S.\u0275fac=function(P){return new(P||S)},S.\u0275prov=d.Yz7({token:S,factory:S.\u0275fac,providedIn:"root"}),S})(),Ps=(()=>{class S extends ds{constructor(){super(Ne.m),this.angularDelegate=(0,d.f3M)(xs),this.injector=(0,d.f3M)(d.zs3),this.environmentInjector=(0,d.f3M)(d.lqb)}create(P){return super.create({...P,delegate:this.angularDelegate.create(this.environmentInjector,this.injector,"modal")})}}return S.\u0275fac=function(P){return new(P||S)},S.\u0275prov=d.Yz7({token:S,factory:S.\u0275fac}),S})(),wr=(()=>{class S extends ds{constructor(){super(Ne.c),this.angularDelegate=(0,d.f3M)(xs),this.injector=(0,d.f3M)(d.zs3),this.environmentInjector=(0,d.f3M)(d.lqb)}create(P){return super.create({...P,delegate:this.angularDelegate.create(this.environmentInjector,this.injector,"popover")})}}return S.\u0275fac=function(P){return new(P||S)},S.\u0275prov=d.Yz7({token:S,factory:S.\u0275fac}),S})(),Wa=(()=>{class S extends ds{constructor(){super(Ne.t)}}return S.\u0275fac=function(P){return new(P||S)},S.\u0275prov=d.Yz7({token:S,factory:S.\u0275fac,providedIn:"root"}),S})();class Ts{shouldDetach(re){return!1}shouldAttach(re){return!1}store(re,P){}retrieve(re){return null}shouldReuseRoute(re,P){if(re.routeConfig!==P.routeConfig)return!1;const ne=re.params,He=P.params,Ln=Object.keys(ne),Kn=Object.keys(He);if(Ln.length!==Kn.length)return!1;for(const zi of Ln)if(He[zi]!==ne[zi])return!1;return!0}}const pr=(S,re,P)=>()=>{if(re.defaultView&&typeof window<"u"){(0,_e.s)({...S,_zoneGate:Ln=>P.run(Ln)});const He="__zone_symbol__addEventListener"in re.body?"__zone_symbol__addEventListener":"addEventListener";return function yt(){var S=[];if(typeof window<"u"){var re=window;(!re.customElements||re.Element&&(!re.Element.prototype.closest||!re.Element.prototype.matches||!re.Element.prototype.remove||!re.Element.prototype.getRootNode))&&S.push(R.e(6748).then(R.t.bind(R,3342,23))),("function"!=typeof Object.assign||!Object.entries||!Array.prototype.find||!Array.prototype.includes||!String.prototype.startsWith||!String.prototype.endsWith||re.NodeList&&!re.NodeList.prototype.forEach||!re.fetch||!function(){try{var ne=new URL("b","http://a");return ne.pathname="c%20d","http://a/c%20d"===ne.href&&ne.searchParams}catch{return!1}}()||typeof WeakMap>"u")&&S.push(R.e(2214).then(R.t.bind(R,2668,23)))}return Promise.all(S)}().then(()=>((S,re)=>typeof window>"u"?Promise.resolve():(0,Je.p)().then(()=>(we(),(0,Je.b)(JSON.parse('[["ion-menu_3",[[33,"ion-menu-button",{"color":[513],"disabled":[4],"menu":[1],"autoHide":[4,"auto-hide"],"type":[1],"visible":[32]},[[16,"ionMenuChange","visibilityChanged"],[16,"ionSplitPaneVisible","visibilityChanged"]]],[33,"ion-menu",{"contentId":[513,"content-id"],"menuId":[513,"menu-id"],"type":[1025],"disabled":[1028],"side":[513],"swipeGesture":[4,"swipe-gesture"],"maxEdgeStart":[2,"max-edge-start"],"isPaneVisible":[32],"isEndSide":[32],"isOpen":[64],"isActive":[64],"open":[64],"close":[64],"toggle":[64],"setOpen":[64]},[[16,"ionSplitPaneVisible","onSplitPaneChanged"],[2,"click","onBackdropClick"],[0,"keydown","onKeydown"]]],[1,"ion-menu-toggle",{"menu":[1],"autoHide":[4,"auto-hide"],"visible":[32]},[[16,"ionMenuChange","visibilityChanged"],[16,"ionSplitPaneVisible","visibilityChanged"]]]]],["ion-fab_3",[[33,"ion-fab-button",{"color":[513],"activated":[4],"disabled":[4],"download":[1],"href":[1],"rel":[1],"routerDirection":[1,"router-direction"],"routerAnimation":[16],"target":[1],"show":[4],"translucent":[4],"type":[1],"size":[1],"closeIcon":[1,"close-icon"]}],[1,"ion-fab",{"horizontal":[1],"vertical":[1],"edge":[4],"activated":[1028],"close":[64],"toggle":[64]}],[1,"ion-fab-list",{"activated":[4],"side":[1]}]]],["ion-refresher_2",[[0,"ion-refresher-content",{"pullingIcon":[1025,"pulling-icon"],"pullingText":[1,"pulling-text"],"refreshingSpinner":[1025,"refreshing-spinner"],"refreshingText":[1,"refreshing-text"]}],[32,"ion-refresher",{"pullMin":[2,"pull-min"],"pullMax":[2,"pull-max"],"closeDuration":[1,"close-duration"],"snapbackDuration":[1,"snapback-duration"],"pullFactor":[2,"pull-factor"],"disabled":[4],"nativeRefresher":[32],"state":[32],"complete":[64],"cancel":[64],"getProgress":[64]}]]],["ion-back-button",[[33,"ion-back-button",{"color":[513],"defaultHref":[1025,"default-href"],"disabled":[516],"icon":[1],"text":[1],"type":[1],"routerAnimation":[16]}]]],["ion-toast",[[33,"ion-toast",{"overlayIndex":[2,"overlay-index"],"delegate":[16],"hasController":[4,"has-controller"],"color":[513],"enterAnimation":[16],"leaveAnimation":[16],"cssClass":[1,"css-class"],"duration":[2],"header":[1],"layout":[1],"message":[1],"keyboardClose":[4,"keyboard-close"],"position":[1],"buttons":[16],"translucent":[4],"animated":[4],"icon":[1],"htmlAttributes":[16],"isOpen":[4,"is-open"],"trigger":[1],"revealContentToScreenReader":[32],"present":[64],"dismiss":[64],"onDidDismiss":[64],"onWillDismiss":[64]}]]],["ion-card_5",[[33,"ion-card",{"color":[513],"button":[4],"type":[1],"disabled":[4],"download":[1],"href":[1],"rel":[1],"routerDirection":[1,"router-direction"],"routerAnimation":[16],"target":[1]}],[32,"ion-card-content"],[33,"ion-card-header",{"color":[513],"translucent":[4]}],[33,"ion-card-subtitle",{"color":[513]}],[33,"ion-card-title",{"color":[513]}]]],["ion-item-option_3",[[33,"ion-item-option",{"color":[513],"disabled":[4],"download":[1],"expandable":[4],"href":[1],"rel":[1],"target":[1],"type":[1]}],[32,"ion-item-options",{"side":[1],"fireSwipeEvent":[64]}],[0,"ion-item-sliding",{"disabled":[4],"state":[32],"getOpenAmount":[64],"getSlidingRatio":[64],"open":[64],"close":[64],"closeOpened":[64]}]]],["ion-accordion_2",[[49,"ion-accordion",{"value":[1],"disabled":[4],"readonly":[4],"toggleIcon":[1,"toggle-icon"],"toggleIconSlot":[1,"toggle-icon-slot"],"state":[32],"isNext":[32],"isPrevious":[32]}],[33,"ion-accordion-group",{"animated":[4],"multiple":[4],"value":[1025],"disabled":[4],"readonly":[4],"expand":[1],"requestAccordionToggle":[64],"getAccordions":[64]},[[0,"keydown","onKeydown"]]]]],["ion-infinite-scroll_2",[[32,"ion-infinite-scroll-content",{"loadingSpinner":[1025,"loading-spinner"],"loadingText":[1,"loading-text"]}],[0,"ion-infinite-scroll",{"threshold":[1],"disabled":[4],"position":[1],"isLoading":[32],"complete":[64]}]]],["ion-reorder_2",[[33,"ion-reorder",null,[[2,"click","onClick"]]],[0,"ion-reorder-group",{"disabled":[4],"state":[32],"complete":[64]}]]],["ion-segment_2",[[33,"ion-segment-button",{"disabled":[1028],"layout":[1],"type":[1],"value":[8],"checked":[32],"setFocus":[64]}],[33,"ion-segment",{"color":[513],"disabled":[4],"scrollable":[4],"swipeGesture":[4,"swipe-gesture"],"value":[1032],"selectOnFocus":[4,"select-on-focus"],"activated":[32]},[[0,"keydown","onKeyDown"]]]]],["ion-tab-bar_2",[[33,"ion-tab-button",{"disabled":[4],"download":[1],"href":[1],"rel":[1],"layout":[1025],"selected":[1028],"tab":[1],"target":[1]},[[8,"ionTabBarChanged","onTabBarChanged"]]],[33,"ion-tab-bar",{"color":[513],"selectedTab":[1,"selected-tab"],"translucent":[4],"keyboardVisible":[32]}]]],["ion-chip",[[1,"ion-chip",{"color":[513],"outline":[4],"disabled":[4]}]]],["ion-datetime-button",[[33,"ion-datetime-button",{"color":[513],"disabled":[516],"datetime":[1],"datetimePresentation":[32],"dateText":[32],"timeText":[32],"datetimeActive":[32],"selectedButton":[32]}]]],["ion-input",[[38,"ion-input",{"color":[513],"accept":[1],"autocapitalize":[1],"autocomplete":[1],"autocorrect":[1],"autofocus":[4],"clearInput":[4,"clear-input"],"clearOnEdit":[4,"clear-on-edit"],"counter":[4],"counterFormatter":[16],"debounce":[2],"disabled":[4],"enterkeyhint":[1],"errorText":[1,"error-text"],"fill":[1],"inputmode":[1],"helperText":[1,"helper-text"],"label":[1],"labelPlacement":[1,"label-placement"],"legacy":[4],"max":[8],"maxlength":[2],"min":[8],"minlength":[2],"multiple":[4],"name":[1],"pattern":[1],"placeholder":[1],"readonly":[4],"required":[4],"shape":[1],"spellcheck":[4],"step":[1],"size":[2],"type":[1],"value":[1032],"hasFocus":[32],"setFocus":[64],"getInputElement":[64]}]]],["ion-searchbar",[[34,"ion-searchbar",{"color":[513],"animated":[4],"autocomplete":[1],"autocorrect":[1],"cancelButtonIcon":[1,"cancel-button-icon"],"cancelButtonText":[1,"cancel-button-text"],"clearIcon":[1,"clear-icon"],"debounce":[2],"disabled":[4],"inputmode":[1],"enterkeyhint":[1],"placeholder":[1],"searchIcon":[1,"search-icon"],"showCancelButton":[1,"show-cancel-button"],"showClearButton":[1,"show-clear-button"],"spellcheck":[4],"type":[1],"value":[1025],"focused":[32],"noAnimate":[32],"setFocus":[64],"getInputElement":[64]}]]],["ion-toggle",[[33,"ion-toggle",{"color":[513],"name":[1],"checked":[1028],"disabled":[4],"value":[1],"enableOnOffLabels":[4,"enable-on-off-labels"],"labelPlacement":[1,"label-placement"],"legacy":[4],"justify":[1],"activated":[32]}]]],["ion-nav_2",[[1,"ion-nav",{"delegate":[16],"swipeGesture":[1028,"swipe-gesture"],"animated":[4],"animation":[16],"rootParams":[16],"root":[1],"push":[64],"insert":[64],"insertPages":[64],"pop":[64],"popTo":[64],"popToRoot":[64],"removeIndex":[64],"setRoot":[64],"setPages":[64],"setRouteId":[64],"getRouteId":[64],"getActive":[64],"getByIndex":[64],"canGoBack":[64],"getPrevious":[64]}],[0,"ion-nav-link",{"component":[1],"componentProps":[16],"routerDirection":[1,"router-direction"],"routerAnimation":[16]}]]],["ion-textarea",[[38,"ion-textarea",{"color":[513],"autocapitalize":[1],"autofocus":[4],"clearOnEdit":[4,"clear-on-edit"],"debounce":[2],"disabled":[4],"fill":[1],"inputmode":[1],"enterkeyhint":[1],"maxlength":[2],"minlength":[2],"name":[1],"placeholder":[1],"readonly":[4],"required":[4],"spellcheck":[4],"cols":[2],"rows":[2],"wrap":[1],"autoGrow":[516,"auto-grow"],"value":[1025],"counter":[4],"counterFormatter":[16],"errorText":[1,"error-text"],"helperText":[1,"helper-text"],"label":[1],"labelPlacement":[1,"label-placement"],"legacy":[4],"shape":[1],"hasFocus":[32],"setFocus":[64],"getInputElement":[64]}]]],["ion-backdrop",[[33,"ion-backdrop",{"visible":[4],"tappable":[4],"stopPropagation":[4,"stop-propagation"]},[[2,"click","onMouseDown"]]]]],["ion-loading",[[34,"ion-loading",{"overlayIndex":[2,"overlay-index"],"delegate":[16],"hasController":[4,"has-controller"],"keyboardClose":[4,"keyboard-close"],"enterAnimation":[16],"leaveAnimation":[16],"message":[1],"cssClass":[1,"css-class"],"duration":[2],"backdropDismiss":[4,"backdrop-dismiss"],"showBackdrop":[4,"show-backdrop"],"spinner":[1025],"translucent":[4],"animated":[4],"htmlAttributes":[16],"isOpen":[4,"is-open"],"trigger":[1],"present":[64],"dismiss":[64],"onDidDismiss":[64],"onWillDismiss":[64]}]]],["ion-breadcrumb_2",[[33,"ion-breadcrumb",{"collapsed":[4],"last":[4],"showCollapsedIndicator":[4,"show-collapsed-indicator"],"color":[1],"active":[4],"disabled":[4],"download":[1],"href":[1],"rel":[1],"separator":[4],"target":[1],"routerDirection":[1,"router-direction"],"routerAnimation":[16]}],[33,"ion-breadcrumbs",{"color":[513],"maxItems":[2,"max-items"],"itemsBeforeCollapse":[2,"items-before-collapse"],"itemsAfterCollapse":[2,"items-after-collapse"],"collapsed":[32],"activeChanged":[32]},[[0,"collapsedClick","onCollapsedClick"]]]]],["ion-modal",[[33,"ion-modal",{"hasController":[4,"has-controller"],"overlayIndex":[2,"overlay-index"],"delegate":[16],"keyboardClose":[4,"keyboard-close"],"enterAnimation":[16],"leaveAnimation":[16],"breakpoints":[16],"initialBreakpoint":[2,"initial-breakpoint"],"backdropBreakpoint":[2,"backdrop-breakpoint"],"handle":[4],"handleBehavior":[1,"handle-behavior"],"component":[1],"componentProps":[16],"cssClass":[1,"css-class"],"backdropDismiss":[4,"backdrop-dismiss"],"showBackdrop":[4,"show-backdrop"],"animated":[4],"presentingElement":[16],"htmlAttributes":[16],"isOpen":[4,"is-open"],"trigger":[1],"keepContentsMounted":[4,"keep-contents-mounted"],"canDismiss":[4,"can-dismiss"],"presented":[32],"present":[64],"dismiss":[64],"onDidDismiss":[64],"onWillDismiss":[64],"setCurrentBreakpoint":[64],"getCurrentBreakpoint":[64]}]]],["ion-route_4",[[0,"ion-route",{"url":[1],"component":[1],"componentProps":[16],"beforeLeave":[16],"beforeEnter":[16]}],[0,"ion-route-redirect",{"from":[1],"to":[1]}],[0,"ion-router",{"root":[1],"useHash":[4,"use-hash"],"canTransition":[64],"push":[64],"back":[64],"printDebug":[64],"navChanged":[64]},[[8,"popstate","onPopState"],[4,"ionBackButton","onBackButton"]]],[1,"ion-router-link",{"color":[513],"href":[1],"rel":[1],"routerDirection":[1,"router-direction"],"routerAnimation":[16],"target":[1]}]]],["ion-avatar_3",[[33,"ion-avatar"],[33,"ion-badge",{"color":[513]}],[1,"ion-thumbnail"]]],["ion-col_3",[[1,"ion-col",{"offset":[1],"offsetXs":[1,"offset-xs"],"offsetSm":[1,"offset-sm"],"offsetMd":[1,"offset-md"],"offsetLg":[1,"offset-lg"],"offsetXl":[1,"offset-xl"],"pull":[1],"pullXs":[1,"pull-xs"],"pullSm":[1,"pull-sm"],"pullMd":[1,"pull-md"],"pullLg":[1,"pull-lg"],"pullXl":[1,"pull-xl"],"push":[1],"pushXs":[1,"push-xs"],"pushSm":[1,"push-sm"],"pushMd":[1,"push-md"],"pushLg":[1,"push-lg"],"pushXl":[1,"push-xl"],"size":[1],"sizeXs":[1,"size-xs"],"sizeSm":[1,"size-sm"],"sizeMd":[1,"size-md"],"sizeLg":[1,"size-lg"],"sizeXl":[1,"size-xl"]},[[9,"resize","onResize"]]],[1,"ion-grid",{"fixed":[4]}],[1,"ion-row"]]],["ion-tab_2",[[1,"ion-tab",{"active":[1028],"delegate":[16],"tab":[1],"component":[1],"setActive":[64]}],[1,"ion-tabs",{"useRouter":[1028,"use-router"],"selectedTab":[32],"select":[64],"getTab":[64],"getSelected":[64],"setRouteId":[64],"getRouteId":[64]}]]],["ion-img",[[1,"ion-img",{"alt":[1],"src":[1],"loadSrc":[32],"loadError":[32]}]]],["ion-progress-bar",[[33,"ion-progress-bar",{"type":[1],"reversed":[4],"value":[2],"buffer":[2],"color":[513]}]]],["ion-range",[[33,"ion-range",{"color":[513],"debounce":[2],"name":[1],"label":[1],"dualKnobs":[4,"dual-knobs"],"min":[2],"max":[2],"pin":[4],"pinFormatter":[16],"snaps":[4],"step":[2],"ticks":[4],"activeBarStart":[1026,"active-bar-start"],"disabled":[4],"value":[1026],"labelPlacement":[1,"label-placement"],"legacy":[4],"ratioA":[32],"ratioB":[32],"pressedKnob":[32]}]]],["ion-split-pane",[[33,"ion-split-pane",{"contentId":[513,"content-id"],"disabled":[4],"when":[8],"visible":[32]}]]],["ion-text",[[1,"ion-text",{"color":[513]}]]],["ion-item_8",[[33,"ion-item-divider",{"color":[513],"sticky":[4]}],[32,"ion-item-group"],[1,"ion-skeleton-text",{"animated":[4]}],[32,"ion-list",{"lines":[1],"inset":[4],"closeSlidingItems":[64]}],[33,"ion-list-header",{"color":[513],"lines":[1]}],[49,"ion-item",{"color":[513],"button":[4],"detail":[4],"detailIcon":[1,"detail-icon"],"disabled":[4],"download":[1],"fill":[1],"shape":[1],"href":[1],"rel":[1],"lines":[1],"counter":[4],"routerAnimation":[16],"routerDirection":[1,"router-direction"],"target":[1],"type":[1],"counterFormatter":[16],"multipleInputs":[32],"focusable":[32],"counterString":[32]},[[0,"ionInput","handleIonInput"],[0,"ionColor","labelColorChanged"],[0,"ionStyle","itemStyle"]]],[34,"ion-label",{"color":[513],"position":[1],"noAnimate":[32]}],[33,"ion-note",{"color":[513]}]]],["ion-select_3",[[33,"ion-select",{"cancelText":[1,"cancel-text"],"color":[513],"compareWith":[1,"compare-with"],"disabled":[4],"fill":[1],"interface":[1],"interfaceOptions":[8,"interface-options"],"justify":[1],"label":[1],"labelPlacement":[1,"label-placement"],"legacy":[4],"multiple":[4],"name":[1],"okText":[1,"ok-text"],"placeholder":[1],"selectedText":[1,"selected-text"],"toggleIcon":[1,"toggle-icon"],"expandedIcon":[1,"expanded-icon"],"shape":[1],"value":[1032],"isExpanded":[32],"open":[64]}],[1,"ion-select-option",{"disabled":[4],"value":[8]}],[34,"ion-select-popover",{"header":[1],"subHeader":[1,"sub-header"],"message":[1],"multiple":[4],"options":[16]}]]],["ion-picker-internal",[[33,"ion-picker-internal",{"exitInputMode":[64]},[[1,"touchstart","preventTouchStartPropagation"]]]]],["ion-datetime_3",[[33,"ion-datetime",{"color":[1],"name":[1],"disabled":[4],"readonly":[4],"isDateEnabled":[16],"min":[1025],"max":[1025],"presentation":[1],"cancelText":[1,"cancel-text"],"doneText":[1,"done-text"],"clearText":[1,"clear-text"],"yearValues":[8,"year-values"],"monthValues":[8,"month-values"],"dayValues":[8,"day-values"],"hourValues":[8,"hour-values"],"minuteValues":[8,"minute-values"],"locale":[1],"firstDayOfWeek":[2,"first-day-of-week"],"titleSelectedDatesFormatter":[16],"multiple":[4],"highlightedDates":[16],"value":[1025],"showDefaultTitle":[4,"show-default-title"],"showDefaultButtons":[4,"show-default-buttons"],"showClearButton":[4,"show-clear-button"],"showDefaultTimeLabel":[4,"show-default-time-label"],"hourCycle":[1,"hour-cycle"],"size":[1],"preferWheel":[4,"prefer-wheel"],"showMonthAndYear":[32],"activeParts":[32],"workingParts":[32],"isPresented":[32],"isTimePopoverOpen":[32],"confirm":[64],"reset":[64],"cancel":[64]}],[34,"ion-picker",{"overlayIndex":[2,"overlay-index"],"delegate":[16],"hasController":[4,"has-controller"],"keyboardClose":[4,"keyboard-close"],"enterAnimation":[16],"leaveAnimation":[16],"buttons":[16],"columns":[16],"cssClass":[1,"css-class"],"duration":[2],"showBackdrop":[4,"show-backdrop"],"backdropDismiss":[4,"backdrop-dismiss"],"animated":[4],"htmlAttributes":[16],"isOpen":[4,"is-open"],"trigger":[1],"presented":[32],"present":[64],"dismiss":[64],"onDidDismiss":[64],"onWillDismiss":[64],"getColumn":[64]}],[32,"ion-picker-column",{"col":[16]}]]],["ion-radio_2",[[33,"ion-radio",{"color":[513],"name":[1],"disabled":[4],"value":[8],"labelPlacement":[1,"label-placement"],"legacy":[4],"justify":[1],"checked":[32],"buttonTabindex":[32],"setFocus":[64],"setButtonTabindex":[64]}],[0,"ion-radio-group",{"allowEmptySelection":[4,"allow-empty-selection"],"name":[1],"value":[1032]},[[4,"keydown","onKeydown"]]]]],["ion-ripple-effect",[[1,"ion-ripple-effect",{"type":[1],"addRipple":[64]}]]],["ion-button_2",[[33,"ion-button",{"color":[513],"buttonType":[1025,"button-type"],"disabled":[516],"expand":[513],"fill":[1537],"routerDirection":[1,"router-direction"],"routerAnimation":[16],"download":[1],"href":[1],"rel":[1],"shape":[513],"size":[513],"strong":[4],"target":[1],"type":[1],"form":[1]}],[1,"ion-icon",{"mode":[1025],"color":[1],"ios":[1],"md":[1],"flipRtl":[4,"flip-rtl"],"name":[513],"src":[1],"icon":[8],"size":[1],"lazy":[4],"sanitize":[4],"svgContent":[32],"isVisible":[32]}]]],["ion-action-sheet",[[34,"ion-action-sheet",{"overlayIndex":[2,"overlay-index"],"delegate":[16],"hasController":[4,"has-controller"],"keyboardClose":[4,"keyboard-close"],"enterAnimation":[16],"leaveAnimation":[16],"buttons":[16],"cssClass":[1,"css-class"],"backdropDismiss":[4,"backdrop-dismiss"],"header":[1],"subHeader":[1,"sub-header"],"translucent":[4],"animated":[4],"htmlAttributes":[16],"isOpen":[4,"is-open"],"trigger":[1],"present":[64],"dismiss":[64],"onDidDismiss":[64],"onWillDismiss":[64]}]]],["ion-alert",[[34,"ion-alert",{"overlayIndex":[2,"overlay-index"],"delegate":[16],"hasController":[4,"has-controller"],"keyboardClose":[4,"keyboard-close"],"enterAnimation":[16],"leaveAnimation":[16],"cssClass":[1,"css-class"],"header":[1],"subHeader":[1,"sub-header"],"message":[1],"buttons":[16],"inputs":[1040],"backdropDismiss":[4,"backdrop-dismiss"],"translucent":[4],"animated":[4],"htmlAttributes":[16],"isOpen":[4,"is-open"],"trigger":[1],"present":[64],"dismiss":[64],"onDidDismiss":[64],"onWillDismiss":[64]},[[4,"keydown","onKeydown"]]]]],["ion-app_8",[[0,"ion-app",{"setFocus":[64]}],[1,"ion-content",{"color":[513],"fullscreen":[4],"forceOverscroll":[1028,"force-overscroll"],"scrollX":[4,"scroll-x"],"scrollY":[4,"scroll-y"],"scrollEvents":[4,"scroll-events"],"getScrollElement":[64],"getBackgroundElement":[64],"scrollToTop":[64],"scrollToBottom":[64],"scrollByPoint":[64],"scrollToPoint":[64]},[[8,"appload","onAppLoad"],[9,"resize","onResize"]]],[36,"ion-footer",{"collapse":[1],"translucent":[4],"keyboardVisible":[32]}],[36,"ion-header",{"collapse":[1],"translucent":[4]}],[1,"ion-router-outlet",{"mode":[1025],"delegate":[16],"animated":[4],"animation":[16],"swipeHandler":[16],"commit":[64],"setRouteId":[64],"getRouteId":[64]}],[33,"ion-title",{"color":[513],"size":[1]}],[33,"ion-toolbar",{"color":[513]},[[0,"ionStyle","childrenStyle"]]],[34,"ion-buttons",{"collapse":[4]}]]],["ion-picker-column-internal",[[33,"ion-picker-column-internal",{"items":[16],"value":[1032],"color":[513],"numericInput":[4,"numeric-input"],"isActive":[32],"scrollActiveItemIntoView":[64],"setValue":[64]}]]],["ion-popover",[[33,"ion-popover",{"hasController":[4,"has-controller"],"delegate":[16],"overlayIndex":[2,"overlay-index"],"enterAnimation":[16],"leaveAnimation":[16],"component":[1],"componentProps":[16],"keyboardClose":[4,"keyboard-close"],"cssClass":[1,"css-class"],"backdropDismiss":[4,"backdrop-dismiss"],"event":[8],"showBackdrop":[4,"show-backdrop"],"translucent":[4],"animated":[4],"htmlAttributes":[16],"triggerAction":[1,"trigger-action"],"trigger":[1],"size":[1],"dismissOnSelect":[4,"dismiss-on-select"],"reference":[1],"side":[1],"alignment":[1025],"arrow":[4],"isOpen":[4,"is-open"],"keyboardEvents":[4,"keyboard-events"],"keepContentsMounted":[4,"keep-contents-mounted"],"presented":[32],"presentFromTrigger":[64],"present":[64],"dismiss":[64],"getParentPopover":[64],"onDidDismiss":[64],"onWillDismiss":[64]}]]],["ion-checkbox",[[33,"ion-checkbox",{"color":[513],"name":[1],"checked":[1028],"indeterminate":[1028],"disabled":[4],"value":[8],"labelPlacement":[1,"label-placement"],"justify":[1],"legacy":[4]}]]],["ion-spinner",[[1,"ion-spinner",{"color":[513],"duration":[2],"name":[1],"paused":[4]}]]]]'),re))))(0,{exclude:["ion-tabs","ion-tab"],syncQueue:!0,raf:Ve,jmp:Ln=>P.runOutsideAngular(Ln),ael(Ln,Kn,zi,ee){Ln[He](Kn,zi,ee)},rel(Ln,Kn,zi,ee){Ln.removeEventListener(Kn,zi,ee)}}))}};let oa=(()=>{class S{static forRoot(P){return{ngModule:S,providers:[{provide:Di,useValue:P},{provide:d.ip1,useFactory:pr,multi:!0,deps:[Di,ae.K0,d.R0b]}]}}}return S.\u0275fac=function(P){return new(P||S)},S.\u0275mod=d.oAB({type:S}),S.\u0275inj=d.cJS({providers:[xs,Ps,wr],imports:[ae.ez]}),S})()},3999:(zn,Dt,R)=>{"use strict";R.d(Dt,{Zw:()=>Re,aw:()=>xt,X$:()=>ze,sK:()=>mt});var x=R(1180),d=R(2029),v=R(2096),s=R(2664),Q=R(9315),ie=R(5211),q=R(4911),y=R(8180),fe=R(8645),Se=R(4552);class De extends fe.x{constructor(gt=1/0,Be=1/0,Bt=Se.l){super(),this._bufferSize=gt,this._windowTime=Be,this._timestampProvider=Bt,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=Be===1/0,this._bufferSize=Math.max(1,gt),this._windowTime=Math.max(1,Be)}next(gt){const{isStopped:Be,_buffer:Bt,_infiniteTimeWindow:Wt,_timestampProvider:wn,_windowTime:Xt}=this;Be||(Bt.push(gt),!Wt&&Bt.push(wn.now()+Xt)),this._trimBuffer(),super.next(gt)}_subscribe(gt){this._throwIfClosed(),this._trimBuffer();const Be=this._innerSubscribe(gt),{_infiniteTimeWindow:Bt,_buffer:Wt}=this,wn=Wt.slice();for(let Xt=0;Xt<wn.length&&!gt.closed;Xt+=Bt?1:2)gt.next(wn[Xt]);return this._checkFinalizedStatuses(gt),Be}_trimBuffer(){const{_bufferSize:gt,_timestampProvider:Be,_buffer:Bt,_infiniteTimeWindow:Wt}=this,wn=(Wt?1:2)*gt;if(gt<1/0&&wn<Bt.length&&Bt.splice(0,Bt.length-wn),!Wt){const Xt=Be.now();let mn=0;for(let an=1;an<Bt.length&&Bt[an]<=Xt;an+=2)mn=an;mn&&Bt.splice(0,mn+1)}}}var X=R(3020);function se(Ve,gt,Be){let Bt,Wt=!1;return Ve&&"object"==typeof Ve?({bufferSize:Bt=1/0,windowTime:gt=1/0,refCount:Wt=!1,scheduler:Be}=Ve):Bt=Ve??1/0,(0,X.B)({connector:()=>new De(Bt,gt,Be),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:Wt})}var Ee=R(7398),_e=R(6328),be=R(4664);class Re{}let Ne=(()=>{class Ve extends Re{getTranslation(Be){return(0,v.of)({})}}return(0,x.Z)(Ve,"\u0275fac",function(){let gt;return function(Bt){return(gt||(gt=d.n5z(Ve)))(Bt||Ve)}}()),(0,x.Z)(Ve,"\u0275prov",d.Yz7({token:Ve,factory:Ve.\u0275fac})),Ve})();class qe{}let _t=(()=>{class Ve{handle(Be){return Be.key}}return(0,x.Z)(Ve,"\u0275fac",function(Be){return new(Be||Ve)}),(0,x.Z)(Ve,"\u0275prov",d.Yz7({token:Ve,factory:Ve.\u0275fac})),Ve})();function Je(Ve,gt){if(Ve===gt)return!0;if(null===Ve||null===gt)return!1;if(Ve!=Ve&&gt!=gt)return!0;let Wt,wn,Xt,Be=typeof Ve;if(Be==typeof gt&&"object"==Be){if(!Array.isArray(Ve)){if(Array.isArray(gt))return!1;for(wn in Xt=Object.create(null),Ve){if(!Je(Ve[wn],gt[wn]))return!1;Xt[wn]=!0}for(wn in gt)if(!(wn in Xt)&&typeof gt[wn]<"u")return!1;return!0}if(!Array.isArray(gt))return!1;if((Wt=Ve.length)==gt.length){for(wn=0;wn<Wt;wn++)if(!Je(Ve[wn],gt[wn]))return!1;return!0}}return!1}function Me(Ve){return typeof Ve<"u"&&null!==Ve}function it(Ve){return Ve&&"object"==typeof Ve&&!Array.isArray(Ve)}function Xe(Ve,gt){let Be=Object.assign({},Ve);return it(Ve)&&it(gt)&&Object.keys(gt).forEach(Bt=>{it(gt[Bt])?Bt in Ve?Be[Bt]=Xe(Ve[Bt],gt[Bt]):Object.assign(Be,{[Bt]:gt[Bt]}):Object.assign(Be,{[Bt]:gt[Bt]})}),Be}class Te{}let ae=(()=>{class Ve extends Te{constructor(...Be){super(...Be),(0,x.Z)(this,"templateMatcher",/{{\s?([^{}\s]*)\s?}}/g)}interpolate(Be,Bt){let Wt;return Wt="string"==typeof Be?this.interpolateString(Be,Bt):"function"==typeof Be?this.interpolateFunction(Be,Bt):Be,Wt}getValue(Be,Bt){let Wt="string"==typeof Bt?Bt.split("."):[Bt];Bt="";do{Bt+=Wt.shift(),!Me(Be)||!Me(Be[Bt])||"object"!=typeof Be[Bt]&&Wt.length?Wt.length?Bt+=".":Be=void 0:(Be=Be[Bt],Bt="")}while(Wt.length);return Be}interpolateFunction(Be,Bt){return Be(Bt)}interpolateString(Be,Bt){return Bt?Be.replace(this.templateMatcher,(Wt,wn)=>{let Xt=this.getValue(Bt,wn);return Me(Xt)?Xt:Wt}):Be}}return(0,x.Z)(Ve,"\u0275fac",function(){let gt;return function(Bt){return(gt||(gt=d.n5z(Ve)))(Bt||Ve)}}()),(0,x.Z)(Ve,"\u0275prov",d.Yz7({token:Ve,factory:Ve.\u0275fac})),Ve})();class yt{}let we=(()=>{class Ve extends yt{compile(Be,Bt){return Be}compileTranslations(Be,Bt){return Be}}return(0,x.Z)(Ve,"\u0275fac",function(){let gt;return function(Bt){return(gt||(gt=d.n5z(Ve)))(Bt||Ve)}}()),(0,x.Z)(Ve,"\u0275prov",d.Yz7({token:Ve,factory:Ve.\u0275fac})),Ve})();class Ze{constructor(){(0,x.Z)(this,"defaultLang",void 0),(0,x.Z)(this,"currentLang",this.defaultLang),(0,x.Z)(this,"translations",{}),(0,x.Z)(this,"langs",[]),(0,x.Z)(this,"onTranslationChange",new d.vpe),(0,x.Z)(this,"onLangChange",new d.vpe),(0,x.Z)(this,"onDefaultLangChange",new d.vpe)}}const Ae=new d.OlP("USE_STORE"),ve=new d.OlP("USE_DEFAULT_LANG"),en=new d.OlP("DEFAULT_LANGUAGE"),dt=new d.OlP("USE_EXTEND");let mt=(()=>{class Ve{get onTranslationChange(){return this.isolate?this._onTranslationChange:this.store.onTranslationChange}get onLangChange(){return this.isolate?this._onLangChange:this.store.onLangChange}get onDefaultLangChange(){return this.isolate?this._onDefaultLangChange:this.store.onDefaultLangChange}get defaultLang(){return this.isolate?this._defaultLang:this.store.defaultLang}set defaultLang(Be){this.isolate?this._defaultLang=Be:this.store.defaultLang=Be}get currentLang(){return this.isolate?this._currentLang:this.store.currentLang}set currentLang(Be){this.isolate?this._currentLang=Be:this.store.currentLang=Be}get langs(){return this.isolate?this._langs:this.store.langs}set langs(Be){this.isolate?this._langs=Be:this.store.langs=Be}get translations(){return this.isolate?this._translations:this.store.translations}set translations(Be){this.isolate?this._translations=Be:this.store.translations=Be}constructor(Be,Bt,Wt,wn,Xt,mn=!0,an=!1,Vt=!1,St){(0,x.Z)(this,"store",void 0),(0,x.Z)(this,"currentLoader",void 0),(0,x.Z)(this,"compiler",void 0),(0,x.Z)(this,"parser",void 0),(0,x.Z)(this,"missingTranslationHandler",void 0),(0,x.Z)(this,"useDefaultLang",void 0),(0,x.Z)(this,"isolate",void 0),(0,x.Z)(this,"extend",void 0),(0,x.Z)(this,"loadingTranslations",void 0),(0,x.Z)(this,"pending",!1),(0,x.Z)(this,"_onTranslationChange",new d.vpe),(0,x.Z)(this,"_onLangChange",new d.vpe),(0,x.Z)(this,"_onDefaultLangChange",new d.vpe),(0,x.Z)(this,"_defaultLang",void 0),(0,x.Z)(this,"_currentLang",void 0),(0,x.Z)(this,"_langs",[]),(0,x.Z)(this,"_translations",{}),(0,x.Z)(this,"_translationRequests",{}),this.store=Be,this.currentLoader=Bt,this.compiler=Wt,this.parser=wn,this.missingTranslationHandler=Xt,this.useDefaultLang=mn,this.isolate=an,this.extend=Vt,St&&this.setDefaultLang(St)}setDefaultLang(Be){if(Be===this.defaultLang)return;let Bt=this.retrieveTranslations(Be);typeof Bt<"u"?(null==this.defaultLang&&(this.defaultLang=Be),Bt.pipe((0,y.q)(1)).subscribe(Wt=>{this.changeDefaultLang(Be)})):this.changeDefaultLang(Be)}getDefaultLang(){return this.defaultLang}use(Be){if(Be===this.currentLang)return(0,v.of)(this.translations[Be]);let Bt=this.retrieveTranslations(Be);return typeof Bt<"u"?(this.currentLang||(this.currentLang=Be),Bt.pipe((0,y.q)(1)).subscribe(Wt=>{this.changeLang(Be)}),Bt):(this.changeLang(Be),(0,v.of)(this.translations[Be]))}retrieveTranslations(Be){let Bt;return(typeof this.translations[Be]>"u"||this.extend)&&(this._translationRequests[Be]=this._translationRequests[Be]||this.getTranslation(Be),Bt=this._translationRequests[Be]),Bt}getTranslation(Be){this.pending=!0;const Bt=this.currentLoader.getTranslation(Be).pipe(se(1),(0,y.q)(1));return this.loadingTranslations=Bt.pipe((0,Ee.U)(Wt=>this.compiler.compileTranslations(Wt,Be)),se(1),(0,y.q)(1)),this.loadingTranslations.subscribe({next:Wt=>{this.translations[Be]=this.extend&&this.translations[Be]?{...Wt,...this.translations[Be]}:Wt,this.updateLangs(),this.pending=!1},error:Wt=>{this.pending=!1}}),Bt}setTranslation(Be,Bt,Wt=!1){Bt=this.compiler.compileTranslations(Bt,Be),this.translations[Be]=(Wt||this.extend)&&this.translations[Be]?Xe(this.translations[Be],Bt):Bt,this.updateLangs(),this.onTranslationChange.emit({lang:Be,translations:this.translations[Be]})}getLangs(){return this.langs}addLangs(Be){Be.forEach(Bt=>{-1===this.langs.indexOf(Bt)&&this.langs.push(Bt)})}updateLangs(){this.addLangs(Object.keys(this.translations))}getParsedResult(Be,Bt,Wt){let wn;if(Bt instanceof Array){let Xt={},mn=!1;for(let an of Bt)Xt[an]=this.getParsedResult(Be,an,Wt),(0,s.b)(Xt[an])&&(mn=!0);if(mn){const an=Bt.map(Vt=>(0,s.b)(Xt[Vt])?Xt[Vt]:(0,v.of)(Xt[Vt]));return(0,Q.D)(an).pipe((0,Ee.U)(Vt=>{let St={};return Vt.forEach((st,qt)=>{St[Bt[qt]]=st}),St}))}return Xt}if(Be&&(wn=this.parser.interpolate(this.parser.getValue(Be,Bt),Wt)),typeof wn>"u"&&null!=this.defaultLang&&this.defaultLang!==this.currentLang&&this.useDefaultLang&&(wn=this.parser.interpolate(this.parser.getValue(this.translations[this.defaultLang],Bt),Wt)),typeof wn>"u"){let Xt={key:Bt,translateService:this};typeof Wt<"u"&&(Xt.interpolateParams=Wt),wn=this.missingTranslationHandler.handle(Xt)}return typeof wn<"u"?wn:Bt}get(Be,Bt){if(!Me(Be)||!Be.length)throw new Error('Parameter "key" required');if(this.pending)return this.loadingTranslations.pipe((0,_e.b)(Wt=>(Wt=this.getParsedResult(Wt,Be,Bt),(0,s.b)(Wt)?Wt:(0,v.of)(Wt))));{let Wt=this.getParsedResult(this.translations[this.currentLang],Be,Bt);return(0,s.b)(Wt)?Wt:(0,v.of)(Wt)}}getStreamOnTranslationChange(Be,Bt){if(!Me(Be)||!Be.length)throw new Error('Parameter "key" required');return(0,ie.z)((0,q.P)(()=>this.get(Be,Bt)),this.onTranslationChange.pipe((0,be.w)(Wt=>{const wn=this.getParsedResult(Wt.translations,Be,Bt);return"function"==typeof wn.subscribe?wn:(0,v.of)(wn)})))}stream(Be,Bt){if(!Me(Be)||!Be.length)throw new Error('Parameter "key" required');return(0,ie.z)((0,q.P)(()=>this.get(Be,Bt)),this.onLangChange.pipe((0,be.w)(Wt=>{const wn=this.getParsedResult(Wt.translations,Be,Bt);return(0,s.b)(wn)?wn:(0,v.of)(wn)})))}instant(Be,Bt){if(!Me(Be)||!Be.length)throw new Error('Parameter "key" required');let Wt=this.getParsedResult(this.translations[this.currentLang],Be,Bt);if((0,s.b)(Wt)){if(Be instanceof Array){let wn={};return Be.forEach((Xt,mn)=>{wn[Be[mn]]=Be[mn]}),wn}return Be}return Wt}set(Be,Bt,Wt=this.currentLang){this.translations[Wt][Be]=this.compiler.compile(Bt,Wt),this.updateLangs(),this.onTranslationChange.emit({lang:Wt,translations:this.translations[Wt]})}changeLang(Be){this.currentLang=Be,this.onLangChange.emit({lang:Be,translations:this.translations[Be]}),null==this.defaultLang&&this.changeDefaultLang(Be)}changeDefaultLang(Be){this.defaultLang=Be,this.onDefaultLangChange.emit({lang:Be,translations:this.translations[Be]})}reloadLang(Be){return this.resetLang(Be),this.getTranslation(Be)}resetLang(Be){this._translationRequests[Be]=void 0,this.translations[Be]=void 0}getBrowserLang(){if(typeof window>"u"||typeof window.navigator>"u")return;let Be=window.navigator.languages?window.navigator.languages[0]:null;return Be=Be||window.navigator.language||window.navigator.browserLanguage||window.navigator.userLanguage,typeof Be>"u"?void 0:(-1!==Be.indexOf("-")&&(Be=Be.split("-")[0]),-1!==Be.indexOf("_")&&(Be=Be.split("_")[0]),Be)}getBrowserCultureLang(){if(typeof window>"u"||typeof window.navigator>"u")return;let Be=window.navigator.languages?window.navigator.languages[0]:null;return Be=Be||window.navigator.language||window.navigator.browserLanguage||window.navigator.userLanguage,Be}}return(0,x.Z)(Ve,"\u0275fac",function(Be){return new(Be||Ve)(d.LFG(Ze),d.LFG(Re),d.LFG(yt),d.LFG(Te),d.LFG(qe),d.LFG(ve),d.LFG(Ae),d.LFG(dt),d.LFG(en))}),(0,x.Z)(Ve,"\u0275prov",d.Yz7({token:Ve,factory:Ve.\u0275fac})),Ve})(),ze=(()=>{class Ve{constructor(Be,Bt){(0,x.Z)(this,"translate",void 0),(0,x.Z)(this,"_ref",void 0),(0,x.Z)(this,"value",""),(0,x.Z)(this,"lastKey",null),(0,x.Z)(this,"lastParams",[]),(0,x.Z)(this,"onTranslationChange",void 0),(0,x.Z)(this,"onLangChange",void 0),(0,x.Z)(this,"onDefaultLangChange",void 0),this.translate=Be,this._ref=Bt}updateValue(Be,Bt,Wt){let wn=Xt=>{this.value=void 0!==Xt?Xt:Be,this.lastKey=Be,this._ref.markForCheck()};if(Wt){let Xt=this.translate.getParsedResult(Wt,Be,Bt);(0,s.b)(Xt.subscribe)?Xt.subscribe(wn):wn(Xt)}this.translate.get(Be,Bt).subscribe(wn)}transform(Be,...Bt){if(!Be||!Be.length)return Be;if(Je(Be,this.lastKey)&&Je(Bt,this.lastParams))return this.value;let Wt;if(Me(Bt[0])&&Bt.length)if("string"==typeof Bt[0]&&Bt[0].length){let wn=Bt[0].replace(/(\')?([a-zA-Z0-9_]+)(\')?(\s)?:/g,'"$2":').replace(/:(\s)?(\')(.*?)(\')/g,':"$3"');try{Wt=JSON.parse(wn)}catch{throw new SyntaxError(`Wrong parameter in TranslatePipe. Expected a valid Object, received: ${Bt[0]}`)}}else"object"==typeof Bt[0]&&!Array.isArray(Bt[0])&&(Wt=Bt[0]);return this.lastKey=Be,this.lastParams=Bt,this.updateValue(Be,Wt),this._dispose(),this.onTranslationChange||(this.onTranslationChange=this.translate.onTranslationChange.subscribe(wn=>{this.lastKey&&wn.lang===this.translate.currentLang&&(this.lastKey=null,this.updateValue(Be,Wt,wn.translations))})),this.onLangChange||(this.onLangChange=this.translate.onLangChange.subscribe(wn=>{this.lastKey&&(this.lastKey=null,this.updateValue(Be,Wt,wn.translations))})),this.onDefaultLangChange||(this.onDefaultLangChange=this.translate.onDefaultLangChange.subscribe(()=>{this.lastKey&&(this.lastKey=null,this.updateValue(Be,Wt))})),this.value}_dispose(){typeof this.onTranslationChange<"u"&&(this.onTranslationChange.unsubscribe(),this.onTranslationChange=void 0),typeof this.onLangChange<"u"&&(this.onLangChange.unsubscribe(),this.onLangChange=void 0),typeof this.onDefaultLangChange<"u"&&(this.onDefaultLangChange.unsubscribe(),this.onDefaultLangChange=void 0)}ngOnDestroy(){this._dispose()}}return(0,x.Z)(Ve,"\u0275fac",function(Be){return new(Be||Ve)(d.Y36(mt,16),d.Y36(d.sBO,16))}),(0,x.Z)(Ve,"\u0275pipe",d.Yjl({name:"translate",type:Ve,pure:!1})),(0,x.Z)(Ve,"\u0275prov",d.Yz7({token:Ve,factory:Ve.\u0275fac})),Ve})(),xt=(()=>{class Ve{static forRoot(Be={}){return{ngModule:Ve,providers:[Be.loader||{provide:Re,useClass:Ne},Be.compiler||{provide:yt,useClass:we},Be.parser||{provide:Te,useClass:ae},Be.missingTranslationHandler||{provide:qe,useClass:_t},Ze,{provide:Ae,useValue:Be.isolate},{provide:ve,useValue:Be.useDefaultLang},{provide:dt,useValue:Be.extend},{provide:en,useValue:Be.defaultLanguage},mt]}}static forChild(Be={}){return{ngModule:Ve,providers:[Be.loader||{provide:Re,useClass:Ne},Be.compiler||{provide:yt,useClass:we},Be.parser||{provide:Te,useClass:ae},Be.missingTranslationHandler||{provide:qe,useClass:_t},{provide:Ae,useValue:Be.isolate},{provide:ve,useValue:Be.useDefaultLang},{provide:dt,useValue:Be.extend},{provide:en,useValue:Be.defaultLanguage},mt]}}}return(0,x.Z)(Ve,"\u0275fac",function(Be){return new(Be||Ve)}),(0,x.Z)(Ve,"\u0275mod",d.oAB({type:Ve})),(0,x.Z)(Ve,"\u0275inj",d.cJS({})),Ve})()},5861:(zn,Dt,R)=>{"use strict";function x(v,s,Q,ie,q,y,fe){try{var Se=v[y](fe),De=Se.value}catch(X){return void Q(X)}Se.done?s(De):Promise.resolve(De).then(ie,q)}function d(v){return function(){var s=this,Q=arguments;return new Promise(function(ie,q){var y=v.apply(s,Q);function fe(De){x(y,ie,q,fe,Se,"next",De)}function Se(De){x(y,ie,q,fe,Se,"throw",De)}fe(void 0)})}}R.d(Dt,{Z:()=>d})},1180:(zn,Dt,R)=>{"use strict";function x(Q){return(x="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(ie){return typeof ie}:function(ie){return ie&&"function"==typeof Symbol&&ie.constructor===Symbol&&ie!==Symbol.prototype?"symbol":typeof ie})(Q)}function s(Q,ie,q){return(ie=function v(Q){var ie=function d(Q,ie){if("object"!==x(Q)||null===Q)return Q;var q=Q[Symbol.toPrimitive];if(void 0!==q){var y=q.call(Q,ie||"default");if("object"!==x(y))return y;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===ie?String:Number)(Q)}(Q,"string");return"symbol"===x(ie)?ie:String(ie)}(ie))in Q?Object.defineProperty(Q,ie,{value:q,enumerable:!0,configurable:!0,writable:!0}):Q[ie]=q,Q}R.d(Dt,{Z:()=>s})},7582:(zn,Dt,R)=>{"use strict";function Q(dt,mt,lt,ze){var gt,xt=arguments.length,Ve=xt<3?mt:null===ze?ze=Object.getOwnPropertyDescriptor(mt,lt):ze;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)Ve=Reflect.decorate(dt,mt,lt,ze);else for(var Be=dt.length-1;Be>=0;Be--)(gt=dt[Be])&&(Ve=(xt<3?gt(Ve):xt>3?gt(mt,lt,Ve):gt(mt,lt))||Ve);return xt>3&&Ve&&Object.defineProperty(mt,lt,Ve),Ve}function X(dt,mt,lt,ze){return new(lt||(lt=Promise))(function(Ve,gt){function Be(wn){try{Wt(ze.next(wn))}catch(Xt){gt(Xt)}}function Bt(wn){try{Wt(ze.throw(wn))}catch(Xt){gt(Xt)}}function Wt(wn){wn.done?Ve(wn.value):function xt(Ve){return Ve instanceof lt?Ve:new lt(function(gt){gt(Ve)})}(wn.value).then(Be,Bt)}Wt((ze=ze.apply(dt,mt||[])).next())})}function Je(dt){return this instanceof Je?(this.v=dt,this):new Je(dt)}function Me(dt,mt,lt){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var xt,ze=lt.apply(dt,mt||[]),Ve=[];return xt={},gt("next"),gt("throw"),gt("return"),xt[Symbol.asyncIterator]=function(){return this},xt;function gt(mn){ze[mn]&&(xt[mn]=function(an){return new Promise(function(Vt,St){Ve.push([mn,an,Vt,St])>1||Be(mn,an)})})}function Be(mn,an){try{!function Bt(mn){mn.value instanceof Je?Promise.resolve(mn.value.v).then(Wt,wn):Xt(Ve[0][2],mn)}(ze[mn](an))}catch(Vt){Xt(Ve[0][3],Vt)}}function Wt(mn){Be("next",mn)}function wn(mn){Be("throw",mn)}function Xt(mn,an){mn(an),Ve.shift(),Ve.length&&Be(Ve[0][0],Ve[0][1])}}function Xe(dt){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var lt,mt=dt[Symbol.asyncIterator];return mt?mt.call(dt):(dt=function be(dt){var mt="function"==typeof Symbol&&Symbol.iterator,lt=mt&&dt[mt],ze=0;if(lt)return lt.call(dt);if(dt&&"number"==typeof dt.length)return{next:function(){return dt&&ze>=dt.length&&(dt=void 0),{value:dt&&dt[ze++],done:!dt}}};throw new TypeError(mt?"Object is not iterable.":"Symbol.iterator is not defined.")}(dt),lt={},ze("next"),ze("throw"),ze("return"),lt[Symbol.asyncIterator]=function(){return this},lt);function ze(Ve){lt[Ve]=dt[Ve]&&function(gt){return new Promise(function(Be,Bt){!function xt(Ve,gt,Be,Bt){Promise.resolve(Bt).then(function(Wt){Ve({value:Wt,done:Be})},gt)}(Be,Bt,(gt=dt[Ve](gt)).done,gt.value)})}}}R.d(Dt,{FC:()=>Me,KL:()=>Xe,gn:()=>Q,mG:()=>X,qq:()=>Je})}},zn=>{zn(zn.s=248)}]);